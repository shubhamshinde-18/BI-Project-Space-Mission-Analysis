var powerbi,__awaiter=this&&this.__awaiter||function(e,i,s,u){return new(s=s||Promise)(function(t,n){function r(e){try{a(u.next(e))}catch(e){n(e)}}function o(e){try{a(u.throw(e))}catch(e){n(e)}}function a(e){var n;e.done?t(e.value):((n=e.value)instanceof s?n:new s(function(e){e(n)})).then(r,o)}a((u=u.apply(e,i||[])).next())})},__generator=this&&this.__generator||function(t,r){var o,a,i,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},e={next:n(0),throw:n(1),return:n(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function n(n){return function(e){return function(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,a&&(i=2&n[0]?a.return:n[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,n[1])).done)return i;switch(a=0,(n=i?[2&n[0],i.value]:n)[0]){case 0:case 1:i=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,a=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(i=0<(i=s.trys).length&&i[i.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){s.label=n[1];break}if(6===n[0]&&s.label<i[1]){s.label=i[1],i=n;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(n);break}i[2]&&s.ops.pop(),s.trys.pop();continue}n=r.call(t,s)}catch(e){n=[6,e],a=0}finally{o=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,e])}}};function addOrUpdateQueryString(e,n,t){t=parseQueryString(t=void 0===t?window.location.search:t);return t[e]=n,rebuildQueryString(t)}function clearQueryString(e,n){n=parseQueryString(n=void 0===n?window.location.search:n);return delete n[e],rebuildQueryString(n)}function parseQueryString(e){var n={},e=e=void 0===e?window.location.search:e;if(e&&"?"===e.substr(0,1))for(var t=0,r=e.substr(1).split("&");t<r.length;t++){var o=r[t].split("="),a=o[0],o=o.slice(1).join("=");n[decodeURIComponent(a)]=decodeURIComponent(o)}return n}function rebuildQueryString(e){var n,t="",r=!0;for(n in e)r||(t+="&"),t+=encodeURIComponent(n)+"=",e[n]&&(t+=encodeURIComponent(e[n])),r=!1;return t=!r?"?"+t:t}function setCookie(e,n,t,r,o){void 0===t&&(t="/"),void 0===r&&(r="none"),o||(o=new Date).setFullYear(o.getFullYear()+1),window&&window.document&&(window.document.cookie=e+" = "+n+";secure;path="+t+";expires="+o.toUTCString()+";samesite="+r)}function startBaseMetadataLogRequest(e,n,t){n={url:e,start:new Date,requestId:n};return window[t].push(n),n}function endBaseMetadataLogRequest(e,n,t,r,o,a,i){e.end=new Date,e.isError=n,e.code=t,e.errorMessage=r,e.parseStart=a,e.parseEnd=i,e.size=o}function getBaseMetadata(n){var t=window;return new Promise(function(e){t.clientAuthEnabled?t.signInPromise.then(function(){window.baseMetadataFromClient?getBaseMetadataInternal(!1,n).then(function(){e(!0)}).catch(function(){e(!0)}):e(!0)}):window.baseMetadataFromClient?getBaseMetadataInternal(!1,n).then(function(){e(!0)}).catch(function(){e(!0)}):e(!0)})}function getBaseMetadataInternal(x,A){return new Promise(function(y,S){var e=window.clusterUri,n=("/"===e.substring(e.length-1)?e:e+"/")+"metadata/bootstrap/base",e=x?window.baseMetadataRetryRequestId:window.baseMetadataRequestId,I=startBaseMetadataLogRequest(n,e,"getBaseMetadataInfo");try{var L=new XMLHttpRequest;L.open("GET",n,!0),L.setRequestHeader("Accept","application/json"),L.setRequestHeader("Authorization","Bearer "+window.powerBIAccessToken),L.setRequestHeader("ActivityId",window.telemetrySessionId),L.setRequestHeader("RequestId",e),L.setRequestHeader("X-PowerBI-Auto-License-Info","AutoLicenseAssignmentSupported"),null!==window.aadConsistencyHeaderScenarioId&&""!==window.aadConsistencyHeaderScenarioId&&L.setRequestHeader("ConsistencyLevel","Organization;ScenarioId="+window.aadConsistencyHeaderScenarioId),null!==powerbi.getQueryStringValue("redirectedFromSignup")&&L.setRequestHeader("X-PowerBI-RedirectedFromSignup","true"),L.onreadystatechange=function(){return __awaiter(this,void 0,void 0,function(){var r,o,a,i,s,u,d,c,w,g,l,f,p,h,v,b,m=this;return __generator(this,function(e){switch(e.label){case 0:return(e.trys.push([0,10,,11]),L.readyState!==XMLHttpRequest.DONE)?[3,9]:(r=L.status,o=L.getAllResponseHeaders(),200<=r&&r<300||304===r?(a=new Date,i=JSON.parse(L.responseText),s=new Date,window.powerbi,window.featureSwitches=i.clientFeatureSwitches,window.placeExpAssignmentContextOnPage&&(window.expAssignmentContext=i.expAssignmentContext),i&&i.branding&&i.branding.config&&(u=JSON.parse(i.branding.config),d={},Object.keys(u).forEach(function(e){var n=e[0].toLowerCase()+e.substring(1);d[n]=u[e]}),i.branding.config=d),window.placeBrandingInfoOnPage&&(window.brandInfo=i.branding),window.placeAutoLicenseAssignmentStateOnPage&&(l=void 0,!o||-1===o.indexOf("x-powerbi-auto-license-info")&&-1===o.indexOf("X-PowerBI-Auto-License-Info")||(l=L.getResponseHeader("x-powerbi-auto-license-info")),c=!1,l&&l.toLowerCase()==="AutoLicenseAssignmentSucceeded".toLowerCase()&&(n=-1!==A.href.indexOf("/teams"),t=function(e){for(var n=0,t=["iphone","ipad","android"];n<t.length;n++){var r=t[n];if(e.toLowerCase().includes(r))return!0}return!1}(window.navigator.userAgent),n&&t&&(A.href="/TeamsMobileAutoLicense?originalUrl="+encodeURIComponent(A.href)),c=!0),R()&&(R().hasAutoAssignedLicense=c),window.hasAutoAssignedLicense=c),(c=i.userSettings.preferredLanguage)&&0<c.length?(setCookie("PreferredLanguage",c),c.toLowerCase()!==C().toLowerCase()&&null===powerbi.getQueryStringValue("language")&&(h=A.origin+A.pathname,v=addOrUpdateQueryString("language",c,A.search),A.href=h+v)):""===c&&(setCookie("PreferredLanguage",c),window.navigator&&window.navigator.language&&window.navigator.language.toLowerCase()!==C().toLowerCase()&&null===powerbi.getQueryStringValue("language")&&(h=A.origin+A.pathname,v=addOrUpdateQueryString("language",window.navigator.language,A.search),A.href=h+v)),endBaseMetadataLogRequest(I,!1,r.toString(),void 0,L.responseText.length,a,s),y(i),[3,9]):[3,1]);case 1:return(w="UserNotLicensed",g=void 0,!o||-1===o.indexOf("x-powerbi-error-info")&&-1===o.indexOf("X-PowerBI-Error-Info")||(g=L.getResponseHeader("x-powerbi-error-info")),0===r&&!g&&window.navigator&&(g="NavigatorOnLineProperty="+window.navigator.onLine),0===r||404===r||408===r||500<=r&&r<600)?x?[3,6]:0!==r?[3,2]:(setTimeout(function(){return __awaiter(m,void 0,void 0,function(){var n;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,getBaseMetadataInternal(!0,A)];case 1:return n=e.sent(),y(n),[3,3];case 2:return n=e.sent(),S(n),[3,3];case 3:return[2]}})})},1e3),[3,5]):[3,8];case 2:return e.trys.push([2,4,,5]),[4,getBaseMetadataInternal(!0,A)];case 3:return f=e.sent(),y(f),[3,5];case 4:return p=e.sent(),S(p),[3,5];case 5:return[3,7];case 6:endBaseMetadataLogRequest(I,!0,r.toString(),g,void 0,void 0,void 0),S(g),e.label=7;case 7:return[3,9];case 8:g&&g.toLowerCase()===w.toLowerCase()?(endBaseMetadataLogRequest(I,!0,r.toString(),g,void 0,void 0,void 0),l=void 0,(l=o&&(-1!==o.indexOf("x-powerbi-auto-license-info")||-1!==o.indexOf("X-PowerBI-Auto-License-Info"))?L.getResponseHeader("x-powerbi-auto-license-info"):l)&&l.toLowerCase()==="AutoLicenseAssignmentDisabledByTenant".toLowerCase()?A.href="https://aka.ms/pbiAdHocSubscriptionNotAllowed":(b=window.staticPageRedirectInTeams,f=powerbi.getQueryStringValue("route"),p=-1!==A.href.indexOf("/teams/"),v=h=void 0,h=f&&0<f.length?(v=clearQueryString("route",A.search),A.origin+"/"+f):(v=A.search,A.origin+A.pathname),A.href=p&&b?"/StaticTeamsSignUp?originalUrl="+encodeURIComponent(A.href)+"&redirectUrl="+encodeURIComponent(h+v):"/SignupRedirect?ru="+h+v)):endBaseMetadataLogRequest(I,!0,r.toString(),g,void 0,void 0,void 0),S(g),e.label=9;case 9:return[3,11];case 10:return b=e.sent(),I.end||endBaseMetadataLogRequest(I,!0,r.toString(),b.message,void 0,void 0,void 0),S(b.message),[3,11];case 11:return[2]}var n,t})})},L.send()}catch(e){I.end||endBaseMetadataLogRequest(I,!0,"No status code",e.message,void 0,void 0,void 0),S(e.message)}function R(){return function(){var e=t();e.session||(e.session={});return e.session}().userInfo}function C(){return function(){var e=t();e.common||(e.common={});return e.common}().cultureInfo}function t(){return window.powerbi||(window.powerbi={}),window.powerbi}})}(powerbi||(powerbi={})).getQueryStringValue=function(e,n){for(var t=(n=n||window.location.search).substr(1).split("&"),r=0,o=t.length;r<o;++r){var a=t[r].split("=");if(a[0]===e)return decodeURIComponent(a[1])}return null},window.getBaseMetadataInfo=[],window.baseMetadataPromise=getBaseMetadata(window.location);