"use strict";var powerbi,__extends=this&&this.__extends||function(){var a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),__awaiter=this&&this.__awaiter||function(e,o,s,l){return new(s=s||Promise)(function(i,t){function a(e){try{r(l.next(e))}catch(e){t(e)}}function n(e){try{r(l.throw(e))}catch(e){t(e)}}function r(e){var t;e.done?i(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(a,n)}r((l=l.apply(e,o||[])).next())})},__generator=this&&this.__generator||function(i,a){var n,r,o,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&t[0]?r.return:t[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,t[1])).done)return o;switch(r=0,(t=o?[2&t[0],o.value]:t)[0]){case 0:case 1:o=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,r=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(o=0<(o=s.trys).length&&o[o.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!o||t[1]>o[0]&&t[1]<o[3])){s.label=t[1];break}if(6===t[0]&&s.label<o[1]){s.label=o[1],o=t;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(t);break}o[2]&&s.ops.pop(),s.trys.pop();continue}t=a.call(i,s)}catch(e){t=[6,e],r=0}finally{n=o=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},__spreadArray=this&&this.__spreadArray||function(e,t){for(var i=0,a=t.length,n=e.length;i<a;i++,n++)e[n]=t[i];return e},__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,i=1,a=arguments.length;i<a;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};!function(e){((e=e.explore||(e.explore={})).components||(e.components={})).invalidFieldWellBucketLocalizationId="Invalid_FieldWellBucket_Move"}(powerbi=powerbi||{}),function(n){!function(t){var e=jsCommon.Utility,i=n.telemetryEventFactory,a=n.telemetry.EventFactories;e?e.generateGuid:Function.prototype;t.EXChangeFieldWellEventName="PBI.EX.ChangeFieldWell",t.EXChangeFieldWell=a[t.EXChangeFieldWellEventName]=function(e){return i({name:t.EXChangeFieldWellEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXChangeFieldWellLoggers})},t.EXChangeAggregationEventName="PBI.EX.ChangeAggregation",t.EXChangeAggregation=a[t.EXChangeAggregationEventName]=function(e){return i({name:t.EXChangeAggregationEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXChangeAggregationLoggers})},t.EXRemoveConditionalFormattingEventName="PBI.EX.RemoveConditionalFormatting",t.EXRemoveConditionalFormatting=a[t.EXRemoveConditionalFormattingEventName]=function(e){return i({name:t.EXRemoveConditionalFormattingEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXRemoveConditionalFormattingLoggers})},t.EXRemoveDataBarsEventName="PBI.EX.RemoveDataBars",t.EXRemoveDataBars=a[t.EXRemoveDataBarsEventName]=function(e){return i({name:t.EXRemoveDataBarsEventName,baseEvent:t.Verbose(e),info:e,category:n.TelemetryCategory.Verbose,loggers:t.EXRemoveDataBarsLoggers})},t.EXAnalyticsPaneOpenEventName="PBI.EX.AnalyticsPane.Open",t.EXAnalyticsPaneOpen=a[t.EXAnalyticsPaneOpenEventName]=function(e){return i({name:t.EXAnalyticsPaneOpenEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXAnalyticsPaneOpenLoggers})},t.EXAnalyticsPaneAddInstanceEventName="PBI.EX.AnalyticsPane.AddInstance",t.EXAnalyticsPaneAddInstance=a[t.EXAnalyticsPaneAddInstanceEventName]=function(e){return i({name:t.EXAnalyticsPaneAddInstanceEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXAnalyticsPaneAddInstanceLoggers})},t.EXAnalyticsPaneRemoveInstanceEventName="PBI.EX.AnalyticsPane.RemoveInstance",t.EXAnalyticsPaneRemoveInstance=a[t.EXAnalyticsPaneRemoveInstanceEventName]=function(e){return i({name:t.EXAnalyticsPaneRemoveInstanceEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXAnalyticsPaneRemoveInstanceLoggers})},t.EXAnalyticsPaneForecastParameterUpdatedEventName="PBI.EX.AnalyticsPane.ForecastParameterUpdated",t.EXAnalyticsPaneForecastParameterUpdated=a[t.EXAnalyticsPaneForecastParameterUpdatedEventName]=function(e){return i({name:t.EXAnalyticsPaneForecastParameterUpdatedEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXAnalyticsPaneForecastParameterUpdatedLoggers})},t.EXPropertyPaneOnValueChangedEventName="PBI.EX.PropertyPane.OnValueChanged",t.EXPropertyPaneOnValueChanged=a[t.EXPropertyPaneOnValueChangedEventName]=function(e){return i({name:t.EXPropertyPaneOnValueChangedEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXPropertyPaneOnValueChangedLoggers})},t.EXDrillthroughPaneChangeLinkEventName="PBI.EX.DrillthroughPane.ChangeLink",t.EXDrillthroughPaneChangeLink=a[t.EXDrillthroughPaneChangeLinkEventName]=function(e){return i({name:t.EXDrillthroughPaneChangeLinkEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXDrillthroughPaneChangeLinkLoggers})},t.EXNavigateAndSelectVisualEventName="PBI.EX.NavigateAndSelectVisual",t.EXNavigateAndSelectVisual=a[t.EXNavigateAndSelectVisualEventName]=function(e){return i({name:t.EXNavigateAndSelectVisualEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXNavigateAndSelectVisualLoggers})},t.EXFieldWellAbnormalRenameEventName="PBI.EX.FieldWellAbnormalRename",t.EXFieldWellAbnormalRename=a[t.EXFieldWellAbnormalRenameEventName]=function(e){return i({name:t.EXFieldWellAbnormalRenameEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXFieldWellAbnormalRenameLoggers})},t.EXLaunchChangeDetectionDialogEventName="PBI.EX.LaunchChangeDetectionDialog",t.EXLaunchChangeDetectionDialog=a[t.EXLaunchChangeDetectionDialogEventName]=function(e){return i({name:t.EXLaunchChangeDetectionDialogEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXLaunchChangeDetectionDialogLoggers})},t.EXAddVisualToCanvasEventName="PBI.EX.AddVisualToCanvas",t.EXAddVisualToCanvas=a[t.EXAddVisualToCanvasEventName]=function(e){return i({name:t.EXAddVisualToCanvasEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,optionalParameters:["isCustom","isFavorite","isOutOfBox","isManaged"],loggers:t.EXAddVisualToCanvasLoggers})},t.EXAboutVisualDialogEventName="PBI.EX.AboutVisualDialog",t.EXAboutVisualDialog=a[t.EXAboutVisualDialogEventName]=function(e){return i({name:t.EXAboutVisualDialogEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXAboutVisualDialogLoggers})},t.EXPersonalizeVisualChangePerspectiveEventName="PBI.EX.PersonalizeVisual.ChangePerspective",t.EXPersonalizeVisualChangePerspective=a[t.EXPersonalizeVisualChangePerspectiveEventName]=function(e){return i({name:t.EXPersonalizeVisualChangePerspectiveEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXPersonalizeVisualChangePerspectiveLoggers})},t.EXPersonalizeVisualLoadFieldListEventName="PBI.EX.PersonalizeVisual.LoadFieldList",t.EXPersonalizeVisualLoadFieldList=a[t.EXPersonalizeVisualLoadFieldListEventName]=function(e){return i({name:t.EXPersonalizeVisualLoadFieldListEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXPersonalizeVisualLoadFieldListLoggers})}}(n.telemetry||(n.telemetry={}))}(powerbi=powerbi||{}),function(r){var e,t,i,a,o,s,l,c,u;e=r.explore||(r.explore={}),t=e.util||(e.util={}),a=r.data,e=r.explore.util,o=r.visuals.cartesianRoleNames,s=r.visuals.AnomalyDetectionVisualPlugin.isSingleDateColumn,l=r.data.ScalarKeyUtils,c=a.SQExprUtils,u=e.VisualContainerUtils,(i=t.AnomalyDetectionValidator||(t.AnomalyDetectionValidator={})).querySupportsAnomalyDetection=function(e,t,i){var a=u.getVisualQuery(e);if(!a)return{shouldInclude:!1};var n=u.getSelectExprs(e);if(!_.every(n,function(e){return c.isExprValidForAnalysisTransform(e.expr)}))return{shouldInclude:!1};if(!_.every(t.schemas,function(e){return _.some(e.capabilities.transformCapabilities.supportedTransforms,function(e){return e===r.data.transforms.AnomalyDetectionTransformPluginName})&&!e.isMultiDimensionalModel}))return{shouldInclude:!0,warningText:i.get("Visual_AnomalyDetection_ErrorMessage_NotSupport")};n=e.config.singleVisual.visualType!==r.visuals.plugins.lineChart.name?void 0:o.category,e=a.tryGetExprs(n);if(s(e,t)||l.isScalarKeySupportedForRole(t,a.defn,a.projections,n))return{shouldInclude:!0};n=i.get("Role_DisplayName_Axis");return{shouldInclude:!0,warningText:i.format("Visual_AnomalyDetection_WarningMessage_CategoryNotDateTime",n)}},i.setQuerySupportsAnomalyDetection=function(e){i.querySupportsAnomalyDetection=e}}(powerbi=powerbi||{}),function(i){var e,a,s,n,c,u,p,r,o,l;function d(e,t){return e.displayName,e.description,0<=e.displayName.search(t)||e.description&&0<=e.description.search(t)}function v(e,t,i,a){for(var n=0,r=e;n<r.length;n++){var o=r[n];o.filtered=!i&&!s.matchFilter(o,t),a=a&&o.filtered}return a}function h(e){if(null==e.type&&null==e.save&&_.isFunction(e.value))return"linkButton";if(null==e.type)return null;var t=function(e){var t=i.ValueType.fromDescriptor(e);if(0!==t.extendedType){t=t.formatting||t.misc;if(t)return function(e){for(var t in e)if(!0===e[t])return t;return null}(t)}return Object.keys(e)[0]}(e.type);switch(t){case"alignment":return"alignment";case"numericUnitSelection":return"numericUnitSelection";case"fontSize":case"titleFontSize":case"secFontSize":case"secTitleFontSize":return a.PropertySliceNames.NumericSelection;case"fontFamily":return"fontPicker";case"altText":return a.PropertySliceNames.TextArea;case"webUrl":return"text"}if(e.selectionOptions)return e.selectionOptions.some(function(e){return e.icon})?"propertyPaneSelection":"flagsEnumeration"===t?a.PropertySliceNames.FlagsSelection:a.PropertySliceNames.Selection;switch(e.name){case"lineTransparency":case"transparency":case"angle":case"shapeAngle":case"textAngle":case"imageHeight":case"steppedLayoutIndentation":case"percentile":case"preferredCategoryWidth":case"maxMarginFactor":case"innerPadding":case"labelDensity":case"bubbleSize":case"backgroundTransparency":case"innerRadiusRatio":case"startAngle":case"borderWidth":case"explode":case"radius":case"dataBarWidthPercent":case"barsPerLevel":case"shadowBlur":case"shadowSpread":case"shadowDistance":case"markerShapeSize":case o.bubbleRadius:case o.minBubbleRadius:case o.maxRadius:case o.mapTransparency:case o.strokeTransparency:case o.blur:case o.unselectedTransparency:case o.bubbleStrokeWidth:case o.height:case o.thickness:case"gridLineWidth":case"gridPadding":case"columnPaddingInner":case"columnPaddingOuter":case"rowPaddingInner":case"rowPaddingOuter":case"shadeTransparency":case l.arrowheadSize:case l.speechBubbleHeight:case l.speechBubbleTailAngle:case l.chevronAngle:case l.hexagonSlant:case l.octagonSnipSize:case l.parallelogramSlant:case l.rectangleRoundedCurve:case l.shapeRounding:case l.arrowStemWidth:case l.tabCutCornerSnipSizeTopRight:case l.tabCutCornerSnipSizeTop:case l.tabCutCornerSnipSizeBottom:case l.tabRoundCornerTopRight:case l.tabRoundCornerTop:case l.tabRoundCornerBottom:case l.trapezoidSlant:case l.isocelesTriangleTipPosition:return a.PropertySliceNames.Slider;case"gradientBar":return"gradientBar";case"expander":return"container";case"weight":case"textSize":case"outlineWeight":case"gridVerticalWeight":case"gridHorizontalWeight":case"rowPadding":case"barWeight":case"cardPadding":case"borderThickness":case"strokeWidth":case"gridlineThickness":case"markerSize":return a.PropertySliceNames.NumericSelection}return e.numericValueOptions?a.PropertySliceNames.NumericSelection:t}e=i.explore||(i.explore={}),a=e.viewModels||(e.viewModels={}),s=a.PropertyPaneUtils||(a.PropertyPaneUtils={}),c=i.data.DataBoundExprWarning,u=i.data.Selector,p=jsCommon.StringExtensions,r=jsCommon.TextSizeDefaults,o=i.visuals.azureMapObjectPropertyNames,l=i.visuals.tileLibraryObjectPropertyNames,(e=n=n||{}).percentLocKey="Slider_Percent",e.weightLocKey="Slider_Weight",e.degreeLocKey="Slider_Degree",s.matchFilter=d,s.applyFilter=function(e,t){if(!_.isEmpty(e))for(var i=p.literalStringToRegex(t||"","i"),a=0,n=e;a<n.length;a++){for(var r=n[a],o=d(r,i),s=!0,l=0,c=_.size(r.containers);l<c;l++){var u=r.containers[l];u.filtered=v(u.slices,i,o,!0),s=s&&u.filtered}s=v(r.slices,i,o,s),r.filtered=v(r.footer,i,o,s)}},s.filterSlices=v,s.getUniqueIdFromKeys=function(e,t){return e?e+"-"+t:t},s.getCardContainerKey=function(e,t){return a.ViewModelFactory.createUniqueId([e,t.toString()])},s.getNumericValueOptions=function(e){if(e.numericValueOptions)return e.numericValueOptions;var t=h(e);if(t===a.PropertySliceNames.Slider||t===a.PropertySliceNames.NumericSelection)switch(e.name){case"weight":return{unitSymbol:n.weightLocKey,minValue:0,maxValue:50};case"angle":return{unitSymbol:n.degreeLocKey,minValue:0,maxValue:360};case"textSize":case"fontSize":case"categoryLabelFontSize":case"dataLabelFontSize":case"levelSubtitleFontSize":case"levelTitleFontSize":case"titleFontSize":case"secFontSize":case"secTitleFontSize":case"expandCollapseButtonsSize":case"headerFontSize":case"cardFontSize":case"questionFontSize":case"restatementFontSize":return{unitSymbol:n.weightLocKey,minValue:r.TextSizeMin,maxValue:r.TextSizeMax};case"outlineWeight":case"gridVerticalWeight":case"gridHorizontalWeight":case"barWeight":return{unitSymbol:"",minValue:1,maxValue:10};case"rowPadding":case"cardPadding":return{unitSymbol:"",minValue:0,maxValue:20};case"gridPadding":case"columnPaddingInner":case"columnPaddingOuter":case"rowPaddingInner":case"rowPaddingOuter":return{unitSymbol:"",minValue:0,maxValue:40};case"imageHeight":return{unitSymbol:"",minValue:24,maxValue:150};case"steppedLayoutIndentation":return{unitSymbol:"",minValue:0,maxValue:40};case"borderThickness":case"markerShapeSize":return{unitSymbol:"",minValue:0,maxValue:10};case"preferredCategoryWidth":return{unitSymbol:"",minValue:20,maxValue:180};case"strokeWidth":return{unitSymbol:"",minValue:0,maxValue:12};case"gridlineThickness":return{unitSymbol:"",minValue:1,maxValue:4};case"markerSize":return{unitSymbol:"",minValue:5,maxValue:20};case"innerRadiusRatio":return{unitSymbol:"",minValue:0,maxValue:95};case"startAngle":return{unitSymbol:i.visuals.visualLocKeys.DegreeLocKey,minValue:0,maxValue:360};case"borderWidth":return{unitSymbol:i.visuals.visualLocKeys.PixelUnitSymbol,minValue:0,maxValue:30};case"explode":return{unitSymbol:n.percentLocKey,minValue:0,maxValue:50};case"bubbleSize":return{unitSymbol:"",minValue:-25,maxValue:100};case"radius":return{unitSymbol:i.visuals.visualLocKeys.PixelUnitSymbol,minValue:0,maxValue:30};case"dataBarWidthPercent":return{unitSymbol:n.percentLocKey,minValue:50,maxValue:150};case"shadowSpread":case"shadowBlur":case"shadowDistance":return{unitSymbol:i.visuals.visualLocKeys.PixelUnitSymbol,minValue:0,maxValue:100};default:return{unitSymbol:n.percentLocKey,minValue:0,maxValue:100}}},s.getSliceComponentType=h,s.isPropertyTitleWidthStretch=function(e){return(e=h(e))===a.PropertySliceNames.Slider||"fill"===e},s.getValidSelectionValue=function(e,t){if(null!=t&&_.isNumber(t))for(var i=t.toString(),a=0,n=e;a<n.length;a++){var r=n[a];if(r.value===t)break;if(r.value===i)return i}return t},s.syncSelectedContainers=function(e,t){var i,a;e.selectedContainers&&(_.isEmpty(t.containers)?e.selectedContainers[t.name]=void 0:(a=void 0,a=(i=e.selectedContainers[t.name])?_.find(t.containers,function(e){return e.value===i}):_.head(t.containers),t.selectedContainer=a))},s.getWarningMessage=function(e,t,i){if(e instanceof c){var a=e;return i?{title:a.getTitle(t),message:null,detail:null}:{title:a.getMessage(t),message:null,detail:null}}return e.getMessages(t)},s.getSliceWarning=function(e,t,i){for(var a=0,n=e;a<n.length;a++){var r=n[a];if(r&&r.warnings)for(var o=0,s=r.warnings;o<s.length;o++){var l=s[o];if(l instanceof c&&l.propertyId.propertyName===i&&(!l.selector&&!l.selector||u.equals(l.selector,t)))return l}}}}(powerbi=powerbi||{}),function(i){!function(e){function t(e,t){this.$services=t,this.HorizontalAlignment=i.visuals.horizontalAlignment,this.VerticalAlignment=i.visuals.verticalAlignment,this.paneColorRefreshEnabled=this.$services.explorationCapabilities.getCapabilities().showFluentDesign||this.$services.featureSwitchService.featureSwitches&&this.$services.featureSwitchService.featureSwitches.paneColorRefresh,this.symbolSheetName=this.paneColorRefreshEnabled?"visualizationPaneIcons_paneColorRefresh":"visualizationPaneIcons",this.services=t,this.initializeHighContrastRules()}e=e.controllers||(e.controllers={}),t.createOptions=function(){return{additionalServices:["$element","highContrastCssGenerationService","featureSwitchService","localizationService"],scopedDependencies:["explorationCapabilities"]}},t.prototype.$onInit=function(){var i=this;this.ngModel.$render=function(){i.selectedValue=i.ngModel.$modelValue;var e=i.$services.$element.find(".alignment-option-wrapper"),t=i.getIndexFromAlignment(i.selectedValue);e.eq(t).focus()}},t.prototype.getSymbolId=function(e){switch(e=e.toLowerCase()){case"top":e="TextAlignTop";break;case"middle":e="TextAlignMiddle";break;case"bottom":e="TextAlignBottom"}return this.paneColorRefreshEnabled?e+"_paneColorRefresh":e},t.prototype.setAlignment=function(e){this.selectedValue=e,this.ngModel.$setViewValue(this.selectedValue)},t.prototype.onAlignmentKeydown=function(e,t,i){var a,n=this.$services.$element.find(".alignment-option-wrapper"),t=this.getIndexFromAlignment(t);!e||e.keyCode!==$.ui.keyCode.RIGHT&&e.keyCode!==$.ui.keyCode.DOWN?!e||e.keyCode!==$.ui.keyCode.LEFT&&e.keyCode!==$.ui.keyCode.UP||(a=(t-1+n.length)%n.length,this.setAlignmentOnFocus(a,i,n)):(a=(t+1)%n.length,this.setAlignmentOnFocus(a,i,n))},t.prototype.isSelected=function(e){return this.selectedValue===e},t.prototype.initializeHighContrastRules=function(){this.$services.highContrastCssGenerationService.addRule(".themeableElement alignment-group .alignment-selected .alignment-option","{ background-color: @selectedBackgroundColor !important; }"),this.$services.highContrastCssGenerationService.addRule(".themeableElement alignment-group :not(.alignment-selected) .alignment-option:hover","{ background-color: @selectedBackgroundColor !important; }")},t.prototype.getIndexFromAlignment=function(e){switch(e){case this.VerticalAlignment.top:case this.HorizontalAlignment.left:return 0;case this.VerticalAlignment.middle:case this.HorizontalAlignment.center:return 1;case this.VerticalAlignment.bottom:case this.HorizontalAlignment.right:return 2}},t.prototype.getAlignmentFromIndex=function(e,t){switch(e){case 0:return t?this.VerticalAlignment.top:this.HorizontalAlignment.left;case 1:return t?this.VerticalAlignment.middle:this.HorizontalAlignment.center;case 2:return t?this.VerticalAlignment.bottom:this.HorizontalAlignment.right}},t.prototype.setAlignmentOnFocus=function(e,t,i){this.setAlignment(this.getAlignmentFromIndex(e,t)),i.eq(e).focus()},t.prototype.getTooltipConfig=function(e){var t;if(e)switch(e=e.toLowerCase()){case"left":t="Visual_TextAlignment_Left";break;case"right":t="Visual_TextAlignment_Right";break;case"center":t="Visual_TextAlignment_Center";break;case"top":t="Top";break;case"middle":t="Middle";break;case"bottom":t="Bottom"}if(t)return{tooltipDisable:!1,tooltipTitle:this.services.localizationService.get(t),tooltipShowOnFocus:!0}},e.AlignmentGroupController=t}(i.explore||(i.explore={}))}(powerbi=powerbi||{}),function(e){var t;((t=e.explore||(e.explore={})).components||(t.components={})).AlignmentGroup={templateUrl:"components/alignmentGroup/alignmentGroup.html",require:{ngModel:"ngModel"},bindings:{inputName:"<"},controller:e.common.createController(t.controllers.AlignmentGroupController)}}(powerbi=powerbi||{}),define("ExploreUIShell/components/analyticsCard/analyticsCardController",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AnalyticsCardController=t.AnalyticsCardControllerBase=void 0;var i=powerbi,r=i.data,a=i.explore.viewModels,n=a.AnalyticsCardHelper,i=(Object.defineProperty(u.prototype,"currentInstance",{get:function(){return _.isEmpty(this.instances)?this.card.defaultInstance:this.getInstance(this.instances,this.currentInstanceSelectorId)},set:function(e){this.currentInstanceSelectorId=e.selector?e.selector.id:void 0},enumerable:!1,configurable:!0}),u.prototype.$onInit=function(){this.visualContainer&&(this.currentInstance===this.card.defaultInstance&&(this.collapsed=!0),_.isEmpty(this.instances)||this.currentInstanceSelectorId||(this.currentInstance=_.last(this.instances)),this.objects=this.visualContainer.config.singleVisual.objects,this.updateCardStatus(),this.onUpdateInstance&&this.onUpdateInstance({instance:this.currentInstance}))},u.prototype.$onChanges=function(e){var t,i;this.card.readOnly?this.toggleCollapsed():this.visualContainer&&(e.instances&&(i=e.instances.currentValue,e=e.instances.previousValue,i.length<e.length&&(_.isEmpty(this.instances)?this.currentInstanceSelectorId=null:this.getInstance(i,this.currentInstanceSelectorId)||(t=parseInt(this.currentInstanceSelectorId,10),i=_.filter(this.instances,function(e){return parseInt(e.selector.id,10)>t}),_.isEmpty(i)?this.currentInstance=_.maxBy(this.instances,function(e){return parseInt(e.selector.id,10)}):this.currentInstance=_.minBy(i,function(e){return parseInt(e.selector.id,10)}))),this.currentInstanceSelectorId||_.isEmpty(this.instances)||(this.currentInstance=_.last(this.instances)),this.onUpdateInstance&&this.onUpdateInstance({instance:this.currentInstance})),this.objects!==this.visualContainer.config.singleVisual.objects&&(this.objects=this.visualContainer.config.singleVisual.objects),this.updateCardStatus())},u.prototype.getLabelForInstanceCount=function(){return this.isForecastCard?this.services.localizationService.format("AnalyticsPane_Forecast_Count",[this.instances.length]):this.isAnomalyDetectionCard?this.services.localizationService.format("AnalyticsPane_AnomalyDetection_Count",[this.instances.length]):this.services.localizationService.format("AnalyticsPane_Instance_Count",[this.instances.length])},u.findSlice=function(e,t){return _.find(e.slices,{name:t})},u.prototype.toggleCollapsed=function(){this.card.readOnly?this.collapsed=!0:this.collapsed=!this.collapsed,this.updateCardStatus()},u.prototype.getTooltipConfig=function(){return{tooltipDescription:this.description||this.displayName}},u.prototype.setCurrentInstance=function(e){this.currentInstance=e,this.onUpdateInstance&&this.onUpdateInstance({instance:this.currentInstance}),this.updateCardStatus()},u.prototype.getSliceComponentType=function(e){return a.PropertyPaneUtils.getSliceComponentType(e)},u.prototype.save=function(e){var t=this;this.currentInstance&&!e.isDisabled&&this.services.undoRedo.register("update slices",function(){return t.saveAction(e)})},u.prototype.onKeyDown=function(e){e.keyCode!==$.ui.keyCode.ENTER&&e.keyCode!==$.ui.keyCode.SPACE||(this.toggleCollapsed(),e.stopPropagation(),e.preventDefault())},u.prototype.saveAction=function(e){if(this.inputForm&&this.inputForm[e.name]&&this.inputForm[e.name].$invalid)return!1;var t={};return this.onSave&&this.onSave({changes:t,slice:e,instance:this.currentInstance})?this.persistProperties(t):"revertToDefault"===e.name?this.revertCurrentInstance(t):void n.saveAnalyticsCardAction(this.card.name,e,this.visualContainer,{undoRedo:this.services.undoRedo,visualAuthoring:this.services.visualAuthoring,visualPlugin:this.services.visualPlugin})},u.prototype.revertCurrentInstance=function(e){var t={objectName:this.card.name,selector:this.currentInstance.selector,properties:{}};e.remove||(e.remove=[]),e.remove.push(t);for(var i=0,a=this.currentInstance.slices;i<a.length;i++){var n=a[i];"show"!==n.name&&"displayName"!==n.name&&(t.properties[n.name]=null)}return this.persistProperties(e)},u.prototype.persistProperties=function(e){return!!this.services.visualAuthoring.persistProperties(e,this.visualContainer,!0)&&(this.services.visualAuthoring.raiseVisualContainerChanged(this.visualContainer),!0)},u.nextSelectorId=function(e){return((_.isEmpty(e)?0:_.max(e))+1).toString()},u.prototype.addInstance=function(){var e=this;this.services.undoRedo.register("add instance",function(){return e.addInstanceAction()})},u.prototype.addInstanceAction=function(){var e;this.objects||(this.objects={});var t=this.objects[this.card.name],i=null;if(this.card.supportsUserDefinedInstances){var a=[];if(t)for(var n=0,r=t;n<r.length;n++){var o=r[n];void 0!==(null===(e=o.selector)||void 0===e?void 0:e.id)&&a.push(parseInt(o.selector.id,10))}i={id:u.nextSelectorId(a)}}for(var s,l=1,c=this.instances.map(function(e){return e.displayName});s=this.services.localizationService.format("AnalyticsPane_New_Instance_Default_Format",[this.displayName,this.instances.length+l]),l++,_.includes(c,s););t={displayName:s,selector:i,slices:[]};this.instances.push(t);i={merge:[{objectName:this.card.name,selector:t.selector,properties:{show:!0}}]},i=this.changeDisplayName(t,s,i);return this.onAddInstance&&this.onAddInstance({changes:i,instance:t}),this.currentInstance=t,"referenceLine"!==this.card.name&&this.services.telemetryService.logEvent(powerbi.telemetry.EXAnalyticsPaneAddInstance,{objectName:this.card.name}),this.persistProperties(i)},u.prototype.removeInstance=function(e){var t=this;this.services.undoRedo.register("remove instance",function(){return t.removeInstanceAction(e)})},u.prototype.removeInstanceAction=function(e){var t={removeObject:[{objectName:this.card.name,selector:e.selector,properties:{}}]};return this.onDeleteInstance&&this.onDeleteInstance({instance:e}),this.persistProperties(t)},u.prototype.renameInstance=function(t,i){var a=this;this.services.undoRedo.register("rename instance",function(){var e=a.changeDisplayName(t,i);return a.persistProperties(e)})},u.prototype.getInstance=function(e,t){return _.find(this.instances,function(e){return!e.selector||e.selector.id===t})},u.prototype.changeDisplayName=function(e,t,i){t={objectName:this.card.name,selector:e.selector,properties:{displayName:t}};return(i=i||{merge:[]}).merge||(i.merge=[]),i.merge.push(t),i},u.prototype.updateCardStatus=function(){if(this.currentInstance){var e=!!this.isCardDirty&&this.isCardDirty({property:null,value:null}),t=r.DataViewObjectDefinitions.getObjectDefinition(this.objects,this.card.name,this.currentInstance.selector);if(t)for(var i in t.properties){var a=t.properties[i];if((this.isCardDirty?this.isCardDirty({property:i,value:a}):u.isCardDirty(i,a))&&"show"!==i&&"displayName"!==i&&"transform"!==i){e=!0;break}}var n=u.findSlice(this.currentInstance,"revertToDefault");n&&(n.value=e)}},u.isCardDirty=function(e,t){return null!==t},u);function u(){}t.AnalyticsCardControllerBase=i;var o,i=(__extends(s,o=i),s.createOptions=function(){return{additionalServices:["localizationService","telemetryService","featureSwitchService","visualStylePresetService","themeService"],scopedDependencies:["undoRedo","visualAuthoring","resourceLoader","resourceRegistration","visualPlugin","visualSync","layoutAuthoring","selection","explorationNavigation","eventBridge"]}},s);function s(e,t){var i=o.call(this)||this;return i.services=t,i.propertySliceSaveServices={featureSwitchService:i.services.featureSwitchService,resourceLoader:i.services.resourceLoader,resourceRegistration:i.services.resourceRegistration,visualStylePresetService:i.services.visualStylePresetService,themeService:i.services.themeService,visualAuthoring:i.services.visualAuthoring,telemetryService:i.services.telemetryService,visualPlugin:i.services.visualPlugin,undoRedo:i.services.undoRedo,visualSync:i.services.visualSync,layoutAuthoring:i.services.layoutAuthoring,explorationNavigation:i.services.explorationNavigation},i}t.AnalyticsCardController=i}),define("ExploreUIShell/components/analyticsCard/analyticsCard",["require","exports","ExploreUIShell/components/analyticsCard/analyticsCardController"],function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.AnalyticsCard=void 0;var a=powerbi.common.createController;t.AnalyticsCard={templateUrl:"components/analyticsCard/analyticsCard.html",transclude:!0,bindings:{card:"<",cardTitle:"<",instances:"<",maximumInstances:"<",displayName:"<",description:"<",visualContainer:"<",isLabelEditable:"<",isForecastCard:"<?",isAnomalyDetectionCard:"<?",onAddInstance:"&",onUpdateInstance:"&",onSave:"&",onDeleteInstance:"&",isCardDirty:"&?"},controller:a(i.AnalyticsCardController)}}),function(V){var D;(function(C){var P,r=V.common.utils.ColorUtility,o=V.data.createDisplayNameGetter,x=V.data.DataViewObjectDefinitions,s=V.visuals.GradientUtils,e=V.explore.constants.MinContainerHeight,t=V.explore.constants.MinContainerWidth,v=V.visuals.ObjectEnumerationBuilder,l=V.data.SQExprUtils;(i=P=C.PropertyPaneConsts||(C.PropertyPaneConsts={})).MinContainerWidth=e,i.MinContainerHeight=t,i.MaxPrecision=15,i.SliceNameAxisStart="axisStart",i.SliceNameAxisEnd="axisEnd",i.SliceNameStart="start",i.SliceNameEnd="end",i.SliceNameInvertAxis="invertAxis",i.SliceNameSecStart="secStart",i.SliceNameSecEnd="secEnd",i.SliceNameSecInvertAxis="secInvertAxis",i.PlotAreaCardName="plotArea",i.ImageSliceName="image",i.MapSliceName="map",i.ImageFitSliceName="scaling",i.TransparencySliceName="transparency";var i=(M.canVisualizeProperty=function(e){return!!e&&(0!==V.ValueType.fromDescriptor(e.type).extendedType||V.StructuralTypeDescriptor.isValid(e.type))},M.getSelectionOptions=function(h){return __awaiter(this,void 0,V.Promise,function(){var t,i,a,n,r,o,s,l,c,u,p,d,v;return __generator(this,function(e){switch(e.label){case 0:return(v=h.propertyType,t=h.instance,i=h.propertyName,l=h.paneServices,d=h.visualType,a=(l=l||{}).bookmarkService,n=l.dataSourcesService,r=l.explorationNavigation,o=l.localizationService,s=l.perspectivesService,p=l.visualStylePresetService,l=v.enum||v.flagsEnum)?[3,7]:((c=v.formatting)&&(c.labelDisplayUnits?l=V.createEnumType(D.util.PropertyPaneUtils.getDisplayUnits()):c.displayUnitsWithoutAuto?l=V.createEnumType(D.util.PropertyPaneUtils.getDisplayUnits(!0)):c.stylePreset&&(l=p.getEnumFromName(d,t.properties.name))),(c=v.reference)?c.bookmark?(a&&(l=V.createEnumType(M.getBookmarks(a))),[3,7]):[3,1]:[3,7]);case 1:return c.bookmarkGroup?(a&&(l=V.createEnumType(M.getBookmarkGroups(a))),[3,7]):[3,2];case 2:return c.section?(r&&(l=V.createEnumType(M.getSections(r))),[3,7]):[3,3];case 3:return c.perspective?n&&s&&o?(u=V.createEnumType,[4,M.getPerspectives(n,s,o)]):[3,5]:[3,6];case 4:l=u.apply(void 0,[e.sent()]),e.label=5;case 5:return[3,7];case 6:e.label=7;case 7:return l?((p=M.getValidValues(t,i))&&(d=void 0,M.isValidationOptions(p)?(d=p.filterValues,p.mergeValues&&(v=__spreadArray(__spreadArray([],p.mergeValues||[]),l.members()||[]),l=V.createEnumType(v))):d=p,d&&(l=V.createEnumType(l.members(d)))),[2,D.util.PropertyPaneUtils.getDisplayNames(l.members())]):[2]}})})},M.getValidValues=function(e,t){e=e.validValues;return e&&e[t]},M.isValidationOptions=function(e){return!_.isArray(e)},M.getBookmarks=function(e){e=e.getAllBookmarks();return _.map(e,function(e){return{displayName:e.displayName,value:e.name}})},M.getBookmarkGroups=function(e){e=e.getBookmarkGroups();return _.map(e,function(e){return{displayName:e.displayName,value:e.name}})},M.getSections=function(e){e=e.getAllSections();return _.map(e,function(e){return{displayName:e.displayName,value:e.name}})},M.getPerspectives=function(n,r,o){var s;return __awaiter(this,void 0,V.Promise,function(){var t,i,a;return __generator(this,function(e){switch(e.label){case 0:t={displayName:o.get("PersonalizeVisual_DefaultPerspective"),value:""},i=n.get().map(function(e){var t=e.type,e=e.dsr;return{type:t,objectId:null==e?void 0:e.dbName}}),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,r.get(i).toPromise()];case 2:return a=(null===(s=e.sent())||void 0===s?void 0:s.perspectiveIds)||[],[3,4];case 3:return e.sent(),a=[],[3,4];case 4:return[2,__spreadArray([t],a.map(function(e){return{displayName:e,value:e}}))]}})})},M.populatePaneForVisual=function(a,n){return __awaiter(this,void 0,V.Promise,function(){var t,i;return __generator(this,function(e){switch(e.label){case 0:return t=C.VisualCapabilitiesSliceFactoryHelper.createPopulatePaneOptions(n),[4,this.populatePane(a,t)];case 1:return(e.sent(),n.featureSwitchService.featureSwitches.useModernFormatPane)?[3,3]:((i=C.VisualContainerSliceFactoryHelper.createPopulatePaneOptions(n)).cardIndexCounter=t.cardIndexCounter,[4,this.populatePane(a,i)]);case 2:e.sent(),e.label=3;case 3:return a.cards=jsCommon.ArrayExtensions.extendWithName(_.sortBy(a.cards,function(e){return e.index})),a.selectedVisualType=n.selectedVisualType,M.addValidation(a,n.sectionSize),[2,a]}})})},M.populatePaneForVisualContainerGroup=function(i,a){return __awaiter(this,void 0,V.Promise,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return t=C.VisualContainerGroupSliceFactoryHelper.createPopulatePaneOptions(a),[4,this.populatePane(i,t)];case 1:return e.sent(),M.addValidation(i,a.sectionSize),[2,i]}})})},M.populatePane=function(n,r){return __awaiter(this,void 0,V.Promise,function(){var t,i,a=this;return __generator(this,function(e){for(i in r.objectDescriptors,n.selectedContainers=r.selectedContainers,t=[],r.objectDescriptors)t.push(this.populateCard(n,r,i,r.cardIndexCounter++));return[2,r.promiseFactory.all(t).then(function(){r.showGradientCard&&!n.cards.withName(C.PropertyCardNames.Gradient)&&a.populateGradientCard(n,r.objectDefinitions,!1,r,r.cardIndexCounter++),r.enumerateObjectRepetition&&!r.excludeConditionalFormattingCard&&(r.conditionalFormattingUtilsService.populateConditionalFormattingCard(n,r),r.cardIndexCounter++);var e=n.cards.withName(C.PropertyCardNames.General);e&&(e.index=-2);e=n.cards.withName(C.PropertyCardNames.StylePreset);return e&&(e.index=-1),n})]})})},M.populateCard=function(r,o,s,l){return __awaiter(this,void 0,V.Promise,function(){var t,i,a,n;return __generator(this,function(e){switch(e.label){case 0:return(t=o.objectDescriptors[s])?o.shouldIncludeObject&&!o.shouldIncludeObject(t.objectCategory)?[2]:[4,o.enumerateObjectInstances(s)]:[2];case 1:return(n=e.sent(),!(i=v.normalize(n))||_.isEmpty(i.instances))?(o.showGradientCard&&"dataPoint"===s&&this.populateGradientCard(r,o.objectDefinitions,!1,o,l),[2]):((a=r.cards.withName(s))||(n=!!(o.objectDefinitions&&o.objectDefinitions[s]&&0<o.objectDefinitions[s].length),a={name:s,id:C.PropertyPaneUtils.getUniqueIdFromKeys(o.visualType,s),index:l,displayName:C.ViewModelFactory.getDisplayName(t.displayName)||s,description:C.ViewModelFactory.getDisplayName(t.description),slices:jsCommon.ArrayExtensions.createWithName(),footer:[],mainShow:null,isDirty:n},r.cards.push(a)),[4,M.addSlices(a,i,t,o)]);case 2:return e.sent(),C.PropertyPaneUtils.syncSelectedContainers(o,a),a.name!==C.PropertyCardNames.General&&M.addFooterSlicesToCard(a,o),[2]}})})},M.addSlices=function(c,u,p,d){return __awaiter(this,void 0,V.Promise,function(){var t,i,a,n,r,o,s,l;return __generator(this,function(e){switch(e.label){case 0:t=d.isDisabled,u.containerInfo&&!_.isEmpty(u.containers)&&(c.containersLabel=C.ViewModelFactory.getDisplayName(u.containerInfo.containersLabel),c.containersTooltip=C.ViewModelFactory.getDisplayName(u.containerInfo.containersTooltip)),i=0,a=u.instances,e.label=1;case 1:return i<a.length?(n=a[i],r=p.properties,o=n.properties,null==n.containerIdx?[3,3]:(s=v.getContainerForInstance(u,n),l=C.PropertyPaneUtils.getCardContainerKey(c.name,n.containerIdx),l={name:l,displayName:C.ViewModelFactory.getDisplayName(s.displayName),value:l,selector:n.selector,containerIndex:n.containerIdx,isDisabled:!1,slices:jsCommon.ArrayExtensions.createWithName()},c.containers||(c.containers=jsCommon.ArrayExtensions.createWithName()),[4,M.createSlices(n,r,d,o,c,t,l.slices,l.displayName)])):[3,6];case 2:return e.sent(),c.containers.push(l),[3,5];case 3:return[4,M.createSlices(n,r,d,o,c,t,c.slices)];case 4:e.sent(),e.label=5;case 5:return i++,[3,1];case 6:return[2]}})})},M.createSlices=function(h,g,m,y,f,b,S,w){return __awaiter(this,void 0,V.Promise,function(){var t,i,a,n,r,o,s,l,c,u,p,d,v;return __generator(this,function(e){switch(e.label){case 0:for(n in r=m.visualWarningCollection&&m.visualWarningCollection.visualObjectWarnings,t=r&&r[f.name]||[],i=M.getPropertyWarning(t),a=[],y)a.push(n);r=0,e.label=1;case 1:return r<a.length?(o=a[r],s=g[o],M.canVisualizeProperty(s)?(d=h.selector?h.displayName:void 0,p=C.ViewModelFactory.getDisplayName(s.displayName),l=C.ViewModelFactory.getDisplayName(s.description),c=C.ViewModelFactory.getDisplayName(s.placeHolderText),u=o===P.ImageSliceName||o===P.MapSliceName?"":d||p||o,v=V.ValueType.fromDescriptor(s.type),[4,M.getSelectionOptions({propertyType:v,instance:h,propertyName:o,paneServices:m,visualType:m.visualType})]):[3,3]):[3,4];case 2:d=e.sent(),p=h.propertyTypes&&h.propertyTypes[o],v=M.getPropertyDescriptorType(s.type,p),p=M.getPropertyValue(y[o],d,v,o,m),"strictSingleSelect"===(p={name:o,displayName:u,description:l,type:v,selector:h.selector,altConstantValueSelector:h.altConstantValueSelector,value:p,show:M.getShowSliceValue(f,o,h),placeholder:c,isValid:!0,isDisabled:b||M.isSliceDisabled(f,o,v,m.disabledSliceTypes),containerIndex:h.containerIdx,save:m.save,selectionOptions:d}).name&&M.shouldDisableStrictSelectionDueToMappedColumn(m,p),h.propertyInstanceKind&&3===h.propertyInstanceKind[o]&&m.conditionalFormattingUtilsService.updateDynamicExpressionSupportForSlice(h,o,v,s,m.objectDefinitions,p,m.localizationService,t,m,f.displayName,p.selector?w:void 0),(d=M.getNumericValueOptionsFromValidValues(h,p)||C.PropertyPaneUtils.getNumericValueOptions(p))&&(p.numericValueOptions=d),M.configureValidators(h,p),o===C.PropertySliceNames.Show?(i&&(p.warningMessage=C.PropertyPaneUtils.getWarningMessage(i,m.localizationService,!0)),f.mainShow=p):S.push(p),y.refreshType===D.contracts.AutoPageRefreshOption.CDM&&"refreshType"===o&&C.ChangeDetectionPropertyPaneCardUtil.populateChangeDetectionPropertyPaneCard(m,S,b||M.isSliceDisabled(f,o,v,m.disabledSliceTypes)),d=x.getValue(m.objectDefinitions,{objectName:"dataPoint",propertyName:"fill"},{data:[V.data.DataViewWildcard.create(1)]}),(!!d||m.featureSwitchService&&m.featureSwitchService.featureSwitches.cartesianConditionalFormatting)&&h.propertyInstanceKind&&h.propertyInstanceKind[o]&&(1&(v=h.propertyInstanceKind[o])||(p.showLinkButtonOnly=!0),2===v&&m.conditionalFormattingDialogLauncher&&(2===v&&h.altConstantValueSelector,m.conditionalFormattingUtilsService.addDialogLauncherToSlice(m.promiseFactory,m,m.conditionalFormattingDialogLauncher,m.visualContainer,h,d,s,f,p))),e.label=3;case 3:return r++,[3,1];case 4:return i&&!f.mainShow&&(f.mainShow=M.createWarningPlaceHolderSlice(C.PropertyPaneUtils.getWarningMessage(i,m.localizationService,!0),h,m,b)),[2]}})})},M.shouldDisableStrictSelectionDueToMappedColumn=function(a,n){var r;return __awaiter(this,void 0,V.Promise,function(){var t,i;return __generator(this,function(e){switch(e.label){case 0:return t=a.dataSourcesService,i=a.conceptualSchemaProxy,t=t.get(),[4,i.get(t)];case 1:return(i=e.sent())?(!(t=null===(r=null===(r=null===(r=null===(r=null===(r=a.visualContainer)||void 0===r?void 0:r.config)||void 0===r?void 0:r.singleVisual)||void 0===r?void 0:r.query)||void 0===r?void 0:r.defn)||void 0===r?void 0:r.select())&&1<(null==t?void 0:t.length)||(t=t[0].expr,1!==(null==(i=l.getConceptualParameterMetadata(t,i))?void 0:i.kind)||null!=i&&i.supportsMultipleValues||(n.isDisabled=!0)),[2]):[2]}})})},M.getVisualObjectValidationOptionsFromValidValues=function(e,t){e=e.validValues;if(e&&e[t]&&!_.isArray(e[t])){t=e[t];if(t.numberRange&&_.isNumber(t.numberRange.max)&&_.isNumber(t.numberRange.min))return t}},M.getDurationPickerValidationOptionsFromValidValues=function(e,t){e=e.validValues;if(e&&e[t]&&!_.isArray(e[t])){t=e[t];if(t.durationRange)return t}},M.getNumericValueOptionsFromValidValues=function(e,t){var i=V.ValueType.fromDescriptor(t.type);if(i.integer||i.formatting&&i.formatting.fontSize){t=M.getVisualObjectValidationOptionsFromValidValues(e,t.name);if(t&&t.numberRange)return{minValue:t.numberRange.min,maxValue:t.numberRange.max,unitSymbol:t.unitSymbol||""}}},M.configureValidators=function(e,t){var i,a=V.ValueType.fromDescriptor(t.type);a.numeric?(i=M.getVisualObjectValidationOptionsFromValidValues(e,t.name))&&(t.validators=i.numberRange):a.duration&&(i=M.getDurationPickerValidationOptionsFromValidValues(e,t.name))&&(t.validators=i.durationRange)},M.addFooterSlicesToCard=function(e,t){var i,a=C.PropertySliceNames.RevertToDefault;_.some(e.footer,function(e){return e.name===a})||(e.name===C.PropertyCardNames.PersonalizeVisual&&e.footer.push({value:e.isDirty,name:C.PropertySliceNames.ApplyToAllPages,displayName:"",type:i={applyToAllPages:!0},show:!0,placeholder:"",isValid:!0,isDisabled:M.isSliceDisabled(e,C.PropertySliceNames.ApplyToAllPages,i,t.disabledSliceTypes),save:t.save}),e.footer.push({value:e.isDirty,name:a,displayName:"",type:i={revertToDefault:!0},show:!0,placeholder:"",isValid:!0,isDisabled:M.isSliceDisabled(e,a,i,t.disabledSliceTypes),save:t.save}))},M.getShowSliceValue=function(e,t,i){if(e.name===P.PlotAreaCardName&&i){i=i.properties[P.ImageSliceName];if(i&&(t===P.ImageFitSliceName||t===P.TransparencySliceName))return null!=i.url}return!0},M.populateGradientCard=function(e,t,i,a,n){t=s.getFillRule(t);t&&(n=M.createGradientCard(e,t,i,a,n),e.cards.push(n),M.addFooterSlicesToCard(n,a))},M.createGradientCard=function(e,t,i,a,n){var r=(r=e.cards.withName(C.PropertyCardNames.Gradient))||{name:C.PropertyCardNames.Gradient,id:C.PropertyPaneUtils.getUniqueIdFromKeys(a.visualType,C.PropertyCardNames.Gradient),index:n,displayName:C.ViewModelFactory.getDisplayName(o("Visual_DataPoint")),description:C.ViewModelFactory.getDisplayName(o("Visual_DataPointDescription")),slices:jsCommon.ArrayExtensions.createWithName(),footer:[],mainShow:null,isDirty:i},e=a.itemPicker.getDataColors().getGradientColors(),n=s.getGradientSettings(t),i="diverging",t={bool:!0};return r.slices.push({value:n.diverging,name:"diverging",displayName:C.ViewModelFactory.getDisplayName(o("Visual_Gradient_Diverging")),description:C.ViewModelFactory.getDisplayName(o("Visual_Gradient_DivergingDescription")),type:t,show:!0,placeholder:"",isValid:!0,save:a.save,isDisabled:M.isSliceDisabled(r,"diverging",t,a.disabledSliceTypes)}),i="gradientBar",t={none:!0},r.slices.push({value:s.getGradientBarColors(n,e),name:"gradientBar",displayName:"gradientBar",type:t,show:!0,placeholder:"",isValid:!0,save:a.save,isDisabled:M.isSliceDisabled(r,"gradientBar",t,a.disabledSliceTypes)}),t={fill:{solid:{color:!0}}},r.slices.push({value:{value:n.minColor||e.minColor.value},name:i="minColor",displayName:C.ViewModelFactory.getDisplayName(o("Visual_Gradient_MinColor")),description:C.ViewModelFactory.getDisplayName(o("Visual_Gradient_MinColorDescription")),type:t,show:!0,placeholder:"",isValid:!0,save:a.save,isDisabled:M.isSliceDisabled(r,"minColor",t,a.disabledSliceTypes)}),r.slices.push({value:{value:n.midColor||e.midColor.value},name:i="midColor",displayName:C.ViewModelFactory.getDisplayName(o("Visual_Gradient_MidColor")),description:C.ViewModelFactory.getDisplayName(o("Visual_Gradient_MidColorDescription")),type:{fill:{solid:{color:!0}}},show:n.diverging,placeholder:"",isValid:!0,save:a.save,isDisabled:!n.diverging}),t={fill:{solid:{color:!0}}},r.slices.push({value:{value:n.maxColor||e.maxColor.value},name:i="maxColor",displayName:C.ViewModelFactory.getDisplayName(o("Visual_Gradient_MaxColor")),description:C.ViewModelFactory.getDisplayName(o("Visual_Gradient_MaxColorDescription")),type:t,show:!0,placeholder:"",isValid:!0,save:a.save,isDisabled:M.isSliceDisabled(r,"maxColor",t,a.disabledSliceTypes)}),t={numeric:!0},r.slices.push({value:n.minValue,name:i="minValue",displayName:C.ViewModelFactory.getDisplayName(o("Visual_Gradient_MinValue")),description:C.ViewModelFactory.getDisplayName(o("Visual_Gradient_MinValueDescription")),type:t,show:!0,placeholder:"",isValid:!0,save:a.save,isDisabled:M.isSliceDisabled(r,"minValue",t,a.disabledSliceTypes)}),r.slices.push({value:n.midValue,name:i="midValue",displayName:C.ViewModelFactory.getDisplayName(o("Visual_Gradient_MidValue")),description:C.ViewModelFactory.getDisplayName(o("Visual_Gradient_MidValueDescription")),type:{numeric:!0},show:n.diverging,placeholder:"",isValid:!0,save:a.save,isDisabled:!n.diverging}),t={numeric:!0},r.slices.push({value:n.maxValue,name:i="maxValue",displayName:C.ViewModelFactory.getDisplayName(o("Visual_Gradient_MaxValue")),description:C.ViewModelFactory.getDisplayName(o("Visual_Gradient_MaxValueDescription")),type:t,show:!0,placeholder:"",isValid:!0,save:a.save,isDisabled:M.isSliceDisabled(r,i,t,a.disabledSliceTypes)}),r},M.isFillProperty=function(e){return null!=e.fill},M.isSliceDisabled=function(e,t,i,a){return null!=e.mainShow&&!1===e.mainShow.value&&!M.isSliceAlwaysEnabled(t)||!(null==a||!a.some(function(e){return!!i[e]}))},M.isSliceAlwaysEnabled=function(e){switch(e){case C.PropertySliceNames.Show:case C.PropertySliceNames.SecShow:case C.PropertySliceNames.RevertToDefault:case P.SliceNameStart:case P.SliceNameEnd:case P.SliceNameInvertAxis:case P.SliceNameSecStart:case P.SliceNameSecEnd:case P.SliceNameSecInvertAxis:case C.PropertySliceNames.ShowAxisTitle:case C.PropertySliceNames.SecShowAxisTitle:case C.PropertySliceNames.ApplyToAllPages:return!0;default:return!1}},M.addValidation=function(e,t){for(var i=0,a=e.cards;i<a.length;i++){var n=a[i];switch(n.name){case C.PropertyCardNames.DataBars:case C.PropertyCardNames.CategoryAxis:case C.PropertyCardNames.ValueAxis:M.setAxisValidationLimitations(n);break;case C.PropertyCardNames.General:M.setGeneralValidationLimitations(n,t);break;default:for(var r=0,o=n.slices;r<o.length;r++){var s=o[r];M.setSliceValidation(s)}}if(!_.isEmpty(n.containers))for(var l=0,c=n.containers;l<c.length;l++)for(var u=0,p=c[l].slices;u<p.length;u++){s=p[u];M.setSliceValidation(s)}}return e},M.setSliceValidation=function(e){var t=V.ValueType.fromDescriptor(e.type);t.misc&&t.misc.webUrl&&(e.validators||(e.validators={}),e.validators.url=!0),(t.numeric||t.integer||t.dateTime)&&"indicatorPrecision"===e.name&&(e.validators={max:P.MaxPrecision})},M.setGeneralValidationLimitations=function(e,t){for(var i=0,a=e.slices;i<a.length;i++){var n=a[i],r=n.name;switch(n.validators={},r){case C.GeneralPropertyNames.Width:var o=e.slices.withName(C.GeneralPropertyNames.X),o=parseFloat(o.value);n.validators.max=t.width-o,n.validators.min=P.MinContainerWidth,n.validators.integer=!0,n.validators.required=!0;break;case C.GeneralPropertyNames.Height:o=e.slices.withName(C.GeneralPropertyNames.Y),o=parseFloat(o.value);n.validators.max=t.height-o,n.validators.min=P.MinContainerHeight,n.validators.integer=!0,n.validators.required=!0;break;case C.GeneralPropertyNames.X:var s=e.slices.withName(C.GeneralPropertyNames.Width),s=parseFloat(s.value);n.validators.max=t.width-s,n.validators.min=0,n.validators.integer=!0,n.validators.required=!0;break;case C.GeneralPropertyNames.Y:s=e.slices.withName(C.GeneralPropertyNames.Height),s=parseFloat(s.value);n.validators.max=t.height-s,n.validators.min=0,n.validators.integer=!0,n.validators.required=!0}}},M.setAxisValidationLimitations=function(e){for(var t=0,i=e.slices;t<i.length;t++){var a=i[t],n=a.name;if(_.includes(M.SliceRangeNames,n)){var r=V.ValueType.fromDescriptor(a.type);a.validators={};for(var o=0,s=e.slices;o<s.length;o++){var l,c=s[o];n===P.SliceNameStart&&c.name===P.SliceNameEnd||n===P.SliceNameSecStart&&c.name===P.SliceNameSecEnd||n===P.SliceNameAxisStart&&c.name===P.SliceNameAxisEnd?r.dateTime?a.validators.max=c.value:(l=parseFloat(c.value),a.validators.max=_.isFinite(l)?l:void 0,a.validators.decimal=!0):(n===P.SliceNameEnd&&c.name===P.SliceNameStart||n===P.SliceNameSecEnd&&c.name===P.SliceNameSecStart||n===P.SliceNameAxisEnd&&c.name===P.SliceNameAxisStart)&&(r.dateTime?a.validators.min=c.value:(l=parseFloat(c.value),a.validators.min=_.isFinite(l)?l:void 0,a.validators.decimal=!0))}}else M.setSliceValidation(a)}},M.getPropertyDescriptorType=function(e,t){var i=V.ValueType.fromDescriptor(e);if(!i.variant)return e;for(var a=V.ValueType.fromDescriptor(t),n=0,r=i.variant;n<r.length;n++){var o=r[n];if(a.isCompatibleFrom(o))return t}},M.getPropertyValue=function(e,t,i,a,n){return null==e?e:t?C.PropertyPaneUtils.getValidSelectionValue(t,e):!i.numeric||_.isFinite(parseFloat(e))?(M.isFillProperty(i)&&(t=e&&e.solid?e.solid.color:e,e={value:r.ensureValidHex(t&&t.toString())}),i.formatting&&i.formatting.stylePreset&&(n.visualType,e={visualType:n.visualType,stylePresetName:e}),e):void 0},M.getPropertyWarning=function(e){for(var t=0,i=e;t<i.length;t++){var a=i[t];if(a&&a.warnings)for(var n=0,r=a.warnings;n<r.length;n++)return r[n]}},M.createWarningPlaceHolderSlice=function(e,t,i,a){var n="warningPlaceHolder";return{name:n,displayName:"",type:null,selector:t.selector,value:"",show:!0,placeholder:n,isValid:!0,isDisabled:a,containerIndex:t.containerIdx,save:i.save,warningMessage:e}},M.SliceRangeNames=[P.SliceNameAxisStart,P.SliceNameAxisEnd,P.SliceNameStart,P.SliceNameEnd,P.SliceNameSecStart,P.SliceNameSecEnd],M);function M(){}C.PropertyPaneViewModelFactory=i})((D=V.explore||(V.explore={})).viewModels||(D.viewModels={}))}(powerbi=powerbi||{}),function(w){var f,e,t,C,b,S,P,x,M,V,D,N,F,E;f=w.explore||(w.explore={}),e=f.viewModels||(f.viewModels={}),P=jsCommon.ArrayExtensions,x=w.explore.contracts.AutoPageRefreshOption,M=w.explore.contracts,V=f.constants.ExploreCanvasConstants,D=M.SectionPageSizeTypes.PageSizeTypes,N=f.util.PropertyPaneUtils,F=e.PropertyPaneViewModelFactory,E=jsCommon.TextSizeDefaults,(t=e.PagePropertyPaneConsts||(e.PagePropertyPaneConsts={})).DisplayAreaName="displayArea",t.PageRefreshCardName="pageRefresh",t.PageSizeCardName="pageSize",t.PageSizeTypeName="pageSizeTypes",t.PageSizeWidthName="pageSizeWidth",t.PageSizeHeightName="pageSizeHeight",t.PageBackgroundColor="color",t.PageInformationCardName="pageInformation",t.PageInformationName="pageInformationName",t.PageInformationQnaPodEnabled="pageInformationQnaPodEnabled",t.PageInformationAltName="pageInformationAltName",t.PageInformationType="pageInformationType",t.PageBackgroundImage="image",t.PageBackgroundTransparency="transparency",t.PageBackgroundRevertToDefault="revertToDefault",t.PageBackgroundCardName="background",t.OutspaceBackgroundCardName="outspace",t.OutspacePaneCardName="outspacePane",t.FilterCardName="filterCard",t.PageSizeUnits={Pixels:"px"},t.PersonalizeVisual="personalizeVisual",t=e.PagePropertyPaneViewModelFactory||(e.PagePropertyPaneViewModelFactory={}),C=e.PagePropertyPaneConsts,b=1,S=9999,t.populatePaneForPage=function(h,g,m,y){return __awaiter(this,void 0,w.Promise,function(){var s,l,c,u,p,d,v;return __generator(this,function(e){switch(e.label){case 0:return s=g.localizationService,l=g.linguisticSchemaProxy,c=g.explorationNavigation,v=g.promiseFactory,u=g.themeService,p={cards:P.createWithName()},d=0,[4,function(n,r,o,s,l,c,u){return __awaiter(this,void 0,w.Promise,function(){var t,i,a;return __generator(this,function(e){switch(e.label){case 0:return(t=n.cards.withName(C.PageInformationCardName))?[3,2]:(t={name:C.PageInformationCardName,id:C.PageInformationCardName,index:u,displayName:r.get("PagePropertyPane_PageInformation"),slices:jsCommon.ArrayExtensions.createWithName(),footer:[],mainShow:null,isDirty:!1},i={name:C.PageInformationName,displayName:r.get("Name"),type:{text:!0},selector:null,value:c.displayName,show:!0,placeholder:"",isValid:!0,isDisabled:!1,validators:{required:!0}},t.slices.push(i),a={name:C.PageInformationType,displayName:r.get("Tooltip"),type:{bool:!0},selector:null,value:!!(1&c.type),show:!0,description:r.get("PagePropertyPane_PageInformation_Tooltip_Description"),placeholder:"",isValid:!0,isDisabled:!1},t.slices.push(a),i=s.getCurrentExploration(),[4,f.PodUtils.getLinguisticMetadata(i,c.name,o,l)]);case 1:a=e.sent(),i={name:C.PageInformationQnaPodEnabled,displayName:r.get("Generic_Qna"),type:{bool:!0},selector:null,value:!!a,show:!0,description:r.get("PagePropertyPane_PageInformation_PodEnabled_Description"),placeholder:"",isValid:!0,isDisabled:!1},t.slices.push(i),a&&(a={name:C.PageInformationAltName,displayName:"",type:{formatting:{altText:!0}},selector:null,value:a.altNames?a.altNames.join(", "):"",show:!0,placeholder:r.get("PagePropertyPane_PageInformation_AltName_Placeholder"),isValid:!0,isDisabled:!1},t.slices.push(a)),n.cards.push(t),e.label=2;case 2:return[2]}})})}(p,s,l,c,v,h,d++)];case 1:return e.sent(),t=h,a=s,n=c,r=d++,(o=(i=p).cards.withName(C.PageSizeCardName))||(o={name:C.PageSizeCardName,id:C.PageSizeCardName,index:r,displayName:a.get("PagePropertyPane_PageSize"),slices:jsCommon.ArrayExtensions.createWithName(),footer:[],mainShow:null,isDirty:!1},r=function(e,t,i){var a=N.getPageSizeType(e.size,i),n=[{value:D.Widescreen,displayName:t.get("PagePropertyPane_PageSizeType_Widescreen")},{value:D.Standard,displayName:t.get("PagePropertyPane_PageSizeType_Standard")},{value:D.Letter,displayName:t.get("PagePropertyPane_PageSizeType_Letter")},{value:D.Tooltip,displayName:t.get("Tooltip")},{value:D.Custom,displayName:t.get("Custom")}];a===D.Dynamic&&n.unshift({value:D.Dynamic,displayName:t.get("PagePropertyPane_PageSizeType_Dynamic")});return{name:C.PageSizeTypeName,displayName:t.get("Type"),type:{},value:N.getPageSizeType(e.size,i),show:!0,placeholder:"",isDisabled:!1,isValid:!0,selectionOptions:n}}(t,a,n),o.slices.push(r),n={name:C.PageSizeWidthName,displayName:a.get("PagePropertyPane_PageSizeWidth"),type:{numericUnitSelection:!0},value:{value:t.size.width,unitOfMeasurement:C.PageSizeUnits.Pixels},show:!0,placeholder:"",isDisabled:r.value!==D.Custom,isValid:!0,selectionOptions:[{value:C.PageSizeUnits.Pixels,displayName:a.get("Generic_Pixels")}],validators:{min:b,max:S}},o.slices.push(n),a={name:C.PageSizeHeightName,displayName:a.get("PagePropertyPane_PageSizeHeight"),type:{numericUnitSelection:!0},value:{value:t.size.height,unitOfMeasurement:C.PageSizeUnits.Pixels},show:!0,placeholder:"",isDisabled:r.value!==D.Custom,isValid:!0,selectionOptions:[{value:C.PageSizeUnits.Pixels,displayName:a.get("Generic_Pixels")}],validators:{min:b,max:S}},o.slices.push(a),i.cards.push(o)),v=u.getVisualStyle(c.getCurrentExploration().themeCollection),[2,function(h,g,m,y,f,b,S){return __awaiter(this,void 0,w.Promise,function(){var t,i,s,l,c,a,n,u,r,o,p,d,v=this;return __generator(this,function(e){switch(e.label){case 0:return t=m.promiseFactory,i=m.undoRedo,s=m.explorationNavigation,l=m.featureSwitchService,c=m.localizationService,a=m.itemPicker,n=m.conceptualSchemaProxy,u=m.dataSources,r=m.changeDetectionMeasure,o=m.explorationCapabilities,d=m.telemetryService,p=m.perspectivesService,d={objectDefinitions:g.objects,objectDescriptors:M.Section.objectDescriptors,promiseFactory:t,undoRedo:i,enumerateObjectInstances:function(o){return __awaiter(v,void 0,w.Promise,function(){var n,r;return __generator(this,function(e){switch(e.label){case 0:return(n=s.getCurrentExploration(),o===C.OutspacePaneCardName)?[2,function(e,t){e=e.evaluatedObjects&&e.evaluatedObjects.outspacePane,t={selector:null,properties:{backgroundColor:e&&null!=e.backgroundColor?e.backgroundColor:{solid:{color:t.colorPalette.background.value}},transparency:e&&null!=e.transparency?e.transparency:V.DefaultOutspacePaneTransparency,foregroundColor:e&&null!=e.foregroundColor?e.foregroundColor:{solid:{color:t.colorPalette.foreground.value}},titleSize:e&&null!=e.titleSize?e.titleSize:V.DefaultOutspacePaneTitleSizePt,headerSize:e&&null!=e.headerSize?e.headerSize:V.DefaultOutspacePaneHeaderSizePt,fontFamily:e&&null!=e.fontFamily?e.fontFamily:V.DefaultOutspacePaneFontFamily,border:e&&null!=e.border?e.border:V.DefaultOutspacePaneBorder,borderColor:e&&null!=e.borderColor?e.borderColor:{solid:{color:V.DefaultOutspacePaneBorderColor}},width:e&&null!=e.width?e.width:V.DefaultOutspacePaneWidth,checkboxAndApplyColor:e&&null!=e.checkboxAndApplyColor?e.checkboxAndApplyColor:{solid:{color:V.DefaultOutspacePaneCheckboxAndApplyColor}}},validValues:{titleSize:{numberRange:{min:E.TextSizeMin,max:E.TextSizeMax},unitSymbol:"Slider_Weight"},headerSize:{numberRange:{min:E.TextSizeMin,max:E.TextSizeMax},unitSymbol:"Slider_Weight"},width:{numberRange:{min:V.OutspacePaneMinWidth,max:V.OutspacePaneMaxWidth},unitSymbol:"Numeric_Pixel"}},objectName:"outspacePane"};return t.properties.searchTextSize=e&&null!=e.searchTextSize?e.searchTextSize:V.DefaultOutspaceSearchTextSizePt,t.properties.inputBoxColor=e&&null!=e.inputBoxColor?e.inputBoxColor:e&&null!=e.backgroundColor?e.backgroundColor:{solid:{color:V.FilterCardSearchBoxBackgroundColor}},t.validValues.searchTextSize={numberRange:{min:E.TextSizeMin,max:E.TextSizeMax},unitSymbol:"Slider_Weight"},[t]}(g,y)]:o===C.FilterCardName?[2,(i=y,t=(a=(t=g).evaluatedObjects&&t.evaluatedObjects.filterCard)&&a.$instances&&a.$instances[V.Available],a=a&&a.$instances&&a.$instances[V.Applied],{instances:[{selector:{id:V.Available},properties:{backgroundColor:t&&null!=t.backgroundColor?t.backgroundColor:{solid:{color:i.colorPalette.background.value}},transparency:t&&null!=t.transparency?t.transparency:V.DefaultAvailableFilterCardTransparency,border:t&&null!=t.border?t.border:V.DefaultFilterCardBorder,borderColor:t&&null!=t.borderColor?t.borderColor:{solid:{color:V.DefaultFilterCardBorderColor}},foregroundColor:t&&null!=t.foregroundColor?t.foregroundColor:{solid:{color:i.colorPalette.foreground.value}},textSize:t&&null!=t.textSize?t.textSize:V.DefaultFilterCardTextSizePt,fontFamily:t&&null!=t.fontFamily?t.fontFamily:V.DefaultOutspacePaneFontFamily,inputBoxColor:t&&null!=t.inputBoxColor?t.inputBoxColor:{solid:{color:V.DefaultControlBackgroundColor}}},validValues:{textSize:{numberRange:{min:E.TextSizeMin,max:E.TextSizeMax},unitSymbol:"Slider_Weight"}},objectName:"filterCard",containerIdx:0},{selector:{id:V.Applied},properties:{backgroundColor:a&&null!=a.backgroundColor?a.backgroundColor:{solid:{color:i.colorPalette.backgroundLight.value}},transparency:a&&null!=a.transparency?a.transparency:V.DefaultAppliedFilterCardTransparency,border:a&&null!=a.border?a.border:V.DefaultFilterCardBorder,borderColor:a&&null!=a.borderColor?a.borderColor:{solid:{color:V.DefaultFilterCardBorderColor}},foregroundColor:a&&null!=a.foregroundColor?a.foregroundColor:{solid:{color:i.colorPalette.foreground.value}},textSize:a&&null!=a.textSize?a.textSize:V.DefaultFilterCardTextSizePt,fontFamily:a&&null!=a.fontFamily?a.fontFamily:V.DefaultOutspacePaneFontFamily,inputBoxColor:a&&null!=a.inputBoxColor?a.inputBoxColor:{solid:{color:V.DefaultControlBackgroundColor}}},validValues:{textSize:{numberRange:{min:E.TextSizeMin,max:E.TextSizeMax},unitSymbol:"Slider_Weight"}},objectName:"filterCard",containerIdx:1}],containerInfo:{containersLabel:w.data.createDisplayNameGetter("Type"),containersTooltip:w.data.createDisplayNameGetter("PagePropertyPane_FilterCards_CardTypeTooltip")},containers:[{displayName:w.data.createDisplayNameGetter("PagePropertyPane_FilterCards_Available")},{displayName:w.data.createDisplayNameGetter("PagePropertyPane_FilterCards_Applied")}]})]:o===C.DisplayAreaName?[2,function(e,t){e=e.evaluatedObjects&&e.evaluatedObjects.displayArea,e=e&&e.verticalAlignment;void 0===e&&(e=t&&t.evaluatedObjects&&t.evaluatedObjects.section&&t.evaluatedObjects.section.verticalAlignment);void 0===e&&(e=M.SectionAlignmentPosition.middle);return[{selector:null,properties:{verticalAlignment:e},objectName:C.DisplayAreaName}]}(g,n)]:o===C.PageBackgroundCardName||o===C.OutspaceBackgroundCardName?[2,function(e,t){var i,a,t=t.evaluatedObjects&&t.evaluatedObjects[e];switch(e){case C.OutspaceBackgroundCardName:i=V.DefaultCanvasOutspaceColor,a=V.DefaultCanvasOutspaceTransparency;break;case C.PageBackgroundCardName:i=V.DefaultCanvasBackgroundColor,a=V.DefaultCanvasBackgroundTransparency}return[{selector:null,properties:{color:t&&null!=t.color?t.color:{solid:{color:i}},transparency:t&&null!=t.transparency?t.transparency:a,image:t&&t.image},objectName:e}]}(o,g)]:!l.featureSwitches.realTimeRefreshDisabled&&o===C.PageRefreshCardName&&_.some(S,function(e){return e.supportsFastRefresh})?(r=_.some(S,function(e){return e.supportChangeDetectionMeasureRefresh}),[2,function(e,t){var i=e.evaluatedObjects&&e.evaluatedObjects.pageRefresh||{show:!1,duration:V.DefaultTimeInterval,refreshType:x.APR},a=i.show||!1,e=i.duration||V.DefaultTimeInterval,i=i.refreshType||x.APR;t||(i=x.APR);i=i===x.APR?{show:a,refreshType:i,duration:e}:{show:a,refreshType:i};t=t?[x.APR,x.CDM]:[x.APR];return[{selector:null,properties:i,validValues:{duration:{durationRange:{min:"PT1S",max:"P24D",integer:!0}},refreshType:{filterValues:t}},objectName:C.PageRefreshCardName}]}(g,r)]):o!==C.PersonalizeVisual?[3,2]:(n=m.explorationCapabilities.getCapabilities().disableInlineExplore,r=m.explorationNavigation&&m.explorationNavigation.getCurrentExploration(),r=r&&r.settings&&r.settings.allowInlineExploration,!n&&r?[4,function(a,n,r,o){var s;return __awaiter(this,void 0,w.Promise,function(){var t,i;return __generator(this,function(e){switch(e.label){case 0:return t=null===(s=null===(s=a.evaluatedObjects)||void 0===s?void 0:s.personalizeVisual)||void 0===s?void 0:s.perspectiveRef,[4,F.getPerspectives(n,r,o)];case 1:return i=e.sent(),[2,[{selector:null,properties:{perspectiveRef:(null==(i=null!=t&&_.find(i,function(e){return e.value===t}))?void 0:i.value)||"",show:null===(s=null===(s=null===(s=null==a?void 0:a.evaluatedObjects)||void 0===s?void 0:s.personalizeVisual)||void 0===s?void 0:s.show)||void 0===s||s},objectName:C.PersonalizeVisual}]]}})})}(g,u,p,c)]:[3,2]);case 1:return[2,e.sent()];case 2:return[2]}var t,i,a})})},localizationService:c,itemPicker:a,visualStyle:y,cardIndexCounter:f,selectedContainers:b,conceptualSchemaProxy:n,dataSourcesService:u,changeDetectionMeasure:r,explorationCapabilities:o,telemetryService:d,perspectivesService:p,featureSwitchService:l},[4,F.populatePane(h,d)];case 1:return[2,e.sent()]}})})}(p,h,g,v,d,m,y)]}var t,i,a,n,r,o})})}}(powerbi=powerbi||{}),define("ExploreUIShell/components/analyticsPane/analyticsPaneController",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AnalyticsPaneController=void 0;var l=powerbi.explore.contracts,i=powerbi.data,a=powerbi.explore.services,n=powerbi.explore.util,c=powerbi.explore.viewModels,u=powerbi.visuals.AnomalyDetectionObjectConstants,p=n.AnomalyDetectionValidator,r=a.events,d=powerbi.visuals.ReferenceLineHelper,v=a.selectionUtils,h=i.SQExpr,g=i.SQExprUtils,m=n.VisualContainerUtils,n=(o.createOptions=function(){return{additionalServices:["$timeout","promiseFactory","telemetryService","conceptualSchemaProxy","localizationService","featureSwitchService","conditionalFormattingUtilsService"],scopedDependencies:["dataSources","eventBridge","explorationDisplayNameService","lazyScoped","selection","visualPlugin","runningVisuals","visualAuthoring","undoRedo"]}},o.prototype.$onDestroy=function(){this.subscriptionManager.unsubscribeAll()},Object.defineProperty(o.prototype,"hasCards",{get:function(){return _.some(this.cards,function(e){return!e.filtered})},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"hasFilter",{get:function(){return!(""===this.filter||null==this.filter)},enumerable:!1,configurable:!0}),o.prototype.triggerUpdate=function(){this.bindToVisualContainer(v.getDefaultSelectedVisualInSingleOrMultiCase(this.services.selection))},o.prototype.onVisualDataRendered=function(e){var t=this;e===v.getSelectedVisual(this.services.selection)&&this.services.$timeout(function(){e===v.getSelectedVisual(t.services.selection)&&t.bindToVisualContainer(e)})},o.prototype.bindToVisualContainer=function(s){return __awaiter(this,void 0,powerbi.Promise,function(){var i,t,a,n,r,o=this;return __generator(this,function(e){switch(e.label){case 0:return this.visualContainer=null,s&&l.isVisualContainer(s)&&this.services.runningVisuals.getVisual(s)&&!v.hasMultipleVisualContainerSelection(this.services.selection)?[4,this.getConceptualSchema(s)]:[3,4];case 1:return(i=e.sent()).visualContainer!==s?(this.cards=[],[2]):(this.validMeasures=this.getValidMeasures(i.visualContainer,i.schema),t=s.config.singleVisual,a=function(e,t){if(!t||2!==t)return{shouldInclude:!1};switch(e){case"referenceLine":if(_.isEmpty(o.validMeasures))return{shouldInclude:!1};break;case"forecast":if(!o.querySupportsForecasting(i.visualContainer,i.schema))return{shouldInclude:!1};break;case u.capabilityObjectName:return o.services.featureSwitchService.featureSwitches.daxTransformEnabled?p.querySupportsAnomalyDetection(i.visualContainer,i.schema,o.services.localizationService):{shouldInclude:!1}}return{shouldInclude:!0}},n=this.services.runningVisuals.getVisual(s),[4,this.services.lazyScoped("conditionalFormattingDialogLauncherService")]);case 2:return r=e.sent(),r={conditionalFormattingDialogLauncher:r,conditionalFormattingUtilsService:this.services.conditionalFormattingUtilsService,featureSwitchService:this.services.featureSwitchService,localizationService:this.services.localizationService,objectDefinitions:t.objects,promiseFactory:this.services.promiseFactory,visualAuthoring:this.services.visualAuthoring,visualContainer:s,visualPlugin:this.services.visualPlugin,visualWarningCollection:null==n?void 0:n.getWarnings(),undoRedo:this.services.undoRedo},this.visualContainer=s,[4,c.AnalyticsPaneViewModelFactory.populatePaneForVisual(n,t,r,a,this.services.promiseFactory,this.validMeasures)];case 3:return r=e.sent(),this.cards=r.cards,c.AnalyticsPaneViewModelFactory.applyFilter(this.cards,this.filter),this.services.telemetryService.logEvent(powerbi.telemetry.EXAnalyticsPaneOpen,{hasContent:this.hasCards,visualType:t.visualType}),[3,5];case 4:this.cards=[],e.label=5;case 5:return[2]}})})},o.prototype.getValidMeasures=function(e,r){if(!(e&&e.config&&e.config.singleVisual&&e.config.singleVisual.query))return[];var o=e.config.singleVisual,s=[],l=this.services.visualPlugin.capabilities(o.visualType);if(!l||!l.objects)return[];l.objects[d.y1AxisRefLineObjectName]&&s.push(1),l.objects[d.xAxisRefLineObjectName]&&s.push(0);for(var c=[],e=m.getDataRolesForVisual(e,this.services.visualPlugin)||[],t=function(t){if(_.some(s,function(e){return e===t.cartesianKind}))for(var e=o.query.tryGetExprs(t.name)||[],a=o.query.defn.select(),i=0,n=e;i<n.length;i++)!function(t){if(!g.isMeasure(t))return;var e=_.find(a,function(e){return h.equals(t,e.expr)}),i=u.services.explorationDisplayNameService.getDisplayName(t,r,l,e.name,o.columnProperties);c.push({displayName:i,value:e.name,selectExpr:e})}(n[i])},u=this,i=0,a=e;i<a.length;i++)t(a[i]);return c},o.prototype.getConceptualSchema=function(t){var e=this.services.dataSources.get();return this.services.conceptualSchemaProxy.get(e).then(function(e){return{schema:e,visualContainer:t}})},o.prototype.querySupportsForecasting=function(e,t){if(!m.getVisualQuery(e))return!1;e=m.getSelectExprs(e);return _.every(e,function(e){return g.isExprValidForAnalysisTransform(e.expr)&&!e.expr.hasGroupOnKeys(t)})},o);function o(e,t){var i=this;this.services=t,this.cards=[],this.scrollbarsConfig={ignoreOverlay:!1,ignoreMobile:!1},this.subscriptionManager=this.services.eventBridge.createChannelSubscriptionManager().subscribe(r.selectionChanged,function(){return i.triggerUpdate()}).subscribe(r.visualTypeChanged,function(){return i.triggerUpdate()}).subscribe(r.visualContainerDataRendered,function(e,t){return i.onVisualDataRendered(t)}),this.triggerUpdate()}t.AnalyticsPaneController=n}),define("ExploreUIShell/components/analyticsPane/analyticsPane",["require","exports","ExploreUIShell/components/analyticsPane/analyticsPaneController"],function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.AnalyticsPane=void 0;var a=powerbi.common.createController;t.AnalyticsPane={templateUrl:"components/analyticsPane/analyticsPane.html",bindings:{},controller:a(i.AnalyticsPaneController)}}),function(S){var e,w,h,g,C,u;function p(e,t,i,a){return!!e&&(e.filtered=w.PropertyPaneUtils.filterSlices(e.slices,t,i,a),a&&e.filtered)}function m(d,v,h,g,m,y,f,b){return __awaiter(this,void 0,S.Promise,function(){var a,n,r,o,s,l,c,u,p;return __generator(this,function(e){switch(e.label){case 0:for(s in a=d.properties,n=f?null:d.selector,u=a.displayName,r={slices:[],displayName:_.isString(u)?u:y.displayName,selector:n},"referenceLine"===g&&P(r,m,f,b),o=[],a)o.push(s);l=0,e.label=1;case 1:return l<o.length?(c=o[l],p=a[c],u=h[c],t=c,i=u,"referenceLine"===g&&"value"===t||"displayName"===t||"type"===t||"show"===t||!w.PropertyPaneViewModelFactory.canVisualizeProperty(i)?[3,3]:[4,function(u,p,d,v,h,g,m,y){var f;return __awaiter(this,void 0,S.Promise,function(){var i,a,n,r,o,s,l,c;return __generator(this,function(e){switch(e.label){case 0:return u.selector&&(i=u.displayName),o=w.ViewModelFactory.getDisplayName(d.displayName),a=w.ViewModelFactory.getDisplayName(d.description),n=w.ViewModelFactory.getDisplayName(d.placeHolderText),r=i||o||h,[4,w.PropertyPaneViewModelFactory.getSelectionOptions({propertyType:S.ValueType.fromDescriptor(d.type),instance:u,propertyName:h})];case 1:return(l=e.sent())&&(g=w.PropertyPaneUtils.getValidSelectionValue(l,g)),s=u.propertyTypes&&u.propertyTypes[h],o=w.PropertyPaneViewModelFactory.getPropertyDescriptorType(d.type,s),(s=d.type.variant)&&(o=__assign(__assign({},o),{variant:s})),(l={name:h,displayName:r,description:a,type:o,selector:u.selector,value:g&&g.solid&&d.type.fill&&"color"!==h?g.solid.color:g,show:!0,placeholder:n,isValid:!0,isDisabled:y,containerIndex:u.containerIdx,selectionOptions:l,save:w.AnalyticsCardHelper.saveAnalyticsCardAction}).type.fill&&(l.value={value:l.value}),3===(null===(f=u.propertyInstanceKind)||void 0===f?void 0:f[h])&&(c=(null===(f=null===(f=p.visualWarningCollection)||void 0===f?void 0:f.visualObjectWarnings)||void 0===f?void 0:f[v])||[],p.conditionalFormattingUtilsService.updateDynamicExpressionSupportForSlice(u,h,o,d,p.objectDefinitions,l,p.localizationService,c,p,m)),(c=w.PropertyPaneUtils.getNumericValueOptions(l))&&(l.numericValueOptions=c),l.isPropertyTitleWidthStretch=w.PropertyPaneUtils.isPropertyTitleWidthStretch(l),(t=l).name===C.dataLabelDecimalPoints&&(t.validators={max:w.PropertyPaneConsts.MaxPrecision}),[2,l]}var t})})}(d,v,u,g,c,p,r.displayName,f)]):[3,4];case 2:p=e.sent(),r.slices.push(p),e.label=3;case 3:return l++,[3,1];case 4:return f?y.defaultInstance=r:y.instances.push(r),r.slices.push({value:"",name:"revertToDefault",displayName:"",type:{revertToDefault:!0},selector:n,show:!0,placeholder:"",isValid:!0,isDisabled:f}),[2]}var t,i})})}function P(e,t,i,a){var n=t.objects,r=t.query.defn.select(),t=S.data.DataViewObjectDefinitions.getValue(n,{objectName:"referenceLine",propertyName:"value"},e.selector),n={displayName:S.common.getLocalize().get("Visual_Reference_Line_Measure"),name:"measure",show:!0,isDisabled:i,isValid:!0,placeholder:S.common.getLocalize().get("Visual_Reference_Line_Measure_Default"),value:void 0,selectionOptions:a,selector:e.selector,type:{enumeration:S.createEnumType([])}};e.slices.push(n),t&&(a=void 0,(S.data.SQExpr.isAggregation(t)||S.data.SQExpr.isPercentile(t))&&(a=t.arg)&&(a=r.withName(a.expressionName),n.value=a?a.name:void 0,!i&&S.data.SQExpr.isPercentile(t)?(e.type=w.ReferenceLineType.Percentile,(i={displayName:S.common.getLocalize().get("Visual_Reference_Line_Percentile"),name:"percentile",show:!0,isDisabled:!1,isValid:!0,placeholder:void 0,value:100*t.k,selector:e.selector,type:{numeric:!0}}).numericValueOptions=w.PropertyPaneUtils.getNumericValueOptions(i),i.isPropertyTitleWidthStretch=w.PropertyPaneUtils.isPropertyTitleWidthStretch(i),e.slices.push(i)):S.data.SQExpr.isMinAggregation(t)?e.type=w.ReferenceLineType.Min:S.data.SQExpr.isMaxAggregation(t)?e.type=w.ReferenceLineType.Max:S.data.SQExpr.isMedianAggregation(t)?e.type=w.ReferenceLineType.Median:S.data.SQExpr.isAvgAggregation(t)&&(e.type=w.ReferenceLineType.Average)))}e=S.explore||(S.explore={}),w=e.viewModels||(e.viewModels={}),g=S.visuals.ObjectEnumerationBuilder,C=S.visuals.ReferenceLineHelper.ReferenceLineProps,u=jsCommon.StringExtensions,e=w.AnalyticsPaneViewModelFactory||(w.AnalyticsPaneViewModelFactory={}),h={trend:{maxInstances:1,supportsUserDefinedInstances:!1,isLabelEditable:!0},forecast:{maxInstances:1,supportsUserDefinedInstances:!0,isLabelEditable:!0},anomalyDetection:{maxInstances:1,supportsUserDefinedInstances:!0,isLabelEditable:!0},y1AxisReferenceLine:{maxInstances:null,supportsUserDefinedInstances:!0,isLabelEditable:!0},xAxisReferenceLine:{maxInstances:null,supportsUserDefinedInstances:!0,isLabelEditable:!0},referenceLine:{maxInstances:null,supportsUserDefinedInstances:!0,isLabelEditable:!0},plotAreaShading:{maxInstances:1,supportsUserDefinedInstances:!1,isLabelEditable:!1},ratioLine:{maxInstances:1,supportsUserDefinedInstances:!1,isLabelEditable:!1}},e.populatePaneForVisual=function(e,t,i,a,n,r){var o=n.defer(),s=e.getType(),l=e.getAdapter(),c=i.visualPlugin.capabilities(s),u={cards:[]},p=[];if(c&&c.objects)for(var d in c.objects){var v=a(d,c.objects[d].objectCategory);v.shouldInclude&&p.push(function(e,s,t,l,c,i,u,p){var a=this,n=t[l],r=h[l],t=w.ViewModelFactory.getDisplayName(n.displayName),d={name:l,displayName:_.isString(t)?t:l,description:w.ViewModelFactory.getDisplayName(n.description),instances:[],defaultInstance:null,maxInstances:r?r.maxInstances:1,supportsUserDefinedInstances:!!r&&r.supportsUserDefinedInstances,isLabelEditable:!r||r.isLabelEditable,warningText:p},v=n.properties;return i.when(function(e,t){if(e){t={objectName:t};return e.enumerateObjectInstancesAsync?e.enumerateObjectInstancesAsync(t):e.enumerateObjectInstances?e.enumerateObjectInstances(t):void 0}}(e,l)).then(function(o){return __awaiter(a,void 0,S.Promise,function(){var t,i,a,n,r;return __generator(this,function(e){switch(e.label){case 0:if(!(t=g.normalize(o))||!t.instances)return[3,7];i=0,a=t.instances,e.label=1;case 1:return i<a.length?(n=a[i],(p=null!=p?p:n.disabledReason)?(d.readOnly=!0,d.warningText=p,[2,d]):(r=!n.properties.show,[4,m(n,s,v,l,c,d,r,u)])):[3,4];case 2:e.sent(),e.label=3;case 3:return i++,[3,1];case 4:return d.defaultInstance?[3,6]:[4,m(t.instances[0],s,v,l,c,d,!0,u)];case 5:e.sent(),e.label=6;case 6:return[2,d];case 7:return[2,null]}})})})}(l,i,c.objects,d,t,n,r,v.warningText))}return n.all(p).then(function(e){var t=e.filter(function(e){return!!e});(e=u.cards).push.apply(e,t),o.resolve(u)}),o.promise},e.applyFilter=function(e,t){if(!_.isEmpty(e))for(var i=u.literalStringToRegex(t||"","i"),a=0,n=e;a<n.length;a++){var r=n[a];if("referenceLine"!==r.name){for(var o=w.PropertyPaneUtils.matchFilter(r,i),s=!0,l=0,c=r.instances||[];l<c.length;l++)s=p(c[l],i,o,s);r.filtered=p(r.defaultInstance,i,o,s)}}},e.filterInstance=p,e.buildReferenceLineSlices=P}(powerbi=powerbi||{}),define("ExploreUIShell/components/analyticsInstanceSelector/analyticsInstanceSelectorController",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AnalyticsInstanceSelectorController=void 0;var i=(a.createOptions=function(){return{additionalServices:["localizationService"]}},a.prototype.editName=function(){this.isEditing=!0},a.prototype.finishEditing=function(e,t){this.renameInstance({instance:e,name:t}),this.isEditing=!1},a.prototype.getInstanceLabelId=function(e){return this.cardTitle+"-instanceLabel-"+e},a.prototype.getAddButtonId=function(){return this.cardTitle+"-addButton"},a.prototype.addInstanceAndSetFocus=function(){var e=this;this.addInstance(),window.setTimeout(function(){$("#"+e.getInstanceLabelId(e.instances.length-1)).focus()},0)},a.prototype.removeAndSetFocus=function(e){var t=this.instances,i=t.indexOf(e);-1!==i&&((1===_.size(t)?$("#"+this.getAddButtonId()):i===t.length-1?$("#"+this.getInstanceLabelId(i-1)):$("#"+this.getInstanceLabelId(i+1))).focus(),this.removeInstance({instance:e}))},a.prototype.onKeyDown=function(e){var t,i,a,n;!_.isEmpty(this.instances)&&this.currentInstance&&this.setCurrentInstance&&(t=e.keyCode===$.ui.keyCode.UP,i=e.keyCode===$.ui.keyCode.DOWN,(t||i)&&(a=(n=this.instances).indexOf(this.currentInstance),t?a=Math.max(a-1,0):i&&(a=Math.min(a+1,n.length-1)),n=n[a],this.setCurrentInstance({instance:n}),$("#"+this.getInstanceLabelId(a)).focus(),e.preventDefault(),e.stopPropagation()))},a);function a(e,t){this.isEditing=!1,this.removeButtonLabel=t.localizationService.get("AnalyticsPane_Remove_Instance_Label")}t.AnalyticsInstanceSelectorController=i}),define("ExploreUIShell/components/analyticsInstanceSelector/analyticsInstanceSelector",["require","exports","ExploreUIShell/components/analyticsInstanceSelector/analyticsInstanceSelectorController"],function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.AnalyticsInstanceSelector=void 0;var a=powerbi.common.createController;t.AnalyticsInstanceSelector={templateUrl:"components/analyticsInstanceSelector/analyticsInstanceSelector.html",bindings:{instances:"<",currentInstance:"<",maximumInstances:"<",isLabelEditable:"<",cardTitle:"<",setCurrentInstance:"&",addInstance:"&",removeInstance:"&",renameInstance:"&"},controller:a(i.AnalyticsInstanceSelectorController)}}),function(a){!function(i){var e;function t(e,t){this.services=t,this.exploreUIShellConfig=i.modules.ExploreUIShellModule}e=i.components||(i.components={}),t.createOptions=function(){return{additionalServices:["telemetryService","featureSwitchService"],scopedDependencies:["viewModeState","gettingStarted","explorationCapabilities","panesVisibility"]}},t.prototype.$onInit=function(){this.paneTitleKey=this.services.featureSwitchService.featureSwitches.onObject?this.viewModel.title:"TaskPane_Fields"},t.prototype.$onChanges=function(){var i=this;this.visibilitySubscription||(this.visibilitySubscription=this.services.gettingStarted.fieldsPaneVisibility$.subscribe(function(e){var t=i.services.explorationCapabilities.getCapabilities();i.viewModel.isPaneExpanded===e||t.forceCollapseTaskPane||i.services.panesVisibility.toggleDataPaneExpansion()}))},t.prototype.$onDestroy=function(){this.visibilitySubscription.unsubscribe()},t.prototype.toggleTaskPane=function(){var e=this.services.panesVisibility.toggleDataPaneExpansion();this.services.telemetryService.logEvent(a.telemetry.EXTogglePaneExpanded,{paneType:"Task",expanded:e,viewMode:i.util.getTelemetryViewMode(this.services.viewModeState.getMode())})},Object.defineProperty(t.prototype,"fieldListModulePath",{get:function(){return"./lazy-modules/field-list/field-list.module#FieldListModule"},enumerable:!1,configurable:!0}),e.TaskPaneController=t}(a.explore||(a.explore={}))}(powerbi=powerbi||{}),function(e){var t;(t=(t=e.explore||(e.explore={})).components||(t.components={})).TaskPane={bindings:{viewModel:"<"},controller:e.common.createController(t.TaskPaneController),templateUrl:"components/taskPane/taskPane.html"}}(powerbi=powerbi||{}),function(o){!function(a){var e,s,l,c;function t(e,t){this.displayNameOptions={includeDefaultAggregate:!0,includeVariationSource:!0},this.keyCodeOfEnter=13,this.singleExpression=0,this.multipleExpression=1,this.fieldList=[],this.services=t}e=a.controllers||(a.controllers={}),s=o.data.FieldExprPattern,l=o.data.SQExpr,c=o.data.SQHierarchyExprUtils,t.createOptions=function(){return{additionalServices:["$element","aggrOps","conceptualSchemaProxy","dragDataService","dropdown","localizationService","promiseFactory"],scopedDependencies:["dataSources","explorationDisplayNameService"]}},t.prototype.$onInit=function(){var n=this;this.pickerTooltip=this.services.localizationService.get("FieldDropZone_AddFields"),this.pickerAriaLabel=this.services.localizationService.get("FieldPicker_EnterToChooseField"),this.dropConfig={accept:"field",greedy:!1},this.ngModel.$render=function(){var e;n.ngModel.$viewValue&&(n.fieldList=[],e=n.services.dataSources.get(),n.services.conceptualSchemaProxy.get(e).then(function(e){if(0===n.dropMode)n.appendNewExpression(n.ngModel.$viewValue,e);else for(var t=0,i=n.ngModel.$viewValue;t<i.length;t++){var a=i[t];n.appendNewExpression(a,e)}}))},o.explore.helpers.enableDropFromModernFieldList(this.services.$element[0],function(e,t){return n.dropField(t)})},t.prototype.getDropAction=function(){var e,a=this,n=this.services.promiseFactory.defer(),r=this.services.dragDataService.getDragContext();return r&&r.field?(e=this.services.dataSources.get(),this.services.conceptualSchemaProxy.get(e).then(function(e){var t=0,i=r.field;!a.disabled&&i&&(i=a.ensureAggregate(i,e),a.validateInput(i,e)&&(t=0===a.dropMode?1:3),n.resolve(t))})):n.resolve(0),n.promise},t.prototype.drop=function(){var e;this.disabled||(e=this.services.dragDataService.getDragContext())&&e.field&&((e=e.field)&&this.dropField(e))},t.prototype.dropField=function(t){var i=this,e=this.services.dataSources.get();this.services.conceptualSchemaProxy.get(e).then(function(e){t=i.ensureAggregate(t,e),i.validateInput(t,e)&&(0!==i.dropMode||0===i.fieldList.length?i.appendNewExpression(t,e):1===i.fieldList.length?i.updateExpression(t,0,e):i.fieldList.length)})},t.prototype.showMenu=function(n,r){return __awaiter(this,void 0,o.Promise,function(){var t,i,a=this;return __generator(this,function(e){switch(e.label){case 0:return r.stopPropagation(),this.fieldList[n],i=this.services.dataSources.get(),[4,this.services.conceptualSchemaProxy.get(i)];case 1:return t=e.sent(),i={anchorElement:$(r.currentTarget),hideExistingOverlays:!0,showInsideVisibleArea:!0},this.services.dropdown.showContextMenu({items:this.fieldList[n].menuItems},void 0,function(e){return a.onMenuItemSelected(e,t,n)},!1,void 0,void 0,!0,i),[2]}})})},t.prototype.deleteField=function(i){0<=i&&this.fieldList.length,this.fieldList.length,this.dropMode,this.fieldList=_.filter(this.fieldList,function(e,t){return t!==i}),_.isEmpty(this.fieldList)?this.ngModel.$setViewValue(null):this.ngModel.$setViewValue(_.map(this.fieldList,function(e){return e.expression}))},t.prototype.getNoValue=function(){return _.isEmpty(this.fieldList)},t.prototype.updateMenuItems=function(a){var n=this,e=this.services.dataSources.get();this.services.conceptualSchemaProxy.get(e).then(function(e){var t,i=a.expression;n.shouldAggregate(i,e)?a.menuItems=n.createAggregateMenuItems(e,i):(t=n.getVariations(e,i),_.isEmpty(t)?a.menuItems=[]:a.menuItems=n.createVariationsMenuItems(t,e,i))})},t.prototype.createAggregateMenuItems=function(e,t){if(!t)return[];var i=a.viewModels.MenuItemFactory.createAggregateMenuItems(t,e,this.services.aggrOps,!1,o.VisualDataRoleKind.Measure,this.getValidationType());return this.updateAggregateMenuCheckedItem(i,e,t),i},t.prototype.updateAggregateMenuCheckedItem=function(e,t,i){for(var a=s.getAggregate(i,t),n=0,r=e;n<r.length;n++){var o=r[n];o.checked=o.key.aggregate===a}},t.prototype.createVariationsMenuItems=function(e,t,i){for(var a=[],n=0,r=e;n<r.length;n++){var o=r[n];a.push({type:0,key:o,text:this.services.explorationDisplayNameService.getDisplayName(o,t,null)})}return this.updateVariationsMenuCheckedItem(a,i),a},t.prototype.updateVariationsMenuCheckedItem=function(e,t){for(var i=0,a=e;i<a.length;i++){var n=a[i];n.checked=l.equals(t,n.key)}},t.prototype.onMenuItemSelected=function(e,t,i){e instanceof l?(this.updateExpression(e,i,t),this.updateVariationsMenuCheckedItem(this.fieldList[i].menuItems,this.fieldList[i].expression)):(this.updateAggregate(e,i,t),this.updateAggregateMenuCheckedItem(this.fieldList[i].menuItems,t,this.fieldList[i].expression))},t.prototype.updateExpression=function(e,t,i){this.fieldList.length;t=this.fieldList[t];l.equals(t.expression,e)||(t.expression=e,this.updateField(t,i),this.setViewValue())},t.prototype.appendNewExpression=function(t,e){var i;_.some(this.fieldList,function(e){return l.equals(e.expression,t)})||(this.updateField(i={expressionDisplayName:void 0,expressionAriaLabel:void 0,tooltip:void 0,menuItems:void 0,expression:t},e),this.fieldList.push(i),this.setViewValue())},t.prototype.updateField=function(e,t){var i=e.expression,a=this.services.explorationDisplayNameService.getDisplayName(i,t,null,null,null,this.displayNameOptions),t=this.services.explorationDisplayNameService.getQualifiedDisplayName(i,t,null,this.displayNameOptions);e.expressionAriaLabel=a+" "+t,e.expressionDisplayName=a,e.tooltip=t,this.updateMenuItems(e)},t.prototype.setViewValue=function(){0===this.dropMode?this.ngModel.$setViewValue(this.fieldList[0].expression):this.ngModel.$setViewValue(_.map(this.fieldList,function(e){return e.expression}))},t.prototype.updateAggregate=function(e,t,i){this.fieldList[t];e=o.data.SQExprBuilder.setAggregate(this.fieldList[t].expression,e.aggregate);this.updateExpression(e,t,i)},t.prototype.ensureAggregate=function(e,t){return this.shouldAggregate(e,t)?this.services.aggrOps.createExprWithAggregate(e,t,!0,this.getValidationType()):e},t.prototype.shouldAggregate=function(e,t){if(e&&t)return 1===this.getValidationKind()&&!o.data.SQExprUtils.discourageAggregation(e,t)},t.prototype.getVariations=function(e,t){if(0!==this.getValidationKind())return[];var i=t;if(l.isHierarchyLevel(t)&&!(i=c.getSourceVariationExpr(t)))return[];var a=c.expandExpr(e,i);if(!_.isArray(a)&&l.equals(a,i))return[];var a=_.isArray(a)?a:[a],n=[];this.validateInput(i,e)&&n.push(i);for(var r=0,o=a;r<o.length;r++){var s=o[r];this.validateInput(s,e)&&n.push(s)}return n.length<=1&&l.equals(n[0],t)?[]:n},t.prototype.validateInput=function(e,t){var i=e.getConceptualProperty(t);if(i&&i.kpiValue)return!1;t=e.getMetadata(t);return t&&t.kind===this.getValidationKind()&&(_.isEmpty(this.getValidationType())||o.ValueType.isCompatibleTo(t.type,this.getValidationType(),!0))},t.prototype.getValidationType=function(){var e=this.validators&&this.validators.field&&this.validators.field.type;if(e)return e.variant||[e]},t.prototype.getValidationKind=function(){return this.validators&&this.validators.field&&this.validators.field.kind},e.FieldPickerController=t}(o.explore||(o.explore={}))}(powerbi=powerbi||{}),function(e){var t;((t=e.explore||(e.explore={})).components||(t.components={})).FieldPicker={templateUrl:"components/fieldPicker/fieldPicker.html",bindings:{validators:"<",dropMode:"<",disabled:"<?",focusField:"&?"},require:{ngModel:"ngModel"},controller:e.common.createController(t.controllers.FieldPickerController)}}(powerbi=powerbi||{}),define("ExploreUIShell/components/fieldWell/fieldWell",["require","exports","ExploreUIShell/components/fieldWell/fieldWellController"],function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.FieldWell=void 0;var a=powerbi.common.createController;t.FieldWell={templateUrl:"components/fieldWell/fieldWell.html",bindings:{},controller:a(i.FieldWellController)}}),function(u){var e;(function(e){var t=jsCommon.ArrayExtensions,i=u.data.SQExpr,a=(n.prototype.equals=function(e){return this.role===e.role&&i.equals(this.expr,e.expr)&&this.startIndex===e.startIndex&&this.endIndex===e.endIndex&&this.isEditingLabel===e.isEditingLabel&&this.valid===e.valid&&(this.displayOptions===e.displayOptions||!!(this.displayOptions&&e.displayOptions&&this.displayOptions.equals&&this.displayOptions.equals(e.displayOptions)))&&(this.interactivityOptions===e.interactivityOptions||!!(this.interactivityOptions&&e.interactivityOptions&&this.interactivityOptions.equals&&this.interactivityOptions.equals(e.interactivityOptions)))&&t.sequenceEqual(this.conditionalFormattingRepetitions,e.conditionalFormattingRepetitions,u.VisualObjectRepetition.metadataEquals)&&t.comparableSequenceEqual(this.hierarchyLevels,e.hierarchyLevels)&&this.visualContainerName===e.visualContainerName&&this.visualType===e.visualType&&this.supportedOperations===e.supportedOperations},n);function n(e,t,i,a,n,r,o,s,l,c,u,p){this.expr=e,this.role=t,this.startIndex=i,this.endIndex=a,this.valid=n,this.displayOptions=r,this.interactivityOptions=o,this.hierarchyLevels=s,this.conditionalFormattingRepetitions=l,this.supportedOperations=33554431,this.visualContainerName=c,this.visualType=u,this.supportedOperations=p}e.FieldWellProperty=a;r.prototype.equals=function(e){return this.displayName===e.displayName&&this.tooltipTitle===e.tooltipTitle&&this.tooltipDescription===e.tooltipDescription&&this.glyph===e.glyph},a=r;function r(e,t,i,a){this.displayName=e,this.tooltipTitle=t,this.tooltipDescription=i,this.glyph=a}e.FieldWellPropertyDisplayOptions=a;o.prototype.disableInteractivity=function(){this.canAppend=!1,this.canPrepend=!1,this.hasContextMenu=!1,this.isDraggableField=!1,this.isDroppableField=!1,this.isEditableField=!1,this.isRemovableField=!1},o.prototype.equals=function(e){return this.canAppend===e.canAppend&&this.canPrepend===e.canPrepend&&_.isEqual(this.dropDownItems,e.dropDownItems)&&this.hasContextMenu===e.hasContextMenu&&this.isDraggableField===e.isDraggableField&&this.isDroppableField===e.isDroppableField&&this.isEditableField===e.isEditableField&&this.isRemovableField===e.isRemovableField&&this.isReplaceable===e.isReplaceable},a=o;function o(e,t,i){this.dropDownItems=e,this.isReplaceable=t,this.isEditableField=i,this.canAppend=!0,this.canPrepend=!0,this.hasContextMenu=!0,this.isDraggableField=!0,this.isDroppableField=!0,this.isRemovableField=!0}e.FieldWellPropertyInteractivityOptions=a;s.prototype.equals=function(e){return i.equals(this.expr,e.expr)&&this.displayName===e.displayName},a=s;function s(e,t){this.expr=e,this.displayName=t}e.FieldWellHierarchyLevel=a;l.prototype.equals=function(e){return this.role===e.role&&this.displayName===e.displayName&&t.comparableSequenceEqual(this.properties,e.properties)&&this.supportsMultipleItems===e.supportsMultipleItems&&this.description===e.description&&(this.warning===e.warning||!!(this.warning&&e.warning&&this.warning.equals&&this.warning.equals(e.warning)))},a=l;function l(e,t,i,a,n){this.role=e,this.displayName=t,this.properties=i,this.supportsMultipleItems=a,this.description=n}e.FieldWellBucket=a;c.prototype.equals=function(e){return this.glyph===e.glyph&&this.title===e.title&&this.description===e.description},a=c;function c(e,t,i){this.glyph=e,this.title=t,this.description=i}e.FieldWellBucketWarning=a,e.FieldWellViewModel=function(e){this.buckets=e}})((e=u.explore||(u.explore={})).viewModels||(e.viewModels={}))}(powerbi=powerbi||{}),define("ExploreUIShell/components/fieldWell/fieldWellController",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.FieldWellCore=t.FieldWellController=void 0;var i=powerbi,p=i.data,a=i.explore,n=a.services,r=a.viewModels,i=a.util,o=jsCommon.ArrayExtensions,s=n.events,l=powerbi.explore.util.FieldWellUtility,c=powerbi.explore.services.isRoleAllowedForSmallMultiples,u=a.services.selectionUtils,d=i.VisualContainerUtils,v=powerbi.explore.contracts.VisualTooltip,i=(h.createOptions=function(){return{additionalServices:["$element","aggrOps","conceptualSchemaProxy","featureSwitchService","lazyProviderModern","geoTaggingAnalyzerService","localizationService","promiseFactory"],scopedDependencies:["dataSources","explorationDisplayNameService","explorationNavigation","eventBridge","groupingDesignStateService","selection","showValueAsService","visualPlugin","runningVisuals"]}},h.prototype.$onInit=function(){this.core.$onInit()},h.prototype.$onDestroy=function(){this.core.$onDestroy()},h);function h(e,t){this.core=new g(t,!1)}t.FieldWellController=i;var g=(m.prototype.$onInit=function(){return __awaiter(this,void 0,powerbi.Promise,function(){var i=this;return __generator(this,function(e){switch(e.label){case 0:return this.viewModel=new r.FieldWellViewModel([]),this.subscriptionManager=this.services.eventBridge.createChannelSubscriptionManager().subscribe(s.modelChanged,function(){return i.requestModelAndUpdate(!0)}).subscribe(s.selectionChanged,function(){return i.requestModelAndUpdate()}).subscribe(s.visualTypeChanged,function(){return i.requestModelAndUpdate()}).subscribe(s.visualContainerChanged,function(){return i.requestModelAndUpdate(!0)}).subscribe(s.fieldWellFieldRemovedEvent,function(e,t){return i.onFieldWellFieldRemoved(t)}).subscribe(s.visualContainerDataRendered,function(){return i.requestModelAndUpdate(!0)}).subscribe(s.explorationContainerReady,function(){return i.requestModelAndUpdate()}),[4,this.requestModelAndUpdate()];case 1:return[2,e.sent()]}})})},m.prototype.$onDestroy=function(){this.subscriptionManager&&this.subscriptionManager.unsubscribeAll()},m.prototype.onFieldWellFieldRemoved=function(t){jsCommon.FocusManager.focus(_.find(this.services.$element.find(".field-well-bucket-element .bucket .bucket-header .caption"),function(e){return $(e).html()===t}),!1)},m.prototype.requestModelAndUpdate=function(a){return __awaiter(this,void 0,powerbi.Promise,function(){var t,i=this;return __generator(this,function(e){return(t=this.services.dataSources.get())?[2,this.services.conceptualSchemaProxy.get(t).then(function(e){return i.update(e,a)})]:[2]})})},m.prototype.update=function(o,s){return __awaiter(this,void 0,powerbi.Promise,function(){var t,i,a,n,r=this;return __generator(this,function(e){switch(e.label){case 0:return[4,this.services.lazyProviderModern.get("@powerbi/ExploreUIAuthoring/lazy-modules/field-well-view-model/field-well-view-model.module#FieldWellViewModelModule","fieldWellViewModelService")];case 1:if(t=e.sent(),i=this.getSelectedVisual(),this.deferredCreateBuckets&&(this.deferredCreateBuckets.reject(),this.deferredCreateBuckets=void 0),o){if(i)return a=[new y(this.services.explorationNavigation,this.services.localizationService)],this.services.featureSwitchService.featureSwitches.cartesianMultiplesAuthoring||a.push(new b(this.services.visualPlugin,i)),n=this.services.runningVisuals.getVisual(i),this.deferredCreateBuckets=t.createBuckets(n,i,o,this.services.groupingDesignStateService,this.services.showValueAsService,this.services.visualPlugin,this.services.explorationDisplayNameService,a,this.disableHierarchyLevelGrouping),[2,this.deferredCreateBuckets.promise.then(function(e){r.updateViewModel(e,s),r.deferredCreateBuckets=void 0})];a=d.getDataRolesForVisualPlugin(l.getDefaultVisualPlugin(this.services.featureSwitchService)),a=t.createEmptyBuckets(a,[]),this.updateViewModel(a,s)}else a=null,this.updateViewModel(a,s);return[2]}})})},m.prototype.updateViewModel=function(e,t){t&&o.comparableSequenceEqual(e,this.viewModel.buckets)||(this.viewModel.buckets=e,this.onViewModelChange&&this.onViewModelChange(this.viewModel))},m.prototype.getSelectedVisual=function(){return u.getSelectedVisual(this.services.selection)},m);function m(e,t,i){this.services=e,this.disableHierarchyLevelGrouping=t,this.onViewModelChange=i}t.FieldWellCore=g;var y=(f.prototype.onBucketCreated=function(t,e,i,a,n,r,o){var s=e.config.singleVisual,l=r.capabilities(s.visualType),e=!l||!l.tooltips||void 0===l.tooltips.showByDefault||l.tooltips.showByDefault,r=p.DataViewObjectDefinitions.getValue(s.vcObjects,{objectName:"visualTooltip",propertyName:"show"},void 0);if((r||e)&&(!r||r.value)){e=p.DataViewObjectDefinitions.getValue(s.vcObjects,{objectName:"visualTooltip",propertyName:"type"},void 0),r=p.DataViewObjectDefinitions.getValue(s.vcObjects,{objectName:"visualTooltip",propertyName:"section"},void 0),s=e&&e.value,e=!s||s===v.Canvas,s=r&&r.value,s=!s||s===v.SectionAuto;if(e&&!s){l=l.tooltips&&l.tooltips.roles;if(_.some(l,function(e){return e===t.role})){var c=r&&r.value,r=void 0;if(c===v.SectionAuto)r=o.get("ReportPage");else{var u=this.explorationNavigation.getAllSections(),u=_.find(u,function(e){return e.name===c&&1===e.type});if(!u)return;r=u.displayName}u=new powerbi.explore.viewModels.FieldWellPropertyDisplayOptions(r,null,null,"pbi-glyph-canvas-tooltip"),r=new powerbi.explore.viewModels.FieldWellPropertyInteractivityOptions(null,!1,!1);r.disableInteractivity();r=new powerbi.explore.viewModels.FieldWellProperty(void 0,t.role,-1,-1,!0,u,r,void 0,void 0,void 0,void 0);t.properties.push(r),t.warning=new powerbi.explore.viewModels.FieldWellBucketWarning("pbi-glyph-info",void 0,this.localizationService.get("FieldWellBucket_Warning_CanvasTooltipDescription"))}}}},f.prototype.shouldCreateBucketForRole=function(e){return!0},f);function f(e,t){this.explorationNavigation=e,this.localizationService=t}var b=(S.prototype.onBucketCreated=function(e,t,i,a,n,r,o){},S.prototype.shouldCreateBucketForRole=function(e){var t=this.visualPluginService.capabilities(this.visual.config.singleVisual.visualType);return c(e,this.visual.config.singleVisual,t)},S);function S(e,t){this.visualPluginService=e,this.visual=t}}),function(e){!function(e){function a(e,t){this.$scope=e,this.$services=t}e=e.controllers||(e.controllers={}),a.createOptions=function(){return{additionalServices:["$element","$timeout","fontService","featureSwitchService"],scopedDependencies:["eventBridge","explorationCapabilities"]}},a.prototype.$onInit=function(){var t=this;this.$services.fontService.getAllFonts().then(function(e){t.isDestroyed||(t.fonts=e,t.currentFontInfo||t.updateSelectedFont(t.fontFamily))}),this.$scope.$on("fontListUpdatedEvent",function(){return t.refresh()})},a.prototype.$postLink=function(){var i=this;a.ensureWidgetRegistered(this);var e=this.$services.$element.find("select"),t=this.fontPicker=$(e).fontPickerMenu({change:function(e,t){i.onFontFamilyChange&&(t=t.item,i.onFontFamilyChange({fontFamily:t.value}))},position:{my:"left top",at:"left bottom",collision:"flip"},labelById:this.labelId}),e=this.$services.featureSwitchService.featureSwitches.paneColorRefresh||this.$services.explorationCapabilities.getCapabilities().showFluentDesign?"newPaneColors":"";t.fontPickerMenu("menuWidget").addClass("selectmenu themeableElement "+e),this.$services.$element.on("keydown",this.fontPickerKeyHandler)},a.prototype.fontPickerKeyHandler=function(e){27===e.keyCode&&e.stopPropagation()},a.prototype.$onChanges=function(e){e&&e.fontFamily&&e.fontFamily&&(e=e.fontFamily.currentValue,this.updateSelectedFont(e),this.refresh())},a.prototype.$onDestroy=function(){this.fontPicker=null,this.isDestroyed=!0,this.refreshHandle&&this.$services.$timeout.cancel(this.refreshHandle),this.$services.$element.off("keydown",this.fontPickerKeyHandler)},a.prototype.updateSelectedFont=function(e){var t,i,a=this;this.fonts&&((t=_.find(this.fonts,function(e){return a.fontFamily===e.family||a.fontFamily===e.displayName}))||(t=this.getCustomFontPickerInfo(e),this.fonts.push(t)),t!==(i=this.currentFontInfo)&&(i&&(i.selected=!1),t.selected=!0,this.currentFontInfo=t)),this.fontFamily=e},a.prototype.getCustomFontPickerInfo=function(e){return{displayName:jsCommon.FontPickerUtility.getCustomFontPickerInfo(e),family:e,selected:!1}},a.ensureWidgetRegistered=function(i){var e=$;e&&e.custom&&e.custom.fontPickerMenu||$.widget("custom.fontPickerMenu",$.ui.selectmenu,{_renderItem:function(e,t){return i.renderItem(e,t)},_renderButtonItem:function(e){return i.renderButtomItem(e)},_renderMenu:function(e,t){for(var i=0,a=t;i<a.length;i++){var n=a[i];this._renderItemData(e,n)}$(e).addClass("fontPickerMenu")}})},a.prototype.refresh=function(){var e=this;this.fontPicker&&(this.refreshHandle&&this.$services.$timeout.cancel(this.refreshHandle),this.refreshHandle=this.$services.$timeout(function(){e.fontPicker.fontPickerMenu("refresh"),e.refreshHandle=null}))},a.prototype.renderItem=function(e,t){var i=$("<li>"),a=$("<div>",{text:t.label}),n=_.find(this.fonts,function(e){return e.family===t.value});return n&&n.suppressStyle||a.css({"font-family":t.value}),i.append(a).appendTo(e)},a.prototype.renderButtomItem=function(t){var e=$("<span>",{class:"ui-selectmenu-text",text:t.label}),i=_.find(this.fonts,function(e){return e.family===t.value});return i&&i.suppressStyle||e.css("font-family",t.value),e},e.FontPickerController=a}(e.explore||(e.explore={}))}(powerbi=powerbi||{}),function(e){var t;((t=e.explore||(e.explore={})).components||(t.components={})).FontPicker={templateUrl:"components/fontPicker/fontPicker.html",bindings:{fontFamily:"<",onFontFamilyChange:"&",labelId:"<?"},controller:e.common.createController(t.controllers.FontPickerController)}}(powerbi=powerbi||{}),function(e){!function(e){function t(e,t){this.services=t,this.newPaneColorsEnabled=this.services.explorationCapabilities.getCapabilities().showFluentDesign||this.services.featureSwitchService.featureSwitches&&this.services.featureSwitchService.featureSwitches.paneColorRefresh}e=e.controllers||(e.controllers={}),t.createOptions=function(){return{additionalServices:["featureSwitchService"],scopedDependencies:["explorationCapabilities"]}},t.prototype.$onInit=function(){var t=this;this.ngModel.$render=function(){var e=t.ngModel.$viewValue;t.modelVal=e.value,t.unitVal=e.unitOfMeasurement}},t.prototype.changeValue=function(e){this.modelVal=e,this.onValueChanged()},t.prototype.onValueChanged=function(){var e=Number(this.modelVal);isNaN(e)||(e={value:e,unitOfMeasurement:this.unitVal},this.ngModel.$setViewValue(e))},e.NumericUnitSelectionController=t}(e.explore||(e.explore={}))}(powerbi=powerbi||{}),function(e){var t;((t=e.explore||(e.explore={})).components||(t.components={})).NumericUnitSelection={templateUrl:"components/numericUnitSelection/numericUnitSelection.html",bindings:{unitOptions:"<",validators:"<",inputName:"<",isDisabled:"<"},require:{ngModel:"ngModel"},controller:e.common.createController(t.controllers.NumericUnitSelectionController)}}(powerbi=powerbi||{}),function(S){var w,C,e,v,P,i,h,x,g,m,y,M,V,D,N,F;function n(t){return t?Object.keys(i).filter(function(e){return!_.includes(t,e)}).reduce(function(e,t){return _.assign(e,((e={})[t]=i[t],e))},{}):i}function r(e,t,i,a,n){var r,o,s,l,c,u,p,d;w.contracts.isVisualContainer(i)&&(r=i.config.singleVisual,a.telemetryService&&function(e,t,i,a){var n=t.name;{var r;e!==C.PropertyCardNames.General||n!==C.GeneralPropertyNames.AllowBinnedLineSample&&n!==C.GeneralPropertyNames.AllowOverlappingPointsSample?e===C.PropertyCardNames.VisualTooltip&&(r=void 0,"type"===n?r=""+t.value:"section"===n&&(r=t.value===D.SectionAuto?D.SectionAuto:"custom"),a.logEvent(S.telemetry.EXPropertyPaneOnValueChanged,{objectName:e,propertyName:n,newValue:r,visualType:i})):a.logEvent(S.telemetry.EXPropertyPaneOnValueChanged,{objectName:e,propertyName:n,newValue:t.value,visualType:i})}}(e,t,r.visualType,a.telemetryService),e===C.PropertyCardNames.StylePreset&&(l=r,o=(s=a).visualStylePresetService,c=s.themeService,o&&c&&(s=(s=null===(s=l.evaluatedObjects)||void 0===s?void 0:s.stylePreset)&&s.name,(s=o.getStylePreset(l.visualType,s))&&(c=c.getVisualStyle({}),c=s.evaluate(c),h.deleteProperties(l.objects,c),h.deleteProperties(l.vcObjects,c)))),e===C.PropertyCardNames.DropShadow&&(!(p=r).evaluatedObjects||(u=p.evaluatedObjects.dropShadow)&&u.preset&&u.preset!==m.CustomPreset&&((d=y.getPresetSettings(u.preset,u.position))&&(s=g.integer(d.angle),l=g.integer(d.shadowDistance),c=g.integer(d.shadowBlur),u=g.integer(d.shadowSpread),d=g.integer(d.transparency),h.setValue(p.vcObjects,{objectName:C.PropertyCardNames.DropShadow,propertyName:"angle"},null,s),h.setValue(p.vcObjects,{objectName:C.PropertyCardNames.DropShadow,propertyName:"shadowDistance"},null,l),h.setValue(p.vcObjects,{objectName:C.PropertyCardNames.DropShadow,propertyName:"shadowBlur"},null,c),h.setValue(p.vcObjects,{objectName:C.PropertyCardNames.DropShadow,propertyName:"shadowSpread"},null,u),h.setValue(p.vcObjects,{objectName:C.PropertyCardNames.DropShadow,propertyName:"transparency"},null,d)))),e===C.PropertyCardNames.General&&_.includes(v,t.name)?(u=t,p=a,d=n,i=(n=i).config.singleVisual,u.name===C.GeneralPropertyNames.AllowBinnedLineSample?b(i).allowBinnedLineSample=!!u.value:u.name===C.GeneralPropertyNames.AllowOverlappingPointsSample?b(i).allowOverlappingPointsSample=!!u.value:f(u,n,p,d)):(r.vcObjects=r.vcObjects||{},C.VisualCapabilitiesSliceFactoryHelper.saveSliceToDefinition(e,t,r.vcObjects,a)))}function f(e,t,i,a){var n,r=t.layouts.withId(a),a=_.cloneDeep(r.position),r=parseInt(e.value,10);isNaN(r)||null==r||(e.name===C.GeneralPropertyNames.X?(n=w.util.VisualContainerUtils.getGroupRelativeVisualContainerPosition(__assign(__assign({},a),{x:r}),t),a.x=n.x):e.name===C.GeneralPropertyNames.Y?(n=w.util.VisualContainerUtils.getGroupRelativeVisualContainerPosition(__assign(__assign({},a),{y:r}),t),a.y=n.y):e.name===C.GeneralPropertyNames.Width?a.width=r:e.name===C.GeneralPropertyNames.Height&&(a.height=r),i.layoutAuthoring&&i.layoutAuthoring.moveCanvasItemFromContract(t,a))}function b(e){return e.queryOptions||(e.queryOptions={}),e.queryOptions}function E(e,t,i){return[{selector:null,properties:{show:e&&null!=e.show?e.show:S.visuals.visualBackgroundHelper.getDefaultShow(),color:e&&null!=e.color?e.color:S.visuals.visualBackgroundHelper.getDefaultColor(),transparency:e&&null!=e.transparency?e.transparency:S.visuals.visualBackgroundHelper.getDefaultTransparency()},objectName:C.PropertyCardNames.Background,propertyInstanceKind:{color:i?3:1}}]}function I(e,t){e=e||{};var i=S.visuals.VisualBorderUtil.getDefaultValues();return[{selector:null,properties:{show:e.show||i.show,color:e.color||i.color,radius:e.radius||i.radius},objectName:C.PropertyCardNames.Border,propertyInstanceKind:{color:t?3:1}}]}function A(e,t,i){i=w.util.VisualDropShadowUtil.getDefaultValues(e=e||{},i),t={selector:null,properties:{show:e.show||i.show,color:e.color||i.color,position:e.position||i.position,preset:e.preset||i.preset},objectName:C.PropertyCardNames.DropShadow,propertyInstanceKind:{color:t?3:1}};return t.properties.preset===m.CustomPreset&&(t.properties.shadowSpread=(void 0!==e.shadowSpread?e:i).shadowSpread,t.properties.shadowBlur=(void 0!==e.shadowBlur?e:i).shadowBlur,t.properties.angle=(void 0!==e.angle?e:i).angle,t.properties.shadowDistance=(void 0!==e.shadowDistance?e:i).shadowDistance,t.properties.transparency=(void 0!==e.transparency?e:i).transparency),[t]}function T(e){return[{selector:null,properties:{show:!(!e||!e.show)},objectName:C.PropertyCardNames.LockAspect}]}function $(e,t){void 0===t&&(t=!0);var i=e.getCurrentSection();return _.chain(e.getAllSections()).filter(function(e){return!(!(1&e.type)||t&&e.name===i.name)}).map(function(e){return e.name}).value()}function k(e,t,i,a){if(null==e||!e.query||!t||!t.dataViewMappings)return!1;var n=e.query,r=S.explore.util.VisualContainerUtils.createRoleKindByQueryRef(n),i=S.DataViewAnalysis.chooseDataViewMappings(n.projections,t.dataViewMappings,r,a,t.objects,e.objects,n.defn.select(),i);return _.some(i.supportedMappings,function(e){var t=!1;return S.DataViewMapping.visitMapping(e,{visitRole:function(e){},visitReduction:function(e){t=t||!!e.binnedLineSample}}),t})}function O(e){return!(!e||!e.dataViewMappings)&&_.some(e.dataViewMappings,function(e){var t=!1;return S.DataViewMapping.visitMapping(e,{visitRole:function(e){},visitReduction:function(e){t=t||!!e.overlappingPointsSample}}),t})}function L(e,t,i,a){var n,r,o,s=[];for(r in e)e[r]&&(o=t[r],s.push(o),o===i&&(n=o));return _.isEmpty(s),void 0===n&&(n=a,_.some(s,function(e){return e===a})),{selectedValue:n,validValues:s}}function z(e,t,i,a){if(!(e&&t&&i&&i.settings))return!1;t=t.disableInlineExplore,i=i.settings.allowInlineExploration;return!t&&i&&a}w=S.explore||(S.explore={}),C=w.viewModels||(w.viewModels={}),P=S.visuals.ColorHelper,i=S.explore.contracts.VisualContainer.CommonObjectDescriptors,h=S.data.DataViewObjectDefinitions,x=S.visuals.plugins,g=S.data.SQExprBuilder,m=S.explore.contracts.VisualDropShadow,y=w.util.VisualDropShadowUtil,M=S.explore.contracts.VisualHeaderTooltip,V=S.explore.contracts.VisualLink,D=S.explore.contracts.VisualTooltip,N=S.explore.util.VisualTooltipStyleUtils,F=jsCommon.CssConstants,e=C.VisualContainerSliceFactoryHelper||(C.VisualContainerSliceFactoryHelper={}),v=[C.GeneralPropertyNames.X,C.GeneralPropertyNames.Y,C.GeneralPropertyNames.Width,C.GeneralPropertyNames.Height,C.GeneralPropertyNames.AllowBinnedLineSample,C.GeneralPropertyNames.AllowOverlappingPointsSample],e.createPopulatePaneOptions=function(h){var e=this,t=!h.visual,g=h.featureSwitchService.featureSwitches,m=h.visualConfig.visualType,i=h.visualPlugin&&h.visualPlugin.isScriptVisual(m),a=h.pluginOps&&h.pluginOps.isAnalysisVisual(m),y=h.pluginOps&&h.pluginOps.isQueryVisual(m),f=h.pluginOps&&h.pluginOps.isQnaVisual(m),b=!(i||a||f);return{objectDescriptors:n(h.excludeObjectRepetition),objectDefinitions:h.visualConfig.vcObjects,enumerateObjectInstances:function(v){return __awaiter(e,void 0,S.Promise,function(){var t,i,a,n,r,o,s,l,c,u,p,d;return __generator(this,function(e){switch(e.label){case 0:return v!==C.PropertyCardNames.Title?[3,3]:null!=(t=(null===(s=h.visualConfig.evaluatedObjects)||void 0===s?void 0:s.title)||{}).text?[3,2]:[4,h.conceptualSchemaProxy.get(h.dataSourcesService.get())];case 1:s=e.sent(),t=h.displayNameService.getVisualTitle(h.visualConfig,s,h.capabilities,t),e.label=2;case 2:return[2,function(e,t,i,a,n){var r={selector:null,properties:{},objectName:C.PropertyCardNames.Title},o=P.create(n),n=S.visuals.FontProperties.createFromObjectOrStyle(e,{size:"fontSize",family:"fontFamily",color:"fontColor"},o,n,void 0,w.util.VisualContainerUtils.DefaultTitleTextClass,w.util.VisualContainerUtils.DefaultTitleFontProperties);r.properties.show=e.show||!w.contracts.VisualTitle.isHidden(e,t),r.properties.text=e.text||"",i.accessibilityTopLevelNav&&(r.properties.heading=e.heading||w.util.VisualContainerUtils.DefaultTitleHeading);r.properties.titleWrap=!!e.titleWrap,r.properties.fontColor={solid:{color:n.color}},r.properties.background=e.background||{solid:{color:""}},r.properties.alignment=e.alignment||"left",r.properties.fontSize=n.size.pt,i.enableBIU&&(r.properties.bold=e.bold||!1,r.properties.italic=e.italic||!1,r.properties.underline=e.underline||!1);r.properties.fontFamily=n.family,a&&(r.propertyInstanceKind={text:3,fontColor:3,background:3});return[r]}(t,h.capabilities&&h.capabilities.suppressDefaultTitle,g,b,h.visualStyle)];case 3:if(v===C.PropertyCardNames.Background)return[2,E(null===(l=h.visualConfig.evaluatedObjects)||void 0===l?void 0:l.background,0,b)];if(v===C.PropertyCardNames.LockAspect)return[2,T(null===(l=h.visualConfig.evaluatedObjects)||void 0===l?void 0:l.lockAspect)];if(v===C.PropertyCardNames.General)return c=h.dataSourcesService.get(),[2,h.conceptualSchemaProxy.get(c).then(function(e){var t=(t=e.schema(void 0).capabilities.supportsBinnedLineSample)&&k(h.visualConfig,h.capabilities,e,g),e=(e=e.schema(void 0).capabilities.supportsOverlappingPointsSample)&&O(h.capabilities);return function(e,t,i,a,n){var r={x:e&&e.x,y:e&&e.y,width:e&&e.width,height:e&&e.height},o={selector:null,properties:r,objectName:C.PropertyCardNames.General};t.evaluatedObjects&&(e=t.evaluatedObjects.general,r.keepLayerOrder=e&&e.keepLayerOrder,r.altText=e&&e.altText||"");o.propertyInstanceKind={altText:n?3:1},i&&(r.allowBinnedLineSample=!(t.queryOptions&&!1===t.queryOptions.allowBinnedLineSample));a&&(r.allowOverlappingPointsSample=!(t.queryOptions&&!1===t.queryOptions.allowOverlappingPointsSample));return[o]}(h.visualContainerPosition,h.visualConfig,t,e,b)})];if(v===C.PropertyCardNames.Border)return[2,I(null===(c=h.visualConfig.evaluatedObjects)||void 0===c?void 0:c.border,b)];if(v===C.PropertyCardNames.DropShadow){if(g.visualDropShadow)return[2,A(null===(u=h.visualConfig.evaluatedObjects)||void 0===u?void 0:u.dropShadow,b,h.visualStyle)]}else{if(v===C.PropertyCardNames.StylePreset)return[2,function(e,t,i){e=i.getStylePreset(t,e);if(e)return[{selector:null,properties:{name:e.name},objectName:C.PropertyCardNames.StylePreset}]}((u=null===(u=h.visualConfig.evaluatedObjects)||void 0===u?void 0:u.stylePreset)&&u.name,m,h.visualStylePresetService)];if(v===C.PropertyCardNames.VisualLink)return[2,function(e,t,i,a,n,r,o){if(t.supportsVisualLink){var s=V.Back,t=(e=e||{show:!1,type:s}).type||s,s=_.map(V.Type.members(),function(e){return e.value});t!==V.PageNavigation&&t!==V.Drillthrough&&(a.drillthroughButtonGA||r!==S.visuals.plugins.basicShape.name&&r!==S.visuals.plugins.image.name||_.remove(s,function(e){return e===V.PageNavigation}),a.navAndDrillthroughActionTypes||r!==x.actionButton.name||_.remove(s,function(e){return e===V.PageNavigation||e===V.Drillthrough})),r!==S.visuals.plugins.basicShape.name&&r!==S.visuals.plugins.image.name||_.remove(s,function(e){return e===V.Drillthrough});var l,c,u,p,d,v,s={selector:null,properties:{show:!!e.show,type:t},objectName:C.PropertyCardNames.VisualLink,validValues:{type:s},propertyInstanceKind:{tooltip:3}};return e.type===V.Bookmark&&(u=[{displayName:function(e){return e.get("None")},value:V.BookmarkNone}],v=i&&i.getAllBookmarks(),c=_.map(v,function(e){return e.name}),v=__spreadArray(__spreadArray([],_.map(u,function(e){return e.value})),c||[]),s.validValues.bookmark={mergeValues:u,filterValues:v},s.properties.bookmark=0<=v.indexOf(e.bookmark)?e.bookmark:V.BookmarkNone),e.type===V.WebUrl&&(s.properties.webUrl=e.webUrl,s.propertyInstanceKind.webUrl=3),e.type===V.PageNavigation&&(u=[{displayName:function(e){return e.get("None")},value:V.SectionNone}],d=n.getAllSections(),l=n.getCurrentSection(),c=_.map(d,function(e){return e.name}),v=__spreadArray(__spreadArray([],_.map(u,function(e){return e.value})),_.filter(c,function(e){return e!==l.name})),s.validValues.navigationSection={mergeValues:u,filterValues:v},s.properties.navigationSection=e.navigationSection,a.drillthroughButtonGA&&(s.propertyInstanceKind.navigationSection=3)),e.type===V.Drillthrough&&(u=[{displayName:function(e){return e.get("None")},value:V.SectionNone}],d=n.getAllSections(),p=n.getCurrentSection(),d=_.filter(d,function(e){return o&&!_.isEmpty(o.getDrillthroughParameters(e.name))}),d=_.map(d,function(e){return e.name}),v=__spreadArray(__spreadArray([],_.map(u,function(e){return e.value})),_.filter(d,function(e){return e!==p.name})),s.validValues.drillthroughSection={mergeValues:u,filterValues:v},s.properties.drillthroughSection=e.drillthroughSection,a.drillthroughButtonGA&&(s.propertyInstanceKind.drillthroughSection=3)),a.suppressDefaultTooltip&&(s.properties.suppressDefaultTooltip=e.suppressDefaultTooltip),e.type!==V.Drillthrough?e.suppressDefaultTooltip||(s.properties.tooltip=e.tooltip):e.suppressDefaultTooltip||(s.properties.enabledTooltip=e.enabledTooltip,s.properties.disabledTooltip=e.disabledTooltip,a.drillthroughButtonGA&&(s.propertyInstanceKind.enabledTooltip=3,s.propertyInstanceKind.disabledTooltip=3)),[s]}}(null===(p=h.visualConfig.evaluatedObjects)||void 0===p?void 0:p.visualLink,h.capabilities,h.bookmarkService,g,h.explorationNavigation,h.visualConfig.visualType,h.drillthroughService)];if(v===C.PropertyCardNames.VisualTooltip)return[2,function(e,t,i,a,n,r){var o=t.tooltips;if(o){var s={selector:null,properties:{show:e&&void 0!==e.show?!!e.show:void 0===o.showByDefault||!!o.showByDefault},objectName:C.PropertyCardNames.VisualTooltip,validValues:{}},t=o.supportedTypes;if(null!=t){o=t.canvas?D.Canvas:D.Default,t=L(t,{default:D.Default,canvas:D.Canvas},e&&e.type,o),o=t.selectedValue,t=t.validValues;if(s.properties.type=o,s.validValues.type=t,o===D.Canvas&&(t=e&&e.section||D.SectionAuto,s.properties.section=t,o=[{displayName:function(e){return e.get("Visual_Auto")},value:D.SectionAuto}],t=__spreadArray(__spreadArray([],$(i)||[]),_.map(o,function(e){return e.value})),s.validValues.section={filterValues:t,mergeValues:o}),!r.defaultTooltipFormatting)return[s];i=null===(i=i.getCurrentExploration().settings)||void 0===i?void 0:i.useEnhancedTooltips,n=n.getConfig().displayOptions.enableMobileTooltipActions,e=N.getVisualTooltipStyles(a,i,n,e);return i?(s.properties.themedTitleFontColor={solid:{color:e.titleFontProperties.color}},s.properties.themedValueFontColor={solid:{color:e.valueFontProperties.color}},s.properties.actionFontColor={solid:{color:e.actionFontProperties.color}}):(s.properties.titleFontColor={solid:{color:e.titleFontProperties.color}},s.properties.valueFontColor={solid:{color:e.valueFontProperties.color}}),s.properties.fontSize=e.titleFontProperties.size.pt,r.enableBIU&&(s.properties.bold=e.titleFontProperties.weight===F.boldValue,s.properties.italic=e.titleFontProperties.style===F.italicValue,s.properties.underline=e.titleFontProperties.textDecoration===F.underlineValue),s.properties.fontFamily=e.titleFontProperties.family,i?s.properties.themedBackground=e.background:s.properties.background=e.background,s.properties.transparency=e.transparency,[s]}}}(null===(p=h.visualConfig.evaluatedObjects)||void 0===p?void 0:p.visualTooltip,h.capabilities,h.explorationNavigation,h.visualStyle,h.viewModeState,g)];if(v===C.PropertyCardNames.VisualHeaderTooltip)return r=null===(d=h.visualConfig.evaluatedObjects)||void 0===d?void 0:d.visualHeader,o=r&&!1!==r.show&&r.showTooltipButton,i=h.explorationCapabilities.getCapabilities(),a=i.visualContainerOptions,n=a.useStylableHeader,[2,function(e,t,i,a,n,r){if(a&&i){e=__assign({type:D.Canvas,show:!0,text:void 0,section:M.NoSection},e);i=null===(i=t.getCurrentExploration().settings)||void 0===i?void 0:i.useEnhancedTooltips,r=r.getConfig().displayOptions.enableMobileTooltipActions,r=N.getVisualTooltipStyles(n,i,r,e),e={selector:null,properties:{section:e.section,text:e.text},objectName:C.PropertyCardNames.VisualHeaderTooltip};i?e.properties.themedTitleFontColor={solid:{color:r.titleFontProperties.color}}:e.properties.titleFontColor={solid:{color:r.titleFontProperties.color}},e.properties.fontSize=r.titleFontProperties.size.pt,e.properties.fontFamily=r.titleFontProperties.family,i?e.properties.themedBackground=r.background:e.properties.background=r.background,e.properties.transparency=r.transparency;r=[{displayName:function(e){return e.get("None")},value:M.NoSection}],t=__spreadArray(__spreadArray([],$(t)||[]),_.map(r,function(e){return e.value}));return e.validValues=e.validValues||{},e.validValues.section={filterValues:t,mergeValues:r},[e]}}(null===(d=h.visualConfig.evaluatedObjects)||void 0===d?void 0:d.visualHeaderTooltip,h.explorationNavigation,n,o,h.visualStyle,h.viewModeState)];if(v===C.PropertyCardNames.VisualHeader)return i=h.explorationCapabilities.getCapabilities(),a=i.visualContainerOptions,n=a.useStylableHeader,r=i.annotationsEnabled,d=h.explorationNavigation&&h.explorationNavigation.getCurrentExploration(),o=z(g,i,d,y||f),[2,function(e,t,i,a,n){var r={show:!0,background:{solid:{color:"#FFF"}},border:{solid:{color:"#FFF"}},transparency:0,foreground:{solid:{color:"#333"}},showVisualInformationButton:!0,showVisualWarningButton:!0,showVisualErrorButton:!0,showDrillRoleSelector:!0,showDrillUpButton:!0,showDrillToggleButton:!0,showDrillDownLevelButton:!0,showDrillDownExpandButton:!0,showPinButton:!0,showFocusModeButton:!0,showSeeDataLayoutToggleButton:!0,showOptionsMenu:!0,showTooltipButton:!1,showFilterRestatementButton:!0,showCommentButton:!0,showPersonalizeVisualButton:!0,showCopyVisualImageButton:!0};e=e||r;var o={selector:null,properties:{show:!1!==e.show},objectName:C.PropertyCardNames.VisualHeader};t&&(t=e.background||r.background,o.properties=__assign(__assign({},o.properties),{background:t,border:e.border||t,transparency:null!==(t=e.transparency)&&void 0!==t?t:r.transparency,foreground:e.foreground||r.foreground,showVisualInformationButton:null!==(t=e.showVisualInformationButton)&&void 0!==t?t:r.showVisualInformationButton,showVisualWarningButton:null!==(t=e.showVisualWarningButton)&&void 0!==t?t:r.showVisualWarningButton,showVisualErrorButton:null!==(t=e.showVisualErrorButton)&&void 0!==t?t:r.showVisualErrorButton,showDrillRoleSelector:null!==(t=e.showDrillRoleSelector)&&void 0!==t?t:r.showDrillRoleSelector,showDrillUpButton:null!==(t=e.showDrillUpButton)&&void 0!==t?t:r.showDrillUpButton,showDrillToggleButton:null!==(t=e.showDrillToggleButton)&&void 0!==t?t:r.showDrillToggleButton,showDrillDownLevelButton:null!==(t=e.showDrillDownLevelButton)&&void 0!==t?t:r.showDrillDownLevelButton,showDrillDownExpandButton:null!==(t=e.showDrillDownExpandButton)&&void 0!==t?t:r.showDrillDownExpandButton,showPinButton:null!==(t=e.showPinButton)&&void 0!==t?t:r.showPinButton,showFocusModeButton:null!==(t=e.showFocusModeButton)&&void 0!==t?t:r.showFocusModeButton,showFilterRestatementButton:null!==(t=e.showFilterRestatementButton)&&void 0!==t?t:r.showFilterRestatementButton,showSeeDataLayoutToggleButton:null!==(t=e.showSeeDataLayoutToggleButton)&&void 0!==t?t:r.showSeeDataLayoutToggleButton,showOptionsMenu:null!==(t=e.showOptionsMenu)&&void 0!==t?t:r.showOptionsMenu,showTooltipButton:null!==(t=e.showTooltipButton)&&void 0!==t?t:r.showTooltipButton}),i&&(o.properties.showCommentButton=null===(i=null==e?void 0:e.showCommentButton)||void 0===i||i),a&&(o.properties.showPersonalizeVisualButton=null!==(a=e.showPersonalizeVisualButton)&&void 0!==a?a:r.showPersonalizeVisualButton),n&&(o.properties.showCopyVisualImageButton=null!==(e=e.showCopyVisualImageButton)&&void 0!==e?e:r.showCopyVisualImageButton));return[o]}(null===(d=h.visualConfig.evaluatedObjects)||void 0===d?void 0:d.visualHeader,n,r,o,g.copyVisualImage&&g.exportVisualImageTenantEnabled)]}e.label=4;case 4:return[2]}})})},dataBarsDialogLauncher:h.dataBarsDialogLauncher,dataSourcesService:h.dataSourcesService,conditionalFormattingDialogLauncher:h.conditionalFormattingDialogLauncher,conditionalFormattingUtilsService:h.conditionalFormattingUtilsService,explorationSerializer:h.explorationSerializer,conceptualSchemaProxy:h.conceptualSchemaProxy,selectedContainers:h.selectedContainers,promiseFactory:h.promiseFactory,isDisabled:t,save:r,localizationService:h.localizationService,modalDialogService:h.modalDialogService,visualContainer:h.visualContainer,visualType:m,itemPicker:h.itemPicker,bookmarkService:h.bookmarkService,explorationNavigation:h.explorationNavigation,featureSwitchService:h.featureSwitchService,lazy:h.lazy,visualAuthoring:h.visualAuthoring,visualStylePresetService:h.visualStylePresetService,visualStyle:h.visualStyle,visualWarningCollection:h.runningVisual&&h.runningVisual.getWarnings(),undoRedo:h.undoRedo,cardIndexCounter:0}},e.excludeObjectRepetition=n,e.saveVisualProperty=r,e.saveGeneralPositionProperty=f,e.enumerateBackgroundObjectInstances=E,e.enumerateBorderObjectInstances=I,e.enumerateDropShadowObjectInstances=A,e.enumerateLockAspectObjectInstances=T,e.getTooltipSections=$,e.visualSupportsHighDensitySampling=k,e.visualSupportsOverlappingPointsSampling=O,e.getSupportedValues=L,e.isPersonalizeVisualBtnAllowed=z}(powerbi=powerbi||{}),function(g){var m,y,t,f,b,S,l,w,C,P,x,M,V;function c(e,t,i,a,n){var r,o,s;if(t.name!==y.PropertySliceNames.RevertToDefault)if(t.name!==y.PropertySliceNames.ApplyToAllPages)f.isValidPropertyName(t.name)&&(c=t.type,o=b.isPropertyDefinition(t.value)?t.value:c.image?function(e,t,i,a,n,r){if(!e||_.isEmpty(e.name))return{name:x.text(""),url:x.text("")};var o=!0;{var s;e.scaling&&(s=b.getValue(n,{objectName:t,propertyName:i},a),o=!s||P.equals(s.name,x.text(""))||P.equals(s.scaling,x.text(e.scaling)))}o&&r?l=r.add(e.name,1,w.Image,{content:e.url}):(a=b.getValue(n,{objectName:t,propertyName:i},a))&&(l=a.url);var l={name:x.text(e.name),url:l};e.scaling&&(l.scaling=x.text(e.scaling));return l}(t.value,e,t.name,t.selector,i,a.resourceRegistration):c.geoJson?function(e,t){var i;if(e)return i=e.type===g.GeoJsonTypes.shared?(t.add(e.name,2,w.ShapeMap),x.resourcePackageItem(C.ShapeMap,2,e.name)):e.type===g.GeoJsonTypes.packaged&&e.content?(i=M.makeJsonDataUri(e.content),t.add(e.name,1,w.ShapeMap,{content:i})):e.content?x.text(e.content):x.nullConstant(),{name:x.text(e.name),type:x.text(e.type),content:i}}(t.value,a.resourceRegistration):b.encodePropertyValue(t.value,c),g.ValueType.fromDescriptor(t.type).text||""!==o||(o=null),s=t.selector,void 0!==t.altConstantValueSelector&&(null==t.value?n||(s=t.altConstantValueSelector):b.getDataBoundExprs(o,t.type,s,jsCommon.ArrayExtensions.createWithName()).length||(s=t.altConstantValueSelector)),c=o,n=e,o=t.name,t=s,s=i,null==c?b.deleteProperty(s,n,t,o):(function(e,t,i,a){e===y.PropertyCardNames.ValueAxis&&(t===y.PropertySliceNames.Position&&(b.ensure(i,e,null).properties[y.PropertySliceNames.SecPosition]=a.value===V.right?x.text(V.left):x.text(V.right)),t===y.PropertySliceNames.SecPosition&&(b.ensure(i,e,null).properties[y.PropertySliceNames.Position]=a.value===V.right?x.text(V.left):x.text(V.right)))}(n,o,s,c),function(e,t,i,a){e===y.PropertyCardNames.Legend&&t===y.PropertySliceNames.Show&&(b.ensure(i,e,null).properties[y.PropertySliceNames.ShowGradientLegend]=a)}(n,o,s,c),b.ensure(s,n,t).properties[o]=c));else for(var l=i[e],c=null!==(c=null===(c=a.explorationNavigation)||void 0===c?void 0:c.getAllSections())&&void 0!==c?c:[],u=null===(a=a.explorationNavigation)||void 0===a?void 0:a.getCurrentSection(),p=m.contracts.Section.objectDescriptors,d=0,v=c;d<v.length;d++){var h=v[d];h!==u&&(h=h.objects=null!==(r=h.objects)&&void 0!==r?r:{},l?S.copyFormatObjects(((r={})[e]=p[e],r),p,((r={})[e]=l,r),h):delete h[e])}else delete i[e]}m=g.explore||(g.explore={}),y=m.viewModels||(m.viewModels={}),f=g.data.DataViewObjectDefinition,b=g.data.DataViewObjectDefinitions,S=g.explore.services.FormatPainter,l=g.visuals.GradientUtils,w=g.contracts.ResourcePackageItemType,C=g.contracts.SharedResourcePackageNames,P=g.data.SQExpr,x=g.data.SQExprBuilder,M=jsCommon.UrlUtils,V=g.visuals.yAxisPosition,(t=y.VisualCapabilitiesSliceFactoryHelper||(y.VisualCapabilitiesSliceFactoryHelper={})).createPopulatePaneOptions=function(n){var e=this;return{dataBarsDialogLauncher:n.dataBarsDialogLauncher,conditionalFormattingDialogLauncher:n.conditionalFormattingDialogLauncher,conditionalFormattingUtilsService:n.conditionalFormattingUtilsService,objectDescriptors:n.capabilities.objects,objectDefinitions:n.visualObjectDefns,shouldIncludeObject:n.shouldIncludeObject,conceptualSchemaProxy:n.conceptualSchemaProxy,dataSourcesService:n.dataSourcesService,modalDialogService:n.modalDialogService,visualAuthoring:n.visualAuthoring,telemetryService:n.telemetryService,featureSwitchService:n.featureSwitchService,lazy:n.lazy,explorationSerializer:n.explorationSerializer,undoRedo:n.undoRedo,enumerateObjectInstances:function(a){return __awaiter(e,void 0,g.Promise,function(){var t,i;return __generator(this,function(e){return n.visual?(t=n.visual,i={objectName:a},t.enumerateObjectInstancesAsync?[2,t.enumerateObjectInstancesAsync(i)]:t.enumerateObjectInstances?[2,t.enumerateObjectInstances(i)]:[2]):[2]})})},enumerateObjectRepetition:function(){if(n.visual&&n.visual.enumerateObjectRepetition)return n.visual.enumerateObjectRepetition()},showGradientCard:n.showGradientCard,selectedContainers:n.selectedContainers,promiseFactory:n.promiseFactory,save:t.saveChangedSliceToDefinition,visualType:n.visualConfig.visualType,visualContainer:n.visualContainer,visualWarningCollection:n.runningVisual&&n.runningVisual.getWarnings(),localizationService:n.localizationService,itemPicker:n.itemPicker,bookmarkService:n.bookmarkService,explorationNavigation:n.explorationNavigation,visualStyle:n.visualStyle,cardIndexCounter:0,disabledSliceTypes:n.disabledSliceTypes,excludeConditionalFormattingCard:n.excludeConditionalFormattingCard}},t.saveSliceToDefinition=c,t.saveChangedSliceToDefinition=function(e,t,i,a,n,r){var o,s;m.contracts.isVisualContainer(i)&&(s=i.config.singleVisual.visualType,a.telemetryService&&function(e,t,i,a){var n,r=t.name;e===y.PropertyCardNames.Totals&&r===y.PropertySliceNames.Show&&a.logEvent(g.telemetry.EXPropertyPaneOnValueChanged,{objectName:e,propertyName:r,newValue:t.value,visualType:i});e===y.PropertyCardNames.Zoom&&r===y.PropertySliceNames.Show&&a.logEvent(g.telemetry.EXPropertyPaneOnValueChanged,{objectName:e,propertyName:r,newValue:t.value,visualType:i});e===y.PropertyCardNames.DataPoint&&r===y.PropertySliceNames.Transparency&&a.logEvent(g.telemetry.EXPropertyPaneOnValueChanged,{objectName:e,propertyName:r,newValue:t.value,visualType:i});e===y.PropertyCardNames.CategoryAxis&&r===y.PropertySliceNames.InnerPadding&&a.logEvent(g.telemetry.EXPropertyPaneOnValueChanged,{objectName:e,propertyName:r,newValue:t.value,visualType:i});e===y.PropertyCardNames.Labels&&r===y.PropertySliceNames.Color&&(o=null===(o=null===(o=null===(o=t.value)||void 0===o?void 0:o.solid)||void 0===o?void 0:o.color)||void 0===o?void 0:o.rule,_.isEmpty(o)||a.logEvent(g.telemetry.EXPropertyPaneOnValueChanged,{objectName:e,propertyName:r,newValue:t.value,visualType:i}));e===y.PropertyCardNames.Totals&&r===y.PropertySliceNames.Color&&(o=null===(n=null===(n=null===(n=t.value)||void 0===n?void 0:n.solid)||void 0===n?void 0:n.color)||void 0===n?void 0:n.rule,_.isEmpty(o)||a.logEvent(g.telemetry.EXPropertyPaneOnValueChanged,{objectName:e,propertyName:r,newValue:t.value,visualType:i}));{var o;e===y.PropertyCardNames.CategoryLabels&&r===y.PropertySliceNames.Color&&(o=null===(n=null===(n=null===(n=t.value)||void 0===n?void 0:n.solid)||void 0===n?void 0:n.color)||void 0===n?void 0:n.rule,_.isEmpty(o)||a.logEvent(g.telemetry.EXPropertyPaneOnValueChanged,{objectName:e,propertyName:r,newValue:t.value,visualType:i}))}}(e,t,s,a.telemetryService),e===y.PropertyCardNames.Gradient?function(e,t){var i=t.config.singleVisual.objects;i||(t.config.singleVisual.objects=i={});l.updateFillRule(e.name,e.value,i)}(t,i):((o=i.config.singleVisual.objects)||(i.config.singleVisual.objects=o={}),(s=a.visualPlugin&&a.visualPlugin.capabilities(s))&&s.supportsSynchronizingFilterState&&(!(s=s.objects[e])||(s=s.properties[t.name])&&s.filterState&&((s=a.visualSync)&&s.syncFilterState(i))),c(e,t,o,a,r),i.config.singleVisual.autoSelectVisualType=void 0))}}(powerbi=powerbi||{}),function(x){!function(f){var e,b,S,l,c;function a(e,t){var i=this;this.services=t,this.expandedCards={},this.filterExpandedCards={},this.selectedContainers={},this.propertySliceSaveServices=this.services,this.saveServices=this.services,this.subscriptionManager=this.services.eventBridge.createChannelSubscriptionManager().subscribe(x.events.visualThemeChanged,function(){return i.updatePagePropertyPane()}).subscribe(b.canvasChanged,function(){return i.updatePagePropertyPane()}).subscribe(b.sectionObjectsEvaluated,function(){return i.updatePagePropertyPane()}).subscribe(b.sectionNameChanged,function(e,t){return i.updatePagePropertyPane()}).subscribe(b.modelChanged,function(){return i.updatePagePropertyPane()}).subscribe(b.explorationSettingsLoaded,function(e,t){t.allowInlineExplorationChanged&&i.updatePagePropertyPane()}),this.scrollbarsConfig={ignoreOverlay:!1,ignoreMobile:!1}}function w(e,t,i,a,n){var r=n.explorationNavigation.getCurrentSection();n.undoRedo.register(e,function(){var e=r.objects||{};f.viewModels.VisualCapabilitiesSliceFactoryHelper.saveSliceToDefinition(t,i,e,a),r.objects=e}),n.eventBridge.publishToChannel(b.sectionObjectsChanged,r)}function C(e,t,i,a,n,r){var o=c.getDefaultSectionSize(e),s=t&&_.find(t.slices,function(e){return e.name===S.PageSizeWidthName}),t=t&&_.find(t.slices,function(e){return e.name===S.PageSizeHeightName});e===l.Custom?0!==r&&(o=i):s&&t&&(s.value={value:o.width,unitOfMeasure:s.value.unitOfMeasure},t.value={value:o.height,unitOfMeasure:t.value.unitOfMeasure}),a.publishToChannel(b.canvasDimensionChanged,o);a=e===l.Tooltip,o=e===l.Custom;(a||1!==r&&!o)&&n.setCanvasDisplay(a?3:1),s&&t&&(s.isDisabled=t.isDisabled=e!==l.Custom)}function P(e,t,i,a){if(e)t.setSectionType(i,a,1),t.setCrossReportDrillthrough(i,a,!1,!1);else{t.clearSectionType(i,a,1);i=a.linkFields;if(_.some(i))for(var n=0,r=__spreadArray([],i||[]);n<r.length;n++){var o=r[n];t.removeDrillthroughLink(a,o)}}}e=f.controllers||(f.controllers={}),b=x.explore.services.events,S=f.viewModels.PagePropertyPaneConsts,l=f.contracts.SectionPageSizeTypes.PageSizeTypes,c=f.util.PropertyPaneUtils,a.createOptions=function(){return{additionalServices:["$timeout","featureSwitchService","linguisticSchemaProxy","localizationService","promiseFactory","screenReaderService","telemetryService","themeService","visualStylePresetService","conceptualSchemaProxy","perspectivesService","conditionalFormattingUtilsService"],scopedDependencies:["canvasScale","itemPicker","eventBridge","explorationNavigation","lazyScoped","resourceLoader","resourceRegistration","undoRedo","visualAuthoring","dataSources","visualSync","layoutAuthoring","changeDetectionMeasure","explorationCapabilities"]}},a.prototype.$onInit=function(){return __awaiter(this,void 0,x.Promise,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return[4,(t=this).createViewModel()];case 1:return t.viewModel=e.sent(),[2]}})})},a.prototype.$onDestroy=function(){this.subscriptionManager.unsubscribeAll()},a.prototype.applyFilter=function(){f.viewModels.PropertyPaneUtils.applyFilter(this.viewModel&&this.viewModel.cards,this.filter),this.isAvailable()&&this.filter&&this.services.screenReaderService.alert(this.isSearchEmpty()?x.common.getLocalize().get("SearchSuggestion_Invalid"):x.common.getLocalize().get("SearchSuggestion_Valid"))},a.prototype.selectContainer=function(e,t){this.selectedContainers&&(this.selectedContainers[e]=t),this.updatePagePropertyPane()},a.prototype.expandCard=function(e){var t=this.filter?this.filterExpandedCards:this.expandedCards;t[e]=null==t[e]?!this.filter:!t[e]},a.prototype.isAvailable=function(){return this.viewModel&&!_.isEmpty(this.viewModel.cards)},a.prototype.isSearchEmpty=function(){return!_.find(this.viewModel.cards,function(e){return!e.filtered})},a.prototype.isCardExpanded=function(e){return this.filter&&!1!==this.filterExpandedCards[e]||!this.filter&&this.expandedCards[e]},a.prototype.save=function(t,i){return __awaiter(this,void 0,x.Promise,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,a.savePageProperties(t,i.name,this.propertySliceSaveServices,this.saveServices,i)];case 1:return e.sent()&&this.updatePagePropertyPane(),[2]}})})},a.savePageProperties=function(p,d,v,h,g){var m,y;return __awaiter(this,void 0,x.Promise,function(){var t,i,a,n,r,o,s,l,c,u;return __generator(this,function(e){return t=h.explorationNavigation.getCurrentExploration(),i=h.explorationNavigation.getCurrentSection(),a=i.size,n=h.canvasScale.getDisplayOption(),r=h.promiseFactory.defer(),p.name===S.PageInformationName?(p.value?(u={sectionNewName:p.value,sectionIndex:_.indexOf(t.sections,i)},h.eventBridge.publishToChannel(b.renameSection,u)):p.value=i.displayName,r.resolve(!1)):p.name===S.PageInformationQnaPodEnabled?p.value?h.undoRedo.register("ReportPagePodEnabled",function(){f.PodUtils.ensurePod(t,i,h.linguisticSchemaProxy).then(function(){return r.resolve(!0)})}):h.undoRedo.register("ReportPagePodDisabled",function(){f.PodUtils.deleteLinguisticEntity(t,i.name,h.linguisticSchemaProxy).then(function(){return r.resolve(!0)})}):p.name===S.PageInformationAltName?(o=p.value.split(/[,\n]/).map(function(e){return e.trim()}).filter(function(e){return!_.isEmpty(e)}),h.undoRedo.register("UpdateLinguisticAltNames",function(){f.PodUtils.updateLinguisticAltNames(t,i,o,h.linguisticSchemaProxy).then(function(){return r.resolve(!0)})}),r.resolve(!1)):p.name===S.PageInformationType?(s=p.value,h.lazyScoped("explorationAuthoring").then(function(e){P(s,e,t,i),h.telemetryService.logEvent(x.telemetry.EXPropertyPaneOnValueChanged,{objectName:S.PageInformationCardName,propertyName:p.name,newValue:""+s,visualType:"page"}),r.resolve(!1)})):p.name===S.PageSizeTypeName?h.lazyScoped("explorationAuthoring").then(function(e){C(p.value,g,a,h.eventBridge,e,n),r.resolve(!1)}):p.name===S.PageSizeWidthName?(l=(v.featureSwitchService.featureSwitches.useModernFormatPane?p:p.value).value,h.eventBridge.publishToChannel(b.canvasDimensionChanged,{width:parseInt(l,10),height:a.height,displayOption:n}),r.resolve(!1)):p.name===S.PageSizeHeightName?(l=(v.featureSwitchService.featureSwitches.useModernFormatPane?p:p.value).value,h.eventBridge.publishToChannel(b.canvasDimensionChanged,{width:a.width,height:parseInt(l,10),displayOption:n}),r.resolve(!1)):d===S.PageBackgroundCardName?(w("UpdateCanvasBackground",d,p,v,h),r.resolve(!0)):d===S.OutspaceBackgroundCardName?(w("UpdateOutspaceBackground",d,p,v,h),r.resolve(!0)):d===S.OutspacePaneCardName?(w("UpdateOutspacePaneBackground",d,p,v,h),r.resolve(!0)):d===S.FilterCardName?(w("UpdateFilterCard",d,p,v,h),r.resolve(!0)):d===S.DisplayAreaName?(w("UpdateDisplayAreaAlignment",d,p,v,h),r.resolve(!0)):d===S.PageRefreshCardName?(w("UpdatePageRefresh",d,p,v,h),(l=p.value)&&h.telemetryService.logEvent(x.telemetry.EXPropertyPaneOnValueChanged,{objectName:S.PageRefreshCardName,propertyName:p.name,newValue:l.toString(),visualType:"page"}),r.resolve(!0)):d===S.PersonalizeVisual&&(w("UpdatePersonalizeVisual",d,p,v,h),c="applyToAllPages"in p.type&&!(null===(m=p.type)||void 0===m||!m.applyToAllPages),u=c?""===(null===(m=null==g?void 0:g.slices.withName("perspectiveRef"))||void 0===m?void 0:m.value):"reference"in p.type&&null!==(y=p.type.reference)&&void 0!==y&&y.perspective?""===p.value:!!("revertToDefault"in p.type&&p.type.revertToDefault)||void 0,h.telemetryService.logEvent(x.telemetry.EXPersonalizeVisualChangePerspective,{isDefault:u,isApplyToAllPages:c}),r.resolve(!0)),[2,r.promise]})})},a.prototype.createViewModel=function(){return __awaiter(this,void 0,x.Promise,function(){var t,i;return __generator(this,function(e){switch(e.label){case 0:return t=this.services.explorationNavigation.getCurrentSection(),i=this.services.dataSources.get(),[4,this.services.conceptualSchemaProxy.get(i)];case 1:return i=e.sent(),i=_.map(i.schemas,function(e){return e.capabilities}).filter(function(e){return!!e}),[4,f.viewModels.PagePropertyPaneViewModelFactory.populatePaneForPage(t,this.services,this.selectedContainers,i)];case 2:return[2,e.sent()]}})})},a.prototype.updatePagePropertyPane=function(){return __awaiter(this,void 0,x.Promise,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return[4,this.createViewModel()];case 1:return t=e.sent(),this.viewModel=t,this.filter||(this.filterExpandedCards={}),this.applyFilter(),[2]}})})},e.PagePropertyPaneController=a,e.savePageSizeType=C,e.savePageInformationType=P}(x.explore||(x.explore={}))}(powerbi=powerbi||{}),function(e){var t;((t=e.explore||(e.explore={})).components||(t.components={})).PagePropertyPane={templateUrl:"components/pagePropertyPane/pagePropertyPane.html",controller:e.common.createController(t.controllers.PagePropertyPaneController)}}(powerbi=powerbi||{}),function(e){!function(i){var e;function t(e,t){this.services=t,this.newPaneColorsEnabled=this.services.explorationCapabilities.getCapabilities().showFluentDesign||this.services.featureSwitchService.featureSwitches&&this.services.featureSwitchService.featureSwitches.paneColorRefresh,this.initializeHighContrastRules()}e=i.controllers||(i.controllers={}),t.createOptions=function(){return{additionalServices:["highContrastCssGenerationService","featureSwitchService"],scopedDependencies:["explorationCapabilities"]}},t.prototype.$onInit=function(){this.updateSelectedContainer()},t.prototype.initializeHighContrastRules=function(){this.services.highContrastCssGenerationService.addRule('.themeableElement .propertyPaneContents .propertyCard .cardTitle:hover, html[data-focus-source="key"] .themeableElement .propertyPaneContents .propertyCard .cardTitle:focus',"{ border-color: @selectedBackgroundColor !important; }")},t.prototype.$onChanges=function(e){e&&e.viewModel&&e.viewModel.currentValue.containers!==e.viewModel.previousValue.containers&&this.updateSelectedContainer()},t.prototype.getSliceComponentType=function(e){return i.viewModels.PropertyPaneUtils.getSliceComponentType(e)},t.prototype.getSliceUniqueId=function(e,t){return i.viewModels.ViewModelFactory.createUniqueId([e.name,t.toString()])},t.prototype.getTooltipConfig=function(){return{tooltipDescription:this.viewModel.description||this.viewModel.displayName}},t.prototype.getContainerTooltipConfig=function(){return!_.isEmpty(this.viewModel.containers)&&this.viewModel.containersLabel?{tooltipDisable:!1,tooltipTitle:this.viewModel.containersLabel,tooltipDescription:this.viewModel.containersTooltip}:this.getTooltipConfig()},t.prototype.onSelectedContainerChanged=function(){this.selectedContainerChanged&&this.selectedContainerChanged({cardName:this.viewModel.name,containerKey:this.selectedContainerKey})},t.prototype.sliceChanged=function(e){this.inputForm&&this.inputForm[e.name]&&this.inputForm[e.name].$invalid||this.cardChanged({slice:e,card:this.viewModel})},t.prototype.expandCard=function(e){this.expandCardTitle&&this.expandCardTitle({cardName:e})},t.prototype.updateSelectedContainer=function(){!_.isEmpty(this.viewModel.containers)&&this.viewModel.selectedContainer?this.selectedContainerKey=this.viewModel.selectedContainer.value:this.selectedContainerKey=void 0},e.PropertyCardController=t}(e.explore||(e.explore={}))}(powerbi=powerbi||{}),function(e){var t;((t=e.explore||(e.explore={})).components||(t.components={})).PropertyCard={templateUrl:"components/propertyCard/propertyCard.html",bindings:{expanded:"<",viewModel:"<",cardChanged:"&",selectedContainerChanged:"&",expandCardTitle:"&",showChangeIndication:"<?"},controller:e.common.createController(t.controllers.PropertyCardController)}}(powerbi=powerbi||{}),function(c){var A;(function(e){var t=jsCommon.ArrayExtensions,V=c.data.DataBoundObjectQueryExtender,a=A.services.events,D=c.explore.constants.ExploreCanvasConstants,N=c.visuals.GradientUtils,i=A.viewModels.PropertyPaneUtils,F=A.viewModels.PropertyPaneViewModelFactory,u=A.services.selectionUtils,E=c.explore.util.VisualContainerUtils;e.MaxPrecision=15;var n=(o.createOptions=function(){return{additionalServices:["$timeout","conceptualSchemaProxy","featureSwitchService","lazy","localizationService","promiseFactory","screenReaderService","telemetryService","themeService","visualStylePresetService","modalDialogService","explorationSerializer","modernDialogService","checkboxDialogToken","conditionalFormattingUtilsService"],scopedDependencies:["bookmarkService","itemPicker","dataSources","explorationDisplayNameService","eventBridge","explorationCapabilities","explorationNavigation","lazyScoped","resourceLoader","resourceRegistration","selection","undoRedo","visualAuthoring","visualPlugin","visualPluginOps","visualSync","layoutAuthoring","viewModeState","runningVisuals","formFactor"]}},o.prototype.setPropertySliceServices=function(){this.propertySliceSaveServices={featureSwitchService:this.services.featureSwitchService,resourceLoader:this.services.resourceLoader,resourceRegistration:this.services.resourceRegistration,visualStylePresetService:this.services.visualStylePresetService,themeService:this.services.themeService,visualAuthoring:this.services.visualAuthoring,telemetryService:this.services.telemetryService,visualPlugin:this.services.visualPlugin,undoRedo:this.services.undoRedo,visualSync:this.services.visualSync,layoutAuthoring:this.services.layoutAuthoring,explorationNavigation:this.services.explorationNavigation}},o.prototype.setPropertyPaneViewModelServices=function(){return __awaiter(this,void 0,c.Promise,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return[4,this.services.lazyScoped("conditionalFormattingDialogLauncherService")];case 1:return t=e.sent(),this.propertyPaneViewModelServices={bookmarkService:this.services.bookmarkService,conceptualSchemaProxy:this.services.conceptualSchemaProxy,conditionalFormattingDialogLauncher:t,conditionalFormattingUtilsService:this.services.conditionalFormattingUtilsService,dataSources:this.services.dataSources,explorationDisplayNameService:this.services.explorationDisplayNameService,explorationCapabilities:this.services.explorationCapabilities,explorationNavigation:this.services.explorationNavigation,explorationSerializer:this.services.explorationSerializer,featureSwitchService:this.services.featureSwitchService,formFactor:this.services.formFactor,itemPicker:this.services.itemPicker,layoutAuthoring:this.services.layoutAuthoring,lazy:this.services.lazy,lazyScoped:this.services.lazyScoped,localizationService:this.services.localizationService,modalDialogService:this.services.modalDialogService,promiseFactory:this.services.promiseFactory,resourceLoader:this.services.resourceLoader,resourceRegistration:this.services.resourceRegistration,runningVisuals:this.services.runningVisuals,telemetryService:this.services.telemetryService,themeService:this.services.themeService,undoRedo:this.services.undoRedo,viewModeState:this.services.viewModeState,visualAuthoring:this.services.visualAuthoring,visualPlugin:this.services.visualPlugin,visualPluginOps:this.services.visualPluginOps,visualStylePresetService:this.services.visualStylePresetService,visualSync:this.services.visualSync},[2]}})})},o.prototype.$onDestroy=function(){this.subscriptionManager.unsubscribeAll()},o.prototype.save=function(t,i){for(var a,n=this,r=this.services.formFactor.getCurrentLayout(),e=u.getSelectedCanvasItems(this.services.selection),o=this,s=0,l=e;s<l.length;s++){var c=l[s];!function(){var e;c&&t.save&&(e=t.dynamicExpressionSupport&&t.dynamicExpressionSupport.isSet,t.suppressUndoRedoRegister?t.save(i.name,t,c,o.propertySliceSaveServices,r,e):(o.services.undoRedo.register("SavePropertyPane",function(){t.save(i.name,t,c,n.propertySliceSaveServices,r,e)}),A.contracts.isVisualContainer(c)?o.services.visualAuthoring.raiseVisualContainerChanged(c):o.services.eventBridge.publishToChannel(A.services.events.visualContainerGroupChanged,{affectContainer:function(e){return e===c}}))),o.propertyChanged({cardName:i.name,sliceName:t.name,visualType:null===(a=c.config)||void 0===a?void 0:a.singleVisual.visualType,visualUniqueName:null==c?void 0:c.name})}()}},o.prototype.selectContainer=function(e,t){var i=u.getDefaultSelectedVisualInSingleOrMultiCase(this.services.selection);i&&this.selectedContainers&&(this.selectedContainers[e]=t,this.bindToCanvasItem(i))},o.prototype.expandCard=function(e){var t=this.filter?this.filterExpandedCards:this.expandedCards;t[e]=null==t[e]?!this.filter:!t[e]},o.prototype.isCardExpanded=function(e){return this.filter&&!1!==this.filterExpandedCards[e]||!this.filter&&this.expandedCards[e]},o.prototype.isAvailable=function(){return this.viewModel&&!_.isEmpty(this.viewModel.cards)},o.prototype.isSearchEmpty=function(){return!_.find(this.viewModel.cards,function(e){return!e.filtered})},o.prototype.onVisualDataRendered=function(e){var t=this,i=u.getDefaultSelectedVisualInSingleOrMultiCase(this.services.selection);e===i&&this.services.$timeout(function(){u.isCanvasItemSelected(e,t.services.selection)&&t.bindToCanvasItem(e)})},o.prototype.triggerUpdate=function(){this.bindToCanvasItem(u.getDefaultSelectedVisualInSingleOrMultiCase(this.services.selection))},o.prototype.applyFilter=function(){i.applyFilter(this.viewModel&&this.viewModel.cards,this.filter),this.isAvailable()&&this.filter&&this.services.screenReaderService.alert(this.isSearchEmpty()?c.common.getLocalize().get("SearchSuggestion_Invalid"):c.common.getLocalize().get("SearchSuggestion_Valid"))},o.prototype.onVisualContainerPositionChanged=function(e){var t=u.getDefaultSelectedVisualInSingleOrMultiCase(this.services.selection);e.affectContainer(t)&&this.bindToCanvasItem(t)},o.prototype.bindToCanvasItem=function(r){return __awaiter(this,void 0,c.Promise,function(){var t,i,a,n;return __generator(this,function(e){switch(e.label){case 0:return t=!1,[4,this.isServicesLoaded];case 1:return e.sent(),r&&(A.contracts.isVisualContainer(r)?(i=this.propertyPaneViewModelServices.runningVisuals.getVisual(r))&&i.getAdapter()&&(a=i.getAdapter()):t=!0),[4,o.getPropertyPaneViewModel(r,this.propertyPaneViewModelServices,this.selectedContainers,this.excludeObjectRepetition,this.excludeConditionalFormattingCard,this.disabledSliceTypes)];case 2:return n=e.sent(),t||a&&i&&a===i.getAdapter()?this.updateViewModel(n):this.viewModel=n,[2]}})})},o.getPropertyPaneViewModel=function(S,w,C,P,x,M){return __awaiter(this,void 0,c.Promise,function(){var a,n,r,o,s,l,c,u,p,d,v,h,g,m,y,f,b;return __generator(this,function(e){switch(e.label){case 0:return S?(n=w.formFactor.getCurrentLayout(),s={height:D.PhonePortraitCanvasHeight,width:D.PhoneAuthoringViewportWidth},r=S.layouts.withId(n).position,o=E.getAbsoluteVisualContainerPosition(r,n,S.parentGroup),r={x:Math.round(o.x),y:Math.round(o.y),width:Math.round(o.width),height:Math.round(o.height)},o=w.themeService.getVisualStyle(w.explorationNavigation.getCurrentExploration().themeCollection),s=1===n?s:w.explorationNavigation.getCurrentSection().size,A.contracts.isVisualContainer(S)?(l=w.runningVisuals.getVisual(S))&&l.getAdapter()?(c=S.config.singleVisual,u=c.visualType,p=l.getAdapter(),d=c.objects,(v=w.visualPlugin.capabilities(u))&&v.objects?(h=c.evaluatedObjects&&c.evaluatedObjects.title,g=function(e,t){if(t&&t.config&&t.config.singleVisual){var i=t.config.singleVisual,e=e.capabilities(t.config.singleVisual.visualType),t=N.getFillRuleDescriptor(e.objects);if(t&&t.inputRole){e=void 0;return null!=i&&null!=(e=i.query)&&null!=e.projections&&null!=e.projections[t.inputRole]&&V.matchesAnyCondition(t.conditions,e.projections,E.createRoleKindByQueryRef(e))}return!1}}(w.visualPlugin,S),m=function(e){return!e||1===e},[4,w.lazyScoped("conditionalFormattingDialogLauncherService")]):[3,5]):[3,5]:[3,6]):[3,9];case 1:return y=e.sent(),[4,w.lazyScoped("dataBarsDialogLauncherService")];case 2:return b=e.sent(),b={visual:p,dataBarsDialogLauncher:b,conditionalFormattingDialogLauncher:y,conditionalFormattingUtilsService:w.conditionalFormattingUtilsService,capabilities:v,visualConfig:c,visualContainer:S,visualTitle:h,visualObjectDefns:d,visualContainerPosition:r,showGradientCard:g,promiseFactory:w.promiseFactory,explorationCapabilities:w.explorationCapabilities,explorationNavigation:w.explorationNavigation,featureSwitchService:w.featureSwitchService,selectedContainers:C,selectedVisualType:u,shouldIncludeObject:m,visualStylePresetService:w.visualStylePresetService,localizationService:w.localizationService,conceptualSchemaProxy:w.conceptualSchemaProxy,dataSourcesService:w.dataSources,modalDialogService:w.modalDialogService,telemetryService:w.telemetryService,visualAuthoring:w.visualAuthoring,itemPicker:w.itemPicker,bookmarkService:w.bookmarkService,lazy:w.lazy,explorationSerializer:w.explorationSerializer,displayNameService:w.explorationDisplayNameService,stylePresetService:w.visualStylePresetService,undoRedo:w.undoRedo,visualStyle:o,visualPlugin:w.visualPlugin,pluginOps:w.visualPluginOps},[4,w.lazyScoped("drillthrough")];case 3:return b.drillthroughService=e.sent(),b.viewModeState=w.viewModeState,b.runningVisual=w.runningVisuals.getVisual(S),b.sectionSize=s,b.canvasLayout=n,b.excludeObjectRepetition=P,b.disabledSliceTypes=M,b.excludeConditionalFormattingCard=x,f=b,l&&p===l.getAdapter()?[4,(t=f,i=I(),F.populatePaneForVisual(i,t))]:[3,5];case 4:a=e.sent(),e.label=5;case 5:return[3,8];case 6:return f={group:S,explorationNavigation:w.explorationNavigation,featureSwitchService:w.featureSwitchService,itemPicker:w.itemPicker,localizationService:w.localizationService,promiseFactory:w.promiseFactory,undoRedo:w.undoRedo,containerPosition:r,visualStyle:o,sectionSize:s},[4,(i=f,t=I(),F.populatePaneForVisualContainerGroup(t,i))];case 7:a=e.sent(),e.label=8;case 8:return[3,10];case 9:a=I(),e.label=10;case 10:return[2,a]}var t,i})})},o.prototype.updateViewModel=function(e){this.viewModel=e,this.filter||(this.filterExpandedCards={}),this.applyFilter()},o.prototype.showConvertShapeDialog=function(){return __awaiter(this,void 0,c.Promise,function(){return __generator(this,function(e){return o.showDialog(this.services,this.services.checkboxDialogToken),[2]})})},o.showDialog=function(s,l){return __awaiter(this,void 0,c.Promise,function(){var t,i,a,n,r,o;return __generator(this,function(e){switch(e.label){case 0:return a={convertAll:{label:"ConvertShape_DialogConvertAll"}},t=s.localizationService.get("Undo"),a={titleText:"ConvertShape_DialogTitle",messageTemplate:s.localizationService.format("ConvertShape_DialogMessage","<strong>"+t+"</strong>"),okButtonText:"Convert",cancelButtonText:"Cancel_ButtonText",checkboxes:a},a={dialogName:"CheckboxDialog",componentName:l,bindings:a,config:{panelClass:["checkbox-dialog"],width:"340px"}},[4,s.modernDialogService.openHostDialog(a)];case 1:return[4,e.sent().afterClosed().toPromise()];case 2:if(!(a=e.sent())||0!==a.result)return[2];if(i=[],a.checkboxes.convertAll)i=s.explorationNavigation.getAllVisualContainers("basicShape");else for(a=u.getSelectedCanvasItems(s.selection),n=0,r=a;n<r.length;n++)o=r[n],A.contracts.isVisualContainer(o)&&"basicShape"===o.config.singleVisual.visualType&&i.push(o);return s.visualAuthoring.convertMultiple(i,s.dataSources.get(),"shape"),[2]}})})},o.prototype.showCovertShapeBanner=function(){var e,t=this.services.formFactor.getCurrentLayout();return this.services.featureSwitchService.featureSwitches.shapeVisual&&"basicShape"===(null===(e=this.viewModel)||void 0===e?void 0:e.selectedVisualType)&&1!==t},o);function o(e,t){var i=this;this.showChangeIndication=!1,this.services=t,this.expandedCards={},this.filterExpandedCards={},this.selectedContainers={},this.setPropertySliceServices(),this.isServicesLoaded=this.setPropertyPaneViewModelServices(),this.subscriptionManager=this.services.eventBridge.createChannelSubscriptionManager().subscribe(a.selectionChanged,function(){return i.triggerUpdate()}).subscribe(a.visualTypeChanged,function(){return i.triggerUpdate()}).subscribe(a.canvasItemContainerPositionChanged,function(e,t){return i.onVisualContainerPositionChanged(t)}).subscribe(a.visualContainerDataRendered,function(e,t){return i.onVisualDataRendered(t)}).subscribe(a.visualContainerGroupRendered,function(e,t){return i.onVisualDataRendered(t)}),this.scrollbarsConfig={ignoreOverlay:!1,ignoreMobile:!1},this.convertShapeBannerModel={bannerType:3,iconName:"glyphicon glyph-small pbi-glyph-info",message:this.services.localizationService.get("ConvertShape_PropPaneMessage")},this.bindToCanvasItem(u.getDefaultSelectedVisualInSingleOrMultiCase(this.services.selection))}function I(){return{selectedVisualType:null,cards:t.createWithName()}}e.PropertyPaneController=n})((A=c.explore||(c.explore={})).controllers||(A.controllers={}))}(powerbi=powerbi||{}),function(e){var t;((t=e.explore||(e.explore={})).components||(t.components={})).PropertyPane={templateUrl:"components/propertyPane/propertyPane.html",bindings:{showChangeIndication:"<?",propertyChanged:"&",excludeObjectRepetition:"<?",excludeConditionalFormattingCard:"<?",disabledSliceTypes:"<?"},controller:e.common.createController(t.controllers.PropertyPaneController)}}(powerbi=powerbi||{}),function(r){!function(e){var t,i;function a(e,t){var i=this;this.services=t,this.newPaneColorsEnabled=this.services.explorationCapabilities.getCapabilities().showFluentDesign||this.services.featureSwitchService.featureSwitches&&this.services.featureSwitchService.featureSwitches.paneColorRefresh,this.changeValue=function(e){i.viewModel.value=e,i.change()},this.initializeHighContrastRules()}function n(e,t){var i={items:[]};return e&&(i.items.push({key:"DynamicExpression",text:t.get("FieldWell_ConditionalFormatting"),type:0,showIcon:!0,icon:"pbi-glyph-variable"}),e.isSet&&i.items.push({key:"RevertToDefault",text:t.get("Reset_To_Default"),type:0,showIcon:!0,icon:"pbi-glyph-undo"})),i}t=e.controllers||(e.controllers={}),i=e.viewModels.PropertySliceNames,a.createOptions=function(){return{additionalServices:["highContrastCssGenerationService","dropdown","localizationService","featureSwitchService"],scopedDependencies:["explorationCapabilities","formFactor"]}},a.prototype.$onInit=function(){this.contextMenuItems=n(this.viewModel.dynamicExpressionSupport,this.services.localizationService)},a.prototype.$onChanges=function(e){var t;this.contextMenuItems=n(this.viewModel.dynamicExpressionSupport,this.services.localizationService),null!==(t=null===(t=null===(t=this.viewModel.type)||void 0===t?void 0:t.fill)||void 0===t?void 0:t.solid)&&void 0!==t&&t.color&&(this.isNoFillItemSupported=r.FillSolidColorTypeDescriptor.nullable(this.viewModel.type.fill.solid.color))},Object.defineProperty(a.prototype,"isCardShowSlice",{get:function(){return this.viewModel.name===i.Show},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"hasContextMenuItems",{get:function(){return!!this.contextMenuItems.items.length},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"hasDynamicExpressionSupport",{get:function(){return!!this.viewModel.dynamicExpressionSupport},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"isDynamicExpressionSet",{get:function(){return!(!this.viewModel.dynamicExpressionSupport||!this.viewModel.dynamicExpressionSupport.isSet)},enumerable:!1,configurable:!0}),a.prototype.change=function(){var e;null!==(e=this.viewModel.value)&&void 0!==e&&e.file&&(this.viewModel.value.file=void 0),this.sliceChanged({slice:this.viewModel})},Object.defineProperty(a.prototype,"exploreUIAuthoringModulePath",{get:function(){return"@powerbi/ExploreUIAuthoring/explore-ui-authoring.module#ExploreUIAuthoringModule"},enumerable:!1,configurable:!0}),a.prototype.initializeHighContrastRules=function(){this.services.highContrastCssGenerationService.addRule(".themeableElement .inputRange","{ border-color: @buttonForegroundColor !important; }"),this.services.highContrastCssGenerationService.addRule(".themeableElement .inputRange .navigationButtons .numericArrowUp i, .themeableElement .unit-numupdown .navigationButtons .numericArrowDown i","{ color: @buttonForegroundColor !important; }"),this.services.highContrastCssGenerationService.addRule(".themeableElement .inputField .inputRange .navigationButtons:hover","{ border-color: @selectedBackgroundColor !important; }"),this.services.highContrastCssGenerationService.addRule(".themeableElement .inputField .inputRange .navigationButtons .buttonBox:hover","{ outline: @selectedBackgroundColor !important; background-color: @selectedBackgroundColor !important; }")},a.prototype.getTitleClass=function(){var e=[],t=this.type;switch(!r.ValueType.fromDescriptor(this.viewModel.type).none&&"slider"!==t||e.push("title-no-max-width"),"outlineWeight"===this.viewModel.name&&e.push("title-of-outline-weight"),t){case"numericUnitSelection":e.push("title-align-left");break;case"fill":e.push("title-of-color-picker");break;case"alignment":e.push("title-of-alignment");break;case"dateTime":e.push("title-of-date-picker");break;case"bool":e.push("title-of-bool")}return e.join(" ")},a.prototype.getRevertResource=function(){return 1===this.services.formFactor.getCurrentLayout()?"Reset_All_Settings_Mobile":"Reset_To_Default"},a.prototype.getRevertTooltipResource=function(){return 1===this.services.formFactor.getCurrentLayout()?"Visual_RevertToDesktop_Tooltip":"Reset_To_Default"},a.prototype.isMultiline=function(){return"textarea"===this.type||"numericUnitSelection"===this.type},a.prototype.getTooltipConfig=function(){var e=this.viewModel;return{tooltipDisable:!1,tooltipTitle:e.displayName,tooltipDescription:e.tooltip||e.description}},a.prototype.getWarningTooltipConfig=function(){return{tooltipDisable:!1,tooltipTitle:this.viewModel.warningMessage.title,tooltipDescription:this.viewModel.warningMessage.detail}},a.prototype.showContextMenu=function(e){this.services.dropdown.showContextMenu(this.contextMenuItems,{x:e.pageX,y:e.pageY},this.onContextMenuItemSelected.bind(this),!1,"propertySliceContextMenu",void 0,!0)},a.prototype.onContextMenuItemSelected=function(e){switch(e){case"DynamicExpression":return void this.editDynamicExpression();case"RevertToDefault":return void this.changeValue(null)}},a.prototype.editDynamicExpression=function(){this.viewModel.dynamicExpressionSupport.edit()},a.prototype.showLabel=function(){var e=this.viewModel;return e.displayName&&"show"!==e.name&&"gradientBar"!==e.name&&!_.isFunction(e.value)&&!e.showLinkButtonOnly},t.PropertySliceController=a}(r.explore||(r.explore={}))}(powerbi=powerbi||{}),function(e){var t;((t=e.explore||(e.explore={})).components||(t.components={})).PropertySlice={templateUrl:"components/propertySlice/propertySlice.html",bindings:{type:"<",viewModel:"<",sliceChanged:"&",headerId:"<?",cardName:"<?",showChangeIndication:"<?"},controller:e.common.createController(t.controllers.PropertySliceController)}}(powerbi=powerbi||{}),function(e){!function(t){var e;function i(){}e=t.controllers||(t.controllers={}),i.prototype.getSliceComponentType=function(e){return t.viewModels.PropertyPaneUtils.getSliceComponentType(e)},i.prototype.sliceChanged=function(e){this.onChanged({slice:e})},e.PropertySliceContainerController=i}(e.explore||(e.explore={}))}(powerbi=powerbi||{}),function(e){var t;((t=e.explore||(e.explore={})).components||(t.components={})).PropertySliceContainer={templateUrl:"components/propertySliceContainer/propertySliceContainer.html",bindings:{slices:"<",onChanged:"&",cardName:"<?",showChangeIndication:"<?"},controller:e.common.createController(t.controllers.PropertySliceContainerController)}}(powerbi=powerbi||{}),function(e){!function(e){function t(){}e=e.controllers||(e.controllers={}),t.prototype.getTooltipConfig=function(){if(this.warningMessage)return{tooltipDisable:!1,tooltipTitle:this.warningMessage.title,tooltipDescription:this.warningMessage.detail}},e.PropertySlicePlaceHolderController=t}(e.explore||(e.explore={}))}(powerbi=powerbi||{}),function(e){var t;((t=e.explore||(e.explore={})).components||(t.components={})).PropertySlicePlaceHolder={templateUrl:"components/propertySlicePlaceHolder/propertySlicePlaceHolder.html",bindings:{warningMessage:"<"},controller:e.common.createController(t.controllers.PropertySlicePlaceHolderController)}}(powerbi=powerbi||{}),define("ExploreUIShell/components/forecastCard/forecastCardController",["require","exports","ExploreUIShell/components/analyticsCard/analyticsCardController"],function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.ForecastCardController=void 0;var i=powerbi,c=i.data,i=i.explore,a=i.viewModels,i=i.util,r=c.DataViewObjectDefinitions,l=c.SQExpr,u=i.VisualContainerUtils,p=powerbi.visuals.forecastUnits,o=powerbi.visuals.forecastConfidenceIntervals,d=(s.forecastName="Forecast",s.unitsSliceName="units",s.forecastDataPointsSliceName="forecastDataPoints",s.ignoreDataPointsSliceName="ignoreDataPoints",s.confidenceIntervalSliceName="confidenceInterval",s.seasonalitySliceName="seasonality",s);function s(){}v.createOptions=function(){return{additionalServices:["transformPluginService","localizationService","conceptualSchemaProxy","telemetryService","featureSwitchService"],scopedDependencies:["dataSources","explorationCapabilities","undoRedo","visualAuthoring","visualPlugin"]}},v.prototype.onAddInstance=function(e,t){this.currentInstance=t;var i=this.getTransformParameters(),a=this.services.transformPluginService.getTransformPlugin(d.forecastName),e=_.find(e.merge,function(e){return c.Selector.equals(e.selector,t.selector)});t.selector.metadata=this.getBoundMeasure(),e.properties.transform={algorithm:a.name,parameters:i},this.updateParameterValues()},v.prototype.onUpdateInstance=function(e){this.currentInstance=e,this.updateParameterValues()},v.prototype.onSave=function(e,t){if("revertToDefault"===t.name)return this.updateParameterValues(!0),!1},v.prototype.saveForecastParameters=function(){var e=this;this.services.undoRedo.register("save forecast",function(){return e.saveForecastParametersAction()})},v.prototype.saveForecastParametersAction=function(){var t=this,e=this.getForecastTransform();if(!e)return!1;var i=_.find(e.parameters,function(e){return e.name===t.parameterSlices[d.seasonalitySliceName].name}),a=i?this.getParameterValueFromObjects(i,d.seasonalitySliceName):void 0,i=this.parameterSlices[d.seasonalitySliceName].value;this.hasValueChanged(a,i)&&this.services.telemetryService.logEvent(powerbi.telemetry.EXAnalyticsPaneForecastParameterUpdated,{seasonality:!0});e={merge:[{objectName:"forecast",selector:this.currentInstance.selector,properties:{transform:{algorithm:e.algorithm,parameters:this.getTransformParameters()}}}]};return this.services.visualAuthoring.persistProperties(e,this.visualContainer,!0),this.services.visualAuthoring.raiseVisualContainerChanged(this.visualContainer),!0},v.prototype.getSliceComponentType=function(e){return a.PropertyPaneUtils.getSliceComponentType(e)},v.prototype.isDisabled=function(){return!this.getForecastTransform()},v.prototype.onUnitsUpdated=function(){var t=this,e=_.find(this.units,function(e){return t.parameterSlices[d.unitsSliceName].value===e.value});e&&(this.currentSelectedUnit=e.displayName)},v.prototype.isCardDirty=function(e,t){if(e&&t)return n.AnalyticsCardControllerBase.isCardDirty(e,t);var i,a=!1;for(i in this.parameterSlices)if(this.parameterSlices[i].value!==this.defaultParameterValues[i]){a=!0;break}return a},v.prototype.haveParametersChanged=function(){var a=this,n=this.getForecastTransform();if(!n)return!1;var e,r=this;for(e in this.parameterSlices){var t=function(t){var e=_.find(n.parameters,function(e){return e.name===a.parameterSlices[t].name}),i=r.getParameterValueFromObjects(e,t),e=r.parameterSlices[t].value;if(r.hasValueChanged(i,e))return{value:!0}}(e);if("object"==typeof t)return t.value}return!1},v.prototype.hasValueChanged=function(e,t){return(e=e&&e.toString())!==(t=t&&t.toString())},v.prototype.getBoundMeasure=function(){var e=this.visualContainer;if(!(e&&e.config&&e.config.singleVisual&&e.config.singleVisual.query))return"";for(var i=e.config.singleVisual,t=0,a=u.getDataRolesForVisual(e,this.services.visualPlugin)||[];t<a.length;t++){var n=a[t];if(1===n.cartesianKind){n=i.query.tryGetExprs(n.name)||[];n.length;for(var r=0,o=n;r<o.length;r++){var s=function(t){var e=i.query.defn.select(),e=_.find(e,function(e){return l.equals(t,e.expr)});if(e)return{value:e.name}}(o[r]);if("object"==typeof s)return s.value}}}return""},v.prototype.updateParameterValues=function(r){var o=this;this.getConceptualSchema(this.visualContainer).then(function(a){if(o.visualContainer===a.visualContainer){var e,n=o.getForecastTransform();for(e in o.parameterSlices)!function(e){var t=o.parameterSlices[e],i=void 0;(i=n?_.find(n.parameters,function(e){return e.name===t.name}):i)&&!r?(l.isConstant(i.expr),t.value=o.getParameterValueFromObjects(i,e),e===d.unitsSliceName&&o.updatePossibleUnits(a.schema)):t.value=o.defaultParameterValues[e]}(e);o.onUnitsUpdated(),r&&o.saveForecastParametersAction()}})},v.prototype.getParameterValueFromObjects=function(e,t){if(e&&e.expr){e=e.expr.value;return t===d.unitsSliceName?e=this.getUnitsEnumValue(e):t===d.confidenceIntervalSliceName&&(e=this.getConfidenceIntervalEnumValue(e)),e}},v.prototype.updatePossibleUnits=function(i){var e=this.visualContainer.config.singleVisual,t=this.services.visualPlugin.capabilities(e.visualType),a=_.find(t.dataRoles,function(e){return 0===e.cartesianKind}),n=!1,r=!1;if(a){var o=e.query.defn.select(),t=e.query.projections,a=a.name;if(!t[a])return;for(var s=0,l=t[a].all();s<l.length;s++)!function(t){var e=_.find(o,function(e){return t.queryRef===e.name}),e=e.expr.getMetadata(i);n=n||e.type.dateTime}(l[s]);r=c.ScalarKeyUtils.isScalarKeySupportedForRole(i,e.query.defn,e.query.projections,a)}n||r?this.parameterSlices[d.unitsSliceName].selectionOptions=this.getSelectionOptions(p.type.members()):(this.parameterSlices[d.unitsSliceName].selectionOptions=[_.last(this.getSelectionOptions(p.type.members()))],this.parameterSlices[d.unitsSliceName].value=this.defaultParameterValues[d.unitsSliceName])},v.prototype.getForecastTransform=function(){var e=u.getSingleVisualConfig(this.visualContainer);if(e&&this.currentInstance)return r.getValue(e.objects,{objectName:"forecast",propertyName:"transform"},this.currentInstance.selector)},v.prototype.getTransformParameters=function(){var e,t=[];for(e in this.parameterSlices){var i=this.parameterSlices[e].value;switch(e){case d.forecastDataPointsSliceName:case d.ignoreDataPointsSliceName:_.isFinite(parseInt(i,10))||(i=this.defaultParameterValues[e]);break;case d.unitsSliceName:i=this.getUnitsQueryValue(i);break;case d.confidenceIntervalSliceName:i=this.getConfidenceIntervalQueryValue(i);break;case d.seasonalitySliceName:if(!_.isFinite(parseInt(i,10)))continue}var a=this.parameterSlices[e].type,a=r.encodePropertyValue(i,a);a instanceof l&&l.isConstant(a),t.push({name:this.parameterSlices[e].name,expr:a})}return t},v.prototype.getSelectionOptions=function(e){return _.map(e,function(e){return{value:e.value,displayName:a.ViewModelFactory.getDisplayName(e.displayName)}})},v.prototype.getConceptualSchema=function(t){var e=this.services.dataSources.get();return this.services.conceptualSchemaProxy.get(e).then(function(e){return{schema:e,visualContainer:t}})},v.prototype.mapUnitsEnumStringsToNumbers=function(e){for(var t={},i=0;i<e.length;i++)t[e[i].value]=i;return t},v.prototype.getUnitsQueryValue=function(e){return this.unitsMap[e]},v.prototype.getUnitsEnumValue=function(t){var i=this;return _.find(_.keys(this.unitsMap),function(e){return i.unitsMap[e]===t})},v.prototype.getConfidenceIntervalQueryValue=function(e){return parseFloat(e)/100},v.prototype.getConfidenceIntervalEnumValue=function(e){return 100*e+"%"},i=v;function v(e,t){this.services=t,this.newPaneColorsEnabled=this.services.explorationCapabilities.getCapabilities().showFluentDesign||this.services.featureSwitchService.featureSwitches&&this.services.featureSwitchService.featureSwitches.paneColorRefresh;var i=p.type.members();this.units=this.getSelectionOptions(i),this.defaultParameterValues=((t={})[d.unitsSliceName]=p.point,t[d.forecastDataPointsSliceName]=10,t[d.ignoreDataPointsSliceName]=0,t[d.confidenceIntervalSliceName]=o.ninetyFive,t[d.seasonalitySliceName]=void 0,t),this.parameterSlices=((t={})[d.unitsSliceName]={name:"Unit",value:this.defaultParameterValues[d.unitsSliceName],selectionOptions:this.units,type:{enumeration:p.type}},t[d.forecastDataPointsSliceName]={name:"ForecastLength",value:this.defaultParameterValues[d.forecastDataPointsSliceName],type:{numeric:!0},validators:{decimal:!0,min:1,max:2e9,integer:!0},tooltipConfig:{tooltipTitle:this.services.localizationService.get("Visual_Forecast_Parameter_ForecastLength"),tooltipDescription:this.services.localizationService.get("Visual_Forecast_Parameter_ForecastLength_Description")}},t[d.ignoreDataPointsSliceName]={name:"IgnoreLast",value:this.defaultParameterValues[d.ignoreDataPointsSliceName],type:{numeric:!0},validators:{decimal:!0,min:0,max:500,integer:!0},tooltipConfig:{tooltipTitle:this.services.localizationService.get("Visual_Forecast_Parameter_IgnoreLength"),tooltipDescription:this.services.localizationService.get("Visual_Forecast_Parameter_IgnoreLength_Description")}},t[d.confidenceIntervalSliceName]={name:"ConfidenceLevel",value:this.defaultParameterValues[d.confidenceIntervalSliceName],selectionOptions:this.getSelectionOptions(o.type.members()),type:{enumeration:o.type},tooltipConfig:{tooltipTitle:this.services.localizationService.get("Visual_Forecast_Parameter_ConfidenceInterval"),tooltipDescription:this.services.localizationService.get("Visual_Forecast_Parameter_ConfidenceInterval_Description")}},t[d.seasonalitySliceName]={name:"MaxSeasonality",value:this.defaultParameterValues[d.seasonalitySliceName],type:{numeric:!0},placeholder:this.services.localizationService.get("Visual_Auto"),validators:{decimal:!0,min:1,max:2e9,integer:!0},tooltipConfig:{tooltipTitle:this.services.localizationService.get("Visual_Forecast_Parameter_Seasonality"),tooltipDescription:this.services.localizationService.get("Visual_Forecast_Parameter_Seasonality_Description")}},t),this.unitsMap=this.mapUnitsEnumStringsToNumbers(i)}t.ForecastCardController=i}),define("ExploreUIShell/components/forecastCard/forecastCard",["require","exports","ExploreUIShell/components/forecastCard/forecastCardController"],function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.ForecastCard=void 0;var a=powerbi.common.createController;t.ForecastCard={templateUrl:"components/forecastCard/forecastCard.html",bindings:{card:"<",displayName:"<",description:"<",visualContainer:"<",instances:"<"},controller:a(i.ForecastCardController)}}),define("ExploreUIShell/components/anomalyDetectionCard/anomalyDetectionCardController",["require","exports","ExploreUIShell/components/analyticsCard/analyticsCardController"],function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.AnomalyDetectionCardController=void 0;var i=powerbi,a=i.data,r=i.explore,i=r.viewModels,r=r.util,o=powerbi.visuals.AnomalyDetectionObjectConstants,s=powerbi.visuals.AnomalyDetectionTransformConstants,l=a.DataViewObjectDefinitions,c=i.PropertySliceNames,u=a.SQExpr,p=powerbi.data.SQExprUtils,d=r.VisualContainerUtils,r=(v.createOptions=function(){return{additionalServices:["localizationService","conceptualSchemaProxy","telemetryService","featureSwitchService"],scopedDependencies:["dataSources","explorationCapabilities","undoRedo","visualAuthoring","visualPlugin"]}},v.prototype.$onInit=function(){var e;!this.visualContainer||(e=d.getObjectDefinitions(this.visualContainer))&&l.deleteObjectDefinition(e,o.capabilityObjectName,void 0)},v.prototype.onAddInstance=function(e,t){this.currentInstance=t;var i=this.getTransformParameters(),e=_.find(e.merge,function(e){return a.Selector.equals(e.selector,t.selector)});t.selector.metadata=this.getBoundMeasure(),t.selector.metadata,e.properties[s.transformPropertyName]={algorithm:s.transformPluginName,parameters:i},e.properties[o.explainByPropertyName]={exprs:[]},this.updateParameterValuesFromTransform(),this.updateFieldsFromExplainBy()},v.prototype.onUpdateInstance=function(e){e?(this.currentInstance=e,this.updateParameterValuesFromTransform(),this.updateFieldsFromExplainBy()):this.currentInstance=null},v.prototype.onDeleteInstance=function(e){this.currentInstance=null,this.fieldPickerParameters.column.value=[]},v.prototype.onSave=function(e,t){if(t.name===c.RevertToDefault)return this.updateParameterValuesFromTransform(!0),this.saveAnomalyDetectionParametersAction(),!1},v.prototype.onSensitivitySliderChanged=function(e){this.parameterSlices[o.sensitivitySliceName].value=e},v.prototype.saveFieldPickerParameters=function(){var e=this;this.services.undoRedo.register("save anomaly detection field picker",function(){return e.saveFieldPickerParametersAction()})},v.prototype.saveFieldPickerParametersAction=function(){var e={merge:[{objectName:o.capabilityObjectName,properties:{explainBy:{exprs:this.fieldPickerParameters.column.value,kind:"ExprList"}},selector:this.currentInstance.selector}]};return this.updateChanges(e),!0},v.prototype.hasExplainByListChanged=function(){var e=this.getExplainByList(),t=this.fieldPickerParameters.column.value,i=_.size(null==e?void 0:e.exprs),a=_.size(t);if(0===i&&0===a)return!1;if(i!==a)return!0;for(var n=0;n<e.exprs.length;n++){var r=e.exprs[n],o=t[n];if(!u.equals(r,o))return!0}return!1},v.prototype.saveAnomalyDetectionParameters=function(){var e=this;this.services.undoRedo.register("save anomaly detection",function(){return e.saveAnomalyDetectionParametersAction()})},v.prototype.saveAnomalyDetectionParametersAction=function(){var e=this.getAnomalyDetectionTransform();if(!e)return!1;e={merge:[{objectName:o.capabilityObjectName,selector:this.currentInstance.selector,properties:{transform:{algorithm:e.algorithm,parameters:this.getTransformParameters()}}}]};return this.updateChanges(e),!0},v.prototype.isDisabled=function(){return!this.getAnomalyDetectionTransform()},v.prototype.isCardDirty=function(e,t){if(e&&t)return n.AnalyticsCardControllerBase.isCardDirty(e,t);var i,a=!1;for(i in this.parameterSlices)if(this.parameterSlices[i].value!==this.defaultParameterValues[i]){a=!0;break}return a},v.prototype.haveParametersChanged=function(){var i=this,a=this.getAnomalyDetectionTransform();if(!a)return!1;var e,n=this;for(e in this.parameterSlices){var t=function(t){var e=_.find(a.parameters,function(e){return e.name===i.parameterSlices[t].name});if(n.getNumericParameterValueFromObjects(e)!==n.parameterSlices[t].value)return{value:!0}}(e);if("object"==typeof t)return t.value}return!1},v.prototype.getBoundMeasure=function(){for(var e=this.visualContainer,t=d.getVisualQuery(e),i=0,a=d.getDataRolesForVisual(e,this.services.visualPlugin)||[];i<a.length;i++){var n=a[i];if(1===n.cartesianKind){n=t.getQueryRefByProjectionIndex(n.name,0);if(n)return n}}},v.prototype.updateFieldsFromExplainBy=function(){var e=this.getExplainByList();e&&!_.isEmpty(e.exprs)&&(this.fieldPickerParameters.column.value=e.exprs)},v.prototype.updateParameterValuesFromTransform=function(i){var e,a=this.getAnomalyDetectionTransform(),n=this;for(e in this.parameterSlices)!function(e){var t=n.parameterSlices[e];t.value=n.defaultParameterValues[e],!i&&a&&(e!==o.sensitivitySliceName||(e=_.find(a.parameters,function(e){return e.name===t.name}))&&(u.isConstant(e.expr),t.value=n.getNumericParameterValueFromObjects(e)))}(e)},v.prototype.getNumericParameterValueFromObjects=function(e){if(e&&e.expr&&u.isConstantNumeric(e.expr))return e.name!==o.transformParameterSensitivityName?void e.name:this.transformParameterToParameterSlicePercent(e)},v.prototype.getAnomalyDetectionTransform=function(){if(this.currentInstance){var e=d.getSingleVisualConfig(this.visualContainer);if(null!=e&&e.objects)return l.getValue(e.objects,s.transformProperty,this.currentInstance.selector)}},v.prototype.getExplainByList=function(){if(this.currentInstance){var e=d.getSingleVisualConfig(this.visualContainer);if(null!=e&&e.objects)return l.getValue(e.objects,s.explainByProperty,this.currentInstance.selector)}},v.prototype.getTransformParameters=function(){var e,t=[];for(e in this.parameterSlices){var i,a=this.parameterSlices[e],n=void 0;e===o.sensitivitySliceName&&(_.isFinite(a.value)||(a.value=this.defaultParameterValues[e]),i=this.parameterSlicePercentToTransformParameter(a.value),n=l.encodePropertyValue(i,{numeric:!0})),t.push({name:a.name,expr:n})}return t},v.prototype.parameterSlicePercentToTransformParameter=function(e){return e/100},v.prototype.transformParameterToParameterSlicePercent=function(e){e=p.getPrimitiveValuesFromSQConstantExpr(e.expr);return _.isFinite(e),Math.round(100*e)},v.prototype.updateChanges=function(e){this.services.visualAuthoring.persistProperties(e,this.visualContainer,!0),this.services.visualAuthoring.raiseVisualContainerChanged(this.visualContainer)},v);function v(e,t){this.dropMode=1,this.sliderPercentSymbol="Slider_Percent",this.services=t,this.defaultParameterValues=((t={})[o.sensitivitySliceName]=Math.round(100*s.defaultSensitivityValue),t),this.parameterSlices=((t={})[o.sensitivitySliceName]={name:o.transformParameterSensitivityName,value:this.defaultParameterValues[o.sensitivitySliceName],type:{integer:!0},validators:{minValue:0,maxValue:100,integer:!0,unitSymbol:this.sliderPercentSymbol},tooltipConfig:{tooltipTitle:this.services.localizationService.get(o.transformParameterSensitivityName),tooltipDescription:this.services.localizationService.get("Visual_AnomalyDetection_Parameter_Sensitivity_Description")}},t),this.fieldPickerParameters={name:o.explainByPropertyName,displayName:o.explainByPropertyName,column:{value:[],validationInfo:{field:{kind:0}},tooltipConfig:{tooltipTitle:this.services.localizationService.get("Role_DisplayName_ExplainBy"),tooltipDescription:this.services.localizationService.get("ExplainAnomalyVisual_FieldPicker_Description")}}}}t.AnomalyDetectionCardController=r}),define("ExploreUIShell/components/anomalyDetectionCard/anomalyDetectionCard",["require","exports","ExploreUIShell/components/anomalyDetectionCard/anomalyDetectionCardController"],function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.AnomalyDetectionCard=void 0;var a=powerbi.common.createController;t.AnomalyDetectionCard={templateUrl:"components/anomalyDetectionCard/anomalyDetectionCard.html",bindings:{card:"<",displayName:"<",description:"<",visualContainer:"<",instances:"<"},controller:a(i.AnomalyDetectionCardController)}}),define("ExploreUIShell/components/referenceLineCard/referenceLineCardController",["require","exports","ExploreUIShell/components/analyticsCard/analyticsCardController"],function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.ReferenceLineCardController=void 0;var i=powerbi,r=i.data,a=i.explore.viewModels,o=a.ReferenceLineType,s=powerbi.data.DataViewObjectDefinitions,i=(l.createOptions=function(){return{additionalServices:["conceptualSchemaProxy","localizationService","telemetryService"],scopedDependencies:["explorationDisplayNameService","undoRedo","visualAuthoring","visualPlugin"]}},l.prototype.saveExpression=function(e,t,i){void 0===i&&(i="90");var a=this.line.valueDecorator(r.SQExprBuilder.selectRef(t),i);e.selector.metadata!==t&&((i=this.visualContainer.config.singleVisual.objects)&&s.updateSelector(i,this.card.name,e.selector,{id:e.selector.id,metadata:t}),e.selector.metadata=t),e.properties.value=a},l.prototype.onUpdateInstance=function(e){e&&(this.measureSlice=n.AnalyticsCardControllerBase.findSlice(e,"measure"),this.percentileSlice=n.AnalyticsCardControllerBase.findSlice(e,"percentile"),this.measureSlice&&(!this.measureSlice.value&&this.validMeasures[0]&&(this.measureSlice.value=this.validMeasures[0].value),this.measureSlice.selectionOptions=this.validMeasures))},l.prototype.onAddInstance=function(e,t){t.type=this.line.type,this.services.telemetryService.logEvent(powerbi.telemetry.EXAnalyticsPaneAddInstance,{objectName:a.ReferenceLineType[this.line.type]}),_.isEmpty(this.validMeasures)||(t={objectName:this.card.name,selector:t.selector,properties:{}},this.saveExpression(t,this.validMeasures[0].value),e.merge||(e.merge=[]),e.merge.push(t))},l.prototype.onSave=function(e,t,i){if("revertToDefault"===t.name){var a={objectName:this.card.name,selector:t.selector,properties:{}};return this.validMeasures[0]&&this.saveExpression(a,this.validMeasures[0].value,"90"),e.merge||(e.merge=[]),e.merge.push(a),!1}if("measure"!==t.name&&"percentile"!==t.name)return!1;a={objectName:this.card.name,selector:t.selector,properties:{}};return this.measureSlice=this.measureSlice||n.AnalyticsCardControllerBase.findSlice(i,"measure"),this.percentileSlice=this.percentileSlice||n.AnalyticsCardControllerBase.findSlice(i,"percentile"),this.saveExpression(a,this.measureSlice.value,this.percentileSlice?this.percentileSlice.value:null),e.merge||(e.merge=[]),e.merge.push(a),!0},l.prototype.getLineType=function(e){switch(e.type){case o.Average:return"Average";case o.Constant:return"Constant";case o.Max:return"Max";case o.Median:return"Median";case o.Min:return"Min";case o.Percentile:return"Percentile"}},l.prototype.isCardDirty=function(e,t){if("value"!==e)return n.AnalyticsCardControllerBase.isCardDirty(e,t);e=this.measureSlice&&this.measureSlice.value&&this.measureSlice.value!==this.measureSlice.selectionOptions[0].value,t=this.percentileSlice&&this.percentileSlice.value&&"90"!==this.percentileSlice.value.toString();return e||t},l);function l(e,t){this.services=t}t.ReferenceLineCardController=i}),define("ExploreUIShell/components/referenceLineCard/referenceLineCard",["require","exports","ExploreUIShell/components/referenceLineCard/referenceLineCardController"],function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.ReferenceLineCard=void 0;var a=powerbi.common.createController;t.ReferenceLineCard={templateUrl:"components/referenceLineCard/referenceLineCard.html",bindings:{card:"<",displayName:"<",description:"<",visualContainer:"<",instances:"<",line:"<",validMeasures:"<"},controller:a(i.ReferenceLineCardController)}}),function(r){var e,o;e=r.explore||(r.explore={}),(e=(o=e.viewModels||(e.viewModels={})).ReferenceLineType||(o.ReferenceLineType={}))[e.Constant=0]="Constant",e[e.Min=1]="Min",e[e.Max=2]="Max",e[e.Average=3]="Average",e[e.Median=4]="Median",e[e.Percentile=5]="Percentile",(o.ReferenceLineCardContainerViewModelFactory||(o.ReferenceLineCardContainerViewModelFactory={})).buildReferenceLines=function(e,t,i,a){var n=[{displayName:t.get("Visual_Min_Reference_Line"),type:o.ReferenceLineType.Min,valueDecorator:function(e){return r.data.SQExprBuilder.aggregate(e,3)},instances:_.chain(e.instances).filter({type:o.ReferenceLineType.Min}).sortBy(function(e){return parseInt(e.selector.id,10)}).value()},{displayName:t.get("Visual_Max_Reference_Line"),type:o.ReferenceLineType.Max,valueDecorator:function(e){return r.data.SQExprBuilder.aggregate(e,4)},instances:_.chain(e.instances).filter({type:o.ReferenceLineType.Max}).sortBy(function(e){return parseInt(e.selector.id,10)}).value()},{displayName:t.get("Visual_Average_Reference_Line"),type:o.ReferenceLineType.Average,valueDecorator:function(e){return r.data.SQExprBuilder.aggregate(e,1)},instances:_.chain(e.instances).filter({type:o.ReferenceLineType.Average}).sortBy(function(e){return parseInt(e.selector.id,10)}).value()}];return i&&n.push({displayName:t.get("Visual_Median_Reference_Line"),type:o.ReferenceLineType.Median,valueDecorator:function(e){return r.data.SQExprBuilder.aggregate(e,6)},instances:_.chain(e.instances).filter({type:o.ReferenceLineType.Median}).sortBy(function(e){return parseInt(e.selector.id,10)}).value()}),a&&n.push({displayName:t.get("Visual_Percentile_Reference_Line"),type:o.ReferenceLineType.Percentile,valueDecorator:function(e,t){t=parseFloat(t),t=_.isNaN(t)?0:Math.min(Math.max(0,t),100);return r.data.SQExprBuilder.percentile(e,t/100,!1)},instances:_.chain(e.instances).filter({type:o.ReferenceLineType.Percentile}).sortBy(function(e){return parseInt(e.selector.id,10)}).value()}),n}}(powerbi=powerbi||{}),define("ExploreUIShell/components/referenceLineCardContainer/referenceLineCardContainerController",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ReferenceLineCardContainerController=void 0;var i=powerbi.explore.viewModels,y=i.AnalyticsPaneViewModelFactory,f=i.PropertyPaneUtils,b=i.ReferenceLineCardContainerViewModelFactory,S=jsCommon.StringExtensions,i=(a.createOptions=function(){return{additionalServices:["conceptualSchemaProxy","localizationService"],scopedDependencies:["dataSources"]}},a.prototype.$onInit=function(){this.setReferenceLines()},a.prototype.$onChanges=function(){this.setReferenceLines()},a.prototype.setReferenceLines=function(){var m=this,e=this.services.dataSources.get();this.services.conceptualSchemaProxy.get(e).then(function(e){var t=!1,i=!1;if(m.validMeasures)for(var a=0,n=m.validMeasures;a<n.length;a++){var r=n[a].selectExpr.expr.getTargetEntity().schema,r=e.schema(r);r&&(r.capabilities.supportsMedian&&(t=!0),r.capabilities.supportsPercentile&&(i=!0))}var o=m.prototypeCard;o.filtered=!0,m.referenceLines=b.buildReferenceLines(o,m.services.localizationService,t,i);for(var s=S.literalStringToRegex(m.filter||"","i"),l=0,c=m.referenceLines;l<c.length;l++){for(var u=c[l],p=f.matchFilter(u,s),d=!0,v=0,h=u.instances;v<h.length;v++)var g=h[v],d=y.filterInstance(g,s,p,d);u.filtered=y.filterInstance(o.defaultInstance,s,p,d),o.filtered=o.filtered&&u.filtered}})},a);function a(e,t){this.services=t}t.ReferenceLineCardContainerController=i}),define("ExploreUIShell/components/referenceLineCardContainer/referenceLineCardContainer",["require","exports","ExploreUIShell/components/referenceLineCardContainer/referenceLineCardContainerController"],function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.ReferenceLineCardContainer=void 0;var a=powerbi.common.createController;t.ReferenceLineCardContainer={templateUrl:"components/referenceLineCardContainer/referenceLineCardContainer.html",bindings:{filter:"<",prototypeCard:"<",visualContainer:"<",validMeasures:"<"},controller:a(i.ReferenceLineCardContainerController)}}),function(s){var l;(function(n){var t=s.visuals.GeoJsonHelper,e=l.util.PropertyPaneUtils;n.ShapeMapSelectorControllerCustomItemValue="@@custom@@";var i=(Object.defineProperty(a.prototype,"items",{get:function(){return a.standardMaps||(a.standardMaps=e.getDisplayNames(s.visuals.standardGeoJson.type.members())),a.standardMapsPlusCustom||(a.CustomItemDisplayName||(a.CustomItemDisplayName=this.services.localizationService.get("Visual_ShapeMap_PropertyPaneCustomMapLabel")),a.standardMapsPlusCustom=a.standardMaps.concat({value:n.ShapeMapSelectorControllerCustomItemValue,displayName:a.CustomItemDisplayName})),this.customMapName()?a.standardMapsPlusCustom:a.standardMaps},enumerable:!1,configurable:!0}),a.createOptions=function(){return{additionalServices:["$element","localizationService","featureSwitchService","modernDialogService"],scopedDependencies:["explorationCapabilities"]}},a.prototype.$onDestroy=function(){this.abortFileInput()},a.prototype.$onInit=function(){var e=this;this.loadedCustomMap=r(this.viewModel),this.fileInput=this.services.$element.find(".file-input"),this.fileInput.change(function(){e.fileInputChanged()}),this.type.geoJson.contentType===s.GeoJsonContentTypes.geojson&&(this.buttonTextKey="PropertyPane_AddLocalFile",this.fileType=".json,.geojson",this.showDropDown=!1)},a.prototype.change=function(){this.changed&&(this.viewModel.type,this.viewModel.name,this.viewModel.type===s.GeoJsonTypes.packaged&&!this.viewModel.content||this.viewModel.type===s.GeoJsonTypes.shared&&!this.viewModel.name||null==this.viewModel.type||null==this.viewModel.name||this.changed())},Object.defineProperty(a.prototype,"selectedMapName",{get:function(){return this.viewModel.type===s.GeoJsonTypes.packaged?n.ShapeMapSelectorControllerCustomItemValue:this.viewModel.name},set:function(e){e===n.ShapeMapSelectorControllerCustomItemValue?this.loadedCustomMap&&(this.viewModel.type=s.GeoJsonTypes.packaged,this.viewModel.name=this.loadedCustomMap.name,this.viewModel.content=this.loadedCustomMap.content):(this.viewModel.type=s.GeoJsonTypes.shared,this.viewModel.name=e,this.viewModel.content=null),this.change()},enumerable:!1,configurable:!0}),a.prototype.customMapName=function(){if(this.viewModel.type===s.GeoJsonTypes.packaged)return this.loadedCustomMap&&this.loadedCustomMap.name},a.prototype.addCustomMap=function(){this.fileInput.val(""),this.fileInput.click()},a.prototype.removeCustomMap=function(){this.loadedCustomMap=void 0,this.viewModel.type===s.GeoJsonTypes.packaged&&(this.selectedMapName=s.visuals.standardGeoJson.usaStates)},a.prototype.abortFileInput=function(){this.lastReader&&(this.lastReader.abort(),this.lastReader=void 0)},a.prototype.fileInputChanged=function(){var t=this;this.abortFileInput();var i,a,e=this.fileInput.get(0).files;e&&e.length&&(i=e[0],(a=new FileReader).onabort=function(e){t.lastReader=void 0},a.onerror=function(e){t.lastReader=void 0},a.onload=function(e){a===t.lastReader&&(t.lastReader=void 0,t.loadedCustomMap=o(i.name,a.result),t.selectedMapName=n.ShapeMapSelectorControllerCustomItemValue)},(this.lastReader=a).readAsText(i))},a.prototype.showDialog=function(){var e;this.viewModel&&this.viewModel.content&&(!(e=jsCommon.JsonExtensions.tryParseJSON(this.viewModel.content))||(e=t.getTopoJsonShapeKeys(e))&&(e={columnNames:e.names,tableValues:e.values,titleKey:"Visual_ShapeMap_MapKeysDialog_Title"},e={cancelButtonIsPrimary:!0,cancelButtonText:this.services.localizationService.get("TableViewDialog_CloseButtonText"),hideOkButton:!0,title:this.services.localizationService.get("Visual_ShapeMap_MapKeysDialog_Title"),modulePath:"@powerbi/ExploreUIDialogs/table-view-dialog.module#TableViewDialogModule",componentId:"TableViewDialogComponentId",inputArgs:e},this.services.modernDialogService.openHostDialog({bindings:e,componentName:"SimpleTemplateDialogComponent",config:{disableClose:!0},dialogName:"SimpleTemplateDialogComponent"})))},a.prototype.customMapLabel=function(){return this.viewModel.type!==s.GeoJsonTypes.shared&&this.viewModel.name?this.viewModel.name:this.services.localizationService.get("PropertyPane_AddShapeMap")},a);function a(e,t){this.buttonTextKey="PropertyPane_AddShapeMap",this.fileType=".json",this.showDropDown=!0,this.services=t,this.newPaneColorsEnabled=this.services.explorationCapabilities.getCapabilities().showFluentDesign||this.services.featureSwitchService.featureSwitches&&this.services.featureSwitchService.featureSwitches.paneColorRefresh}function r(e){if(e&&e.type===s.GeoJsonTypes.packaged&&e.name&&e.content)return{name:e.name,content:e.content}}function o(e,t){if(e&&t)return{name:e,content:t}}n.ShapeMapSelectorController=i,n.FromGeoJson=r,n.FromFile=o})((l=s.explore||(s.explore={})).controllers||(l.controllers={}))}(powerbi=powerbi||{}),function(e){var t;((t=e.explore||(e.explore={})).components||(t.components={})).ShapeMapSelector={templateUrl:"components/shapeMapSelector/shapeMapSelector.html",bindings:{viewModel:"<",changed:"&",type:"<"},controller:e.common.createController(t.controllers.ShapeMapSelectorController)}}(powerbi=powerbi||{}),function(u){var p;(function(e){var r=u.explore.services.events,o=u.explore.modules,i=u.visuals.plugins,t=p.services.selectionUtils,s=p.util.VisualContainerUtils,a=(Object.defineProperty(n.prototype,"newColorsEnabled",{get:function(){return this.core.newColorsEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"viewModel",{set:function(e){this.$scope.viewModel=e},enumerable:!1,configurable:!0}),n.createOptions=function(){return{additionalServices:["highContrastCssGenerationService","featureSwitchService","localizationService","telemetryService","promiseFactory","favoriteVisualLoader","visualPaneSettingsService","svgProvider","globalEventBridge"],scopedDependencies:["eventBridge","explorationCapabilities","selection","viewModeState","visualPlugin","visualPluginOps","explorationNavigation","undoRedo"]}},n.prototype.$onInit=function(){this.initializeHighContrastRules(),this.$scope.focusedSection=this.$scope.viewModel.activeSection,this.useModernFieldWell=this.services.featureSwitchService.featureSwitches.useModernFieldWell},Object.defineProperty(n.prototype,"exploreUIAuthoringModulePath",{get:function(){return this.core.exploreUIAuthoringModulePath()},enumerable:!1,configurable:!0}),n.prototype.initializeHighContrastRules=function(){this.services.highContrastCssGenerationService.addRule(".themeableElement .navMarker","{ background: @foregroundColor !important; }"),this.services.highContrastCssGenerationService.addRule(".themeableElement .visualizationPane .pivotNav li:focus, .themeableElement .visualizationPane .pivotNav li:hover","{ background-color: @selectedBackgroundColor !important; }"),this.services.highContrastCssGenerationService.addRule(".themeableElement .propertyPaneContents .inputField .inputFieldInSlice:hover,\n            .themeableElement .propertyPaneContents .inputField .inputRange:hover, .themeableElement .propertyPaneContents .inputField\n            .themeableElement .inputUpDown:hover, .themeableElement .propertyPaneContents .inputField .paragraph:hover,\n            .themeableElement .propertyPaneContents .inputField .select-element:hover, .themeableElement .propertyPaneContents .inputField .selection-box:hover,\n            .themeableElement .propertyPaneContents .inputField .ui-widget:hover","{ border-color: @selectedBackgroundColor !important; }"),this.services.highContrastCssGenerationService.addRule(".themeableElement .propertyPaneContents .inputField .clearAll","{ border-color: transparent !important; }")},n.prototype.toggleEffectClasses=function(e,t,i){this.services.svgProvider.toggleCssClasses(t,i?"hover":"focus",this.$scope.sectionIconSheetName,this.$scope.getSectionIconSymbolId(e))},n.prototype.setActiveSection=function(e){this.$scope.viewModel.previousSection=this.$scope.viewModel.activeSection,this.$scope.viewModel.activeSection=e,this.updateShowHideElements()},n.prototype.setActivePagePaneSection=function(e){this.$scope.viewModel.previousPageSection=this.$scope.viewModel.activePageSection,this.$scope.viewModel.activePageSection=e,this.updateShowHideElements()},n.prototype.updateAll=function(){var e=this.$scope.viewModeState.getMode();this.$scope.isEditing=1===e,this.$scope.populatePanes=this.$scope.isEditing||this.$scope.viewModeState.getConfig().alwaysPopulatePanes,this.$scope.showVisualTypes=this.$scope.populatePanes,this.$scope.viewModel&&(this.updateShowHideElements(),this.updateSections(),this.updatePagePaneSections(),this.updateHeader(),this.updateExplorationVisuals())},n.prototype.updateExplorationVisuals=function(){if(this.$scope.isEditing){this.services.visualPaneSettingsService.resetExplorationVisuals();var e=this.services.explorationNavigation.getCurrentExploration();if(e)for(var t=0,i=e.sections;t<i.length;t++)for(var a=0,n=i[t].visualContainers;a<n.length;a++){var r=n[a];this.services.visualPaneSettingsService.addExplorationVisual(r.config.singleVisual.visualType)}}},n.prototype.updateShowHideElements=function(){var e=this.$scope.viewModel.activeSection,t=this.$scope.viewModel.activePageSection,i=this.$scope.populatePanes,a=this.getSelectedVisual();this.$scope.showVisualTypes=a?i&&(p.contracts.isVisualContainerGroup(a)||this.services.visualPluginOps.canConvertVisual(a)):i,this.$scope.showFieldWellOrFilters=!e&&!t||e===p.viewModels.VisualizationPaneSectionType.Fields||t===p.viewModels.PagePaneSectionType.Fields,this.$scope.showFieldWell=i&&(e===p.viewModels.VisualizationPaneSectionType.Fields||t===p.viewModels.PagePaneSectionType.Fields),this.$scope.showPropertyPane=i&&e===p.viewModels.VisualizationPaneSectionType.Format,this.$scope.showPagePropertyPane=i&&t===p.viewModels.PagePaneSectionType.Format&&!this.$scope.isNonQueryVisual,this.$scope.showAnalyticsPane=i&&e===p.viewModels.VisualizationPaneSectionType.Analytics,this.$scope.showDrillthroughPane=this.$scope.showFieldWellOrFilters},n.prototype.updateSections=function(){var e=this.getSelectedVisual(),t=this.$scope.viewModel,i=s.getVisualType(e),a=this.services.visualPluginOps,n=e&&p.contracts.isVisualContainer(e)&&a.isSupportedVisual(e),i=i&&a.isQueryVisual(i);this.$scope.isNonQueryVisual=void 0!==e&&!i,t.sections=[],e&&(p.contracts.isVisualContainerGroup(e)||n)?(this.$scope.isEditing&&this.$scope.isNonQueryVisual?this.setActiveSection(p.viewModels.VisualizationPaneSectionType.Format):(n=t.activeSection,this.$scope.isEditing&&void 0!==n||this.setActiveSection(p.viewModels.VisualizationPaneSectionType.Fields),t.sections.push({sectionType:p.viewModels.VisualizationPaneSectionType.Fields,displayName:this.services.localizationService.get("VisualizationPane_Section_Fields"),cssClass:"fields"})),(p.contracts.isVisualContainerGroup(e)||a.canFormatVisual(e))&&(t.sections.push({sectionType:p.viewModels.VisualizationPaneSectionType.Format,displayName:this.services.localizationService.get("Format"),cssClass:"format"}),t.sections.push({sectionType:p.viewModels.VisualizationPaneSectionType.Analytics,displayName:this.services.localizationService.get("VisualizationPane_Section_Analytics"),cssClass:"analytics"}))):this.setActiveSection(void 0)},n.prototype.updatePagePaneSections=function(){var e=this.getSelectedVisual(),t=this.$scope.viewModel;t.pagePaneSections=[],e?this.setActivePagePaneSection(void 0):(this.$scope.isEditing&&void 0!==t.activePageSection||this.setActivePagePaneSection(p.viewModels.PagePaneSectionType.Fields),t.pagePaneSections.push({sectionType:p.viewModels.PagePaneSectionType.Fields,displayName:this.services.localizationService.get("VisualizationPane_Section_Fields"),cssClass:"fields"}),t.pagePaneSections.push({sectionType:p.viewModels.PagePaneSectionType.Format,displayName:this.services.localizationService.get("Format"),cssClass:"format"}))},n.prototype.updateHeader=function(){var e,t=this.$scope.populatePanes?((e=this.getSelectedVisual())&&p.contracts.isVisualContainer(e)&&((e=e.config.singleVisual.visualType)===i.basicShape.name||e===i.shape.name?t="VisualizationPane_Shape":e===i.image.name?t="VisualizationPane_Image":e===i.textbox.name?t="VisualizationPane_Text_Box":e===i.actionButton.name?t="VisualizationPane_Action_Button":e!==i.pageNavigator.name&&e!==i.bookmarkNavigator.name||(t="VisualizationPane_Navigator")),t||"VisualizationPane_Title"):"VisualizationPane_Filters";this.$scope.viewModel.header=this.services.localizationService.get(t)},n.prototype.toggle=function(){this.$scope.viewModel.isPaneExpanded=!this.$scope.viewModel.isPaneExpanded,this.services.telemetryService.logEvent(u.telemetry.EXTogglePaneExpanded,{paneType:"Visualization",expanded:this.$scope.viewModel.isPaneExpanded,viewMode:p.util.getTelemetryViewMode(this.services.viewModeState.getMode())})},n.prototype.getSelectedVisual=function(){return t.getDefaultSelectedVisualInSingleOrMultiCase(this.services.selection)},n);function n(e,t){var a=this;this.$scope=e,this.services=t,this.core=new l(t),this.$scope.viewModeState=t.viewModeState,this.$scope.setActiveSection=function(e){return a.setActiveSection(e)},this.$scope.setActivePagePaneSection=function(e){return a.setActivePagePaneSection(e)},this.$scope.toggleEffectClasses=function(e,t,i){return a.toggleEffectClasses(e,t,i)},this.$scope.toggle=function(){return a.toggle()},this.$scope.exploreUIShellConfig=o.ExploreUIShellModule,this.$scope.scrollbarsConfig={ignoreOverlay:!1,ignoreMobile:!1},this.core.$onInit(),this.$scope.personalVisualizationPanePrepared=!1,this.$scope.showNonPersonalVisualizationPane=function(){return a.core.showNonPersonalVisualizationPane()},this.$scope.onVisualTypesContainerDoneLoading=function(){a.$scope.isPersonalVisualTypesLoaded=!0},this.$scope.getSectionIconSymbolId=function(e){return"visualizationPane"+_.upperFirst(e)+a.core.newColorsSuffix},this.$scope.sectionIconSheetName="visualizationPaneIcons"+this.core.newColorsSuffix,this.updateAll();var i=this.services.eventBridge.createChannelSubscriptionManager().subscribe(r.selectionChanged,function(){a.updateSections(),a.updateHeader(),a.updatePagePaneSections()}).subscribe(r.visualTypeChanged,function(){a.updateSections(),a.updateHeader(),a.updatePagePaneSections()}).subscribe(r.preparePersonalVisuals,function(){a.core.preparePersonalVisualizationPane()}).subscribe(r.explorationContainerReady,function(){return a.updateAll()}).subscribe(r.findAnomalies,function(){a.setActiveSection(p.viewModels.VisualizationPaneSectionType.Analytics)}).subscribe(r.forecast,function(){a.setActiveSection(p.viewModels.VisualizationPaneSectionType.Analytics)}),n=this.services.globalEventBridge.createChannelSubscriptionManager().subscribe(u.host.global.events.SignInStatusChangedEvent,function(){a.services.favoriteVisualLoader.reset(a.services.visualPlugin),a.services.visualPaneSettingsService.reset(),a.core.preparePersonalVisualizationPane()});this.$scope.$watchGroup(["viewModeState.getMode()","viewModeState.getConfig().alwaysPopulatePanes"],function(){return a.updateAll()}),this.$scope.$on("$destroy",function(){i.unsubscribeAll(),n.unsubscribeAll()})}e.VisualizationPaneController=a;var l=(c.prototype.$onInit=function(){this.newColorsEnabled=this.services.explorationCapabilities.getCapabilities().showFluentDesign||this.services.featureSwitchService.featureSwitches&&this.services.featureSwitchService.featureSwitches.paneColorRefresh,this.newColorsSuffix=this.newColorsEnabled?"_paneColorRefresh":""},c.prototype.showNonPersonalVisualizationPane=function(){var o=this;return _.some(this.services.visualPlugin.getConvertibleVisuals(),function(e){if(!e)return!1;var t=!1,i=o.services.featureSwitchService.featureSwitches.userFavoriteResourcePackagesEnabled&&e.custom&&o.services.visualPaneSettingsService.isFavoritePublicCustomVisual(e.name),a=o.services.featureSwitchService.featureSwitches.userFavoriteResourcePackagesEnabled&&e.custom&&e.favoriteId||i,n=o.services.featureSwitchService.featureSwitches.userFavoriteResourcePackagesEnabled&&e.custom&&!e.favoriteId&&!i,r=o.services.featureSwitchService.featureSwitches.tenantOutOfBoxVisualsEnabled&&e.custom&&e.isOutOfBox,i=o.services.featureSwitchService.featureSwitches.personalVisualizationPaneEnabled&&o.services.visualPaneSettingsService.isUnpinnedVisual(e.name);return t=e.custom&&!r&&n||i&&!a?!0:t})},c.prototype.exploreUIAuthoringModulePath=function(){return"@powerbi/ExploreUIAuthoring/explore-ui-authoring.module#ExploreUIAuthoringModule"},c.prototype.preparePersonalVisualizationPaneServices=function(){var e=this,t=[];return this.services.featureSwitchService.featureSwitches.userFavoriteResourcePackagesEnabled&&t.push(this.services.favoriteVisualLoader.ensureFavoriteVisualResources(this.services.visualPlugin)),this.services.featureSwitchService.featureSwitches.tenantOutOfBoxVisualsEnabled&&t.push(this.services.favoriteVisualLoader.ensureOutOfBoxVisuals(this.services.visualPlugin)),this.services.promiseFactory.allSettled(t).finally(function(){if(e.services.featureSwitchService.featureSwitches.personalVisualizationPaneEnabled)return e.services.visualPaneSettingsService.updateVisuals()})},c.prototype.preparePersonalVisualizationPane=function(){var e=this;this.preparePersonalVisualizationPaneServices().finally(function(){e.services.eventBridge.publishToChannel(r.visualPluginsChanged)})},c);function c(e){this.services=e,this.preparePersonalVisualizationPane()}e.VisualizationPaneCore=l})((p=u.explore||(u.explore={})).components||(p.components={}))}(powerbi=powerbi||{}),function(e){var t;(t=(t=e.explore||(e.explore={})).components||(t.components={})).VisualizationPane={bindings:{viewModel:"<"},controller:e.common.createController(t.VisualizationPaneController),templateUrl:"components/visualizationPane/visualizationPane.html"}}(powerbi=powerbi||{}),define("ExploreUIShell/components/fieldWellField/fieldWellFieldController",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.FieldWellFieldController=t.FieldWellFieldCore=void 0;var i=powerbi.explore,l=i.viewModels,o=powerbi.data,a=powerbi.explore.util,n=powerbi.explore.services.events.fieldWellFieldRemovedEvent,r=powerbi.explore.components.invalidFieldWellBucketLocalizationId,s=i.services.selectionUtils,c=powerbi.telemetry,u=jsCommon.ArrayExtensions,m=powerbi.data.services.DataViewObjectSerializer,p=jsCommon.DropPosition,d=jsCommon.FocusManager,v=powerbi.Promise,h=powerbi.data.SQExprConverter,g=i.ScopeUtils,y=powerbi.data.services.SemanticQuerySerializer,f=a.VisualContainerUtils,b=(S.prototype.onDestroy=function(){this.dataBarsDialogRef&&this.dataBarsDialogRef.close()},S.prototype.getDropAction=function(e){var t=this.services.promiseFactory.defer(),i=this.services.dragDataService.getDragContext(),a=this.viewModel.interactivityOptions,n=a.canAppend?3:2;if(i&&a.isDroppableField&&(a.canAppend||a.canPrepend)){var r=i.sourceRole;if(r){var o=i.hierarchyLevelCount||1,s=i.sourceIndex,i=!a.canPrepend||p.isBelow(e);if(void 0===this.getTargetIndex(r,s,o,{role:this.viewModel.role,startIndex:this.viewModel.startIndex,hierarchyLevelsLength:this.viewModel.hierarchyLevels?this.viewModel.hierarchyLevels.length:0},i))return t.resolve(0),t.promise}a.isReplaceable&&a.isReplaceOnly?n=1:p.isAbove(e)&&a.canPrepend&&(n=2)}else n=0;return t.resolve(n),t.promise},S.prototype.getFieldDropAction=function(e){var t=this.viewModel.interactivityOptions;return t.isDroppableField&&(t.canAppend||t.canPrepend)?t.isReplaceable&&t.isReplaceOnly?1:p.isAbove(e)&&t.canPrepend?2:p.isBelow(e)&&t.canAppend?3:0:0},S.prototype.drop=function(e,t,i){var a=this.services.dragDataService.getDragContext();this.dropWithPayloadAndAction(a,i)},S.prototype.dropWithPayloadAndAction=function(e,t){var i,a,n=e,r=this.viewModel,o=this.services.dataSources.get(),s=n.sourceRole;s?(i=n.hierarchyLevelCount||1,a=n.sourceIndex,n=this.getTargetIndex(s,a,i,{role:this.viewModel.role,startIndex:this.viewModel.startIndex,hierarchyLevelsLength:this.viewModel.hierarchyLevels?this.viewModel.hierarchyLevels.length:0},3===t),this.services.visualAuthoring.moveField(s,r.role,a,n,i,o)):e.field&&this.dropField(e.field,t,o)},S.prototype.dropField=function(e,t,i){this.viewModel.interactivityOptions.isReplaceable&&(this.viewModel.interactivityOptions.isReplaceOnly||1===t)?this.services.visualAuthoring.replaceField(e,this.viewModel.role,this.viewModel.startIndex,this.getSelectedVisual(),i):this.services.visualAuthoring.addFieldInRole(e,this.viewModel.role,i,this.getSelectedVisual(),3===t?this.viewModel.startIndex+(this.viewModel.hierarchyLevels&&this.viewModel.hierarchyLevels.length||1):this.viewModel.startIndex)},S.prototype.moveToBucket=function(i){return __awaiter(this,void 0,v,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return t=this.viewModel.hierarchyLevels.length||1,[4,this.services.visualAuthoring.moveField(this.viewModel.role,i.role,this.viewModel.startIndex,i.targetIndex,t,this.services.dataSources.get())];case 1:return e.sent()||(t=this.services.localizationService.format(r,[this.viewModel.displayOptions.displayName,i.displayName]),this.services.screenReaderService.alert(t),this.onContextMenuActionFailed&&this.onContextMenuActionFailed()),[2]}})})},S.prototype.moveField=function(e,t){var i=this.viewModel.hierarchyLevels.length||1,t=this.getTargetIndex(this.viewModel.role,this.viewModel.startIndex,i,e,t);this.services.visualAuthoring.moveField(this.viewModel.role,e.role,this.viewModel.startIndex,t,i,this.services.dataSources.get())},S.prototype.getTargetIndex=function(e,t,i,a,n){var r=a.startIndex;if(n&&(r+=a.hierarchyLevelsLength||1),e===a.role){if(r===t||r===t+i)return;t<r&&(r=Math.max(r-i,0))}return r},S.prototype.deleteField=function(i){return __awaiter(this,void 0,v,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return[4,this.services.conceptualSchemaProxy.get(this.services.dataSources.get())];case 1:return t=e.sent(),this.services.visualAuthoring.removeFieldFromRole({role:this.viewModel.role,projOptions:{fieldIndex:this.viewModel.startIndex+(i||0)},count:!_.isNumber(i)&&this.viewModel.hierarchyLevels.length||1},t),this.logDeleteTelemetry(),[2]}})})},S.prototype.deleteFieldAndFocus=function(i,a){return __awaiter(this,void 0,v,function(){var t=this;return __generator(this,function(e){switch(e.label){case 0:return i&&i.stopPropagation(),[4,this.deleteField(a)];case 1:return e.sent(),jsCommon.Zone.setTimeout(function(){t.services.eventBridge.publishToChannel(n,t.bucketDisplayName)}),[2]}})})},S.prototype.switchQueryParameter=function(){return __awaiter(this,void 0,v,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return[4,this.services.conceptualSchemaProxy.get(this.services.dataSources.get())];case 1:return t=e.sent(),this.services.visualAuthoring.switchQueryParameter(t,this.viewModel.startIndex,this.viewModel.role),[2]}})})},S.prototype.logDeleteTelemetry=function(){var e=g.getSchemaPromise(this.services.dataSources.get(),this.services.promiseFactory,this.services.conceptualSchemaProxy),t=a.VisualContainerUtils.getVisualType(this.getSelectedVisual());this.services.groupAuthoring.telemetry.logGroupsUsageTelemetry(e,this.viewModel.expr,t,null,this.viewModel.role,"Delete")},S.prototype.getDragContext=function(){return{sourceIndex:this.viewModel.startIndex,sourceRole:this.viewModel.role,hierarchyLevelCount:this.viewModel.hierarchyLevels.length}},S.prototype.setAggregate=function(e,t){var i=this.getAuthoringContext();if(i){var a=o.FieldExprPattern.getAggregate(e.expr),n=this.services.visualAuthoring.setAggregate(this.viewModel.role,this.viewModel.startIndex,t,i.visual,i.dataSources);return l.FieldWellViewModelOperations.updateSelectedMenuItems(e,i.visual),this.services.telemetryService.logEvent(c.EXChangeAggregation,{original:o.aggregateFunctionName(a),target:o.aggregateFunctionName(t),visualName:i.visual.name}),n}},S.prototype.setVariation=function(e,t){var i=this.getAuthoringContext();i&&this.services.visualAuthoring.setVariation(i.dataSources,i.visual,t,this.viewModel.role,this.viewModel.startIndex,this.viewModel.hierarchyLevels.length)},S.prototype.removeAggregate=function(e){var t=this.getAuthoringContext();t&&(this.services.visualAuthoring.removeAggregate(this.viewModel.role,this.viewModel.startIndex,t.visual,t.dataSources),l.FieldWellViewModelOperations.updateSelectedMenuItems(e,t.visual))},S.prototype.restoreHierarchy=function(e){var t=this.getAuthoringContext();t&&this.services.visualAuthoring.expandHierarchy(t.dataSources,t.visual,this.viewModel.role,this.viewModel.startIndex,this.viewModel.hierarchyLevels.length)},S.prototype.toggleShowAll=function(e){var t=this.getAuthoringContext();t&&(this.services.visualAuthoring.toggleShowAll(e.role,t.visual),l.FieldWellViewModelOperations.updateSelectedMenuItems(e,t.visual))},S.prototype.selectFieldMenuItem=function(e){switch(e.action){case 32768:this.editLabel();break;case 1:this.deleteFieldAndFocus();break;case 4:this.setAggregate(this.viewModel,e.aggregate);break;case 2:this.removeAggregate(this.viewModel);break;case 8:this.toggleShowAll(this.viewModel);break;case 128:this.setVariation(this.viewModel,e.variationExpr);break;case 32:this.setShowValueAs(this.viewModel,e.showValueAs);break;case 64:this.showQuickCalcDialog();break;case 256:this.showGroupsDialog(this.viewModel,!0);break;case 512:this.showGroupsDialog(this.viewModel,!1);break;case 1024:this.showEditClusteringDialogAsync(this.viewModel);break;case 2048:this.restoreHierarchy(this.viewModel);break;case 4096:this.setConditionalFormatting(e.conditionalFormattingOptions);break;case 16384:this.removeConditionalFormatting(e.conditionalFormattingOptions);break;case 8192:this.removeConditionalFormattingAll();break;case 65536:this.moveField(e.moveFieldPropertyOptions,!1);break;case 131072:this.moveField(e.moveFieldPropertyOptions,!0);break;case 262144:this.moveToBucket(e.moveFieldBucketOptions);break;case 2097152:this.showSparklinesDialog(!1);break;case 4194304:this.showSparklinesDialog(!0);break;case 16777216:case 8388608:this.switchQueryParameter()}},S.prototype.onKeyDown=function(e){e.stopPropagation(),13===e.keyCode&&this.editLabel()},S.prototype.editLabel=function(){var e=this.viewModel;e.interactivityOptions.isEditableField&&(e.isEditingLabel=!0,this.onLabelInEditingModeChanged&&this.onLabelInEditingModeChanged(!0))},S.prototype.rename=function(e){var t,i,a,n,r=this.viewModel.displayOptions;e!==r.displayName&&(n=(t=this.getSelectedVisual()).config.singleVisual.query,i=t&&t.name,a=t&&t.config.singleVisual.visualType,t&&n&&n.projections&&n.projections[this.viewModel.role]&&this.viewModel.visualContainerName===i?(n=f.getQueryName(t,this.viewModel.role,this.viewModel.startIndex),r.displayName=e,this.services.visualAuthoring.setDisplayNameAlias(n,t,e)):this.services.telemetryService.logEvent(c.EXFieldWellAbnormalRename,{originalVisualContainerName:this.viewModel.visualContainerName,originalVisualType:this.viewModel.visualType,currentVisualContainerName:i,currentVisualType:a}))},S.prototype.cancelRename=function(){this.viewModel.isEditingLabel=!1,this.onLabelInEditingModeChanged&&this.onLabelInEditingModeChanged(!1)},S.prototype.setShowValueAs=function(a,n){var r,o=this,s=this.getAuthoringContext();s&&(r=this.services.dataSources.get(),this.services.conceptualSchemaProxy.get(r).then(function(e){var t={dataSources:r,roleIndex:o.viewModel.startIndex,visual:s.visual,visualDataRole:o.getVisualDataRole()},i=a.interactivityOptions.dropDownItems.items,i=_.find(i,function(e){return e.key&&16===e.key.action}),i=_.find(i.children,function(e){return e.checked});o.services.showValueAsService.applyShowValueAs(t,i.key.showValueAs,n),l.FieldWellViewModelOperations.updateSelectedMenuItems(a,s.visual)}))},S.prototype.showQuickCalcDialog=function(){return __awaiter(this,void 0,powerbi.Promise,function(){var t,i,a,n;return __generator(this,function(e){switch(e.label){case 0:return(t=this.getAuthoringContext())?(i=this.viewModel.role,a=this.viewModel.startIndex,n=t.visual.config.singleVisual.query.tryGetExpr(i,a),[4,this.services.lazyScoped("quickMeasures")]):[2];case 1:return e.sent().launchQuickMeasures(n,"FieldWell",void 0,{visualContainer:t.visual,index:a,role:i}),[2]}})})},S.prototype.showSparklinesDialog=function(l){return __awaiter(this,void 0,powerbi.Promise,function(){var t,i,a,n,r,o,s;return __generator(this,function(e){switch(e.label){case 0:return(t=this.getAuthoringContext())?(i=this.viewModel.role,a=this.viewModel.startIndex,n=t.visual.config.singleVisual.query.tryGetExpr(i,a),l?[3,2]:[4,this.services.sparklinesService.showCreateDialog(n)]):[2];case 1:return(r=e.sent())&&(o=y.deserializeExpr(r.measure),s=y.deserializeExpr(r.grouping),this.services.sparklinesService.addSparklinesToVisual(o,s,t.visual)),[3,4];case 2:return[4,this.services.sparklinesService.showEditDialog(n)];case 3:(r=e.sent())&&(o=y.deserializeExpr(r.measure),s=y.deserializeExpr(r.grouping),this.services.sparklinesService.updateSparklinesExpr(o,s,t.visual,i,a)),e.label=4;case 4:return[2]}})})},S.prototype.showGroupsDialog=function(o,s){return __awaiter(this,void 0,powerbi.Promise,function(){var t,i,a,n,r=this;return __generator(this,function(e){switch(e.label){case 0:return t=this.services.dataSources.get(),[4,this.services.conceptualSchemaProxy.get(t)];case 1:a=e.sent(),i=o.expr.getTargetEntity(),n=o.expr.getConceptualProperty(a),a={schema:i.schema,entity:i.entity,name:s?null:n.name,sourcePropertyName:s?n.name:null,isNew:s},n=this.services.modelChangeHandler.register(function(e){return r.handleNewGroupsBins(i,o,e),r.services.promiseFactory.resolve()}),e.label=2;case 2:return e.trys.push([2,,4,5]),[4,this.services.groupAuthoring.openGroupDialog(a)];case 3:return e.sent(),[3,5];case 4:return n.stopHandling(),[7];case 5:return[2]}})})},S.prototype.showEditClusteringDialogAsync=function(t){return __awaiter(this,void 0,v,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,this.services.lazyScoped("clustering")];case 1:return[4,e.sent().editClustering(h.asFieldPattern(t.expr),this.services.dataSources.get())];case 2:return e.sent(),[2]}})})},S.prototype.handleNewGroupsBins=function(e,t,i){var a=_.find(i.changes,function(e){return e.newBins});a&&(n=o.SQExprBuilder.columnRef(e,a.newBins.name));var n,r,i=_.find(i.changes,function(e){return e.newGroups});i&&(r=o.services.SemanticGroupingSerializer.deserialize(i.newGroups.definition).groupedColumns[0],n=o.SQExprBuilder.groupRef(i.newGroups.name,e,[r])),n&&(r=this.services.dataSources.get(),this.services.visualAuthoring.replaceField(n,t.role,t.startIndex,this.getSelectedVisual(),r))},S.prototype.setConditionalFormatting=function(g){return __awaiter(this,void 0,v,function(){var t,i,a,n,r,o,s,l,c,u,p,d,v,h;return __generator(this,function(e){switch(e.label){case 0:return t=this.getSelectedVisual(),i=this.services,u=i.dataSources.get(),a=this.viewModel,n=this.services.featureSwitchService.featureSwitches&&this.services.featureSwitchService.featureSwitches.conditionalTablixWebURL,[4,i.conceptualSchemaProxy.get(u)];case 1:return r=e.sent(),o=g.repetition,s=o.propertyDescriptor&&o.propertyDescriptor.type,c=o.propertyDescriptor&&o.propertyDescriptor.type.misc,l=this.viewModel.displayOptions.displayName,s&&(s.fill||s.icon||n&&c&&c.webUrl)?[4,this.services.lazyScoped("conditionalFormattingDialogLauncherService")]:[3,4];case 2:return[4,e.sent().show(t,l,a.expr,o,g.propertyDefinition)];case 3:return(u=e.sent())&&(c=m.deserializeObjectProperty(u.propertyDefinition,o.propertyDescriptor,!1),u=m.deserializeSelector(u.selector),this.services.visualAuthoring.setPropertyDefinition(t,o.propertyId,o.selector,c,u)),[3,8];case 4:return s&&s.dataBars?(d=i.explorationNavigation.getCurrentExploration().themeCollection,p=i.themeService.getVisualStyle(d),v=a.expr,d=v.getMetadata(r).type,[4,i.lazyScoped("dataBarsDialogLauncherService")]):[3,7];case 5:return v=e.sent(),h=this,[4,v.show(t,l,o,p.colorPalette,d,!1)];case 6:return h.dataBarsDialogRef=e.sent(),[3,8];case 7:e.label=8;case 8:return[2]}})})},S.prototype.removeConditionalFormatting=function(e){e.propertyDefinition;var t=this.getSelectedVisual(),i=e.repetition,a=i.propertyDescriptor&&i.propertyDescriptor.type,n=i.propertyDescriptor&&i.propertyDescriptor.type.misc,e=this.services.featureSwitchService.featureSwitches&&this.services.featureSwitchService.featureSwitches.conditionalTablixWebURL;a&&(a.fill||a.icon||e&&n&&n.webUrl)?this.services.visualAuthoring.removePropertyDefinition(t,i.propertyId,i.selector):a&&a.dataBars&&this.services.visualAuthoring.removeDataBars(t,i),this.services.telemetryService.logEvent(c.EXRemoveConditionalFormatting,{visualType:f.getVisualType(t),visualName:t.name})},S.prototype.removeConditionalFormattingAll=function(){var e=this.getSelectedVisual(),t=this.viewModel.conditionalFormattingRepetitions;this.services.visualAuthoring.removeConditionalFormattingAll(e,t),this.services.telemetryService.logEvent(c.EXRemoveConditionalFormatting,{visualType:f.getVisualType(e),visualName:e.name})},S.prototype.getSelectedVisual=function(){return s.getSelectedVisual(this.services.selection)},S.prototype.getVisualDataRole=function(){var e=f.getDataRolesForVisual(this.getSelectedVisual(),this.services.visualPlugin);if(!_.isEmpty(e))return u.findItemWithName(e,this.viewModel.role)},S.prototype.getAuthoringContext=function(){var e=this.getSelectedVisual();if(e){var t=this.services.dataSources.get();if(t)return{visual:e,dataSources:t}}},S);function S(e,t,i,a){var n=this;this.services=e,this.modernFieldlistDropElement=t,this.onContextMenuActionFailed=i,this.onLabelInEditingModeChanged=a,this.dropConfig={accept:"field",greedy:!1},this.tooltipConfigManager={getTooltipConfig:function(){return{tooltipTitle:n.viewModel.displayOptions.tooltipTitle,tooltipDescription:n.viewModel.displayOptions.tooltipDescription}}},this.removeAriaLabel=this.services.localizationService.get("FieldWell_Remove"),this.newPaneColorsEnabled=this.services.explorationCapabilities.getCapabilities().showFluentDesign||this.services.featureSwitchService.featureSwitches&&this.services.featureSwitchService.featureSwitches.paneColorRefresh,this.getEditableLabelAriaLabel=function(){var e=n.viewModel.displayOptions.displayName;return _.isString(n.viewModel.displayOptions.tooltipTitle)&&(e=_.isString(e)?e.concat(". ",n.viewModel.displayOptions.tooltipTitle):n.viewModel.displayOptions.tooltipTitle),e=_.isString(n.viewModel.displayOptions.tooltipDescription)?_.isString(e)?e.concat(". ",n.viewModel.displayOptions.tooltipDescription):n.viewModel.displayOptions.tooltipDescription:e},t&&powerbi.explore.helpers.enableDropFromModernFieldList(t,function(e,t,i){return n.dropField(t,n.getFieldDropAction(i),n.services.dataSources.get())},function(e){return n.getFieldDropAction(e)})}t.FieldWellFieldCore=b;Object.defineProperty(w.prototype,"bucketDisplayName",{get:function(){return this.core.bucketDisplayName},set:function(e){this.core.bucketDisplayName=e},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"viewModel",{get:function(){return this.core.viewModel},set:function(e){this.core.viewModel=e},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"dropConfig",{get:function(){return this.core.dropConfig},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"getEditableLabelAriaLabel",{get:function(){return this.core.getEditableLabelAriaLabel},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"removeAriaLabel",{get:function(){return this.core.removeAriaLabel},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"tooltipConfigManager",{get:function(){return this.core.tooltipConfigManager},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"newPaneColorsEnabled",{get:function(){return this.core.newPaneColorsEnabled},enumerable:!1,configurable:!0}),w.createOptions=function(){return{additionalServices:["$element","conceptualSchemaProxy","dragDataService","dropdown","lazy","localizationService","modalDialogService","promiseFactory","telemetryService","featureSwitchService","explorationSerializer","themeService","screenReaderService"],scopedDependencies:["dataSources","eventBridge","explorationNavigation","groupAuthoring","modelChangeHandler","lazyScoped","selection","showValueAsService","undoRedo","visualAuthoring","visualPlugin","explorationCapabilities","sparklinesService"]}},w.prototype.onDestroy=function(){this.core.onDestroy()},w.prototype.getDropAction=function(e){return this.core.getDropAction(e)},w.prototype.drop=function(e,t,i){this.core.drop(e,t,i)},w.prototype.deleteField=function(e){return this.core.deleteField(e)},w.prototype.deleteFieldAndFocus=function(e,t){return this.core.deleteFieldAndFocus(e,t)},w.prototype.getDragContext=function(){return this.core.getDragContext()},w.prototype.selectFieldMenuItem=function(e){this.core.selectFieldMenuItem(e)},w.prototype.showMenu=function(e){var t={anchorElement:$(e.currentTarget)};this.services.dropdown.showContextMenu(this.viewModel.interactivityOptions.dropDownItems,void 0,this.selectFieldMenuItem.bind(this),!1,void 0,void 0,!0,t),e.keyCode===$.ui.keyCode.SPACE&&e.stopPropagation()},w.prototype.onKeyDown=function(e){this.core.onKeyDown(e)},w.prototype.editLabel=function(){this.core.editLabel()},w.prototype.rename=function(e){this.core.rename(e)},i=w;function w(e,t){var i=this;this.scope=e,this.services=t,this.core=new b(t,this.services.$element.get(0),function(){d.focus(i.services.$element.find(".fieldWellIcon.dropDown")[0])}),this.scope.$on(powerbi.common.constants.editableLabelOnBlurEventName,function(){return i.core.cancelRename()})}t.FieldWellFieldController=i}),define("ExploreUIShell/components/fieldWellBucket/fieldWellBucketController",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.FieldWellBucketCore=t.FieldWellBucketController=void 0;var r=powerbi.explore.contracts,i=powerbi.explore,o=powerbi.telemetry,s=powerbi.explore.util,a=powerbi.explore.util.FieldWellUtility,l=i.ScopeUtils,n=powerbi.explore.services.events,c=i.services.selectionUtils,i=(Object.defineProperty(u.prototype,"viewModel",{get:function(){return this.core.viewModel},set:function(e){this.core.viewModel=e},enumerable:!1,configurable:!0}),u.createOptions=function(){return{additionalServices:["$element","conceptualSchemaProxy","dragDataService","dropdown","featureSwitchService","localizationService","promiseFactory","telemetryService"],scopedDependencies:["dataSources","eventBridge","groupAuthoring","groupingDesignStateService","selection","viewModeState","visualAuthoring"]}},u.prototype.$onInit=function(){var a=this;this.scope.drop=function(e,t,i){return a.drop(e,t,i)},this.scope.getDropAction=function(e){return a.getDropAction(e)},this.scope.dropConfig=this.core.getDropConfig(),this.scope.fieldWellAriaLabel=this.core.fieldWellAriaLabel.bind(this),this.scope.addFieldsAriaLabel=this.core.addFieldsAriaLabel(),this.scope.tooltipConfigManager={getTooltipConfig:function(){return{tooltipDescription:a.core.getTooltipDescription()}}},this.viewModel.warning&&(this.scope.warningTooltipConfigManager={getTooltipConfig:function(){return a.core.getWarningTooltip()}}),this.core.$onInit(this.services.$element.get(0))},u.prototype.getBorderStyle=function(){return this.core.getBorderStyle()},u.prototype.getDropAction=function(e){return this.core.getDropAction(e)},u.prototype.drop=function(e,t,i){this.core.drop(e,t,i)},u);function u(e,t){var i=this;this.services=t,this.onSourceSelected=function(e,t){i.core.onSourceSelected(e,t)},this.core=new p(t),this.scope=e}t.FieldWellBucketController=i;var p=(d.prototype.$onInit=function(e){var i=this;e&&powerbi.explore.helpers.enableDropFromModernFieldList(e,function(e,t){return i.dropField(t)})},d.prototype.isInlineExploreMode=function(){return 0===this.services.viewModeState.getMode()},d.prototype.getTooltipDescription=function(){return this.viewModel.description||this.viewModel.displayName},d.prototype.getWarningTooltip=function(){var e={tooltipTitle:"",tooltipDescription:""};return e=this.viewModel.warning?{tooltipTitle:this.viewModel.warning.title,tooltipDescription:this.viewModel.warning.description}:e},d.prototype.getBorderStyle=function(){if(this.isInlineExploreMode()&&0!==this.viewModel.properties.length)return"none"},d.prototype.getDropAction=function(e){var t,i=this.services.promiseFactory.defer(),a=this.services.dragDataService.getDragContext(),n=0;return a&&(t=this.viewModel,n=a.sourceRole===t.role&&_.last(t.properties).startIndex===a.sourceIndex?0:_.isEmpty(this.viewModel.properties)?1:2),i.resolve(n),i.promise},d.prototype.drop=function(e,t,i){var a=this.services.dragDataService.getDragContext();this.dropWithPayload(a)},d.prototype.dropWithPayload=function(e){var t,i,a,n,r;e&&(t=e,i=this.viewModel,a=this.getSelectedVisual(),t.sourceRole?($.isNumeric(t.sourceIndex),(n=0)<i.properties.length&&(n=_.last(i.properties).endIndex+1),t.sourceRole===i.role&&(n=Math.max(n-(t.hierarchyLevelCount||1),0)),r=this.services.dataSources.get(),this.services.visualAuthoring.moveField(t.sourceRole,i.role,t.sourceIndex,n,t.hierarchyLevelCount||1,r),r=a?a.config.singleVisual.query.tryGetExpr(t.sourceRole,t.sourceIndex):null,this.logTelemetry(r,t.sourceRole,a)):e.field&&this.dropField(e.field))},d.prototype.dropField=function(e){var t,i=this.getSelectedVisual();i?(t=this.services.dataSources.get(),this.services.visualAuthoring.addFieldInRole(e,this.viewModel.role,t,i)):this.services.eventBridge.publishToChannel(n.addVisualContainer,{expr:e,visualType:a.getDefaultVisualPlugin(this.services.featureSwitchService).name,targetRole:this.viewModel.role,allowAggregate:!0,telemetrySource:3}),this.logTelemetry(e,null)},d.prototype.getSelectedVisual=function(){return c.getSelectedVisual(this.services.selection)},d.prototype.logTelemetry=function(e,t,i){var a,n;e&&(a="Create",t&&(a="Update",this.services.telemetryService.logEvent(o.EXChangeFieldWell,{sourceBucketRole:t,targetBucketRole:this.viewModel.role,visualName:i&&i.name})),n=s.VisualContainerUtils.getVisualType(this.getSelectedVisual()),i=l.getSchemaPromise(this.services.dataSources.get(),this.services.promiseFactory,this.services.conceptualSchemaProxy),this.services.groupAuthoring.telemetry.logGroupsUsageTelemetry(i,e,n,this.viewModel.role,t,a))},d.prototype.fieldWellAriaLabel=function(){var e=this.viewModel.displayName;return e=_.isString(this.viewModel.description)?_.isString(e)?e.concat(". ",this.viewModel.description):this.viewModel.description:e},d.prototype.getDropConfig=function(){return{accept:"field",greedy:!1}},d.prototype.addFieldsAriaLabel=function(){var e=this.services.localizationService;return e.get("FieldDropZone_NoDataFields").concat(". ",e.get("FieldDropZone_AddFields"))},d);function d(e){var n=this;this.onSourceSelected=function(e,t){var i,a=c.getSelectedCanvasItems(n.services.selection);1!==a.length||(i=a[0])&&r.isVisualContainer(i)&&(a=n.services.dataSources.get(),n.services.visualAuthoring.addFieldInRole(t,n.viewModel.role,a,i))},this.services=e}t.FieldWellBucketCore=p}),function(e){!function(e){function t(e,t){var n=this;this.restrict="E",this.replace=!0,this.require="ngModel",this.scope={warningMessage:"<",labelId:"<?",isDisabled:"<?"},this.templateUrl="views/toggleSwitch.html",this.link=function(t,e,i,a){a.$render=function(){t.toggleValue=a.$viewValue},t.checked=function(){a.$setViewValue(t.toggleValue)},t.handleToggleEvent=function(e){13===e.keyCode&&(t.toggleValue=!t.toggleValue)},t.$watch("toggleValue",function(e){null==e||t.isDisabled||t.checked()}),t.handleToggleFocus=function(e){t.warningMessage&&n.screenReaderService.alert(t.warningMessage.title+t.warningMessage.detail)},t.getTooltipConfig=function(){if(t.warningMessage)return{tooltipDisable:!1,tooltipTitle:t.warningMessage.title,tooltipDescription:t.warningMessage.detail}},n.initializeHighContrastRules()},this.highContrastCssGenerationService=e,this.screenReaderService=t}e=e.directives||(e.directives={}),t.prototype.initializeHighContrastRules=function(){this.highContrastCssGenerationService.addRule(".themeableElement .toggle-switch-inner:after","{ border-color: @foregroundColor !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement .toggle-switch-checkbox:checked + .toggle-switch-label .toggle-switch-inner:after","{ background: @foregroundColor !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement  .toggle-switch .toggle-switch-label:hover .toggle-switch-inner:after","{ border-color: @selectedBackgroundColor !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement .toggle-switch .toggle-switch-checkbox:checked + .toggle-switch-label:hover .toggle-switch-inner:after","{ background: @selectedBackgroundColor !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement .toggle-switch .toggle-switch-checkbox:checked + .toggle-switch-label:hover .toggle-switch-inner","{ border-color: @selectedBackgroundColor !important; }"),this.highContrastCssGenerationService.addRule(".themeableElement .inputField .toggle-switch:focus","{ outline-color: @selectedBackgroundColor !important; }")},e.ToggleSwitch=t}(e.explore||(e.explore={}))}(powerbi=powerbi||{}),function(e){!function(e){function t(){var n=this;this.restrict="A",this.scope={viewModel:"=?",sectionNumber:"=?",navMarkerParent:"@",autoWidth:"<?"},this.link=function(i,a){null!=i.viewModel?(i.$watch("viewModel.activePageSection",function(e){var t;null!=e&&(e=(t=n.getPageSectionIndexes(i.viewModel,e))[0],t=t[1],n.animateSectionSlide(i,a,e,t))}),i.$watch("viewModel.activeSection",function(e){var t;null!=e&&(e=(t=n.getSectionIndexes(i.viewModel,e))[0],t=t[1],n.animateSectionSlide(i,a,e,t))}),i.$watch("viewModel.sections.length",function(e,t){0!==e&&e!==t&&(t=(e=n.getSectionIndexes(i.viewModel,i.viewModel.activeSection))[0],e=e[1],n.animateSectionSlide(i,a,t,e))})):null!=i.sectionNumber&&i.$watch("sectionNumber",function(e){null!=e&&n.animateSectionSlide(i,a,e,Number(!e))})}}e=e.directives||(e.directives={}),t.prototype.animateSectionSlide=function(e,t,i,a){i<a?t.css({right:"200%"}).animate({right:0},200):a<i&&t.css({"margin-left":"200%"}).animate({"margin-left":0},200);t=$("."+e.navMarkerParent+".navMarker");e.autoWidth?0===i?t.css({"margin-left":t.width()+"px","margin-right":"auto"}).animate({"margin-left":"0"},200):t.css({"margin-right":t.width()+"px","margin-left":"auto"}).animate({"margin-right":"0"},200):t.animate({"margin-left":t.width()*i+"px"},200)},t.prototype.getSectionIndexes=function(e,i){var a=[],n=e.previousSection;return e.sections.forEach(function(e,t){if(e.sectionType===i?a[0]=t:e.sectionType===n&&(a[1]=t),2===a.length)return a}),a},t.prototype.getPageSectionIndexes=function(e,i){var a=[],n=e.previousPageSection;return e.pagePaneSections.forEach(function(e,t){if(e.sectionType===i?a[0]=t:e.sectionType===n&&(a[1]=t),2===a.length)return a}),a},e.SectionAnimationSlider=t}(e.explore||(e.explore={}))}(powerbi=powerbi||{}),function(e){var r;function t(){this.restrict="A",this.scope={sectionLength:"<",currentSection:"=",setActiveSectionFunction:"&"},this.link=function(n,e){e.on("keydown",function(e){var t=r("sectionTab"),i=n.sectionLength;switch(e.keyCode){case $.ui.keyCode.LEFT:case $.ui.keyCode.UP:var a=(n.currentSection-1+i)%i;n.setActiveSectionFunction({nextSection:a}),$(e.target).parent("ul").find(t.selector).eq(a).focus(),e.stopPropagation();break;case $.ui.keyCode.RIGHT:case $.ui.keyCode.DOWN:a=(n.currentSection+1)%i,n.setActiveSectionFunction({nextSection:a}),$(e.target).parent("ul").find(t.selector).eq(a).focus(),e.stopPropagation()}})}}e=(e=e.explore||(e.explore={})).directives||(e.directives={}),r=jsCommon.CssConstants.createClassAndSelector,e.SectionTabKeyHandler=t}(powerbi=powerbi||{}),define("ExploreUIShell/components/fieldWellBucket/fieldWellBucket",["require","exports","ExploreUIShell/components/fieldWellBucket/fieldWellBucketController"],function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.FieldWellBucket=void 0;t.FieldWellBucket={templateUrl:"components/fieldWellBucket/fieldWellBucket.html",bindings:{viewModel:"="},controller:powerbi.common.createController(i.FieldWellBucketController)}}),define("ExploreUIShell/components/fieldWellField/fieldWellField",["require","exports","ExploreUIShell/components/fieldWellField/fieldWellFieldController"],function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.FieldWellField=void 0;t.FieldWellField={templateUrl:"components/fieldWellField/fieldWellField.html",bindings:{viewModel:"=",bucketDisplayName:"="},controllerAs:"ctrl",controller:powerbi.common.createController(i.FieldWellFieldController)}}),function(t){var e;(function(e){var v=t.data.FieldExprPattern,h=t.data.SQExprConverter;t.data.SQHierarchyExpr;e.updateSelectedMenuItems=function(e,t){var i=v.getAggregate(e.expr),a=void 0!==i,n=e.interactivityOptions.dropDownItems;if(n)for(var r=0,o=n.items;r<o.length;r++){var s=o[r],l=s.key;if(l)switch(l.action){case 4:s.checked=a&&l.aggregate===i;break;case 2:s.checked=!a;break;case 8:var c=t.config.singleVisual.query.projections[e.role];s.checked=!(!c||!c.showAll);break;case 128:s.checked=function(e,t){var i=function(e){if(!_.isEmpty(e.hierarchyLevels)){e=e.hierarchyLevels[0].expr;return e.arg,e.arg}}(e);if(i)return i.hierarchy===t;e=h.asFieldPattern(e.expr);return!!e&&(e.columnAggr?e.columnAggr.name===t:e.groupingColumnAggr?e.groupingColumnAggr.name===t:e.column?e.column.name===t:!!e.groupingColumn&&e.groupingColumn.name===t)}(e,s.text);break;case 16:for(var u=0,p=s.children;u<p.length;u++){var d=p[u];d.checked=function(e,t){var i=h.asFieldPattern(e.expr);if(!i||!t)return!1;switch(t.kind){case void 0:return!i.percentOfGrandTotal&&!i.percentOfRoleTotal;case 0:return!!i.percentOfGrandTotal;case 1:var a=t;return!(!i.percentOfRoleTotal||!_.every(i.percentOfRoleTotal.roles,function(e){return _.includes(a.roles,e)}));default:return!1}}(e,d.key.showValueAs)}break;case 2048:s.checked=!1;break;default:s.checked=void 0}}}})((e=(e=t.explore||(t.explore={})).viewModels||(e.viewModels={})).FieldWellViewModelOperations||(e.FieldWellViewModelOperations={}))}(powerbi=powerbi||{}),define("ExploreUIShell/module.templates",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.put=void 0,t.put=function(e){e.put("components/alignmentGroup/alignmentGroup.html",'<div class=\'alignment-group\' role="radiogroup" ng-if="$ctrl.inputName !== \'verticalAlignment\'"><div class="alignment-option-wrapper" ng-repeat="alignment in $ctrl.HorizontalAlignment" role="radio" aria-checked="{{$ctrl.isSelected(alignment)}}" tabindex="{{$ctrl.isSelected(alignment) ? 0 : - 1}}" ng-keydown="$ctrl.onAlignmentKeydown($event, alignment, false)" tooltip tooltip-config="::$ctrl.getTooltipConfig(alignment)" ng-class="{\'alignment-selected\': $ctrl.isSelected(alignment)}"><span class=\'alignment-option\' ng-class="alignment" ng-click="$ctrl.setAlignment(alignment)"><svg-use-symbol [sheet]="$ctrl.symbolSheetName" [symbol-id]="$ctrl.getSymbolId(alignment)"></svg-use-symbol></span></div></div><div class=\'alignment-group\' role="radiogroup" ng-if="$ctrl.inputName === \'verticalAlignment\'"><div class="alignment-option-wrapper" ng-repeat="alignment in $ctrl.VerticalAlignment" role="radio" aria-checked="{{$ctrl.isSelected(alignment)}}" tabindex="{{$ctrl.isSelected(alignment) ? 0 : - 1}}" ng-keydown="$ctrl.onAlignmentKeydown($event, alignment, true)" tooltip tooltip-config="::$ctrl.getTooltipConfig(alignment)" ng-class="{\'alignment-selected\': $ctrl.isSelected(alignment)}"><span class=\'alignment-option\' ng-class="alignment" ng-click="$ctrl.setAlignment(alignment)"><svg-use-symbol [sheet]="$ctrl.symbolSheetName" [symbol-id]="$ctrl.getSymbolId(alignment)"></svg-use-symbol></span></div></div>'),e.put("components/analyticsCard/analyticsCard.html",'<section class="card analyticsCard" ng-class="{disabled: $ctrl.card && $ctrl.card.readOnly}"><div id="title-{{$ctrl.cardTitle}}" class="flex cardTitle" ng-click="::$ctrl.toggleCollapsed()" ng-keydown="$ctrl.onKeyDown($event)" aria-controls="content-{{$ctrl.cardTitle}}" aria-expanded="{{!$ctrl.collapsed}}" role="button heading" tabindex="0"><div class="cardTitleExpander arrowRight glyphicon glyph-mini" ng-hide="$ctrl.card && $ctrl.card.readOnly" ng-class="{\'selected\': !$ctrl.collapsed,                \'pbi-glyph-chevrondownsmall\': $ctrl.collapsed,                \'pbi-glyph-chevronupsmall\': !$ctrl.collapsed}"></div><header class="cardTitleDisplayName item-fill trimmedTextWithEllipsis" ng-class="{disabled: $ctrl.card && $ctrl.card.readOnly}" tooltip tooltip-config="$ctrl.getTooltipConfig()"> {{::$ctrl.displayName}}<span class="instanceCount" ng-if="$ctrl.instances && $ctrl.instances.length > 0" ng-bind="$ctrl.instances.length" aria-label="{{$ctrl.getLabelForInstanceCount()}}"></span></header><div class="disabledWarning glyphicon glyph-mini pbi-glyph-warning" id="warning" ng-if="$ctrl.card && $ctrl.card.readOnly" aria-label="{{$ctrl.card.warningText}}" tooltip="{{$ctrl.card.warningText}}"></div></div><div id="content-{{$ctrl.cardTitle}}" class="contents" ng-if="!$ctrl.collapsed" aria-labelledby="title-{{$ctrl.cardTitle}}" aria-hidden="{{$ctrl.collapsed}}"><analytics-instance-selector instances="$ctrl.instances" current-instance="$ctrl.currentInstance" maximum-instances="::$ctrl.maximumInstances" is-label-editable="::$ctrl.isLabelEditable" card-title="::$ctrl.cardTitle" set-current-instance="$ctrl.setCurrentInstance(instance)" add-instance="$ctrl.addInstance()" remove-instance="$ctrl.removeInstance(instance)" rename-instance="$ctrl.renameInstance(instance, name)"></analytics-instance-selector><ng-transclude></ng-transclude><form name="{{$ctrl.cardTitle}}-form" ng-if="$ctrl.currentInstance"><ol><li class="card-slice" ng-repeat="slice in $ctrl.currentInstance.slices track by $index"><property-slice view-model="slice" slice-changed="$ctrl.save(slice)" type="$ctrl.getSliceComponentType(slice)"></property-slice></li></ol></form></div></section>'),e.put("components/analyticsInstanceSelector/analyticsInstanceSelector.html",'<ul class="instances card-slice" ng-keydown="$ctrl.onKeyDown($event)" role="listbox" aria-activedescendant="{{$ctrl.getInstanceLabelId($ctrl.instances.indexOf($ctrl.currentInstance))}}"><li class="instance flex" ng-repeat="instance in $ctrl.instances track by instance.selector.id" ng-if="!instance.isDefault" ng-dblclick="$ctrl.editName()" ng-click="$ctrl.setCurrentInstance({instance: instance})"><editable-label id="{{$ctrl.getInstanceLabelId($index)}}" class="instanceName item-fill" ng-class="{ current: $ctrl.currentInstance.selector === instance.selector && $ctrl.isLabelEditable }" on-blur="$ctrl.finishEditing(instance, newName)" display-name="instance.displayName" editable="$ctrl.currentInstance === instance && $ctrl.isEditing && $ctrl.isLabelEditable" disable-click="true" ng-keydown="$event.which === 13 ? $ctrl.editName() : _.noop" role="option" aria-setsize="{{$ctrl.instances.length}}" aria-posinset="{{$index+1}}" aria-selected="{{$ctrl.currentInstance === instance}}" tabindex="{{$ctrl.currentInstance.selector === instance.selector ? 0 : -1}}"></editable-label> <button class="remove glyphicon glyph-micro pbi-glyph-close" ng-click="$ctrl.removeAndSetFocus(instance)" tabindex="{{$ctrl.currentInstance.selector === instance.selector ? 0 : -1}}" aria-label="{{$ctrl.removeButtonLabel}}"></button></li></ul> <button id="{{$ctrl.getAddButtonId()}}" class="add pbi-glyph-add" ng-click="$ctrl.addInstanceAndSetFocus()" localize="ItemAction_Add" ng-if="!$ctrl.maximumInstances || $ctrl.instances.length < $ctrl.maximumInstances"></button>'),e.put("components/analyticsPane/analyticsPane.html",'<section class="propertyPaneContents propertyPaneContentsFlex"><search-box filter="$ctrl.filter" on-change="$ctrl.triggerUpdate()"></search-box><ng-scrollbars ng-scrollbars-config="::$ctrl.scrollbarsConfig"><header class="unavailable" ng-if="!$ctrl.hasCards"><span ng-if="$ctrl.hasFilter" localize="AnalyticsPane_NoSearchResult"></span><span ng-if="!$ctrl.hasFilter" localize="AnalyticsPane_Unavailable"></span><br><a ng-if="!$ctrl.hasFilter" class="learn-more" href="https://go.microsoft.com/fwlink/?LinkID=825117" target="_blank" localize="LearnMore"></a></header><div ng-repeat="card in $ctrl.cards track by card.name" ng-switch="card.name"><reference-line-card-container valid-measures="$ctrl.validMeasures" prototype-card="card" filter="$ctrl.filter" visual-container="$ctrl.visualContainer" ng-if="card.name === \'referenceLine\'"></reference-line-card-container><forecast-card card="card" instances="card.instances" display-name="card.displayName" description="card.description" visual-container="$ctrl.visualContainer" ng-if="card.name === \'forecast\'" ng-show="!card.filtered"></forecast-card><anomaly-detection-card card="card" instances="card.instances" display-name="card.displayName" description="card.description" visual-container="$ctrl.visualContainer" ng-if="card.name === \'anomalyDetection\'" ng-show="!card.filtered"></anomaly-detection-card><analytics-card card="card" instances="card.instances" maximum-instances="::card.maxInstances" is-label-editable="::card.isLabelEditable" display-name="card.displayName" description="card.description" card-title="::card.name" visual-container="$ctrl.visualContainer" ng-if="card.name !== \'referenceLine\' && card.name !== \'forecast\' && card.name !== \'anomalyDetection\'" ng-show="!card.filtered"></analytics-card></div></ng-scrollbars></section>'),e.put("components/anomalyDetectionCard/anomalyDetectionCard.html",'<analytics-card card="$ctrl.card" instances="$ctrl.instances" card-title="$ctrl.card.name" maximum-instances="::$ctrl.card.maxInstances" is-label-editable="::$ctrl.card.isLabelEditable" display-name="$ctrl.displayName" description="$ctrl.description" visual-container="$ctrl.visualContainer" on-add-instance="::$ctrl.onAddInstance(changes, instance)" on-update-instance="::$ctrl.onUpdateInstance(instance)" on-delete-instance="::$ctrl.onDeleteInstance(instance)" on-save="::$ctrl.onSave(changes, slice)" is-card-dirty="::$ctrl.isCardDirty(property, value)" is-anomaly-detection-card="true"><div class="parameterValues card-slice" ng-class="{disabled: $ctrl.card.instances.length === 0}" ng-init="labelId=$id"><label id="{{::labelId}}" localize="Visual_AnomalyDetection_Sensitivity" class="anomalyDetectionLabel trimmedTextWithEllipsis" tooltip tooltip-config="$ctrl.parameterSlices[\'sensitivity\'].tooltipConfig" [localizeAttr]="{\'aria-label\':\'Visual_AnomalyDetection_Sensitivity\'}"></label><div class="inputField anomalyDetectionParameterField" ng-class="{disabled: $ctrl.card.instances.length === 0}" role="spinbutton"><slider [use-modern-styles]="false" (model-value-change)="$ctrl.onSensitivitySliderChanged($event)" [model-value]="$ctrl.parameterSlices[\'sensitivity\'].value" [options]="$ctrl.parameterSlices[\'sensitivity\'].validators" [label-id]="{{::labelId}}"></slider></div><div class="applyButton"><pbi-button kind="text" label="Apply" accessible-click="$ctrl.saveAnomalyDetectionParameters()" ng-class="{active: $ctrl.haveParametersChanged()}" ng-disabled="$ctrl.card.instances.length === 0" tabindex="{{$ctrl.card.instances.length === 0?-1:0}}" role="button"></pbi-button></div></div><div class="parameterValues fieldPickerContainer anomalyExplainByFields" ng-class="{disabled: $ctrl.card.instances.length === 0}" ng-init="labelId=\'AnomalyExplainByFieldPickerLabel-\'+$id"><label id="{{::labelId}}" localize="Role_DisplayName_ExplainBy" class="anomalyDetectionLabel trimmedTextWithEllipsis" tooltip tooltip-config="$ctrl.fieldPickerParameters.column.tooltipConfig" [localizeAttr]="{\'aria-label\': \'Role_DisplayName_ExplainBy\'}"></label><field-picker ng-model="$ctrl.fieldPickerParameters.column.value" validators="$ctrl.fieldPickerParameters.column.validationInfo" drop-mode="$ctrl.dropMode" disabled="$ctrl.card.instances.length === 0" [aria-disabled]="$ctrl.card.instances.length === 0" role="option"></field-picker><div class="applyButton"><pbi-button kind="text" label="Apply" accessible-click="$ctrl.saveFieldPickerParameters()" ng-class="{active: $ctrl.hasExplainByListChanged()}" tabindex="{{$ctrl.card.instances.length === 0?-1:0}}" ng-disabled="$ctrl.card.instances.length === 0" role="button" [aria-disabled]="$ctrl.card.instances.length === 0"></pbi-button></div></div></analytics-card>'),e.put("components/fieldPicker/fieldPicker.html",'<div class="fieldPicker" drop="$ctrl.dropConfig" drop-handler="$ctrl.drop()" drop-action="$ctrl.getDropAction()" ng-class="{\'disabled\': $ctrl.disabled, \'noValue\': $ctrl.getNoValue()}" aria-label="{{$ctrl.pickerAriaLabel}}" ng-keydown="$event.which === $ctrl.keyCodeOfEnter && $ctrl.getNoValue() && $ctrl.focusField()"><span class="addFieldMessage" ng-if="$ctrl.getNoValue()" tabindex="0" title="{{$ctrl.pickerTooltip}}" localize="FieldDropZone_AddFields"></span><ul class="fields" ng-class="{\'singleField\': $ctrl.dropMode === 0}"><li class="field" ng-right-click="$ctrl.showMenu(index, $event)" ng-repeat="(index, parameter) in $ctrl.fieldList"><span ng-bind="parameter.expressionDisplayName" title="{{parameter.tooltip}}" tabindex="0" aria-label="{{parameter.expressionAriaLabel}}"></span><i ng-if="parameter.menuItems.length > 0" class="glyphicon glyph-micro pbi-glyph-flickup" accessible-click="$ctrl.showMenu(index, $event)" aria-haspopup="true" tabindex="0"></i><i class="glyphicon glyph-micro pbi-glyph-close" accessible-click="$ctrl.deleteField(index)" tabindex="0" localize-attr="{\'aria-label\': \'FieldPicker_Remove\'}"></i></li></ul></div>'),e.put("components/fieldWell/fieldWell.html",'<section class="fieldWell unselectable"><ol ng-if="$ctrl.core.viewModel.buckets"><li ng-repeat="bucket in $ctrl.core.viewModel.buckets"><field-well-bucket class="field-well-bucket-element" view-model="bucket" role="list"></field-well-bucket></li></ol></section>'),e.put("components/fieldWellBucket/fieldWellBucket.html",'<li class="bucket"><div class="bucket-header"><h2 class="caption trimmedTextWithEllipsis smallFontSize" tabindex="0" role="heading" aria-label="{{::fieldWellAriaLabel()}}" ng-bind="::$ctrl.viewModel.displayName" tooltip tooltip-config="tooltipConfigManager.getTooltipConfig()"></h2><i ng-if="$ctrl.viewModel.warning" role="alert" tabindex="0" aria-label="{{warningTooltipConfigManager.getTooltipConfig().tooltipDescription}}" class="warning glyphicon glyph-mini ng-scope" ng-class="$ctrl.viewModel.warning.glyph" tooltip tooltip-config="warningTooltipConfigManager.getTooltipConfig()"></i></div><ol class="properties" ng-style="{\'border\': $ctrl.getBorderStyle()}" drop="dropConfig"><li class="bucketTopBorder"></li><li ng-repeat="property in $ctrl.viewModel.properties"><field-well-field bucket-display-name="$ctrl.viewModel.displayName" view-model="property" id="{{::\'container\'+$id}}" role="list"/></li><li drop="dropConfig" tabindex="{{$ctrl.viewModel.properties.length === 0 ? 0 : -1}}" role="heading" aria-label="{{::addFieldsAriaLabel}}" aria-level="3" drop-handler="drop(event, ui, dropAction)" drop-action="getDropAction(dropPosition)" class="trimmedTextWithEllipsis" ng-class="{\'dropzone\': $ctrl.viewModel.properties.length === 0, \'end-dropzone\': $ctrl.viewModel.properties.length > 0, \'supports-multiple-items\': $ctrl.viewModel.supportsMultipleItems}" ng-attr-localize="{{$ctrl.viewModel.properties.length === 0 ? \'FieldDropZone_AddFields\' : \'\'}}" ng-attr-localize-tooltip="{{$ctrl.viewModel.properties.length === 0 ? \'FieldDropZone_AddFields\' : \'\'}}"></li></ol></li>'),e.put("components/fieldWellField/fieldWellField.html",'<li class="fieldWellProperty" ng-class="{\'can-prepend\': !ctrl.viewModel.interactivityOptions.isReplaceable, \'not-draggable\': !ctrl.viewModel.interactivityOptions.isDraggableField}" drag="field" drag-context="ctrl.getDragContext()" drag-disabled="!ctrl.viewModel.interactivityOptions.isDraggableField" drop="ctrl.dropConfig" drop-handler="ctrl.drop(event, ui, dropAction)" drop-action="ctrl.getDropAction(dropPosition)" drop-container-id="{{::\'container\'+$parent.$id}}" tooltip tooltip-config="ctrl.tooltipConfigManager.getTooltipConfig()"><h2 class="flex smallFontSize" ng-right-click="ctrl.showMenu($event)"><i ng-if="::!ctrl.viewModel.valid" tabindex="0" role="button" accessible-click="ctrl.editLabel()" aria-label="{{::ctrl.getEditableLabelAriaLabel()}}" class="errorIcon error item-auto"><svg-use-symbol sheet="fieldListPaneIcons" symbol-id="fieldListError"></svg-use-symbol></i><i ng-if="ctrl.viewModel.displayOptions.glyph" class="field-glyph glyphicon glyph-mini" ng-class="ctrl.viewModel.displayOptions.glyph"></i><editable-label class="propertyText propertyContent caption trimmedTextWithEllipsis item-fill" tabindex="0" aria-label="{{::ctrl.getEditableLabelAriaLabel()}}" display-name="ctrl.viewModel.displayOptions.displayName" on-blur="ctrl.rename(newName)" editable="ctrl.viewModel.isEditingLabel" disable-click="true" ng-dblclick="ctrl.editLabel()" ng-keydown="ctrl.onKeyDown($event)" custom-tooltip="true"></editable-label> <button ng-if="ctrl.viewModel.interactivityOptions.hasContextMenu" role="button" aria-expanded="false" aria-label="{{::ctrl.getEditableLabelAriaLabel()}}" class="fieldWellIcon dropDown item-auto" ng-class="{ \'glyphicon glyph-mini pbi-glyph-chevrondownsmall\': ctrl.newPaneColorsEnabled }" ng-click="ctrl.showMenu($event)"><svg-use-symbol ng-if="!ctrl.newPaneColorsEnabled" sheet="fieldListPaneIcons" symbol-id="fieldListDropdown"></svg-use-symbol></button> <button ng-if="ctrl.viewModel.interactivityOptions.isRemovableField" aria-label="{{::ctrl.removeAriaLabel}}" ng-click="ctrl.deleteFieldAndFocus($event)" class="delete glyphicon pbi-glyph-close glyph-micro"></button></h2><ol class="hierarchyList" ng-if="::ctrl.viewModel.hierarchyLevels"><li ng-repeat="hierarchyLevel in ::ctrl.viewModel.hierarchyLevels" class="flex"><span tabindex="0" aria-label="{{::hierarchyLevel.displayName}}" class="subcaption trimmedTextWithEllipsis item-fill" ng-bind="::hierarchyLevel.displayName"></span> <button aria-label="{{ctrl.removeAriaLabel}}" ng-click="ctrl.deleteFieldAndFocus($event, $index)" class="delete glyphicon pbi-glyph-close glyph-micro"></button></li></ol></li>'),e.put("components/fontPicker/fontPicker.html",'<select class="select-element"><option ng-repeat="font in $ctrl.fonts track by font.family" value="{{font.family}}" ng-selected="font.selected" ng-bind="font.displayName" ng-repeat-finish-event="fontListUpdatedEvent"></option></select>'),e.put("components/forecastCard/forecastCard.html",'<analytics-card card="$ctrl.card" instances="$ctrl.instances" card-title="$ctrl.card.name" maximum-instances="::$ctrl.card.maxInstances" is-label-editable="::$ctrl.card.isLabelEditable" display-name="$ctrl.displayName" description="$ctrl.description" visual-container="$ctrl.visualContainer" on-add-instance="::$ctrl.onAddInstance(changes, instance)" on-update-instance="::$ctrl.onUpdateInstance(instance)" on-save="::$ctrl.onSave(changes, slice)" is-card-dirty="::$ctrl.isCardDirty(property, value)" is-Forecast-Card="true"><div class="parameterValues card-slice" ng-class="{disabled: $ctrl.card.instances.length === 0}"><label localize="Visual_Forecast_Parameter_ForecastLength" class="forecastLabel trimmedTextWithEllipsis" tooltip tooltip-config="$ctrl.parameterSlices[\'forecastDataPoints\'].tooltipConfig"></label><div class="inputField forecastParameterField" ng-class="{disabled: $ctrl.card.instances.length === 0}"><property-pane-text-box ng-model="$ctrl.parameterSlices[\'forecastDataPoints\'].value" validators="$ctrl.parameterSlices[\'forecastDataPoints\'].validators" is-disabled="$ctrl.card.instances.length === 0"></property-pane-text-box><select-menu class="selection" ng-model="$ctrl.parameterSlices[\'units\'].value" options="$ctrl.parameterSlices[\'units\'].selectionOptions" ng-change="$ctrl.onUnitsUpdated()" is-disabled="$ctrl.card.instances.length === 0" new-pane-colors="::$ctrl.newPaneColorsEnabled"></select-menu></div><label localize="Visual_Forecast_Parameter_IgnoreLength" class="forecastLabel trimmedTextWithEllipsis" tooltip tooltip-config="$ctrl.parameterSlices[\'ignoreDataPoints\'].tooltipConfig"></label><div class="inputField forecastParameterField" ng-class="{disabled: $ctrl.card.instances.length === 0}"><property-pane-text-box ng-model="$ctrl.parameterSlices[\'ignoreDataPoints\'].value" validators="$ctrl.parameterSlices[\'ignoreDataPoints\'].validators" is-disabled="$ctrl.card.instances.length === 0"></property-pane-text-box><span class="selectedUnits" ng-bind="$ctrl.currentSelectedUnit"></span></div><label localize="Visual_Forecast_Parameter_ConfidenceInterval" class="forecastLabel trimmedTextWithEllipsis" tooltip tooltip-config="$ctrl.parameterSlices[\'confidenceInterval\'].tooltipConfig"></label><div class="inputField forecastParameterField" ng-class="{disabled: $ctrl.card.instances.length === 0}"><select-menu class="selection" ng-model="$ctrl.parameterSlices[\'confidenceInterval\'].value" options="$ctrl.parameterSlices[\'confidenceInterval\'].selectionOptions" is-disabled="$ctrl.card.instances.length === 0" new-pane-colors="::$ctrl.newPaneColorsEnabled"></select-menu></div><label localize="Visual_Forecast_Parameter_Seasonality" class="forecastLabel trimmedTextWithEllipsis" tooltip tooltip-config="$ctrl.parameterSlices[\'seasonality\'].tooltipConfig"></label><div class="inputField forecastParameterField" ng-class="{disabled: $ctrl.card.instances.length === 0}"><property-pane-text-box ng-model="$ctrl.parameterSlices[\'seasonality\'].value" validators="$ctrl.parameterSlices[\'seasonality\'].validators" placeholder="$ctrl.parameterSlices[\'seasonality\'].placeholder" is-disabled="$ctrl.card.instances.length === 0"></property-pane-text-box><span class="selectedUnits" localize="Visual_Forecast_Units_Point"></span></div><div class="applyButton"><pbi-button kind="text" label="Apply" accessible-click="$ctrl.saveForecastParameters()" ng-class="{active: $ctrl.haveParametersChanged()}" tabindex="{{$ctrl.card.instances.length === 0?-1:0}}" ng-disabled="$ctrl.card.instances.length === 0"></pbi-button></div></div></analytics-card>'),e.put("components/numericUnitSelection/numericUnitSelection.html",'<div class="numeric-unit-selector"><num-up-down [use-modern-styles]="false" [is-disabled]="$ctrl.isDisabled" [model-value]="$ctrl.modelVal" [validators]="$ctrl.validators" [new-pane-colors]="::$ctrl.newPaneColorsEnabled" (model-value-change)="$ctrl.changeValue($event)" [input-name]="::$ctrl.inputName"></num-up-down><select-menu class="selection unit-selection-box" is-disabled="$ctrl.isDisabled" ng-model="$ctrl.unitVal" ng-change="$ctrl.onValueChanged()" options="$ctrl.unitOptions" new-pane-colors="::$ctrl.newPaneColorsEnabled"></select-menu></div>'),e.put("components/pagePropertyPane/pagePropertyPane.html",'<section class="propertyPaneContents propertyPaneContentsFlex"><search-box filter="$ctrl.filter" showclearbutton="true" on-change="$ctrl.applyFilter()" arialive="polite" arialabelledby="searchSuggestion"></search-box><header class="unavailable" ng-if="!$ctrl.isAvailable() || $ctrl.isSearchEmpty()"><span ng-if="$ctrl.isAvailable()" localize="PropertyPane_NoSearchResult"></span><span ng-if="!$ctrl.isAvailable()" localize="PropertyPane_Unavailable"></span></header><ng-scrollbars ng-scrollbars-config="::$ctrl.scrollbarsConfig"><property-card class="card" ng-repeat="card in $ctrl.viewModel.cards track by card.id" expand-card-title="$ctrl.expandCard(cardName)" ng-show="!card.filtered" view-model="card" expanded="$ctrl.isCardExpanded(card.name)" card-changed="$ctrl.save(slice, card)" selected-container-changed="::$ctrl.selectContainer(cardName, containerKey)"></property-card></ng-scrollbars></section>'),e.put("components/propertyCard/propertyCard.html",'<section class="propertyCard"><div class="flex cardTitle" tabindex="0" role="button" aria-expanded="{{!!$ctrl.expanded}}" aria-labelledby="title-{{$ctrl.viewModel.id}}" accessible-click="$ctrl.expandCard($ctrl.viewModel.name)"><div class="cardTitleExpander arrowRight" ng-class="{\'selected\': $ctrl.expanded,                 \'glyphicon glyph-mini\': $ctrl.newPaneColorsEnabled,                 \'pbi-glyph-chevrondownsmall\': $ctrl.newPaneColorsEnabled && !$ctrl.expanded,                 \'pbi-glyph-chevronupsmall\': $ctrl.newPaneColorsEnabled && $ctrl.expanded}" tooltip tooltip-config="$ctrl.getTooltipConfig()"><svg-use-symbol ng-if="!$ctrl.newPaneColorsEnabled" sheet="visualizationPaneIcons" symbol-id="arrow_top"></svg-use-symbol></div><header class="cardTitleDisplayName item-fill trimmedTextWithEllipsis" ng-bind="::$ctrl.viewModel.displayName" tooltip tooltip-config="$ctrl.getTooltipConfig()" id="title-{{$ctrl.viewModel.id}}" aria-expanded="{{$ctrl.expanded}}" aria-controls="content-{{$ctrl.viewModel.id}}" role="button heading"></header><mobile-property-change-indicator-lazy ng-if="$ctrl.showChangeIndication" [type]="\'card\'" [view-model]="$ctrl.viewModel"></mobile-property-change-indicator-lazy><div class="cardTitleToggle item-auto" ng-if="$ctrl.viewModel.mainShow"><property-slice view-model="$ctrl.viewModel.mainShow" ng-click="$event.stopPropagation()" slice-changed="$ctrl.sliceChanged(slice)" type="$ctrl.getSliceComponentType($ctrl.viewModel.mainShow)" header-id="\'title-\'+$ctrl.viewModel.id"></property-slice></div></div><form ng-if="$ctrl.expanded" name="{{$ctrl.viewModel.id}}-form" class="contents" id="content-{{$ctrl.viewModel.id}}" aria-labelledby="title-{{$ctrl.viewModel.id}}" aria-hidden="{{!$ctrl.expanded}}"><virtual-list total-items-amount="$ctrl.viewModel.slices.length" init-limit="20"><div class="card-slice" ng-repeat="slice in $ctrl.viewModel.slices | limitTo:limitItems track by $ctrl.getSliceUniqueId(slice, $index)"><property-slice view-model="slice" slice-changed="$ctrl.sliceChanged(slice)" type="$ctrl.getSliceComponentType(slice)" show-change-indication="$ctrl.showChangeIndication" card-name="$ctrl.viewModel.name"></property-slice></div><div ng-if="$ctrl.selectedContainerKey" ng-show="!$ctrl.viewModel.selectedContainer.filtered"><div class="inputFieldWrapper"><div class="inputField" ng-class="{\'disabled\': $ctrl.viewModel.mainShow && !$ctrl.viewModel.mainShow.value}" ng-init="labelId=\'label-\'+$id"><label id="{{::labelId}}" class="title unselectable trimmedTextWithEllipsis" ng-if="$ctrl.viewModel.containersLabel" ng-bind="::$ctrl.viewModel.containersLabel" tooltip tooltip-config="$ctrl.getContainerTooltipConfig()"></label><div class="inputFieldContent"><select-menu class="item-fill selection" label-id="labelId" ng-model="$ctrl.selectedContainerKey" ng-change="$ctrl.onSelectedContainerChanged()" options="$ctrl.viewModel.containers" new-pane-colors="::$ctrl.newPaneColorsEnabled"></select-menu></div></div></div><property-slice-container slices="$ctrl.viewModel.selectedContainer.slices" on-changed="$ctrl.sliceChanged(slice)" show-change-indication="$ctrl.showChangeIndication" card-name="$ctrl.viewModel.name"></property-slice-container></div></virtual-list><property-slice-container slices="$ctrl.viewModel.footer" on-changed="$ctrl.sliceChanged(slice)"></property-slice-container></form></section>'),e.put("components/propertyPane/propertyPane.html",'<section class="propertyPaneContents propertyPaneContentsFlex"><search-box filter="$ctrl.filter" on-change="$ctrl.applyFilter()" arialive="assertive" arialabelledby="searchSuggestion"></search-box><div class="convertShape" ng-if="$ctrl.showCovertShapeBanner()"><message-banner class="convert-shape-message-banner" [view-model]="$ctrl.convertShapeBannerModel"></message-banner> <button localize="Convert" class="pbi-modern-button secondaryBtn compact" ng-click="$ctrl.showConvertShapeDialog()"></button></div><header class="unavailable" ng-if="!$ctrl.isAvailable() || $ctrl.isSearchEmpty()"><span ng-if="$ctrl.isAvailable()" localize="PropertyPane_NoSearchResult"></span><span ng-if="!$ctrl.isAvailable()" localize="PropertyPane_Unavailable"></span></header><ng-scrollbars ng-scrollbars-config="::$ctrl.scrollbarsConfig"><property-card class="card" ng-repeat="card in $ctrl.viewModel.cards track by card.id" expand-card-title="$ctrl.expandCard(cardName)" view-model="card" expanded="$ctrl.isCardExpanded(card.name)" card-changed="::$ctrl.save(slice, card)" ng-show="!card.filtered" selected-container-changed="::$ctrl.selectContainer(cardName, containerKey)" show-change-indication="$ctrl.showChangeIndication"></property-card></ng-scrollbars></section>'),e.put("components/propertySlice/propertySlice.html",'<div class="inputField" ng-show="$ctrl.viewModel.show && !$ctrl.viewModel.filtered" ng-switch="$ctrl.type" ng-class="{\'disabled\': $ctrl.viewModel.isDisabled, \'multiline-flex\': $ctrl.isMultiline(), \'invalid\': !$ctrl.viewModel.isValid }" ng-init="labelId=\'PropertySliceLabel-\'+$id" ng-right-click="$ctrl.showContextMenu($event)"><div class="sliceHeader"><label id="{{::labelId}}" class="title unselectable trimmedTextWithEllipsis {{$ctrl.getTitleClass()}}" ng-bind="$ctrl.viewModel.displayName" ng-if="$ctrl.showLabel()" tooltip tooltip-config="$ctrl.getTooltipConfig()"></label><mobile-property-change-indicator-lazy ng-if="$ctrl.showChangeIndication" [type]="\'slice\'" [view-model]="$ctrl.viewModel" [card-name]="$ctrl.cardName"></mobile-property-change-indicator-lazy></div><div class="inputFieldContent"><div class="primaryInput" ng-if="!$ctrl.viewModel.showLinkButtonOnly"> <button class="editDynamicExpression" type="button" ng-click="$ctrl.editDynamicExpression()" ng-if="$ctrl.isDynamicExpressionSet" is-disabled="$ctrl.viewModel.isDisabled" ng-class="$ctrl.type" label-id="labelId" aria-haspopup="true" ng-disabled="$ctrl.viewModel.isDisabled"><span class="glyphicon pbi-glyph-variable"></span></button><duration-picker [model-value]="$ctrl.viewModel.value" [validators]="$ctrl.viewModel.validators" (model-value-change)="$ctrl.changeValue($event)" ng-switch-when="duration" [is-disabled]="$ctrl.viewModel.isDisabled" [label-id]="labelId"></duration-picker><property-pane-text-box ng-model="$ctrl.viewModel.value" ng-change="$ctrl.change()" ng-switch-when="text" ng-if="!$ctrl.isDynamicExpressionSet" ng-attr-aria-haspopup="$ctrl.hasDynamicExpressionSupport" validators="$ctrl.viewModel.validators" placeholder="$ctrl.viewModel.placeholder" input-type="text" is-disabled="$ctrl.viewModel.isDisabled" label-id="labelId"></property-pane-text-box><property-pane-text-box ng-model="$ctrl.viewModel.value" ng-change="$ctrl.change()" ng-switch-when="numeric" ng-if="!$ctrl.isDynamicExpressionSet" ng-attr-aria-haspopup="$ctrl.hasDynamicExpressionSupport" validators="$ctrl.viewModel.validators" placeholder="$ctrl.viewModel.placeholder" input-type="number" is-disabled="$ctrl.viewModel.isDisabled" label-id="labelId"></property-pane-text-box><toggle-switch ng-class="::{\'main-show\': $ctrl.isCardShowSlice}" ng-switch-when="bool" ng-change="$ctrl.change()" ng-model="$ctrl.viewModel.value" warning-message="$ctrl.viewModel.warningMessage" label-id="labelId" is-disabled="$ctrl.viewModel.isDisabled"></toggle-switch><select-menu class="selection" ng-switch-when="selection" ng-if="!$ctrl.isDynamicExpressionSet" ng-model="$ctrl.viewModel.value" ng-change="$ctrl.change()" options="$ctrl.viewModel.selectionOptions" select-class="propertySliceSelect" is-disabled="$ctrl.viewModel.isDisabled" tabindex="-1" label-id="labelId" new-pane-colors="::$ctrl.newPaneColorsEnabled" aria-disabled="{{$ctrl.viewModel.isDisabled}}"></select-menu><property-pane-select-menu class="selection" ng-switch-when="propertyPaneSelection" ng-if="!$ctrl.isDynamicExpressionSet" [selected-value]="$ctrl.viewModel.value" [options]="$ctrl.viewModel.selectionOptions" (selection-change)="$ctrl.changeValue($event)" [disabled]="$ctrl.viewModel.isDisabled" [new-pane-colors]="::$ctrl.newPaneColorsEnabled" [label-id]="labelId"></property-pane-select-menu><pbi-lazy-load-modern ng-switch-when="flagsSelection" [module-path]="$ctrl.exploreUIAuthoringModulePath" [component-id]="\'FormatPaneFlagsControlComponentId\'" [input-args]="{modelValue: $ctrl.viewModel.value, options: $ctrl.viewModel.selectionOptions, isDisabled: $ctrl.viewModel.isDisabled, sliceLabel: $ctrl.viewModel.displayName, useModernStyles: false}" [output-args]="{modelValueChange: $ctrl.changeValue}"></pbi-lazy-load-modern><slider ng-switch-when="slider" [use-modern-styles]="false" [ng-if]="!$ctrl.isDynamicExpressionSet" [ng-attr-aria-haspopup]="$ctrl.hasDynamicExpressionSupport" [new-pane-colors]="::$ctrl.newPaneColorsEnabled" (model-value-change)="$ctrl.changeValue($event)" [model-value]="$ctrl.viewModel.value" [options]="$ctrl.viewModel.numericValueOptions" [input-name]="::$ctrl.viewModel.name" [is-disabled]="$ctrl.viewModel.isDisabled" [label-id]="labelId"></slider><alignment-group ng-switch-when="alignment" ng-change="$ctrl.change()" ng-model="$ctrl.viewModel.value" input-name="::$ctrl.viewModel.name"></alignment-group><downgraded-theme-color-input class="colorpicker-center" ng-switch-when="fill" ng-if="!$ctrl.isDynamicExpressionSet" ng-attr-aria-haspopup="$ctrl.hasDynamicExpressionSupport" [color]="$ctrl.viewModel.value" [on-change-color]="$ctrl.changeValue" [is-no-fill-item-supported]="$ctrl.isNoFillItemSupported" [is-disabled]="$ctrl.viewModel.isDisabled" [label-id]="labelId"></downgraded-theme-color-input><pbi-lazy-load-modern ng-switch-when="gradientBar" [module-path]="$ctrl.exploreUIAuthoringModulePath" [component-id]="\'GradientBarComponentId\'" [input-args]="{colors: $ctrl.viewModel.value}"></pbi-lazy-load-modern><image-upload ng-switch-when="image" ng-model="$ctrl.viewModel.value" ng-change="$ctrl.change()" [file-type]="\'Image\'"></image-upload><num-up-down ng-switch-when="numericSelection" class="useElementWidth" [ng-if]="!$ctrl.isDynamicExpressionSet" [ng-attr-aria-haspopup]="$ctrl.hasDynamicExpressionSupport" [use-modern-styles]="false" [is-disabled]="$ctrl.viewModel.isDisabled" (model-value-change)="$ctrl.changeValue($event)" [new-pane-colors]="::$ctrl.newPaneColorsEnabled" [model-value]="$ctrl.viewModel.value" [options]="$ctrl.viewModel.numericValueOptions" [placeholder-text]="::$ctrl.viewModel.placeholder" [input-name]="::$ctrl.viewModel.name" [label-id]="labelId"></num-up-down><numeric-unit-selection ng-switch-when="numericUnitSelection" is-disabled="$ctrl.viewModel.isDisabled" unit-options="$ctrl.viewModel.selectionOptions" ng-change="$ctrl.change()" ng-model="$ctrl.viewModel.value" input-name="::$ctrl.viewModel.name" validators="$ctrl.viewModel.validators"></numeric-unit-selection><shape-map-selector class="selection" ng-switch-when="geoJson" view-model="$ctrl.viewModel.value" type="$ctrl.viewModel.type" changed="$ctrl.change()"></shape-map-selector><textarea class="paragraph" ng-blur="$ctrl.change()" ng-model="$ctrl.viewModel.value" type="text" ng-switch-when="textarea" ng-if="!$ctrl.isDynamicExpressionSet" placeholder="{{::$ctrl.viewModel.placeholder}}" maxlength="250"></textarea><date-time-picker ng-switch-when="dateTime" ng-model="$ctrl.viewModel.value" ng-change="$ctrl.change()" ng-if="!$ctrl.isDynamicExpressionSet" ng-attr-aria-haspopup="$ctrl.hasDynamicExpressionSupport" label-id="labelId" placeholder="$ctrl.viewModel.placeholder" validators="$ctrl.viewModel.validators"></date-time-picker><font-picker class="selection" font-family="$ctrl.viewModel.value" on-font-family-change="$ctrl.changeValue(fontFamily)" ng-switch-when="fontPicker" label-id="labelId"></font-picker><div class="trimmedTextWithEllipsis" ng-class="$ctrl.viewModel.name" ng-switch-when="readOnlyText">{{$ctrl.viewModel.value}}</div><div class="linkButtonContainer" ng-switch-when="linkButton"> <a class="linkButton" ng-click="$ctrl.viewModel.value()" href="" aria-disabled="{{$ctrl.viewModel.isDisabled}}" aria-label="{{$ctrl.viewModel.ariaValue}}" tabindex="{{$ctrl.viewModel.isDisabled? -1 : 0}}">{{$ctrl.viewModel.displayName}}</a></div><div type="button" class="clearAll trimmedTextWithEllipsis" ng-class="{\'dirtyCard\': $ctrl.viewModel.value}" ng-switch-when="revertToDefault" accessible-click="$ctrl.change()" role="button" localize="{{$ctrl.getRevertResource()}}" localize-tooltip="{{$ctrl.getRevertTooltipResource()}}" tabindex="{{$ctrl.viewModel.isDisabled? -1 : 0}}" aria-disabled="{{$ctrl.viewModel.isDisabled}}"></div> <button class="clearAll trimmedTextWithEllipsis applyToAllPages" ng-class="{ \'dirtyCard\': $ctrl.viewModel.value }" ng-switch-when="applyToAllPages" ng-click="$ctrl.change()" is-disabled="$ctrl.viewModel.isDisabled" ng-disabled="$ctrl.viewModel.isDisabled" localize="PagePropertyPane_ApplyToAllPages"></button><property-slice-place-holder class="main-show" ng-switch-default warning-message="$ctrl.viewModel.warningMessage"></property-slice-place-holder><pbi-icon ng-if="!$ctrl.viewModel.isValid && !$ctrl.isCardShowSlice" class="warningIcon" name="warning" size="small" tooltip tooltip-config="$ctrl.getWarningTooltipConfig()"></pbi-icon> <button class="conditionalFormattingIndicator" type="button" ng-click="$ctrl.editDynamicExpression()" ng-if="!$ctrl.isDynamicExpressionSet && $ctrl.hasDynamicExpressionSupport" is-disabled="$ctrl.viewModel.isDisabled" aria-haspopup="true" ng-disabled="$ctrl.viewModel.isDisabled"><span class="glyphicon pbi-glyph-variable"></span></button> <button class="conditionalFormattingRevertIndicator" type="button" ng-click="$ctrl.changeValue(null)" ng-if="$ctrl.isDynamicExpressionSet" is-disabled="$ctrl.viewModel.isDisabled" ng-disabled="$ctrl.viewModel.isDisabled"><span class="glyphicon pbi-glyph-eraser"></span></button></div><div class="sameSliceLinkButtonContainer" ng-if="$ctrl.viewModel.linkButtonAction"> <a class="linkButton" ng-click="$ctrl.viewModel.linkButtonAction()" href="">{{$ctrl.viewModel.linkButtonDisplayName}}</a></div></div></div>'),e.put("components/propertySliceContainer/propertySliceContainer.html",'<div ng-repeat="slice in $ctrl.slices track by $index"><property-slice view-model="slice" slice-changed="$ctrl.sliceChanged(slice)" type="$ctrl.getSliceComponentType(slice)" show-change-indication="$ctrl.showChangeIndication" card-name="$ctrl.cardName"></property-slice></div>'),e.put("components/propertySlicePlaceHolder/propertySlicePlaceHolder.html",'<div class="slice-place-holder"><label class="slice-place-holder-label"><pbi-icon ng-if="$ctrl.warningMessage" class="warning" name="warning" size="small" tooltip tooltip-config="$ctrl.getTooltipConfig()"></pbi-icon></label></div>'),e.put("components/referenceLineCard/referenceLineCard.html",'<analytics-card card="$ctrl.card" instances="$ctrl.instances" card-title="$ctrl.getLineType($ctrl.line)" maximum-instances="::$ctrl.card.maxInstances" is-label-editable="::$ctrl.card.isLabelEditable" display-name="$ctrl.displayName" description="$ctrl.description" visual-container="$ctrl.visualContainer" on-add-instance="::$ctrl.onAddInstance(changes, instance)" on-delete-instance="::$ctrl.onDeleteInstance(instance)" on-update-instance="::$ctrl.onUpdateInstance(instance)" on-save="::$ctrl.onSave(changes, slice, instance)" is-card-dirty="::$ctrl.isCardDirty(property, value)"></analytics-card>'),e.put("components/referenceLineCardContainer/referenceLineCardContainer.html",'<reference-line-card card="$ctrl.prototypeCard" display-name="::line.displayName" description="::line.description" visual-container="$ctrl.visualContainer" ng-repeat="line in $ctrl.referenceLines track by line.type" line="line" valid-measures="$ctrl.validMeasures" instances="line.instances" ng-show="!line.filtered"></reference-line-card>'),e.put("components/shapeMapSelector/shapeMapSelector.html",'<div class="shapeMapSelector"> <input class="file-input" type="file" accept="{{$ctrl.fileType}}"/><div ng-if="$ctrl.showDropDown"><div class="label-container"><select-menu ng-model="$ctrl.selectedMapName" ng-change="$ctrl.change()" options="$ctrl.items" new-pane-colors="::$ctrl.newPaneColorsEnabled"></select-menu><div class="label"><span class="unselectable" localize="Visual_ShapeMap_PropertyPaneLabel"></span></div></div><div class="viewkeyslink-container"><a class="viewkeyslink" ng-show="$ctrl.viewModel.content" localize="Visual_ShapeMap_ViewMapKeys" ng-click="$ctrl.showDialog()" href=""></a></div></div><div class="custom-map-container" ng-if="!$ctrl.customMapName()"><div class="add-custom-map unselectable"><span localize="$ctrl.buttonTextKey" ng-click="$ctrl.addCustomMap()"></span></div></div><div class="custom-map-container custom-map-name-spacing" ng-if="$ctrl.customMapName()"><div class="trimmedTextWithEllipsis"><span class="unselectable" ng-attr-title="{{$ctrl.customMapName()}}" ng-bind="$ctrl.customMapName()"></span><span class="remove-custom-map glyphicon pbi-glyph-close unselectable" ng-click="$ctrl.removeCustomMap()"></span></div></div></div>'),e.put("components/taskPane/taskPane.html",'<exploration-pane-downgraded [expanded]="$ctrl.viewModel.isPaneExpanded" [title]="$ctrl.paneTitleKey" (on-toggle)="$ctrl.toggleTaskPane()" disable-scroll modeling-context-changer data-automation-type="taskPaneGroup" keyboard-shortcuts="ctrl-F6" focus-nav-mode="Group" focus-priority="9"><exploration-pane-section-downgraded class=\'paneSection\' no-padding><div class="paneContents" ng-if="$ctrl.viewModel.isPaneExpanded" pbi-lazy-load-contents="$ctrl.exploreUIShellConfig"><pbi-lazy-load-modern [module-path]="$ctrl.fieldListModulePath" [component-id]="\'FieldListContainerComponentId\'"></pbi-lazy-load-modern></div><div class="paneStopBottom" tabindex="0"></div></exploration-pane-section-downgraded></exploration-pane-downgraded>'),e.put("components/visualizationPane/visualizationPane.html",'<article modeling-context-changer data-automation-type="visualizationPaneGroup" keyboard-shortcuts="ctrl-F6" focus-nav-mode="Group" focus-priority="7"><div class="paneHeader"> <button class="btn toggleBtn" aria-label="{{viewModel.header}}" aria-expanded="{{!!viewModel.isPaneExpanded}}" ng-class="{ isCollapsed: !viewModel.isPaneExpanded }" ng-click="toggle()" localize-tooltip="Pane_Toggle"><div class="btnIcon glyphicon pbi-glyph-chevronrightmedium glyph-mini"></div><div class="sidePaneHorizontalTitle unselectable sidePaneTitle largeFontSize trimmedTextWithEllipsis" ng-bind="viewModel.header" ng-show="viewModel.isPaneExpanded"></div><div class="verticalTitle verticalText" ng-show="!viewModel.isPaneExpanded"><span class="collapsedVisualsTitle largeFontSize" ng-bind="viewModel.header" ng-show="populatePanes"></span></div></button></div><div class="paneContents flex" ng-if="viewModel.isPaneExpanded" pbi-lazy-load-contents="exploreUIShellConfig"><section ng-if="showVisualTypes" class="lazy-load-wrapper"><visual-types-container-modern [visual-plugin-filter]="viewModel.visualPluginFilter"></visual-types-container-modern></section><section ng-if="showVisualTypes && showNonPersonalVisualizationPane()" class="lazy-load-wrapper nonPersonalVisualizationPane"><spinner ng-if="!isPersonalVisualTypesLoaded"></spinner><visual-types-container-modern ng-show="isPersonalVisualTypesLoaded" [visual-plugin-filter]="viewModel.nonPersonalVisualizationPaneFilter" [disable-more-options-icon]="true" (is-finished-loading)="onVisualTypesContainerDoneLoading()"></visual-types-container-modern></section><nav class="sectionHeader item-auto pivotNav visualizationPane" ng-if="viewModel.sections.length && !isNonQueryVisual && populatePanes"><ul role="tablist"><li role="tab" section-tab-key-handler tooltip section-length="viewModel.sections.length" current-section="section.sectionType" set-active-section-function="setActiveSection(nextSection)" aria-controls="section-{{section.sectionType}}" aria-label="{{::section.displayName}}" tabindex="{{section.sectionType === viewModel.activeSection ? 0 : -1}}" aria-posinset="{{$index+1}}" aria-setsize="{{viewModel.sections.length}}" aria-selected="{{section.sectionType === viewModel.activeSection}}" ng-repeat="section in viewModel.sections" ng-mouseover="toggleEffectClasses(section.cssClass, true, true)" ng-mouseleave="toggleEffectClasses(section.cssClass, false, true)" ng-focus="toggleEffectClasses(section.cssClass, true, false)" ng-blur="toggleEffectClasses(section.cssClass, false, false)" accessible-click="setActiveSection(section.sectionType)" class="sectionTab" ng-class="{active: section.sectionType === viewModel.activeSection}"><svg-use-symbol class="sectionIcon" [sheet]="::sectionIconSheetName" [symbol-id]="getSectionIconSymbolId(section.cssClass)"></svg-use-symbol></li></ul><div class="navMarker visualizationPane"></div></nav><nav class="sectionHeader item-auto pivotNav visualizationPane" ng-if="viewModel.pagePaneSections.length && populatePanes"><ul role="tablist"><li role="tab" tooltip section-tab-key-handler section-length="viewModel.pagePaneSections.length" current-section="section.sectionType" set-active-section-function="setActivePagePaneSection(nextSection)" aria-controls="section-{{section.sectionType}}" aria-label="{{::section.displayName}}" tabindex="{{section.sectionType === viewModel.activePageSection ? 0 : -1}}" aria-posinset="{{$index+1}}" aria-setsize="{{viewModel.pagePaneSections.length}}" aria-selected="{{section.sectionType === viewModel.activePageSection}}" ng-keydown="onSectionKeyDown($event, section.sectionType, true)" ng-repeat="section in viewModel.pagePaneSections" ng-mouseover="toggleEffectClasses(section.cssClass, true, true)" ng-mouseleave="toggleEffectClasses(section.cssClass, false, true)" ng-focus="toggleEffectClasses(section.cssClass, true, false)" ng-blur="toggleEffectClasses(section.cssClass, false, false)" ng-click="setActivePagePaneSection(section.sectionType)" class="sectionTab" ng-class="{active: section.sectionType === viewModel.activePageSection}"><svg-use-symbol class="sectionIcon" [sheet]="::sectionIconSheetName" [symbol-id]="getSectionIconSymbolId(section.cssClass)"></svg-use-symbol></li></ul><div class="navMarker visualizationPane"></div></nav><div class="sectionHost item-fill" id="section-0" role="tabpanel" ng-if="showFieldWellOrFilters" section-animation-slider view-model="viewModel" nav-marker-parent="visualizationPane" ng-class="{\'readOnly\' : !populatePanes}"><ng-scrollbars ng-scrollbars-config="::scrollbarsConfig"><section ng-if="showFieldWell" data-automation-type="fieldWellLazy" class="lazy-load-wrapper"><field-well ng-if="!$ctrl.useModernFieldWell"></field-well><pbi-lazy-load-modern ng-if="$ctrl.useModernFieldWell" [module-path]="$ctrl.exploreUIAuthoringModulePath" [component-id]="\'FieldWellModernComponentId\'"></pbi-lazy-load-modern></section><section ng-if="showDrillthroughPane" class="lazy-load-wrapper"><pbi-lazy-load-modern [module-path]="$ctrl.exploreUIAuthoringModulePath" [component-id]="\'DrillthroughPaneComponentId\'"></pbi-lazy-load-modern></section></ng-scrollbars></div><section ng-if="showPropertyPane" focus-nav-mode="Browser" id="section-1" role="tabpanel" section-animation-slider view-model="viewModel" nav-marker-parent="visualizationPane" class="lazy-load-wrapper stretch item-fill"><property-pane role="application"></property-pane></section><section ng-if="showPagePropertyPane" focus-nav-mode="Browser" id="section-1" role="tabpanel" section-animation-slider view-model="viewModel" nav-marker-parent="visualizationPane" class="lazy-load-wrapper stretch item-fill"><page-property-pane></page-property-pane></section><section ng-if="showAnalyticsPane" focus-nav-mode="Browser" id="section-2" role="tabpanel" section-animation-slider view-model="viewModel" nav-marker-parent="visualizationPane" class="lazy-load-wrapper stretch item-fill"><analytics-pane></analytics-pane></section></div></article>'),e.put("views/inputFields/propertyPaneTextBox.html",'<form name="inputForm" novalidate> <input type="{{::inputType}}" class="inputFieldInSlice" pbi-validate="validators" autocomplete="off" ng-change="onChange()" ng-model="sliceValue" ng-model-options="{ debounce: 400 }" tooltip tooltip-config="getErrorMessage()" placeholder="{{::placeholder}}" maxlength="{{::maxLength}}" name="inputField" ng-keydown="onKeydown($event)" aria-labelledby="{{labelId}}" ng-disabled="isDisabled"/></form>'),e.put("views/virtualList.html",'<div class="virtual-list-container"><ng-scrollbars class="virtual-list" ng-scrollbars-config="::scrollbarsConfig"><ng-transclude></ng-transclude></ng-scrollbars></div>')}}),define("ExploreUIShell/module",["require","exports","ExploreUIShell/module.templates","ExploreUIShell/components/analyticsCard/analyticsCard","ExploreUIShell/components/fieldWell/fieldWell","ExploreUIShell/components/fieldWellField/fieldWellField","ExploreUIShell/components/fieldWellBucket/fieldWellBucket","ExploreUIShell/components/forecastCard/forecastCard","ExploreUIShell/components/anomalyDetectionCard/anomalyDetectionCard","ExploreUIShell/components/referenceLineCard/referenceLineCard","ExploreUIShell/components/analyticsInstanceSelector/analyticsInstanceSelector","ExploreUIShell/components/analyticsPane/analyticsPane","ExploreUIShell/components/referenceLineCardContainer/referenceLineCardContainer"],function(e,t,i,a,n,r,o,s,l,c,u,p,d){function v(){h||(angular.module("powerbi.exploreUIShell",["powerbi.explore","powerbi.common"]).run(["$templateCache",i.put]),h=!0)}Object.defineProperty(t,"__esModule",{value:!0}),t.registerBuildingBlocksForHost=t.initializeAngularModule=void 0,t.initializeAngularModule=v;var h=!1;v(),t.registerBuildingBlocksForHost=function(e){var t=[{name:"AlignmentGroup",blockType:2,consumerHostFlags:24875,factory:powerbi.explore.components.AlignmentGroup},{name:"AnalyticsCard",factory:a.AnalyticsCard,blockType:2,consumerHostFlags:24875},{name:"AnalyticsInstanceSelector",factory:u.AnalyticsInstanceSelector,blockType:2,consumerHostFlags:24587},{name:"AnalyticsPane",factory:p.AnalyticsPane,blockType:2,consumerHostFlags:24875},{name:"AnomalyDetectionCard",factory:l.AnomalyDetectionCard,blockType:2,consumerHostFlags:24587},{name:"FontPicker",dependencies:["$timeout"],blockType:2,consumerHostFlags:25099,factory:powerbi.explore.components.FontPicker},{name:"FieldPicker",blockType:2,consumerHostFlags:25387,factory:powerbi.explore.components.FieldPicker},{name:"FieldWell",factory:n.FieldWell,blockType:2,consumerHostFlags:24875},{name:"FieldWellBucket",factory:o.FieldWellBucket,blockType:2,consumerHostFlags:24875},{name:"FieldWellField",factory:r.FieldWellField,blockType:2,consumerHostFlags:24875},{name:"ForecastCard",factory:s.ForecastCard,blockType:2,consumerHostFlags:24587},{name:"NumericUnitSelection",blockType:2,consumerHostFlags:24875,factory:powerbi.explore.components.NumericUnitSelection},{name:"PropertyPaneTextBox",dependencies:["localizationService"],blockType:1,consumerHostFlags:25387,factory:powerbi.explore.directives.PropertyPaneTextBox},{name:"PbiValidate",blockType:1,consumerHostFlags:24875,factory:powerbi.explore.directives.PbiValidate},{name:"PagePropertyPane",blockType:2,consumerHostFlags:24875,factory:powerbi.explore.components.PagePropertyPane},{name:"PropertyCard",blockType:2,consumerHostFlags:24875,factory:powerbi.explore.components.PropertyCard},{name:"PropertyPane",blockType:2,consumerHostFlags:24875,factory:powerbi.explore.components.PropertyPane},{name:"PropertySlice",blockType:2,consumerHostFlags:24875,factory:powerbi.explore.components.PropertySlice},{name:"PropertySliceContainer",blockType:2,consumerHostFlags:24875,factory:powerbi.explore.components.PropertySliceContainer},{name:"ReferenceLineCard",factory:c.ReferenceLineCard,blockType:2,consumerHostFlags:24587},{name:"PropertySlicePlaceHolder",blockType:2,consumerHostFlags:24875,factory:powerbi.explore.components.PropertySlicePlaceHolder},{name:"ReferenceLineCardContainer",factory:d.ReferenceLineCardContainer,blockType:2,consumerHostFlags:24587},{name:"SectionAnimationSlider",blockType:1,consumerHostFlags:24875,factory:powerbi.explore.directives.SectionAnimationSlider},{name:"SectionTabKeyHandler",blockType:1,consumerHostFlags:24875,factory:powerbi.explore.directives.SectionTabKeyHandler},{name:"ShapeMapSelector",blockType:2,consumerHostFlags:24875,factory:powerbi.explore.components.ShapeMapSelector},{name:"ToggleSwitch",dependencies:["highContrastCssGenerationService","screenReaderService"],blockType:1,consumerHostFlags:24591,factory:powerbi.explore.directives.ToggleSwitch},{name:"VisualizationPane",blockType:2,consumerHostFlags:24875,factory:powerbi.explore.components.VisualizationPane},{name:"TaskPane",blockType:2,consumerHostFlags:24875,factory:powerbi.explore.components.TaskPane},{name:"VirtualList",blockType:1,consumerHostFlags:24875,factory:powerbi.explore.directives.VirtualList}];powerbi.common.registerBuildingBlocksForHost(e,t,{directivesTarget:"powerbi.exploreUIShell",componentsTarget:"powerbi.exploreUIShell"})}}),function(l){var e,c;e=(e=l.explore||(l.explore={})).viewModels||(e.viewModels={}),c=l.data.DataViewObjectDefinitions,(e.AnalyticsCardHelper||(e.AnalyticsCardHelper={})).saveAnalyticsCardAction=function(e,t,i,a){var n={},r=t.value,o=t.type,s=l.ValueType.fromDescriptor(t.type),e={objectName:e,selector:t.selector,properties:{}};return s.text||""!==r||(r=null),_.isUndefined(r)||_.isNull(r)||r instanceof l.data.SQConstantExpr&&_.isUndefined(r.value)?(e.properties[t.name]=r,n.remove||(n.remove=[]),n.remove.push(e)):(!t.type.variant||r instanceof l.data.SQExpr||(r=c.encodePropertyValue(r,o)),e.properties[t.name]=r,n.merge||(n.merge=[]),n.merge.push(e)),!!a.visualAuthoring.persistProperties(n,i,!0)&&(a.visualAuthoring.raiseVisualContainerChanged(i),!0)}}(powerbi=powerbi||{}),function(e){var r,o,s,a;function n(e,t,i,a,n){r.contracts.isVisualContainerGroup(i)&&(e===o.PropertyCardNames.General&&_.includes(s,t.name)?o.VisualContainerSliceFactoryHelper.saveGeneralPositionProperty(t,i,a,n):(i.objects=i.objects||{},o.VisualCapabilitiesSliceFactoryHelper.saveSliceToDefinition(e,t,i.objects,a)))}r=e.explore||(e.explore={}),o=r.viewModels||(r.viewModels={}),a=e.explore.contracts.VisualContainerGroup,e=o.VisualContainerGroupSliceFactoryHelper||(o.VisualContainerGroupSliceFactoryHelper={}),s=[o.GeneralPropertyNames.X,o.GeneralPropertyNames.Y,o.GeneralPropertyNames.Width,o.GeneralPropertyNames.Height],e.createPopulatePaneOptions=function(t){var i=t.featureSwitchService&&t.featureSwitchService.featureSwitches;return{objectDescriptors:a.objectDescriptors,objectDefinitions:t.group.objects,enumerateObjectInstances:function(e){if(e===o.PropertyCardNames.Background)return o.VisualContainerSliceFactoryHelper.enumerateBackgroundObjectInstances(t.group.evaluatedObjects&&t.group.evaluatedObjects[o.PropertyCardNames.Background],i,!1);if(e===o.PropertyCardNames.Border)return o.VisualContainerSliceFactoryHelper.enumerateBorderObjectInstances(t.group.evaluatedObjects&&t.group.evaluatedObjects[o.PropertyCardNames.Border],!1);if(e!==o.PropertyCardNames.General)return e===o.PropertyCardNames.LockAspect?o.VisualContainerSliceFactoryHelper.enumerateLockAspectObjectInstances(t.group.evaluatedObjects&&t.group.evaluatedObjects[o.PropertyCardNames.LockAspect]):void 0;e=t.group.evaluatedObjects&&t.group.evaluatedObjects[o.PropertyCardNames.General];return function(e,t){e={x:e&&e.x,y:e&&e.y,width:e&&e.width,height:e&&e.height};return e.altText=t||"",[{selector:null,properties:e,objectName:o.PropertyCardNames.General}]}(t.containerPosition,e&&e.altText)},save:n,visualStyle:t.visualStyle,itemPicker:t.itemPicker,undoRedo:t.undoRedo,promiseFactory:t.promiseFactory,localizationService:t.localizationService,cardIndexCounter:0}},e.saveProperty=n}(powerbi=powerbi||{}),function(e){!function(e){function n(){this.restrict="A",this.require="ngModel",this.scope={pbiValidate:"="},this.link=function(i,e,t,a){i.pbiValidate&&(a.$validators.required=function(e,t){return null==t||!i.pbiValidate.required||""!==t},a.$validators.min=function(e,t){return n.isLargerOrEqual(t,i.pbiValidate.min)},a.$validators.max=function(e,t){return n.isLargerOrEqual(i.pbiValidate.max,t)},a.$validators.decimal=function(e,t){return null==t||!i.pbiValidate.decimal||_.isFinite(Number(t))},a.$validators.integer=function(e,t){if(null==t||!i.pbiValidate.integer)return!0;t=Number(t);return _.isFinite(t)&&Math.floor(t)===t},a.$validators.url=function(e,t){return null==t||!i.pbiValidate.url||jsCommon.UrlUtils.isValidHttpUrl(t)})}}e=e.directives||(e.directives={}),n.isLargerOrEqual=function(e,t){if(null==e||null==t||""===e||""===t)return!0;e=Number(e),t=Number(t);return!_.isFinite(e)||!_.isFinite(t)||t<=e},e.PbiValidate=n}(e.explore||(e.explore={}))}(powerbi=powerbi||{}),function(e){function t(){this.restrict="E",this.replace=!0,this.transclude=!0,this.scope={initLimit:"=",totalItemsAmount:"="},this.templateUrl="views/virtualList.html",this.link=function(t,i){var a=0;t.limitItems=+t.initLimit,t.limitItems,t.scrollbarsConfig={ignoreOverlay:!1,ignoreMobile:!1};var n=i.find(".virtual-list"),r=2*i.height();n.scroll(function(){var e=n.scrollTop();e+(r=r||2*i.height())>n.height()&&(isNaN(t.totalItemsAmount),t.totalItemsAmount>=t.limitItems&&a<e&&(a=e,t.limitItems+=10,t.$digest()))})}}((e=e.explore||(e.explore={})).directives||(e.directives={})).VirtualList=t}(powerbi=powerbi||{}),function(e){((e=e.explore||(e.explore={})).directives||(e.directives={})).PropertyPaneTextBox=function(e){var n=this;this.require="ngModel",this.restrict="E",this.scope={validators:"=",placeholder:"<",inputType:"@",labelId:"<?",isDisabled:"<?"},this.templateUrl="views/inputFields/propertyPaneTextBox.html",this.link=function(i,e,t,a){a.$render=function(){var e=!1;(e="number"===i.inputType&&isNaN(a.$viewValue)?!0:e)||(i.sliceValue=a.$viewValue)},i.maxLength=i.validators&&i.validators.url?2048:250,i.onKeydown=function(e){e.which===$.ui.keyCode.DELETE&&e.stopPropagation()},i.onChange=function(){i.inputForm,i.inputForm&&!i.inputForm.$invalid&&a.$setViewValue(i.sliceValue)},i.getErrorMessage=function(){var e,t=i.inputForm.$error;return t&&(t.decimal||t.number?e=n.localizationService.get("Validation_NotANumber"):t.min?e=n.localizationService.get("Validation_NumberBelowMin"):t.max?e=n.localizationService.get("Validation_NumberAboveMax"):t.integer?e=n.localizationService.get("Validation_NumberNotInteger"):t.required?e=n.localizationService.get("Validation_Empty"):t.url?e=n.localizationService.get("Validation_NotAUrl"):_.isEmpty(t)),{tooltipDescription:e,tooltipDisable:_.isEmpty(t)}}},this.localizationService=e}}(powerbi=powerbi||{}),function(P){var e,x,r,M,V,D,o;function n(S,w,C){return __awaiter(this,void 0,P.Promise,function(){var t,i,a,n,r,o,s,l,c,u,p,d,v,h,g,m,y,f,b=this;return __generator(this,function(e){switch(e.label){case 0:return t=[],f=S.dataSourcesService,m=S.conceptualSchemaProxy,i=S.localizationService,a=S.changeDetectionMeasure,n=S.telemetryService,y=f.get(),[4,m.get(y)];case 1:if(!(f=e.sent()))return[2,[]];for(r=!1,o=0,s=f.schemas;o<s.length;o++)for(l=s[o],c=0,u=l.entities;c<u.length;c++)for(p=u[c],d=0,v=p.properties;d<v.length;d++)if((g=v[d]).measure&&g.measure.changeDetectionMetadata){h=D.parseISODurationdString(g.measure.changeDetectionMetadata.refreshInterval),(h=D.durationParseResultToArray(h)).length,h=V.getTimeString(h[0],i),g=g.name,t=t.concat(C.getMeasureAndCheckEverySlices(g,h,i,w)),r=!0;break}return S.explorationCapabilities.getCapabilities().disableChangeDetectionDialog?[2,t]:(m=function(){return __awaiter(b,void 0,P.Promise,function(){return __generator(this,function(e){return n.logEvent(P.telemetry.EXLaunchChangeDetectionDialog,{launchPoint:"PropertyPane"}),a.showDialog(),[2]})})},y=x.ViewModelFactory.getDisplayName(M(r?"ChangeDetectionEditLink":"ChangeDetectionAddLink")),f=i.get(r?"Link_Button_Edit_Aria_Value":"Link_Button_Add_Aria_Value"),t.push(C.getAddCDMDialogSlice(y,w,m,f)),[2,t])}})})}function a(e,t,i,a){var n=o.pageRefresh.dialogLauncher;return(new r.LegacySimpleFormattingSliceBuilder).withDisplayName(e,void 0,!0).withUid(n).withDisabled(t).withControlProperties(new r.LinkBuilder({descriptor:n,value:i,ariaLabel:a}).build()).build()}function s(e,t,i,a){return{name:"dialogLauncher",displayName:e,type:void 0,value:i,show:!0,placeholder:void 0,isValid:!0,isDisabled:t,save:void 0,ariaValue:a}}function l(e,t,i,a){var n=o.pageRefresh.measure,n=(new r.LegacySimpleFormattingSliceBuilder).withDisplayName(i.get("NewMeasureName")).withUid(n).withDisabled(a).withControlProperties(new r.ReadOnlyTextBuilder({descriptor:n,value:e}).build()).build(),e=o.pageRefresh.checkEvery;return[n,(new r.LegacySimpleFormattingSliceBuilder).withDisplayName(i.get("CheckEvery")).withUid(e).withDisabled(a).withControlProperties(new r.ReadOnlyTextBuilder({descriptor:e,value:t}).build()).build()]}function c(e,t,i,a){return[{name:"measure",displayName:i.get("NewMeasureName"),type:{readOnlyText:!0},selector:void 0,altConstantValueSelector:void 0,value:e,show:!0,placeholder:"",isValid:!0,isDisabled:a,containerIndex:void 0,save:void 0,selectionOptions:void 0,tooltip:e},{name:"checkEvery",displayName:i.get("CheckEvery"),type:{readOnlyText:!0},selector:void 0,altConstantValueSelector:void 0,value:t,show:!0,placeholder:"",isValid:!0,isDisabled:a,containerIndex:void 0,save:void 0,selectionOptions:void 0,tooltip:t}]}e=P.explore||(P.explore={}),e=(x=e.viewModels||(e.viewModels={})).ChangeDetectionPropertyPaneCardUtil||(x.ChangeDetectionPropertyPaneCardUtil={}),r=P.visuals.builder,M=P.data.createDisplayNameGetter,V=P.explore.util.DurationDisplayHelper,D=P.explore.util.DurationParser,o=P.explore.contracts.SectionProps,e.getFormattingSlices=function(t,i){return __awaiter(this,void 0,P.Promise,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,n(t,i,{getAddCDMDialogSlice:a,getMeasureAndCheckEverySlices:l})];case 1:return[2,e.sent()]}})})},e.populateChangeDetectionPropertyPaneCard=function(t,i,a){return __awaiter(this,void 0,P.Promise,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,n(t,a,{getAddCDMDialogSlice:s,getMeasureAndCheckEverySlices:c})];case 1:return e.sent().forEach(function(e){return i.push(e)}),[2]}})})}}(powerbi=powerbi||{}),function(p){var d;(function(e){var a=p.explore.viewModels.FieldListConceptualHierarchy,n=p.data.SQExprBuilder;e.getFieldExprKind=function(e){switch(e){case 2:return 1;case 3:return 2;case 0:return 0;case 6:return 3;default:return 0}},e.createFieldListExprGenerator=function(e,t){switch(e){case 1:return new s;case 2:return new c;case 3:return new i;default:return new r(t)}};var i=(t.prototype.fieldExpr=function(e){e=n.entity(e.schema.name,e.contract.name);return n.aggregate(e,2)},t);function t(){}var r=(o.prototype.fieldExpr=function(e){if(void 0!==e.kind){if(0===e.kind){if(d.utils.GroupUtils.isGroupOrClusteringColumn(e.entity.name,e.contract,this.groupingDesignStateService)){var t=n.entity(e.entity.contractSchema.name,e.entity.name),t=d.utils.GroupUtils.getGroupedColumnsFromMetadata(e.contract.column.groupingMetadata,t);return n.fieldExpr({groupingColumn:{schema:e.schema.name,entity:e.entity.name,name:e.name,groupedColumns:t}})}return n.fieldExpr({column:{schema:e.schema.name,entity:(e.originalEntity||e.entity).name,name:e.name}})}if(1===e.kind)return n.fieldExpr({measure:{schema:e.schema.name,entity:e.entity.name,name:e.name}})}},o);function o(e){this.groupingDesignStateService=e}var s=(l.prototype.fieldExpr=function(e){if(e.variation&&e.originalEntity){var t=e.parent;return n.fieldExpr({columnHierarchyVariation:{source:{name:t.name,schema:t.entity.contractSchema.name,entity:t.entity.name},hierarchy:{schema:e.entity.contractSchema.name,entity:e.originalEntity.name,name:e.contract.name},variationName:e.variation}})}return n.fieldExpr({hierarchy:{name:e.name,schema:e.entity.contractSchema.name,entity:(e.originalEntity||e.entity).name}})},l);function l(){}var c=(u.prototype.fieldExpr=function(e){if(e.variation&&e.parent instanceof a){var t=e.parent,i=t.parent;return n.fieldExpr({columnHierarchyLevelVariation:{source:{name:i.name,schema:i.entity.contractSchema.name,entity:i.entity.name},level:{schema:i.entity.contractSchema.name,entity:e.originalEntity.name,name:t.contract.name,level:e.name},variationName:e.variation}})}return n.fieldExpr({hierarchyLevel:{schema:e.entity.contractSchema.name,entity:e.entity.name,name:e.parent.name,level:e.name}})},u);function u(){}})((d=p.explore||(p.explore={})).util||(d.util={}))}(powerbi=powerbi||{});