"use strict";var powerbi,__awaiter=this&&this.__awaiter||function(e,s,n,l){return new(n=n||Promise)(function(i,t){function o(e){try{a(l.next(e))}catch(e){t(e)}}function r(e){try{a(l.throw(e))}catch(e){t(e)}}function a(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(o,r)}a((l=l.apply(e,s||[])).next())})},__generator=this&&this.__generator||function(i,o){var r,a,s,n={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return n.label++,{value:t[1],done:!1};case 5:n.label++,a=t[1],t=[0];continue;case 7:t=n.ops.pop(),n.trys.pop();continue;default:if(!(s=0<(s=n.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){n=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){n.label=t[1];break}if(6===t[0]&&n.label<s[1]){n.label=s[1],s=t;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(t);break}s[2]&&n.ops.pop(),n.trys.pop();continue}t=o.call(i,n)}catch(e){t=[6,e],a=0}finally{r=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},__extends=this&&this.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,i=1,o=arguments.length;i<o;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},__spreadArray=this&&this.__spreadArray||function(e,t){for(var i=0,o=t.length,r=e.length;i<o;i++,r++)e[r]=t[i];return e};!function(e){((e=e.sidePanes||(e.sidePanes={})).utilities||(e.utilities={})).convertAdUserMetaDataListToArtifactContactList=function(e){return _.map(e,function(e){return{contact:e,contactType:1}})}}(powerbi=powerbi||{}),function(e){((e=e.sidePanes||(e.sidePanes={})).utilities||(e.utilities={})).handleUpdateSettingsError=function(e,t){if(e&&e.error)switch(e.error.code){case"GroupOrPrincipalValidationFailed":var i=e.error["pbi.error"].parameters,o=_.isArray(i)?_.first(i).Key:_.first(Object.keys(i)),i=_.isArray(i)?_.first(i).Value:i[o];if("FailedGroupOrPrincipals"!==o)break;i=i&&i.trim().slice(1,-1);if(i){i=_.map(i.split(","),function(e){return e.trim()}).join("; ");return{errorMessage:t.format("PublishContentPack_InvalidGroupAddresses",[i])}}return{errorMessage:t.get("PublishContentPack_GroupsValidationFailed")};case"ContactsQuotaExceeded":return{errorMessage:t.get("Contacts_QuotaExceeded")};case"PromotedContentQuotaExceeded":return{errorMessage:t.get("PromotedContent_QuotaExceededError")};case"PowerBIEntityAlreadyExists":return{errorMessage:t.get("PromotedContent_AlreadyExistsError")}}}}(powerbi=powerbi||{}),function(e){((e=e.sidePanes||(e.sidePanes={})).htmlTemplate||(e.htmlTemplate={})).put=function(e){e.put("components/expando/expando.html","<i class=\"glyphicon glyph-mini expand\" ng-class=\"$ctrl.expanded ? 'pbi-glyph-chevronupmedium' : 'pbi-glyph-chevrondownmedium'\" localize-tooltip=\"{{$ctrl.expanded ? 'Chevron_CollapseDescription' : 'Chevron_ExpandDescription'}}\" dynamic-tooltip-update></i>"),e.put("components/folderPermissionsEditBlade/folderPermissionsEditBlade.html",'<div id="folderAccess" class="paneLayout noSelect"><header class=primaryHeading><i class="glyphicon pbi-glyph-user glyph-medium accessUserIcon"></i><h1 class="accessHeader" localize="Access"></h1><h2 class="accessSubHeader" bind-text-and-tooltip="$ctrl.model.folder.displayName"></h2></header><section class="accessContentContainer"><section class="informationProtectionWarning" ng-if="$ctrl.showInformationProtectionWarning"><pbi-lazy-load-modern [module-path]="::$ctrl.MessageBannerModulePath" [component-id]="\'MessageBannerComponentId\'" [input-args]="{viewModel: $ctrl.informationProtectionBannerModel}"></pbi-lazy-load-modern></section><span class="contentTitle accessContentHeader" localize="Access_Folder_UserPermissionDescription"></span><a href="https://aka.ms/workspaceRoles" target="_blank" localize="LearnMore"></a><emails-list view-model="$ctrl.model.emailsList" ng-disabled="$ctrl.isSaving" allow-security-groups="true" allow-object-ids="true" allow-service-principals="true" on-tag-added="$ctrl.validateInputTags()" on-tag-removed="$ctrl.resetValidation()" allow-distribution-lists="true" allow-unified-groups="::$ctrl.allowUnifiedGroups" check-valid-org-user="true" is-finding-users="$ctrl.isFindingUsers" include-guests="true"></emails-list><div class="domainAlert" ng-if="$ctrl.model.emailValidationWarning"><i class="glyphicon glyph-small pbi-glyph-warning"></i><span ng-bind="$ctrl.model.emailValidationWarning"></span></div> <select class="memberRole" ng-model="$ctrl.model.folderMemberRoleOption" ng-options="folderMemberRoleOption.key as folderMemberRoleOption.value for folderMemberRoleOption in $ctrl.model.folderMemberRoleOptions" ng-disabled="$ctrl.isSaving" ng-attr-aria-label="{{$ctrl.getDisplayStringForMemberRole($ctrl.model.folderMemberRoleOption)}}"></select><pbi-button class="addMembers" label="GroupEditor_AddButton_Text" primary="true" ng-click="$ctrl.addMembersWithAccess()" ng-disabled="$ctrl.canAdd()"></pbi-button><label class="error" title="{{$ctrl.model.invalidEmailAddressesErrorMessage }}" ng-if="$ctrl.model.invalidEmailAddressesErrorMessage  !== \'\'" ng-bind="$ctrl.model.invalidEmailAddressesErrorMessage "></label><label class="error" title="{{$ctrl.model.notExitingEmailAddressesErrorMessage}}" ng-if="$ctrl.model.notExitingEmailAddressesErrorMessage !== \'\'" ng-bind="$ctrl.model.notExitingEmailAddressesErrorMessage"></label><section class="accessUserListSection"><search-box class="searchBoxContainer" filter="$ctrl.model.searchFilter"></search-box><ul><li class="header"><span class="username" localize="ContentHeader_Name"></span><span class="usertype" localize="Access_Folder_UserPermission"></span></li><li class="accessListData" ng-repeat="member in filteredMembers = ($ctrl.model.members | filter: { displayName: $ctrl.model.searchFilter })"><ng-container ng-switch="::$ctrl.services.appPrincipalService.isAppOnlyUser(member)"><div ng-switch-when="false" class="username"><span id="displayName{{$index}}" class="trimmedTextWithEllipsis display-name" ng-bind="::$ctrl.getMemberDisplayName(member)"></span> <button class="info-button glyphicon pbi-glyph-info glyph-small" tooltip tooltip-config="::$ctrl.getMemberInfoTooltipConfig(member)"></button></div><downgraded-app-principal-details ng-switch-when="true" class="username" [user]="member" [given-name]="member.displayName" [object-id]="member.objectId"></downgraded-app-principal-details></ng-container><div class="action"><div class="userTypeLabel" ng-if="::user.isExternalUser"><span localize="Sharing_Guest"></span><i class="glyphicon glyph-small pbi-glyph-info" localize-tooltip="Sharing_Guest_Info"></i></div> <button ng-if="::$ctrl.canEdit(member)" class="optionsMenu glyphicon pbi-glyph-more glyph-small" dropdown-menu dropdown-items="$ctrl.getValidMenuItemsForMember(member)" dropdown-on-item-selected="$ctrl.onMemberAccessMenuItemSelected(member, selected.action)" localize-tooltip="Actions"></button><div class="performAction" ng-switch="member.permission"><span ng-switch-when="13" localize="GroupEditor_RoleOptions_Member" localize-attr="{title: \'GroupEditor_RoleOptions_MemberTooltip\'}"></span><span ng-switch-when="9" localize="GroupEditor_RoleOptions_Contributor" localize-attr="{title: \'GroupEditor_RoleOptions_ContributorTooltip\'}"></span><span ng-switch-when="15" localize="GroupEditor_RoleOptions_Admin" localize-attr="{title: \'GroupEditor_RoleOptions_AdminTooltip\'}"></span><span ng-switch-when="1" localize="GroupEditor_RoleOptions_Viewer" localize-attr="{title: \'GroupEditor_RoleOptions_ViewerTooltip\'}"></span><span ng-switch-when="7" localize="GroupEditor_RoleOptions_Admin" localize-attr="{title: \'GroupEditor_RoleOptions_AdminTooltip\'}"></span><span ng-switch-when="5" localize="GroupEditor_RoleOptions_Member" localize-attr="{title: \'GroupEditor_RoleOptions_MemberTooltip\'}"></span></div></div></li></ul></section></section><footer><spinner ng-if="$ctrl.isSaving"></spinner><pbi-button class="buttons" label="Close" ng-click="$ctrl.cancel()" ng-disabled="$ctrl.isSaving"></pbi-button></footer></div>'),e.put("components/groupEditor/create/createGroupBlade.html",'<ng-form name="createGroupForm"><div class="groupsEditorBlade paneLayout" ng-switch="$ctrl.isTryingWorkspacesV2Preview"><header><h1 class="primaryHeading" localize="GroupEditor_Title_CreateGroup"></h1></header><section ng-if="$ctrl.showImproveWorkspaceBanner" class="workspaceV2BannerSection" feature-switch-not="workspacesV2GA"><div class="workspaceBannerContentDiv"><span localize="GroupEditor_NewWorkspaceHeader_Text"></span><span localize="GroupEditor_NewWorkspaceMessage_Text"></span><a href="https://aka.ms/Iskx6l" target="_blank" localize="LearnMore"></a><pbi-button label="GroupEditor_NewWorkspaceLink_Text" ng-click="$ctrl.toggleFolderModePreview()" class="tryNowBtn" ng-disabled="$ctrl.isSaving"></pbi-button></div></section><section ng-if="$ctrl.showImproveWorkspaceBanner" class="workspaceV2BannerSection workspaceGABannerContentDiv" feature-switch="workspacesV2GA"><span localize="GroupEditor_NewWorkspaceHeaderGA_Text"></span><span localize="GroupEditor_NewWorkspaceMessageGA_Text"></span><div><a href="" ng-click="$ctrl.toggleFolderModePreview()" localize="GroupEditor_NewWorkspaceLinkGA_Text" ng-disabled="$ctrl.isSaving"></a> <span class="divider">|</span><a href="https://aka.ms/Iskx6l" target="_blank" localize="LearnMore"></a></div></section><section ng-if="$ctrl.showDowngradeWorkspaceBanner" class="workspaceV2BannerSection workspaceGABannerContentDiv" feature-switch="workspacesV2GA"><span localize="GroupEditor_OldWorkspaceHeader_Text"></span><span localize="GroupEditor_OldWorkspaceMessage_Text"></span><div><a href="" ng-click="$ctrl.toggleFolderModePreview()" localize="GroupEditor_OldWorkspaceMessage_LinkText"></a> <span class="divider">|</span><a href="https://aka.ms/createWorkspaceV2" target="_blank" localize="LearnMore"></a></div></section><section class="contentContainer" ng-switch-when="false"><section class="displayBlock"><h4 class="title" localize="WorkspaceName"></h4> <input id="groupName" localize-attr="{placeholder: \'NameThisWorkspace\', label: \'WorkspaceName\'}" required name="groupName" type="text" spellcheck="false" localize-tooltip="GroupEditor_GroupName_Tooltip" autocomplete="off" ng-model="$ctrl.model.groupName" ng-keyup="$ctrl.groupNameKeyUp()"/></section><section class="displayBlock"><h4 class="title" ng-if="$ctrl.model.groupName" localize="GroupEditor_GroupIdLabel_Text"></h4> <input name="groupId" spellcheck="false" type="text" autocomplete="off" ng-if="$ctrl.model.groupName" ng-model="$ctrl.model.groupId" ng-disabled="!$ctrl.isEditingGroupId" ng-keyup="$ctrl.groupIdKeyUp()"><pbi-button id="createGroupEditNameIcon" kind="icon" icon-name="edit" icon-size="small" ng-click="$ctrl.isEditingGroupId = true" ng-if="$ctrl.model.groupName && !$ctrl.isEditingGroupId" localize-tooltip="GroupEditor_GroupIdEdit_Tooltip"></pbi-button><div ng-if="$ctrl.isValidatingGroupId" class="spinnerWithText"><spinner [size]="\'xsmall\'"></spinner><div localize="GroupEditor_WaitForGroupIdValidation"></div></div><div class="spinnerWithText" ng-hide="$ctrl.isValidatingGroupId || !$ctrl.model.groupId" ng-switch="$ctrl.groupValidationStatus"><label ng-switch-when="0" for="createGroupEditNameIcon" localize="GroupEditor_CreateGroup_GroupId_Available_Text"></label><label ng-switch-when="1" for="createGroupEditNameIcon" localize="GroupEditor_CreateGroup_GroupId_NotAvailable_Text"></label><label ng-switch-when="2" localize="GroupEditor_FailedValidateGroupId_Message"></label><label ng-switch-when="3" localize="GroupEditor_CreateGroup_GroupId_HasInvalidCharacters"></label></div></section><section class="displayBlock"><h4 class="title" localize="Privacy"></h4> <select name="privacySetting" localize-tooltip="Privacy" ng-model="$ctrl.model.privacyOption" ng-options="privacyOption.key as privacyOption.value for privacyOption in $ctrl.model.privacyOptions" ng-disabled="$ctrl.isSaving"></select> <select name="accessControlOption" localize-tooltip="GroupEditor_AccessControlOptions" ng-if="::$ctrl.readOnlyGroupEnabled" ng-model="$ctrl.model.accessControlOption" ng-options="accessControlOption.key as accessControlOption.value for accessControlOption in $ctrl.model.accessControlOptions" ng-disabled="$ctrl.isSaving"></select></section><section class="displayBlock"><h4 class="title" localize="GroupEditor_AddGroupMembersLabel_Text"></h4><emails-list id="emailList" view-model="$ctrl.model.emailsList" include-guests="true"></emails-list><pbi-button id="addButton" label="GroupEditor_AddButton_Text" primary="true" ng-click="$ctrl.add()" ng-disabled="!$ctrl.model.emailsList.inputUserList || $ctrl.isSaving"></pbi-button><div class="spinnerWithText" ng-if="$ctrl.isAddingMembers"><spinner></spinner><div localize="GroupEditor_WaitForAddingMembers"></div></div><div class="error"><label title="{{$ctrl.model.invalidEmailAddressesErrorMessage }}" ng-if="$ctrl.model.invalidEmailAddressesErrorMessage  !== \'\'" ng-bind="$ctrl.model.invalidEmailAddressesErrorMessage "></label><label title="{{$ctrl.model.notExitingEmailAddressesErrorMessage}}" ng-if="$ctrl.model.notExitingEmailAddressesErrorMessage !== \'\'" ng-bind="$ctrl.model.notExitingEmailAddressesErrorMessage"></label></div><ul class="userListContainer"><li ng-repeat="member in $ctrl.model.displayMemberList track by member.userPrincipalName"><span class="username trimmedTextWithEllipsis" ng-bind="::member.userPrincipalName"></span> <select name="groupMemberRole" class="usertype" ng-if="::$ctrl.readOnlyGroupEnabled && member.role !== 2" ng-model="member.role" ng-options="groupMemberRole.key as groupMemberRole.value for groupMemberRole in $ctrl.model.groupMemberRoleOptions"></select><pbi-button kind="icon" icon-name="delete" icon-size="mini" ng-click="$ctrl.removeMember(member);createGroupForm.$setDirty();"></pbi-button></li></ul></section> <button class="displayBlock advanced" ng-if="::$ctrl.capacityEnabled" ng-click="$ctrl.toggleAdvancedMode()" aria-expanded="{{$ctrl.isAdvancedModeExpanded}}" localize-tooltip="Advanced"><h4 class="title" localize="Advanced"></h4><expando expanded="$ctrl.isAdvancedModeExpanded"></expando></button><section class="displayBlock capacity" ng-if="$ctrl.isAdvancedModeExpanded"><div class="licenseHeadingContainer"><label class="input-field-label altTextStyling" localize="Workspace_LicenseMode"></label><i class="glyphicon pbi-glyph-info" tooltip tooltip-config="$ctrl.getLicenseModeToolTipConfig()"></i></div><pbi-radio-group-legacy ng-model="$ctrl.model.licenseMode" ng-change="$ctrl.onLicenseModeChange()" no-label><pbi-radio class="licenseModeOption" label="Workspace_LicenseMode_Pro" ng-value="0"></pbi-radio><pbi-radio class="licenseModeOption" label="Workspace_LicenseMode_PPU" ng-value="1" ng-disabled="true"></pbi-radio><pbi-radio class="licenseModeOption" label="Workspace_LicenseMode_Premium" ng-value="2" ng-disabled="!$ctrl.licenseModeAvailability[2]"></pbi-radio><div class="radioAndInfoContainer"><pbi-radio class="licenseModeOption" label="Workspace_LicenseMode_Embedded" ng-value="3" ng-disabled="!$ctrl.licenseModeAvailability[3]"></pbi-radio><i class="glyphicon pbi-glyph-info embeddedModeInfo" tooltip tooltip-config="$ctrl.getEmbeddedToolTipConfig()"></i></div></pbi-radio-group-legacy><div class="capEdit" ng-if="$ctrl.canEditCapacity($ctrl.capacitiesList)"><label class="subtitle capacitySelection" for="groupEditorCapacitySelector" localize="Workspace_LicenseMode_Select"></label> <select ng-model="$ctrl.model.capacity" id="groupEditorCapacitySelector" ng-change="$ctrl.capacityChange()" ng-options="capacity as $ctrl.getCapacityOptionDisplayText(capacity) for capacity in $ctrl.capacitiesList"></select><a localize="Capacity_LearnMore_PremiumCapacities" href="https://go.microsoft.com/fwlink/?linkid=845343" target="_blank"></a></div></section></section><section class="contentContainer" ng-switch-when="true"><span class="bladeInnerContent imageLabel" localize="WorkspaceImage"></span><image-picker [(icon-url)]="$ctrl.model.iconUrl" [(icon-updated)]="$ctrl.model.iconUpdated"></image-picker><section class="bladeInnerContent"><h4 class="title" localize="WorkspaceName"></h4> <input id="folderName" localize-attr="{placeholder: \'NameThisWorkspace\', label: \'WorkspaceName\'}" required name="groupName" type="text" class="{errorFolderNameInput: !$ctrl.latestFolderNameIsValid}" spellcheck="false" autocomplete="off" maxlength="256" ng-model="$ctrl.model.groupName" ng-change="$ctrl.folderNameChanged()" localize-tooltip="GroupEditor_GroupName_Tooltip"/><div ng-if="$ctrl.isValidatingFolderName" class="spinnerWithText"><spinner [size]="\'xsmall\'"></spinner><div localize="GroupEditor_WaitForGroupIdValidation"></div></div><div ng-hide="$ctrl.isValidatingFolderName || !$ctrl.model.groupName" ng-switch="$ctrl.latestFolderNameIsValid"><label ng-switch-when="true" for="validationIcon" localize="GroupEditor_CreateGroup_GroupId_Available_Text"></label><div class="errorMessageContainer" ng-switch-when="false"><i class="glyphicon glyph-small pbi-glyph-error"></i><span class="errorMessage" localize="GroupEditor_CreateGroup_GroupId_NotAvailable_Text"></span></div></div></section><section class="bladeInnerContent"><h4 localize="Description"></h4><textarea localize-attr="{placeholder: \'DescribeThisWorkspace\'}" name="description" class="folderDescriptionBox" maxlength="4000" ng-model="$ctrl.model.description" localize-tooltip="Description"></textarea><a href="https://go.microsoft.com/fwlink/?linkid=2053958" class="learnMoreLink" target="_blank" localize="LearnMore_WorkspaceSettings"></a></section> <button class="bladeInnerContent advanced" ng-if="::$ctrl.capacityEnabled" ng-click="$ctrl.toggleAdvancedMode()" aria-expanded="{{$ctrl.isAdvancedModeExpanded}}" localize-tooltip="Advanced"><h4 class="title" localize="Advanced"></h4><expando expanded="$ctrl.isAdvancedModeExpanded"></expando></button><section class="displayBlock" feature-switch="workspacesV2GAFeatures" ng-if="$ctrl.isAdvancedModeExpanded"><span class="input-field-label altTextStyling" localize="ContactList"></span><pbi-radio-group-legacy ng-model="$ctrl.model.notificationTarget" no-label><pbi-radio id="radioEditorAdmins" label="CapacityWorkspaces_WorkspaceAdmins" ng-value="0"></pbi-radio><pbi-radio id="radioEditorSpecificUsersAndGroups" label="GroupEditor_ContactList_SendToSpecificUsers" ng-value="1"></pbi-radio></pbi-radio-group-legacy><section class="workspaceContactList" ng-class="{\'disabled\': !$ctrl.model.notificationTarget}"><emails-list view-model="$ctrl.model.contactList" allow-email-enabled-security-groups="true" allow-object-ids="true" allow-distribution-lists="true" allow-unified-groups="true" check-valid-org-user="true" is-finding-users="$ctrl.isFindingUsers" placeholder="\'EmailsList_UsersAndGroupsPlaceholder\'"></emails-list></section><span class="sharePointHeader input-field-label altTextStyling" localize="WorkspaceSharePoint"></span><section class="workspaceContactList"><emails-list view-model="$ctrl.model.sharePointStorageList" allow-security-groups="false" allow-object-ids="true" allow-distribution-lists="false" allow-unified-groups="true" on-tag-added="$ctrl.validateSharePointInputTags()" on-tag-removed="$ctrl.resetSharePointValidation()" block-users="true" check-valid-org-user="true" is-finding-users="$ctrl.isFindingGroups" placeholder="\'Optional_Parenthesis\'" max-tags="1"></emails-list></section></section><section class="bladeInnerContent capacity" ng-if="$ctrl.isAdvancedModeExpanded"><div class="licenseHeadingContainer"><label class="input-field-label altTextStyling" localize="Workspace_LicenseMode"></label><i class="glyphicon pbi-glyph-info" tooltip tooltip-config="$ctrl.getLicenseModeToolTipConfig()"></i></div><pbi-radio-group-legacy ng-model="$ctrl.model.licenseMode" ng-change="$ctrl.onLicenseModeChange()" no-label><pbi-radio class="licenseModeOption" label="Workspace_LicenseMode_Pro" ng-value="0" ng-disabled="!$ctrl.licenseModeAvailability[0]"></pbi-radio><pbi-radio class="licenseModeOption" label="Workspace_LicenseMode_PPU" ng-value="1" ng-disabled="!$ctrl.licenseModeAvailability[1]"></pbi-radio><pbi-radio class="licenseModeOption" label="Workspace_LicenseMode_Premium" ng-value="2" ng-disabled="!$ctrl.licenseModeAvailability[2]"></pbi-radio><div class="radioAndInfoContainer"><pbi-radio class="licenseModeOption" label="Workspace_LicenseMode_Embedded" ng-value="3" ng-disabled="!$ctrl.licenseModeAvailability[3]"></pbi-radio><i class="glyphicon pbi-glyph-info embeddedModeInfo" tooltip tooltip-config="$ctrl.getEmbeddedToolTipConfig()"></i></div></pbi-radio-group-legacy><div class="capEdit" ng-if="$ctrl.canEditCapacity($ctrl.capacitiesList)"><label class="subtitle capacitySelection" for="groupEditorCapacitySelector" localize="Workspace_LicenseMode_Select"></label> <select ng-model="$ctrl.model.capacity" id="groupEditorCapacitySelector" ng-change="$ctrl.capacityChange()" ng-options="capacity as $ctrl.getCapacityOptionDisplayText(capacity) for capacity in $ctrl.capacitiesList"></select><a localize="Capacity_LearnMore_PremiumCapacities" href="https://go.microsoft.com/fwlink/?linkid=845343" target="_blank"></a></div><div class="capEdit" ng-if="$ctrl.allowLargeFiles && $ctrl.model.isCapacityEnabled"><label class="subtitle capacitySelection" for="groupEditorStorageFormatSelector" localize="GroupEditor_StorageFormat"></label> <select ng-model="$ctrl.model.defaultDatasetStorageFormat" ng-disabled="!$ctrl.isPremiumFilesSupported" id="groupEditorStorageFormatSelector"><option ng-value="{{ 1 }}" localize="GroupEditor_StorageFormat_Small"></option><option ng-value="{{ 2 }}" localize="GroupEditor_StorageFormat_Large"></option></select><section class="warningMessageContainer storageFormatWarning" ng-if="!$ctrl.isPremiumFilesSupported"><p localize="GroupEditor_StorageFormat_Warning"></p></section><a localize="GroupEditor_StorageFormat_LearnMore" href="https://go.microsoft.com/fwlink/?linkid=2147083" target="_blank"></a></div></section><section class="bladeInnerContent dataflowsStorageAccount" ng-class="{\'capOpen\': $ctrl.model.isCapacityEnabled}" ng-if="$ctrl.isAdvancedModeExpanded && $ctrl.showDataflowsStorageAccount"><section class="datToggle"><pbi-toggle class="toggle" on-state-text="ToggleSwitchOn" off-state-text="ToggleSwitchOff" ng-model="$ctrl.isDataflowsStorageAccountEnabled" label="DataflowsStorageTitle"></pbi-toggle><pbi-icon name="info" size="small" tooltip tooltip-config="{tooltipLocalizeDescription: \'DataflowsStorageAccountTooltip\', tooltipArrowPosition: 1}"></pbi-icon></section><section class="warningMessageContainer" ng-if="$ctrl.isDataflowsStorageAccountEnabled"><p localize="DataflowsStorageAccount_CreateWarning"></p><ul><li localize="DataflowsStorageAccount_CreateWarning_Part1"></li><li><span localize="DataflowsStorageAccount_CreateWarning_Part2" localize-fragments><a target="_blank" fragment-index="0" href="https://go.microsoft.com/fwlink/?linkid=2037985" localize="Generic_LearnMore" localize-tooltip="Generic_LearnMore"></a></span></li></ul></section></section><section class="serviceAppInfo" ng-if="$ctrl.isAdvancedModeExpanded && $ctrl.showServiceAppCheckbox"><pbi-checkbox label="GroupEditor_ServiceAppCheckbox" class="serviceAppCheckBox" aria-label="{{::$ctrl.serviceAppCheckboxAriaLabel}}" ng-model="$ctrl.model.isServiceApp"></pbi-checkbox><p><span localize="GroupEditor_ServiceAppCreateInfo"></span><a href="http://aka.ms/powerbiapps" target="_blank" rel="noopener noreferrer" localize="LearnMore"></a></p></section><section class="allowContributorUpdateApp" ng-if="$ctrl.isAdvancedModeExpanded"><span class="input-field-label altTextStyling" localize="SecuritySettings"></span><pbi-checkbox label="AllowContributorsUpdateAppForWorkspace" ng-model="$ctrl.model.allowContributorUpdateApp" aria-label="{{::$ctrl.allowContributorUpdateAppAriaLabel}}"></pbi-checkbox></section></section><footer><fieldset class="buttons"><spinner ng-if="$ctrl.isSaving"></spinner><pbi-button label="GroupEditor_SaveButton_Text" ng-click="$ctrl.save()" ng-disabled="!createGroupForm.$dirty && !$ctrl.model.iconUpdated || editGroupForm.$invalid || !$ctrl.canSave || $ctrl.isSaving || $ctrl.isFindingGroups" primary="true"></pbi-button><pbi-button label="Cancel_ButtonText" ng-click="$ctrl.cancel()" ng-disabled="$ctrl.isSaving"></pbi-button></fieldset></footer></div></ng-form>'),e.put("components/groupEditor/edit/editGroupBlade.html",'<ng-form name="editGroupForm"><div class="groupsEditorBlade paneLayout" ng-switch="::$ctrl.model.isFolder"><header><div ng-switch-when="false"><h1 localize="GroupEditor_Title_EditGroup"></h1></div><div ng-switch-when="true"><i class="glyphicon pbi-glyph-settings glyph-medium folderSettingsIcon"></i><h2 class="folderSettingsHeaderText" localize="ActivityPane_SettingsAction"></h2><h4 bind-text-and-tooltip="$ctrl.model.groupName" class="folderSettingsSubTitle"></h4><section class="settingsOptionsList" role="tablist"> <button class="settingsOptionTab label-med inviteTab" ng-class="{selected: $ctrl.activeTab===$ctrl.aboutSwitchTab}" ng-click="$ctrl.switchTabs($ctrl.aboutSwitchTab)" aria-controls="edit-group-blade-content-tab" role="tab" localize="About"></button> <button class="settingsOptionTab label-med sharedWithTab" ng-class="{selected: $ctrl.activeTab===$ctrl.premiumSwitchTab}" ng-click="$ctrl.switchTabs($ctrl.premiumSwitchTab)" aria-controls="edit-group-blade-content-tab" role="tab" localize="PremiumLabel"></button> <button class="settingsOptionTab label-med" ng-if="$ctrl.showBYOResourceSettings" ng-class="{selected: $ctrl.activeTab===$ctrl.byoResourcesSwitchTab}" ng-click="$ctrl.switchTabs($ctrl.byoResourcesSwitchTab)" aria-controls="edit-group-blade-content-tab" role="tab" localize="Azure_Connections"></button></section></div></header><section class="contentContainer" ng-switch-when="false"><section class="displayBlock"><h4 class="title" localize="Name"></h4> <input name="groupName" required ng-model="$ctrl.model.groupName" ng-disabled="$ctrl.editNonAdmin" type="text" spellcheck="false" autocomplete="off" maxlength="64" autofocus></section><section class="displayBlock"><h4 class="title" localize="GroupEditor_PrivacyLabel_Text"></h4> <input id="privacySetting" required type="text" disabled="disabled" ng-value="$ctrl.getPrivacyOption()"/> <select name="accessOption" ng-if="::$ctrl.readOnlyGroupEnabled" ng-model="$ctrl.model.accessControlOption" ng-options="accessControlOption.key as accessControlOption.value for accessControlOption in $ctrl.model.accessControlOptions" ng-disabled="!$ctrl.model.isAdmin || $ctrl.isSaving"></select></section><section class="informationProtectionWarning" ng-if="$ctrl.showInformationProtectionWarning"><pbi-lazy-load-modern [module-path]="::$ctrl.MessageBannerModulePath" [component-id]="\'MessageBannerComponentId\'" [input-args]="{viewModel: $ctrl.informationProtectionBannerModel}"></pbi-lazy-load-modern></section><section class="displayBlock"><h4 class="title" localize="GroupEditor_AddGroupMembers_ViewMode_Label_Text"></h4><emails-list id="emailList" view-model="$ctrl.model.emailsList" include-guests="true"></emails-list><pbi-button label="GroupEditor_AddButton_Text" primary="true" ng-click="$ctrl.add()" ng-disabled="!$ctrl.model.emailsList.inputUserList || $ctrl.isSaving"></pbi-button><div class="spinnerWithText" ng-if="$ctrl.isAddingMembers"><spinner></spinner><div localize="GroupEditor_WaitForAddingMembers"></div></div><div class="error"><label title="{{$ctrl.model.invalidEmailAddressesErrorMessage }}" ng-if="$ctrl.model.invalidEmailAddressesErrorMessage  !== \'\'" ng-bind="$ctrl.model.invalidEmailAddressesErrorMessage "></label><label title="{{$ctrl.model.notExitingEmailAddressesErrorMessage}}" ng-if="$ctrl.model.notExitingEmailAddressesErrorMessage !== \'\'" ng-bind="$ctrl.model.notExitingEmailAddressesErrorMessage"></label></div><ul class="userListContainer"><li ng-repeat="member in $ctrl.model.displayMemberList | orderBy:\'+userPrincipalName\' track by $index"><span class="username trimmedTextWithEllipsis" ng-bind="member.userPrincipalName" ng-attr-title="{{::member.userPrincipalName}}"></span> <select ng-if="::$ctrl.model.isAdmin" ng-model="member.role" class="usertype" ng-options="groupMemberRole.key as groupMemberRole.value for groupMemberRole in $ctrl.model.groupMemberRoleOptions" ng-disabled="$ctrl.isMemberTheOnlyAdmin(member)"></select><span class="usertype" ng-if="!$ctrl.model.isAdmin && member.role === 1" localize="GroupEditor_RoleOptions_Admin"></span><span class="usertype" ng-if="!$ctrl.model.isAdmin && member.role === 0" localize="GroupEditor_RoleOptions_Member"></span><pbi-button ng-if="::$ctrl.model.isAdmin" kind="icon" icon-name="delete" icon-size="mini" localize-tooltip="Delete" arialabel="{{::$ctrl.deleteButtonAriaLabel}}" no-label ng-click="$ctrl.removeMember(member);editGroupForm.$setDirty();"></pbi-button></li></ul></section> <button ng-click="$ctrl.toggleAdvancedMode()" aria-expanded="{{$ctrl.isAdvancedModeExpanded}}" class="displayBlock advanced" ng-if="::$ctrl.capacityEnabled"><h4 class="title" localize="Advanced"></h4><i class="glyphicon glyph-mini expand" ng-class="$ctrl.isAdvancedModeExpanded ? \'pbi-glyph-chevronupmedium\' : \'pbi-glyph-chevrondownmedium\'"></i></button><section class="displayBlock capacity" ng-if="$ctrl.isAdvancedModeExpanded"><div class="licenseHeadingContainer"><label class="input-field-label altTextStyling" localize="Workspace_LicenseMode"></label><i class="glyphicon pbi-glyph-info" tabindex="0" tooltip tooltip-config="$ctrl.getLicenseModeToolTipConfig()" aria-label="{{::$ctrl.getLicenseModeToolTipConfig().tooltipDescription}}"></i></div><pbi-radio-group-legacy ng-model="$ctrl.model.licenseMode" ng-change="$ctrl.updateCapacityList()" no-label><pbi-radio class="licenseModeOption" label="Workspace_LicenseMode_Pro" ng-value="0"></pbi-radio><pbi-radio class="licenseModeOption" label="Workspace_LicenseMode_PPU" ng-value="1" ng-disabled="true"></pbi-radio><pbi-radio class="licenseModeOption" label="Workspace_LicenseMode_Premium" ng-value="2" ng-disabled="!$ctrl.licenseModeAvailability[2]"></pbi-radio><div class="radioAndInfoContainer"><pbi-radio class="licenseModeOption" label="Workspace_LicenseMode_Embedded" ng-value="3" ng-disabled="!$ctrl.licenseModeAvailability[3]"></pbi-radio><i class="glyphicon pbi-glyph-info embeddedModeInfo" tooltip tooltip-config="$ctrl.getEmbeddedToolTipConfig()"></i></div></pbi-radio-group-legacy><div class="capInfo" ng-if="!$ctrl.canEditCapacity() && $ctrl.model.licenseMode !== 1 && $ctrl.model.isCapacityEnabled"><pbi-icon name="info" size="small"></pbi-icon> <label>{{$ctrl.getInCapacityMessage()}}</label><a localize="Capacity_LearnMore_PremiumCapacities" href="https://go.microsoft.com/fwlink/?linkid=845343" target="_blank"></a></div><div class="capEdit" ng-if="$ctrl.canEditCapacity($ctrl.capacitiesList)"><label class="subtitle capacitySelection" for="groupEditorCapacitySelector" localize="Workspace_LicenseMode_Select"></label> <select ng-model="$ctrl.model.capacity" id="groupEditorCapacitySelector" ng-change="$ctrl.capacityChange()" ng-options="capacity as $ctrl.getCapacityOptionDisplayText(capacity) for capacity in $ctrl.capacitiesList"></select><a localize="Capacity_LearnMore_PremiumCapacities" href="https://go.microsoft.com/fwlink/?linkid=845343" target="_blank"></a></div><section class="displayBlock" ng-if="$ctrl.model.isCapacityEnabled && $ctrl.model.workspaceConnection"><h4 class="title" localize="WorkspaceConnection"></h4> <input name="groupServerName" class="groupServerName" ng-model="$ctrl.model.workspaceConnection" ng-disabled="true" type="text"/><pbi-button ng-click="$ctrl.copyServerUrl()" primary="primary" label="Copy"></pbi-button><span class="linkCopied" ng-if="$ctrl.showCopySuccess" localize="CopyToClipboard_Success"></span></section></section><section class="displayBlock" ng-if="$ctrl.isAdvancedModeExpanded" feature-switch="workspacesV2OptInUpgradeButton"><h4 localize="WorkspacesUpgrade_ButtonSettingsTitle"></h4><span class="detailText workspaceMigration" localize="WorkspacesUpgrade_ButtonSettingsText"></span><workspace-migration-button class="detailText" [group-object-id]="$ctrl.folder.uniqueId" action="Upgrade"></workspace-migration-button> <span class="detailText detailTextSeparator">|</span><a class="detailText" localize="LearnMore" href="https://aka.ms/WorkspacesUpgradeInfoBar" target="_blank"></a></section></section><section class="contentContainer" id="edit-group-blade-content-tab" ng-switch-when="true"><span class="bladeInnerContent imageLabel" ng-if="$ctrl.activeTab==0" localize="WorkspaceImage"></span><image-picker ng-if="$ctrl.activeTab==$ctrl.aboutSwitchTab" [(icon-url)]="{{ ($ctrl.isAdminFolder) ? \'$ctrl.adminIconPath\' : \'$ctrl.model.iconUrl\' }}" [(icon-updated)]="$ctrl.model.iconUpdated" [disabled]="::!$ctrl.model.isAdmin"></image-picker><section class="bladeInnerContent" ng-if="$ctrl.activeTab==0"><h4 localize="WorkspaceName"></h4> <input name="groupName" required localize-attr="{placeholder: \'NameThisWorkspace\'}" ng-model="$ctrl.model.groupName" ng-disabled="::!$ctrl.model.isAdmin || $ctrl.isAdminFolder" type="text" spellcheck="false" autocomplete="off" maxlength="256" autofocus class="{errorFolderNameInput: !$ctrl.latestFolderNameIsValid}" ng-keyup="$ctrl.folderNameChanged()"><div ng-if="$ctrl.isValidatingFolderName" class="spinnerWithText"><spinner [size]="\'xsmall\'"></spinner><span localize="GroupEditor_WaitForGroupIdValidation"></span></div><div ng-if="!$ctrl.isValidatingFolderName && !$ctrl.folderNameResetToOriginal" ng-switch="$ctrl.latestFolderNameIsValid"><label ng-switch-when="true" for="validationIcon" localize="GroupEditor_CreateGroup_GroupId_Available_Text"></label><div class="errorMessageContainer" ng-switch-when="false"><i class="glyphicon glyph-small pbi-glyph-error"></i><span class="errorMessage" localize="GroupEditor_CreateGroup_GroupId_NotAvailable_Text"></span></div></div></section><section class="bladeInnerContent" ng-if="$ctrl.activeTab==$ctrl.aboutSwitchTab"><h4 localize="Description"></h4><textarea localize-attr="{placeholder: \'DescribeThisWorkspace\'}" maxlength="4000" name="description" class="folderDescriptionBox" ng-model="$ctrl.model.description" ng-disabled="::!$ctrl.model.isAdmin || $ctrl.isAdminFolder"></textarea><a href="https://go.microsoft.com/fwlink/?linkid=2053958" class="learnMoreLink" target="_blank" localize="LearnMore_WorkspaceSettings"></a></section> <button class="displayBlock advanced" feature-switch="workspacesV2GAFeatures" ng-if="$ctrl.activeTab==$ctrl.aboutSwitchTab && !$ctrl.isAdminFolder" ng-click="$ctrl.toggleAdvancedMode()" aria-expanded="{{$ctrl.isAdvancedModeExpanded}}" aria-label="{{::$ctrl.advancedButtonArialabel}}"><h4 class="title" localize="Advanced"></h4><expando expanded="$ctrl.isAdvancedModeExpanded"></expando></button><section class="bladeInnerContent" ng-if="$ctrl.activeTab==$ctrl.aboutSwitchTab && !$ctrl.isAdminFolder"><section class="displayBlock email-notifications" feature-switch="workspacesV2GAFeatures" ng-if="$ctrl.isAdvancedModeExpanded"><span class="input-field-label altTextStyling" localize="ContactList"></span><pbi-radio-group-legacy ng-model="$ctrl.model.notificationTarget" ng-disabled="::!$ctrl.model.isAdmin" ng-change="editGroupForm.$setDirty()" no-label><pbi-radio id="radioEditorAdmins" label="CapacityWorkspaces_WorkspaceAdmins" ng-value="0"></pbi-radio><pbi-radio id="radioEditorSpecificUsersAndGroups" label="GroupEditor_ContactList_SendToSpecificUsers" ng-value="1"></pbi-radio></pbi-radio-group-legacy><section class="workspaceContactList" ng-class="{\'disabled\': !$ctrl.model.isAdmin || !$ctrl.model.notificationTarget}"><fieldset ng-disabled="!$ctrl.model.isAdmin || !$ctrl.model.notificationTarget"><emails-list view-model="$ctrl.model.contactList" allow-email-enabled-security-groups="true" allow-object-ids="true" allow-distribution-lists="true" allow-unified-groups="true" check-valid-org-user="true" is-finding-users="$ctrl.isFindingUsers" include-guests="true" placeholder="\'EmailsList_UsersAndGroupsPlaceholder\'"></emails-list></fieldset></section><span class="sharePointHeader input-field-label altTextStyling" localize="WorkspaceSharePoint"></span><section class="workspaceContactList" ng-class="{\'disabled\': !$ctrl.model.isAdmin }"><fieldset ng-disabled="!$ctrl.model.isAdmin"><emails-list view-model="$ctrl.model.sharePointStorageList" allow-security-groups="false" allow-object-ids="true" allow-distribution-lists="false" allow-unified-groups="true" on-tag-added="$ctrl.validateSharePointInputTags()" on-tag-removed="$ctrl.resetSharePointValidation()" block-users="true" check-valid-org-user="true" is-finding-users="$ctrl.isFindingGroups" placeholder="\'Optional_Parenthesis\'" max-tags="1"></emails-list></fieldset></section></section><section class="displayBlock" ng-if="$ctrl.isAdvancedModeExpanded && $ctrl.model.isUpgradedFromV1Workspace" feature-switch="workspacesV2Downgrade"><span class="input-field-label" localize="WorkspacesDowngrade_ButtonSettingsTitle"></span><span class="detailText" localize="WorkspacesDowngrade_ButtonInfoText"></span><workspace-migration-button class="detailText workspaceMigration" [group-object-id]="$ctrl.folder.uniqueId" action="Downgrade"></workspace-migration-button></section><section class="serviceAppInfo" ng-if="$ctrl.isAdvancedModeExpanded && $ctrl.showServiceAppCheckbox"><pbi-checkbox label="GroupEditor_ServiceAppCheckbox" aria-label="{{::$ctrl.serviceAppCheckboxAriaLabel}}" class="serviceAppCheckBox" ng-model="$ctrl.model.isServiceApp" ng-disabled="::(!$ctrl.model.isServiceAppEnabled || !$ctrl.model.isAdmin)" ng-change="$ctrl.toggleServiceApp()"></pbi-checkbox><p><span localize="GroupEditor_ServiceAppCreateInfo"></span><a href="http://aka.ms/powerbiapps" target="_blank" rel="noopener noreferrer" localize="LearnMore"></a></p></section><section class="installedServiceAppInfo" ng-if="$ctrl.isAdvancedModeExpanded && $ctrl.isInstalledServiceAppInstance"><p><pbi-icon name="info" size="mini"></pbi-icon><span localize="GroupEditor_ServiceApp_AboutApp" localize-fragments><span fragment-index="0" bind-text-and-tooltip="$ctrl.appName"></span></span><span class="version" localize="ServiceApps_PackageVersion_WithBrackets" localize-fragments><span fragment-index="0" bind-text-and-tooltip="$ctrl.appVersion"></span></span></p></section><section class="allowContributorUpdateApp" ng-if="$ctrl.isAdvancedModeExpanded"><span class="input-field-label altTextStyling" localize="SecuritySettings"></span><pbi-checkbox label="AllowContributorsUpdateAppForWorkspace" aria-label="{{::$ctrl.allowContributorUpdateAppAriaLabel}}" ng-model="$ctrl.model.allowContributorUpdateApp" ng-disabled="::!$ctrl.model.isAdmin"></pbi-checkbox></section></section><section class="bladeInnerContent" ng-if="$ctrl.activeTab==$ctrl.premiumSwitchTab"><section class="bladeInnerContent capacity"><div class="licenseHeadingContainer"><label class="input-field-label altTextStyling" localize="Workspace_LicenseMode"></label><i class="glyphicon pbi-glyph-info" tabindex="0" tooltip tooltip-config="$ctrl.getLicenseModeToolTipConfig()" aria-label="{{::$ctrl.getLicenseModeToolTipConfig().tooltipDescription}}"></i></div><pbi-radio-group-legacy ng-model="$ctrl.model.licenseMode" ng-change="$ctrl.updateCapacityList()" no-label><pbi-radio class="licenseModeOption" label="Workspace_LicenseMode_Pro" ng-value="0" ng-disabled="!$ctrl.licenseModeAvailability[0]"></pbi-radio><pbi-radio class="licenseModeOption" label="Workspace_LicenseMode_PPU" ng-value="1" ng-disabled="!$ctrl.licenseModeAvailability[1]"></pbi-radio><pbi-radio class="licenseModeOption" label="Workspace_LicenseMode_Premium" ng-value="2" ng-disabled="!$ctrl.licenseModeAvailability[2]"></pbi-radio><div class="radioAndInfoContainer"><pbi-radio class="licenseModeOption" label="Workspace_LicenseMode_Embedded" ng-value="3" ng-disabled="!$ctrl.licenseModeAvailability[3]"></pbi-radio><i class="glyphicon pbi-glyph-info embeddedModeInfo" tooltip tooltip-config="$ctrl.getEmbeddedToolTipConfig()"></i></div></pbi-radio-group-legacy><div class="capInfo" ng-if="!$ctrl.canEditCapacity() && $ctrl.model.licenseMode !== 1 && $ctrl.model.isCapacityEnabled"><pbi-icon name="info" size="small"></pbi-icon> <label>{{$ctrl.getInCapacityMessage()}}</label><a localize="Capacity_LearnMore_PremiumCapacities" href="https://go.microsoft.com/fwlink/?linkid=845343" target="_blank"></a></div><div class="capEdit" ng-if="$ctrl.canEditCapacity($ctrl.capacitiesList)"><label class="subtitle capacitySelection" for="groupEditorCapacitySelector" localize="Workspace_LicenseMode_Select"></label> <select ng-model="$ctrl.model.capacity" id="groupEditorCapacitySelector" ng-change="$ctrl.capacityChange()" ng-disabled="::!$ctrl.model.isAdmin" ng-options="capacity as $ctrl.getCapacityOptionDisplayText(capacity) for capacity in $ctrl.capacitiesList"></select><a localize="Capacity_LearnMore_PremiumCapacities" href="https://go.microsoft.com/fwlink/?linkid=845343" target="_blank"></a></div><div class="capEdit" ng-if="$ctrl.model.isCapacityEnabled && $ctrl.allowLargeFiles"><label class="subtitle capacitySelection" for="groupEditorStorageFormatSelector" localize="GroupEditor_StorageFormat"></label> <select ng-model="$ctrl.model.defaultDatasetStorageFormat" ng-disabled="!$ctrl.model.isAdmin || !$ctrl.isPremiumFilesSupported" id="groupEditorStorageFormatSelector"><option ng-value="{{ 1 }}" localize="GroupEditor_StorageFormat_Small"></option><option ng-value="{{ 2 }}" localize="GroupEditor_StorageFormat_Large"></option></select><section class="warningMessageContainer storageFormatWarning" ng-if="!$ctrl.isPremiumFilesSupported"><p localize="GroupEditor_StorageFormat_Warning"></p></section><a localize="GroupEditor_StorageFormat_LearnMore" href="https://go.microsoft.com/fwlink/?linkid=2147083" target="_blank"></a></div><section class="displayBlock" ng-if="$ctrl.model.isCapacityEnabled && $ctrl.model.workspaceConnection"><h4 class="title" localize="WorkspaceConnection"></h4> <input name="groupServerName" class="groupServerName" ng-model="$ctrl.model.workspaceConnection" ng-disabled="true" type="text"/><pbi-button ng-click="$ctrl.copyServerUrl()" primary="primary" label="Copy"></pbi-button><span class="linkCopied" ng-if="$ctrl.showCopySuccess" localize="CopyToClipboard_Success"></span></section></section></section><section class="bladeInnerContent" ng-if="$ctrl.activeTab==$ctrl.dataflowsStorageSwitchTab && $ctrl.showDataflowsStorageAccount"><section class="bladeInnerContent dataflowsStorageAccount"><section class="warningMessageContainer" ng-if="$ctrl.isCdsaModelsExists"><p localize="DataflowsStorageAccount_UpdateWarning"></p></section></section></section><section class="bladeInnerContent" ng-if="$ctrl.activeTab==$ctrl.byoResourcesSwitchTab && $ctrl.showBYOResourceSettings"><pbi-lazy-load-modern [module-path]="::$ctrl.byoResourcesModule" [component-id]="::$ctrl.byoResourcesWorkspaceContainerComponent" [input-args]="{folder: $ctrl.folder, isBYOResourceExpanded: $ctrl.isBYOResourcesActiveTab}"></pbi-lazy-load-modern></section></section><footer><fieldset class="buttons"><pbi-button id="deleteGroupButton" ng-if="$ctrl.model.isAdmin && !$ctrl.isAdminFolder" label="GroupEditor_DeleteGroup_Text" ng-click="$ctrl.delete()" ng-disabled="$ctrl.isSaving || !$ctrl.canDelete"></pbi-button><pbi-button label="GroupEditor_SaveButton_Text" ng-if="::(!$ctrl.model.isFolder || $ctrl.model.isAdmin)" ng-click="$ctrl.save()" ng-disabled="!editGroupForm.$dirty && !$ctrl.model.iconUpdated || editGroupForm.$invalid || !$ctrl.canSave" primary="true"></pbi-button><pbi-button label="Cancel_ButtonText" ng-click="$ctrl.cancel()" ng-disabled="$ctrl.isSaving"></pbi-button></fieldset></footer></div></ng-form>'),e.put("components/groupEditor/myWorkspace/editMyWorkspaceBlade.html",'<ng-form name="editGroupForm"><div class="groupsEditorBlade paneLayout"><header><h1 class="primaryHeading" localize="GroupEditor_Title_EditGroup"></h1></header><section class="contentContainer"><section class="displayBlock"><h4 class="title" localize="Name"></h4><span class="textBody" ng-bind="::$ctrl.model.groupName"></span></section><section class="displayBlock capacity"><div class="licenseHeadingContainer"><label class="input-field-label altTextStyling" localize="Workspace_LicenseMode"></label><i class="glyphicon pbi-glyph-info" tooltip tooltip-config="$ctrl.getLicenseModeToolTipConfig"></i></div><pbi-radio-group-legacy ng-model="$ctrl.model.licenseMode" ng-change="$ctrl.updateCapacityList()" no-label><div class="radioAndInfoContainer" ng-if="$ctrl.isMyFolder"><pbi-radio class="licenseModeOption" label="Workspace_LicenseMode_Pro" ng-disabled="$ctrl.restrictMyFolderCapacityEnabled" ng-value="0"></pbi-radio><i class="glyphicon pbi-glyph-info embeddedModeInfo" tooltip tooltip-config="$ctrl.getMyFolderProToolTipConfig"></i></div><pbi-radio class="licenseModeOption" label="Workspace_LicenseMode_Pro" ng-if="!$ctrl.isMyFolder" ng-value="0"></pbi-radio><pbi-radio class="licenseModeOption" label="Workspace_LicenseMode_PPU" ng-value="1" ng-if="$ctrl.myFolderPPU && $ctrl.isMyFolder" ng-disabled="!$ctrl.licenseModeAvailability[1]"></pbi-radio><pbi-radio class="licenseModeOption" label="Workspace_LicenseMode_Premium" ng-value="2" ng-disabled="!$ctrl.licenseModeAvailability[2]"></pbi-radio><div class="radioAndInfoContainer"><pbi-radio class="licenseModeOption" label="Workspace_LicenseMode_Embedded" ng-value="3" ng-disabled="!$ctrl.licenseModeAvailability[3]"></pbi-radio><i class="glyphicon pbi-glyph-info embeddedModeInfo" tooltip tooltip-config="$ctrl.getEmbeddedToolTipConfig"></i></div></pbi-radio-group-legacy><div class="capEdit" ng-if="$ctrl.canEditCapacity($ctrl.capacitiesList)"><label class="subtitle capacitySelection" for="groupEditorCapacitySelector" localize="Workspace_LicenseMode_Select"></label> <select ng-model="$ctrl.model.capacity" id="groupEditorCapacitySelector" ng-options="capacity as $ctrl.getCapacityOptionDisplayText(capacity) for capacity in $ctrl.capacitiesList"></select><a localize="Capacity_LearnMore_PremiumCapacities" href="https://go.microsoft.com/fwlink/?linkid=845343" target="_blank"></a></div><div class="capInfo" ng-if="!$ctrl.canEditCapacity() && $ctrl.model.isCapacityEnabled && $ctrl.model.licenseMode !== 1"><pbi-icon name="info" size="small"></pbi-icon><label ng-bind="$ctrl.getInCapacityMessage"></label><a localize="Capacity_LearnMore_PremiumCapacities" href="https://go.microsoft.com/fwlink/?linkid=845343" target="_blank"></a></div><div class="spinnerWithText" ng-if="$ctrl.isLoadingCapacities"><spinner></spinner></div></section></section><footer><fieldset class="buttons"><pbi-button label="GroupEditor_SaveButton_Text" ng-click="$ctrl.save()" ng-disabled="!editGroupForm.$dirty || editGroupForm.$invalid || !$ctrl.canSave || $ctrl.isSaving" primary="true"></pbi-button><pbi-button label="Cancel_ButtonText" ng-click="$ctrl.cancel()" ng-disabled="$ctrl.isSaving || !$ctrl.canSave"></pbi-button></fieldset></footer></div></ng-form>'),e.put("components/groupEditor/view/viewGroupBlade.html",'<div class="groupsEditorBlade paneLayout"><header><h1 class="primaryHeading" localize="GroupEditor_Title_ViewGroup"></h1></header><section class="contentContainer viewContainer"><section class="displayBlock"><h4 class="title" localize="Name"></h4><span class="textBody" ng-bind="::$ctrl.model.groupName"></span></section><section class="displayBlock" ng-if="$ctrl.model.isCapacityEnabled && $ctrl.model.workspaceConnection"><h4 class="title" localize="WorkspaceConnection"></h4> <input name="groupServerName" class="groupServerName" ng-model="$ctrl.model.workspaceConnection" ng-disabled="true" type="text"/><pbi-button ng-click="$ctrl.copyServerUrl()" primary="primary" label="Copy"></pbi-button><span class="linkCopied" ng-if="$ctrl.showCopySuccess" localize="CopyToClipboard_Success"></span></section><section class="displayBlock"><h4 class="title" localize="GroupEditor_PrivacyLabel_Text"></h4><div class="textBody" ng-bind="::$ctrl.getAccessControlOption()"></div><div class="textBody" ng-bind="$ctrl.getPrivacyOption()"></div></section><section class="displayBlock"><h4 class="title" localize="GroupEditor_AddGroupMembers_ViewMode_Label_Text"></h4><ul class="userListContainer" ng-if="!$ctrl.isLoadingGroupMembers"><li ng-repeat="member in ::$ctrl.model.displayMemberList | orderBy:\'+userPrincipalName\' track by member.userPrincipalName"><span class="username trimmedTextWithEllipsis" ng-bind="::member.userPrincipalName" ng-attr-title="{{::member.userPrincipalName}}"></span><span class="glyphicon pbi-glyph-mail glyph-small invite" ng-if="member.role === 2 && !member.invitationSent" localize-tooltip="GroupEditor_PendingInvitation"></span><span class="glyphicon pbi-glyph-mail glyph-small invite" ng-if="member.role === 2 && member.invitationSent" localize-tooltip="GroupEditor_InvitationSent"></span><span class="usertype" ng-if="::$ctrl.readOnlyGroupEnabled && member.role === 1" localize="GroupEditor_RoleOptions_Admin"></span><span class="usertype" ng-if="::$ctrl.readOnlyGroupEnabled && member.role === 0" localize="GroupEditor_RoleOptions_Member"></span></li></ul><div ng-if="$ctrl.isLoadingGroupMembers"><spinner></spinner><span localize="GroupEditor_WaitLoadMembers"></span></div></section></section><footer><fieldset class="buttons"><pbi-button label="PBI_Button_Label_OK" primary="true" ng-click="$ctrl.cancel()"></pbi-button></fieldset></footer></div>'),e.put("components/settingsBlade/settingsBlade.html",'<ng-form name="settingsForm"><div class="settingsBlade paneLayout"><header><h3 class="primaryHeading trimmedTextWithEllipsis" ng-bind="::$ctrl.bladeTitle" title="{{::$ctrl.bladeTitle}}"></h3></header><section class="contentContainer"><aside class="requiredField" localize="Required"></aside><div class="ownerInfo modelNameText info trimmedTextWithEllipsis" ng-if="$ctrl.isSettingsPane"><label for="ownerInput" localize="Owner_Lowercase"></label><a class="email" ng-if="$ctrl.ownerMail" href="mailto:{{$ctrl.ownerMail}}"><span localize="Email"></span></a> <input id="ownerInput" type="text" value="{{$ctrl.ownerInfo}}" spellcheck="false" autofocus="autofocus" maxlength="250" readonly/></div><div ng-if="$ctrl.settingsType !== 1" class="modelNameText info"><label ng-bind="::$ctrl.artifactLabel" for="inputArtifactDisplayName"></label></div><div ng-if="$ctrl.settingsType !== 1" class="info"> <input class="nameInput" id="inputArtifactDisplayName" type="text" ng-model="$ctrl.artifact.displayName" ng-change="$ctrl.onDisplayNameChanged($ctrl.artifact.displayName)" ng-disabled="$ctrl.isScorecardReport" spellcheck="false" autofocus="autofocus" maxlength="250" ng-readonly="::$ctrl.readOnly"/><div ng-if="$ctrl.isDataflow && !$ctrl.isDisabled()" class="errorBanner duplicateNameError"><span localize="Dataflow_Name_Saved_Refresh_To_Update"></span></div><div ng-if="::$ctrl.shouldShowDescription()" class="modelNameText"><label for="inputArtifactDescription" localize="Description"></label> <input id="inputArtifactDescription" type="text" ng-model="$ctrl.description" spellcheck="false" maxlength="120" ng-readonly="::$ctrl.readOnly"/></div><div ng-if="$ctrl.modelRenameError" class="errorBanner duplicateNameError" localize="SettingsBlade_DuplicateModelName"></div><div ng-if="::$ctrl.shouldShowContacts" feature-switch="contactsSettingsList" class="modelNameText info"><label localize="Contact"></label><emails-list view-model="$ctrl.contactsModel.emailsList" on-tag-added="$ctrl.validateInputTags($ctrl.contactsModel)" on-tag-removed="$ctrl.resetValidation($ctrl.contactsModel)" allow-unified-groups="true" allow-email-enabled-security-groups="true" allow-distribution-lists="true" include-guests="true" allow-object-ids="true" check-valid-org-user="true" is-finding-users="$ctrl.contactsModel.isFindingUsers"></emails-list><div ng-if="$ctrl.contactsModel.emailValidationWarning" class="alertBlock"><i class="glyphicon glyph-small pbi-glyph-warning"></i><span ng-bind="$ctrl.contactsModel.emailValidationWarning"></span></div><div ng-if="$ctrl.contactsModel.emailValidationError" class="errorBlock"><i class="glyphicon glyph-small pbi-glyph-error"></i><span class="message" ng-bind="$ctrl.contactsModel.emailValidationError"></span></div><div ng-if="$ctrl.hasContactValidationError" class="errorBlock"><i class="glyphicon glyph-small pbi-glyph-error"></i><span class="message" ng-bind="$ctrl.contactsErrorMessage"></span></div></div><div ng-if="::$ctrl.shouldShowSnapshot()" class="modelNameText"><span localize="ManageEmbed_EmbedType_Snapshot"></span><image-picker [(icon-url)]="$ctrl.iconUrl" [(icon-updated)]="$ctrl.iconUpdatedBool" [config]="$ctrl.iconConfiguration" [max-image-size]="1500000" [max-image-size-text]="\'File_Size_MB_1\'" [(default-image)]="$ctrl.defaultSnapshot"></image-picker></div><hr/><pbi-lazy-load-modern ng-if="::$ctrl.shouldShowReportEndorsementSection()" [module-path]="::$ctrl.setArtifactEndorsementModulePath" [component-id]="::$ctrl.setArtifactEndorsementComponentId" [input-args]="::$ctrl.setArtifactEndorsementInputArgs" [output-args]="::$ctrl.setArtifactEndorsementOutputArgs"></pbi-lazy-load-modern><section ng-if="::$ctrl.shouldShowFeaturedCheckbox()"><pbi-checkbox aria-label="{{$ctrl.services.localizationService.get(\'FeatureOnHome\')}}" label="FeatureOnHome" ng-model="$ctrl.isPromoted" ng-disabled="::!$ctrl.shouldEnableFeaturedSetting()"></pbi-checkbox><span class="settingDescription" localize="SettingsBlade_FeaturedContent_Report"></span><div class="warningBanner" ng-if="::!$ctrl.shouldEnableFeaturedSetting()"><i class="glyphicon glyph-small pbi-glyph-info"></i><div class="bannerTextContainer"><label localize="{{::$ctrl.getFeaturedContentWarning()}}"></label></div></div></section><h4 class="persistentFilter" ng-if="::$ctrl.isStickyFilterEnabled()" localize="SettingsBlade_PersistentFilters"></h4><pbi-toggle ng-if="::$ctrl.isStickyFilterEnabled()" class="persistentMsg" label="PersistentUserState_Message" ng-model="$ctrl.isPersistentUserStateDisabled"></pbi-toggle><h4 ng-if="::$ctrl.isPagesPaneEnabled() && $ctrl.isPagesPanePositionSettingEnabled()" localize="PagesPane"></h4><pbi-toggle ng-if="::$ctrl.isPagesPaneEnabled() && $ctrl.isPagesPanePositionSettingEnabled()" label="PagesPaneDescription" ng-model="$ctrl.showPagesOnBottom"></pbi-toggle><h4 class="visualOptions" ng-if="::$ctrl.visualOptionsEnabled()" localize="SettingsBlade_VisualOptions"></h4><pbi-toggle ng-if="::$ctrl.hideVisualContainerHeaderEnable()" class="hideVisualContainerHeader" label="Hide_VisualHeader_Message" ng-model="$ctrl.hideVisualContainerHeader"></pbi-toggle><pbi-toggle ng-if="::$ctrl.useStylableVisualContainerHeaderEnabled()" class="useStylableVisualContainerHeader" label="Use_Modern_Visual_Header_Message" ng-model="$ctrl.useStylableVisualContainerHeader"></pbi-toggle><pbi-toggle ng-if="::$ctrl.isDefaultFilterActionEnabled()" class="defaultFilterActionIsDataFilter" label="Default_Filter_Action_Message" ng-model="$ctrl.defaultFilterActionIsDataFilter"></pbi-toggle><section class="exportOptions" ng-if="::$ctrl.isExportDataModeEnabled()"><h4 class="exportOptions" localize="TenantSetting_ExportData_Title"></h4><p id="exportOptionsLabel" class="description" localize="SettingsBlade_ExportDataOptionsLabel"></p> <select ng-options="option.id as option.name for option in ::$ctrl.exportModeOptions" aria-labelledby="exportOptionsLabel" ng-model="$ctrl.exportDataMode" ng-change="$ctrl.exportDataModeChanged()"></select></section><pbi-lazy-load-modern ng-if="::$ctrl.shouldShowInformationProtectionSection()" [module-path]="::$ctrl.settingsBladeModulePath" [component-id]="::$ctrl.setArtifactLabelComponentId" [input-args]="::$ctrl.setArtifactLabelInputArgs" [output-args]="::$ctrl.setArtifactLabelOutputArgs"></pbi-lazy-load-modern><section ng-if="::$ctrl.isFilterExperienceSettingsVisible()"><h4 localize="SettingsBlade_NewFilterExperience"></h4><pbi-toggle label="SettingsBlade_AllowChangeFilterTypesMessage" ng-model="$ctrl.allowChangeFilterType"></pbi-toggle><pbi-toggle label="FilterPane_EnableSearch" ng-model="$ctrl.enableFilterPaneSearch"></pbi-toggle></section><section ng-if="::$ctrl.isCrossReportDrillthroughVisible()"><h4 localize="CrossReportDrillthrough"></h4><pbi-toggle label="CrossReportDrillthroughEnabledMessage" ng-model="$ctrl.useCrossReportDrillthrough"></pbi-toggle></section><h4 ng-if="::$ctrl.isReportAnnotationsFeatureEnabled()" localize="Comments"></h4><pbi-toggle ng-if="::$ctrl.isReportAnnotationsFeatureEnabled()" label="ReportAnnotations_Message" ng-model="$ctrl.isReportAnnotationsEnabled"></pbi-toggle><section ng-if="::$ctrl.isRebindFeatureEnabled()"><h4 localize="SettingsBlade_ChangeDatasource_Title"></h4><p class="description" localize="SettingsBlade_ChangeDatasource_Detail"></p><p class="description trimmedTextWithEllipsis" title="{{::$ctrl.getReportDatasetDisplayName()}}">{{::$ctrl.getReportDatasetDisplayName()}}</p><pbi-button label="SettingsBlade_PickDataset" primary="true" class="wideButton" ng-click="$ctrl.rebind()"></pbi-button></section><section ng-if="::$ctrl.isInlineExploreVisible()"><h4 localize="SettingsBlade_InlineExplore_Header"></h4><pbi-toggle label="SettingsBlade_InlineExplore_ToggleLabel" ng-model="$ctrl.allowInlineExploration"></pbi-toggle></section><section ng-if="::$ctrl.isEnhancedTooltipVisible()"><h4 localize="SettingsBlade_EnhancedTooltips"></h4><pbi-toggle label="SettingsBlade_EnhancedTooltips_ToggleLabel" ng-model="$ctrl.useEnhancedTooltips"></pbi-toggle></section><section ng-if="::$ctrl.isAutomatedInsightsVisible()"><h4 localize="Generic_Insights_Preview"></h4><pbi-toggle label="SettingsBlade_AutomatedInsights_Message" ng-model="$ctrl.allowAutomatedInsightsNotification"></pbi-toggle></section><section ng-if="::$ctrl.isDefaultAggregateDisplayNameVisible()"><h4 localize="SettingsBlade_DefaultAggregateDisplayName"></h4><pbi-toggle label="SettingsBlade_DefaultAggregateDisplayName_ToggleLabel" ng-model="$ctrl.useDefaultAggregateDisplayName"></pbi-toggle></section></div><ng-form name="dashboardSettingsForm"><section class="info" ng-if="$ctrl.isSettingsPane"><pbi-lazy-load-modern [module-path]="$ctrl.settingsBladeModulePath" [component-id]="$ctrl.settingsDashboardBladeComponentId" [input-args]="$ctrl.settingsDashboardBladeInputArgs" [output-args]="$ctrl.settingsDashboardBladeOutputArgs"></pbi-lazy-load-modern></section></ng-form><div class="workbookSettings metadata info" ng-if="$ctrl.isWorkbook"><pbi-lazy-load-modern [module-path]="$ctrl.settingsBladeModulePath" [component-id]="$ctrl.settingsWorkbookBladeComponentId" [input-args]="{viewModel: $ctrl.artifact}"></pbi-lazy-load-modern></div><ng-form ng-if="$ctrl.isDataflow" name="datapoolSettingsForm" class="dataflowDescription"><label class="info" localize="Description"></label><textarea ng-model="$ctrl.artifact.description" ng-readonly="::$ctrl.readOnly" maxlength="3999"></textarea><label class="info" ng-bind="::$ctrl.lastModifiedDetails" title="{{::$ctrl.lastModifiedDetails}}"></label></ng-form></section><section class="informationProtectionMissingBanner" ng-if="$ctrl.isSensitivityLabelMissing"><pbi-lazy-load-modern [module-path]="$ctrl.MessageBannerModulePath" [component-id]="\'MessageBannerComponentId\'" [input-args]="{viewModel: $ctrl.sensitivityLabelRequiredBannerModel}"></pbi-lazy-load-modern></section><footer><fieldset class="buttons"><div ng-show="$ctrl.isSaving" class="spinnerWithText"><spinner></spinner><div localize="GroupEditor_WaitForSave"></div></div><div ng-switch="::$ctrl.readOnly"><div ng-switch-default="false"><section class="disabled-button-wrapper" tooltip tooltip-config="$ctrl.sensitivityLabelRequiredTooltipConfig"> <button class="biButton primary" title="{{$ctrl.saveBtnTooltip}}" type="button" ng-disabled="$ctrl.isDisabled()" ng-click="$ctrl.saveModelName($ctrl.artifact.displayName)" localize="SettingsBlade_Save"></button></section> <button class="biButton" type="button" localize="SettingsBlade_Cancel" ng-click="$ctrl.cancel()"></button></div> <button ng-switch-when="true" class="biButton" type="button" localize="OK_ButtonText" ng-click="$ctrl.cancel()"></button></div></fieldset></footer></div></ng-form>'),e.put("components/tileEditor/tileEditor.html",'<ng-form name="tileEditorForm" role="dialog" aria-labelledby="tileEditorHeader"><div class="tileEditor paneLayout"><header><h2 id="tileEditorHeader" class="primaryHeading" ng-bind="::tileEditorHeaderPaneTitle()"></h2><ul class="headerTabs" ng-if="::isSavedRealTimeTile" role="tablist"><li class="label-med" ng-repeat="tab in ::headerTabs" ng-class="{selected: activeHeaderTab.type === tab.type}" ng-click="activateHeaderTab(tab)" ng-bind="::tab.text" role="tab" aria-selected="{activeHeaderTab.type === tab.type}"></li></ul></header><section class="contentContainer noPadding" pbi-auto-focus><pbi-lazy-load-modern ng-if="(activeHeaderTab.type === 0) && isSavedRealTimeTile" [module-path]="realTimeAuthoringUIModule" component-id="realTimeTileVisualizationDesignComponentId" [input-args]="{ tile: tileModel, model: selectedModel }"></pbi-lazy-load-modern><div class="tileDetails" ng-show="(activeHeaderTab.type === 1) || !isSavedRealTimeTile"><aside class="requiredField" localize="Required"></aside><section class="tileEditorSection"><h3 class="sectionHeader" localize="Details"></h3><div class="sectionContent"><pbi-checkbox id="chkDisplayTitle" label="TileEditor_PaneSubtitle_DisplayTitle" ng-model="displayTitle" ng-change="toggleDisplayTitle()" ng-disabled="viewModel.titleRequired || viewModel.tile.config.lastRefreshTimeEnabled"></pbi-checkbox><div ng-class="{disabled: !displayTitle}"><h4 class="input-field-label" ng-class="{required:viewModel.titleRequired}"><label localize="TileEditor_PaneSubtitle_Title" for="inputTileTitle"></label></h4> <input type="text" id="inputTileTitle" name="title" class="displayText" ng-class="{hasError: hasTitleError()}" ng-model="viewModel.tile.displayText"/><div class="errorBlock" ng-if="hasTitleError()" role="alert"><i class="glyphicon glyph-small pbi-glyph-error"></i><div class="message" localize="TileEditor_EmptyTitleWarning" localize-tooltip="TileEditor_EmptyTitleWarning"></div></div><h4 class="input-field-label"><label localize="TileEditor_PaneSubtitle_Subtitle" for="inputTileSubTitle"></label></h4> <input type="text" id="inputTileSubTitle" class="subDisplayText" ng-disabled="!displayTitle" ng-attr-readonly="!displayTitle" ng-model="viewModel.tile.subDisplayText"/></div></div></section><section ng-show="viewModel.tile.config.widget" class="tileEditorSection"><h3 class="sectionHeader" localize="Content"></h3><div class="sectionContent"><div class="widgetEditorContent"></div></div></section><section class="tileEditorSection"><h3 class="sectionHeader" localize="TileEditor_SectionHeader_Functionality"></h3><div class="sectionContent"><pbi-checkbox id="chkDisplayLastRefreshTime" label="TileEditor_DisplayLastRefreshTime" ng-if="viewModel.hasLastRefreshTime" ng-model="viewModel.tile.config.lastRefreshTimeEnabled" ng-change="showLastRefreshTimeChanged()"></pbi-checkbox><pbi-checkbox id="chkTileCustomLink" label="TileEditor_SetCustomLink" ng-model="hasCustomLink" ng-change="setCustomLinkChanged()" ng-disabled="::!viewModel.canAddOrRemoveCustomLink" name="customLink"></pbi-checkbox><label><span class="input-field-label altTextStyling" localize="TileEditor_SelectLinkType"></span><pbi-radio-group-legacy ng-model="customLinkType" ng-disabled="!hasCustomLink" ng-change="setCustomLinkChanged()" no-label name="linkType"><pbi-radio id="radioELink" label="TileEditor_ExternalLink" ng-value="1"></pbi-radio><pbi-radio id="radioALink" label="TileEditor_ArtifactLink" ng-value="2"></pbi-radio></pbi-radio-group-legacy></label><div ng-class="{disabled: !hasCustomLink}" ng-if="(customLinkType === 1)" class="externalLink"><h4 class="input-field-label altTextStyling required"><label localize="Url" for="inputTileCustomUrl"></label></h4> <input class="customLinkUrl" type="text" id="inputTileCustomUrl" name="customUrl" ng-model="viewModel.tile.action.targetUrl" ng-disabled="!hasCustomLink" ng-attr-readonly="!hasCustomLink" ng-class="{hasError: hasExternalLinkError()}" aria-required="true"/><div class="errorBlock" ng-if="hasExternalLinkError()" role="alert"><i class="glyphicon glyph-small pbi-glyph-error"></i><div class="message" localize="Validation_InvalidUrl" localize-tooltip="Validation_InvalidUrl"></div></div><label><span class="input-field-label altTextStyling" localize="TileEditor_SetOpenInSameTab"></span><pbi-radio-group-legacy ng-model="viewModel.tile.action.openInSameTab" ng-disabled="!hasCustomLink" no-label><pbi-radio id="radioEditorYes" label="Yes" ng-value="true"></pbi-radio><pbi-radio id="radioEditorNo" label="No" ng-value="false"></pbi-radio></pbi-radio-group-legacy></label></div><div ng-class="{disabled: !hasCustomLink}" ng-if="(customLinkType === 2)" class="internalLink" ng-switch="getInternalLinkWarningType()"><h4 class="input-field-label altTextStyling required"><label localize="TileEditor_PickArtifact" for="sltTileArtifactPicker"></label></h4> <select class="artifactPicker" id="sltTileArtifactPicker" name="artifactPicker" ng-model="internalLinkInfo.target" ng-disabled="!hasCustomLink" ng-change="onLinkTargetChanged()" ng-class="{hasError: getInternalLinkWarningType() === 1}" ng-options="candidate as internalLinkInfo.getCandidateName(candidate) for candidate in internalLinkInfo.candidates"></select><div class="errorBlock" ng-switch-when="1" role="alert"><i class="glyphicon glyph-small pbi-glyph-error"></i><span class="message" localize="TileEditorArtifactNotFound" localize-tooltip="TileEditorArtifactNotFound"></span></div><div class="infoBlock" ng-switch-when="2"><i class="glyphicon glyph-small pbi-glyph-info"></i><span class="message" localize="TileEditor_ArtifactLink_CantReshareWarning" localize-tooltip="TileEditor_ArtifactLink_CantReshareWarning"></span></div></div></div></section><section class="tileEditorSection" ng-if="viewModel.tile.workbook && viewModel.tile.config.workbookTile"><div><h3 class="tileEditorTitle sectionHeader" localize="AdvancedOptions"></h3><div class="sectionContent"><h4 class="input-field-label altTextStyling" localize="TileEditor_PaneSubtitle_Fit"></h4><label class="toggleButton"><pbi-toggle label="TileEditor_SetKeepOriginalContentSize" ng-model="viewModel.tile.workbook.keepOriginalContentSize" ng-change="setDynamicImageForWorkbookTile()"></pbi-toggle></label></div></div></section></div></section><section class="banner"><pbi-button ng-if="viewModel.canRestoreDefaults()" label="TileEditor_UseDefaultText" kind="text" ng-click="restoreDefaults()"></pbi-button><pbi-button label="TileEditor_TechnicalDetails" kind="text" ng-click="showTechnicalDetailsDialog()"></pbi-button></section><footer><fieldset class="buttons"><pbi-button label="Generic_Back" ng-if="viewModel.tile.isTemporary" class="accessibleNeutral" ng-click="back()"></pbi-button><pbi-button label="Apply" primary="true" class="accessiblePrimary" ng-disabled="!canSave() || realTimeVisualizationForm.$invalid" ng-click="saveChangesAndExit()" data-unique-id="TileEditApply" id="TileEditApply"></pbi-button><pbi-button label="PBI_Button_Label_Cancel" class="accessibleNeutral" ng-click="closeTileEditorWithoutSaving()"></pbi-button></fieldset></footer></div></ng-form>'),e.put("components/tileEditor/tileGallery.html",'<div class="addTilesView paneLayout" role="dialog" aria-labelledby="tileGalleryHeader"><header><h3 id="tileGalleryHeader" class="primaryHeading" localize="AddTile"></h3><h4 class="secondaryHeading" localize="Add_Tile_Experience_Select_Source"></h4></header><section class="contentContainer" pbi-auto-focus><div class="tilesGroup" ng-repeat="tileGroup in $ctrl.tileGroups"><h4 class="headerText" ng-bind="::tileGroup.title"></h4><ul class="tilesContainer"><li ng-repeat="tile in tileGroup.tiles"> <button class="tile" ng-click="$ctrl.select(tile)" ng-class="{selected: $ctrl.selectedTile.id === tile.id}" ng-disabled="{{tile.disabled}}" title="{{tile.tooltip || tile.title}}"><i class="glyphicon glyph-large icon {{::tile.iconClass}}"></i><span class="tileTitle" ng-bind="::tile.title" ng-attr-title="{{::tile.title}}"></span></button></li></ul></div></section><footer><fieldset class="buttons"><pbi-button label="PBI_Button_Label_Next" primary="true" id="Tile_Gallery_Button_Next" class="accessiblePrimary" ng-disabled="!$ctrl.selectedTile" ng-click="$ctrl.next()"></pbi-button><pbi-button label="PBI_Button_Label_Cancel" class="accessibleNeutral" ng-click="$ctrl.closeTileGalleryPane()"></pbi-button></fieldset></footer></div>'),e.put("components/tileEditor/widgets/editIframeWidget.html",'<div><label class="input-field-label required" localize="EditWidget_EmbedCode" for="editEmbedCode"></label><textarea id="editEmbedCode" ng-model="viewModel.tile.iframe.embedCode" aria-required="true"></textarea><div class="infoBlock"><i class="glyphicon glyph-small pbi-glyph-info"></i><span class="message" localize="EditWidget_WebContentIssues" localize-fragments><a class="link" href="https://go.microsoft.com/fwlink/?LinkID=799824" target="_blank" fragment-index="0" localize="LearnMore"></a></span></div></div>'),e.put("components/tileEditor/widgets/editImageWidget.html",'<div aria-live="polite"><form name="imageContentForm"><label class="input-field-label required" localize="Url" for="imageUrl"></label> <input type="url" id="imageUrl" name="imageUrl" ng-model="viewModel.tile.image.imageUrl" ng-change="onChange()" ng-class="{hasError: imageContentForm.imageUrl.$touched && !viewModel.isImageUrlValid()}" aria-required="true"/><div class="errorBlock" ng-if="imageContentForm.imageUrl.$touched && !viewModel.isImageUrlValid()" role="alert"><i class="glyphicon glyph-small pbi-glyph-error"></i><div class="message" localize="Validation_InvalidUrl" localize-tooltip="Validation_InvalidUrl"></div></div></form></div>'),e.put("components/tileEditor/widgets/editTextWidget.html",'<div class="editWidgetContainer" toolbar-anchor><div class="widgetDetails" localize="EditWidget_Details"></div><div><div toolbar-container></div><downgraded-visual-modern class="textVisual" [view-model]="viewModel.visualModel"></downgraded-visual-modern></div></div>'),e.put("components/tileEditor/widgets/editVideoWidget.html",'<div aria-live="polite"><form name="videoContentForm"><label class="input-field-label required" localize="EditWidget_VideoWidget_Url" for="videoUrl"></label> <input type="url" id="videoUrl" name="videoUrl" ng-model="url" ng-blur="blurChanged()" ng-change="inputChanged()" ng-class="{hasError: videoContentForm.videoUrl.$touched && !viewModel.isVideoUrlValid()}" aria-required="true"/><div class="errorBlock" ng-if="videoContentForm.videoUrl.$touched && !viewModel.isVideoUrlValid()" role="alert"><i class="glyphicon glyph-small pbi-glyph-error"></i><div class="message" localize="EditWidget_VideoWidget_InvalidUrl" localize-tooltip="EditWidget_VideoWidget_InvalidUrl"></div></div></form></div>')}}(powerbi=powerbi||{}),function(a){!function(i){var o,e=a.sidePanes.htmlTemplate.put;function t(){r||(o=angular.module("powerbi.sidePanes",["powerbi"]).config(["lazyProvider",function(e){e.factories.tileAuthoring={source:{javascript:"PowerBISidePanes/services/tileAuthoring"},ng:["dashboardDataService","folderService","reportService","localizationService","ownership","packageService","appService","usageMetricsReport"],fn:function(e,t,i,o,r,a,s,n,l){return e.create(t,i,o,r,a,s,n,l)}}}]).factory("relatedContentForModelProxy",["httpService",function(e){return i.createRelatedContentForModelProxy(e)}]).run(["$templateCache",e]),r=!0)}i.initializeAngularModule=t;var r=!1;t(),i.registerBuildingBlocksForHost=function(e){var t=[{name:"CreateGroupBlade",blockType:2,consumerHostFlags:8,factory:a.sidePanes.components.CreateGroupBlade},{name:"CustomValidator",dependencies:["$timeout"],blockType:1,consumerHostFlags:8,factory:a.sidePanes.directives.CustomValidator},{name:"CustomValidatorSynchronizer",blockType:1,consumerHostFlags:8,factory:a.sidePanes.directives.CustomValidatorSynchronizer},{name:"EditGroupBlade",blockType:2,consumerHostFlags:8,factory:a.sidePanes.components.EditGroupBlade},{name:"EditIframeWidget",dependencies:["explorationSerializer"],blockType:1,consumerHostFlags:8,factory:a.sidePanes.directives.EditIframeWidget},{name:"EditImageWidget",dependencies:["explorationSerializer"],blockType:1,consumerHostFlags:8,factory:a.sidePanes.directives.EditImageWidget},{name:"EditMyWorkspaceBlade",blockType:2,consumerHostFlags:8,factory:a.sidePanes.components.EditMyWorkspaceBlade},{name:"EditTextWidget",blockType:1,consumerHostFlags:8,factory:a.sidePanes.directives.EditTextWidget},{name:"Expando",blockType:2,consumerHostFlags:65535,factory:a.sidePanes.components.Expando},{name:"FolderPermissionsEditBlade",blockType:2,consumerHostFlags:8,factory:a.sidePanes.components.FolderPermissionsEditBlade},{name:"EditVideoWidget",blockType:1,consumerHostFlags:8,factory:a.sidePanes.directives.EditVideoWidget},{name:"SettingsBlade",blockType:2,consumerHostFlags:8,factory:a.sidePanes.components.SettingsBlade},{name:"TileEditor",blockType:1,consumerHostFlags:8,factory:a.sidePanes.directives.TileEditor},{name:"TileEditorInner",dependencies:["$compile","$timeout","localizationService"],blockType:1,consumerHostFlags:8,factory:a.sidePanes.directives.TileEditorInner},{name:"TileGallery",blockType:1,consumerHostFlags:8,factory:a.sidePanes.directives.TileGallery},{name:"ValidateRealTimeTileEdit",blockType:1,consumerHostFlags:8,factory:a.sidePanes.directives.ValidateRealTimeTileEdit},{name:"ViewGroupBlade",blockType:2,consumerHostFlags:8,factory:a.sidePanes.components.ViewGroupBlade}];a.common.registerBuildingBlocksForHost(e,t,{componentsTarget:"powerbi.sidePanes",directivesTarget:"powerbi.sidePanes"}),o.filter("truncateTo",i.filters.truncateTo),o.filter("rolePropertyFilter",i.filters.rolePropertyFilter)}}(a.sidePanes||(a.sidePanes={}))}(powerbi=powerbi||{}),function(n){!function(e){var o,t,r,a,i;function s(e,t){this.viewerLevelPermission=1,this.contributorLevelPermission=9,this.memberLevelPermission=4|this.contributorLevelPermission,this.adminLevelPermission=2|this.memberLevelPermission,this.MessageBannerModulePath="@powerbi/UILibrary/message-banner/message-banner.module#MessageBannerModule",this.services=t}e=e.controllers||(e.controllers={}),o=n.common.models.EmailsListModel,t=n.helpers.EmailValidationHelper,r=n.models.FolderPermissionsEditModel,a=n.common.contracts.FolderType,i=n.common.ArrowPosition,s.createOptions=function(){return{additionalServices:["errorService","folderService","localizationService","lazy","lazyProviderModern","domainHelperService","taskPaneSliderService","promiseFactory","licenseEnforcementService","featureSwitchService","informationProtectionService","appPrincipalService"]}},s.prototype.$onInit=function(){this.initializeModel(),this.setFolderMemberInformation(),this.isAdmin=2===this.model.userRole,this.shouldShowInformationProtectionWarning()},s.prototype.initializeModel=function(){var e=this.services,t=this.parameters,i=t&&t.folder||e.folderService.activeFolder,t=new r(this.services.localizationService,this.services.featureSwitchService.featureSwitches.workspacesV2ViewerRole,i,this.services.featureSwitchService.featureSwitches.displayAdminInsights);this.model=t,this.setPermissionRoleMappings(),this.allowUnifiedGroups=e.featureSwitchService.featureSwitches.workspacesV2UnifiedGroups,t.emailsList=new o,t.userRole=this.permissionsToRoles[i.permissions],this.setModelPermissionAddOptionsForMemberLevel(t.userRole)},s.prototype.shouldShowInformationProtectionWarning=function(){return __awaiter(this,void 0,n.Promise,function(){var t,i,o,r;return __generator(this,function(e){switch(e.label){case 0:return t=this.services.informationProtectionService,i=this.model.folder,o=this,(r=t.isInformationProtectionFeatureEnabled())?[4,t.isWorkspaceArtifactsHasLabel(i.id,i.uniqueId).toPromise()]:[3,2];case 1:r=e.sent(),e.label=2;case 2:return o.showInformationProtectionWarning=r,this.showInformationProtectionWarning&&(this.informationProtectionBannerModel={bannerType:2,iconName:"pbi-glyph-info",message:this.services.localizationService.get("Sharing_Workspace_Information_Protection_Warning"),linkDisplayName:this.services.localizationService.get("LearnMore"),link:"https://go.microsoft.com/fwlink/?linkid=2128233"}),[2]}})})},s.prototype.resetValidation=function(){this.model.emailValidationWarning="",this.validateInputTags()},s.prototype.validateInputTags=function(){t.validateInputTags(this.services,this.model,{shouldBlockConsumerDomains:!1})},s.prototype.canAdd=function(){return this.model.emailsList.hasValidationError||this.isSaving||this.isFindingUsers},s.prototype.canEdit=function(e){if(this.services.featureSwitchService.featureSwitches.displayAdminInsights){e=this.permissionsToRoles[e.permission];return this.isAdmin&&!(this.model.folder.type===a.AdminFolder&&2===e)}return this.isAdmin},s.prototype.addMembersWithAccess=function(){return __awaiter(this,void 0,n.Promise,function(){var t,o,i,r,a,s,n=this;return __generator(this,function(e){return t=this.model,o=t.emailsList,i=t.folder.id,r=t.permissionArtifact,a=this.roleToPermissions[t.folderMemberRoleOption],o.validationTrigger()?0<(s=_.map(o.inputUserList,function(e){return n.getPermissionRequestForUser(e,i,a)})).length?[2,this.updateMembers(s,function(){for(var e,t=0,i=s;t<i.length;t++)!function(t){_.remove(r.members,function(e){return e.email===t.email})}(i[t]);(e=r.members).push.apply(e,s||[]),o.inputUserList=[]})]:(o.inputUserList=[],[2]):[2]})})},s.prototype.onMemberAccessMenuItemSelected=function(o,r){return __awaiter(this,void 0,n.Promise,function(){var t,i;return __generator(this,function(e){return this.isSaving?[2]:(t=this.model.permissionArtifact,i=o.permission,this.validateRemainingAdmins(o)?(o.permission=this.roleToPermissions[r],[2,this.updateMembers([o],function(){3===r&&(t.members=_.without(t.members,o))},function(){o.permission=i})]):(this.showAtleastOneAdminRequiredMessage(),[2]))})})},s.prototype.shouldShowMemberInfo=function(e){e=angular.element("#displayName"+e)[0];return e&&e.offsetWidth<e.scrollWidth},s.prototype.getMemberDisplayName=function(e){var t=(t=e.displayName&&0<e.displayName.length?e.displayName:e.email)||(this.services.appPrincipalService.isAppOnlyUser(e)&&e.objectId?e.objectId:"");return e.tenantId?this.services.localizationService.get("PermissionCenter_EntireTenant"):t},s.prototype.getMemberInfoTooltipConfig=function(e){return{tooltipArrowPosition:i.arrowBottomMiddle,tooltipShowOnFocus:!0,tooltipTitle:this.getMemberDisplayName(e),tooltipDescription:this.getMemberTooltipDescription(e)}},s.prototype.getValidMenuItemsForMember=function(e){var t=this.model,i=this.permissionsToRoles[e.permission];return 2!==t.userRole?[]:this.services.appPrincipalService.isServicePrincipalProfile(e)?t.folderServicePrincipalProfileActionOption:t.folderMemberActionOptionAdminByRole[i]},s.prototype.getDisplayStringForMemberRole=function(e){var t=this.model;switch(e){case 2:return t.localizedAdmin;case 0:return t.localizedMember;case 1:return t.localizedContributor;case 4:return t.localizedViewer;default:return""}},s.prototype.cancel=function(){this.services.taskPaneSliderService.collapsePane()},s.prototype.setFolderMemberInformation=function(){return __awaiter(this,void 0,n.Promise,function(){var t,i,o,r,a=this;return __generator(this,function(e){switch(e.label){case 0:return[4,this.services.lazyProviderModern.get("@powerbi/WebSharing/web-sharing.module#WebSharingModule","permissionData")];case 1:t=e.sent(),i=this.model,o=this.model.folder,e.label=2;case 2:return e.trys.push([2,4,,5]),[4,t.getFolderPermissionArtifact(o.id)];case 3:return(r=e.sent()).members=r.members?_.sortBy(r.members,function(e){return a.getMemberDisplayName(e).toUpperCase()}):[],i.permissionArtifact=r,[3,5];case 4:return r=e.sent(),this.handleError(r.requestId,r.status),[3,5];case 5:return[2]}})})},s.prototype.updateMembers=function(r,a,s){return __awaiter(this,void 0,n.Promise,function(){var t,i,o;return __generator(this,function(e){switch(e.label){case 0:return[4,this.services.lazyProviderModern.get("@powerbi/WebSharing/web-sharing.module#WebSharingModule","permissionData")];case 1:t=e.sent(),this.isSaving=!0,i=this.model,e.label=2;case 2:return e.trys.push([2,4,5,6]),[4,t.updateFolderAccess(i.folder.id,r)];case 3:return 200<=(o=e.sent()).status&&o.status<=204?a():this.handleError(o.requestId,o.status,o.error,s),[3,6];case 4:return o=e.sent(),this.handleError(o.requestId,o.status,void 0,s),[3,6];case 5:return this.isSaving=!1,[7];case 6:return[2]}})})},s.prototype.handleError=function(e,t,i,o){o&&o();this.services.errorService.error(this.services.localizationService.get("GroupEditor_FailedUpdateGroup_Message"),"FailedToUpdateGroup",{requestId:e,statusCode:t&&t.toString()})},s.prototype.setPermissionRoleMappings=function(){this.permissionsToRoles={},this.permissionsToRoles[this.adminLevelPermission]=2,this.permissionsToRoles[this.memberLevelPermission]=0,this.permissionsToRoles[this.contributorLevelPermission]=1,this.permissionsToRoles[this.viewerLevelPermission]=4,this.permissionsToRoles[7]=2,this.permissionsToRoles[5]=0,this.roleToPermissions={},this.roleToPermissions[2]=this.adminLevelPermission,this.roleToPermissions[0]=this.memberLevelPermission,this.roleToPermissions[1]=this.contributorLevelPermission,this.roleToPermissions[4]=this.viewerLevelPermission,this.roleToPermissions[3]=0},s.prototype.setModelPermissionAddOptionsForMemberLevel=function(e){var t=this.model,i=t.folder,o=[];2===e&&i.type!==a.AdminFolder&&o.push({key:2,value:t.localizedAdmin}),o.push.apply(o,[{key:0,value:t.localizedMember},{key:1,value:t.localizedContributor}]),this.services.featureSwitchService.featureSwitches.workspacesV2ViewerRole&&o.push({key:4,value:t.localizedViewer}),t.folderMemberRoleOptions=o,t.folderMemberRoleOption=0},s.prototype.getPermissionRequestForUser=function(e,t,i){var o={id:t,displayName:e.displayName,email:e.userPrincipalName,permission:i};switch(e.objectType){case 1:o.userObjectId=e.objectId,o.isServicePrincipal=this.services.appPrincipalService.isAppOnlyUser(e);break;case 2:o.groupObjectId=e.objectId}return o},s.prototype.validateRemainingAdmins=function(e){var t=this;return 2!==this.permissionsToRoles[e.permission]||1<_.filter(this.model.members,function(e){return 2===t.permissionsToRoles[e.permission]}).length},s.prototype.showAtleastOneAdminRequiredMessage=function(){var i=this.services.errorService.control();i.showPrompt("",this.services.localizationService.get("WorkspaceAtLeastOneAdmin"),[new InJs.ModalDialogAction(this.services.localizationService.get("ModalDialogButtonText_Ok"),function(e,t){i.hideDialog()})])},s.prototype.getMemberTooltipDescription=function(e){var t=[];return e.userPrincipalName&&t.push(this.services.localizationService.get("UserPrincipalName"),e.userPrincipalName),!e.userPrincipalName&&e.email&&t.push(this.services.localizationService.get("Email"),e.email),t.join("\n")},e.FolderPermissionsEditBladeController=s}(n.sidePanes||(n.sidePanes={}))}(powerbi=powerbi||{}),function(e){var t;((t=e.sidePanes||(e.sidePanes={})).components||(t.components={})).FolderPermissionsEditBlade={controller:e.common.createController(t.controllers.FolderPermissionsEditBladeController),bindings:{parameters:"<"},templateUrl:"components/folderPermissionsEditBlade/folderPermissionsEditBlade.html"}}(powerbi=powerbi||{}),function(s){!function(e){var t,i,a,c;function o(e){this.services=e,this.showBYOResourceSettings=!1,this.isDataflowsStorageAccountEnabled=!1,this.showDataflowsStorageAccount=!1,this.isAdminFolder=!1,this.licenseModeAvailability={},this.folderDisplayNameDebounceInMilliseconds=600,this.isLoadingDataflowsStorageAccounts=!1,this.isPremiumFilesSupported=!0,this.showServiceAppCheckbox=!1,this.cdsaFolderStorageAccountUIEnabled=!1,this.readOnlyGroupEnabled=this.services.featureSwitchService.featureSwitches.readOnlyGroupEnabled,this.capacityEnabled=this.services.featureSwitchService.featureSwitches.groupCapacity,this.workspacesV2GAFeaturesEnabled=this.services.featureSwitchService.featureSwitches.workspacesV2GAFeatures,this.availableCapacities=[],this.cdsaFolderStorageAccountUIEnabled=this.services.featureSwitchService.featureSwitches.cdsaFrontend&&this.services.featureSwitchService.featureSwitches.cdsaFolderStorageAccountUI,this.enabledDataflowsStorageAccounts=[],this.isAdvancedModeExpanded=!1,this.byoResourcesModule="@powerbi/BYOResources/module#BYOResourcesModule",this.byoResourcesWorkspaceContainerComponent="BYOResourcesComponentId",this.licenseModeAvailability[c.Pro]=!0,this.serviceAppCheckboxAriaLabel=this.services.localizationService.get("GroupEditor_ServiceAppCheckbox"),this.allowContributorUpdateAppAriaLabel=this.services.localizationService.get("AllowContributorsUpdateAppForWorkspace")}e=e.controllers||(e.controllers={}),t=s.common.contracts,i=s.common.controllers.EmailsListController,a=s.errorDetailsHelper,c=s.models.LicenseMode,o.prototype.baseInit=function(){this.latestFolderNameIsValid=!0,this.folderNameResetToOriginal=!0,this.showServiceAppCheckbox=this.services.featureSwitchService.featureSwitches.insightApps,this.isAdminFolder=this.model.folderType===t.FolderType.AdminFolder,this.showBYOResourceSettings=this.services.featureSwitchService.featureSwitches.byoResourcesUI&&!this.isAdminFolder},o.prototype.isEmailListChanged=function(){var e=this.model.originalDisplayMemberList,t=this.model.displayMemberList;if(e.length!==t.length)return!0;e=this.contractGroupMembersToArray(e),t=this.contractGroupMembersToArray(t),t=_.difference(e,t);return!_.isEmpty(t)},o.prototype.add=function(){this.model.invalidEmailAddressesErrorMessage="",this.model.notExitingEmailAddressesErrorMessage="",this.model.emailsList.validationTrigger()&&(this.isAddingMembers=!0,this.validateEmailAddresses())},o.prototype.removeMember=function(t){var i,e;this.isMemberTheOnlyAdmin(t)?(i=this.services.errorService.control(),e=this.services.localizationService,i.showPrompt("",e.get("GroupEditor_TheOnlyAdmin_Message"),[new InJs.ModalDialogAction(e.get("ModalDialogButtonText_Ok"),function(e,t){i.hideDialog()})])):(this.model.emailsList.isDirty=!1,this.model.displayMemberList=_.filter(this.model.displayMemberList,function(e){return e.userPrincipalName!==t.userPrincipalName}))},o.prototype.getGroupMembers=function(){var t=this;this.isLoadingGroupMembers=!0;function e(){return t.isLoadingGroupMembers=!1}var i=this.services.telemetryService.startEvent(s.telemetry.GroupEditorGetGroupMembers),o=this.folder.uniqueId,o=this.services.groupHttp.getGroupMembers(o,i.event).toPromise();o.then(function(e){e=_.sortBy(t.mapFromMemberContractListToMemberModelList(e.data),function(e){return e.userPrincipalName});t.model.originalDisplayMemberList=e,t.model.displayMemberList=_.cloneDeep(e),i.resolve()},function(e){i.reject(a.getTelemetryErrorDetails(e.error,e.status)),t.services.errorService.error(t.services.localizationService.get("GroupEditor_FailedGetGroupMembers_Message"),"FailedToGetGroupMembers",{requestId:e.requestId,statusCode:e.status.toString()})}),o.then(e,e)},o.prototype.resetSharePointValidation=function(){this.model.sharePointStorageList.hasValidationError=!1,this.validateSharePointInputTags()},o.prototype.validateSharePointInputTags=function(){var e=this.model.sharePointStorageList;1<e.inputUserList.length?(e.hasValidationError=!0,e.errorMessage=this.services.localizationService.get("GroupEditor_SharePoint_OnlyOneGroupAllowed")):0===e.inputUserList.length?e.validObjectIds=[]:e.validationTrigger()},o.prototype.getLicenseModeToolTipConfig=function(){return{tooltipArrowPosition:s.common.ArrowPosition.arrowBottomRight,tooltipShowOnFocus:!0,tooltipDescription:this.services.localizationService.get("Workspace_LicenseMode_Tooltip"),tooltipHyperlinkText:this.services.localizationService.get("Workspace_LicenseMode_Tooltip_Link"),tooltipHyperlinkUrl:"https://go.microsoft.com/fwlink/?linkid=2159767"}},o.prototype.getEmbeddedToolTipConfig=function(){return{tooltipArrowPosition:s.common.ArrowPosition.arrowBottomRight,tooltipShowOnFocus:!0,tooltipDescription:this.services.localizationService.get("Workspace_LicenseMode_Embedded_Information"),tooltipHyperlinkText:this.services.localizationService.get("Generic_LearnMore"),tooltipHyperlinkUrl:"https://go.microsoft.com/fwlink/?linkid=2159726"}},o.prototype.validateEmailAddresses=function(){var e,n,l=this;this.model.emailsList.validEmailsList=_.uniq(_.map(this.model.emailsList.validEmailsList,function(e){return e.toLowerCase()})),this.model.emailsList.validEmailsList=_.difference(this.model.emailsList.validEmailsList,_.map(this.model.displayMemberList,function(e){return e.userPrincipalName.toLowerCase()})),0<this.model.emailsList.validEmailsList.length?(e=_.map(this.model.emailsList.validEmailsList,function(e){return{userPrincipalName:e,membershipStatus:1}}),n=this.services.telemetryService.startEvent(s.telemetry.GroupEditorValidateGroupMembers),this.services.domainHelperService.getVerifiedDomains().then(function(s){l.services.groupHttp.validateGroupMembers(e,n.event).toPromise().then(function(e){for(var t=[],i={},o=0,r=e.data;o<r.length;o++){var a=r[o];a.userPrincipalName.split("@")[1].toUpperCase()in s.verifiedDomains?i[a.userPrincipalName]=1:t.push(a)}l.displayValidationErrors(t);e=l.contractGroupMembersToArray(t),e=_.difference(l.model.emailsList.validEmailsList,e);l.model.displayMemberList=_.union(l.model.displayMemberList,_.map(e,function(e){return{userPrincipalName:e,role:e in i?2:0,invitationSent:!1}})),l.model.emailsList.isDirty=!1,n.resolve()},function(e){n.reject(a.getTelemetryErrorDetails(e.error,e.status)),l.services.errorService.error(l.services.localizationService.get("GroupEditor_FailedValidateMembers_Message"),"FailedToValidateMembers",{requestId:e.requestId,statusCode:e.status.toString()})})},function(e){n.reject(a.getTelemetryErrorDetails(e.error,e.status))}).finally(function(){l.isAddingMembers=!1})):(this.displayValidationErrors([]),this.setEmailsListContent(""),this.model.emailsList.isDirty=!1,this.isAddingMembers=!1)},o.prototype.setEmailsListContent=function(e){this.model.emailsList.inputUserList=i.emailsToUsers(e.split(s.constants.emailsListSeparator))},o.prototype.resetEmailsListControl=function(e){this.model.invalidEmailAddressesErrorMessage="",this.displayValidationErrors(e)},o.prototype.mapFromMemberModelListToMemberContractList=function(e){return _.map(e,function(e){var t=1===e.role?3:1;return 2===e.role&&(t=4),{userPrincipalName:e.userPrincipalName,membershipStatus:t}})},o.prototype.mapFromMemberContractListToMemberModelList=function(e){var t=this;return _.map(e,function(e){return{userPrincipalName:e.userPrincipalName,role:t.convertMemberRole(e),invitationSent:4===e.membershipStatus}})},o.prototype.getAccessControlOption=function(){var e=this.model.accessControlOption;if(null!=e)return _.find(this.model.accessControlOptions,{key:e}).value},o.prototype.getPrivacyOption=function(){var e=this.model.privacyOption;if(null!=e)return _.find(this.model.privacyOptions,{key:e}).value},o.prototype.cancel=function(){this.services.taskPaneSliderService.collapsePane()},o.prototype.isMemberTheOnlyAdmin=function(e){if(1!==e.role)return!1;var t=_.filter(this.model.displayMemberList,function(e){return 1===e.role});return 1===t.length&&t[0].userPrincipalName.toLowerCase()===e.userPrincipalName.toLowerCase()},o.prototype.updateCapacityList=function(e){void 0===e&&(e=!0),this.capacitiesList=this.getCapacitiesPerLicenseMode(this.availableCapacities,this.model.licenseMode),e&&(this.model.defaultDatasetStorageFormat=1,this.capacitiesList.length?(this.model.capacity=this.capacitiesList[0],6===this.model.capacity.capacitySkuTier?this.isPremiumFilesSupported=!1:this.getCapacityPremiumFileSupport(this.model.capacity.id)):this.model.capacity=null)},o.prototype.getCapacitiesPerLicenseMode=function(e,t){var i;switch(t){case c.Premium:i=_.filter(e,function(e){return 1===e.capacitySkuTier&&!e.disabled});break;case c.Embedded:i=_.filter(e,function(e){return(3===e.capacitySkuTier||2===e.capacitySkuTier)&&!e.disabled});break;case c.PPU:i=_.filter(e,function(e){return 4===e.capacitySkuTier&&!e.disabled});break;case c.Pro:i=_.filter(e,function(e){return 6===e.capacitySkuTier&&!e.disabled});break;default:i=[]}return i},o.prototype.canEditCapacity=function(e){return void 0===e&&(e=this.availableCapacities),(this.model.licenseMode===c.Premium||this.model.licenseMode===c.Embedded)&&!_.isEmpty(_.filter(e,function(e){return!e.disabled}))},o.prototype.getInCapacityMessage=function(){if(this.capacityEnabled&&this.model.capacity)return this.services.localizationService.format("GroupEditor_IsOnCapacityMessage",[this.model.capacity.name])},o.prototype.toggleAdvancedMode=function(){this.isAdvancedModeExpanded=!this.isAdvancedModeExpanded},o.prototype.getToggleTooltipConfig=function(){var e="GroupEditor_CapacityToggleEnabledTooltip";return{tooltipAnchorElementSelector:".capToggle input",tooltipLocalizeDescription:e=!this.canEditCapacity()?"GroupEditor_CapacityToggleDisabledTooltip":e,tooltipArrowPosition:s.common.ArrowPosition.arrowTopMiddle}},o.prototype.loadCapacities=function(l){return __awaiter(this,void 0,s.Promise,function(){var t,i,o,r,a,s,n=this;return __generator(this,function(e){switch(e.label){case 0:if(!this.capacityEnabled)return[2];this.isLoadingCapacities=!0,e.label=1;case 1:return e.trys.push([1,3,4,5]),[4,this.services.groupHttp.getAvailableGroupCapacities().toPromise()];case 2:if((o=e.sent())&&200===o.status&&(this.availableCapacities=_.map(o.data,function(e){return n.convertCapacity(e)})),t=this.model.capacity)if(i=this.folder.contract,(o=_.find(this.availableCapacities,function(e){return t.id.toLowerCase()===e.id.toLowerCase()}))?(this.model.capacity=o,t=o,this.getCapacityPremiumFileSupport(t.id)):(null!=i.capacityObjectId&&t.id.toLowerCase()===i.capacityObjectId.toLowerCase()&&6===i.capacitySkuTier?t.capacitySkuTier=6:t.disabled=!0,this.availableCapacities.push(t)),t.disabled)this.model.licenseMode=void 0;else switch(t.capacitySkuTier){case 1:this.model.licenseMode=c.Premium;break;case 4:this.model.licenseMode=c.PPU;break;case 3:case 2:this.model.licenseMode=c.Embedded;break;case 6:this.model.licenseMode=c.Pro;break;default:this.model.licenseMode=void 0}for(l&&_.remove(this.availableCapacities,function(e){return 4===e.capacitySkuTier}),this.updateCapacityList(!t),r=0,a=[c.PPU,c.Premium,c.Embedded];r<a.length;r++)s=a[r],this.licenseModeAvailability[s]=this.model.isAdmin&&0<this.getCapacitiesPerLicenseMode(this.availableCapacities,s).length;return[3,5];case 3:return e.sent(),[3,5];case 4:return this.isLoadingCapacities=!1,[7];case 5:return[2]}})})},o.prototype.getCapacityPremiumFileSupport=function(i){return __awaiter(this,void 0,s.Promise,function(){var t;return __generator(this,function(e){switch(e.label){case 0:if(!this.capacityEnabled)return[2];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.services.groupHttp.getCapacityPremiumFileAvailability(i).toPromise()];case 2:return t=e.sent(),this.isPremiumFilesSupported=null==t?void 0:t.data.isPremiumFilesSupported,[3,4];case 3:return e.sent(),this.isPremiumFilesSupported=!0,[3,4];case 4:return[2]}})})},o.prototype.loadDataflowsStorageAccounts=function(e){var t=this;this.cdsaFolderStorageAccountUIEnabled&&!this.showBYOResourceSettings&&(this.isLoadingDataflowsStorageAccounts=!0,this.services.groupHttp.getAvailableFolderDataflowsStorageAccounts(e).toPromise().then(function(e){e&&e.data&&(t.enabledDataflowsStorageAccounts=_.filter(e.data,function(e){return e.enabled||!!e.isConnectedToContextFolder}),t.showDataflowsStorageAccount=!_.isEmpty(t.enabledDataflowsStorageAccounts),t.isDataflowsStorageAccountEnabled=!_.isEmpty(_.filter(t.enabledDataflowsStorageAccounts,function(e){return e.isConnectedToContextFolder}))),t.isLoadingDataflowsStorageAccounts=!1},function(e){t.isLoadingDataflowsStorageAccounts=!1}))},o.prototype.getDataflowsStorageAccountId=function(){if(this.isDataflowsStorageAccountEnabled&&!_.isEmpty(this.enabledDataflowsStorageAccounts))return _.head(this.enabledDataflowsStorageAccounts).id},o.prototype.showErrorInfo=function(e,t,i,o,r,a,s){var n,l,c=[];if(s)switch(s.code){case"ADGraphGroupOperationFailedBlockedWord":n=o.get("GroupEditor_FailedCreateGroup_Message_BlockedWord"),l=o.get("GroupEditor_FailedCreateGroup_Title_BlockedWord"),c=this.populateDisplayableErrorInfo(s,"BlockedWord");break;case"ADGraphGroupOperationFailedGroupCreationDisabled":n=o.get("GroupEditor_FailedCreateGroup_Message_GroupCreationDisabled"),l=o.get("GroupEditor_FailedCreateGroup_Title_GroupCreationDisabled");break;case"ADGraphGroupOperationFailedQuotaExceeded":n=o.get("GroupEditor_FailedCreateGroup_Message_QuotaExceeded"),l=o.get("Alerts_QuotaExceededDialogTitle");break;case"ADGraphGroupOperationFailedPrefixSuffix":n=o.get("GroupEditor_FailedCreateGroup_Message_MissingPrefixSuffix"),l=o.get("GroupEditor_FailedCreateGroup_Title_MissingPrefixSuffix"),c=this.populateDisplayableErrorInfo(s,"SuggestedPropertyValue");break;case"ProPlus_Workspace_Dataflows_NotSupported":n=o.get("GroupEditor_ProPlus_DataflowsNotSupported_Message"),l=o.get("GroupEditor_ProPlus_DataflowsNotSupported_Title");break;case"ProPlus_Workspaces_NotOnboarded":n=o.get("GroupEditor_ProPlus_WorkspacesNotOnboarded_Message"),l=o.get("GroupEditor_ProPlus_WorkspacesNotOnboarded_Title")}n&&l?i.error(n,e,{title:l,requestId:r,statusCode:a.toString(),showAdditionalErrorInfo:0<c.length,displayableErrorInfo:c}):i.error(o.get(t),e,{requestId:r,statusCode:a.toString()})},o.prototype.getCapacityOptionDisplayText=function(e){return this.services.localizationService.format("Capacity_CapacityRegionFormat",[e.name,e.region])},o.prototype.getContactList=function(){if(this.workspacesV2GAFeaturesEnabled)return 0===this.model.notificationTarget?[]:this.model.contactList.inputUserList},o.prototype.isMigratingBetweenRegions=function(t,i){var e=_.find(this.availableCapacities,function(e){return e.id===t}),o=_.find(this.availableCapacities,function(e){return e.id===i});return null==o||null==e||e.region!==o.region},o.prototype.getCapacitySkuTierFromId=function(t){if(t){var e=_.find(this.availableCapacities,function(e){return e.id===t});return e?e.capacitySkuTier:void 0}},o.prototype.populateDisplayableErrorInfo=function(e,t){var i=[],o=e["pbi.error"];return o&&!_.isEmpty(o.parameters)&&((e=_.find(o.parameters,function(e){return e.Key===t}))&&i.push({errorInfoKey:e.Key,errorInfoValue:e.Value}),(e=_.find(o.parameters,function(e){return"PropertyName"===e.Key}))&&i.push({errorInfoKey:e.Key,errorInfoValue:e.Value})),i},o.prototype.convertCapacity=function(e){if(e)return{id:e.capacityObjectId,name:e.displayName,region:e.region,capacitySkuTier:e.capacitySkuTier}},o.prototype.displayValidationErrors=function(e){this.model.invalidEmailAddressesErrorMessage=this.model.emailsList.hasValidationError?this.model.emailsList.errorMessage:"";e=this.arrayStringsToSeparatorTerminatedString(this.contractGroupMembersToArray(e));this.model.notExitingEmailAddressesErrorMessage=_.isEmpty(e)?"":this.services.localizationService.format("GroupEditor_Email_Address_DoNotExist",[e]),this.setEmailsListContent(e)},o.prototype.arrayStringsToSeparatorTerminatedString=function(e){e=e.join(s.constants.emailsListSeparator).toLowerCase();return _.isEmpty(e)||_.endsWith(e,s.constants.emailsListSeparator)||(e+=s.constants.emailsListSeparator),e},o.prototype.convertMemberRole=function(e){switch(e.membershipStatus){case 4:return 2;case 1:return 0;case 3:case 2:return 1;default:return 0}},o.prototype.contractGroupMembersToArray=function(e){return _.map(e,function(e){return e.userPrincipalName.toLowerCase()})},o.prototype.processFolderName=function(){return __awaiter(this,void 0,s.Promise,function(){var t;return __generator(this,function(e){return t=this.model.groupName,this.folderNameResetToOriginal=!_.isEmpty(this.folder)&&this.folder.displayName===t,_.isEmpty(t)||this.folderNameResetToOriginal?(this.latestFolderNameIsValid=!0,this.validatedFolderName=void 0,this.isValidatingFolderName=!1,[2]):[2,this.checkFolderNameAvailability()]})})},o.prototype.checkFolderNameAvailability=function(){return __awaiter(this,void 0,s.Promise,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return this.isValidatingFolderName||this.model.groupName===this.validatedFolderName?[3,2]:(t=this.model.groupName,this.isValidatingFolderName=!0,[4,this.validateFolderName(t)]);case 1:if(e.sent(),this.isValidatingFolderName=!1,t!==this.model.groupName&&!_.isEmpty(t)&&(_.isEmpty(this.folder)||this.folder.displayName!==t))return[2,this.checkFolderNameAvailability()];this.validatedFolderName=t,e.label=2;case 2:return[2]}})})},o.prototype.validateFolderName=function(r){return __awaiter(this,void 0,s.Promise,function(){var t,i,o;return __generator(this,function(e){switch(e.label){case 0:t=this.services,i=t.telemetryService.startEvent(s.telemetry.GroupEditorValidateGroupId),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,t.groupHttp.validateFolderName(r,i.event).toPromise()];case 2:return o=e.sent(),this.latestFolderNameIsValid=o.data,i.resolve(),[3,4];case 3:return o=e.sent(),this.latestFolderNameIsValid=!1,i.reject(a.getTelemetryErrorDetails(o)),[3,4];case 4:return[2]}})})},e.GroupEditorBaseController=o}(s.sidePanes||(s.sidePanes={}))}(powerbi=powerbi||{}),function(l){!function(e){var o,r,t,i;function a(e,t){var i=o.call(this,t)||this;i.scope=e,i.services=t;e=new l.models.Group(null);i.model=new l.models.GroupEditorModel(e,i.services.localizationService),i.model.isAdmin=!0;t=t.featureSwitchService.featureSwitches;return i.isTryingWorkspacesV2Preview=!!t.workspacesV2GA,i.showImproveWorkspaceBanner=!i.isTryingWorkspacesV2Preview,i.showDowngradeWorkspaceBanner=!t.BlockWorkspaceV1Creation&&!t.disableWorkspaceV1CreationEnabled&&i.isTryingWorkspacesV2Preview,i.allowLargeFiles=t.largeFilesUI,i.scope.$watch("this.model.emailsList.emailAddresses",function(e,t){t!==e&&(e||(i.model.invalidEmailAddressesErrorMessage="",i.model.notExitingEmailAddressesErrorMessage=""))},!0),i.loadDataflowsStorageAccounts(),i.processCapacities(),i}e=e.controllers||(e.controllers={}),r=l.errorDetailsHelper,t=l.models.LicenseMode,i=/[^a-zA-Z0-9_-]/g,o=e.GroupEditorBaseController,__extends(a,o),a.createOptions=function(){return{additionalServices:["domainHelperService","errorService","featureSwitchService","groupHttp","folderService","localizationService","navigation","telemetryService","modalDialogService","taskPaneSliderService","tutorialPopup","localStorage","userInfo","licenseHelperService"]}},a.prototype.$onInit=function(){var e=this;this.baseInit(),this.folderNameChanged=_.debounce(function(){e.scope.$evalAsync(function(){e.processFolderName()})},this.folderDisplayNameDebounceInMilliseconds),this.model.isServiceApp=!1},Object.defineProperty(a.prototype,"canSave",{get:function(){return this.isTryingWorkspacesV2Preview?this.model.groupName&&this.latestFolderNameIsValid&&!this.isFindingUsers&&!this.model.contactList.hasValidationError&&!this.model.sharePointStorageList.hasValidationError:this.model.groupName&&this.model.groupId&&0===this.groupValidationStatus&&!this.isValidatingGroupId&&!this.isAddingMembers&&!this.isLoadingGroupMembers&&!this.services.userInfo.isGuestUser},enumerable:!1,configurable:!0}),a.prototype.save=function(){this.isTryingWorkspacesV2Preview?this.createFolder():this.createGroup()},a.prototype.createFolder=function(){return __awaiter(this,void 0,l.Promise,function(){return __generator(this,function(e){switch(e.label){case 0:return this.isSaving=!0,[4,this.checkLicenseForCapacityRequirement()];case 1:return e.sent()?[4,this.createFolderInternal()]:[3,3];case 2:e.sent(),e.label=3;case 3:return this.isSaving=!1,[2]}})})},a.prototype.groupNameKeyUp=function(e){_.isEmpty(this.model.groupName)?(this.isEditingGroupId=!1,this.model.groupId="",this.groupValidationStatus=0):this.isEditingGroupId||(this.model.groupId=this.model.groupName.replace(i,"").toLowerCase(),this.checkGroupIdAvailability())},a.prototype.editGroupId=function(){this.isEditingGroupId=!0},a.prototype.capacityChange=function(){var e;this.model.capacity&&(e=this.model.capacity.id,this.isTryingWorkspacesV2Preview&&this.getCapacityPremiumFileSupport(e))},a.prototype.checkLicenseForCapacityRequirement=function(){var t;return __awaiter(this,void 0,l.Promise,function(){return __generator(this,function(e){switch(e.label){case 0:return 4!==(null===(t=this.model.capacity)||void 0===t?void 0:t.capacitySkuTier)||this.services.userInfo.isProPlusUser?[3,2]:[4,this.services.licenseHelperService.displayFeatureDisabledErrorMessage("CreateGroups",null,null,!0)];case 1:return e.sent(),[2,!1];case 2:return[2,!0]}})})},a.prototype.createFolderInternal=function(){var n;return __awaiter(this,void 0,l.Promise,function(){var t,i,o,r,a,s;return __generator(this,function(e){switch(e.label){case 0:t=this.services,o=this.model,i={displayName:o.groupName,icon:o.iconUrl,description:o.description,capacityObjectId:null===(n=o.capacity)||void 0===n?void 0:n.id,isServiceApp:o.isServiceApp,dataflowsStorageAccountId:this.getDataflowsStorageAccountId(),contacts:this.getContactList(),sharePointStorageGroupObjectId:o.sharePointStorageList.validObjectIds[0],allowContributorUpdateApp:o.allowContributorUpdateApp,datasetStorageMode:o.defaultDatasetStorageFormat},a=t.telemetryService,o=a.startEvent(l.telemetry.GroupEditorCreateGroup,{groupCreated:!1,groupId:"",isReadOnly:!1,adminCount:1,memberCount:0,invitedMemberCount:0,hasCapacity:!!i.capacityObjectId,isServiceApp:i.isServiceApp,capacityId:null==i?void 0:i.capacityObjectId,capcitySkuTier:"",currentLicense:t.userInfo.userLicense()}),e.label=1;case 1:return e.trys.push([1,6,,7]),[4,t.groupHttp.addFolder(i,o.event).toPromise()];case 2:return!(r=e.sent()).data||_.isEmpty(r.data.objectId)?[3,4]:(a=r.data,6!==(s=__assign({},a)).capacitySkuTier&&(s.capacitySkuTier=this.getCapacitySkuTierFromId(a.capacityObjectId)),o.event.info.capacitySkuTier=s.capacitySkuTier,[4,this.performFolderCreatedActivities(s,o)]);case 3:return e.sent(),[3,5];case 4:this.handleErrorOnCreate(r.requestId,r.status,o,r.error),e.label=5;case 5:return[3,7];case 6:return s=e.sent(),this.handleErrorOnCreate(s.requestId,s.status,o,s.error),[3,7];case 7:return[2]}})})},a.prototype.performFolderCreatedActivities=function(i,o){return __awaiter(this,void 0,l.Promise,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return(t=this.services).folderService.addFolder(i),[4,t.navigation.navigateToContentList(i.objectId)];case 1:return e.sent(),this.performAppWorkspaceCreatedActivities(i.objectId,o),[2]}})})},a.prototype.performAppWorkspaceCreatedActivities=function(e,t){var i=this.services,o=t.event.info;o.groupId=e,o.groupCreated=!0,t.resolve(),i.rootScope.$emit(l.constants.groupAddedUpdateContextMenuEventName,e),i.taskPaneSliderService.collapsePane()},a.prototype.handleErrorOnCreate=function(e,t,i,o){i&&i.reject(r.getTelemetryErrorDetails(o,t)),this.showErrorInfo("FailedToCreateGroup","GroupEditor_FailedCreateGroup_Message",this.services.errorService,this.services.localizationService,e,t,o)},a.prototype.createGroup=function(){var i=this,o=this.services;this.isSaving=!0;var e=this.mapFromMemberModelListToMemberContractList(this.model.displayMemberList),e={displayName:this.model.groupName,mailNickname:this.model.groupId,isPublic:0===this.model.privacyOption,isReadOnly:1===this.model.accessControlOption,members:e,capacityObjectId:null===(t=this.model.capacity)||void 0===t?void 0:t.id},t=_.filter(e.members,function(e){return 1!==e.membershipStatus}).length,r=o.telemetryService.startEvent(l.telemetry.GroupEditorCreateGroup,{groupCreated:!1,groupId:"",isReadOnly:e.isReadOnly,adminCount:t,memberCount:e.members.length-t,invitedMemberCount:_.filter(this.model.displayMemberList,function(e){return 2===e.role}).length,hasCapacity:!!e.capacityObjectId,isServiceApp:!1,capacityId:null===(t=this.model.capacity)||void 0===t?void 0:t.id,capcitySkuTier:null===(t=this.model.capacity)||void 0===t?void 0:t.capacitySkuTier.toString(),currentLicense:o.userInfo.userLicense()});o.groupHttp.addGroup(e,r.event).toPromise().then(function(t){return __awaiter(i,void 0,l.Promise,function(){return __generator(this,function(e){switch(e.label){case 0:return _.isEmpty(t.data.group.objectId)?[3,2]:(o.folderService.addGroup(t.data.group),[4,o.navigation.navigateToContentList(t.data.group.objectId)]);case 1:return e.sent(),this.performAppWorkspaceCreatedActivities(t.data.group.objectId,r),[3,3];case 2:this.resetEmailsListControl(t.data.invalidMembers),r.event.info.groupCreated=!1,r.resolve(),e.label=3;case 3:return this.isSaving=!1,[2]}})})},function(e){i.handleErrorOnCreate(e.requestId,e.status,r,e.error),i.isSaving=!1})},a.prototype.hasGroupIdInvalidCharacters=function(){null!==this.model.groupId.match(i)&&(this.groupValidationStatus=3)},a.prototype.groupIdKeyUp=function(){this.groupValidationStatus=0,this.hasGroupIdInvalidCharacters(),3!==this.groupValidationStatus&&this.checkGroupIdAvailability()},a.prototype.toggleFolderModePreview=function(){this.isTryingWorkspacesV2Preview=!this.isTryingWorkspacesV2Preview,this.showImproveWorkspaceBanner=!this.isTryingWorkspacesV2Preview,this.showDowngradeWorkspaceBanner=!this.showDowngradeWorkspaceBanner&&this.services.featureSwitchService.featureSwitches.workspacesV2GA,this.model.licenseMode=t.Pro,this.licenseModeAvailability[t.PPU]=this.model.isAdmin&&0<this.getCapacitiesPerLicenseMode(this.availableCapacities,t.PPU).length,this.updateCapacityList()},a.prototype.onLicenseModeChange=function(){o.prototype.updateCapacityList.call(this)},a.prototype.checkGroupIdAvailability=function(){var e,t,i=this;this.validateGroupIdPromise||_.isEmpty(this.model.groupId)||this.model.groupId===this.validatedGroupId||(e=this.model.groupId,t=function(){i.validateGroupIdPromise=null,i.validatedGroupId=e,i.checkGroupIdAvailability()},this.validateGroupIdPromise=this.validateGroupId(e),this.validateGroupIdPromise.then(t,t))},a.prototype.validateGroupId=function(e){var t=this,i=this.services,o=i.telemetryService.startEvent(l.telemetry.GroupEditorValidateGroupId);this.isValidatingGroupId=!0;e=i.groupHttp.validateGroupId(e,o.event).toPromise();return e.then(function(e){t.groupValidationStatus=e.data?0:1,o.resolve(),t.isValidatingGroupId=!1},function(e){t.groupValidationStatus=2,o.reject(r.getTelemetryErrorDetails(e.error)),t.isValidatingGroupId=!1}),e},a.prototype.processCapacities=function(){return __awaiter(this,void 0,l.Promise,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return[4,this.loadCapacities()];case 1:return e.sent(),_.isEmpty(this.availableCapacities)||(this.updateCapacityList(),t=this.createGroupCapacitySettingsTutorialModel(),this.services.tutorialPopup.startTutorial(t)),[2]}})})},a.prototype.updateCapacityList=function(){var e=this.services.userInfo&&this.services.userInfo.userHasProPlusPlan;this.licenseModeAvailability[t.PPU]&&(this.licenseModeAvailability[t.PPU]=!(!this.isTryingWorkspacesV2Preview||this.services.featureSwitchService.featureSwitches.proPlusExcludePPUCapacityCreateWorkspace)),e&&this.licenseModeAvailability[t.PPU]?this.model.licenseMode=t.PPU:this.licenseModeAvailability[t.Premium]?this.model.licenseMode=t.Premium:this.licenseModeAvailability[t.Embedded]&&(this.model.licenseMode=t.Embedded),o.prototype.updateCapacityList.call(this)},a.prototype.createGroupCapacitySettingsTutorialModel=function(){var e="GroupCapacitySettings",t=this.services.localizationService;return{itemKeys:[e],items:{GroupCapacitySettings:{title:t.get("TutorialPopup_GroupCapacitySettingsTitle"),text:t.get("TutorialPopup_GroupCapacitySettingsText"),buttonLabel:t.get("TutorialPopup_GotIt"),canShow:function(){return 0<$(".advanced").length},attachTo:function(){return $(".advanced")},iconClass:"pbi-glyph-diamond",offset:l.tutorialPopupOffset.groupCapacitySettings,dataStoreKey:e}}}},e.CreateGroupBladeController=a}(l.sidePanes||(l.sidePanes={}))}(powerbi=powerbi||{}),function(e){var t;((t=e.sidePanes||(e.sidePanes={})).components||(t.components={})).CreateGroupBlade={controller:e.common.createController(t.controllers.CreateGroupBladeController),templateUrl:"components/groupEditor/create/createGroupBlade.html"}}(powerbi=powerbi||{}),function(m){!function(e){var o,c,a,d,r;function t(e,t){var i=o.call(this,t)||this;return i.scope=e,i.services=t,i.aboutSwitchTab=0,i.premiumSwitchTab=1,i.byoResourcesSwitchTab=2,i.isCdsaModelsExists=!1,i.showCopySuccess=!1,i.isInstalledServiceAppInstance=!1,i.MessageBannerModulePath="@powerbi/UILibrary/message-banner/message-banner.module#MessageBannerModule",i.adminIconPath=m.getBuild()+"/images/adminWorkspaceIcon.png",i.convertToServiceAppWorkspace=!1,i.ppuLearnMoreLink="https://go.microsoft.com/fwlink/?linkid=2143794",i.messageDialogBuilder=new r(i.services.modalDialogService),i}e=e.controllers||(e.controllers={}),c=m.dataServices.AppUtils,a=m.errorDetailsHelper,d=m.models.LicenseMode,r=m.common.dialog.MessageDialogBuilder,o=e.GroupEditorBaseController,__extends(t,o),t.createOptions=function(){return{additionalServices:["domainHelperService","errorService","lazy","featureSwitchService","groupHttp","folderService","localizationService","navigation","telemetryService","modalDialogService","taskPaneSliderService","tutorialPopup","localStorage","cdsaModelStore","contentPackStore","userInfo","packageService","lazyProviderModern","informationProtectionService","modernDialogService","licenseHelperService"]}},t.prototype.switchTabs=function(e){this.activeTab=e},t.prototype.$onInit=function(){var l;return __awaiter(this,void 0,m.Promise,function(){var t,i,o,r,a,s,n=this;return __generator(this,function(e){switch(e.label){case 0:return(t=this.services,this.folder=this.parameters.group||this.services.folderService.activeFolder,this.model=new m.models.GroupEditorModel(this.folder,this.services.localizationService),this.originalCapacity=this.model.capacity,this.isBYOResourcesActiveTab=null===(l=this.parameters)||void 0===l?void 0:l.isBYOResourcesActiveTab,this.activeTab=this.isBYOResourcesActiveTab?2:0,this.allowLargeFiles=this.services.featureSwitchService.featureSwitches.largeFilesUI,this.scope.$watch("this.model.emailsList.emailAddresses",function(e,t){t!==e&&(e||(n.model.invalidEmailAddressesErrorMessage="",n.model.notExitingEmailAddressesErrorMessage=""))},!0),0!==this.model.privacyOption||this.model.isAdmin||(this.editNonAdmin=!0),this.oldGroupName=this.model.groupName,this.model.isFolder||this.getGroupMembers(),this.model.isServiceAppEnabled=!1,this.services.cdsaModelStore.cdsaModels.subscribe(function(e){n.isCdsaModelsExists=!_.isEmpty(e)}),this.model.isFolder)?(i=this.folder.id,this.loadFolderSettings(this.folder.uniqueId),this.loadDataflowsStorageAccounts(i),(o=c.getServiceAppWorkspacePackageIdByFolderId(i,t.packageService))&&(this.isInstalledServiceAppInstance=!0,t.lazyProviderModern.get("@powerbi/ServiceApps/service-apps.module#ServiceAppsModule","serviceAppsDetailsCacheService").then(function(i){return __awaiter(n,void 0,m.Promise,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return[4,i.getInstalledAppExtendedDetails(o)];case 1:return t=e.sent(),this.appVersion=t.version,this.appName=t.name,[2]}})})})),[3,4]):[3,1];case 1:return r=this.services.localizationService,a=this,(s=t.informationProtectionService.isInformationProtectionFeatureEnabled())?[4,t.informationProtectionService.isWorkspaceArtifactsHasLabel(null,this.folder.uniqueId).toPromise()]:[3,3];case 2:s=e.sent(),e.label=3;case 3:a.showInformationProtectionWarning=s,this.showInformationProtectionWarning&&(this.informationProtectionBannerModel={bannerType:2,iconName:"pbi-glyph-info",message:r.get("Sharing_Workspace_Information_Protection_Warning"),linkDisplayName:r.get("LearnMore"),link:"https://go.microsoft.com/fwlink/?linkid=2128233"}),e.label=4;case 4:return this.loadCapacities(!this.model.isFolder),this.baseInit(),this.folderNameChanged=_.debounce(function(){n.scope.$evalAsync(function(){n.processFolderName()})},this.folderDisplayNameDebounceInMilliseconds),this.showServiceAppCheckbox&&this.setAppSwitchState(),this.advancedButtonArialabel=this.services.localizationService.get("Advanced"),this.deleteButtonAriaLabel=this.services.localizationService.get("Delete"),this.licenseModeAvailability[d.Pro]=this.model.isAdmin,[2]}})})},t.prototype.copyServerUrl=function(){try{var e=$(".groupServerName");m.CopyPasteService.create().copyText(e.val()),this.showCopySuccess=!0}catch(e){}},Object.defineProperty(t.prototype,"canSave",{get:function(){return this.model.isFolder?!this.isLoadingCapacities&&!this.model.contactList.hasValidationError&&!this.model.sharePointStorageList.hasValidationError&&!this.isFindingUsers&&!this.isFindingGroups&&this.latestFolderNameIsValid&&!this.isLoadingDataflowsStorageAccounts:!this.isAddingMembers&&!this.isLoadingGroupMembers&&!this.isLoadingCapacities&&this.latestFolderNameIsValid&&!this.services.userInfo.isGuestUser},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canDelete",{get:function(){return this.latestFolderNameIsValid},enumerable:!1,configurable:!0}),t.prototype.setAppSwitchState=function(){return __awaiter(this,void 0,m.Promise,function(){var t,i;return __generator(this,function(e){switch(e.label){case 0:return this.model.isFolder?(t=this.folder,[4,this.services.lazyProviderModern.get("@powerbi/PublishApp/publish-app.module#PublishAppServiceModule","publishAppService")]):(this.showServiceAppCheckbox=!1,[2]);case 1:return[4,e.sent().loadPublishedApps(t)];case 2:return i=e.sent(),_.isEmpty(i)?(this.model.isServiceApp=!1,this.model.isServiceAppEnabled=!0):(i=_.find(i,function(e){return 8===e.category}),this.model.isServiceApp=!!i,this.model.isServiceAppEnabled=!1),[2]}})})},t.prototype.toggleServiceApp=function(){return __awaiter(this,void 0,m.Promise,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return this.model.isServiceApp?(t=this.services.localizationService,[4,this.messageDialogBuilder.show("PermanentlyConvertFolder",{messageText:t.get("GroupEditor_ServiceAppConfirmation_Body_Line1"),additionalMessageTexts:[t.get("GroupEditor_ServiceAppConfirmation_Body_Line2")],titleText:t.get("GroupEditor_ServiceAppConfirmation_Title"),okButtonText:t.get("GroupEditor_ServiceAppConfirmation_Confirm"),cancelButtonText:t.get("Cancel_ButtonText")})]):[3,2];case 1:return t=e.sent(),this.model.isServiceApp=0===t,this.convertToServiceAppWorkspace=this.model.isServiceApp,[3,3];case 2:this.convertToServiceAppWorkspace=!1,e.label=3;case 3:return[2]}})})},t.prototype.capacityChange=function(){var e;this.model.capacity&&(e=this.model.capacity.id,this.model.isFolder&&this.getCapacityPremiumFileSupport(e))},t.prototype.compareGroupMemberByUserPrincipalName=function(e,t){return e.userPrincipalName>t.userPrincipalName?1:e.userPrincipalName===t.userPrincipalName?0:-1},t.prototype.prepareMemberOperations=function(e,t,i,o){for(var r=this.model.displayMemberList.sort(this.compareGroupMemberByUserPrincipalName),a=this.model.originalDisplayMemberList.sort(this.compareGroupMemberByUserPrincipalName),s=0,n=r.length,l=0,c=a.length;s<n||l<c;){var d=r[s],p=a[l];switch(void 0===d?1:void 0===p?-1:this.compareGroupMemberByUserPrincipalName(d,p)){case-1:e.push(d),s++;break;case 0:s++,l++,1===d.role&&0===p.role?i.push(d):0===d.role&&1===p.role&&o.push(d);break;case 1:t.push(p),l++}}},t.prototype.save=function(){return __awaiter(this,void 0,m.Promise,function(){var t=this;return __generator(this,function(e){switch(e.label){case 0:return this.model.isFolder?[4,this.saveWorkspace(function(){return t.saveFolder()})]:[3,2];case 1:return e.sent(),[3,3];case 2:this.saveWorkspace(function(){return t.saveGroupInternal()}),e.label=3;case 3:return[2]}})})},t.prototype.saveFolder=function(){var g;return __awaiter(this,void 0,m.Promise,function(){var t,i,o,r,a,s,n,l,c,d,p,u,h=this;return __generator(this,function(e){switch(e.label){case 0:return(this.isSaving=!0,t=this.model,i=this.folder,o=i.uniqueId,d=this.model.sharePointStorageList,r={displayName:t.groupName,description:t.description,capacityObjectId:this.getCapacityValue(t),icon:this.getIconValue(t),isServiceApp:t.isServiceApp,dataflowsStorageAccountId:this.getDataflowsStorageAccountId(),contacts:this.getContactList(),sharePointStorageGroupObjectId:d.validObjectIds?this.model.sharePointStorageList.validObjectIds[0]:void 0,allowContributorUpdateApp:t.allowContributorUpdateApp,datasetStorageMode:t.defaultDatasetStorageFormat},a=this.model.capacity&&_.find(this.availableCapacities,function(e){return e.id===h.model.capacity.id}),u=4===(null==a?void 0:a.capacitySkuTier),l=!this.originalCapacity,s=this.originalCapacity&&_.find(this.availableCapacities,function(e){return e.id===h.originalCapacity.id}),c=4!==(null==s?void 0:s.capacitySkuTier),p=!!this.services.featureSwitchService.featureSwitches.proPlusServicePlan&&!!this.services.userInfo.isProPlusUser,d=!this.services.featureSwitchService.featureSwitches.disablePPUConfirmationDialog,n=this.services.telemetryService.startEvent(m.telemetry.GroupEditorUpdateGroup,{groupUpdated:!1,groupId:o,isGroupReadOnly:!1,adminCount:1,memberCount:0,invitedMemberCount:0,capacityChanged:!1,isServiceApp:r.isServiceApp,currentLicense:this.services.userInfo.userLicense(),previousCapacityId:null==s?void 0:s.id,previousCapacitySkuTier:null===(g=null==s?void 0:s.capacitySkuTier)||void 0===g?void 0:g.toString(),newCapacityId:null==a?void 0:a.id,newCapacitySkuTier:null===(g=null==a?void 0:a.capacitySkuTier)||void 0===g?void 0:g.toString(),isProPlusUser:!!this.services.userInfo.isProPlusUser}),u&&(l||c)&&d)?p?(u=this.services.localizationService,l=u.get("GroupEditor_LoseAccessTitle"),c=u.get("GroupEditor_ConfirmChangeToPPUText"),d=u.get("ModalDialogButtonText_Continue"),p=function(){h.saveFolderInternal(o,r,i,t,n)},u={url:this.ppuLearnMoreLink,text:"Generic_LearnMore"},[4,this.createConfirmationDialogWithIcon(l,c,d,p,u,"pbi-glyph-error-circle-exclamation glyph-mini")]):[3,2]:[3,5];case 1:return 2===e.sent()&&(this.model.capacity=this.originalCapacity),[3,4];case 2:return this.model.capacity=this.originalCapacity,n.resolve(),[4,this.services.licenseHelperService.displayFeatureDisabledErrorMessage("SwitchGroups",null,null,!0)];case 3:e.sent(),e.label=4;case 4:return[3,6];case 5:this.saveFolderInternal(o,r,i,t,n),e.label=6;case 6:return[2]}})})},t.prototype.createConfirmationDialogWithIcon=function(t,i,o,r,a,s){return __awaiter(this,void 0,m.Promise,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,this.services.modernDialogService.promptSimpleConfirmationDialog(t,i,o,r,{minWidth:750,maxWidth:750},a,s)];case 1:return[2,e.sent()]}})})},t.prototype.saveFolderInternal=function(i,o,r,a,s){return __awaiter(this,void 0,m.Promise,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,3,4]),[4,this.services.groupHttp.updateFolder(i,o,s.event).toPromise()];case 1:return 204===(t=e.sent()).status||200===t.status?(r.description=a.description,r.displayName=a.groupName,r.icon=a.iconUrl,r.capacity=a.capacity,this.updateFolderCapacity(o,t.data),s.event.info.groupUpdated=!0,s.event.info.capacityChanged=!0,this.services.taskPaneSliderService.collapsePane(),t.data&&(this.services.folderService.updateFolders([t.data]),this.convertToServiceAppWorkspace&&this.services.contentPackStore.loadContentPackForSelectedGroup())):(s.event.info.groupUpdated=!1,this.handleErrorOnUpdate(t.requestId,t.status,s,t.error)),s.resolve(),[3,4];case 2:return t=e.sent(),this.handleErrorOnUpdate(t.requestId,t.status,s,t.error),[3,4];case 3:return this.isSaving=!1,[7];case 4:return[2]}})})},t.prototype.updateFolderCapacity=function(e,t){var i=this.folder.contract;t&&6===t.capacitySkuTier?(i.capacityObjectId=t.capacityObjectId,i.capacitySkuTier=t.capacitySkuTier):(t=this.model.capacity,e=""===e.capacityObjectId?void 0:t&&t.id,(i.capacityObjectId=e)?(i.capacityName=t.name,i.capacitySkuTier=t.capacitySkuTier):i.capacitySkuTier=void 0)},t.prototype.getCapacityValue=function(e){var t,i=this.folder.contract,o=e.capacity,o=o&&o.id,i=i&&i.capacityObjectId;return i&&!e.isCapacityEnabled?t="":i!==o&&(t=o),t},t.prototype.getIconValue=function(e){if(e.iconUpdated)return e.iconUrl||""},t.prototype.getFolderSettings=function(o){return __awaiter(this,void 0,m.Promise,function(){var t,i;return __generator(this,function(e){switch(e.label){case 0:return t=this.services.telemetryService.startEvent(m.telemetry.GroupEditorGetFolderSettings,{folderGUID:o}),[4,this.services.groupHttp.getFolderSettings(o,t.event).toPromise()];case 1:return i=e.sent(),t.resolve(),[2,i.data]}})})},t.prototype.handleErrorOnUpdate=function(e,t,i,o){i&&i.reject(a.getTelemetryErrorDetails(o,t)),this.showErrorInfo("FailedToUpdateGroup","GroupEditor_FailedUpdateGroup_Message",this.services.errorService,this.services.localizationService,e,t,o)},t.prototype.loadFolderSettings=function(i){return __awaiter(this,void 0,m.Promise,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return[4,this.getFolderSettings(i)];case 1:return t=e.sent(),this.model.contactList.inputUserList=t.contacts,this.model.isUpgradedFromV1Workspace=t.isUpgradedFromV1Workspace,this.model.notificationTarget=_.isEmpty(t.contacts)?0:1,this.model.defaultDatasetStorageFormat=null==t.defaultDatasetStorageMode?1:t.defaultDatasetStorageMode,t=t.sharePointStorage,this.model.sharePointStorageList.inputUserList=this.getADUserMetadataFromSharePointStorage(t),t&&(this.model.sharePointStorageList.validObjectIds=[t.groupObjectId]),[2]}})})},t.prototype.getADUserMetadataFromSharePointStorage=function(e){return e&&e.groupObjectId?[{displayName:e.groupDisplayName,objectId:e.groupObjectId,userPrincipalName:void 0,isSecurityGroup:!1,objectType:2,groupType:4,aadAppId:null}]:[]},t.prototype.saveWorkspace=function(l){return __awaiter(this,void 0,m.Promise,function(){var t,i,o,r,a,s,n;return __generator(this,function(e){switch(e.label){case 0:return!this.originalCapacity||6!==this.originalCapacity.capacitySkuTier||this.model.isCapacityEnabled?[3,1]:(l(),[3,6]);case 1:return!this.originalCapacity||this.model.isCapacityEnabled?[3,3]:(t=this.services.localizationService,i=t.get("GroupEditor_ConfirmRemoveCapacityTitle"),o=t.get("GroupEditor_ConfirmRemoveCapacityText"),r=t.get("GroupEditor_ConfirmRemoveCapacityButton"),a=function(){l()},s={url:"https://go.microsoft.com/fwlink/?linkid=845343",text:"Generic_LearnMore"},n="pbi-glyph-warning glyph-medium",[4,this.createConfirmationDialogWithIcon(i,o,r,a,s,n)]);case 2:return 2===e.sent()&&(this.model.capacity=this.originalCapacity),[3,6];case 3:return this.originalCapacity&&this.model.isCapacityEnabled&&this.isMigratingBetweenRegions(this.originalCapacity.id,this.model.capacity.id)?(t=this.services.localizationService,i=t.get("GroupEditor_ConfirmMoveCapacityTitle"),o=t.get("GroupEditor_ConfirmMoveCapacityText"),r=t.get("GroupEditor_ConfirmMoveCapacityButton"),a=function(){l()},s={url:"https://go.microsoft.com/fwlink/?linkid=845343",text:"Generic_LearnMore"},n="pbi-glyph-warning glyph-medium",[4,this.createConfirmationDialogWithIcon(i,o,r,a,s,n)]):[3,5];case 4:return 2===e.sent()&&(this.model.capacity=this.originalCapacity),[3,6];case 5:l(),e.label=6;case 6:return[2]}})})},t.prototype.saveGroupInternal=function(){var r=this;if(this.isSaving=!0,0===_.filter(this.model.displayMemberList,function(e){return 1===e.role}).length){var i=this.services.errorService.control();return i.showPrompt("",this.services.localizationService.get("GroupEditor_TheOnlyAdmin_Message"),[new InJs.ModalDialogAction(this.services.localizationService.get("ModalDialogButtonText_Ok"),function(e,t){i.hideDialog()})]),void(this.isSaving=!1)}var e=[],a=[],t=[],o=[];this.prepareMemberOperations(e,a,t,o);var s={displayName:this.oldGroupName!==this.model.groupName?this.model.groupName:"",isReadOnly:this.model.accessControlOption===this.originalAccessControlOption?null:1===this.model.accessControlOption,capacityObjectId:this.model.capacity&&this.model.isCapacityEnabled?this.model.capacity.id:null},n=_.filter(this.model.displayMemberList,function(e){return 1===e.role}).length,l=this.services.telemetryService.startEvent(m.telemetry.GroupEditorUpdateGroup,{groupUpdated:!1,groupId:this.folder.contract.objectId,isGroupReadOnly:s.isReadOnly,adminCount:n,memberCount:this.model.displayMemberList.length-n,invitedMemberCount:_.filter(this.model.displayMemberList,function(e){return 2===e.role}).length,capacityChanged:!1,isServiceApp:!1,currentLicense:this.services.userInfo.userLicense(),previousCapacityId:null===(n=this.originalCapacity)||void 0===n?void 0:n.id,previousCapacitySkuTier:null===(n=null===(n=this.originalCapacity)||void 0===n?void 0:n.capacitySkuTier)||void 0===n?void 0:n.toString(),newCapacityId:null===(n=this.model.capacity)||void 0===n?void 0:n.id,newCapacitySkuTier:null===(n=null===(n=this.model.capacity)||void 0===n?void 0:n.capacitySkuTier)||void 0===n?void 0:n.toString(),isProPlusUser:!!this.services.userInfo.isProPlusUser});this.services.groupHttp.updateGroup(this.folder.uniqueId,s,this.mapFromMemberModelListToMemberContractList(e),this.mapFromMemberModelListToMemberContractList(a),this.mapFromMemberModelListToMemberContractList(t),this.mapFromMemberModelListToMemberContractList(o),l.event).toPromise().then(function(e){var t,i,o=_.filter(e.data,function(e){return 4!==e.membershipStatus});o&&0===o.length?(r.folder.displayName=r.model.groupName,r.folder.capacity=r.model.capacity,(t=r.folder.contract).isReadOnly=1===r.model.accessControlOption,t.capacityObjectId=r.model.capacity&&r.model.capacity.id,t.capacityName=r.model.capacity&&r.model.capacity.name,e=r.services.folderService,i=m.session.UserInfoUtils.getEmailAddressForReceivingMail(),0<_.filter(a,function(e){return e.userPrincipalName&&i&&e.userPrincipalName.toLowerCase()===i.toLowerCase()}).length&&(e.removeGroup(r.folder.uniqueId),e.activeFolderObjectId===r.folder.uniqueId&&r.services.navigation.navigateToGroupByGUID(m.constants.myWorkSpaceFolderId)),t.displayName=r.folder.displayName,e.updateGroupInStore(r.folder.contract),l.event.info.groupUpdated=!0,l.event.info.capacityChanged=r.originalCapacity!==r.model.capacity,l.resolve(),r.services.taskPaneSliderService.collapsePane()):(l.event.info.groupUpdated=!1,l.resolve(),r.resetEmailsListControl(o))},function(e){r.handleErrorOnUpdate(e.requestId,e.status,l,e.error),r.isSaving=!1})},t.prototype.delete=function(){return __awaiter(this,void 0,m.Promise,function(){var t,i,o,r,a,s,n=this;return __generator(this,function(e){switch(e.label){case 0:return t=this.services.localizationService,i=this.services.errorService.control(),a=this.folder,[4,this.services.lazyProviderModern.get("@powerbi/PublishApp/publish-app.module#PublishAppServiceModule","publishAppService")];case 1:return[4,e.sent().loadPublishedApps(a)];case 2:return s=e.sent(),s=_.find(s,function(e){return 8===e.category}),s=s&&!_.isEmpty(s.providerContract.serviceApp.appPackages),s=s?(o=[new InJs.ModalDialogAction(t.get("ModalDialogButtonText_Cancel"),function(e,t){i.hideDialog()})],r=this.services.localizationService.get("GroupEditor_CannotDeleteServiceAppsGroup_Title"),this.services.localizationService.get("GroupEditor_CannotDeleteServiceAppsGroup_Message")):(o=[new InJs.ModalDialogAction(t.get("Delete"),function(e,t){n.deleteInternal(),i.hideDialog()}),new InJs.ModalDialogAction(t.get("ModalDialogButtonText_Cancel"),function(e,t){i.hideDialog()})],r=this.services.localizationService.get("GroupEditor_AreYouSureYouWantToDeleteGroup_Title"),this.services.localizationService.get("GroupEditor_AreYouSureYouWantToDeleteGroup_Message")),i.showCustomDialog(r,$("<div></div>").text(s),o,function(e){e.parent().find('input[value="'+n.services.localizationService.get("ModalDialogButtonText_Cancel")+'"]').focus()},!0),[2]}})})},t.prototype.deleteInternal=function(){return __awaiter(this,void 0,m.Promise,function(){var t,i,o,r;return __generator(this,function(e){switch(e.label){case 0:return t=this.services,r=t.telemetryService,i=r.startEvent(m.telemetry.GroupEditorDeleteGroup),o=t.errorService.control(),r=t.rootScope.$new(),r={dialogName:null,scope:r,template:'<spinner></spinner><span localize="GroupEditor_WaitDeleteGroup"></span>',containerCssClass:"deleteGroup",isDismissable:!1},t.modalDialogService.showLegacyWebModalDialog(r),this.model.isFolder?[4,this.executeDelete(o,i,204,function(e){return t.groupHttp.deleteFolder(e,i.event).toPromise()},function(e){return t.folderService.removeFolder(e)})]:[3,2];case 1:return e.sent(),[3,4];case 2:return[4,this.executeDelete(o,i,200,function(e){return t.groupHttp.deleteGroup(e,i.event).toPromise()},function(e){return t.folderService.removeGroup(e)})];case 3:e.sent(),e.label=4;case 4:return[2]}})})},t.prototype.executeDelete=function(r,a,s,n,l){return __awaiter(this,void 0,m.Promise,function(){var t,i,o;return __generator(this,function(e){switch(e.label){case 0:t=this.folder.uniqueId,e.label=1;case 1:return e.trys.push([1,3,,4]),[4,n(t)];case 2:return(o=e.sent()).status===s?(a.resolve(),this.handleDeleteSuccess(t,r,a,l)):(i=o.error,this.handleDeleteFailure(i,o.requestId,o.status,a,r)),[3,4];case 3:return o=e.sent(),this.handleDeleteFailure(o.error,o.requestId,o.status,a,r),[3,4];case 4:return[2]}})})},t.prototype.handleDeleteFailure=function(e,t,i,o,r){o.reject(a.getTelemetryErrorDetails(e,i)),r.hideDialog();i="ALM_InvalidRequest_CannotDisableFoldersThatAreConnectedToAnyALMPipeline",r={requestId:t,statusCode:status&&status.toString(),title:void 0};e.code===i&&(r={requestId:t,statusCode:status&&status.toString(),title:this.services.localizationService.get("GroupEditor_CannotDeleteServiceAppsGroup_Title")});i=e.code===i?"Pipelines_Error_DeleteFolderThatIsAssighedToSlot_Message":"GroupEditor_FailedDeleteGroup_Message";this.services.errorService.error(this.services.localizationService.get(i),"FailedToDeleteGroup",r)},t.prototype.handleDeleteSuccess=function(e,t,i,o){t.hideDialog(),i.resolve(),this.services.taskPaneSliderService.collapsePane(),o(e),this.services.folderService.activeFolderObjectId===e&&this.services.navigation.navigateToGroupByGUID(m.constants.myWorkSpaceFolderId)},e.EditGroupBladeController=t}(m.sidePanes||(m.sidePanes={}))}(powerbi=powerbi||{}),function(e){var t;((t=e.sidePanes||(e.sidePanes={})).components||(t.components={})).EditGroupBlade={controller:e.common.createController(t.controllers.EditGroupBladeController),bindings:{parameters:"<"},templateUrl:"components/groupEditor/edit/editGroupBlade.html"}}(powerbi=powerbi||{}),function(l){var e;(function(e){var a=l.errorDetailsHelper,t=l.common.contracts.FolderType,i=(o.createOptions=function(){return{additionalServices:["domainHelperService","errorService","featureSwitchService","groupHttp","folderService","localizationService","navigation","telemetryService","modalDialogService","taskPaneSliderService","tutorialPopup"]}},o.prototype.$onInit=function(){this.onInitHook()},o.prototype.canEditCapacity=function(e){return this.core.canEditCapacity(e)},Object.defineProperty(o.prototype,"canSave",{get:function(){return this.core.canSave},enumerable:!1,configurable:!0}),o.prototype.cancel=function(){this.core.cancel()},Object.defineProperty(o.prototype,"capacitiesList",{get:function(){return this.core.capacitiesList},enumerable:!1,configurable:!0}),o.prototype.getCapacityOptionDisplayText=function(e){return this.core.getCapacityOptionDisplayText(e)},Object.defineProperty(o.prototype,"getEmbeddedToolTipConfig",{get:function(){return this.core.getEmbeddedToolTipConfig()},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"getInCapacityMessage",{get:function(){return this.core.getInCapacityMessage()},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"getLicenseModeToolTipConfig",{get:function(){return this.core.getLicenseModeToolTipConfig()},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"getMyFolderProToolTipConfig",{get:function(){return this.core.getMyFolderProToolTipConfig()},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"isLoadingCapacities",{get:function(){return this.core.isLoadingCapacities},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"isMyFolder",{get:function(){return this.core.isMyFolder},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"isSaving",{get:function(){return this.core.isSaving},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"licenseModeAvailability",{get:function(){return this.core.licenseModeAvailability},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"model",{get:function(){return this.core.model},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"myFolderPPU",{get:function(){return this.core.myFolderPPU},enumerable:!1,configurable:!0}),o.prototype.onInitHook=function(){this.core.onInitHook()},Object.defineProperty(o.prototype,"parameters",{get:function(){return this.core.parameters},set:function(e){this.core.parameters=e},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"restrictMyFolderCapacityEnabled",{get:function(){return this.core.restrictMyFolderCapacityEnabled},enumerable:!1,configurable:!0}),o.prototype.save=function(){this.core.save()},o.prototype.updateCapacityList=function(e){this.core.updateCapacityList(e=void 0===e?!0:e)},o);function o(t,e){this.core=new s(e,function(e){t.$applyAsync(function(){e()})})}e.EditMyWorkspaceBladeController=i;var r,s=(r=e.GroupEditorBaseController,__extends(n,r),n.prototype.onInitHook=function(){this.folder=this.parameters.group,this.model=new l.models.GroupEditorModel(this.folder,this.services.localizationService),this.restrictMyFolderCapacityEnabled=this.services.featureSwitchService.featureSwitches.restrictMyFolderCapacityEnabled,this.originalCapacity=this.model.capacity,this.myFolderPPU=this.services.featureSwitchService.featureSwitches.myFolderPPU,this.loadCapacitiespromise=this.loadCapacities(!this.isMyFolder),this.baseInit()},Object.defineProperty(n.prototype,"canSave",{get:function(){return!this.isLoadingCapacities},enumerable:!1,configurable:!0}),n.prototype.getMyFolderProToolTipConfig=function(){return{tooltipArrowPosition:l.common.ArrowPosition.arrowBottomRight,tooltipShowOnFocus:!0,tooltipDescription:this.services.localizationService.get("Workspace_LicenseMode_Pro_Information"),tooltipHyperlinkText:this.services.localizationService.get("Generic_LearnMore"),tooltipHyperlinkUrl:"https://aka.ms/RestrictMyFolderCapacity"}},n.prototype.save=function(){var t,i,o,r,e,a,s,n,l=this;this.originalCapacity&&6===this.originalCapacity.capacitySkuTier&&!this.model.isCapacityEnabled?this.saveInternal():this.originalCapacity&&!this.model.isCapacityEnabled?(t=this.services.localizationService,i=this.services.errorService.control(),e=[new InJs.ModalDialogAction(t.get("GroupEditor_ConfirmRemoveCapacityButton"),function(e,t){l.saveInternal(),i.hideDialog()}),new InJs.ModalDialogAction(t.get("ModalDialogButtonText_Cancel"),function(e,t){l.onCancelCapacityPrompt(function(){l.model.capacity=l.originalCapacity,i.hideDialog()})})],a=t.get("GroupEditor_ConfirmRemoveCapacityTitle"),s="<div>"+t.get("GroupEditor_ConfirmRemoveCapacityText")+' <a href="https://go.microsoft.com/fwlink/?linkid=845343" target="_blank">'+t.get("Generic_LearnMore")+"</a></div>",n=$(s),i.showCustomDialog(a,n,e,function(e){e.parent().find('input[value="'+t.get("ModalDialogButtonText_Cancel")+'"]').focus()},!0)):this.originalCapacity&&this.model.isCapacityEnabled&&this.isMigratingBetweenRegions(this.originalCapacity.id,this.model.capacity.id)?(o=this.services.localizationService,r=this.services.errorService.control(),e=[new InJs.ModalDialogAction(o.get("GroupEditor_ConfirmMoveCapacityButton"),function(e,t){l.saveInternal(),r.hideDialog()}),new InJs.ModalDialogAction(o.get("ModalDialogButtonText_Cancel"),function(e,t){l.onCancelCapacityPrompt(function(){l.model.capacity=l.originalCapacity,r.hideDialog()})})],a=o.get("GroupEditor_ConfirmMoveCapacityTitle"),s="<div>"+o.get("GroupEditor_ConfirmMoveCapacityText")+' <a href="https://go.microsoft.com/fwlink/?linkid=845343" target="_blank">'+o.get("Generic_LearnMore")+"</a></div>",n=$(s),r.showCustomDialog(a,n,e,function(e){e.parent().find('input[value="'+o.get("ModalDialogButtonText_Cancel")+'"]').focus()},!0)):this.saveInternal()},Object.defineProperty(n.prototype,"isMyFolder",{get:function(){return this.folder.folderType===t.MyFolder},enumerable:!1,configurable:!0}),n.prototype.saveInternal=function(){return __awaiter(this,void 0,l.Promise,function(){var t,i,o,r;return __generator(this,function(e){switch(e.label){case 0:this.isSaving=!0,r=this.services.telemetryService,t=this.isMyFolder,i=r.startEvent(l.telemetry.GroupEditorUpdateMyWorkspace,{myWorkspaceId:this.folder.workspaceId,capacityEnabled:!!this.model.capacity}),o=t?{FolderObjectIds:[this.services.folderService.myFolderObjectId],TargetCapacityObjectId:this.model.isCapacityEnabled?this.model.capacity.id:void 0,TenantObjectId:window.tenantId}:{WorkspaceObjectIds:[this.folder.workspaceId],TargetCapacityObjectId:this.model.isCapacityEnabled?this.model.capacity.id:void 0,TenantObjectId:window.tenantId},e.label=1;case 1:return e.trys.push([1,3,4,5]),[4,this.services.groupHttp.updateMyWorkspace(o).toPromise()];case 2:return e.sent(),t?this.services.folderService.folders[0].capacity=this.model.capacity:this.services.folderService.groups[0].capacity=this.model.capacity,this.folder.capacity=this.model.capacity,this.folder.contract.capacityObjectId=this.model.capacity&&this.model.capacity.id,this.folder.contract.capacityName=this.model.capacity&&this.model.capacity.name,i.event.info.groupUpdated=!0,i.resolve(),this.services.taskPaneSliderService.collapsePane(),[3,5];case 3:return r=e.sent(),i.reject(a.getTelemetryErrorDetails(r.error,r.status)),this.services.errorService.error(this.services.localizationService.get("GroupEditor_FailedUpdateGroup_Message"),"FailedToUpdateGroup",{requestId:r.requestId,statusCode:r.status.toString()}),[3,5];case 4:return this.isSaving=!1,[7];case 5:return[2]}})})},n);function n(e,t){var i=r.call(this,e)||this;return i.services=e,i.onCancelCapacityPrompt=t,i.myFolderPPU=!1,i}e.EditMyWorkspaceBladeCore=s})((e=l.sidePanes||(l.sidePanes={})).controllers||(e.controllers={}))}(powerbi=powerbi||{}),function(i){!function(e){var o;function t(e,t){var i=o.call(this,t)||this;return i.services=t,i.showCopySuccess=!1,i}e=e.controllers||(e.controllers={}),o=e.GroupEditorBaseController,__extends(t,o),t.createOptions=function(){return{additionalServices:["errorService","featureSwitchService","groupHttp","folderService","localizationService","telemetryService","taskPaneSliderService"]}},t.prototype.$onInit=function(){this.folder=this.parameters.group||this.services.folderService.activeFolder,this.model=new i.models.GroupEditorModel(this.folder,this.services.localizationService),this.showCopySuccess=!1,this.getGroupMembers()},t.prototype.copyServerUrl=function(){try{var e=$(".groupServerName");i.CopyPasteService.create().copyText(e.val()),this.showCopySuccess=!0}catch(e){}},e.ViewGroupBladeController=t}(i.sidePanes||(i.sidePanes={}))}(powerbi=powerbi||{}),function(e){var t;((t=e.sidePanes||(e.sidePanes={})).components||(t.components={})).ViewGroupBlade={controller:e.common.createController(t.controllers.ViewGroupBladeController),bindings:{parameters:"<"},templateUrl:"components/groupEditor/view/viewGroupBlade.html"}}(powerbi=powerbi||{}),function(d){!function(e){var s,i,t,b,y,o,a,n,r,l;function c(e,t){this.scope=e,this.services=t,this.isLabelAssignedByDefaultPolicy=!1,this.modelRenameError=!1,this.setArtifactEndorsementModulePath="@powerbi/SettingsBlade/settings-blade.module#SettingsBladeModule",this.setArtifactEndorsementComponentId="SetArtifactEndorsementComponentId",this.iconUrl="",this.iconUpdatedBool=!1,this.iconConfiguration={controlOrientation:1,previewType:1,showDefaultIcon:!1,imageMaxHeight:"143px",imageMaxWidth:"250px"},this.defaultSnapshot="",this.MessageBannerModulePath="@powerbi/UILibrary/message-banner/message-banner.module#MessageBannerModule",this.cdsaModelStore=t.cdsaModelStore,this.settingsBladeModulePath="@powerbi/SettingsBlade/settings-blade.module#SettingsBladeModule",this.setArtifactLabelComponentId="SetArtifactLabelComponentId",this.settingsWorkbookBladeComponentId="SettingsWorkbookBladeComponentId",this.settingsDashboardBladeComponentId="SettingsDashboardBladeComponentId",this.sensitivityLabelRequiredBannerModel={bannerType:1,iconName:"pbi-glyph-blocked2",message:"",linkDisplayName:this.services.localizationService.get("LearnMore"),link:"https://go.microsoft.com/fwlink/?linkid=2128233"},this.sensitivityLabelRequiredTooltipConfig={tooltipLocalizeDescription:"EimInformationProtection_Mandatory_DisabledSaveButton_Tooltip",tooltipArrowPosition:d.common.ArrowPosition.arrowBottomMiddle,tooltipDisable:!0,tooltipDelay:100},this.isSensitivityLabelMissing=!1}e=e.controllers||(e.controllers={}),s=d.common.contracts.ArtifactType,i=d.common.models.EmailsListModel,t=d.helpers.EmailValidationHelper,b=d.explore.util.ExplorationUtil,y=d.explore.contracts.OriginalExploration,o=d.common.helpers.UserInfoHelper,a=d.session.UserInfoUtils,n=d.sidePanes.utilities,r=jsCommon.EnumExtensions,l=d.common.constants.isScorecardPackage,c.createOptions=function(){return{additionalServices:["localizationService","settingsMetadataService","modelService","cdsaModelStore","dashboardDataService","workbookService","taskPaneSliderService","usageMetricsReport","featureSwitchService","activeFolderId","userInfo","lazy","$rootScope","errorService","explorationProxy","explorationSerializer","folderService","lazyProviderModern","promiseFactory","licenseEnforcementService","domainHelperService","informationProtectionService","promotedContentService","telemetryService","moduleLoader","artifactEndorsementService","permissionService","modernDialogService","reportStore","shellCapabilities","reportModelConverter","packageStore"]}},c.prototype.$onInit=function(){return __awaiter(this,void 0,d.Promise,function(){var t,i=this;return __generator(this,function(e){switch(e.label){case 0:return this.isPromoted=!1,this.originalIsPromoted=!1,this.settingsType=this.services.settingsMetadataService.getSettingsType(),this.readOnly=!1,this.artifactObjectId=this.services.settingsMetadataService.getArtifactObjectId(),this.artifactId=this.services.settingsMetadataService.getArtifactId(),this.isSaving=!1,this.isWorkbook=!1,this.isDataflow=!1,this.scope.$on(d.constants.hideTaskPaneSliderOnClickEventName,function(e){return i.cancel()}),[4,this.prepareToPopulateSettings()];case 1:return e.sent(),this.noneLabelId=this.services.informationProtectionService.getEmptyLabel().labelId,this.onDisplayNameChanged=_.debounce(function(e){return i.checkModelDisplayName(e)},150),2!==this.settingsType?[3,5]:[4,this.loadReportSettings()];case 2:return e.sent(),this.shouldShowContacts=this.contactListFeatureSwitchOn()&&(!this.services.folderService.isMyWorkspace()||!!this.hasFolderId),this.loadSnapshotsForReport(),this.isRdlReport()?[2]:[4,this.services.explorationProxy.get({id:this.reportId})];case 3:return t=e.sent(),this.exploration=t.exploration,this.originalExploration=new y(t.wireContractJSON),t=t.exploration.settings,this.isPersistentUserStateDisabled=t&&t.isPersistentUserStateDisabled,this.showPagesOnBottom=1===(t&&t.pagesPosition),this.hideVisualContainerHeader=t&&t.hideVisualContainerHeader,this.useStylableVisualContainerHeader=t&&t.useStylableVisualContainerHeader,this.defaultFilterActionIsDataFilter=t&&t.defaultFilterActionIsDataFilter,this.allowChangeFilterType=t&&t.allowChangeFilterTypes,this.enableFilterPaneSearch=!(t&&t.disableFilterPaneSearch),this.useCrossReportDrillthrough=t&&t.useCrossReportDrillthrough,this.allowInlineExploration=t&&t.allowInlineExploration,this.useEnhancedTooltips=t&&t.useEnhancedTooltips,this.useDefaultAggregateDisplayName=t&&t.useDefaultAggregateDisplayName,this.exportModeOptions=[{id:1,name:this.services.localizationService.get("ModalDialog_ExportDataSummarizedAndDataCurrentLayout")},{id:0,name:this.services.localizationService.get("SettingsBlade_ExportDataOptionsSummarizedAndUnderlying")},{id:2,name:this.services.localizationService.get("None")}],this.exportDataMode=t&&t.exportDataMode,this.isReportAnnotationsEnabled=!(t&&t.isReportAnnotationsDisabled),this.allowAutomatedInsightsNotification=this.allowAutomatedInsightsNotificationInitialValue(t),void 0===this.exportDataMode&&(this.exportDataMode=0),this.isExportDataModeChanged=!1,[4,this.services.shellCapabilities.ensureCapabilitiesInitialized()];case 4:e.sent(),this.isFluentUIEnabled=!!this.services.shellCapabilities.getCapabilities().showFluentUI,e.label=5;case 5:return[2]}})})},c.prototype.$postLink=function(){window.setTimeout(function(){angular.element(document.getElementsByClassName("nameInput")).focus()},100)},c.prototype.prepareToPopulateSettings=function(){return __awaiter(this,void 0,d.Promise,function(){var t,i,o,r;return __generator(this,function(e){switch(e.label){case 0:switch(this.settingsType){case 1:return[3,1];case 2:return[3,4];case 3:return[3,7];case 4:return[3,9];case 5:return[3,11]}return[3,12];case 1:return[4,this.services.dashboardDataService.getDashboards()];case 2:return e.sent(),t=this.services.dashboardDataService.findDashboardByGUID(this.artifactObjectId),this.artifactLabel=this.services.localizationService.get("SettingsBlade_DashboardName"),this.artifact=t,this.isSettingsPane=!0,this.populateDisplayName(t.displayName,!1),this.sensitivityLabelRequiredBannerModel.message=this.services.localizationService.get("EimInformationProtection_Mandatory_DisabledSaveButton_Banner_Dashboard"),this.initSettingDashboardBladeComponent(),[4,this.services.userInfo.userMetadataPromise];case 3:return e.sent(),this.ownerInfo=t.ownerFullname,this.ownerMail=t.ownerMail,t.ownerFullname,[3,12];case 4:return[4,this.getReportByGUID(this.artifactObjectId)];case 5:return o=e.sent(),i=this.isRdlReport()?s.RdlReport:s.Report,this.isScorecardReport=this.getIsScorecardReport(o.packageId),this.artifactLabel=this.services.localizationService.get(this.isScorecardReport?"ScorecardDialog_Name":"ReportName"),this.artifact=o,this.isSettingsPane=!1,this.populateDisplayName(o.displayName,!1),this.initSetArtifactLabelComponent(o.id,o.displayName,this.services.folderService.activeFolder.displayName),this.initSetArtifactEndorsement(o.id,o.objectId),this.sensitivityLabelRequiredBannerModel.message=this.services.localizationService.get("EimInformationProtection_Mandatory_DisabledSaveButton_Banner_Report"),[4,(o=this).services.informationProtectionService.isLabelingRequired(i).toPromise()];case 6:return o.isSensitivityLabelingRequired=e.sent(),[3,12];case 7:return[4,this.services.workbookService.ensureWorkbookInitialization()];case 8:return e.sent(),r=this.services.workbookService.findWorkbookByUniqueId(this.artifactObjectId),this.artifactLabel=this.services.localizationService.get("SettingsBlade_WorkbookName"),this.artifact=r,this.isSettingsPane=!1,this.isWorkbook=!0,this.populateDisplayName(r.displayName,!1),[3,12];case 9:return[4,this.services.modelService.modelsPromise];case 10:return e.sent(),r=this.getSelectedModel(),this.artifactLabel=this.services.localizationService.get("SettingsBlade_ModelName"),this.artifact=r,this.isSettingsPane=!1,this.modelRenameError=!1,this.populateDisplayName(r.displayName,!0),[3,12];case 11:return this.prepareDataflowPopulateSettings(),[3,12];case 12:return[2]}})})},c.prototype.getReportByGUID=function(i){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return[4,this.services.reportStore.findByObjectId(i)];case 1:return t=e.sent(),[2,t?this.services.reportModelConverter.convertReport(t):null]}})})},c.prototype.loadReportSettings=function(){return __awaiter(this,void 0,d.Promise,function(){var o,t,r,a=this;return __generator(this,function(e){switch(e.label){case 0:return this.contactsModel={emailsList:new i,originalContactList:[],emailValidationError:null,emailValidationWarning:null,isFindingUsers:!1},[4,this.getReportByGUID(this.artifactObjectId)];case 1:return o=e.sent(),this.reportPermissions=o.getPermissions(),this.reportId=o.id,this.reportModelId=o.modelId,this.hasFolderId=!!o.contract.folderId,this.isReportSettingsEnabled()?[4,this.getReportSettingsService()]:[2];case 2:return t=e.sent(),[4,this.getContactsListStoreService()];case 3:return r=e.sent(),t.getReportSettings(this.artifact.id).subscribe(function(e){var t,i=e.contacts;a.contactsModel.originalContactList=i,e.contacts&&(a.contactsModel.emailsList={inputUserList:__spreadArray([],i||[]),validEmailsList:[],validObjectIds:[],hasValidationError:!1,isDirty:!1,errorMessage:"",validationTrigger:null},_.isEmpty(i)||(t=n.convertAdUserMetaDataListToArtifactContactList(i),r.updateReportContacts(a.reportId,{contacts:t}))),e.description&&(t=e.description,a.originalDescription=t,a.description=t),null!=e.annotationsEnabled&&null!=o&&a.isRdlReport()&&(a.isReportAnnotationsEnabled=a.originalIsReportAnnotationsEnabled=e.annotationsEnabled),e.isPromoted&&(a.originalIsPromoted=e.isPromoted,a.isPromoted=e.isPromoted)}),[2]}})})},c.prototype.initSetArtifactLabelComponent=function(e,t,i){var o=this;this.setArtifactLabelInputArgs={viewModel:{artifactType:s.Report,artifactId:e,artifactName:t,artifactWorkspace:i,artifactObjectId:this.artifactObjectId,sectionDescription:this.isScorecardReport?"SensitivityLabel_Description_Scorecard":"SensitivityLabel_Description_Report",showCheckboxInUserDownstreamInheritance:!this.isRdlReport()&&!this.isScorecardReport}},this.setArtifactLabelOutputArgs={hasChanges:function(e){(o.reportSensitivityLabelChanged=e)&&o.scope.settingsForm.$setDirty()},selectedLabelId:function(e){o.reportSensitivityLabelId=e,o.updateIsSensitivityLabelMissing()},downstreamInheritanceCheckBoxChanged:function(e){o.shouldTriggerDownstreamInheritance=e},isLabelAssignedByDefaultPolicy:function(e){o.isLabelAssignedByDefaultPolicy=e}}},c.prototype.initSettingDashboardBladeComponent=function(){var t=this;this.settingsDashboardBladeInputArgs={isSensitivityLabelMissing:this.isSensitivityLabelMissing,dashboardSettingsForm:this.scope.dashboardSettingsForm},this.settingsDashboardBladeOutputArgs={setCanSave:function(e){t.canSaveCallback=e.canSaveCallback},setApplyDashboardBladeChanges:function(e){t.applyDashboardBladeChangesCallback=e.applyDashboardBladeChangesCallback}}},c.prototype.initSetArtifactEndorsement=function(e,t){var i=this;this.setArtifactEndorsementInputArgs={viewModel:{artifactType:s.Report,artifactId:e,artifactObjectId:t}},this.setArtifactEndorsementOutputArgs={hasChanges:function(e){(i.hasArtifactStageChanged=e)&&i.scope.settingsForm.$setDirty()},artifactStageChange:function(e){i.shouldEnableFeaturedSetting()&&void 0===i.artifactStage&&0!==e&&(i.isPromoted=!0),i.artifactStage=e}}},c.prototype.loadSnapshotsForReport=function(){return __awaiter(this,void 0,d.Promise,function(){var t,i=this;return __generator(this,function(e){switch(e.label){case 0:return this.shouldShowSnapshot()?[4,this.getSnapshotStoreService()]:[2];case 1:return(t=e.sent()).ensureSnapshot(this.artifact.id,2,this.services.activeFolderId.activeFolderObjectId),t.getSnapshots(this.artifact.id,2).subscribe(function(e){i.snapshots=e;e=_.filter(i.snapshots,function(e){return 4===e.screenType});0<e.length&&(i.iconUrl=e[0].snapshotImageData);e=_.filter(i.snapshots,function(e){return 4!==e.screenType});0<e.length&&(i.defaultSnapshot=e[0].snapshotImageData)}),[2]}})})},c.prototype.prepareDataflowPopulateSettings=function(){var o,r=this;this.cdsaModelStore.findCdsaModelByObjectId(this.artifactObjectId).then(function(e){o=e,r.artifactLabel=r.services.localizationService.get("Name"),r.artifact=o,r.isSettingsPane=!1,r.isDataflow=!0,r.isMutipleContributorsEnabled()?r.readOnly=!1:(i=o.ownerUser,r.readOnly=!jsCommon.StringExtensions.equalIgnoreCase(i.userPrincipalName,a.getUPN()));var t=jsCommon.Utility.getDateFromWcfJsonString(o.lastEditedTimeUTC,!0),e=r.services.localizationService.get("ManageDatasets_NextRefresh_NA"),i=t?t.toLocaleDateString():e,t=t?t.toLocaleTimeString():e,e=r.getModifiedByFullName(o.modifiedByUser);r.lastModifiedDetails=r.services.localizationService.format("CDSA_LastEditedDetails",[i,t,e]),r.populateDisplayNameAndDescription(o.displayName,o.description)})},c.prototype.isMutipleContributorsEnabled=function(){return this.services.featureSwitchService.featureSwitches.CdsaMultipleContributors},c.prototype.exportDataModeChanged=function(){this.isExportDataModeChanged=!0},c.prototype.isInitialized=function(){return!!this.artifact},c.prototype.isExportDataModeEnabled=function(){if(this.isInitialized())return this.services.featureSwitchService.featureSwitches.exportDataMode&&this.isReportView()&&!this.isRdlReport()&&!this.isScorecardReport},c.prototype.shouldShowInformationProtectionSection=function(){if(this.isInitialized())return this.services.informationProtectionService.isInformationProtectionEditEnabled()&&this.isReportView()&&(this.services.featureSwitchService.featureSwitches.eimInformationProtectionUI||!this.isRdlReport())},c.prototype.shouldShowReportEndorsementSection=function(){if(this.isInitialized())return this.services.featureSwitchService.featureSwitches.artifactEndorsementFeatureUI&&this.isReportView()},c.prototype.isFilterExperienceSettingsVisible=function(){if(this.isInitialized())return this.isReportView()&&!this.isRdlReport()&&!this.isScorecardReport},c.prototype.isCrossReportDrillthroughVisible=function(){if(this.isInitialized())return this.isReportView()&&!this.isRdlReport()&&!this.isScorecardReport},c.prototype.isInlineExploreVisible=function(){if(this.isInitialized())return this.isReportView()&&!this.isRdlReport()&&!this.isScorecardReport},c.prototype.isEnhancedTooltipVisible=function(){if(this.isInitialized())return this.services.featureSwitchService.featureSwitches.enhancedTooltips&&this.isReportView()&&!this.isRdlReport()&&!this.isScorecardReport},c.prototype.isDefaultAggregateDisplayNameVisible=function(){if(this.isInitialized())return this.services.featureSwitchService.featureSwitches.defaultAggrDisplayName&&this.isReportView()&&!this.isRdlReport()&&!this.isScorecardReport},c.prototype.setIsSaving=function(e){this.isSaving=e},c.prototype.isAutomatedInsightsVisible=function(){if(this.isInitialized())return this.services.featureSwitchService.featureSwitches.automatedInsights&&this.services.featureSwitchService.featureSwitches.automatedInsightsTenantEnabled&&!this.isScorecardReport&&!this.isDatamart},c.prototype.allowAutomatedInsightsNotificationInitialValue=function(e){return null!==(e=e&&e.allowAutomatedInsightsNotification)&&void 0!==e?e:this.isAutomatedInsightsVisible()&&this.services.featureSwitchService.featureSwitches.automatedInsightsBackgroundRefresh},c.prototype.getModifiedByFullName=function(e){return e?o.getFullName(e.givenName,e.familyName,e.emailAddress):""},c.prototype.visualOptionsEnabled=function(){if(this.isInitialized())return!this.isScorecardReport&&(this.hideVisualContainerHeaderEnable()||this.useStylableVisualContainerHeaderEnabled())},c.prototype.hideVisualContainerHeaderEnable=function(){if(this.isInitialized())return this.isReportView()&&!this.isRdlReport()&&!this.isScorecardReport},c.prototype.useStylableVisualContainerHeaderEnabled=function(){if(this.isInitialized())return this.isReportView()&&!this.isRdlReport()&&!this.isScorecardReport},c.prototype.isStickyFilterEnabled=function(){if(this.isInitialized())return this.isReportView()&&!this.isRdlReport()&&!this.isScorecardReport},c.prototype.isPagesPaneEnabled=function(){if(this.isInitialized())return this.isFluentUIEnabled&&!this.isRdlReport()&&!this.isScorecardReport},c.prototype.isPagesPanePositionSettingEnabled=function(){var e;return!(null===(e=this.services.featureSwitchService)||void 0===e||!e.featureSwitches.reportPagePanePositionSetting)},c.prototype.isReportAnnotationsFeatureEnabled=function(){if(this.isInitialized())return this.isReportView()&&(!!this.isRdlReport()||this.services.featureSwitchService.featureSwitches.reportAnnotationsUI)&&!this.isScorecardReport&&!this.isTenantDisabledCommenting()},c.prototype.isTenantDisabledCommenting=function(){return this.services.featureSwitchService.featureSwitches.tenantDisableCommentingEnabled},c.prototype.isDefaultFilterActionEnabled=function(){if(this.isInitialized())return this.isReportView()&&!this.isRdlReport()&&!this.isScorecardReport},c.prototype.isReportView=function(){return 2===this.settingsType},c.prototype.isDashboardView=function(){return 1===this.settingsType},c.prototype.checkModelDisplayName=function(i){var o=this;4===this.settingsType&&(this.modelRenameError=_.some(this.services.modelService.editableModels,function(e){var t;return(null===(t=e.displayName)||void 0===t?void 0:t.toLowerCase())===(null==i?void 0:i.toLowerCase())&&e.id!==o.artifactId}))},c.prototype.saveModelName=function(a){return __awaiter(this,void 0,d.Promise,function(){var t,i,o,r=this;return __generator(this,function(e){switch(e.label){case 0:this.isSaving=!0,this.contactsErrorMessage="",this.hasContactValidationError=!1,e.label=1;case 1:switch(e.trys.push([1,10,11,12]),this.settingsType){case 1:return[3,2];case 2:return[3,3];case 3:return[3,6];case 4:return[3,7];case 5:return[3,8]}return[3,9];case 2:return this.applyDashboardBladeChangesCallback&&this.applyDashboardBladeChangesCallback(),[3,9];case 3:return[4,this.getReportByGUID(this.artifactObjectId)];case 4:return t=e.sent(),i=this.isRdlReport()?null:this.exploration.settings,this.isRdlReport()||this.saveReportSettings(),this.renameReport(a,t),this.reportSensitivityLabelChanged&&this.saveReportInformationProtection(this.reportId,t.displayName,this.services.folderService.activeFolder.displayName,this.reportSensitivityLabelId,this.shouldTriggerDownstreamInheritance,this.isLabelAssignedByDefaultPolicy),this.hasArtifactStageChanged&&this.services.artifactEndorsementService.setArtifactEndorsement(t.id,t.objectId,this.artifactStage,s.Report),(i||this.reportSensitivityLabelChanged)&&this.sendReportSettingsSaveTelemetry(i),this.updateSnapshot(),[4,this.updateReportSettings()];case 5:return e.sent(),[3,9];case 6:return o=this.services.workbookService.findWorkbookByUniqueId(this.artifactObjectId),this.services.workbookService.renameWorkbook(a,o.id,o.packageId),[3,9];case 7:return o=this.getSelectedModel(),this.services.modelService.renameModel(a,o.id,o.packageId),this.modelRenameError=!1,[3,9];case 8:return this.cdsaModelStore.findCdsaModelByObjectId(this.artifactObjectId).then(function(i){var o=i.description;r.oldDisplayName===a&&r.oldDescription===o||r.cdsaModelStore.findByDisplayName(a,i.id).then(function(e){var t;if(void 0===e)try{t=r.services.telemetryService.startEvent(d.telemetry.DatapoolUpdateProperties,{datapoolGuid:i.objectId}),r.cdsaModelStore.updateProperties(i.id,a,o,t)}catch(e){r.services.errorService.error(r.services.localizationService.get("CdsaModel_FailToUpdatePropertiesMessage"),"FailToUpdateProperties",{requestId:e.requestId,statusCode:e.status.toString()}),t.reject()}else r.services.errorService.infoCustom(r.services.localizationService.get("CdsaModel_CantRenameTitle"),r.services.localizationService.get("CdsaModel_NameAlreadyExistsMessage"))})}),[3,9];case 9:return[3,12];case 10:return e.sent(),[3,12];case 11:return 1!==this.settingsType&&(this.hasContactValidationError||this.unselectTileAndHideTaskPane(),this.isSaving=!1),[7];case 12:return[2]}})})},c.prototype.renameReport=function(e,t){var i;_.isEmpty(e.trim())||(i=this.services.telemetryService.startEvent(d.telemetry.DashboardRenameReport,{reportType:d.dataServices.ContractUtils.reportTypeToString(t.reportType)}),this.services.reportStore.rename(t.contract,e,i))},c.prototype.saveReportSettings=function(){var f;return __awaiter(this,void 0,d.Promise,function(){var t,i,o,r,a,s,n,l,c,d,p,u,h,g,m,v;return __generator(this,function(e){switch(e.label){case 0:return(t=this.exploration.settings,i=(t&&t.isPersistentUserStateDisabled)!==this.isPersistentUserStateDisabled,o=(t&&t.hideVisualContainerHeader)!==this.hideVisualContainerHeader,r=(t&&t.useStylableVisualContainerHeader)!==this.useStylableVisualContainerHeader,a=(t&&t.useCrossReportDrillthrough)!==this.useCrossReportDrillthrough,s=(t&&t.allowChangeFilterTypes)!==this.allowChangeFilterType,n=!(t&&t.disableFilterPaneSearch)!==this.enableFilterPaneSearch,l=(t&&t.allowInlineExploration)!==this.allowInlineExploration,c=1===(t&&t.pagesPosition)!==this.showPagesOnBottom,h=void 0===(t&&t.exportDataMode),g=h&&!this.isExportDataModeChanged,m=!g&&(t&&t.exportDataMode)!==this.exportDataMode,d=b.isReportAnnotationsEnabled(t)!==this.isReportAnnotationsEnabled,p=(t&&t.defaultFilterActionIsDataFilter)!==this.defaultFilterActionIsDataFilter,u=(t&&t.useEnhancedTooltips)!==this.useEnhancedTooltips,h=this.allowAutomatedInsightsNotificationInitialValue(t)!==this.allowAutomatedInsightsNotification,g=(t&&t.useDefaultAggregateDisplayName)!==this.useDefaultAggregateDisplayName,i||o||r||a||m||d||p||s||n||l||c||u||h||g)?(v={},t&&(v={isPersistentUserStateDisabled:t.isPersistentUserStateDisabled,hideVisualContainerHeader:t.hideVisualContainerHeader,useStylableVisualContainerHeader:t.useStylableVisualContainerHeader,exportDataMode:t.exportDataMode,isReportAnnotationsDisabled:t.isReportAnnotationsDisabled,defaultFilterActionIsDataFilter:t.defaultFilterActionIsDataFilter,allowChangeFilterTypes:t.allowChangeFilterTypes,disableFilterPaneSearch:t.disableFilterPaneSearch,useCrossReportDrillthrough:t.useCrossReportDrillthrough,allowInlineExploration:t.allowInlineExploration,pagesPosition:t.pagesPosition,useEnhancedTooltips:t.useEnhancedTooltips,allowAutomatedInsightsNotification:t.allowAutomatedInsightsNotification,useDefaultAggregateDisplayName:t.useDefaultAggregateDisplayName}),i&&(v.isPersistentUserStateDisabled=this.isPersistentUserStateDisabled),o&&(v.hideVisualContainerHeader=this.hideVisualContainerHeader),r&&(v.useStylableVisualContainerHeader=this.useStylableVisualContainerHeader),a&&(v.useCrossReportDrillthrough=this.useCrossReportDrillthrough),m&&(m=void 0,0!==this.exportDataMode&&(m=this.exportDataMode),v.exportDataMode=m),d&&(v.isReportAnnotationsDisabled=!this.isReportAnnotationsEnabled),p&&(v.defaultFilterActionIsDataFilter=this.defaultFilterActionIsDataFilter),s&&(v.allowChangeFilterTypes=this.allowChangeFilterType),n&&(v.disableFilterPaneSearch=!this.enableFilterPaneSearch),l&&(v.allowInlineExploration=this.allowInlineExploration),c&&null!==(f=this.services.featureSwitchService.featureSwitches)&&void 0!==f&&f.reportPagePanePositionSetting&&(v.pagesPosition=this.showPagesOnBottom?1:0),u&&(v.useEnhancedTooltips=this.useEnhancedTooltips),h&&(v.allowAutomatedInsightsNotification=this.allowAutomatedInsightsNotification),g&&(v.useDefaultAggregateDisplayName=this.useDefaultAggregateDisplayName),this.exploration.settings=v,[4,this.services.explorationProxy.save(this.originalExploration.value(),this.exploration,this.reportId)]):[2];case 1:return v=e.sent(),this.originalExploration=new y(v.wireContractJSON),[2]}})})},c.prototype.sendReportSettingsSaveTelemetry=function(e){var t=this.exploration.settings,e=this.getSettingsChanges(e,t),t=e.enabledSettings,e=e.disabledSettings;this.services.telemetryService.logEvent(d.telemetry.ReportSettingsSave,{enabledSettings:t.toString(),disabledSettings:e.toString(),sensitivityLabelId:this.reportSensitivityLabelChanged?this.reportSensitivityLabelId:"",isSensitivityLabelingRequired:this.isSensitivityLabelingRequired})},c.prototype.getSettingsChanges=function(t,i){var e=Object.keys(__assign(__assign({},t),i)).filter(function(e){return t[e]!==i[e]}),o=e.filter(function(e){return!0===i[e]});return{enabledSettings:o,disabledSettings:_.difference(e,o)}},c.prototype.cancel=function(){this.artifact.displayName=this.oldDisplayName,5===this.settingsType&&(this.artifact.description=this.oldDescription),this.modelRenameError=!1,this.unselectTileAndHideTaskPane()},c.prototype.rebind=function(){return __awaiter(this,void 0,d.Promise,function(){var t,i,o;return __generator(this,function(e){switch(e.label){case 0:return this.unselectTileAndHideTaskPane(),[4,(t=this.services).moduleLoader.require({javascript:"PowerBIDialogs/components/rebindReportDialog/rebindReportDialogBuilder"})];case 1:return o=e.sent(),[4,o.rebindReportDialogBuilder(t.modernDialogService,t.modelService,t.promiseFactory,t.userInfo,t.folderService,t.featureSwitchService,t.telemetryService,t.permissionService,function(e){return t.usageMetricsReport.isUsageMetricsArtifact(e)}).show()];case 2:return(i=e.sent())&&i.selectedDataset?[4,t.reportStore.findByObjectId(this.artifactObjectId)]:[3,4];case 3:o=e.sent(),this.services.reportStore.rebind(o,i.selectedDataset),e.label=4;case 4:return[2]}})})},c.prototype.unselectTileAndHideTaskPane=function(){this.artifact.isContentTileSelected=!1,this.services.taskPaneSliderService.collapsePane()},c.prototype.isSlashInName=function(){if(this.isDataflow)for(var e=0,t=this.artifact.displayName;e<t.length;e++){var i=t[e];if("\\"===i||"/"===i)return!0}return!1},c.prototype.isDisabled=function(){if(!(this.formWasChanged()||this.iconUpdatedBool)||this.formContainsEmptyInput()||this.isSaving||this.isSlashInName())return!0;this.updateIsSensitivityLabelMissing();var e=!1;return(e=this.contactsModel?this.contactsModel.isFindingUsers||!!this.contactsModel.emailValidationError||this.contactsModel.emailsList.hasValidationError:e)||!!this.canSaveCallback&&!this.canSaveCallback()||this.isSensitivityLabelMissing||this.modelRenameError},c.prototype.updateIsSensitivityLabelMissing=function(){!(this.formWasChanged()||this.iconUpdatedBool)||this.formContainsEmptyInput()||this.isSaving||(2===this.settingsType&&(this.isSensitivityLabelMissing=!!this.isSensitivityLabelingRequired&&(_.isEmpty(this.reportSensitivityLabelId)||this.reportSensitivityLabelId===this.noneLabelId)),this.sensitivityLabelRequiredTooltipConfig.tooltipDisable=!this.isSensitivityLabelMissing)},c.prototype.shouldShowDescription=function(){return this.isReport()},c.prototype.shouldShowFeaturedCheckbox=function(){if(this.isInitialized())return this.isReport()&&!this.isScorecardReport},c.prototype.shouldShowSnapshot=function(){if(this.isInitialized())return!this.isScorecardReport&&this.shouldEnableFeaturedSetting()},c.prototype.shouldEnableFeaturedSetting=function(){var e=this.services.featureSwitchService.featureSwitches,t=this.services.activeFolderId;return this.isReport()&&e.promoteContentEnabled&&(t.isActiveFolderWSv2||t.activeFolderObjectId===t.myWorkspaceFolderId)},c.prototype.getFeaturedContentWarning=function(){var e=this.services.activeFolderId;return e.isActiveFolderWSv2||e.activeFolderObjectId===e.myWorkspaceFolderId?"FeaturedContent_TenantSetting_Disabled":"FeaturedContent_WorkspaceV1_Disabled"},c.prototype.resetValidation=function(e){e.emailValidationWarning="",this.validateInputTags(e)},c.prototype.validateInputTags=function(e){t.validateInputTags(this.services,e,{shouldBlockConsumerDomains:!0})},c.prototype.formWasChanged=function(){var e=this.scope.settingsForm&&this.scope.settingsForm.$dirty;switch(this.settingsType){case 1:return e||this.scope.dashboardSettingsForm&&this.scope.dashboardSettingsForm.$dirty;case 5:return this.oldDisplayName!==this.artifact.displayName||this.oldDescription!==this.artifact.description;default:return e}},c.prototype.formContainsEmptyInput=function(){return!!this.artifact&&_.isEmpty(this.artifact.displayName.trim())},c.prototype.constructArtifactName=function(e,t){return t?this.services.localizationService.format("SettingsBlade_SettingRename",[e]):this.services.localizationService.format("SettingsBlade_SettingsFor",[e])},c.prototype.populateDisplayName=function(e,t){this.bladeTitle=this.constructArtifactName(e,t),this.oldDisplayName=e},c.prototype.populateDisplayNameAndDescription=function(e,t){this.bladeTitle=e,this.oldDisplayName=e,this.oldDescription=t},c.prototype.getSelectedModel=function(){return this.artifactId&&_.isNumber(this.artifactId)?this.services.modelService.findModel(this.artifactId):this.services.modelService.findModelByDBName(this.artifactObjectId)},c.prototype.isRebindFeatureEnabled=function(){if(this.isInitialized()){if(!this.services.folderService.activeFolder)return!1;var e=this.services.folderService.isFolder,t=this.services.folderService.isMyWorkspace();return this.isReportView()&&!this.isRdlReport()&&!this.reportModelId&&this.services.featureSwitchService.featureSwitches.rebindReportUi&&r.hasFlag(this.reportPermissions,2)&&(e||t)}},c.prototype.getReportDatasetDisplayName=function(){var e=this.services.localizationService.get("None");return this.services.localizationService.format("SettingsBlade_CurrentDataset",[e])},c.prototype.isRdlReport=function(){if(this.isInitialized())return 1===this.artifact.reportType},c.prototype.isReport=function(){return 2===this.settingsType},c.prototype.getReportSettingsService=function(){return __awaiter(this,void 0,d.Promise,function(){return __generator(this,function(e){return[2,this.services.lazyProviderModern.get("@powerbi/ReportSettings/report-settings.module#ReportSettingsModule","ReportSettingsService")]})})},c.prototype.getContactsListStoreService=function(){return __awaiter(this,void 0,d.Promise,function(){return __generator(this,function(e){return[2,this.services.lazyProviderModern.get("@powerbi/ContactList/contact-list.module#ContactListModule","ContactsStoreService")]})})},c.prototype.getSnapshotStoreService=function(){return __awaiter(this,void 0,d.Promise,function(){return __generator(this,function(e){return[2,this.services.lazyProviderModern.get("@powerbi/SnapshotConsumption/snapshot-consumption.module#SnapshotConsumptionModule","SnapshotStoreService")]})})},c.prototype.saveReportInformationProtection=function(e,t,i,o,r,a){void 0===a&&(a=!1),o===this.noneLabelId?this.services.informationProtectionService.deleteArtifactInformationProtection(e,t,i,s.Report):this.services.informationProtectionService.upsertArtifactInformationProtection(o,e,t,i,s.Report,r,void 0,a)},c.prototype.updateReportSettings=function(){return __awaiter(this,void 0,d.Promise,function(){var i,t,o,r,a=this;return __generator(this,function(e){switch(e.label){case 0:return i=this.services.promiseFactory.defer(),this.isReportSettingsEnabled()&&this.shouldUpdateReportSettings()?[4,this.getReportSettingsService()]:(i.resolve(),[2,i.promise]);case 1:return t=e.sent(),[4,this.getContactsListStoreService()];case 2:return o=e.sent(),r={contacts:this.shouldUpdateContactsForReport()?this.contactsModel.emailsList.inputUserList:void 0,description:this.shouldUpdateDescriptionForReport()?this.description:void 0,annotationsEnabled:this.shouldUpdateAnnotationsEnabledForReport()?this.isReportAnnotationsEnabled:void 0,isPromoted:this.shouldUpdateIsPromotedForReport()?this.isPromoted:void 0},t.updateReportSettings(r,this.artifact.id).subscribe(function(e){var t;r.contacts&&a.shouldUpdateContactsForReport()&&(t=n.convertAdUserMetaDataListToArtifactContactList(r.contacts),_.isEmpty(t)?o.clearReportContacts(a.reportId):o.updateReportContacts(a.reportId,{contacts:t})),a.shouldUpdateIsPromotedForReport()&&(a.isPromoted?a.services.promotedContentService.addPromotedArtifact(a.artifactId,a.artifactObjectId,a.isRdlReport()?"RdlReport":"Report",a.artifact.displayName,a.artifact.description):a.services.promotedContentService.deletePromotedArtifact(a.artifactId,a.artifactObjectId,a.isRdlReport()?"RdlReport":"Report")),i.resolve()},function(e){e=n.handleUpdateSettingsError(e,a.services.localizationService).errorMessage;a.hasContactValidationError=!0,a.contactsErrorMessage=e,i.reject()}),[2,i.promise]}})})},c.prototype.shouldUpdateReportSettings=function(){return this.shouldUpdateContactsForReport()||this.shouldUpdateDescriptionForReport()||this.shouldUpdateAnnotationsEnabledForReport()||this.shouldUpdateIsPromotedForReport()},c.prototype.contactListFeatureSwitchOn=function(){return this.services.featureSwitchService.featureSwitches.contactsSettingsList},c.prototype.isReportSettingsEnabled=function(){return this.isReport()},c.prototype.shouldUpdateContactsForReport=function(){return this.shouldShowContacts&&!_.isEqual(this.contactsModel.originalContactList,this.contactsModel.emailsList.inputUserList)},c.prototype.shouldUpdateDescriptionForReport=function(){return!_.isEqual(this.originalDescription,this.description)},c.prototype.shouldUpdateAnnotationsEnabledForReport=function(){return this.isReport()&&this.isRdlReport()&&this.isReportAnnotationsEnabled!==this.originalIsReportAnnotationsEnabled},c.prototype.shouldUpdateIsPromotedForReport=function(){return!_.isEqual(this.originalIsPromoted,this.isPromoted)&&this.shouldEnableFeaturedSetting()},c.prototype.shouldUpdateReportSnapshot=function(){return this.iconUpdatedBool&&this.shouldShowSnapshot()},c.prototype.updateSnapshot=function(){return __awaiter(this,void 0,d.Promise,function(){var t,i,o,r;return __generator(this,function(e){switch(e.label){case 0:return this.shouldUpdateReportSnapshot()?[4,this.getSnapshotStoreService()]:[2];case 1:return(t=e.sent(),i=_.filter(this.snapshots,function(e){return 4===e.screenType}),o=this.services.folderService.activeFolderObjectId,o=o===d.constants.myWorkSpaceFolderId?void 0:o,0<i.length)?((r=i[0]).folderObjectId=o,_.isEmpty(this.iconUrl)?[4,t.deleteSnapshot(this.artifact.id,r)]:[3,3]):[3,6];case 2:return e.sent(),[3,5];case 3:return r.snapshotImageData=this.iconUrl.substring(this.iconUrl.indexOf(",")+1),[4,t.updateSnapshot(this.artifact.id,r)];case 4:e.sent(),e.label=5;case 5:return[3,8];case 6:return r={snapshotImageData:this.iconUrl?this.iconUrl.substring(this.iconUrl.indexOf(",")+1):void 0,artifactType:2,screenType:4,blobInfoId:void 0,lastUpdatedTime:void 0,id:void 0,folderObjectId:o},[4,t.addSnapshot(this.artifact.id,r)];case 7:e.sent(),e.label=8;case 8:return this.iconUpdatedBool=!1,[2]}})})},c.prototype.getIsScorecardReport=function(e){e=this.services.packageStore.findById(e);return l(e)},e.SettingsBladeController=c}(d.sidePanes||(d.sidePanes={}))}(powerbi=powerbi||{}),function(e){var t;((t=e.sidePanes||(e.sidePanes={})).components||(t.components={})).SettingsBlade={controller:e.common.createController(t.controllers.SettingsBladeController),templateUrl:"components/settingsBlade/settingsBlade.html"}}(powerbi=powerbi||{}),function(e){((e=e.sidePanes||(e.sidePanes={})).controllers||(e.controllers={})).CustomValidatorSynchronizerController=function(e,t){var i=this;this.registerValidator=function(t){return i.validators.push(t),function(){_.remove(i.validators,function(e){return e===t})}},this.synchronizeValidation=function(){i.validators.forEach(function(e){return e()})},this.validators=[]}}(powerbi=powerbi||{}),function(p){var e,u;function t(e){var d=this;this.$timeout=e,this.require=["ngModel","?^customValidatorSynchronizer"],this.restrict="A",this.link=function(e,t,i,o){var r,a,s=o[0],n=o[1],l=e.$eval(i.customValidator);function c(e){s.$setValidity(u,l.validate(e)),n&&n.synchronizeValidation()}l.validate,n&&(a=n.registerValidator(function(){s.$error[u]&&s.$setValidity(u,l.validate(s.$viewValue))})),e.$watch(i.ngModel,function(e,t){(e||t)&&(r?d.$timeout.cancel(r):s.$setValidity(u,!0),0<l.delay?r=d.$timeout(function(){r=null,c(e)},l.delay):c(e))}),e.$on(p.common.constants.scopeDestroyEventName,function(){a&&a(),r&&d.$timeout.cancel(r)})}}e=(e=p.sidePanes||(p.sidePanes={})).directives||(e.directives={}),u="custom",e.CustomValidator=t}(powerbi=powerbi||{}),function(e){var t;((t=e.sidePanes||(e.sidePanes={})).directives||(t.directives={})).CustomValidatorSynchronizer=function(){this.controller=e.common.createController(t.controllers.CustomValidatorSynchronizerController),this.restrict="A"}}(powerbi=powerbi||{}),function(e){((e=e.sidePanes||(e.sidePanes={})).filters||(e.filters={})).rolePropertyFilter=function(){return function(e,t){return _.filter(e,function(e){return!e||!e.isHidden||e.value===t})}}}(powerbi=powerbi||{}),function(e){((e=e.sidePanes||(e.sidePanes={})).filters||(e.filters={})).truncateTo=function(){return function(e,t){return e.length<t?e:e.substr(0,t)+"..."}}}(powerbi=powerbi||{}),define("PowerBISidePanes/services/tileAuthoring",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.create=void 0;var i=powerbi,o=i.common,c=i.common.contracts.ContentTileType,r=jsCommon.EnumExtensions,d=i.models.Folder,a=i.dataServices.models.IsValidIntraDomainPrefix,s=o.constants.tileActions;t.create=function(e,t,i,o,r,a,s,n){return new l(e,t,i,o,r,a,s,n)};var l=(n.prototype.getInternalLinkModel=function(e){var t,i,o,r=this,a=this.getCustomLinkType(e),s=this.dashboardDataService,n=_.union(_.pull(__spreadArray([],s.dashboards||[]),s.activeDashboard),this.reportService.reports),s=this.folderService.activeFolder;s instanceof d&&(t=s.id),n=_(n).filter(function(e){return r.isValidByFolderId(e,t)&&r.isVisibleAndOwned(e)}).sortBy(function(e){return e.displayName.toLocaleLowerCase()}).value(),_.isEmpty(n)||(1===a?i=n[0]:(o=e.intraDomainNavigationParameters&&e.intraDomainNavigationParameters.navigationTargetGuid)&&(i=_.find(n,function(e){return e.objectId===o})));var l=this.localizationService;return{candidates:n,target:i,getCandidateName:function(e){var t=e.contentTileType===c.Dashboard?"CreateApp_DefaultContent_Dashboard":"CreateApp_DefaultContent_Report";return l.format(t,[e.displayName])},warningType:this.getWarningType(i,a)}},n.prototype.getCustomLinkType=function(e){e=e.action;return e.action===s.custom.openUrlActionName&&a(e.targetUrl)?2:1},n.prototype.getWarningType=function(e,t){return e&&r.hasFlag(e.getPermissions(),17)?2:2!==t||e?void 0:1},n.prototype.isValidByFolderId=function(e,t){return!e.contract&&!t||(t?e.contract&&e.contract.folderId===t:!(e.contract&&e.contract.folderId))},n.prototype.isVisibleAndOwned=function(e){return(e.contentTileType===c.Dataset||e.contentTileType===c.CdsaModel||!this.ownershipService.isResourceSharedWithMe(e))&&this.isVisible(e)},n.prototype.isVisible=function(e){if(e.isHidden)return!1;switch(e.contentTileType){case c.Report:case c.RdlReport:return this.canCopyAndEdit(e)&&this.isFromVisiblePackage(e,!0)}return this.isFromVisiblePackage(e,!1)},n.prototype.canCopyAndEdit=function(e){e=e.getPermissions();return r.hasFlag(e,2)||r.hasFlag(e,17)},n.prototype.isFromVisiblePackage=function(e,t){e=powerbi.helpers.ContentTileHelper.getPackageId(e);if(!_.isNumber(e))return!0;e=this.packageService.findPackage(e);return!(!e||!e.contract)&&((!this.folderService.isMyWorkspace()||e.packageType!==powerbi.common.contracts.PackageType.AppInstance||null==this.appService.getAppInstance(e.id))&&(!t||!this.usageMetricsReport.isUsageMetricsPackage(e.contract)))},n);function n(e,t,i,o,r,a,s,n){this.dashboardDataService=e,this.folderService=t,this.reportService=i,this.localizationService=o,this.ownershipService=r,this.packageService=a,this.appService=s,this.usageMetricsReport=n}}),function(r){!function(t){var e=jsCommon.Utility,i=r.telemetryEventFactory,o=r.telemetry.EventFactories;e?e.generateGuid:Function.prototype;t.DataAlertsOpenAlertsEditorEventName="PBI.DataAlerts.OpenAlertsEditor",t.DataAlertsOpenAlertsEditor=o[t.DataAlertsOpenAlertsEditorEventName]=function(e){return i({name:t.DataAlertsOpenAlertsEditorEventName,baseEvent:t.CustomerAction(e),info:e,category:r.TelemetryCategory.CustomerAction,loggers:t.DataAlertsOpenAlertsEditorLoggers})},t.DataAlertsSaveAlertsEventName="PBI.DataAlerts.SaveAlerts",t.DataAlertsSaveAlerts=o[t.DataAlertsSaveAlertsEventName]=function(e){return i({name:t.DataAlertsSaveAlertsEventName,baseEvent:t.CustomerAction(e),info:e,category:r.TelemetryCategory.CustomerAction,loggers:t.DataAlertsSaveAlertsLoggers})},t.GroupEditorCreateGroupEventName="PBI.GroupEditor.CreateGroup",t.GroupEditorCreateGroup=o[t.GroupEditorCreateGroupEventName]=function(e){return i({name:t.GroupEditorCreateGroupEventName,baseEvent:t.CustomerAction(e),info:e,category:r.TelemetryCategory.CustomerAction,loggers:t.GroupEditorCreateGroupLoggers})},t.GroupEditorGetFolderSettingsEventName="PBI.GroupEditor.GetFolderSettings",t.GroupEditorGetFolderSettings=o[t.GroupEditorGetFolderSettingsEventName]=function(e){return i({name:t.GroupEditorGetFolderSettingsEventName,baseEvent:t.CustomerAction(e),info:e,category:r.TelemetryCategory.CustomerAction,loggers:t.GroupEditorGetFolderSettingsLoggers})},t.GroupEditorUpdateGroupEventName="PBI.GroupEditor.UpdateGroup",t.GroupEditorUpdateGroup=o[t.GroupEditorUpdateGroupEventName]=function(e){return i({name:t.GroupEditorUpdateGroupEventName,baseEvent:t.CustomerAction(e),info:e,category:r.TelemetryCategory.CustomerAction,loggers:t.GroupEditorUpdateGroupLoggers})},t.GroupEditorDeleteGroupEventName="PBI.GroupEditor.DeleteGroup",t.GroupEditorDeleteGroup=o[t.GroupEditorDeleteGroupEventName]=function(e){return i({name:t.GroupEditorDeleteGroupEventName,baseEvent:t.CustomerAction(e),info:e,category:r.TelemetryCategory.CustomerAction,loggers:t.GroupEditorDeleteGroupLoggers})},t.GroupEditorValidateGroupIdEventName="PBI.GroupEditor.ValidateGroupId",t.GroupEditorValidateGroupId=o[t.GroupEditorValidateGroupIdEventName]=function(e){return i({name:t.GroupEditorValidateGroupIdEventName,baseEvent:t.CustomerAction(e),info:e,category:r.TelemetryCategory.CustomerAction,loggers:t.GroupEditorValidateGroupIdLoggers})},t.GroupEditorValidateGroupMembersEventName="PBI.GroupEditor.ValidateGroupMembers",t.GroupEditorValidateGroupMembers=o[t.GroupEditorValidateGroupMembersEventName]=function(e){return i({name:t.GroupEditorValidateGroupMembersEventName,baseEvent:t.CustomerAction(e),info:e,category:r.TelemetryCategory.CustomerAction,loggers:t.GroupEditorValidateGroupMembersLoggers})},t.GroupEditorUpdateMyWorkspaceEventName="PBI.GroupEditor.UpdateMyWorkspace",t.GroupEditorUpdateMyWorkspace=o[t.GroupEditorUpdateMyWorkspaceEventName]=function(e){return i({name:t.GroupEditorUpdateMyWorkspaceEventName,baseEvent:t.CustomerAction(e),info:e,category:r.TelemetryCategory.CustomerAction,loggers:t.GroupEditorUpdateMyWorkspaceLoggers})},t.DashboardEditTilePropertiesEventName="PBI.Dashboard.EditTileProperties",t.DashboardEditTileProperties=o[t.DashboardEditTilePropertiesEventName]=function(e){return i({name:t.DashboardEditTilePropertiesEventName,baseEvent:t.CustomerAction(e),info:e,category:r.TelemetryCategory.CustomerAction,loggers:t.DashboardEditTilePropertiesLoggers})},t.RealTimeStreamingDatasetGalleryPaneOpenedEventName="PBI.RealTime.StreamingDatasetGalleryPaneOpened",t.RealTimeStreamingDatasetGalleryPaneOpened=o[t.RealTimeStreamingDatasetGalleryPaneOpenedEventName]=function(e){return i({name:t.RealTimeStreamingDatasetGalleryPaneOpenedEventName,baseEvent:t.CustomerAction(e),info:e,category:r.TelemetryCategory.CustomerAction,loggers:t.RealTimeStreamingDatasetGalleryPaneOpenedLoggers})},t.RealTimeEditStreamingDatasetPaneOpenedEventName="PBI.RealTime.EditStreamingDatasetPaneOpened",t.RealTimeEditStreamingDatasetPaneOpened=o[t.RealTimeEditStreamingDatasetPaneOpenedEventName]=function(e){return i({name:t.RealTimeEditStreamingDatasetPaneOpenedEventName,baseEvent:t.CustomerAction(e),info:e,category:r.TelemetryCategory.CustomerAction,loggers:t.RealTimeEditStreamingDatasetPaneOpenedLoggers})},t.ThemingImportThemeEventName="PBI.Theming.ImportTheme",t.ThemingImportTheme=o[t.ThemingImportThemeEventName]=function(e){return i({name:t.ThemingImportThemeEventName,baseEvent:t.CustomerAction(e),info:e,category:r.TelemetryCategory.CustomerAction,loggers:t.ThemingImportThemeLoggers})},t.ThemingExportThemeEventName="PBI.Theming.ExportTheme",t.ThemingExportTheme=o[t.ThemingExportThemeEventName]=function(e){return i({name:t.ThemingExportThemeEventName,baseEvent:t.CustomerAction(e),info:e,category:r.TelemetryCategory.CustomerAction,loggers:t.ThemingExportThemeLoggers})},t.SettingsGetRelatedContentEventName="PBI.Settings.GetRelatedContent",t.SettingsGetRelatedContent=o[t.SettingsGetRelatedContentEventName]=function(e){return i({name:t.SettingsGetRelatedContentEventName,baseEvent:t.Verbose(e),info:e,category:r.TelemetryCategory.Verbose,loggers:t.SettingsGetRelatedContentLoggers})},t.ReportSettingsSaveEventName="PBI.ReportSettings.Save",t.ReportSettingsSave=o[t.ReportSettingsSaveEventName]=function(e){return i({name:t.ReportSettingsSaveEventName,baseEvent:t.CustomerAction(e),info:e,category:r.TelemetryCategory.CustomerAction,loggers:t.ReportSettingsSaveLoggers})}}(r.telemetry||(r.telemetry={}))}(powerbi=powerbi||{}),function(e){((e=e.sidePanes||(e.sidePanes={})).components||(e.components={})).Expando={templateUrl:"components/expando/expando.html",bindings:{expanded:"<"}}}(powerbi=powerbi||{}),function(e){var t;((t=e.sidePanes||(e.sidePanes={})).components||(t.components={})).EditMyWorkspaceBlade={controller:e.common.createController(t.controllers.EditMyWorkspaceBladeController),bindings:{parameters:"<"},templateUrl:"components/groupEditor/myWorkspace/editMyWorkspaceBlade.html"}}(powerbi=powerbi||{}),function(r){var a,e,s;a=r.sidePanes||(r.sidePanes={}),e=a.directives||(a.directives={}),s=r.dataServices.models.TileFactory,e.TileEditor=function(){this.template="<legacy-scoped-root><dashboard-scoped-services-bridge><tile-editor-inner></tile-editor-inner></dashboard-scoped-services-bridge></legacy-scoped-root>",this.scope={}},e.TileEditorInner=function(e,t,i){var o=this;this.$compile=e,this.$timeout=t,this.localizationService=i,this.controller=r.common.createController(a.controllers.TileEditorController),this.replace=!0,this.restrict="E",this.scope={},this.templateUrl="components/tileEditor/tileEditor.html",this.link=function(e,t){var i=e.viewModel.tile.config;i&&i.widget&&(i=s.getTileTemplate(i.widget.id,o.localizationService),e=o.$compile(i)(e),t.find(".widgetEditorContent").append(e)),o.$timeout(function(){t.find(".textVisual").keydown(function(e){27===e.keyCode&&(e.stopPropagation(),t.find(":tabbable").last().focus())})})}}}(powerbi=powerbi||{}),function(u){!function(e){var a,t,o,i,r,s,n,l,c,d;function p(e,t){var i=this;this.tileSaved=!1,this.scope=e,this.services=t;var o=this.services.dashboardDataService.selectedDashboardTile;e.back=function(){return i.back()},e.closeTileEditorWithoutSaving=function(){return i.cancel()},e.restoreDefaults=function(){return i.restoreDefaults()},e.showTechnicalDetailsDialog=function(){return i.showTechnicalDetailsDialog()},e.saveChangesAndExit=function(){return i.save()},e.setCustomLinkChanged=function(){return i.setCustomLinkChanged()},e.setDynamicImageForWorkbookTile=function(){return e.workbookService.setModelDynamicImageUrl(o.workbook)},e.showLastRefreshTimeChanged=function(){return i.showLastRefreshTimeChanged()},e.toggleDisplayTitle=function(){return i.toggleDisplayTitle()},e.onLinkTargetChanged=function(){return i.onLinkTargetChanged()},e.hasTitleError=function(){return i.hasTitleError()},e.hasExternalLinkError=function(){return i.hasExternalLinkError()},e.getInternalLinkWarningType=function(){return i.getInternalLinkWarningType()},e.canSave=function(){return i.canSave()},e.$on(u.constants.hideTaskPaneSliderOnClickEventName,function(e){return i.cancel()}),e.realTimeAuthoringUIModule="@powerbi/RealTimeAuthoringUI/real-time-authoring-ui.module#RealTimeAuthoringUIModule",e.viewModel=new u.models.TileEditorModel(o,this.services.explorationSerializer,this.services.visualPlugin,this.services.workbookService),e.workbookService=t.workbookService,e.tileEditorHeaderPaneTitle=function(){return i.tileEditorHeaderPaneTitle()},e.activateHeaderTab=function(e){return i.activateHeaderTab(e)},this.setDisplayTitle();var r=e.viewModel.tile;r&&r.realTime&&this.saveRealTimeTileContext(),this.setCustomLinkProperties(),e.isSavedRealTimeTile=!!r.realTime&&!r.isTemporary,e.isSavedRealTimeTile&&(e.headerTabs=l.getRealTimeTileEditHeaderTabs(t.localizationService),e.activeHeaderTab=e.headerTabs[0]),e.tileModel=o,e.selectedModel=t.modelService.findModel(o.contract.modelId),e.$watchGroup([function(){return o.hasTitle()},function(){return o.hasSubtitle()}],function(){r.invalidateLayout()});var a=e.$on("$destroy",function(){var e=i.scope.viewModel;i.tileSaved||e.tile.isTemporary||!e.isDirty()||e.undoChanges(),a()})}e=e.controllers||(e.controllers={}),a=u.dataServices.models.ContentPackItems,t=u.common.contracts.DataCacheModeType,o=u.dataServices.models.IsValidIntraDomainPrefix,i=u.common.helpers.ModelConverterHelper,r=u.common.models.Report,s=u.explore.contracts.SingleVisualConfig,n=u.common.constants.tileActions,l=u.models.factory.TileOptionsFactory,c=u.dataServices.contracts.TileType,d=u.dataServices.TileUtils,p.createOptions=function(){return{additionalServices:["$injector","dashboardService","dashboardDataService","dashboardHttpService","errorService","explorationSerializer","lazy","localizationService","modelService","telemetryService","taskPaneSliderService","tileSelectionService","visualPlugin","workbookService"],scopedDependencies:["pinVisual","visualQueryGenerator"]}},p.prototype.hasTitleError=function(){var e=this.scope;return!!e.tileEditorForm&&e.tileEditorForm.title.$touched&&!e.viewModel.isTitleValid()},p.prototype.hasExternalLinkError=function(){var e=this.scope;return!!e.hasCustomLink&&(e.tileEditorForm&&e.tileEditorForm.customUrl&&e.tileEditorForm.customUrl.$touched&&!e.viewModel.isCustomLinkValid(!1))},p.prototype.getInternalLinkWarningType=function(){var e=this.scope;if(e.hasCustomLink)return e.internalLinkInfo.warningType},p.prototype.canSave=function(){var e=this.scope,t=e.viewModel;return!(!!e.tileEditorForm&&e.tileEditorForm.$invalid)&&t.isDirty()&&t.isValid(2===e.customLinkType)},p.prototype.showTechnicalDetailsDialog=function(){var i=this.services.errorService.control(),e=[new InJs.ModalDialogAction(this.services.localizationService.get("PBI_Button_Label_Close"),function(e,t){i.hideDialog()})],t=$("<div></div>"),o='<a href="'+jsCommon.PowerBIDefaultHelpPage+'" target="_blank">'+this.services.localizationService.get("TileEditor_TechnicalDetails_SupportPage")+"</a>";t.append($("<div></div>").html(this.services.localizationService.format("TileEditor_TechnicalDetails_Description",[o]))),this.addTileDetails(t);o=window.powerbi;o.session.userInfo&&o.session.userInfo.uoid&&t.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_UserObjectId"),o.session.userInfo.uoid));o=this.services.dashboardDataService.activeDashboard;o&&t.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_DashboardId"),o.id.toString())),this.addPackageDetails(t),this.addModelDetails(t),i.showCustomDialog(this.services.localizationService.get("TileEditor_TechnicalDetails_Title"),t,e,null,!0)},p.prototype.activateHeaderTab=function(e){this.scope.activeHeaderTab=e},p.prototype.onLinkTargetChanged=function(){var t=this.scope,i=t.internalLinkInfo,o=i.target;o&&this.services.lazy("tileAuthoring").then(function(e){i.warningType=e.getWarningType(o,t.customLinkType);e=t.viewModel.tile.action;o instanceof r?1===o.reportType?e.targetUrl="/rdlreports/"+o.objectId:e.targetUrl="/reports/"+o.objectId:e.targetUrl="/dashboards/"+o.objectId})},p.prototype.cancel=function(){var e=this.scope.viewModel.tile;e.isTemporary?this.services.dashboardService.removeTemporaryTile(e):(this.scope.viewModel.undoChanges(),e.realTime&&this.restoreRealTimeTileContext()),this.services.tileSelectionService.clearSelected(),this.services.taskPaneSliderService.collapsePane()},p.prototype.back=function(){var e=this.scope.viewModel.tile;e.isTemporary&&(7==(e=e.realTime?7:5)?(null==this.sidePaneStoreService&&(this.sidePaneStoreService=this.services.$injector.get("sidePaneStoreService")),this.services.taskPaneSliderService.collapsePane(),this.sidePaneStoreService.openRealTimeBladePane()):this.services.taskPaneSliderService.expandPane(e,3))},p.prototype.restoreDefaults=function(){this.scope.viewModel.restoreDefaults(),this.scope.hasCustomLink=!1,this.scope.customLinkType=1,this.setDisplayTitle()},p.prototype.save=function(){var e=this.scope.viewModel;e.isValid(2===this.scope.customLinkType)&&((e=e.tile).isTemporary?(e.isSelected=!1,this.saveNewTile()):this.saveExistingTile())},p.prototype.saveNewTile=function(){var e=this.scope.viewModel,t=this.getPinTileTelemetryEvent();e.updateModelContract(),this.tileSaved=!0,this.services.dashboardService.saveTemporaryTile(e.tile,t),this.services.tileSelectionService.clearSelected(),this.services.taskPaneSliderService.collapsePane()},p.prototype.saveExistingTile=function(){var t=this,e=this.scope.viewModel,i=e.tile.contract,o=e.originalContract;if(!e.isDirty())return this.services.tileSelectionService.clearSelected(),void this.services.taskPaneSliderService.collapsePane();e.updateModelContract();var r=this.services.telemetryService.startEvent(u.telemetry.DashboardEditTileProperties,{readOnlyTileEdited:!1,titleEdited:i.displayText!==o.displayText,subTitleEdited:i.subDisplayText!==o.subDisplayText,actionEdited:i.action!==o.action,configEdited:i.config!==o.config});this.services.dashboardHttpService.updateTile(o,i,r.event).then(function(){r.resolve(),t.tileSaved=!0,t.services.tileSelectionService.clearSelected(),t.services.taskPaneSliderService.collapsePane();var e=t.services.dashboardDataService.activeDashboard;e&&e.isUsedByContentPack&&t.services.rootScope.$emit(u.constants.contentPackDirtyShowNotification,e.id,a.Dashboard)},function(e){401===e.status?(r.event.info.readOnlyTileEdited=!0,r.resolve()):r.reject(),t.services.errorService.error(t.services.localizationService.get("TileEditor_UpdateFailed"),"TileEditor_UpdateFailed",{requestId:e.requestId,statusCode:e.status.toString()})})},p.prototype.setCustomLinkProperties=function(){var a=this;this.services.lazy("tileAuthoring").then(function(e){var t=a.scope,i=t.viewModel,o=t.viewModel.tile,r=o.action;r.openInSameTab=!!r.openInSameTab||!1,t.customLinkType=e.getCustomLinkType(o),t.hasCustomLink=i.isCustomAction(r.action),!t.hasCustomLink&&r.targetUrl&&(r.targetUrl=null),t.internalLinkInfo=e.getInternalLinkModel(o)})},p.prototype.setCustomLinkChanged=function(){var e,t=this.scope,i=t.viewModel;t.hasCustomLink?(t.customLinkType=t.customLinkType||1,i.setAction(n.custom.openUrlActionName),(e=i.tile.action).openInSameTab=!1,2===t.customLinkType?this.onLinkTargetChanged():(t=i.originalContract.$action,e.targetUrl=t&&!o(t.targetUrl)?t.targetUrl:null)):i.setAction(null)},p.prototype.setDisplayTitle=function(){var e=this.scope,t=e.viewModel,i=t.tile.config,i=i&&!!i.hideTitle,t=t.titleRequired||!!t.tile.getDisplayText();e.displayTitle=!i&&t},p.prototype.showLastRefreshTimeChanged=function(){var e=this.scope.viewModel.tile.config;e&&e.lastRefreshTimeEnabled&&!this.scope.displayTitle&&(this.scope.displayTitle=!0,this.toggleDisplayTitle())},p.prototype.toggleDisplayTitle=function(){this.scope.viewModel.tile.config=this.scope.viewModel.tile.config||{},this.scope.viewModel.tile.config.hideTitle=!this.scope.displayTitle},p.prototype.tileEditorHeaderPaneTitle=function(){var e=this.services.localizationService,t=e.get("TileEditor_PaneTitle_Details"),i=this.scope.viewModel.tile,o=i.config&&i.config.widget;if(null==o||!i.isTemporary)return t;switch(o.id){case 1:return e.get("TileEditorPane_WebContentTitle");case 2:return e.get("TileEditorPane_ImageWidgetTitle");case 3:return e.get("TileEditorPane_TextboxTitle");case 4:return e.get("TileEditorPane_VideoWidgetTitle");default:return t}},p.prototype.getPinTileTelemetryEvent=function(){var e=this.scope.viewModel,t=e.tile.config,i=u.dataServices.TileUtils.getVisualType(t)||"",t=t&&t.widget?t.widget.name:"",e=e.tile.realTime;return e&&(i=e.visual&&e.visual.type,t=c[c.realTime]),this.services.telemetryService.startEvent(u.telemetry.DashboardPinTile,{visualType:i,source:"Widget",reason:"",unsupportedVisualPinned:!1,contentProviderType:"",isCustomVisual:!1,widgetType:t,reportPageContainsScriptVisuals:!1,sourceOrigin:"Owned"})},p.prototype.saveRealTimeTileContext=function(){var e=this.scope.viewModel.tile.realTime;this.restoreContext={singleVisualConfig:s.clone(e.singleVisualConfig),dataWindow:e.config.dataWindow}},p.prototype.restoreRealTimeTileContext=function(){var e,t=this.scope.viewModel.tile,i=t.realTime;i.singleVisualConfig&&this.restoreContext&&(i.hideVisual&&(i.hideVisual=!1),e=this.services,d.UpdateRealTimeTile(t,this.restoreContext.singleVisualConfig,this.restoreContext.dataWindow,this.scope.selectedModel,i.schema,e.pinVisual,e.visualPlugin,e.visualQueryGenerator,e.telemetryService))},p.prototype.addPackageDetails=function(e){var t=this.scope.tileModel;t&&t.contract.tilePackage&&(t=t.contract.tilePackage,e.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_PakageId"),t.id.toString())),t.lastRefreshTime&&(e.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_PakageLastRefreshTime"),i.convertRefreshTimeToLocaleString(t.lastRefreshTime,this.services.localizationService))),null!=t.publishOrRefreshStatus&&e.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_PakageLastRefreshStatus"),t.publishOrRefreshStatus.toString()))),t.NextRefreshTime&&e.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_PakageNextRefreshTime"),i.convertRefreshTimeToLocaleString(t.NextRefreshTime,this.services.localizationService))),t.contentProviderId&&e.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_PakageContentProviderId"),t.contentProviderId.toString())))},p.prototype.addModelDetails=function(e){var t=this.scope.selectedModel;t&&(e.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_ModelId"),t.id.toString())),e.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_ModelLastRefreshTime"),t.lastRefreshTimeInLocaleString)),null!=t.contract.lastRefreshStatus&&e.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_ModelLastRefreshStatus"),t.contract.lastRefreshStatus.toString())),t.contract.nextRefreshTime&&e.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_ModelNextRefreshTime"),i.convertRefreshTimeToLocaleString(t.contract.nextRefreshTime,this.services.localizationService))),t.contract.lastTimeAModelChangeWasDetectedInTheCluster&&e.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_ModelLastTimeAModelChangeWasDetectedInTheCluster"),i.convertRefreshTimeToLocaleString(t.contract.lastTimeAModelChangeWasDetectedInTheCluster,this.services.localizationService))),t.contract.onPremModelConnectionString&&e.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_ModelOnPremModelConnectionString"),t.contract.onPremModelConnectionString)),null!=t.contract.forcedRLS&&e.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_ModelForcedRLS"),String(t.contract.forcedRLS))),null!=t.contract.dataCacheMode&&e.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_ModelDirectQueryMode"),String(this.getDirectQueryModeDisplayString(t.contract.dataCacheMode)))),null!=t.contract.isRefreshedByContentProvider&&e.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_ModelIsRefreshedByContentProvider"),String(t.contract.isRefreshedByContentProvider))))},p.prototype.getDirectQueryModeDisplayString=function(e){switch(e){case t.Import:return this.services.localizationService.get("BooleanFalse");case t.DirectQuery:return this.services.localizationService.get("BooleanTrue");case t.Mixed:return this.services.localizationService.get("Mixed")}},p.prototype.addTileDetails=function(e){var t=this.scope.tileModel;e.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_TileId"),t.id.toString()));var i=t.contract;i&&(i.errorCode&&e.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_ErrorCode"),i.errorCode.toString())),(t=i.queryResultError)&&(e.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_ErrorId"),t.id.toString())),e.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_ErrorType"),t.type.toString())),e.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_ErrorDetail"),t.errorDetail)),e.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_ErrorRequestActivityId"),t.rootActivityId))),i.queryHash&&e.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_QueryHash"),i.queryHash.toString())))},e.TileEditorController=p}(u.sidePanes||(u.sidePanes={}))}(powerbi=powerbi||{}),function(e){var t;((t=e.sidePanes||(e.sidePanes={})).directives||(t.directives={})).TileGallery=function(){this.controller=e.common.createController(t.controllers.TileGalleryController),this.restrict="E",this.bindToController=!0,this.controllerAs="$ctrl",this.scope={},this.templateUrl="components/tileEditor/tileGallery.html"}}(powerbi=powerbi||{}),function(o){!function(e){var i;function t(e,t){this.scope=e,this.services=t,this.tileGroups=i.getTileGalleryGroups(t.asyncFeatureSwitchService.featureSwitches.webContentTilesTenantEnabled,this.services.localizationService),this.clearOutTemporaryTile()}e=e.controllers||(e.controllers={}),i=o.dataServices.models.TileFactory,t.createOptions=function(){return{additionalServices:["modelConverter","dashboardService","taskPaneSliderService","tileSelectionService","asyncFeatureSwitchService","localizationService"]}},t.prototype.closeTileGalleryPane=function(){this.selectedTile=null,this.services.taskPaneSliderService.collapsePane()},t.prototype.select=function(e){this.selectedTile=e},t.prototype.next=function(){var e=this.services.modelConverter.convertTile(this.selectedTile.defaultTileContract),t=o.dataServices.ContractUtils.getMasterLayoutPosition(e.contract);t.width=t.width||2,t.height=t.height||2,this.services.dashboardService.addTemporaryTile(e.contract)},t.prototype.clearOutTemporaryTile=function(){return __awaiter(this,void 0,o.Promise,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return[4,this.services.tileSelectionService.getSelected()];case 1:return(t=e.sent())&&t.isTemporary&&this.services.dashboardService.removeTemporaryTile(t),[2]}})})},e.TileGalleryController=t}(o.sidePanes||(o.sidePanes={}))}(powerbi=powerbi||{}),function(o){var e;((e=o.sidePanes||(o.sidePanes={})).directives||(e.directives={})).EditIframeWidget=function(e,t){var i=this;this.explorationSerializer=e,this.visualPlugin=t,this.replace=!0,this.restrict="E",this.templateUrl="components/tileEditor/widgets/editIframeWidget.html",this.link=function(e){var t=e.viewModel.tile;e.viewModel=new o.models.EditIframeWidgetModel(t,i.explorationSerializer,i.visualPlugin)}}}(powerbi=powerbi||{}),function(o){var e;((e=o.sidePanes||(o.sidePanes={})).directives||(e.directives={})).EditImageWidget=function(e,t){var i=this;this.explorationSerializer=e,this.visualPlugin=t,this.replace=!0,this.restrict="E",this.templateUrl="components/tileEditor/widgets/editImageWidget.html",this.link=function(e){var t=e.viewModel.tile;t.image.isStatic=!0,e.viewModel=new o.models.EditImageWidgetModel(t,i.explorationSerializer,i.visualPlugin),e.onChange=function(){t.resetTileErrors&&t.resetTileErrors()},e.$on(o.common.constants.scopeDestroyEventName,function(){t.resetTileErrors&&t.resetTileErrors()})}}}(powerbi=powerbi||{}),function(e){var t;((t=e.sidePanes||(e.sidePanes={})).directives||(t.directives={})).EditTextWidget=function(){this.controller=e.common.createController(t.controllers.widgets.EditTextWidgetController),this.replace=!0,this.restrict="E",this.templateUrl="components/tileEditor/widgets/editTextWidget.html"}}(powerbi=powerbi||{}),function(a){var e;(function(e){var o;function t(e,t){this.services=t,this.scope=e;e=this.scope.viewModel.tile;this.scope.viewModel=new a.models.EditTextWidgetModel(e,this.services.featureSwitchService,this.services.explorationSerializer,this.services.visualPlugin),this.initializeViewModelProperties()}e=e.widgets||(e.widgets={}),o=a.common.controllers.ToolbarOverlay,t.createOptions=function(){return{additionalServices:["explorationSerializer","featureSwitchService","moduleLoader","localizationService","promiseFactory","visualHostTooltipServiceFactory","visualPlugin","$element"],scopedDependencies:["uiComponent"]}},t.prototype.initializeViewModelProperties=function(){var t=this,e=this.scope.viewModel,i=a.Prototype.inherit(a.explore.services.createVisualHostServices(__assign(__assign({},this.services),{geolocation:void 0,geocoder:void 0,visualHostTooltipService:this.services.visualHostTooltipServiceFactory.create()})),function(e){e.getViewMode=function(){return 1},e.persistProperties=function(e){return t.persistProperties(e)},e.setToolbar=function(e){return t.setToolbar(e)},e.getUIComponentFactory=function(){return t.services.uiComponent.getUIComponentFactory(void 0)}});e.visualModel={type:a.dataServices.TileUtils.getVisualType(e.tile.config),viewport:{height:220},dataTransforms:e.tile.composite.visual.dataTransforms,data:{dataView:null},hostServices:i,themeCollection:{}};i=this.services.$element.find(o.ContainerSelector);this.toolbarOverlay=o.create(i,null,{layout:"stackedToolbar",theme:"lightTheme"})},t.prototype.$onInit=function(){var i=this,o=this.scope.$watch(function(){return 0<i.services.$element.find(".ql-editor").length},function(e,t){t!==e&&(i.services.$element.find(".ql-editor").attr("aria-label",i.services.localizationService.get("EditWidget_Details")),o())})},t.prototype.persistProperties=function(e){for(var t=this.scope.viewModel.tile.composite.visual,i=0,o=e;i<o.length;i++){var r=o[i];a.data.DataViewObjectDefinitions.ensure(t.dataTransforms.objects,r.objectName,r.selector).properties=r.properties,t.dataViews[0].metadata.objects||(t.dataViews[0].metadata.objects={}),t.dataViews[0].metadata.objects[r.objectName]=r.properties,t.visual&&t.visual.onDataChanged({dataViews:t.dataViews})}this.scope.$applyAsync(_.noop)},t.prototype.setToolbar=function(e){this.toolbarOverlay.setToolbar(e),this.toolbarOverlay.show()},e.EditTextWidgetController=t})((e=a.sidePanes||(a.sidePanes={})).controllers||(e.controllers={}))}(powerbi=powerbi||{}),function(e){var t;((t=e.sidePanes||(e.sidePanes={})).directives||(t.directives={})).EditVideoWidget=function(){this.controller=e.common.createController(t.controllers.widgets.EditVideoWidgetController),this.replace=!0,this.restrict="E",this.templateUrl="components/tileEditor/widgets/editVideoWidget.html"}}(powerbi=powerbi||{}),function(o){var e;(function(e){function a(e,t){var i=this;this.scope=e,this.services=t;t=this.scope.viewModel.tile;this.scope.viewModel=new o.models.EditVideoWidgetModel(t,this.services.explorationSerializer,this.services.visualPlugin),this.scope.url=t.iframe.srcUrl,this.scope.inputChanged=function(){return i.inputChanged()}}e=e.widgets||(e.widgets={}),a.createOptions=function(){return{additionalServices:["explorationSerializer","visualPlugin"]}},a.prototype.inputChanged=function(){var e=this.scope.url,t=this.scope.viewModel.tile.iframe,i=this.parseUrl(e),o=i.hostname.toLowerCase();if(("www.youtube.com"===o||"youtube.com"===o)&&i.queryParams.v)return t.srcUrl=e,void(t.embedCode=jsCommon.StringExtensions.format(a.youtubeEmbedTemplate,i.queryParams.v+i.search));if("youtu.be"===o){var r=_.trimStart(i.pathname,"/");if(r)return t.srcUrl=e,void(t.embedCode=jsCommon.StringExtensions.format(a.youtubeEmbedTemplate,r+i.search))}else if(_.includes(o,"vimeo.com")){o=this.parseVimeoVideoId(e);if(null!=o)return t.srcUrl=e,void(t.embedCode=jsCommon.StringExtensions.format(a.vimeoEmbedTemplate,o))}t.srcUrl="",t.embedCode=""},a.prototype.parseUrl=function(e){var t=document.createElement("a");return t.href=e,{hostname:t.hostname,pathname:t.pathname,search:t.search,queryParams:jsCommon.QueryStringUtil.parseQueryString(t.search)}},a.prototype.parseVimeoVideoId=function(e){e=e.match(/^.*(vimeo\.com\/)((channels\/[A-z]+\/)|(groups\/[A-z]+\/videos\/))?([0-9]+)((#|\?)(.*))?$/i);if(e)return e[5]},a.youtubeEmbedTemplate='<iframe role="presentation" width="100%" height="100%" src="https://www.youtube.com/embed/{0}" frameborder="0"></iframe>',a.vimeoEmbedTemplate='<iframe role="presentation" width="100%" height="100%" src="https://player.vimeo.com/video/{0}" frameborder="0"></iframe>',e.EditVideoWidgetController=a})((e=o.sidePanes||(o.sidePanes={})).controllers||(e.controllers={}))}(powerbi=powerbi||{}),function(e){((e=e.sidePanes||(e.sidePanes={})).directives||(e.directives={})).ValidateRealTimeTileEdit=function(){this.require="ngModel",this.link=function(e,t,i,o){o.$validators.realTimeTileEdit=function(e,t){return!e||!e.realTimeVisual||!!e.realTimeVisual.heading1}}}}(powerbi=powerbi||{}),function(e){!function(e){var t;(t=e.WorkspaceProvisionState||(e.WorkspaceProvisionState={}))[t.Enabled=0]="Enabled",t[t.Disabled=1]="Disabled",t[t.Deleting=2]="Deleting",t[t.DisabledByDeprovisioning=3]="DisabledByDeprovisioning",t[t.DeprovisioningFailed=4]="DeprovisioningFailed",t[t.DeletedByDeprovision=5]="DeletedByDeprovision",e.createRelatedContentForModelProxy=function(e){return new i(e)};var i=(o.prototype.getRelatedContent=function(e,t){t=this.httpService.powerbiRequestOptions(t,"getRelatedContentForModel",{isAdminRequest:!1});return this.httpService.get("/metadata/gallery/models/"+e+"/relatedcontent",t)},o);function o(e){this.httpService=e}}(e.sidePanes||(e.sidePanes={}))}(powerbi=powerbi||{});