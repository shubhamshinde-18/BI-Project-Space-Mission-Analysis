'use strict'; 
"use strict";
this.parseTimeMarkers = this.parseTimeMarkers || {};
var marker = this.parseTimeMarkers['powerbiportal.explore.bundle.min.js'] || (this.parseTimeMarkers['powerbiportal.explore.bundle.min.js'] = {});
marker.startEval = window.jsCommon && window.jsCommon.performance && window.jsCommon.performance.now ? window.jsCommon.performance.now() : Date.now(); marker.isExternal = false;
if (window.perfTracking && window.perfTracking.startBundleEval) window.perfTracking.startBundleEval('powerbiportal.explore.bundle.min.js');var powerbi,__spreadArray=this&&this.__spreadArray||function(e,t){for(var r=0,i=t.length,a=e.length;r<i;r++,a++)e[a]=t[r];return e},__extends=this&&this.__extends||(function(){var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}})(),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},__decorate=this&&this.__decorate||function(e,t,r,i){var a,o=arguments.length,n=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;0<=s;s--)(a=e[s])&&(n=(o<3?a(n):3<o?a(t,r,n):a(t,r))||n);return 3<o&&n&&Object.defineProperty(t,r,n),n},__awaiter=this&&this.__awaiter||function(e,n,s,l){return new(s=s||Promise)(function(r,t){function i(e){try{o(l.next(e))}catch(e){t(e)}}function a(e){try{o(l.throw(e))}catch(e){t(e)}}function o(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(i,a)}o((l=l.apply(e,n||[])).next())})},__generator=this&&this.__generator||function(r,i){var a,o,n,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return (function(t){if(a)throw new TypeError("Generator is already executing.");for(;s;)try{if(a=1,o&&(n=2&t[0]?o.return:t[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,t[1])).done)return n;switch(o=0,(t=n?[2&t[0],n.value]:t)[0]){case 0:case 1:n=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,o=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(n=0<(n=s.trys).length&&n[n.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!n||t[1]>n[0]&&t[1]<n[3])){s.label=t[1];break}if(6===t[0]&&s.label<n[1]){s.label=n[1],n=t;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(t);break}n[2]&&s.ops.pop(),s.trys.pop();continue}t=i.call(r,s)}catch(e){t=[6,e],o=0}finally{a=n=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}})([t,e])}}};!(function(a){!(function(t){var e=jsCommon.Utility,r=a.telemetryEventFactory,i=a.telemetry.EventFactories;e?e.generateGuid:Function.prototype;(e=t.OpenExplorationSource||(t.OpenExplorationSource={})).Normal="Normal",e.EmailSubscription="EmailSubscription",e.ReportInvitation="ReportInvitation",e.SubscribeOthers="SubscribeOthers",e.Commenting="Commenting",e.Invalid="Invalid",t.EXRetrieveFromVisualContainerCacheEventName="PBI.EX.RetrieveFromVisualContainerCache",t.EXRetrieveFromVisualContainerCache=i[t.EXRetrieveFromVisualContainerCacheEventName]=function(e){return r({name:t.EXRetrieveFromVisualContainerCacheEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,optionalParameters:["warning"],loggers:t.EXRetrieveFromVisualContainerCacheLoggers})},t.EXRunQueryEventName="PBI.EX.RunQuery",t.EXRunQuery=i[t.EXRunQueryEventName]=function(e){return r({name:t.EXRunQueryEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.EXRunQueryLoggers,logRatio:0})},t.EXRunQueryImplEventName="PBI.EX.RunQueryImpl",t.EXRunQueryImpl=i[t.EXRunQueryImplEventName]=function(e){return r({name:t.EXRunQueryImplEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.EXRunQueryImplLoggers,logRatio:0})},t.EXGetCachedQueryOrGenerateEventName="PBI.EX.GetCachedQueryOrGenerate",t.EXGetCachedQueryOrGenerate=i[t.EXGetCachedQueryOrGenerateEventName]=function(e){return r({name:t.EXGetCachedQueryOrGenerateEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.EXGetCachedQueryOrGenerateLoggers,logRatio:0})},t.EXVisualFirstLoadEventName="PBI.EX.VisualFirstLoad",t.EXVisualFirstLoad=i[t.EXVisualFirstLoadEventName]=function(e){return r({name:t.EXVisualFirstLoadEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,optionalParameters:["isServerCacheEligible","staleCacheResultFromServer","cacheResultFromServer"],loggers:t.EXVisualFirstLoadLoggers})},t.EXToggleVisualDisplayEventName="PBI.EX.ToggleVisualDisplay",t.EXToggleVisualDisplay=i[t.EXToggleVisualDisplayEventName]=function(e){return r({name:t.EXToggleVisualDisplayEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.EXToggleVisualDisplayLoggers,logExpAssignment:!0})},t.EXGetExplorationEventName="PBI.EX.GetExploration",t.EXGetExploration=i[t.EXGetExplorationEventName]=function(e){return r({name:t.EXGetExplorationEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,optionalParameters:["transferSize","startTime","requestStart","responseEnd","responseStart","duration","timeToFirstByte"],loggers:t.EXGetExplorationLoggers})},t.EXDeserializeExplorationEventName="PBI.EX.DeserializeExploration",t.EXDeserializeExploration=i[t.EXDeserializeExplorationEventName]=function(e){return r({name:t.EXDeserializeExplorationEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,optionalParameters:["reportGuid"],loggers:t.EXDeserializeExplorationLoggers})},t.EXOpenExplorationEventName="PBI.EX.OpenExploration",t.EXOpenExploration=i[t.EXOpenExplorationEventName]=function(e){return r({name:t.EXOpenExplorationEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,optionalParameters:["reportGuid","isUsageMetrics","groupObjectId","tags","isReadonlyGroup","scrubUserInfo","isB2B","enterpriseCapacitySkuTier","bookmarkObjectId","useMaxParallelQueryData","synchronous","areAnySectionQuickExplore","creationSource"],loggers:t.EXOpenExplorationLoggers,shouldLogStartEnd:!0,logExpAssignment:!0})},t.EXExplorationStateApplyImpactEventName="PBI.EX.ExplorationStateApplyImpact",t.EXExplorationStateApplyImpact=i[t.EXExplorationStateApplyImpactEventName]=function(e){return r({name:t.EXExplorationStateApplyImpactEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.EXExplorationStateApplyImpactLoggers})},t.EXSwitchSectionEventName="PBI.EX.SwitchSection",t.EXSwitchSection=i[t.EXSwitchSectionEventName]=function(e){return r({name:t.EXSwitchSectionEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.EXSwitchSectionLoggers})},t.EXSwitchToAdjacentSectionEventName="PBI.EX.SwitchToAdjacentSection",t.EXSwitchToAdjacentSection=i[t.EXSwitchToAdjacentSectionEventName]=function(e){return r({name:t.EXSwitchToAdjacentSectionEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.EXSwitchToAdjacentSectionLoggers})},t.EXNavigateBackEventName="PBI.EX.NavigateBack",t.EXNavigateBack=i[t.EXNavigateBackEventName]=function(e){return r({name:t.EXNavigateBackEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.EXNavigateBackLoggers,logExpAssignment:!0})},t.EXNavigationButtonClickedEventName="PBI.EX.NavigationButtonClicked",t.EXNavigationButtonClicked=i[t.EXNavigationButtonClickedEventName]=function(e){return r({name:t.EXNavigationButtonClickedEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.EXNavigationButtonClickedLoggers,logExpAssignment:!0})},t.EXVisualQueryGeneratorWarningEventName="PBI.EX.VisualQueryGeneratorWarning",t.EXVisualQueryGeneratorWarning=i[t.EXVisualQueryGeneratorWarningEventName]=function(e){return r({name:t.EXVisualQueryGeneratorWarningEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.EXVisualQueryGeneratorWarningLoggers})},t.EXVisualQueryGeneratorErrorEventName="PBI.EX.VisualQueryGeneratorError",t.EXVisualQueryGeneratorError=i[t.EXVisualQueryGeneratorErrorEventName]=function(e){return r({name:t.EXVisualQueryGeneratorErrorEventName,info:e,category:a.TelemetryCategory.CriticalError,loggers:t.EXVisualQueryGeneratorErrorLoggers})},t.EXGroupsGroupsActionEventName="PBI.EX.Groups.GroupsAction",t.EXGroupsGroupsAction=i[t.EXGroupsGroupsActionEventName]=function(e){return r({name:t.EXGroupsGroupsActionEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.EXGroupsGroupsActionLoggers})},t.EXGroupsBinBySizeActionEventName="PBI.EX.Groups.BinBySizeAction",t.EXGroupsBinBySizeAction=i[t.EXGroupsBinBySizeActionEventName]=function(e){return r({name:t.EXGroupsBinBySizeActionEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.EXGroupsBinBySizeActionLoggers})},t.EXGroupsBinByCountActionEventName="PBI.EX.Groups.BinByCountAction",t.EXGroupsBinByCountAction=i[t.EXGroupsBinByCountActionEventName]=function(e){return r({name:t.EXGroupsBinByCountActionEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.EXGroupsBinByCountActionLoggers})},t.EXGroupsUsageEventName="PBI.EX.Groups.Usage",t.EXGroupsUsage=i[t.EXGroupsUsageEventName]=function(e){return r({name:t.EXGroupsUsageEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.EXGroupsUsageLoggers})},t.EXGroupsErrorEventName="PBI.EX.Groups.Error",t.EXGroupsError=i[t.EXGroupsErrorEventName]=function(e){return r({name:t.EXGroupsErrorEventName,info:e,category:a.TelemetryCategory.CriticalError,loggers:t.EXGroupsErrorLoggers})},t.EXModelChangeEventName="PBI.EX.ModelChange",t.EXModelChange=i[t.EXModelChangeEventName]=function(e){return r({name:t.EXModelChangeEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.EXModelChangeLoggers})},t.EXMeasuresEventName="PBI.EX.Measures",t.EXMeasures=i[t.EXMeasuresEventName]=function(e){return r({name:t.EXMeasuresEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.EXMeasuresLoggers})},t.EXReportMeasureDataTypeChangeEventName="PBI.EX.ReportMeasureDataTypeChange",t.EXReportMeasureDataTypeChange=i[t.EXReportMeasureDataTypeChangeEventName]=function(e){return r({name:t.EXReportMeasureDataTypeChangeEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.EXReportMeasureDataTypeChangeLoggers})},t.EXReportMeasureDataCategoryChangeEventName="PBI.EX.ReportMeasureDataCategoryChange",t.EXReportMeasureDataCategoryChange=i[t.EXReportMeasureDataCategoryChangeEventName]=function(e){return r({name:t.EXReportMeasureDataCategoryChangeEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.EXReportMeasureDataCategoryChangeLoggers})},t.EXReportMeasureMoveRoleKindEventName="PBI.EX.ReportMeasureMoveRoleKind",t.EXReportMeasureMoveRoleKind=i[t.EXReportMeasureMoveRoleKindEventName]=function(e){return r({name:t.EXReportMeasureMoveRoleKindEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.EXReportMeasureMoveRoleKindLoggers})},t.EXQuickCalcMeasureEditedEventName="PBI.EX.QuickCalcMeasureEdited",t.EXQuickCalcMeasureEdited=i[t.EXQuickCalcMeasureEditedEventName]=function(e){return r({name:t.EXQuickCalcMeasureEditedEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.EXQuickCalcMeasureEditedLoggers})},t.EXQuickCalcMeasureDeletedEventName="PBI.EX.QuickCalcMeasureDeleted",t.EXQuickCalcMeasureDeleted=i[t.EXQuickCalcMeasureDeletedEventName]=function(e){return r({name:t.EXQuickCalcMeasureDeletedEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.EXQuickCalcMeasureDeletedLoggers})},t.EXVisualDrillableRoleActiveItemsFixedEventName="PBI.EX.VisualDrillableRoleActiveItemsFixed",t.EXVisualDrillableRoleActiveItemsFixed=i[t.EXVisualDrillableRoleActiveItemsFixedEventName]=function(e){return r({name:t.EXVisualDrillableRoleActiveItemsFixedEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.EXVisualDrillableRoleActiveItemsFixedLoggers})},t.PersistentStateSerializationErrorEventName="PBI.PersistentState.SerializationError",t.PersistentStateSerializationError=i[t.PersistentStateSerializationErrorEventName]=function(e){return r({name:t.PersistentStateSerializationErrorEventName,baseEvent:t.ErrorWithStackTrace(e),info:e,category:a.TelemetryCategory.CriticalError,loggers:t.PersistentStateSerializationErrorLoggers})},t.PodSerializationErrorFixedEventName="PBI.Pod.SerializationErrorFixed",t.PodSerializationErrorFixed=i[t.PodSerializationErrorFixedEventName]=function(e){return r({name:t.PodSerializationErrorFixedEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.PodSerializationErrorFixedLoggers})},t.SerializationErrorEventName="PBI.SerializationError",t.SerializationError=i[t.SerializationErrorEventName]=function(e){return r({name:t.SerializationErrorEventName,baseEvent:t.ErrorWithStackTrace(e),info:e,category:a.TelemetryCategory.CriticalError,loggers:t.SerializationErrorLoggers})},t.EXEmptyVisualContainerConfigEventName="PBI.EX.EmptyVisualContainerConfig",t.EXEmptyVisualContainerConfig=i[t.EXEmptyVisualContainerConfigEventName]=function(e){return r({name:t.EXEmptyVisualContainerConfigEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.EXEmptyVisualContainerConfigLoggers})},t.ClipboardServicePasteEventName="PBI.ClipboardService.Paste",t.ClipboardServicePaste=i[t.ClipboardServicePasteEventName]=function(e){return r({name:t.ClipboardServicePasteEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.ClipboardServicePasteLoggers})},t.ClipboardServiceUnsupportedVersionEventName="PBI.ClipboardService.UnsupportedVersion",t.ClipboardServiceUnsupportedVersion=i[t.ClipboardServiceUnsupportedVersionEventName]=function(e){return r({name:t.ClipboardServiceUnsupportedVersionEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.ClipboardServiceUnsupportedVersionLoggers})},t.DataPointLassoSelectPreviewSerializedEventName="PBI.DataPointLassoSelect.PreviewSerialized",t.DataPointLassoSelectPreviewSerialized=i[t.DataPointLassoSelectPreviewSerializedEventName]=function(e){return r({name:t.DataPointLassoSelectPreviewSerializedEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DataPointLassoSelectPreviewSerializedLoggers})},t.EXLoopingSQExprEventName="PBI.EX.LoopingSQExpr",t.EXLoopingSQExpr=i[t.EXLoopingSQExprEventName]=function(e){return r({name:t.EXLoopingSQExprEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.EXLoopingSQExprLoggers})},t.EXGetLinguisticSchemaEventName="PBI.EX.GetLinguisticSchema",t.EXGetLinguisticSchema=i[t.EXGetLinguisticSchemaEventName]=function(e){return r({name:t.EXGetLinguisticSchemaEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.EXGetLinguisticSchemaLoggers})},t.EXGetAutoRefreshAdminConfigEventName="PBI.EX.GetAutoRefreshAdminConfig",t.EXGetAutoRefreshAdminConfig=i[t.EXGetAutoRefreshAdminConfigEventName]=function(e){return r({name:t.EXGetAutoRefreshAdminConfigEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.EXGetAutoRefreshAdminConfigLoggers})},t.EXGetChangeDetectionAdminConfigEventName="PBI.EX.GetChangeDetectionAdminConfig",t.EXGetChangeDetectionAdminConfig=i[t.EXGetChangeDetectionAdminConfigEventName]=function(e){return r({name:t.EXGetChangeDetectionAdminConfigEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.EXGetChangeDetectionAdminConfigLoggers})},t.EXAnchorTimeUndefinedEventName="PBI.EX.AnchorTimeUndefined",t.EXAnchorTimeUndefined=i[t.EXAnchorTimeUndefinedEventName]=function(e){return r({name:t.EXAnchorTimeUndefinedEventName,info:e,category:a.TelemetryCategory.CriticalError,loggers:t.EXAnchorTimeUndefinedLoggers})},t.EXGetAPRConfigFailureEventName="PBI.EX.GetAPRConfigFailure",t.EXGetAPRConfigFailure=i[t.EXGetAPRConfigFailureEventName]=function(e){return r({name:t.EXGetAPRConfigFailureEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.EXGetAPRConfigFailureLoggers})},t.EXDefnsDuplicateSelectorEventName="PBI.EX.DefnsDuplicateSelector",t.EXDefnsDuplicateSelector=i[t.EXDefnsDuplicateSelectorEventName]=function(e){return r({name:t.EXDefnsDuplicateSelectorEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.EXDefnsDuplicateSelectorLoggers})},t.EXCertifiedTelemetryChildrenCountMismatchEventName="PBI.EX.CertifiedTelemetryChildrenCountMismatch",t.EXCertifiedTelemetryChildrenCountMismatch=i[t.EXCertifiedTelemetryChildrenCountMismatchEventName]=function(e){return r({name:t.EXCertifiedTelemetryChildrenCountMismatchEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.EXCertifiedTelemetryChildrenCountMismatchLoggers})},t.EXUndoEventTimeEventName="PBI.EX.UndoEventTime",t.EXUndoEventTime=i[t.EXUndoEventTimeEventName]=function(e){return r({name:t.EXUndoEventTimeEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.EXUndoEventTimeLoggers})}})(a.telemetry||(a.telemetry={}))})(powerbi=powerbi||{}),(function(e){!(function(e){function t(){}e=e.contracts||(e.contracts={}),t.isValidBookmark=function(e){return e&&(t.isBookmarkGroup(e)||t.isStateBookmark(e))},t.isBookmarkGroup=function(e){return void 0!==e.children},t.isStateBookmark=function(e){return!t.isBookmarkGroup(e)},t.isWebBookmark=function(e){return void 0!==e.type},e.BookmarkExtensions=t,(e=e.BookmarkActions||(e.BookmarkActions={})).Add="AddBookmark",e.Apply="ApplyBookmark",e.Remove="RemoveBookmark",e.Move="MoveBookmark",e.Update="UpdateBookmark",e.Rename="RenameBookmark",e.Group="GroupBookmarks",e.Ungroup="UngroupBookmarks"})(e.explore||(e.explore={}))})(powerbi=powerbi||{}),(function(a){var o,e,t,i;function n(e){return _.includes(Object.keys(e),"extends")}function s(e){return _.map(e,(function(e){return e[i.readerType(e)]}))}o=a.explore||(a.explore={}),e=o.contracts||(o.contracts={}),t=jsCommon.ArrayExtensions,i=a.data.DataReaderUtils,e.createDataSourceArray=function(e){return t.extendWithName(t.extendWithId(e=void 0===e?[]:e))},e.dataSourceForModel=function(e){var t=o.constants.DefaultSchemaName,r=e.capacityObjectId&&void 0===e.queryCachingState?void 0:2===e.queryCachingState,i=e.datasetHost;return{type:a.common.constants.dsrDataReaderType,id:e.id,name:t,dsr:{schemaName:t,vsName:e.vsName,dbName:e.dbName,modelId:e.id,isQueryCachingEnabled:r,lastRefreshTime:e.lastRefreshTime,isLimitedParallelQueryModel:i===a.common.contracts.DatasetHost.ASOnPrem}}},(e=e.DataSource||(e.DataSource={})).isExtension=n,e.referenced=function(e,t){if(!_.isEmpty(e)){var r=i.findSchemas(t),e=_.isEmpty(r)?e:_.filter(e,(function(e){return _.includes(r,e.name)}));return s(e)}},e.queried=function(e,t){if(!_.isEmpty(e)){var r=i.findSchemas(t);return _.isEmpty(r)?_.filter(e,(function(e){return!n(e)})):_.chain(e).filter((function(e){return _.includes(r,e.name)})).map((function(t){return n(t)?_.find(e,(function(e){return e.name===t.extends})):t})).uniq().value()}},e.dataReaderDataSources=s})(powerbi=powerbi||{}),(function(e){var t;(t=(t=(t=e.explore||(e.explore={})).contracts||(t.contracts={})).AutoPageRefreshOption||(t.AutoPageRefreshOption={})).CDM="CDM",t.APR="APR",t.Type=e.createEnumType([{value:t.APR,displayName:function(e){return e.get("PageRefresh_APR")}},{value:t.CDM,displayName:function(e){return e.get("ChangeDetection")}}])})(powerbi=powerbi||{}),(function(e){var t,r;t=e.explore||(e.explore={}),(t=(r=t.contracts||(t.contracts={})).SectionAlignmentOption||(r.SectionAlignmentOption={}))[t.Top=0]="Top",t[t.Middle=1]="Middle",(r=r.SectionAlignmentPosition||(r.SectionAlignmentPosition={})).top="Top",r.middle="Middle",r.Type=e.createEnumType([{value:r.top,displayName:function(e){return e.get("Top")}},{value:r.middle,displayName:function(e){return e.get("Middle")}}])})(powerbi=powerbi||{}),(function(e){var t;(t=(t=(t=e.explore||(e.explore={})).contracts||(t.contracts={})).SectionPageSizeTypes||(t.SectionPageSizeTypes={})).PageSizeTypes={Dynamic:"Dynamic",Standard:"Standard",Widescreen:"Widescreen",Cortana:"Cortana",Letter:"Letter",Tooltip:"Tooltip",Custom:"Custom"},t.Type=e.createEnumType([{value:t.PageSizeTypes.Widescreen,displayName:function(e){return e.get("PagePropertyPane_PageSizeType_Widescreen")}},{value:t.PageSizeTypes.Standard,displayName:function(e){return e.get("PagePropertyPane_PageSizeType_Standard")}},{value:t.PageSizeTypes.Letter,displayName:function(e){return e.get("PagePropertyPane_PageSizeType_Letter")}},{value:t.PageSizeTypes.Tooltip,displayName:function(e){return e.get("Tooltip")}},{value:t.PageSizeTypes.Custom,displayName:function(e){return e.get("Custom")}}])})(powerbi=powerbi||{}),(function(i){var d;(function(l){var e,p=jsCommon.ArrayExtensions,t=i.data.createDisplayNameGetter,u=i.data.DataViewObjectDefinitions,c=i.data.SQExprBuilder;(e=l.LinguisticSchemaSyncVersion||(l.LinguisticSchemaSyncVersion={}))[e.Unspecified=0]="Unspecified",e[e.QnaSuggestQuestions=1]="QnaSuggestQuestions",e[e.VisualColumnRenameTerms=2]="VisualColumnRenameTerms",l.createDefaultExploration=function(e,t,r,i,a){var o=d.constants,n={},s={useNewFilterPaneExperience:!0,allowChangeFilterTypes:!0,useStylableVisualContainerHeader:!0};return r.featureSwitches.enhancedTooltips&&(s.useEnhancedTooltips=!0),r.featureSwitches.exportDataMode&&(s.exportDataMode=1),r.featureSwitches.automatedInsights&&r.featureSwitches.automatedInsightsBackgroundRefresh&&r.featureSwitches.automatedInsightsEntryPointsEnabled&&r.featureSwitches.automatedInsightsTenantEnabled&&(s.allowAutomatedInsightsNotification=!0),r.featureSwitches.defaultAggrDisplayName&&(s.useDefaultAggregateDisplayName=!0),null!=i?u.setValue(n,{objectName:"section",propertyName:"verticalAlignment"},null,c.text(i)):u.setValue(n,{objectName:"section",propertyName:"verticalAlignment"},null,c.text(l.SectionAlignmentPosition.top)),{themeCollection:{baseTheme:d.util.ThemeUtils.getCurrentBaseThemeMetadata(r)},id:0,width:o.ExploreCanvasConstants.DefaultCanvasWidth,height:o.ExploreCanvasConstants.DefaultCanvasHeight,dataSources:l.createDataSourceArray(),sections:p.extendWithId([{id:0,name:"ReportSection",displayName:e,visualContainers:t,visualContainerGroups:__spreadArray([],t||[]),filters:[],size:{displayOption:1,width:o.ExploreCanvasConstants.DefaultWidescreenWidth,height:o.ExploreCanvasConstants.DefaultWidescreenHeight}}]),settings:_.isEmpty(s)?void 0:s,objects:n,creationSource:a}},l.ExplorationObjectDescriptors={outspacePane:{displayName:t("Exploration_FilterPane"),properties:{expanded:{type:{bool:!0}},visible:{type:{bool:!0}}}},section:{displayName:t("PagePropertyPane_PageAlignment"),properties:{verticalAlignment:{type:{enumeration:l.SectionAlignmentPosition.Type}}}}};r.prototype.value=function(){return!this.originalExploration&&this.originalExplorationJSON&&(this.originalExploration=jsCommon.JsonExtensions.tryParseJSON(this.originalExplorationJSON),this.originalExplorationJSON=void 0),this.originalExploration},r.Empty=new r,t=r;function r(e){"string"==typeof e?this.originalExplorationJSON=e:this.originalExploration=e}l.OriginalExploration=t})((d=i.explore||(i.explore={})).contracts||(d.contracts={}))})(powerbi=powerbi||{}),(function(e){var t;t=e.explore||(e.explore={}),(t=(e=t.contracts||(t.contracts={})).FilterContainer||(e.FilterContainer={})).ObjectType="filter",t.CommonObjectDescriptors={general:{properties:{requireSingleSelect:{type:{bool:!0}},isInvertedSelectionMode:{type:{bool:!0}}}}},(e=e.FilterType||(e.FilterType={}))[e.Categorical=0]="Categorical",e[e.Range=1]="Range",e[e.Advanced=2]="Advanced",e[e.Passthrough=3]="Passthrough",e[e.Visual=4]="Visual",e[e.TopN=5]="TopN",e[e.Include=6]="Include",e[e.Exclude=7]="Exclude",e[e.RelativeDate=8]="RelativeDate",e[e.Tuple=9]="Tuple",e[e.RelativeTime=10]="RelativeTime"})(powerbi=powerbi||{}),(function(e){(e=(e=(e=e.explore||(e.explore={})).contracts||(e.contracts={})).CollectedFilterSource||(e.CollectedFilterSource={}))[e.Self=1]="Self",e[e.Slicer=2]="Slicer"})(powerbi=powerbi||{}),(function(e){var t,r;t=e.explore||(e.explore={}),r=t.contracts||(t.contracts={}),e=e.data.createDisplayNameGetter,(t=r.Section||(r.Section={})).objectDescriptors={pageInformation:{displayName:e("PagePropertyPane_PageInformation"),properties:{pageInformationName:{displayName:e("Name"),type:{text:!0}},pageInformationQnaPodEnabled:{displayName:e("Generic_Qna"),type:{bool:!0}},pageInformationAltName:{displayName:e("PagePropertyPane_PageInformation_AltName_Placeholder"),type:{formatting:{altText:!0}}},pageInformationType:{displayName:e("Allow_As_Tooltip"),type:{bool:!0}}}},pageSize:{displayName:e("Canvas_Settings"),properties:{pageSizeTypes:{displayName:e("Type"),type:{enumeration:r.SectionPageSizeTypes.Type}},pageSizeWidth:{displayName:e("PagePropertyPane_PageSizeWidth"),type:{numeric:!0}},pageSizeHeight:{displayName:e("PagePropertyPane_PageSizeHeight"),type:{numeric:!0}}}},background:{displayName:e("PagePropertyPane_PageBackground"),properties:{color:{displayName:e("PagePropertyPane_PageBackgroundColor"),type:{fill:{solid:{color:!0}}}},image:{type:{image:{}}},transparency:{displayName:e("Transparency"),type:{numeric:!0}}}},displayArea:{displayName:e("PagePropertyPane_PageAlignment"),properties:{verticalAlignment:{displayName:e("Visual_Alignment_Vertical"),type:{enumeration:r.SectionAlignmentPosition.Type}}}},outspace:{displayName:e("PagePropertyPane_Outspace"),properties:{color:{displayName:e("PagePropertyPane_PageBackgroundColor"),type:{fill:{solid:{color:!0}}}},image:{type:{image:{}}},transparency:{displayName:e("Transparency"),type:{numeric:!0}}}},outspacePane:{displayName:e("Exploration_FilterPane"),properties:{backgroundColor:{displayName:e("PagePropertyPane_OutspacePane_BackgroundColor"),type:{fill:{solid:{color:!0}}},description:e("PagePropertyPane_OutspacePane_BackgroundColorTooltip")},transparency:{displayName:e("Transparency"),type:{numeric:!0},description:e("PagePropertyPane_OutspacePane_BackgroundTransparencyTooltip")},foregroundColor:{displayName:e("PagePropertyPane_OutspacePane_ForegroundColor"),type:{fill:{solid:{color:!0}}},description:e("PagePropertyPane_OutspacePane_ForegroundColorTooltip")},titleSize:{displayName:e("Visual_AxisTitleTextSize"),type:{integer:!0},description:e("PagePropertyPane_OutspacePane_TitleSizeTooltip")},searchTextSize:{displayName:e("PagePropertyPane_OutspacePane_SearchTextSize"),type:{integer:!0},description:e("PagePropertyPane_OutspacePane_SearchTextSizeTooltip")},headerSize:{displayName:e("PagePropertyPane_OutspacePane_HeaderSize"),type:{integer:!0},description:e("PagePropertyPane_OutspacePane_HeaderSizeTooltip")},fontFamily:{displayName:e("Visual_FontFamily"),type:{formatting:{fontFamily:!0}},description:e("PagePropertyPane_OutspacePane_FontFamilyTooltip")},border:{displayName:e("Visual_Border"),type:{bool:!0},description:e("PagePropertyPane_OutspacePane_LeftBorderTooltip")},borderColor:{displayName:e("PagePropertyPane_FilterCards_BorderColor"),type:{fill:{solid:{color:!0}}},description:e("PagePropertyPane_OutspacePane_BorderColorTooltip")},checkboxAndApplyColor:{displayName:e("Checkbox_Apply_Color_Title"),type:{fill:{solid:{color:!0}}},description:e("Checkbox_Apply_Color_Description")},inputBoxColor:{displayName:e("PagePropertyPane_FilterCards_InputBoxColor"),type:{fill:{solid:{color:!0}}},description:e("PagePropertyPane_OutspacePane_InputBoxColorTooltip")},width:{displayName:e("PagePropertyPane_PageSizeWidth"),type:{integer:!0}}}},filterCard:{displayName:e("PagePropertyPane_FilterCards"),properties:{backgroundColor:{displayName:e("PagePropertyPane_OutspacePane_BackgroundColor"),type:{fill:{solid:{color:!0}}},description:e("PagePropertyPane_FilterCards_BackgroundColorTooltip")},transparency:{displayName:e("Transparency"),type:{integer:!0},description:e("PagePropertyPane_FilterCards_BackgroundTransparencyTooltip")},border:{displayName:e("Visual_Border"),type:{bool:!0},description:e("PagePropertyPane_FilterCards_BorderTooltip")},borderColor:{displayName:e("PagePropertyPane_FilterCards_BorderColor"),type:{fill:{solid:{color:!0}}},description:e("PagePropertyPane_FilterCards_BorderColorTooltip")},foregroundColor:{displayName:e("PagePropertyPane_OutspacePane_ForegroundColor"),type:{fill:{solid:{color:!0}}},description:e("PagePropertyPane_FilterCards_ForegroundColorTooltip")},textSize:{displayName:e("Visual_TextSize"),type:{integer:!0},description:e("PagePropertyPane_FilterCards_TextSizeTooltip")},fontFamily:{displayName:e("Visual_FontFamily"),type:{formatting:{fontFamily:!0}},description:e("PagePropertyPane_FilterCards_FontFamilyTooltip")},inputBoxColor:{displayName:e("PagePropertyPane_FilterCards_InputBoxColor"),type:{fill:{solid:{color:!0}}},description:e("PagePropertyPane_FilterCards_InputBoxColorTooltip")}}},pageRefresh:{displayName:e("PageRefresh"),properties:{show:{displayName:e("Show"),type:{bool:!0}},refreshType:{displayName:e("AutoPageRefreshType"),type:{enumeration:r.AutoPageRefreshOption.Type}},duration:{displayName:e("AutoPageRefreshInterval"),type:{duration:!0}},dialogLauncher:{displayName:e("AutoPageRefreshInterval"),type:{}},measure:{displayName:e("NewMeasureName"),type:{readOnlyText:!0}},checkEvery:{displayName:e("CheckEvery"),type:{readOnlyText:!0}}}},personalizeVisual:{displayName:e("VisualHeader_ShowPersonalizeVisualButton"),properties:{show:{displayName:e("Show"),type:{bool:!0}},perspectiveRef:{displayName:e("PersonalizeVisual_PerspectivePropertyName"),type:{reference:{perspective:!0}}},applyToAllPages:{displayName:e("PagePropertyPane_ApplyToAllPages"),type:{applyToAllPages:!0}}}}},t.filterTransient=function(e){return _.filter(e,(function(e){return!e.transient}))},r.SectionProps={pageInformation:{pageInformationName:{objectName:"pageInformation",propertyName:"pageInformationName"},pageInformationQnaPodEnabled:{objectName:"pageInformation",propertyName:"pageInformationQnaPodEnabled"},pageInformationAltName:{objectName:"pageInformation",propertyName:"pageInformationAltName"},pageInformationType:{objectName:"pageInformation",propertyName:"pageInformationType"}},pageSize:{pageSizeTypes:{objectName:"pageSize",propertyName:"pageSizeTypes"},pageSizeWidth:{objectName:"pageSize",propertyName:"pageSizeWidth"},pageSizeHeight:{objectName:"pageSize",propertyName:"pageSizeHeight"}},background:{color:{objectName:"background",propertyName:"color"},image:{objectName:"background",propertyName:"image"},transparency:{objectName:"background",propertyName:"transparency"}},displayArea:{verticalAlignment:{objectName:"displayArea",propertyName:"verticalAlignment"}},outspace:{color:{objectName:"outspace",propertyName:"color"},image:{objectName:"outspace",propertyName:"image"},transparency:{objectName:"outspace",propertyName:"transparency"}},outspacePane:{backgroundColor:{objectName:"outspacePane",propertyName:"backgroundColor"},transparency:{objectName:"outspacePane",propertyName:"transparency"},foregroundColor:{objectName:"outspacePane",propertyName:"foregroundColor"},titleSize:{objectName:"outspacePane",propertyName:"titleSize"},searchTextSize:{objectName:"outspacePane",propertyName:"searchTextSize"},headerSize:{objectName:"outspacePane",propertyName:"headerSize"},fontFamily:{objectName:"outspacePane",propertyName:"fontFamily"},border:{objectName:"outspacePane",propertyName:"border"},borderColor:{objectName:"outspacePane",propertyName:"borderColor"},checkboxAndApplyColor:{objectName:"outspacePane",propertyName:"checkboxAndApplyColor"},inputBoxColor:{objectName:"outspacePane",propertyName:"inputBoxColor"},width:{objectName:"outspacePane",propertyName:"width"}},filterCard:{backgroundColor:{objectName:"filterCard",propertyName:"backgroundColor"},transparency:{objectName:"filterCard",propertyName:"transparency"},border:{objectName:"filterCard",propertyName:"border"},borderColor:{objectName:"filterCard",propertyName:"borderColor"},foregroundColor:{objectName:"filterCard",propertyName:"foregroundColor"},textSize:{objectName:"filterCard",propertyName:"textSize"},fontFamily:{objectName:"filterCard",propertyName:"fontFamily"},inputBoxColor:{objectName:"filterCard",propertyName:"inputBoxColor"}},pageRefresh:{show:{objectName:"pageRefresh",propertyName:"show"},refreshType:{objectName:"pageRefresh",propertyName:"refreshType"},duration:{objectName:"pageRefresh",propertyName:"duration"},dialogLauncher:{objectName:"pageRefresh",propertyName:"dialogLauncher"},measure:{objectName:"pageRefresh",propertyName:"measure"},checkEvery:{objectName:"pageRefresh",propertyName:"checkEvery"}},personalizeVisual:{show:{objectName:"personalizeVisual",propertyName:"show"},perspectiveRef:{objectName:"personalizeVisual",propertyName:"perspectiveRef"},applyToAllPages:{objectName:"personalizeVisual",propertyName:"applyToAllPages"}}}})(powerbi=powerbi||{}),(function(e){(e=(e=e.explore||(e.explore={})).contracts||(e.contracts={})).SnapshotReportType="Report",(e=e.EmbedType||(e.EmbedType={}))[e.Static=0]="Static",e[e.Interactive=1]="Interactive"})(powerbi=powerbi||{}),(function(e){var t,r,i;t=e.explore||(e.explore={}),r=t.contracts||(t.contracts={}),i=e.visuals.builder,t=e.data.createDisplayNameGetter,(r=r.VisualContainerGroup||(r.VisualContainerGroup={})).objectType="visualContainerGroup",r.objectDescriptors={background:{displayName:t("Visual_Background"),properties:{show:{displayName:t("Visual_Show"),type:{bool:!0}},color:{displayName:t("Visual_Background_Color"),description:t("VisualGroup_Background_ColorDescription"),type:{fill:{solid:{color:!0}}}},transparency:{displayName:t("Transparency"),description:t("Visual_Background_TransparencyDescription"),type:{numeric:!0}}}},lockAspect:{displayName:t("Visual_BasicShape_LockAspect"),properties:{show:{displayName:t("Visual_Show"),type:{bool:!0}}}},general:{displayName:t("Visual_General_Properties"),properties:{x:{displayName:t("Visual_General_Properties_X_Coordinate"),type:{numeric:!0}},y:{displayName:t("Visual_General_Properties_Y_Coordinate"),type:{numeric:!0}},width:{displayName:t("Visual_General_Properties_Width"),type:{numeric:!0}},height:{displayName:t("Visual_General_Properties_Height"),type:{numeric:!0}},altText:{displayName:t("Visual_General_Properties_Description"),placeHolderText:t("Visual_General_Properties_Description_Placeholder"),type:{formatting:{altText:!0}}}}}},r.ObjectProps=i.getPropertyIdentifiers(r.objectDescriptors),r.isHidden=function(e){return e.isHidden},r.setHidden=function(e,t){e.isHidden=t},r.setDisplayName=function(e,t){e.displayName=t}})(powerbi=powerbi||{}),(function(e){var t;function p(e){return!!e.children}function u(e){return p(e)?t.VisualContainerGroup.isHidden(e):t.VisualContainer.isHidden(e.config.singleVisual)}e=e.explore||(e.explore={}),(t=e.contracts||(e.contracts={})).traverseVisualContainerGroups=function(e,t,r){return (function e(t,r,i,a){for(var o=0,n=i;o<n.length;o++){var s=n[o],l=t||u(s);r&&l||(a(s,l),p(s)&&e(l,r,s.children,a))}})(!1,r&&r.visibleOnly,e,t)},t.isVisualContainerGroup=p,t.isVisualContainer=function(e){return!e.children}})(powerbi=powerbi||{}),(function(e){var t,r,a;t=e.explore||(e.explore={}),r=t.contracts||(t.contracts={}),a=e.data.DataViewObjectDefinitions,(t=r.VisualTooltip||(r.VisualTooltip={})).Default="Default",t.Canvas="Canvas",t.Type=e.createEnumType([{value:t.Default,displayName:function(e){return e.get("Default")}},{value:t.Canvas,displayName:function(e){return e.get("ReportPage")}}]),t.getType=function(e){return e.type},t.SectionAuto="___AUTO___",(r.VisualTitle||(r.VisualTitle={})).isHidden=function(e,t){return void 0===t&&(t=!1),!!e&&(!1===e.show||void 0===e.show&&t)},(r=r.SingleVisualConfig||(r.SingleVisualConfig={})).clone=function(e){if(e){var t={visualType:e.visualType};e.syncGroup&&(t.syncGroup=_.cloneDeep(e.syncGroup)),e.columnProperties&&(t.columnProperties=_.cloneDeep(e.columnProperties)),e.query&&(t.query=e.query.clone()),e.queryOptions&&(t.queryOptions=_.cloneDeep(e.queryOptions)),e.objects&&(t.objects=a.clone(e.objects)),e.vcObjects&&(t.vcObjects=a.clone(e.vcObjects)),i=t,(r=e).mobileObjects&&(i.mobileObjects=a.clone(r.mobileObjects)),r.mobileVcObjects&&(i.mobileVcObjects=a.clone(r.mobileVcObjects)),e.hasDefaultSort&&(t.hasDefaultSort=e.hasDefaultSort);r=e.conversionSourceContext;return r&&(t.conversionSourceContext={visualType:r.visualType,query:r.query&&r.query.clone(),syncGroup:r.syncGroup}),e.display&&(t.display=_.cloneDeep(e.display)),t.hasUsedSmallMultiples=e.hasUsedSmallMultiples,t}var r,i},r.enumerateObjectRepetition=function(e,t){return(e=e&&e.getAdapter())?e.enumerateObjectRepetitionAsync?e.enumerateObjectRepetitionAsync():e.enumerateObjectRepetition?t.resolve(e.enumerateObjectRepetition()):t.resolve():t.resolve()}})(powerbi=powerbi||{}),(function(e){var t,r;t=e.explore||(e.explore={}),(t=(r=t.contracts||(t.contracts={})).VisualHeaderTooltip||(r.VisualHeaderTooltip={})).Text=r.VisualTooltip.Default,t.Canvas=r.VisualTooltip.Canvas,t.Type=e.createEnumType([{value:r.VisualTooltip.Default,displayName:function(e){return e.get("Text")}},{value:t.Canvas,displayName:function(e){return e.get("ReportPage")}}])})(powerbi=powerbi||{}),(function(e){var t,r,i,a,o,n,s,l,p;t=e.explore||(e.explore={}),r=t.contracts||(t.contracts={}),l=e.visuals.builder,p=e.data.createDisplayNameGetter,(a=i=r.VisualLink||(r.VisualLink={})).Back="Back",a.Bookmark="Bookmark",a.Drillthrough="Drillthrough",a.PageNavigation="PageNavigation",a.Qna="Qna",a.WebUrl="WebUrl",a.Type=e.createEnumType([{value:a.Back,displayName:function(e){return e.get("Generic_Back")}},{value:a.Bookmark,displayName:function(e){return e.get("Generic_Bookmark")}},{value:a.Drillthrough,displayName:function(e){return e.get("Drillthrough")}},{value:a.PageNavigation,displayName:function(e){return e.get("PageNavigation")}},{value:a.Qna,displayName:function(e){return e.get("Generic_Qna")}},{value:a.WebUrl,displayName:function(e){return e.get("Web_Url")}}]),a.getType=function(e){return e.type||a.Back},a.BookmarkNone="",a.SectionNone="",(s=o=r.VisualDropShadow||(r.VisualDropShadow={})).CustomPreset="Custom",s.TopPreset="Top",s.TopLeftPreset="TopLeft",s.TopRightPreset="TopRight",s.CenterPreset="Center",s.CenterLeftPreset="CenterLeft",s.CenterRightPreset="CenterRight",s.BottomPreset="Bottom",s.BottomLeftPreset="BottomLeft",s.BottomRightPreset="BottomRight",s.OuterPosition="Outer",s.InnerPosition="Inner",s.Preset=e.createEnumType([{value:s.BottomRightPreset,displayName:function(e){return e.get("Visual_LabelPosition_BottomRight")}},{value:s.BottomPreset,displayName:function(e){return e.get("Bottom")}},{value:s.BottomLeftPreset,displayName:function(e){return e.get("Visual_LabelPosition_BottomLeft")}},{value:s.CenterRightPreset,displayName:function(e){return e.get("Visual_TextAlignment_Right")}},{value:s.CenterPreset,displayName:function(e){return e.get("Visual_TextAlignment_Center")}},{value:s.CenterLeftPreset,displayName:function(e){return e.get("Visual_TextAlignment_Left")}},{value:s.TopRightPreset,displayName:function(e){return e.get("Visual_LabelPosition_TopRight")}},{value:s.TopPreset,displayName:function(e){return e.get("Top")}},{value:s.TopLeftPreset,displayName:function(e){return e.get("Visual_LabelPosition_TopLeft")}},{value:s.CustomPreset,displayName:function(e){return e.get("Custom")}}]),s.Position=e.createEnumType([{value:s.OuterPosition,displayName:function(e){return e.get("Visual_DonutLabelPosition_Outside")}},{value:s.InnerPosition,displayName:function(e){return e.get("Visual_DonutLabelPosition_Inside")}}]),(t=n=r.VisualTitleHeading||(r.VisualTitleHeading={})).Normal="Normal",t.Heading2="Heading2",t.Heading3="Heading3",t.Heading4="Heading4",t.Heading5="Heading5",t.Heading6="Heading6",t.HeadingTypeAttribute=e.createEnumType([{value:t.Normal,displayName:function(e){return e.get("Normal")}},{value:t.Heading2,displayName:function(e){return e.get("Heading_2")}},{value:t.Heading3,displayName:function(e){return e.get("Heading_3")}},{value:t.Heading4,displayName:function(e){return e.get("Heading_4")}},{value:t.Heading5,displayName:function(e){return e.get("Heading_5")}},{value:t.Heading6,displayName:function(e){return e.get("Heading_6")}}]),t.DefaultHeadingAttribute=t.Heading3,(s=r.VisualHeaderTooltip||(r.VisualHeaderTooltip={})).NoSection="none",(t=r.VisualContainer||(r.VisualContainer={})).EmptyConfig={singleVisual:{visualType:"uninitializedVisual"}},jsCommon.FreezeUtility.deepFreeze(t.EmptyConfig),t.CommonObjectDescriptors={title:{displayName:p("Visual_Title"),description:p("Visual_TitleDescription"),properties:{show:{displayName:p("Visual_Show"),type:{bool:!0}},text:{displayName:p("Visual_Title_Text"),description:p("Visual_Title_TextDescription"),type:{text:!0},suppressFormatPainterCopy:!0},heading:{displayName:p("Visual_Title_Heading_Attribute"),description:p("Visual_Title_Heading_AttributeDescription"),type:{enumeration:n.HeadingTypeAttribute}},titleWrap:{displayName:p("Visual_Word_Wrap"),type:{bool:!0}},fontColor:{displayName:p("Visual_FontColor"),description:p("Visual_Title_FontColorDescription"),type:{fill:{solid:{color:!0}}}},background:{displayName:p("Background_Color"),description:p("Visual_Title_BackgroundColorDescription"),type:{fill:{solid:{color:{nullable:!0}}}}},alignment:{displayName:p("Visual_Title_Alignment"),description:p("Visual_Title_AlignmentDescription"),type:{formatting:{alignment:!0}}},fontSize:{displayName:p("Visual_TextSize"),description:p("Visual_Title_TextSizeDescription"),type:{formatting:{fontSize:!0}}},bold:{displayName:p("Bold"),type:{bool:!0}},italic:{displayName:p("Italic"),type:{bool:!0}},underline:{displayName:p("Underline"),type:{bool:!0}},fontFamily:{displayName:p("Visual_FontFamily"),type:{formatting:{fontFamily:!0}}},paddingTop:{displayName:p("Visual_PaddingTop"),type:{numeric:!0}},paddingBottom:{displayName:p("Visual_PaddingBottom"),type:{numeric:!0}},paddingLeft:{displayName:p("Visual_PaddingLeft"),type:{numeric:!0}},paddingRight:{displayName:p("Visual_PaddingRight"),type:{numeric:!0}}}},background:{displayName:p("Visual_Background"),properties:{show:{displayName:p("Visual_Show"),type:{bool:!0}},color:{displayName:p("Visual_Background_Color"),description:p("Visual_Background_ColorDescription"),type:{fill:{solid:{color:!0}}}},transparency:{displayName:p("Transparency"),description:p("Visual_Background_TransparencyDescription"),type:{numeric:!0}}}},lockAspect:{displayName:p("Visual_BasicShape_LockAspect"),properties:{show:{displayName:p("Visual_Show"),type:{bool:!0}}}},general:{displayName:p("Visual_General_Properties"),properties:{x:{displayName:p("Visual_General_Properties_X_Coordinate"),type:{numeric:!0}},y:{displayName:p("Visual_General_Properties_Y_Coordinate"),type:{numeric:!0}},width:{displayName:p("Visual_General_Properties_Width"),type:{numeric:!0}},height:{displayName:p("Visual_General_Properties_Height"),type:{numeric:!0}},altText:{displayName:p("Visual_General_Properties_Description"),placeHolderText:p("Visual_General_Properties_Description_Placeholder"),type:{formatting:{altText:!0}}},allowBinnedLineSample:{displayName:p("Visual_General_HighDensitySampling"),type:{bool:!0}},allowOverlappingPointsSample:{displayName:p("Visual_General_HighDensitySampling"),type:{bool:!0}},keepLayerOrder:{displayName:p("Visual_General_KeepLayerOrder"),description:p("Visual_General_KeepLayerOrderDescription"),type:{bool:!0}},removeVisualBorderForSubselection:{displayName:p("SubselectionPoC_ToggleName"),type:{bool:!0}}}},border:{displayName:p("Visual_Border"),properties:{show:{displayName:p("Visual_Show"),type:{bool:!0}},color:{displayName:p("Visual_Border_Color"),type:{fill:{solid:{color:!0}}}},radius:{displayName:p("Visual_Radius"),type:{numeric:!0}},paddingTop:{displayName:p("Visual_PaddingTop"),type:{numeric:!0}},paddingBottom:{displayName:p("Visual_PaddingBottom"),type:{numeric:!0}},paddingLeft:{displayName:p("Visual_PaddingLeft"),type:{numeric:!0}},paddingRight:{displayName:p("Visual_PaddingRight"),type:{numeric:!0}}}},dropShadow:{displayName:p("Visual_DropShadow"),properties:{show:{displayName:p("Visual_Show"),type:{bool:!0}},preset:{displayName:p("Visual_DropShadow_Preset"),type:{enumeration:o.Preset}},position:{displayName:p("Visual_DropShadow_Position"),type:{enumeration:o.Position}},color:{displayName:p("Generic_Color"),type:{fill:{solid:{color:!0}}}},transparency:{displayName:p("Transparency"),type:{numeric:!0}},shadowSpread:{displayName:p("Visual_BubbleSize"),type:{numeric:!0}},shadowBlur:{displayName:p("Visual_DropShadow_Blur"),type:{numeric:!0}},angle:{displayName:p("Visual_Angle"),type:{numeric:!0}},shadowDistance:{displayName:p("Distance"),type:{numeric:!0}}}},visualLink:{displayName:p("Visual_VisualLink"),suppressFormatPainterCopy:!0,properties:{show:{displayName:p("Visual_Show"),type:{bool:!0}},type:{displayName:p("Type"),description:p("Visual_VisualLink_Type_Description"),type:{enumeration:i.Type}},bookmark:{displayName:p("Generic_Bookmark"),description:p("Visual_VisualLink_Bookmark_Description"),type:{reference:{bookmark:!0}}},disabledTooltip:{displayName:p("Disabled_Tooltip"),type:{text:!0}},drillthroughSection:{displayName:p("Destination"),description:p("Visual_VisualLink_Destination_Description"),type:{reference:{section:!0}}},enabledTooltip:{displayName:p("Enabled_Tooltip"),type:{text:!0}},suppressDefaultTooltip:{displayName:p("Visual_SuppressDefaultTooltips"),type:{bool:!0}},showDefaultTooltip:{displayName:p("Visual_ShowTooltips"),type:{bool:!0}},navigationSection:{displayName:p("Destination"),description:p("Visual_VisualLink_Destination_Description"),type:{reference:{section:!0}}},tooltip:{displayName:p("Tooltip"),description:p("Visual_VisualLink_Tooltip_Description"),type:{text:!0}},webUrl:{displayName:p("Web_Url"),type:{misc:{webUrl:!0}}}}},visualTooltip:{displayName:p("Tooltip"),properties:{show:{displayName:p("Visual_Show"),type:{bool:!0}},type:{displayName:p("Type"),description:p("Visual_Tooltip_Type_Description"),type:{enumeration:r.VisualTooltip.Type}},section:{displayName:p("Page"),description:p("Visual_Tooltip_Section_Description"),type:{reference:{section:!0}}},titleFontColor:{displayName:p("Visual_Label_FontColor"),description:p("Visual_Tooltip_Title_FontColorDescription"),type:{fill:{solid:{color:!0}}}},valueFontColor:{displayName:p("Visual_Value_FontColor"),description:p("Visual_Tooltip_Value_FontColorDescription"),type:{fill:{solid:{color:!0}}}},fontSize:{displayName:p("Visual_TextSize"),description:p("Visual_Tooltip_TextSizeDescription"),type:{formatting:{fontSize:!0}}},bold:{displayName:p("Bold"),type:{bool:!0}},italic:{displayName:p("Italic"),type:{bool:!0}},underline:{displayName:p("Underline"),type:{bool:!0}},fontFamily:{displayName:p("Visual_FontFamily"),description:p("Visual_Tooltip_FontFamilyDescription"),type:{formatting:{fontFamily:!0}}},background:{displayName:p("Background_Color"),description:p("Visual_Tooltip_BackgroundColorDescription"),type:{fill:{solid:{color:{nullable:!0}}}}},transparency:{displayName:p("Transparency"),description:p("Visual_Tooltip_BackgroundTransparencyDescription"),type:{numeric:!0}},actionFontColor:{displayName:p("Visual_Action_FontColor"),description:p("Visual_Action_FontColor_FontColorDescription"),type:{fill:{solid:{color:!0}}}},themedTitleFontColor:{displayName:p("Visual_Label_FontColor"),description:p("Visual_Tooltip_Title_FontColorDescription"),type:{fill:{solid:{color:!0}}}},themedBackground:{displayName:p("Background_Color"),description:p("Visual_Tooltip_BackgroundColorDescription"),type:{fill:{solid:{color:{nullable:!0}}}}},themedValueFontColor:{displayName:p("Visual_Value_FontColor"),description:p("Visual_Tooltip_Value_FontColorDescription"),type:{fill:{solid:{color:!0}}}}}},stylePreset:{displayName:p("Visual_Table_StylePreset_SliceTitle"),properties:{name:{displayName:p("Visual_Table_StylePreset_SliceTitle"),type:{formatting:{stylePreset:!0}}}}},visualHeader:{displayName:p("Visual_Header"),description:p("VisualHeader_Toggle_Description"),properties:{show:{displayName:p("Visual_Show"),type:{bool:!0}},background:{displayName:p("Background_Color"),description:p("VisualHeader_Background_ColorDescription"),type:{fill:{solid:{color:!0}}}},border:{displayName:p("Visual_Border"),description:p("Visual_Border"),type:{fill:{solid:{color:!0}}}},transparency:{displayName:p("Transparency"),description:p("VisualHeader_Background_TransparencyDescription"),type:{numeric:!0}},foreground:{displayName:p("VisualHeader_Foreground_Color"),description:p("VisualHeader_Foreground_ColorDescription"),type:{fill:{solid:{color:!0}}}},showVisualInformationButton:{displayName:p("VisualHeader_ShowVisualInformationButton"),description:p("VisualHeader_ShowVisualInformationButton_Description"),type:{bool:!0}},showVisualWarningButton:{displayName:p("VisualHeader_ShowVisualWarningButton"),description:p("VisualHeader_ShowVisualWarningButton_Description"),type:{bool:!0}},showVisualErrorButton:{displayName:p("VisualHeader_ShowVisualErrorButton"),description:p("VisualHeader_ShowVisualErrorButton_Description"),type:{bool:!0}},showDrillRoleSelector:{displayName:p("VisualHeader_ShowDrillRoleSelector"),description:p("VisualHeader_ShowDrillRoleSelector_Description"),type:{bool:!0}},showDrillUpButton:{displayName:p("VisualHeader_ShowDrillUpButton"),description:p("VisualHeader_ShowDrillUpButton_Description"),type:{bool:!0}},showDrillToggleButton:{displayName:p("VisualHeader_ShowDrillToggleButton"),description:p("VisualHeader_ShowDrillToggleButton_Description"),type:{bool:!0}},showDrillDownLevelButton:{displayName:p("VisualHeader_ShowDrillDownLevelButton"),description:p("VisualHeader_ShowDrillDownLevelButton_Description"),type:{bool:!0}},showDrillDownExpandButton:{displayName:p("VisualHeader_ShowDrillDownExpandButton"),description:p("VisualHeader_ShowDrillDownExpandButton_Description"),type:{bool:!0}},showPinButton:{displayName:p("VisualHeader_ShowPinButton"),description:p("VisualHeader_ShowPinButton_Description"),type:{bool:!0}},showFilterRestatementButton:{displayName:p("VisualHeader_ShowFilterRestatementButton"),description:p("VisualHeader_ShowFilterRestatementButton_Description"),type:{bool:!0}},showFocusModeButton:{displayName:p("VisualHeader_ShowFocusModeButton"),description:p("VisualHeader_ShowFocusModeButton_Description"),type:{bool:!0}},showCopyVisualImageButton:{displayName:p("VisualHeader_ShowCopyVisualImageButton"),description:p("VisualHeader_ShowCopyVisualImageButton_Description"),type:{bool:!0}},showSeeDataLayoutToggleButton:{displayName:p("VisualHeader_ShowSeeDataLayoutToggleButton"),description:p("VisualHeader_ShowSeeDataLayoutToggleButton_Description"),type:{bool:!0}},showOptionsMenu:{displayName:p("VisualHeader_ShowOptionsMenu"),description:p("VisualHeader_ShowOptionsMenu_Description"),type:{bool:!0}},showCommentButton:{displayName:p("VisualHeader_ShowCommentButton"),description:p("VisualHeader_ShowCommentButton_Description"),type:{bool:!0}},showTooltipButton:{displayName:p("VisualHeader_ShowVisualHeaderTooltip"),description:p("VisualHeader_ShowVisualHeaderTooltip_Description"),type:{bool:!0}},showPersonalizeVisualButton:{displayName:p("VisualHeader_ShowPersonalizeVisualButton"),description:p("VisualHeader_ShowPersonalizeVisualButton_Description"),type:{bool:!0}}}},visualHeaderTooltip:{displayName:p("VisualHeaderTooltip"),properties:{type:{displayName:p("Type"),type:{enumeration:s.Type}},section:{displayName:p("Page"),description:p("Visual_Tooltip_Section_Description"),type:{reference:{section:!0}}},text:{displayName:p("VisualHeaderTooltip_Text"),description:p("VisualHeaderTooltip_Text_Description"),type:{text:!0}},titleFontColor:{displayName:p("Generic_Color"),description:p("VisualHeaderTooltip_FontColorDescription"),type:{fill:{solid:{color:!0}}}},fontSize:{displayName:p("Visual_TextSize"),description:p("Visual_Tooltip_TextSizeDescription"),type:{formatting:{fontSize:!0}}},fontFamily:{displayName:p("Visual_FontFamily"),description:p("Visual_Tooltip_FontFamilyDescription"),type:{formatting:{fontFamily:!0}}},bold:{displayName:p("Bold"),type:{bool:!0}},italic:{displayName:p("Italic"),type:{bool:!0}},underline:{displayName:p("Underline"),type:{bool:!0}},background:{displayName:p("Background_Color"),description:p("Visual_Tooltip_BackgroundColorDescription"),type:{fill:{solid:{color:{nullable:!0}}}}},transparency:{displayName:p("Transparency"),description:p("Visual_Tooltip_BackgroundTransparencyDescription"),type:{numeric:!0}},themedTitleFontColor:{displayName:p("Generic_Color"),description:p("VisualHeaderTooltip_FontColorDescription"),type:{fill:{solid:{color:!0}}}},themedBackground:{displayName:p("Background_Color"),description:p("Visual_Tooltip_BackgroundColorDescription"),type:{fill:{solid:{color:{nullable:!0}}}}}}}},t.ObjectProps=l.getPropertyIdentifiers(t.CommonObjectDescriptors),t.clone=function(e,t){if(e){e=t.serializeVisualContainer(e);return t.deserializeCanvasItem(e,!0)}},t.isHidden=function(e){return!!e.display&&"hidden"===e.display.mode},t.setHidden=function(e,t){e.display=t?{mode:"hidden"}:void 0},(r.PinData||(r.PinData={})).getVisualType=function(e){if(e.visualContainer)return e.visualContainer.config.singleVisual.visualType}})(powerbi=powerbi||{}),(function(e){((e=(e=e.explore||(e.explore={})).contracts||(e.contracts={})).VisualRelationshipFilterActionUtil||(e.VisualRelationshipFilterActionUtil={})).toString=function(e){switch(e){case 0:return"Default";case 1:return"DataFilter";case 2:return"HighlightFilter";case 3:return"NoFilter"}}})(powerbi=powerbi||{}),(function(i){!(function(e){var l,x,m,r,u,a,t,b,v;function p(e,t,r){for(var i in this.defn=e,this.projections=t,this.expansionStates=r||[],t)_.isEmpty(t[i].activeProjectionRefs)||this.ensureActiveItems(i)}e=e.contracts||(e.contracts={}),l=jsCommon.ArrayExtensions,x=i.data.ExpansionState,m=i.data.transforms.plugins,r=i.data.ProjectionUtils,u=i.data.QueryProjectionCollection,a=i.data.QueryProjectionsByRole,t=i.data.SemanticQuery,b=i.data.SQExpr,v=i.data.SQExprBuilder,p.prototype.ensureExpansionState=function(e,t){var r,i=x.findExpansionState(this.expansionStates,e);return i||(i=new x(e,t),r=this.getRolesUniqueProjectionRefs(e),e=this.getRolesUniqueActiveProjectionsRefs(e,t.canCollapseRoot),i.updateLevels(r,e.length),this.expansionStates.push(i)),i.supportsMerge,t.supportsMerge,i},p.prototype.add=function(e,t,r){var i,a,o;r&&(p=r.exprName,i=r.fieldIndex,a=r.parameter,o=r.indexInParameter);var n=(n=this.defn.selectNameOf(e))||this.addSelect(e,p);this.getRoleProjections(t)||(this.projections[t]=new u([]));var s,e={queryRef:n},l=0,p=this.projections[t];return a?(s=null!=o?o:null!==(s=a.length)&&void 0!==s?s:0,p.addProjection(e,{parameter:a,indexInParameter:s}),l=p.getParameterProjectionIndex(a,s),this.addNewQueryRefToActiveProjectionRefsIfNeeded(t,n,l)):(s=p.all(),null==i||i>s.length?(p.addProjection(e),l=s.length-1):(p.addProjection(e,{fieldIndex:i}),l=p.getColumnProjectionIndex(i),this.addNewQueryRefToActiveProjectionRefsIfNeeded(t,n,l))),this.updateExpansionStates(t,(function(e,t){return e.addLevel(n,t+l)})),l},p.prototype.addParameter=function(e,t,r){this.getRoleProjections(t)||(this.projections[t]=new u([]));t=this.projections[t];return null==r&&(r=t.getFieldCount()),t.addFieldParameter({expr:e,index:r,length:void 0}),r},p.prototype.removeParameterBySQExpr=function(e){var t,r=this.projections;for(t in r){var i=r[t],a=i.findParameterBySQExpr(e);_.isEmpty(a)||i.removeFieldParameters(a)}},p.prototype.removeParameter=function(e){var t,r=!1;for(t in this.projections)r=this.removeParameterByRoleName(e,t)||r;return r},p.prototype.removeParameterByRoleName=function(e,t){t=this.projections[t];return null==t?void 0:t.removeFieldParameters([e])},p.prototype.getParameterByFieldIndex=function(e,t){t=this.projections[t];return null==t?void 0:t.getParameterByFieldIndex(e)},p.prototype.getResolveParameterResultsByRole=function(){var t=this,e={},r=this.projections;if(r)for(var i in r){var a=this.getQueryFieldParametersByRole(i);if(!_.isEmpty(a))for(var o=e[i]=[],n=0,s=a;n<s.length;n++){var l=s[n],p=r[i].getParameterProjections(l).map((function(e){return{expr:t.defn.select().withName(e.queryRef).expr,alias:void 0}}));o.push({parameter:l,result:p})}}return e},p.prototype.removeExpr=function(e,t,r,i){if(t){for(var a=this.defn.select(),o=!1,n=a.length-1;0<=n;--n){var s=a[n].expr;if(p.areEqualIgnoringAggregate(s,e,r)){if(!this.removeAllProjectionsForExpr(s,i))return!1;o=!0}}return o}return this.removeAllProjectionsForExpr(e,i)},p.prototype.getQueryRefByProjectionIndex=function(e,t){e=this.projections[e];if(e){e=e.getQueryRefs();if(t<e.length)return e[t]}},p.prototype.getQueryRef=function(e,t){t&&(void 0!==t.fieldIndex||void 0!==t.parameter&&t.indexInParameter);var r=t.fieldIndex,i=t.parameter,t=t.indexInParameter,e=a.getRole(this.projections,e);if(e)return i?e.getParameterProjections(i)[t].queryRef:r>=e.getFieldCount()?void 0:e.getColumnProjection(r).queryRef},p.prototype.removeProjection=function(e,t){t&&(void 0!==t.fieldIndex||void 0!==t.parameter&&t.indexInParameter),this.projections[e];var r=t.fieldIndex,i=t.parameter,a=t.indexInParameter,o=this.getQueryRef(e,t);if(!o)return!1;var n=this.defn.select().withName(o);if(!n)return!1;var s=n.expr,t=this.projections[e],n=t.all(),l=i?(p={parameter:i,indexInParameter:a},t.getParameterProjectionIndex(i,a)):(p={fieldIndex:r},t.getColumnProjectionIndex(r));t.removeProjection(p);r=this.projections[e].activeProjectionRefs;_.pull(r,o);var p=_.isEmpty(n);return p&&_.isEmpty(t.getFieldParameters())?delete this.projections[e]:!p&&r&&0===r.length&&r.push(n[Math.max(0,l-1)].queryRef),this.updateExpansionStates(e,(function(e,t){return e.removeLevel(t+l)})),this.isUsed(o)||this.removeExpr(s,!1),!0},p.prototype.moveProjection=function(e,t,r,i){if(t===r)return!1;if(t<0||r<0)return!1;var a,o=this.projections[e];o&&(a=o.all());var n=o.convertFieldIndexToProjectionIndex(r),s=o.convertFieldIndexToProjectionIndex(t),l=o.convertFieldIndexToProjectionIndex(r+i);if(!a||l>a.length)return!1;var p=this.projections[e].activeProjectionRefs,u=o.moveFields(t,r,i);if(p)if((t<r?l:n)<p.length){r=_.take(a,o.convertFieldIndexToProjectionIndex(r+1));this.projections[e].activeProjectionRefs=_.map(r,(function(e){return e.queryRef}))}else if(s<p.length){for(var c=0,d=u;c<d.length;c++){var m=d[c];_.pull(p,m.queryRef)}0===p.length&&p.push(a[0].queryRef)}return this.updateExpansionStates(e,(function(e,t){return e.moveLevels(t+s,t+n,i)})),!0},p.prototype.setAggregate=function(e,t,r){return this.updateExpression(e,t,(function(e){return v.setAggregate(e,r)}))},p.prototype.removeAggregate=function(e,t,r){return this.updateExpression(e,t,(function(e){return v.removeAggregate(e,r)}))},p.prototype.setPercentOfGrandTotal=function(e,t){return this.updateExpression(e,t,(function(e){return v.setPercentOfGrandTotal(e)}))},p.prototype.removePercentOfGrandTotal=function(e,t){return this.updateExpression(e,t,(function(e){return v.removePercentOfGrandTotal(e)}))},p.prototype.setPercentOfRoleTotal=function(t,e,r){return this.updateExpression(e,r,(function(e){return v.setPercentOfRoleTotal(e,t)}))},p.prototype.removePercentOfRoleTotal=function(e,t){return this.updateExpression(e,t,(function(e){return v.removePercentOfRoleTotal(e)}))},p.prototype.orderBy=function(e){this.defn,this.defn=this.defn.orderBy(e)},p.prototype.removeOrderBy=function(e){this.defn,this.defn=this.defn.removeOrderBy(e)},p.prototype.removeUnusedOrderBy=function(){this.defn;for(var e=this.defn,t=0,r=e.orderBy();t<r.length;t++){var i=r[t].expr;e.selectNameOf(i)||(this.defn=e.removeOrderBy(i))}},p.prototype.addTransform=function(e,t,r){this.defn;for(var i={},a=this.defn.transforms(),o=0,n=a;o<n.length;o++)i[n[o].name]=!0;var s=jsCommon.StringExtensions.findUniqueName(i,e.name),t={algorithm:e.name,name:s,input:{parameters:t},output:void 0};this.defn=this.defn.transforms(a.concat([t]));for(var l=e.name===m.KMeansClustering.name&&r.grouping&&r.grouping.cluster,p=0,u=e.outputRoles;p<u.length;p++){var c=u[p],d=c.name;l&&(d=r.grouping.cluster.clusteringRole),this.add(v.transformOutputRoleRef(c.algorithmRole),d,{exprName:c.columnName||c.algorithmRole})}return s},p.prototype.removeTransform=function(e,t){this.defn;var r=_.find(this.defn.transforms(),(function(e){return e.name===t}));if(r){for(var i=0,a=e.outputRoles;i<a.length;i++){var o=a[i];this.removeExpr(v.transformOutputRoleRef(o.algorithmRole),!1)}this.defn=this.defn.removeTransform(r)}},p.prototype.updateTransform=function(t,e){this.defn;var r=_.find(this.defn.transforms(),(function(e){return e.name===t}));r&&(r.input.parameters=e)},p.prototype.clone=function(){return new p(this.defn,a.clone(this.projections),x.clone(this.expansionStates))},p.prototype.equals=function(e){return!!t.equals(this.defn,e.defn)&&(_.isEqual(this.projections,e.projections)&&_.isEqual(this.expansionStates,e.expansionStates))},p.prototype.ensureDrillableRoles=function(e){if(_.isEmpty(e))return[];for(var t=[],r=0,i=e;r<i.length;r++){var a=i[r];this.ensureActiveItems(a)&&t.push(a)}return t},p.prototype.ensureActiveItems=function(e){var t=this.projections[e];if(t){e=t.all();return!_.isEmpty(e)&&_.isEmpty(t.activeProjectionRefs)?(t.activeProjectionRefs=[e[0].queryRef],!0):void 0}},p.prototype.toggleShowAll=function(e){e=this.projections[e];e&&(e.showAll=!e.showAll)},p.prototype.hasShowAll=function(){return!_.isEmpty(this.projections)&&_.some(this.projections,(function(e){return e.showAll}))},p.prototype.roleContainsExpr=function(e,t){var e=this.projections[e],r=e&&e.all();if(_.isEmpty(r))return!1;for(var i=0,a=this.defn.select();i<a.length;i++)for(var o=a[i],n=0,s=r;n<s.length;n++)if(s[n].queryRef===o.name&&b.equals(t,o.expr))return!0;return!1},p.prototype.getRoleNameForExpr=function(e){var t,r=this.projections;for(t in r){var i=this.tryGetExprs(t);if(i&&0<i.length)for(var a=0,o=i;a<o.length;a++){var n=o[a];if(b.equals(e,n))return t}i=r[t].getFieldParameters();if(!_.isEmpty(i))for(var s=0,l=i;s<l.length;s++){var p=l[s];if(b.equals(p.expr,e))return t}}},p.prototype.tryGetExpr=function(e,t){e=this.getRoleProjections(e);if(e){var t=e[t];return null===(t=r.tryGetExprByProjection(this.defn,t))||void 0===t?void 0:t.expr}},p.prototype.tryGetExprs=function(e){e=r.tryGetExprs(this.defn,this.projections,e);if(void 0!==e)return _.map(e,(function(e){return e.expr}))},p.prototype.tryGetFieldExprs=function(e){return r.tryGetFieldExprs(this.defn,this.projections,e)},p.prototype.getUniqueQueryRefs=function(){var e=_.values(this.projections);return _.chain(e).map((function(e){return e.getQueryRefs()})).flatten(!0).uniq().value()},p.prototype.getUniqueQueryFields=function(){var t=this,e=_.keys(this.projections);return _.chain(e).map((function(e){return t.tryGetFieldExprs(e)})).flatten(!0).uniqWith(p.isEqualQueryFields).value()},p.prototype.currentDrillMode=function(e){var t=this.getRoleProjections(e);if(!_.isEmpty(t)){e=this.projections[e];if(e){e=e.activeProjectionRefs;if(!_.isEmpty(e))return 1<e.length?2:e[0]!==t[0].queryRef?3:void 0}}},p.prototype.addSelect=function(e,t){var r=this.defn;this.defn=r=r.addSelect(e,t);t=r.select(),r=t.length-1;return b.equals(e,t[r].expr),t[r].name},p.isEqualQueryFields=function(e,t){return e.isFieldParameter||t.isFieldParameter||void 0===e.queryName||void 0===t.queryName?e.isFieldParameter===t.isFieldParameter&&b.equals(e.expr,t.expr):e.queryName===t.queryName},p.prototype.updateExpansionStates=function(t,e){var r,i;_.isEmpty(this.expansionStates)||(_.remove(this.expansionStates,(function(e){return!e.supportsMerge})),(r=x.findExpansionStateForRole(this.expansionStates,t))&&(_.isEmpty(this.projections[t])||_.isEmpty(this.projections[t].all())?_.remove(this.expansionStates,(function(e){return e===r})):(i=_.takeWhile(r.roles,(function(e){return e!==t})),i=this.getRolesUniqueActiveProjectionsRefs(i,r.canCollapseRoot).length,e(r,i),i=r.getVisibleDescendentsDepth(r.root,-1),this.setActiveProjections(r.roles,i))))},p.prototype.removeAllProjectionsForExpr=function(e,f){var g,t=this.defn,h=t.selectNameOf(e);if(!h)return!1;_.remove(this.expansionStates,(function(e){return!e.supportsMerge}));var r,y=this.projections,C=this;for(r in y)!(function(t){var e=x.findExpansionStateForRole(C.expansionStates,t),r=y[t],i=r.all(),a=e&&_.takeWhile(e.roles,(function(e){return e!==t})),o=a&&C.getRolesUniqueActiveProjectionsRefs(a,e&&e.canCollapseRoot).length;if(f)for(var n=C.getQueryFieldParametersByRole(t),s=0,l=_.filter(n,(function(e){return b.equals(e.expr,f)}));s<l.length;s++)for(var p=l[s],u=p.length-1;0<=u;u--){var c={indexInParameter:u,parameter:p},d=r.getParameterProjectionIndex(p,u);(null===(g=i[d])||void 0===g?void 0:g.queryRef)===h&&(r.removeProjection(c),C.updateActiveProjectionRefAndExpansionState(t,h,o,d))}else for(d=i.length-1;0<=d;d--){var m=r.convertProjectionIndexToFieldIndex(d),v=r.getColumnProjection(m);(null==v?void 0:v.queryRef)===h&&(r.removeProjection(c={fieldIndex:m}),C.updateActiveProjectionRefAndExpansionState(t,h,o,d))}0!==i.length&&e&&(n=e.getVisibleDescendentsDepth(e.root,-1),C.setActiveProjections(e.roles,n))})(r);return this.isUsed(h)||(this.defn=t.removeSelect(e).removeOrderBy(e)),!0},p.prototype.updateActiveProjectionRefAndExpansionState=function(e,t,r,i){var a=this.projections[e],o=a.all(),e=x.findExpansionStateForRole(this.expansionStates,e),a=a.activeProjectionRefs;_.pull(a,t),a&&_.isEmpty(a)&&!_.isEmpty(o)&&a.push(o[Math.max(0,i-1)].queryRef),e&&e.removeLevel(r+i)},p.prototype.updateExpression=function(e,t,r){var i=this.projections[e];if(!(s=i?i.all():s)||t>=s.length)return!1;var a=this.defn,o=s[t].queryRef,n=a.select(),e=l.indexWithName(n,o),s=n[e].expr,n=r(s),r=a.selectNameOf(n);return r?(i.updateQueryRef(t,r),this.isUsed(o)||(this.defn=a.removeSelect(s))):1<this.getUsageCount(o)?i.updateQueryRef(t,this.addSelect(n)):this.defn=a.setSelectAt(e,n),!0},p.prototype.isUsed=function(e){return 0<this.getUsageCount(e)},p.prototype.getUsageCount=function(t){var e,r=0,i=this.projections;for(e in i){var a=i[e].all();r+=_.filter(a,(function(e){return e.queryRef===t})).length}return r},p.prototype.getRoleProjections=function(e){e=a.getRole(this.projections,e);if(e)return e.all()},p.prototype.addNewQueryRefToActiveProjectionRefsIfNeeded=function(e,t,r){var i=this.getRoleProjections(e),e=this.projections[e].activeProjectionRefs;e&&(1<e.length&&r<e.length?e.splice(r,0,t):1===e.length&&0===r&&1<i.length&&i[1].queryRef===e[0]&&e.splice(0,1,t))},p.prototype.getRolesProjectionRefs=function(e){for(var t=[],r=0,i=e;r<i.length;r++){var a=i[r],a=this.projections[a];a&&(a=_.map(a.all(),(function(e){return e.queryRef})),t.push.apply(t,a||[]))}return t},p.prototype.getRolesUniqueProjectionRefs=function(e){return _.uniq(this.getRolesProjectionRefs(e))},p.prototype.getQueryFieldParametersByRole=function(e){if(!_.isEmpty(this.projections)){e=this.projections[e];return e?e.getFieldParameters():[]}},p.prototype.getParameterProjectionExprs=function(e){var t,r=this,i=[],a=this.projections;for(t in a)for(var o=a[t],n=0,s=o.findParameterBySQExpr(e);n<s.length;n++){var l=s[n],p=o.getParameterProjections(l).map((function(e){return r.defn.select().withName(e.queryRef).expr}));i.push({exprs:p,parameter:l})}return i},p.prototype.getQueryFieldParameters=function(){if(_.isEmpty(this.projections))return[];var e,t=[];for(e in this.projections){var r=this.projections[e];r&&t.push.apply(t,r.getFieldParameters())}return t},p.prototype.hasQueryFieldParameters=function(){return!_.isEmpty(this.getQueryFieldParameters())},p.prototype.resetExpansionStates=function(){this.expansionStates=[]},p.prototype.getRolesActiveProjectionsRefs=function(e,t){for(var r=this,i=[],a=t||_.some(e,(function(e){return r.projections[e]&&!_.isEmpty(r.projections[e].activeProjectionRefs)})),o=0,n=e;o<n.length;o++){var s=n[o],l=this.projections[s],s=l&&l.all(),l=s&&(l.activeProjectionRefs||!a&&_.map(s,(function(e){return e.queryRef})));if(l&&(i.push.apply(i,l||[]),s.length!==l.length&&_.uniqBy(s,(function(e){return e.queryRef})).length!==_.uniq(l).length))break}return i},p.prototype.getRolesUniqueActiveProjectionsRefs=function(e,t){return _.uniq(this.getRolesActiveProjectionsRefs(e,t))},p.areEqualIgnoringAggregate=function(e,t,r){return b.equals(v.removeAggregate(e,r),v.removeAggregate(t,r))},p.prototype.setActiveProjections=function(e,t){var r=this.projections,i=x.findExpansionState(this.expansionStates,e);i&&i.pinLevels(t);for(var a=0,o=e;a<o.length;a++){var n,s,l=o[a];0<t?(n=r[l]&&r[l].all(),s=void 0,s=(n=_.uniqBy(n,(function(e){return e.queryRef}))).length<=t?n:_.take(n,t),r[l].activeProjectionRefs=_.map(s,(function(e){return e.queryRef})),t-=s.length):r[l]&&(r[l].activeProjectionRefs=[])}},e.VisualQuery=p})(i.explore||(i.explore={}))})(powerbi=powerbi||{}),(function(e){((e=(e=e.explore||(e.explore={})).services||(e.services={})).upgrade||(e.upgrade={})).CurrentExplorationVersion="5.36"})(powerbi=powerbi||{}),(function(e){var t;e=(e=e.explore||(e.explore={})).services||(e.services={}),(t=e.upgrade||(e.upgrade={})).CurrentExplorationStateVersion="1.14",t.setCurrentExplorationStateVersion=function(e){t.CurrentExplorationStateVersion=e}})(powerbi=powerbi||{}),(function(e){var t,a,i;function r(e,t){return e.modelExtensions&&e.modelExtensions.withName(t)}function o(e,t){e=r(e,t);if(!e)throw new Error("Unable to find expected model extension: "+t);return e}function n(e,t,r){e.modelExtensions||(e.modelExtensions=a.createWithName());var i=e.modelExtensions.withName(t);return i||(i=s(t,r),e.modelExtensions.push(i)),i.extends,i}function s(e,t){return{name:e,extends:t,entities:a.createWithName()}}function l(e,t){return e.entities.withName(t)}function p(e,t,r){t=l(o(e,t),r);if(!t)throw new Error("Unable to find expected entity: "+r);return t}function u(e,t){e.entities||(e.entities=a.createWithName());var r=e.entities.withName(t);return r||(r={name:t,extends:t,measures:a.createWithName()},e.entities.push(r)),r.extends,r}function c(e,t){return e.measures.withName(t)}function d(e,t){e=c(e,t);if(!e)throw new Error("Unable to find expected measure:"+t);return e}function m(t){var e=Object.keys(t),e=_.chain(e).filter((function(e){return"name"!==e&&"extends"!==e})).filter((function(e){return!(_.isArray(t[e])&&_.isEmpty(t[e]))})).value();return _.some(e)}t=(t=e.explore||(e.explore={})).util||(t.util={}),a=jsCommon.ArrayExtensions,i=e.data.dsr,(t=t.ModelExtensionUtils||(t.ModelExtensionUtils={})).getOptionalModelExtension=r,t.getExpectedModelExtension=o,t.getOrCreateModelExtension=n,t.createModelExtension=s,t.ensureEntityExists=function(e,t,r){return u(n(e,t,i.DefaultSchemaName),r)},t.findEntity=l,t.getExpectedEntity=p,t.getOrCreateExtendingEntity=u,t.addMeasure=function(e,t){if(e.measures||(e.measures=a.createWithName()),e.measures.withName(t.name))throw new Error("Measure "+t.name+" already exists and cannot be added");e.measures.push(t)},t.getExpectedMeasure=function(e,t,r,i){return d(p(e,t,r),i)},t.findMeasureFromEntity=c,t.removeMeasure=function(e,t,r,i){i=d(r=p(e,t,r),i),i=r.measures.indexOf(i);r.measures.splice(i,1),0===r.measures.length&&(delete r.measures,e=e,t=t,m(r=r)||(t=o(e,t),r=t.entities.indexOf(r),t.entities.splice(r,1),0===t.entities.length&&(delete t.entities,(function(e,t){m(t)||(t=e.modelExtensions.indexOf(t),e.modelExtensions.splice(t,1),0===e.modelExtensions.length&&delete e.modelExtensions)})(e,t))))},t.setAnnotation=function(e,t,r){null==r?(function(e,t){t=e.annotations&&e.annotations.withName(t);t&&(t=e.annotations.indexOf(t),e.annotations.splice(t,1),e.annotations&&0===e.annotations.length&&delete e.annotations)})(e,t):(function(e,t,r){e.annotations||(e.annotations=a.createWithName());var i=e.annotations.withName(t);i?i.value=r:(i={name:t,value:r},e.annotations.push(i))})(e,t,r)},t.getAnnotationValue=function(e,t){if(t=e.annotations&&e.annotations.withName(t))return t.value},t.toQueryExtensionSchema=function(e){if(e){var t={Version:0,Name:e.name,Extends:e.extends};return e.entities&&(t.Entities=_.map(e.entities,(function(e){var t={Extends:e.extends,Name:e.name};e.measures&&(t.Measures=_.map(e.measures,(function(e){var t=e.dataType;6!==t&&9!==t||(t=7);return{Name:e.name,Expression:e.expression,DataType:t}})));return t}))),t}}})(powerbi=powerbi||{}),(function(e){!(function(e){var n;function t(e){this.modelExtension=e,this.visited={}}n=e.util||(e.util={}),t.prototype.visitReference=function(e){if(e.schema===this.modelExtension.name){var t=n.ModelExtensionUtils.findEntity(this.modelExtension,e.entity);if(t){var r=n.ModelExtensionUtils.findMeasureFromEntity(t,e.name);if(r){e=this.toVisitedKey(e);if(!this.visited[e]){this.visitMeasure(this.modelExtension,t,r),this.visited[e]=!0;for(var i=0,a=r.references.measures;i<a.length;i++){var o=a[i];this.visitReference(o)}}}}}},t.prototype.visitMeasure=function(e,t,r){},t.prototype.toVisitedKey=function(e){return JSON.stringify(e)},n.ModelExtensionDependencyVisitor=t})(e.explore||(e.explore={}))})(powerbi=powerbi||{}),(function(e){var t,u;function i(e){var t=e.resourcePackages;return t||(e.resourcePackages=t=[]),t}t=(t=e.explore||(e.explore={})).util||(t.util={}),u=e.visualHost.utils.ResourcePackageUtils,(t=t.ResourcePackageUtils||(t.ResourcePackageUtils={})).newSharedResourceItem=function(e,t,r){return u.newSharedResourceItem(e,t,r)},t.ensureResourcePackageType=function(e,t,r){return e=i(e),u.ensureResourcePackage(e,t,r)},t.ensurePublicCustomVisuals=function(e){var t=e.publicCustomVisuals;return t||(e.publicCustomVisuals=t=[]),t},t.ensureResourcePackages=i,t.synchronizePackageIds=function(e,t){if(!_.isEmpty(t)&&!_.isEmpty(e))for(var r=0,i=t;r<i.length;r++){var a=i[r],o=u.findResourcePackage(e,a.type,a.name);if(o){o.id,3!==a.type||(a.id,o.id),a.id=o.id;for(var n=0,s=a.items;n<s.length;n++){var l=s[n],p=u.findItemInPackage(o,l.name);p&&(p.id,3!==a.type||(l.id,p.id),l.id=p.id)}}}}})(powerbi=powerbi||{}),(function(e){var i;e=e.explore||(e.explore={}),(i=e.dataReaderPlugins||(e.dataReaderPlugins={})).ExplorationDataReaderType="exploration",i.registerExplorationDataReaderExtension=function(e,t,r){e[i.ExplorationDataReaderType],e[i.ExplorationDataReaderType]={name:"exploration",extends:"dsr",queryExtensionProvider:i.createExplorationQueryExtensionProvider(),schemaReader:function(){return i.createConceptualSchemaReader(t,r)}}},i.getExplorationDataReaderDataSource=function(e){if(e=_.find(e,(function(e){return"exploration"===e.type})))return e.exploration}})(powerbi=powerbi||{}),(function(d){var e;(function(e){var s=d.explore.util.ModelExtensionUtils,t=d.explore.util.ModelExtensionDependencyVisitor,r=d.data.SQExpr,i=d.data.SQExprRewriter;function a(n){return function(e,t,r){var i={query:e,extensions:void 0,queryRewrites:t};if(1!==n.length)return r?r(e,t):i;var a=n[0],o=a.getModelExtensions();if(_.isEmpty(o))return r?r(e,t):i;a=s.toQueryExtensionSchema(u.build(e,o.withName(a.schemaName)));return r?r(e,t,a):{query:e,queryRewrites:t,extensions:a}}}e.createExplorationQueryExtensionProvider=function(){return a};var o,n=(__extends(l,o=i),l.prototype.visitMeasureRef=function(e){return r.isEntity(e.source)&&this.dependencyVisitor.visitReference({schema:e.source.schema,entity:e.source.entity,name:e.ref}),e},l);function l(e){var t=o.call(this)||this;return t.dependencyVisitor=e,t}var p,u=(__extends(c,p=t),c.build=function(e,t){t=new c(t);return e.rewrite(new n(t)),t.result},c.prototype.visitMeasure=function(e,t,r){this.result=this.result||s.createModelExtension(e.name,e.extends);t=s.getOrCreateExtendingEntity(this.result,t.name);s.findMeasureFromEntity(t,r.name)||s.addMeasure(t,r)},c);function c(e){return p.call(this,e)||this}})((e=d.explore||(d.explore={})).dataReaderPlugins||(e.dataReaderPlugins={}))})(powerbi=powerbi||{}),(function(c){var e,d,a;function m(e,t,r){var i=new a;return i.name=e,i.extends=t,i.capabilities={canEdit:r,discourageQueryAggregateUsage:!1,isExtendable:!1,isQnaEnabled:!1,normalizedFiveStateKpiRange:!1,supportsMedian:!1,supportsPercentile:!1,supportsScopedEval:!1,supportsStringMinMax:!1,supportsMultiTableTupleFilters:!1,supportsTimeIntelligenceQuickMeasures:!1,supportsCalculatedColumns:!1,supportsGrouping:!1,limitMultiColumnFiltersToQueryGroupColumns:!1,supportsBinnedLineSample:!1,supportsOverlappingPointsSample:!1,supportsQna:!1,insights:{},supportsFastRefresh:!1,supportsSubqueryRegrouping:!1,supportsTopNPerLevel:!1,supportsExtensionColumns:!1,canEditChangeDetectionMeasure:!1,supportsGroupSynchronization:!1,supportsScopedDataReduction:!1,transformCapabilities:{supportedTransforms:[]},supportChangeDetectionMeasureRefresh:!1,supportsSparklineData:!1},i.entities=d.createWithName(),i}e=(e=c.explore||(c.explore={})).dataReaderPlugins||(e.dataReaderPlugins={}),d=jsCommon.ArrayExtensions,a=c.data.ConceptualSchema,(e=e.ExplorationConceptualSchemaFactory||(e.ExplorationConceptualSchemaFactory={})).createExtensionSchema=m,e.convertModelExtension=function(e,t){var r=m(e.name,e.extends,t);if(!e.entities)return r;for(var i=0,a=e.entities;i<a.length;i++){var o=a[i],n={name:o.name,extends:o.extends,displayName:o.name,properties:d.createWithName(),hierarchies:d.createWithName(),displayFolders:d.createWithName(),capabilities:{canRefresh:!1,canEditSource:!1,canRename:!1,canDelete:!1,canEditStorageMode:!1,supportsClustering:!1,supportsBinByCount:!1,limitOnNumberOfGroups:null,dataView:null},source:{}};if(r.entities.push(n),o.measures)for(var s=0,l=o.measures;s<l.length;s++){var p=l[s],u={name:p.name,displayName:p.name,type:c.ValueType.fromPrimitiveTypeAndCategory(p.dataType,p.dataCategory),kind:1,hidden:p.hidden,errorMessage:p.errorMessage,queryable:p.errorMessage?1:0,format:p.formatInformation&&p.formatInformation.formatString,measure:{},canDelete:r.capabilities.canEdit,description:p.description};!(function(e,t,r){if(e.displayFolder)for(var e=e.displayFolder.split(";"),i=0,a=e;i<a.length;i++){var o=a[i].split("\\");!(function e(t,r,i,a){var o;i.withName(t)?o=i.withName(t):(o={displayName:t,name:t,properties:d.createWithName(),displayFolders:d.createWithName(),hierarchies:d.createWithName()},i.push(o));Array.isArray(r)&&r.length?e(r.shift(),r,o.displayFolders,a):o.properties.push(a)})(o.shift(),o,t.displayFolders,r)}})(p,n,u),p.measureTemplate&&(u.measure.template={name:p.measureTemplate.daxTemplateName}),n.properties.push(u)}}return r}})(powerbi=powerbi||{}),(function(t){var e;(function(n){var o=t.data.FederatedConceptualSchema;n.createConceptualSchemaReader=function(e,t){return new r(e,t=void 0===t?!1:t)};var r=(e.prototype.execute=function(e){var t=e.dataSources;if(!t||1<t.length)return this.promiseFactory.reject(null);e=t[0],t=e.exploration;if(!t)return this.promiseFactory.reject(null);var r=[],t=t.getModelExtensions();if(_.isEmpty(t))r.push(n.ExplorationConceptualSchemaFactory.createExtensionSchema(e.name,e.extends,this.canEditSchemas));else for(var i=0,a=t;i<a.length;i++){var o=a[i];r.push(n.ExplorationConceptualSchemaFactory.convertModelExtension(o,this.canEditSchemas))}return this.promiseFactory.resolve({data:{extensionSchemas:r}})},e.prototype.transform=function(e){for(var t={schemas:{}},r=0,i=e.data.extensionSchemas;r<i.length;r++){var a=i[r];t.schemas[a.name]=a}return{schema:new o(t)}},e);function e(e,t){this.promiseFactory=e,this.canEditSchemas=t}})((e=t.explore||(t.explore={})).dataReaderPlugins||(e.dataReaderPlugins={}))})(powerbi=powerbi||{}),(function(e){function u(e,t){var r=(function(e,t){for(var r=[],i=[],a=e.visualContainers.slice(),o=0,n=t.visualContainers;o<n.length;o++){var s,l,p=n[o];void 0!==p.id&&(s=jsCommon.ArrayExtensions.findWithId(a,p.id))?(l=a.indexOf(s),a.splice(l,1),jsCommon.JsonComparer.equals(s,p)||i.push(p)):r.push(p)}return{added:r,updated:i,removed:a}})(e,t);return{added:r.added,updated:r.updated,removed:r.removed,page:t,originalPage:e}}((e=(e=e.explore||(e.explore={})).proxies||(e.proxies={})).ExplorationDiffer||(e.ExplorationDiffer={})).diff=function(e,t){return{pages:(function(e,t){for(var r=[],i=[],a=e.slice(),o=0,n=t.length;o<n;o++){var s,l,p=t[o];void 0!==p.id&&(s=jsCommon.ArrayExtensions.findWithId(a,p.id))?(l=a.indexOf(s),a.splice(l,1),l=u(s,p),i.push(l)):r.push(p)}return{added:r,updated:i,removed:a}})(e.sections,t.sections),pods:(function(e,t){for(var r=[],i=[],t=t||[],a=e?e.slice():[],o=0,n=t;o<n.length;o++){var s,l,p=n[o];void 0===p.id?r.push(p):(s=p.id,0<=(l=_.findIndex(a,(function(e){return e.id===s})))?(i.push({updatedPod:p,originalPod:a[l]}),a.splice(l,1)):r.push(p))}return{added:r,removed:a,updated:i}})(e.pods,t.pods)}}})(powerbi=powerbi||{}),(function(e){(e=(e=(e=(e=e.explore||(e.explore={})).proxies||(e.proxies={})).wireContracts||(e.wireContracts={})).VisualLink||(e.VisualLink={})).Bookmark="Bookmark",e.Back="Back",e.Qna="Qna"})(powerbi=powerbi||{}),(function(e){(e=(e=(e=(e=e.explore||(e.explore={})).proxies||(e.proxies={})).wireContracts||(e.wireContracts={})).VisualTooltip||(e.VisualTooltip={})).Canvas="Canvas",e.Default="Default"})(powerbi=powerbi||{}),(function(C){var b;(function(f){var d=C.telemetry.EXDeserializeExplorationEventName,g=C.telemetry.EXGetExplorationEventName,h=C.fillTelemetryEvent,e=C.MonitorWith,x=C.explore.util.ResourcePackageUtils,r=jsCommon.HttpUtils.attachPerformanceTimingByUrl;f.createExplorationProxy=function(e,t,r,i,a,o,n,s){return new l(e,t,r,i,a,o,n,s)},f.saveExplorationSerializationOptions={withData:!0,excludeHighContrastTheme:!0,forSave:!0};var l=(y.prototype.get=function(e){var r,i=this,t=this.featureSwitchService&&this.featureSwitchService.featureSwitches&&this.featureSwitchService.featureSwitches.telemetryV2,a=this.telemetryService,o=e.parentActivity?a.startChildEvent(e.parentActivity.event,C.telemetry.EXGetExploration,{fromCache:!1}):a.startEvent(C.telemetry.EXGetExploration,{fromCache:!1});e.parentContextActivity&&(r=e.parentContextActivity.createChildActivity({name:"Get Exploration"}));var n=e.sectionId,s=e.id,l=e.model,a=e.bookmarkGuid;if(e.allowResultFromClientCache){e=this.getExplorationFromCache(s,n,l,a);if(e)return t&&h(g,{fromCache:!0}),o.event.info.fromCache=!0,o.resolve(),r&&r.resolve(),e}var p=t?new C.PbiDeferred:this.promiseFactory.defer(),u=this.uriPrefix+"reports/"+s+"/exploration";_.isNumber(n)&&(u+="/sections/"+n),_.isEmpty(a)||(u+="?bookmarkGuid="+a);var c=y.getCacheKey(s,n,a);this.cache[c.fullKey]={promise:p.promise};var d,m,v=this.httpService.powerbiRequestOptions(o.event,"GetExploration");return v.responseType="text",this.preloadExplorationsService&&(d=this.preloadExplorationsService.getPreloadedExplorations(),m=this.preloadExplorationsService.getPreloadExplorationsUrl()),m===u&&d?(d.then((function(e){i.attachPerfTimingToTelemetry(o.event,u);var t=e,e=jsCommon.JsonExtensions.tryParseJSON(t);i.onSuccess(e,p,t,r,l,c),r&&r.resolve()}),(function(e){i.onError(__assign(__assign({},e),{data:void 0}),s,p,c,!0),i.httpGet(u,v,o,p,s,l,c,r)})),this.preloadExplorationsService.clear()):this.httpGet(u,v,o,p,s,l,c,r),p.promise},y.prototype.httpGet=function(r,e,i,a,t,o,n,s){var l=this;this.httpService.get(r,e).then((function(e){l.attachPerfTimingToTelemetry(i.event,r);var t=e.data,e=jsCommon.JsonExtensions.tryParseJSON(t);l.onSuccess(e,a,t,s,o,n),i.resolve(),s&&s.resolve()}),(function(e){l.attachPerfTimingToTelemetry(i.event,r),i.reject(C.errorDetailsHelper.getTelemetryErrorDetails(e.error,e.status)),l.onError(__assign(__assign({},e),{data:void 0}),t,a,n),s&&s.reject()}))},y.prototype.attachPerfTimingToTelemetry=function(e,t){r(t,e.info)},y.prototype.save=function(e,t,r,i){return this.saveInternal(e,t,r,!1,i)},y.prototype.saveWithoutGroupIdHeader=function(e,t,r){return this.saveInternal(e,t,r,!0)},y.prototype.saveInternal=function(o,n,s,l,p){var u=this,c=this.promiseFactory.defer();return this.copyResourcePackages(n).then((function(){var e,t=y.getCacheKey(s),r=u.serializer.serializeExploration(n,f.saveExplorationSerializationOptions),i=u.serializer.stringifyExplorationConfigs(r),a=u.cloneExplorationShallowForSave(i);null==n.id?(e=u.uriPrefix+"explorations/?reportid="+s,u.httpService.put(e,i,u.httpService.powerbiRequestOptions(null,"SaveExploration")).then((function(e){return u.onSuccess(e.data,c,JSON.stringify(e.data),void 0,null,t)}),(function(e){return u.onError(e,s,c,t)}))):(e=f.ExplorationDiffer.diff(o,i),n.id,u.explorationUpdateDiff(e,n.id,n,a,i,l,p).then((function(){c.resolve({wireContractJSON:JSON.stringify(i),exploration:n,isMobileOptimized:r.layoutOptimization}),u.updateExplorationCache(t,r)}),(function(e){c.reject(e)})))})),c.promise},y.prototype.copyResourcePackages=function(r){var i=[];if(r.resourcePackages)for(var a=r.report&&r.report.folderId,o=this,e=0,t=r.resourcePackages.length;e<t;e++)!(function(e){var t=e;i.push(o.resourcePackageCopyService.copyResourcePackageIfNeeded(r.resourcePackages[t].id,a,null).then((function(e){null!=e&&(r.resourcePackages[t]=e)})))})(e);return this.promiseFactory.all(i)},y.prototype.getModelsAndExploration=function(e,t,r){var i=this,a=this.promiseFactory.defer(),t=this.uriPrefix+"reports/"+e+"/modelsAndExploration?preferReadOnlySession="+t;return r&&(t+="&bookmarkGuid="+r),this.httpService.get(t,this.httpService.powerbiRequestOptions(null,"GetModelsAndExploration")).then((function(t){var r=t.data.models;i.featureSwitchService.registerFeatureSwitches(t.data.featureSwitches),i.serializer.ensureInitialized().then((function(){var e=i.serializer.deserializeExploration(i.serializer.parseExplorationConfigs(t.data.exploration),[],!0,r);a.resolve({exploration:e,models:r,featureSwitches:t.data.featureSwitches})}))}),(function(e){a.reject(e?{error:e.error,requestId:e.requestId,httpStatusCode:e.status}:{})})),a.promise},y.prototype.cloneExplorationShallowForSave=function(e){return{id:e.id,reportId:e.reportId,config:e.config,filters:e.filters,layoutOptimization:e.layoutOptimization,sections:void 0,resourcePackages:_.cloneDeep(e.resourcePackages),publicCustomVisuals:e.publicCustomVisuals}},y.prototype.explorationUpdateDiff=function(e,t,m,r,v,i,a){var f=this,g=this.promiseFactory.defer(),o={};o.exploration=r;var n=-1,s=-1,l=-1,h={},y={},C={};o.addedPods=e.pods.added.map((function(e){return e.id=s--,C[e.name]=e.id,e})),o.deletedPods=e.pods.removed.map((function(e){return e.id})),o.updatedPods=e.pods.updated.reduce((function(e,t){return jsCommon.JsonComparer.equals(t.originalPod,t.updatedPod)||e.push(t.updatedPod),e}),[]),o.addedPages=e.pages.added.map((function(e){if(e.id=n--,h[e.name]=e.id,e.visualContainers)for(var t=0,r=e.visualContainers;t<r.length;t++){var i=r[t];i.id=l--;var a=JSON.parse(i.config);y[f.concatenatePageAndVisualContainerNames(e.name,a.name)]=i.id}return e})),o.deletedPages=e.pages.removed.map((function(e){return e.id})),o.updatedPages=e.pages.updated.reduce((function(e,t){for(var r=0,i=t.added;r<i.length;r++){var a=i[r];a.id=l--;var o=JSON.parse(a.config);y[f.concatenatePageAndVisualContainerNames(t.page.name,o.name)]=a.id}var n=f.getUpdatedPageProperty(t);return _.isEmpty(n.addedVisualContainers)&&_.isEmpty(n.updatedVisualContainers)&&_.isEmpty(n.deletedVisualContainers)&&_.isEmpty(n.pageProperty)||e.push(n),e}),[]);t=this.uriPrefix+"explorations/savereport/"+t;return a=i?this.httpService.powerbiRequestOptions(null,"explorationUpdateDiff",{dismissGroupObjectId:!0}):this.getRequestOptionsWithGroupId(a),this.httpService.post(t,o,a).then((function(e){var e=e&&e.data,t=e&&e.addedPodIds,r=e&&e.addedSectionIds,i=e&&e.addedVisualContainerIds,e=e&&e.exploration&&e.exploration.resourcePackages;if(e&&x.synchronizePackageIds(f.serializer.deserializeResourcePackages(e),x.ensureResourcePackages(m)),m.pods&&t)for(var a=0,o=m.pods.length;a<o;a++){var n,s=m.pods[a];(u=_.find(t,{oldId:C[s.name]}))&&(n=v.pods[a],s.id=n.id=u.id)}var l=b.contracts.Section.filterTransient(m.sections),p=v.sections;if(l){l.length,p.length;for(a=0,o=l.length;a<o;a++){var u,c=l[a],d=p[a];(u=_.find(r,{oldId:h[c.name]}))&&(c.id=d.id=u.id);d=d.visualContainers;i&&f.updateDiffForContainerIds(c,d,i,y)}}g.resolve(m)}),(function(e){return g.reject(e?{error:e.error,requestId:e.requestId,httpStatusCode:e.status}:{})})),g.promise},y.prototype.updateDiffForContainerIds=function(e,t,r,i){for(var a=0,o=t;a<o.length;a++){var n=o[a],s=JSON.parse(n.config),l=_.find(r,{oldId:i[this.concatenatePageAndVisualContainerNames(e.name,s.name)]});l&&(C.ItemGroupingManager.find(s.name,e.visualContainerGroups).id=n.id=l.id)}},y.prototype.concatenatePageAndVisualContainerNames=function(e,t){return e+"/"+t},y.prototype.getRequestOptionsWithGroupId=function(e,t,r){return e?this.httpService.powerbiRequestOptions(t,r,{groupObjectIdOverride:e}):this.httpService.powerbiRequestOptions(t,r)},y.prototype.saveAs=function(i,a,o,n,s,l,p,u,c,d){var m=this;if(s&&u)throw Error("Save As request should not be sent with both the folder id and the folder object id.");var v=this.promiseFactory.defer();return this.copyResourcePackages(i).then((function(){var e=m.serializer.stringifyExplorationConfigs(m.serializer.serializeExploration(i,f.saveExplorationSerializationOptions)),t=i.reportId;e.reportId=void 0,e.report=void 0;var r={modelIds:[o],exploration:e,packageId:l?0:n,folderId:s,sourceReportId:t,folderObjectId:u,sensitivityLabelId:c};a=encodeURIComponent(a);e=m.uriPrefix+"explorations/"+(d||"")+"?name="+a;l&&(e+="&personalizedreport=true");t=m.getRequestOptionsWithGroupId(p,void 0,"saveExplorationAs");m.httpService.put(e,r,t).then((function(e){return m.onSuccess(e.data,v,JSON.stringify(e.data),void 0,void 0)}),(function(e){return m.onError(e,o,v)}))})),v.promise},y.prototype.saveVisualContainerQueries=function(e,t){e=this.uriPrefix+"explorations/"+e+"/cache";return this.httpService.post(e,t,this.httpService.powerbiRequestOptions(null,"SaveVisualContainerQueries"))},y.prototype.getUpdatedPageProperty=function(e){var t={pageId:e.page.id};t.addedVisualContainers=e.added,t.updatedVisualContainers=e.updated,t.deletedVisualContainers=e.removed.map((function(e){return e.id}));var r=this.shallowCloneSection(e.originalPage),e=this.shallowCloneSection(e.page);return jsCommon.JsonComparer.equals(r,e)||(t.pageProperty=e),t},y.prototype.shallowCloneSection=function(e){return{config:e.config,displayName:e.displayName,displayOption:e.displayOption,filters:e.filters,height:e.height,id:e.id,name:e.name,objectId:e.objectId,ordinal:e.ordinal,transient:e.transient,visualContainers:void 0,width:e.width}},y.prototype.getExplorationFromCache=function(e,t,r,i){e=this.findMatch(e,t,i);if(e){i=e.result;if(i.promise)return i.promise;if(i.data&&(null==t||_.some(i.data.sections,(function(e){return e.id===t})))){e=this.promiseFactory.defer();return e.resolve({wireContractJSON:JSON.stringify(this.serializer.stringifyExplorationConfigs(i.data)),exploration:this.serializer.deserializeExploration(i.data,[],!0,r)}),e.promise}}},y.prototype.findMatch=function(e,t,r){var i=y.getCacheKey(e,t,r),t=this.cache[i.fullKey];if(t||null!=r||(i=y.getCacheKey(e),t=this.cache[i.fullKey]),t)return{key:i,result:t}},y.prototype.updateExplorationCache=function(r,e){var t,i=this;r&&(e?((t=this.cache[r.fullKey])?(t.promise&&delete t.promise,t.data=e):this.cache[r.fullKey]={data:e,promise:null},r.part&&!this.cache[r.part.reportKey]&&((e=_.clone(e)).activeWebBookmark&&delete e.activeWebBookmark,this.cache[r.part.reportKey]={data:e,promise:null}),r.allSectionKey&&_.forOwn(this.cache,(function(e,t){t!==r.fullKey&&null!=t.match(new RegExp("^"+r.fullKey))&&delete i.cache[t]})),this.cacheExpirationTimerId&&clearTimeout(this.cacheExpirationTimerId),this.cacheExpirationTimerId=setTimeout((function(){i.clearCache()}),18e5)):delete this.cache[r.fullKey])},y.prototype.clearCache=function(){this.cache={}},y.prototype.logDeserializationErrorsTelemetryEvents=function(e,t){_.find(t,(function(e){return 0===e.errorType}))&&((e=e.config).version,this.telemetryService.logEvent(C.telemetry.NewerExplorationVersion,{explorationVersion:e.version.toString(),supportedVersion:b.services.upgrade.CurrentExplorationVersion.toString()}))},y.prototype.onSuccess=function(e,t,r,i,a,o){var n=[],s=this.deserializeExploration(e,r,n,i,a),l=s&&s.explorationWireContract,a=s&&s.explorationContract;i&&i.setProperty("deserializationDuration",null==s?void 0:s.duration);a={wireContractJSON:r,exploration:a,isMobileOptimized:l.layoutOptimization};e.report&&(a.modelId=e.report.modelId,a.reportGuid=e.report.objectId),t.resolve(a),this.logDeserializationErrorsTelemetryEvents(l,n),this.updateExplorationCache(o,l)},y.prototype.deserializeExploration=function(e,t,r,i,a){var o,n=this,s=this.featureSwitchService&&this.featureSwitchService.featureSwitches&&this.featureSwitchService.featureSwitches.telemetryV2;e&&e.sections&&(o=e.sections.length);var l=this.telemetryService.startEvent(C.telemetry.EXDeserializeExploration,{length:t.length,upgraderCount:0,sectionCount:o,reportGuid:null===(o=null==e?void 0:e.report)||void 0===o?void 0:o.objectId}),p=this.serializer.parseExplorationConfigs(e);i&&(i.setProperty("explorationJSONStringLength",t.length),i.setProperty("explorationVersion",p.config.version));var u,c={upgraderCount:0},e=jsCommon.PerfTimer.logTime((function(){l.event.info.explorationVersion=p.config.version,s&&h(d,{explorationVersion:p.config.version,length:t.length}),u=n.serializer.deserializeExploration(p,r,!0,a,c,i),l.event.info.upgraderCount=c.upgraderCount}));return l.resolve(),s&&h(d,{upgraderCount:c.upgraderCount}),{explorationContract:u,explorationWireContract:p,duration:e}},y.prototype.onError=function(e,t,r,i,a){a||r.reject(e?{error:e.error,requestId:e.requestId,httpStatusCode:e.status}:{}),this.updateExplorationCache(i,null)},y.getCacheKey=function(e,t,r){var i=null!=t?e+"_"+t:e+"_[0-9]+";if(r){_.size(r);e=_.cloneDeep(i);return{fullKey:i+="_"+r,allSectionKey:null==t,part:{reportKey:e}}}return{fullKey:i,allSectionKey:null==t}},__decorate([e(g)],y.prototype,"get",null),__decorate([e(d)],y.prototype,"deserializeExploration",null),y);function y(e,t,r,i,a,o,n,s){this.promiseFactory=e,this.httpService=t,this.serializer=r,this.telemetryService=i,this.featureSwitchService=a,this.cache={},this.resourcePackageCopyService=o,this.uriPrefix=n||"explore/",this.preloadExplorationsService=s}})((b=C.explore||(C.explore={})).proxies||(b.proxies={}))})(powerbi=powerbi||{}),(function(e){((e=(e=e.explore||(e.explore={})).util||(e.util={})).DisplayNameServiceUtils||(e.DisplayNameServiceUtils={})).concatStrings=function(e,t,r){if(_.isEmpty(e))return null;if(1===e.length)return e[0];var i=e.pop();return StringExtensions.format(r.stringResourceProvider.get(t),1<e.length?e.join(r.stringResourceProvider.get("ListJoin_Separator")):e[0],i)}})(powerbi=powerbi||{}),(function(e){function x(e,t,r){t=e.defn.select().withName(t);return t?{expr:t.expr,roleName:r}:void 0}(e=(e=(e=e.explore||(e.explore={})).util||(e.util={})).DrillUtils||(e.DrillUtils={})).getDrillableRoles=function(e){return null!=(e=e.drilldown)?e.roles:[]},e.getDrillFilterRemovalInfoList=function(e,t,r){if(t){var i,a;switch(r){case 1:o=(function(e,t){var r=[],i=e.projections,a=t.sourceCount,o=t.sourceIndex,n=t.sourceRole,s=t.targetRole;if(i[s]){var l=(f=i[s]).all(),t=t.targetIndex;o<=t&&n===s&&(t+=a);for(var p=f.convertFieldIndexToProjectionIndex(t),u=l.length;p<u;p++){for(var c=f.getProjectionsByProjectionIndex(p),d=0,m=c;d<m.length;d++){var v=m[d];r.push(x(e,v.queryRef,s))}p+=c.length-1}}if(i[n])for(var f=i[n],g=a-1;0<=g;g--)for(var h=f.getProjectionsByFieldIndex(o+g),y=0,C=h;y<C.length;y++){v=C[y];r.push(x(e,v.queryRef,n))}return r})(e,t);break;case 0:if(t.expr)for(var o=[],n=0,s=jsCommon.ArrayExtensions.ensureArray(t.expr);n<s.length;n++){var l=s[n];o.push((i=l,void 0,a=void 0,a=(l=e).defn.selectNameOf(i),a=(function(e,t){for(var r in e){var i=e[r].all();if(0<=_.findIndex(i,(function(e){return e.queryRef===t})))return r}})(l.projections,a),{expr:i,roleName:a}))}else o=(function(e,t){for(var r=[],i=null!==(i=t.count)&&void 0!==i?i:1,a=t.role,o=e.projections[a],n=t.projOptions.fieldIndex+i-1,s=i-1;0<=s;s--,n--)for(var l=o.getProjectionsByFieldIndex(n),p=0,u=l;p<u.length;p++){var c=u[p];r.push(x(e,c.queryRef,a))}return r})(e,t);break;default:return}return _.compact(o)}}})(powerbi=powerbi||{}),(function(e){var l,u,p;function c(e,a,l,p){e&&(v(e.filters,p),_.forOwn(e.sections,(function(e,t){var r,o,n,s,i=_.find(a,(function(e){return e.name===t}));r=i,o=l,i=p,(e=e)&&r&&(i.visitSectionState(e),v(e.filters,i),(n=i.visualContainerStateVisitor)&&(s=r.visualContainers,_.forOwn(e.visualContainers,(function(e,t){var r,i,a=_.find(s,(function(e){return e.name===t}));r=a,i=o,a=n,(e=e)&&r&&(a.visitVisualContainerState(e),v(e.filters,a),(function(e,t){if(e){if(!_.isEmpty(e.selection))for(var r=0,i=e.selection;r<i.length;r++){var a=i[r];t.visitSelectorsByColumn(a)}e.filterExpressionMetadata&&t.visitFilterExpressionMetadata(e.filterExpressionMetadata)}})(e.highlight,a),(function(e,t,r,i){if(e){i.visitSingleVisualState(e);var a=e.orderBy;a&&i.visitOrderByStates(a);a=e.objects;if(a){r=u.VisualContainerUtils.getVisualCapabilities(t,r);!r||(o=r.objects)&&i.visitDataViewObjectDefinitionUpdates(a,o);var o=a.merge;o&&f(o,i);a=a.remove;if(!_.isEmpty(a))for(var n=0,s=a;n<s.length;n++){var l=s[n].selector;l&&i.visitSelector(l)}}e=e.activeProjections;e&&i.visitActiveProjectionStates(e)}})(e&&e.singleVisual,r,i,a))}))))})))}function d(e,r,t){var i,a,o,n,s;r.visitVisualContainer(e),e.config&&(s=e.config.singleVisual)&&(r.visitSingleVisualConfig(s),(a=s.query)&&r.visitQuery(a),i=function(e,t){t&&r.visitDataViewObjects(e,t),f(e,r)},(a=s.objects)&&(n=void 0,i(a,n=(o=u.VisualContainerUtils.getVisualCapabilities(e,t))?o.objects:n)),(o=s.vcObjects)&&(i(o,n=l.contracts.VisualContainer.CommonObjectDescriptors),(s=s.vcObjects.visualLink)&&r.visitVisualLinks(s))),m(e.filters,r)}function m(e,t){if(!_.isEmpty(e))for(var r=0,i=e;r<i.length;r++){var a=i[r];null!=a&&t.visitFilterContainer(a)}}function v(e,t){if(e){var r=e.nameIdentifiedMerges;_.forOwn(r,(function(e){t.visitFilterContainer(e)}));e=e.exprIdentifiedMerges;if(!_.isEmpty(e))for(var i=0,a=e;i<a.length;i++){var o=a[i];t.visitFilterContainer(o)}}}function f(e,a){_.forOwn(e,(function(e){if(!_.isEmpty(e))for(var t=0,r=e;t<r.length;t++){var i=r[t].selector;i&&a.visitSelector(i)}}))}l=e.explore||(e.explore={}),u=l.util||(l.util={}),p=e.explore.contracts.BookmarkExtensions,u.traverseExploration=function(e,t,r){t.visitExploration(e),m(e.filters,t);var i=e.bookmarks;if(!_.isEmpty(i))for(var a=0,o=i;a<o.length;a++)!(function e(t,r,i,a){a.visitBookmark(t);if(p.isBookmarkGroup(t))for(var o=0,n=t.children;o<n.length;o++){var s=n[o];e(s,r,i,a)}else c(t.explorationState,r,i,a.explorationStateVisitor)})(o[a],e.sections,r,t);if(i=e.sections,!_.isEmpty(i))for(var n=0,s=i;n<s.length;n++)!(function(e,t,r){t.visitSection(e),m(e.filters,t),(function(e,t){if(!_.isEmpty(e))for(var r=0,i=e;r<i.length;r++){var a=i[r];t.visitLinkField(a)}})(e.linkFields,t);var i=e.visualContainers;if(!_.isEmpty(i))for(var a=0,o=i.length;a<o;a++)d(i[a],t.visualContainerVisitor,r)})(s[n],t,r);!(function(e,t){if(!_.isEmpty(e))for(var r=0,i=e;r<i.length;r++){var a=i[r];t.visitPod(a)}})(e.pods,t)},u.traverseExplorationState=c,u.traverseVisualContainer=d})(powerbi=powerbi||{}),(function(e){(function(a){var e=(t.prototype.visitVisualContainer=function(e){},t.prototype.visitSingleVisualConfig=function(e){},t.prototype.visitQuery=function(e){},t.prototype.visitDataViewObjects=function(e,t){},t.prototype.visitSelector=function(e){},t.prototype.visitFilterContainer=function(e){},t.prototype.visitVisualLinks=function(e){},t);function t(){}a.DefaultVisualContainerVisitor=e;var r,e=(__extends(i,r=e),i.prototype.visitSingleVisualConfig=function(e){e.cachedFilterDisplayItems&&a.rewriteDisplayNameIdentityPairs(e.cachedFilterDisplayItems,this.rewriters)},i.prototype.visitQuery=function(e){if(e.defn)for(var t=0,r=this.rewriters;t<r.length;t++)e=r[t].rewriteQuery(e)},i.prototype.visitDataViewObjects=function(e,t){a.rewriteFilterOutput(e,t,this.rewriters),a.rewriteDataBoundPropertyDefinitions(e,t,this.rewriters)},i.prototype.visitFilterContainer=function(e){a.rewriteFilterContainer(e,this.rewriters)},i.prototype.visitVisualLinks=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t];a.rewriteVisualLink(i,this.rewriters)}},i.prototype.visitSelector=function(e){var t=a.rewriteDataRepetitionSelectors(e.data,this.rewriters);t!==e.data&&(e.data=t)},i);function i(e){var t=r.call(this)||this;return t.rewriters=e,t}a.VisualContainerRewriter=e})((e=e.explore||(e.explore={})).util||(e.util={}))})(powerbi=powerbi||{}),(function(e){(function(a){var i=jsCommon.DictionaryExtensions,e=(t.prototype.visitActiveProjectionStates=function(e){},t.prototype.visitDataViewObjectDefinitionUpdates=function(e,t){},t.prototype.visitFilterContainer=function(e){},t.prototype.visitOrderByStates=function(e){},t.prototype.visitSelector=function(e){},t.prototype.visitSelectorsByColumn=function(e){},t.prototype.visitSingleVisualState=function(e){},t.prototype.visitVisualContainerState=function(e){},t.prototype.visitFilterExpressionMetadata=function(e){},t);function t(){}a.DefaultVisualContainerStateVisitor=e;var r,e=(__extends(o,r=e),o.prototype.visitActiveProjectionStates=function(r){var i=this;_.forOwn(r,(function(e,t){e=e.map((function(e){return a.rewriteExpr(e,i.rewriters)}));r[t]=e}))},o.prototype.visitFilterContainer=function(e){a.rewriteFilterContainerState(e,this.rewriters)},o.prototype.visitDataViewObjectDefinitionUpdates=function(e,t){e=e.merge;e&&(a.rewriteFilterOutput(e,t,this.rewriters),a.rewriteDataBoundPropertyDefinitions(e,t,this.rewriters))},o.prototype.visitOrderByStates=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t];i.expr=a.rewriteExpr(i.expr,this.rewriters)}},o.prototype.visitSelector=function(e){var t=a.rewriteDataRepetitionSelectors(e.data,this.rewriters);t!==e.data&&(e.data=t)},o.prototype.visitSelectorsByColumn=function(e){var r=this,t=i.rewriteDictionary(e.dataMap,(function(e,t){return a.rewriteDataRepetitionSelectors(t,r.rewriters)}));t!==e.dataMap&&(e.dataMap=t)},o.prototype.visitFilterExpressionMetadata=function(e){a.rewriteFilterExpressionMetadata(e,this.rewriters)},o);function o(e){var t=r.call(this)||this;return t.rewriters=e,t}a.VisualContainerStateRewriter=e})((e=e.explore||(e.explore={})).util||(e.util={}))})(powerbi=powerbi||{}),(function(e){((e=(e=e.explore||(e.explore={})).util||(e.util={})).VisualPerformanceActivityUtil||(e.VisualPerformanceActivityUtil={})).updateParentWithNewLinkingActivity=function(e,t,r){if(e&&e.getProperty("telemetryActivityId")){var i=r.getOpenActivityById(e&&e.getProperty("telemetryActivityId"));if(i&&i.isActive(),i&&i.isActive()){t=r.startChildActivity(i.event,t);return e.setProperty("telemetryActivityId",t.event.id),t}}}})(powerbi=powerbi||{}),(function(e){function p(e,t){var r,i={},a=e.defn.select();if(!a)return i;for(r in e.projections){var o=e.projections[r];if(o){i[r]=[];for(var n=o.all(),s=0;s<n.length;s++){var l=o.convertProjectionIndexToFieldIndex(s);o.doesParameterExist(l)||t?i[r].push(a.withName(n[s].queryRef).expr):i[r].push(null)}}}return i}(e=(e=(e=e.explore||(e.explore={})).util||(e.util={})).PresentationUtils||(e.PresentationUtils={})).explorationToPresentationState=function(e){for(var t={},r=0,i=e.sections;r<i.length;r++){var a=i[r];t[a.name]={};for(var o=0,n=a.visualContainers;o<n.length;o++){var s,l=n[o];l.config.singleVisual&&(s=l.config.singleVisual,t[a.name][l.name]={visualType:s.visualType,autoSelectVisualType:s.autoSelectVisualType,projections:s.query?p(s.query,!0):void 0})}}return t},e.captureProjections=p,e.captureParameters=function(e){var t,r;if(!e.defn.select())return t;for(r in e.projections){var i=e.projections[r];if(i){i=_.sortBy(i.getFieldParameters(),(function(e){return e.index}));if(!_.isEmpty(i)){(t=t||{})[r]=[];for(var a=0,o=i;a<o.length;a++){var n=o[a],s=n.expr,l=n.index,n=n.length;t[r].push({expr:s,index:l,length:n})}}}}return t}})(powerbi=powerbi||{}),(function(e){!(function(e){function t(e){this.container=e,this.context={pendingGeocodingCount:0}}e=e.util||(e.util={}),t.prototype.newQuery=function(e){var t=0!==this.context.pendingGeocodingCount,r=this.context.geocodingActivity;this.context={pendingGeocodingCount:0,rootActivity:e},t&&(r&&r.reject(),this.container.onStopGeocoding())},t.prototype.hasPendingGeocoding=function(){return 0<this.context.pendingGeocodingCount},t.prototype.wrapGeocoder=function(n){return{geocode:this.wrapAsyncGeocoderMethod(n,n.geocode),geocodeBoundary:this.wrapAsyncGeocoderMethod(n,n.geocodeBoundary),geocodePoint:this.wrapAsyncGeocoderMethod(n,n.geocodePoint),tryGeocodeImmediate:function(e){return n.tryGeocodeImmediate(e)},tryGeocodeBoundaryImmediate:function(e,t,r,i,a,o){return n.tryGeocodeBoundaryImmediate(e,t,r,i,a,o)}}},t.prototype.wrapAsyncGeocoderMethod=function(o,n){var s=this;return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=s.context,i=n.apply(o,e);1==++r.pendingGeocodingCount&&(s.context.rootActivity&&(s.context.geocodingActivity=s.context.rootActivity.createChildActivity({name:"Geocoding"})),s.container.onStartGeocoding());function a(){r===s.context&&--r.pendingGeocodingCount<=0&&(r.pendingGeocodingCount,s.context.geocodingActivity&&s.context.geocodingActivity.resolve(),s.container.onStopGeocoding())}return i.then(a,a),i}},e.QueryGeocodingTracker=t})(e.explore||(e.explore={}))})(powerbi=powerbi||{}),(function(e){!(function(e){function t(e,t){this.explorationStateVisitor=e,this.visualContainerVisitor=t}e=e.util||(e.util={}),t.prototype.visitBookmark=function(e){},t.prototype.visitFilterContainer=function(e){},t.prototype.visitExploration=function(e){},t.prototype.visitSection=function(e){},t.prototype.visitLinkField=function(e){},t.prototype.visitPod=function(e){},e.DefaultExplorationVisitor=t})(e.explore||(e.explore={}))})(powerbi=powerbi||{}),(function(e){(function(t){var e=(r.prototype.visitFilterContainer=function(e){},r.prototype.visitSectionState=function(e){},r);function r(e){this.visualContainerStateVisitor=e}t.DefaultExplorationStateVisitor=e;var i,e=(__extends(a,i=e),a.prototype.visitFilterContainer=function(e){t.rewriteFilterContainerState(e,this.rewriters)},a);function a(e,t){t=i.call(this,t)||this;return t.rewriters=e,t}t.ExplorationStateRewriter=e})((e=e.explore||(e.explore={})).util||(e.util={}))})(powerbi=powerbi||{}),(function(N){!(function(l){var o=N.common.utils.ColorUtility,i=N.visualHost.CustomVisualsFilterPropertyIdentifier,n=N.data.DataViewObjectDefinitions,a=N.data.DataViewObjectDescriptors,p=N.data.FieldExprPattern,u=N.data.FilterKindDetector,s=l.contracts.FilterType,c=N.common.utils.IdUtility,d=N.data.ScopeIdentityExtractor.ScopeIdKeysAndValuesExtractorImpl,m=N.data.SemanticFilter,v=N.data.services.SemanticQuerySerializer,f=N.data.SQExpr,g=N.data.SQExprConverter,h=N.data.SQExprUtils,r=N.visuals.valueFormatter,e=(t.getFormatter=function(e,t){t=e.getMetadata(t);if(t){t=t.format;return r.create({format:t,allowFormatBeautification:!0})}},t.getDefaultFilterType=function(e,t,r,i){t=e.getMetadata(t);if(t){if(5===r)return l.contracts.FilterType.Categorical;r=t.type,r=r&&(r.text||r.bool||r.dateTime),i=t.idOnEntityKey&&i&&f.equals(e,i);return!r||h.isMeasure(e)||i?l.contracts.FilterType.Advanced:l.contracts.FilterType.Categorical}},t.getFilterType=function(e,t){return h.isMeasure(e)||!t?l.contracts.FilterType.Advanced:l.contracts.FilterType.Categorical},t.canAdd=function(e,t,r,i,a,o){if(!t||!r)return!1;if(!this.supportsMeasureFilters(e,o)&&h.isMeasure(t))return!1;var n=g.asFieldPattern(t,r),e=p.toFieldExprEntityItemPattern(n),t=r.schema(e.schema);if(!t)return!1;var s,r=t.findProperty(e.entity,p.getPropertyName(n));if(r||(n.hierarchyLevel?(s=t.findHierarchy(e.entity,n.hierarchyLevel.name))&&(l=s.levels.withName(n.hierarchyLevel.level)):n.columnHierarchyLevelVariation&&(s=t.findHierarchy(n.columnHierarchyLevelVariation.level.entity,n.columnHierarchyLevelVariation.level.name))&&(l=s.levels.withName(n.columnHierarchyLevelVariation.level.level))),!r&&!l||!i||!i.container)return!1;if(r&&1===r.kind&&(0!==i.scopeType||t.capabilities.limitMultiColumnFiltersToQueryGroupColumns)&&!a)return!1;if(a){r=r&&r.kind;if(!(!!l||0===r||1===r))return!1;var l=!1;if(1!==i.scopeType||(r=i.container)&&!r.transient&&(l=!0),!l)return!1}if(0===i.scopeType){i=i.container;if(!i||!this.supportsVisualFilters(i,o))return!1}return!0},t.supportsVisualFilters=function(e,t){e=l.util.VisualContainerUtils.getVisualType(e);return t.isQueryVisual(e)},t.supportsFilterOutput=function(e){return null!=this.tryGetFilterPropertyIdentifier(e,null,null)},t.tryGetFilterPropertyIdentifier=function(e,t,r){return t&&r&&r.isCustomVisual(t)?i:e?a.findFilterOutput(e.objects):void 0},t.tryGetFilterProperty=function(e,t,r,i){r=this.tryGetFilterPropertyIdentifier(e,t,r);if(r)return n.getValue(i,r,void 0)},t.add=function(e,t){e.filters||(e.filters=[]),e.filters.push(t)},t.getFiltersContainer=function(e,t,r){switch(e){case 0:return l.services.selectionUtils.getSelectedVisual(t);case 1:return r.getCurrentSection();case 2:return r.getCurrentExploration()}},t.convertFilterData=function(e,t,r){if(e){r={filter:e.filter,name:this.getNextFilterName(t),type:e.type,restatement:e.restatement,howCreated:r};if(e.type===l.contracts.FilterType.Categorical||e.filterExpressionMetadata&&1===e.filterExpressionMetadata.expressions.length){r.expression=e.filterExpressionMetadata.expressions[0];var i=[];if(!_.isEmpty(e.filterExpressionMetadata.cachedValueItems)){for(var a=0,o=e.filterExpressionMetadata.cachedValueItems;a<o.length;a++){var n=o[a];1===n.identities.length&&i.push({identity:n.identities[0],displayName:n.valueMap[0]})}r.cachedValueItems=i}}else e.filterExpressionMetadata&&(r.filterExpressionMetadata=e.filterExpressionMetadata);return r}},t.shouldDisableFilter=function(e,t,r,i,a){if(!r)return!1;var o=e.expression;if(!o)return!1;var n=N.data.SQExprUtils.isMeasure(o),e=!_.isEmpty(this.validate(e,t,i)),i=l.util.VisualContainerUtils.hasGrouping(r,t);if(n){if(!i&&!e)return!0;o=o.getTargetEntity();if(!o)return!0;o=o.schema;if(t.schema(o).capabilities.limitMultiColumnFiltersToQueryGroupColumns)return!0;if(l.util.VisualContainerUtils.hasFilterMappingWithNonAggregatableColumns(r,t,a))return!0;if(l.util.VisualContainerUtils.hasGroupByItemsInQuery(r))return!0}return!1},t.getValueType=function(e,t){t=e.getMetadata(t);if(t)return t.type},t.getDefaultRetainedValue=function(e,t){t=N.data.SQExprUtils.getDefaultValues(e,t);if(!_.isEmpty(t))return{isNot:!1,scopeIds:[[N.data.createDataViewScopeIdentity(N.data.SQExprUtils.getDataViewScopeIdentityComparisonExpr(e,t))]]}},t.validate=function(e,t,r){var i=e.expression,e=e.filter,i=l.util.ModelAuthoringUtility.validate(i,t,r);if(e&&(i=e.validate(t,r,i)),!_.isEmpty(i))return i},t.getNextFilterName=function(e){for(var t={},r=0,i=e=null==e?[]:e;r<i.length;r++){var a=i[r];null!=a&&(t[a.name]=!0)}return c.generateUniqueId(t,"Filter")},t.isCategoricalFilter=function(e){return e===l.contracts.FilterType.Categorical||e===l.contracts.FilterType.Visual},t.getQueryRefsForSingleItemDrillFilters=function(e,t,r){var i=e.filters,a=[];if(i)for(var o=0,n=i;o<n.length;o++){var s=n[o],l=s&&s.filter;l&&_.isEmpty(l.validate(t,r))&&(2!==s.howCreated||!this.areDrillFiltersSingleValue(l.where())||(s=this.getQueryRefFromFilter(e,s.expression))&&a.push(s))}return a},t.areDrillFiltersSingleValue=function(e){return!_.isEmpty(e)&&_.every(e,(function(e){if(null==e)return!1;e=e.condition;return f.isIn(e)?e.values&&1===e.values.length:!!f.isCompareRef(e)&&0===e.comparison}))},t.getQueryRefFromFilter=function(e,t){e=l.util.VisualContainerUtils.getVisualQuery(e);if(e)return e.defn.selectNameOf(t)},t.getFilterValuesForColumn=function(e,t){if(t){t=t.condition,e=new S(e);return t.accept(e),e.values}},t.deriveFromSQFilters=function(e,t,r){var i=[],a=r&&r.Filters&&0!==r.Filters.length?r.Filters:null;a&&a.length!==t.length&&(a=null);for(var o=0,n=t.length;o<n;o++){var s=t[o],l=a&&a[o],p=l&&l.expression&&v.deserializeExpr(l.expression);i.push({name:this.getNextFilterName(i),filter:new N.data.SemanticFilter(e,[s]),restatement:l&&l.Restatement,expression:p,howCreated:0,type:l&&l.type})}return i},t.extractParameterFilters=function(e,t){var r=_.filter(e.From,(function(e){return 1!==e.Type})),e={Version:e.Version,From:r,Where:e.Where},i={RemovedIndexes:[]},e=v.deserializeFilter(e,i);if(t&&!_.isEmpty(i.RemovedIndexes)&&(t.Filters=_.filter(t.Filters,(function(e,t){return!_.includes(i.RemovedIndexes,t)}))),e)return this.deriveFromSQFilters(e.from(),e.where(),t)},t.mergeExplorationSectionFilters=function(e,t){_.isEmpty(e.filters)||(t.filters=this.mergeFilters(t.filters,e.filters,"explore"),e.filters=[])},t.isFilterModified=function(e){var t=!0===e.isHiddenInViewMode,r=!0===e.isLockedInViewMode,i=!!e.displayName,a=void 0!==e.ordinal,a=t||r||i||a;return!!e.filter||!n.isEmpty(e.objects)||a},t.ensureFilterHasName=function(e,t){null==e.name&&this.isFilterModified(e)&&(e.name=this.getNextFilterName(t.container&&t.container.filters))},t.applySectionParameterFilters=function(e,t,r,i,a){if(e.filters=this.getSectionParameterFiltersToApply(t,e.filters,r,i),a=!_.isEmpty(i)||!_.isEmpty(r)?!0:a)for(var o=0,n=e.visualContainers;o<n.length;o++)n[o].cachedData=null},t.getFiltersToApplyFromVisualQueryFilterContext=function(e){if(e){for(var t=e.dataFilters?e.dataFilters.slice():[],r=[],i=[],a=0,o=t=e.highlightFiltersUnmerged?t.concat(e.highlightFiltersUnmerged):t;a<o.length;a++){var n=o[a],s=n.filter.where();if(!_.isEmpty(s)){var l=_.filter(s,(function(e){return 1===u.runDetector(e.condition)}));if(i.push.apply(i,l||[]),!_.isEmpty(l)){s=_.filter(s,(function(e){return 1!==u.runDetector(e.condition)}));if(_.isEmpty(s))continue;n={filter:m.fromSQFromAndSQFilters(n.filter.from(),s)}}r.push(n)}}return _.isEmpty(i)||(e=m.fromMeasureFilters(e.query,i))&&r.push({filter:e}),r}},t.findValuesInFilterCache=function(e,t,r){if(e.length,t.length,r&&!_.isEmpty(r.cachedValueItems)){var i=this.findIdentityMapInFilterCache(e,t,r);if(i){var a,o=[],n=[];for(a in i.valueMap)o.push(i.valueMap[a]),n.push(r.expressions[a]);return{values:o,columns:n}}}},t.removeEntryFromFilterCache=function(e,t,r){var i;e.length,t.length,!r||_.isEmpty(r.cachedValueItems)||(i=this.findIdentityMapInFilterCache(e,t,r))&&_.remove(r.cachedValueItems,(function(e){return e===i}))},t.findIdentityMapInFilterCache=function(r,i,e){if(r.length,i.length,e&&!_.isEmpty(e.cachedValueItems))for(var t=0,a=e.cachedValueItems;t<a.length;t++){for(var o=a[t],n=new d,s=0,l=o.identities;s<l.length;s++)l[s].expr.accept(n);if(n.keys.length===r.length){for(var p=!0,u=0;u<n.keys.length;u++)if("break"===(function(e){var t=n.keys[e];if(_.findIndex(r,(function(e){return f.equals(e,t)}))<0||i[e].value!==n.values[e].value)return p=!1,"break"})(u))break;if(p)return o}}},t.getSectionParameterFiltersToApply=function(e,t,r,i){t=__spreadArray([],t||[]);if(_.isEmpty(i)||e&&!_.isEmpty(e.parameters)&&_.remove(t,(function(t){return _.some(e.parameters,(function(e){return e.boundFilter===t.name}))})),_.isEmpty(i)&&_.isEmpty(r))return t;r=this.getUnOverriddenAndMergedFilters(i,r);return this.getUnOverriddenAndMergedFilters(r,t)},t.getUnOverriddenAndMergedFilters=function(e,t){if(_.isEmpty(e))return t;if(_.isEmpty(t))return e;t=this.getNonoverriddenFilters(e,t);return this.mergeFilters(t||[],e||[],"param")},t.getNonoverriddenFilters=function(e,t){var r=this;if(_.isEmpty(e)||_.isEmpty(t))return t;var i=this.extractAllReferencedFields(e);return _.filter(t,(function(e){e=r.extractReferencedFields(e);return!_.some(e,(function(t){return _.some(i,(function(e){return f.equals(e,t,!1,!0)}))}))}))},t.extractParameterFiltersFromSection=function(e,t){e=e||[];for(var r={},i=[],a=0,o=t=t||[];a<o.length;a++)r[(l=o[a]).name]=l;for(var n=0,s=e;n<s.length;n++){var l,p=r[(l=s[n]).name];p&&_.isEqual(p,l)||i.push(l)}return i},t.mergeFilters=function(e,t,r){for(var i={},a=0,o=e=e||[];a<o.length;a++)i[(n=o[a]).name]=!0;for(var n,s=0,l=t;s<l.length;s++)(n=l[s]).name=r+"_"+n.name,i[n.name]?n.name:i[n.name]=!0;return e.concat(t)},t.canExpandManually=function(e,t,r,i){return 6!==e&&(!(5===e&&!t&&f.isMeasure(r))&&!!i)},t.hasMeasureOrAsAggregationLinkField=function(e){return _.some(e.filters,(function(e){return 5===e.howCreated&&!e.isTransient&&(e.isLinkedAsAggregation||e.expression&&f.isMeasure(e.expression))}))},t.notifyFilterContainerChangedByUser=function(e,t){e.publishToChannel(l.services.events.userActionTriggered,{source:"UserAction_ChangeFilter"}),e.publishToChannel(l.services.events.filterContainerChanged,t)},t.createChangeFilterActivity=function(e,t){return e.createActivity({name:"Change Filter",operationType:t})},t.notifyBufferedFilterChanges=function(e,t,r,i,a,o){e.publishToChannel(l.services.events.applyAllBufferedFilterCardChanged,{filterScopeType:t,filterType:r,id:i,canApply:a,wasDeleted:o})},t.isApplyAllEnabled=function(e,t){t=t.getCurrentExploration();return!!(e&&t&&t.slowDataSourceSettings)&&t.slowDataSourceSettings.isApplyAllButtonEnabled},t.getFilterCardStyle=function(e,t,r,i){var a,o,n=e&&e.filterCard,s=t?(a=n&&n.$instances&&n.$instances[l.constants.ExploreCanvasConstants.Applied],o=r.colorPalette.backgroundLight.value,l.constants.ExploreCanvasConstants.DefaultAppliedFilterCardTransparency):(a=n&&n.$instances&&n.$instances[l.constants.ExploreCanvasConstants.Available],o=r.colorPalette.background.value,l.constants.ExploreCanvasConstants.DefaultAvailableFilterCardTransparency),r=null!==(n=null==i?void 0:i.defaultStyleOverride)&&void 0!==n?n:{checkboxAndApplyColor:l.constants.ExploreCanvasConstants.DefaultOutspacePaneCheckboxAndApplyColor,borderColor:l.constants.ExploreCanvasConstants.DefaultFilterCardBorderColor,backgroundColor:o,foregroundColor:r.colorPalette.foreground.value,inputBoxBorderColor:l.constants.ExploreCanvasConstants.DefaultFilterCardBorderColor,inputBoxBackgroundColor:l.constants.ExploreCanvasConstants.DefaultControlBackgroundColor,inputBoxForegroundColor:l.constants.ExploreCanvasConstants.DefaultControlForegroundColor,fontSize:this.getFontSize(a),fontFamily:this.getFontFamily(a)};return{checkboxAndApplyColor:this.getCheckboxAndApplyColor(e&&e.outspacePane,r.checkboxAndApplyColor),borderColor:this.getBorderColor(a,r.borderColor,null==i?void 0:i.alwaysEnableBorder),backgroundColor:this.getBackgroundColor(a,r.backgroundColor,s,t,r.backgroundColorApplied),foregroundColor:this.getColor(a,"foregroundColor",r.foregroundColor),inputBoxBorderColor:this.getBorderColor(a,r.inputBoxBorderColor,!0),inputBoxBackgroundColor:this.getColor(a,"inputBoxColor",r.inputBoxBackgroundColor),inputBoxForegroundColor:this.getColor(a,"foregroundColor",r.inputBoxForegroundColor),fontSize:null!=i&&i.ignoreFontSizeAndFamily?null:r.fontSize,fontFamily:null!=i&&i.ignoreFontSizeAndFamily?null:r.fontFamily}},t.determineIsLinkedAsAggregation=function(e,t,r){if(5===e.howCreated)return null!=r.defaultAggregate(e.expression,t)},t.getDisplayNameForIncludeExcludeFilters=function(e,t,r){return(t===s.Include?e.get("Include_Label"):e.get("FilterPane_Exclude"))+" ("+r+")"},t.getCheckboxAndApplyColor=function(e,t){void 0===t&&(t=l.constants.ExploreCanvasConstants.DefaultOutspacePaneCheckboxAndApplyColor);t=N.DataViewObject.getFillColorByPropertyName(e,"checkboxAndApplyColor",t);return o.hexToRGBString(t)},t.getBorderColor=function(e,t,r){t=N.DataViewObject.getFillColorByPropertyName(e,"borderColor",t),r=!0===N.DataViewObject.getValue(e,"border",l.constants.ExploreCanvasConstants.DefaultFilterCardBorder)||r?1:0;return o.hexToRGBString(t,r)},t.getBackgroundColor=function(e,t,r,i,a){t=N.DataViewObject.getFillColorByPropertyName(e,"backgroundColor",i&&a?a:t),r=o.convertTransparencyToOpacity(N.DataViewObject.getValue(e,"transparency",r));return o.hexToRGBString(t,r)},t.getColor=function(e,t,r){r=N.DataViewObject.getFillColorByPropertyName(e,t,r);return o.hexToRGBString(r)},t.getFontSize=function(e){return N.DataViewObject.getValue(e,"textSize",l.constants.ExploreCanvasConstants.DefaultFilterCardTextSizePt)+"pt"},t.getFontFamily=function(e){return N.DataViewObject.getValue(e,"fontFamily",l.constants.ExploreCanvasConstants.DefaultOutspacePaneFontFamily)},t.extractAllReferencedFields=function(e){var t=this;return _.flatten(_.map(e,(function(e){return t.extractReferencedFields(e)})))},t.extractReferencedFields=function(e){var t=[];if(e.expression&&t.push(e.expression),e.filter)for(var r=0,i=e.filter.conditions();r<i.length;r++){var a=i[r],o=new C;a.accept(o),t=t.concat(o.fields)}return t},t.supportsMeasureFilters=function(e,t){e=l.util.VisualContainerUtils.getVisualType(e);return!t.isAnalysisVisual(e)},t.getFilterCapabilities=function(e){return{canClear:this.canClearManually(e),canDelete:this.canDeleteManually(e),canEdit:this.canEditManually(e),canHide:this.canHideManually(e),canLock:this.canLockManually(e),canRename:this.canRenameManually(e),canSort:this.canSortManually(e)}},t.canClearManually=function(e){var t=5===e.howCreated&&(e.type===s.Exclude||e.type===s.Include);return(0===e.howCreated||1===e.howCreated||2===e.howCreated||5===e.howCreated||7===e.howCreated)&&e.type!==s.Passthrough&&!t},t.canDeleteManually=function(e){return 1===e.howCreated||5===e.howCreated||7===e.howCreated||e.type===s.Passthrough||3===e.howCreated||4===e.howCreated},t.canEditManually=function(e){return(0===e.howCreated||1===e.howCreated||2===e.howCreated||5===e.howCreated||7===e.howCreated||3===e.howCreated||4===e.howCreated)&&e.type!==s.Passthrough},t.canHideManually=function(e){return 0===e.howCreated||1===e.howCreated||5===e.howCreated&&!e.isTransient||e.type===s.Passthrough||3===e.howCreated||4===e.howCreated},t.canLockManually=function(e){return(0===e.howCreated||1===e.howCreated||5===e.howCreated&&!e.isTransient||3===e.howCreated||4===e.howCreated)&&e.type!==s.Passthrough},t.canRenameManually=function(e){return(0===e.howCreated||1===e.howCreated)&&e.type!==s.Passthrough},t.canSortManually=function(e){return 0===e.howCreated||1===e.howCreated||e.type===s.Passthrough||3===e.howCreated||4===e.howCreated},t);function t(){}l.FilterUtils=e;var y,C=(y=N.data.DefaultSQExprVisitorWithTraversal,__extends(x,y),x.prototype.visitColumnRef=function(e){this.fields.push(e)},x.prototype.visitHierarchyLevel=function(e){this.fields.push(e)},x.prototype.visitMeasureRef=function(e){this.fields.push(e)},x.prototype.visitEntity=function(e){this.fields.push(e)},x.prototype.visitAggr=function(){},x);function x(){var e=null!==y&&y.apply(this,arguments)||this;return e.fields=[],e}var b,S=(b=N.data.DefaultSQExprVisitor,__extends(E,b),E.prototype.visitCompare=function(e){0===e.comparison&&f.isConstant(e.right)&&f.equals(e.left,this.comparisonColumn)&&this.values.push(e.right)},E.prototype.visitIn=function(e){var t=this;if(!_.isEmpty(e.values)){var r=e.args,i=_.findIndex(r,(function(e){return f.equals(e,t.comparisonColumn,void 0,!0)}));if(!(i<0))for(var a=0,o=e.values;a<o.length;a++){var n=o[a];this.values.push(n[i])}}},E);function E(e){var t=b.call(this)||this;return t.comparisonColumn=e,t.values=[],t}})(N.explore||(N.explore={}))})(powerbi=powerbi||{}),(function(n){var e,m,s,i,v,f;function t(e,t){return e.displayName.localeCompare(t.displayName,void 0,{sensitivity:"base"})}e=(e=n.explore||(n.explore={})).util||(e.util={}),m=n.data.SQExpr,s=n.data.SQExprBuilder,i=n.data.SQExprConverter,v=n.data.SQExprGroupUtils,f=n.data.SQHierarchyExprUtils,(e=e.HierarchyUtils||(e.HierarchyUtils={})).getOptionsToAddHierarchyLevelToExistingHierarchies=function(s,e,l,t){if(l&&e&&m.isHierarchyLevel(t)){for(var p=t,u=p.arg,c=f.expandExpr(s,u),d=[],r=0,i=e.dataRoles;r<i.length;r++)!(function(e){var t=l.tryGetExprs(e.name);if(!t)return;for(var r,i=0,a=m.isHierarchy(u)&&m.isPropertyVariationSource(u.arg)?(r=u.arg,_(v.groupExprs(s,t)).filter((function(e){return e.isHierarchyLevelsGroup&&m.isColumn(e.expr)&&m.equals(e.expr.source,r.arg)&&e.expr.ref===r.property})).reverse().value()):_(v.groupExprs(s,t)).filter((function(e){return m.equals(e.expr,u)})).reverse().value();i<a.length;i++){var o=a[i],n=f.getInsertionIndex(c,o.children,p);d.push({expr:p,schema:s,targetRole:e.name,projOptions:{fieldIndex:o.selectQueryIndex+n}})}})(i[r]);return d}},e.getHierarchyReplacementExpressions=function(e,t,r,i,a,o){if(r=(e.singleVisual.query.tryGetExprs(t)||[]).slice(r,r+i),!_.isEmpty(r)){i=(_.isEmpty(o)?r:o)[0];if(m.isHierarchyLevel(i)){i=(function(e,t){if(e&&e.kind===n.VisualDataRoleKind.Measure){t=f.getHierarchySourceAsVariationSource(t);if(t)return s.columnRef(t.arg,t.property)}})(a,i);if(i)return[i]}return _.isEmpty(o)?r:o}},e.hierarchyLevelComparer=function(e,t){return m.isHierarchyLevel(e)&&m.isHierarchyLevel(t)&&m.equals(e.arg,t.arg)},e.findHierarchyLevelIndex=function(e,t){var r=i.asFieldPattern(t).hierarchyLevel;if(r){e=e.findHierarchy(r.entity,r.name);return e?_.findIndex(e.levels,(function(e){return e.name===r.level})):void 0}},e.sortHierarchies=function(e){_.isEmpty(e)||e.sort(t)}})(powerbi=powerbi||{}),(function(t){!(function(e){var h,p,y,o;function d(){}e=e.util||(e.util={}),h=t.data.DataViewMatrixUtils,p=t.data.DataViewSelectTransform,y=t.visuals.matrixRoleNames,o=t.data.SQExprUtils,d.generate=function(e,t,r,i,a,o){if(e.matrix){for(var n=[],s=[],l=[],p=[],u=e.matrix,c=0,d=t;c<d.length;c++){var m=d[c],m=__assign({},m);m.roles={},n.push(m)}var v=function(e){if(o&&o.featureSwitches.showGeneratedColumnsInDetailView)return!0;e=t[e.index];return!e||!_.isEmpty(e.roles)||!_.isEmpty(e.relatedSelects)},f=null==o?void 0:o.featureSwitches.comboMultiples,g=this.getSelectsGroupedByRowHierarchy(r,t,e.matrix,v),r=this.tryProcessDataViewHierarchy(u.rows,n,s,y.rows,g)&&this.tryProcessDataViewHierarchy(u.columns,n,l,y.columns,g,(function(e){return!e.isMeasure}))&&this.tryUpdateReferencedSelects(u.valueSources,n,p,y.values,g,v);if(!f||(u=_.last(u.rows.levels))&&(r=r&&this.tryUpdateReferencedSelects(h.getScopedValueSources(u),n,p,y.values,g,v)),r){r=e;this.sortMatrixRoleProjectionOrders(i,a,s,l,p,n),_.isEmpty(g)||(r=this.fixMeasuresGroupedByRowHierarchy(e,f,g));g={};return 0<s.length&&(g[y.rows]=s),0<l.length&&(g[y.columns]=l),0<p.length&&(g[y.values]=p),{transformActions:{selects:n,roles:{ordering:g}},dataView:r}}}},d.getSelectsGroupedByRowHierarchyFromMatrix=function(e,t){var r={},e=null===(e=null==e?void 0:e.rows)||void 0===e?void 0:e.levels;if(!_.isEmpty(e)){e=_.last(e),e=h.getScopedValueSources(e);if(!_.isEmpty(e))for(var i=0,a=e;i<a.length;i++){var o=a[i];_.isNumber(o.index)&&t(o)&&(r[o.index]=!0)}}return r},d.tryProcessDataViewHierarchy=function(e,t,r,i,a,o){if(!e||_.isEmpty(e.levels))return!0;for(var n=0,s=e.levels;n<s.length;n++){var l=s[n];if(!this.tryUpdateReferencedSelects(l.sources,t,r,i,a,o))return!1}return!0},d.tryUpdateReferencedSelects=function(i,a,o,n,s,l){if(_.isEmpty(i))return!0;for(var e=function(r){if(!l||l(r)){if(null==r.index&&_.some(i,(function(e){return e.formatSource&&e.formatSource.formatString===r})))return"continue";if(s[r.index]){if(!_.isEmpty(a[r.index].relatedSelects))for(var e=0,t=a[r.index].relatedSelects;e<t.length;e++)!(function(t){var e=_.findIndex(a,(function(e){return e.queryName===t.queryName}));s[e]||o.push(r.index)})(t[e])}else o.push(r.index);if(!a[r.index])return{value:!1};a[r.index].roles[n]=!0}},t=0,r=i;t<r.length;t++){var p=e(r[t]);if("object"==typeof p)return p.value}return!0},d.sortMatrixRoleProjectionOrders=function(e,t,r,i,a,o){var n,s,l;!_.isEmpty(e)&&t&&(n=2<=r.length,s=2<=i.length,l=2<=a.length,!(n||s||l)||(t=this.createSelectIndexToSortOrderMappings(e,t))&&(n&&this.applySortOrder(r,t),s&&this.applySortOrder(i,t),l&&(this.applySortOrder(a,t),(t={})[y.values]=a,t=t,p.reorderDependentSelects(o,t))))},d.createSelectIndexToSortOrderMappings=function(e,t){e=_.chain(e).map((function(e){return t[e]})).flatten().filter((function(e){return _.isNumber(e)})).value(),e=_.reduce(e,(function(e,t,r){return void 0===e[t]&&(e[t]=r),e}),{});return 2<=Object.keys(e).length?e:void 0},d.applySortOrder=function(e,r){var i=this;e.sort((function(e,t){return i.getSortOrderOrDefault(e,r)-i.getSortOrderOrDefault(t,r)}))},d.getSortOrderOrDefault=function(e,t,r){return void 0===r&&(r=Number.MAX_VALUE),_.isNumber(t[e])?t[e]:r},d.fixMeasuresGroupedByRowHierarchy=function(e,t,r){e.matrix,e.matrix.columns;var i=e.matrix;if(this.nothingToFix(r,i))return e;i=_.cloneDeep(e);return t?this.addMeasureValuesGroupedByRowHierarchy(i,r):(e.categorical,this.removeMeasuresGroupedByRowHierarchy(i.matrix,r),this.addMeasureValuesGroupedByRowHierarchyLegacy(i,r)),i},d.nothingToFix=function(e,t){return _.isEmpty(Object.keys(e))||_.isEmpty(t.columns.root.children)||_.isEmpty(t.rows.root.children)},d.getSelectsGroupedByRowHierarchy=function(e,t,r,i){var a;if(e&&1<e.length){(null===(a=e[0])||void 0===a?void 0:a.selects)&&(null===(o=e[1])||void 0===o||o.selects);var o=this.categorizeSplitSelects(e[0],t);if(_.isEmpty(o.measureSelectIndices))return{};var n=this.categorizeSplitSelects(e[1],t);if(_.isEqual(o.groupingSelectIndices,n.groupingSelectIndices))return{};if(!_.isEmpty(n.measureSelectIndices))for(var s=_.map(_.keys(n.measureSelectIndices),(function(e){return t[parseInt(e,10)].queryName})),l=0;l<t.length;l++){var p=t[l];if(!_.isEmpty(p.relatedSelects))for(var u=0,c=p.relatedSelects;u<c.length;u++)!(function(t){null!=_.find(s,(function(e){return t.queryName===e}))&&(n.measureSelectIndices[l]=!0)})(c[u])}return n.measureSelectIndices}return d.getSelectsGroupedByRowHierarchyFromMatrix(r,i)},d.categorizeSplitSelects=function(e,t){var r,i={groupingSelectIndices:{},measureSelectIndices:{}};for(r in e.selects){var a=t[r];a.expr&&(o.isMeasure(a.expr)?i.measureSelectIndices[r]=!0:i.groupingSelectIndices[r]=!0)}return i},d.addMeasureValuesGroupedByRowHierarchy=function(e,t){e.matrix.columns.root.children;var r=e.matrix,i=r.columns.levels[0],o=[],a=_.last(r.rows.levels),n=r.valueSources.length;a.valueSources;var s=h.getScopedValueSources(a);if(s){for(var l=r.columns.root,p=this.getColumnLeavesCount(l),u=0;u<s.length;u++){var c=s[u];t[c.index]&&(c.formatSource&&delete c.formatSource,r.valueSources.push(c),this.addStaticMeasureColumnHeader(i,c,l),o.push(u))}h.forEachLeafNode(e.matrix.rows.root,(function(e){var t=p,r=h.getNodeScopedValues(e);if(!_.isEmpty(r))for(var i=0;i<o.length;i++){var a=o[i];e.values[t++]={value:r[a].value,valueSourceIndex:n+i}}}))}},d.addMeasureValuesGroupedByRowHierarchyLegacy=function(e,t){e.matrix.columns.root.children;for(var r=e.matrix,i=r.columns.root,a=this.getColumnLeavesCount(i),o=r.columns.levels[0],n=0,s=r.valueSources;n<s.length;n++){var l=s[n];t[l.index]&&this.addStaticMeasureColumnHeader(o,l,i)}var p=this.getValuesForMeasuresGroupedByRowHierarchy(e,t),u=0;h.forEachLeafNode(e.matrix.rows.root,(function(e){var t,r=a;for(t in p){var i=p[t];e.values[r]={value:i[u],valueSourceIndex:parseInt(t,10)},r++}u++}))},d.getColumnLeavesCount=function(e){var t=0;return h.forEachLeafNode(e,(function(){return t++})),t},d.addStaticMeasureColumnHeader=function(e,t,r){e.sources.push(t);e={level:0,levelSourceIndex:e.sources.length-1};r.children.push(e)},d.getValuesForMeasuresGroupedByRowHierarchy=function(r,i){for(var a={},e=0,t=r.categorical.values;e<t.length;e++)!(function(t){var e;t.source&&i[t.source.index]&&(t.identity,e=_.findIndex(r.matrix.valueSources,(function(e){return e.index===t.source.index})),a[e]=t.values)})(t[e]);return a},d.removeMeasuresGroupedByRowHierarchy=function(e,t){for(var r={},i=[],a=0;a<e.valueSources.length;a++){var o,n=e.valueSources[a];t[n.index]&&(r[a]=!0,i.push(n),n&&n.formatSource&&n.formatSource.formatString&&(o=n.formatSource.formatString,r[e.valueSources.indexOf(o)]=!0,i.push(o),delete n.formatSource))}this.removeColumnHeaders(e.columns,r),e.valueSources=this.adjustIntersections(e.rows,r,e.valueSources);var s=_.last(e.columns.levels);s.sources=s.sources.filter((function(t){return!_.find(i,(function(e){return e===t}))}))},d.removeColumnHeaders=function(e,t){for(var r=0,i=h.getLeafNodesPath(e.root);r<i.length;r++){var a=i[r],a=a[a.length-2];a.children=_.filter(a.children,(function(e){return!t[e.levelSourceIndex||0]})),a.children&&null!=a.level&&1===a.children.length&&delete a.children}},d.adjustIntersections=function(e,n,t){if(!_.isEmpty(e.root.children)){var r=t.filter((function(e,t){return e&&!n[t]})),s=r.length;return r.push.apply(r,t.filter((function(e,t){return e&&null!=e.index&&n[t]}))),h.forEachLeafNode(e.root,(function(e){var t,r={},i=0;for(t in e.values){var a,o=e.values[t];n[o.valueSourceIndex||0]||(0==(a=i%s)?delete o.valueSourceIndex:o.valueSourceIndex=a,r[i]=o,i++)}e.values=r})),r}},e.MatrixVisualDataViewConverter=d})(t.explore||(t.explore={}))})(powerbi=powerbi||{}),(function(e){var t,o,l,n,p;function u(e,t){return t.apply({changes:[e]})}function s(e){if(c(e)){if(e.column||e.groupingColumn)return"Column";if(e.measure)return"Measure";if(e.hierarchy)return"Hierarchy"}return"Table"}function c(e){return o.getPropertyName(e)||o.getHierarchyName(e)}t=(t=e.explore||(e.explore={})).util||(t.util={}),o=e.data.FieldExprPattern,l=e.data.SQExpr,n=e.data.SQExprBuilder,p=e.data.SQExprConverter,(t=t.ModelAuthoringUtility||(t.ModelAuthoringUtility={})).move=function(e,t,r){!e||(e=p.asFieldPattern(e).hierarchyLevel)&&u({hierarchyLevelMove:{schema:e.schema,entity:e.entity,hierarchy:e.name,level:e.level,index:t}},r)},t.refreshEntity=function(e,t){u({entityRefresh:{schema:(e=o.toFieldExprEntityItemPattern(e)).schema,entity:e.entity}},t)},t.rename=function(e,t,r){if(e){var i,a=p.asFieldPattern(e),e=o.toFieldExprEntityItemPattern(a);return a.hierarchyLevel?i={hierarchyLevelRename:{schema:(i=a.hierarchyLevel).schema,entity:i.entity,hierarchy:i.name,before:i.level,after:t}}:o.hasFieldExprName(a)?i={propertyRename:{schema:e.schema,entity:e.entity,objectType:s(a),before:c(a),after:t}}:a.hierarchy?i={propertyRename:{schema:e.schema,entity:e.entity,objectType:s(a),before:o.getHierarchyName(a),after:t}}:e.entity&&(i={entityRename:{schema:e.schema,before:e.entity,after:t}}),u(i,r)}},t.createHierarchy=function(e,t){if(_.isEmpty(e),!_.isEmpty(e)){for(var r,i=[],a=0,o=e;a<o.length;a++){var n=o[a],s=p.asFieldPattern(n),s=s.column||s.groupingColumn;if(!s)return;if(r){if(!l.equals(n.source,r))return}else r=n.source;i.push({property:s.name,columnName:s.name})}u({hierarchyCreate:{schema:r.schema,entity:r.entity,name:null,levels:i}},t)}},t.createHierarchyLevel=function(e,t,r,i){!e||(e=(e=p.asFieldPattern(e)).column||e.groupingColumn)&&u({hierarchyLevelCreate:{schema:e.schema,entity:e.entity,hierarchy:t,property:e.name,index:r}},i)},t.getSelectedItemFromModelChange=function(e){if(null!=e&&!_.isEmpty(e.changes)){e=_.filter(e.changes,(function(e){return e.newMeasureCreated||e.newCalculatedColumnCreated||e.measureMove||e.newCalculatedTableCreated||e.newBins||e.newGroups}));if(0!==e.length){var t,r,i,a,e=e[e.length-1];return e.newMeasureCreated?(t=e.newMeasureCreated.schema,r=e.newMeasureCreated.entity,a=e.newMeasureCreated.name,n.measureRef(n.entity(t,r),a)):e.newCalculatedColumnCreated?(t=e.newCalculatedColumnCreated.schema,r=e.newCalculatedColumnCreated.entity,i=e.newCalculatedColumnCreated.name,n.columnRef(n.entity(t,r),i||a)):e.newCalculatedTableCreated?(t=e.newCalculatedTableCreated.schema,r=e.newCalculatedTableCreated.entity,n.entity(t,r)):e.measureMove?(t=e.measureMove.schema,r=e.measureMove.destination,a=e.measureMove.property,n.measureRef(n.entity(t,r),a)):e.newBins?(t=e.newBins.schema,r=e.newBins.entity,i=e.newBins.name,n.columnRef(n.entity(t,r),i)):e.newGroups?(t=e.newGroups.schema,r=e.newGroups.entity,i=e.newGroups.name,n.columnRef(n.entity(t,r),i)):void 0}}},t.validate=function(e,t,r){var i=[];if(e&&(i=e.validate(t,r,i)),!_.isEmpty(i))return i},t.getObjectTypeForSchemaChange=s,t.getFieldExprReferenceNameInEntity=c})(powerbi=powerbi||{}),(function(e){(function(e){var c,t;(t=c=e.NameValidationError||(e.NameValidationError={}))[t.None=0]="None",t[t.DuplicatedName=1]="DuplicatedName",t[t.EmptyName=2]="EmptyName",t[t.NameTooLong=3]="NameTooLong",e.createNameValidator=function(e,t){return new r(e,t)};var r=(d.prototype.validateMeasureName=function(e,t){if(!e||0===e.trim().length)return{error:c.EmptyName,reason:this.localizationService.get("NameValidationFailedEmptyName")};if(e.length>this.MaximumNameLength)return{error:c.NameTooLong,reason:this.localizationService.format("NameValidationFailedLongName",[e,this.MaximumNameLength])};e=d.normalizeModelItemName(e);return t&&d.normalizeModelItemName(t)===e?{error:c.None}:this.validateColumnAndMeasureNameUniqueness(e)},d.prototype.validateExistingMeasureName=function(r){var e=d.normalizeModelItemName(r.name);return this.validateColumnAndMeasureNameUniqueness(e,(function(e,t){return t!==r}))},d.prototype.makeValidMeasureName=function(e){var t=this;return this.makeValidName(e,(function(e){return t.validateMeasureName(e).error}))},d.prototype.makeValidName=function(e,t){t(e),c.EmptyName;var r,i=e;if((a=t(i))===c.DuplicatedName)r=2;else{if(a===c.None)return e;r=0}for(;;){i.length;var a,o=void 0;switch(a=t(o=r?i+" "+r:i)){case c.None:return o;case c.DuplicatedName:1===++r&&(r=2);continue;case c.NameTooLong:i=i.slice(0,Math.min(this.MaximumNameLength,i.length-1)),r=0;continue;default:throw new Error("MakeValidName encountered a problem it can't fix.")}}},d.prototype.validateColumnAndMeasureNameUniqueness=function(e,t){for(var r=0,i=this.federatedConceptualSchema.schemas;r<i.length;r++)for(var a=0,o=i[r].entities;a<o.length;a++)for(var n=o[a],s=0,l=n.properties;s<l.length;s++){var p=l[s];if((!t||t(n,p))&&d.normalizeModelItemName(p.name)===e){var u=p.measure?"NameValidationFailedCollisionMeasure":"NameValidationFailedCollisionColumn";return{error:c.DuplicatedName,reason:this.localizationService.format(u,[p.name,n.name])}}}return{error:c.None}},d.normalizeModelItemName=function(e){return jsCommon.StringExtensions.normalizeCase(e)},d);function d(e,t){this.federatedConceptualSchema=e,this.localizationService=t,this.MaximumNameLength=512}})((e=e.explore||(e.explore={})).util||(e.util={}))})(powerbi=powerbi||{}),(function(l){var e;(function(e){var i=l.data.QueryProjectionCollection,a=l.data.QueryProjectionsByRole,o=(Object.defineProperty(r,"ValuesRoleName",{get:function(){return r.ValuesRole},enumerable:!1,configurable:!0}),r.getProjectionCollection=function(e,t){var r=a.getRole(e,t);return r||(e[t]=r=new i([])),r},r.addCategoryRole=function(e,t){t.metadata.kind,r.getProjectionCollection(e,r.CategoryRole).addProjection(t.projection)},r.addValuesRole=function(e,t){r.getProjectionCollection(e,r.ValuesRole).addProjection(t.projection)},r.addSeriesRole=function(e,t){t.metadata.kind,r.getProjectionCollection(e,r.SeriesRole).addProjection(t.projection)},r.addBreakdownRole=function(e,t){t.metadata.kind,r.getProjectionCollection(e,r.BreakdownRole).addProjection(t.projection)},r.addGroupRole=function(e,t){t.metadata.kind,r.getProjectionCollection(e,r.GroupRole).addProjection(t.projection)},r.addDetailsRole=function(e,t){t.metadata.kind,r.getProjectionCollection(e,r.DetailsRole).addProjection(t.projection)},r.addYRole=function(e,t){t.metadata.kind,r.getProjectionCollection(e,r.YRole).addProjection(t.projection)},r.addTargetValueRole=function(e,t){t.metadata.kind,r.getProjectionCollection(e,r.TargetValueRole).addProjection(t.projection)},r.addMinValueRole=function(e,t){t.metadata.kind,r.getProjectionCollection(e,r.MinValueRole).addProjection(t.projection)},r.addMaxValueRole=function(e,t){t.metadata.kind,r.getProjectionCollection(e,r.MaxValueRole).addProjection(t.projection)},r.addXRole=function(e,t){t.metadata.kind,r.getProjectionCollection(e,r.XRole).addProjection(t.projection)},r.addSizeRole=function(e,t){t.metadata.kind,r.getProjectionCollection(e,r.SizeRole).addProjection(t.projection)},r.addGradientRole=function(e,t){t.metadata.kind,r.getProjectionCollection(e,r.GradientRole).addProjection(t.projection)},r.addTooltipRole=function(e,t){t.metadata.kind,r.getProjectionCollection(e,r.TooltipRole).addProjection(t.projection)},r.addRowsRole=function(e,t){t.metadata.kind,r.getProjectionCollection(e,r.RowsRole).addProjection(t.projection)},r.addColumnsRole=function(e,t){t.metadata.kind,r.getProjectionCollection(e,r.ColumnsRole).addProjection(t.projection)},r.prototype.initialize=function(e,t){var r=e.select();this.projectionsInfo=[];for(var i=0,a=r.length;i<a;i++){var o=r[i];this.projectionsInfo.push({projection:{queryRef:o.name},metadata:o.expr.getMetadata(t)})}},r.ValuesRole="Values",r.SeriesRole="Series",r.BreakdownRole="Breakdown",r.CategoryRole="Category",r.GroupRole="Group",r.DetailsRole="Details",r.YRole="Y",r.Y2Role="Y2",r.XRole="X",r.SizeRole="Size",r.GradientRole="Gradient",r.PlayRole="Play",r.RowsRole="Rows",r.ColumnsRole="Columns",r.MinValueRole="MinValue",r.MaxValueRole="MaxValue",r.TargetValueRole="TargetValue",r.TooltipRole="Tooltips",r);function r(e,t,r){e.capabilities,this.plugin=e,this.initialize(t,r)}e.QueryProjectionBuilder=o;var n,s=(__extends(t,n=o),t.prototype.validatePlugin=function(){return!0},t.prototype.build=function(){for(var e={},t=0,r=this.dataRoles.length;t<r;t++){var i=this.dataRoles[t],a=this.projectionsInfo[i.Projection];a&&(o.getProjectionCollection(e,i.Name).addProjection(a.projection),i.isActive&&e[i.Name].addActiveQueryReference(a.projection.queryRef))}return e},t);function t(e,t,r,i){i=n.call(this,e,r,i)||this;return i.dataRoles=t,i}e.DataRolesQueryProjectionBuilder=s,e.createProjectionBuilderFromDataRoles=function(e,t,r,i){return new s(e,t,r,i)}})((e=l.explore||(l.explore={})).QueryProjectionBuilderCoreUtils||(e.QueryProjectionBuilderCoreUtils={}))})(powerbi=powerbi||{}),(function(e){var t,r,i,a,o;t=e.explore||(e.explore={}),r=t.utils||(t.utils={}),t=jsCommon.Lazy,o=e.visuals.plugins,r=r.visualUtil||(r.visualUtil={}),i=new t(function(){var e={};return e[3]=o.card,e[13]=o.lineClusteredColumnComboChart,e[29]=o.multiRowCard,e[7]=o.clusteredBarChart,e[10]=o.clusteredColumnChart,e[20]=o.donutChart,e[16]=o.funnel,e[30]=o.gauge,e[22]=o.heatMap,e[9]=o.hundredPercentStackedBarChart,e[12]=o.hundredPercentStackedColumnChart,e[4]=o.lineChart,e[1]=o.map,e[19]=o.filledMap,e[2]=o.pivotTable,e[5]=o.pieChart,e[6]=o.scatterChart,e[8]=o.barChart,e[11]=o.columnChart,e[0]=o.tableEx,e[17]=o.treemap,e[23]=o.waterfallChart,e[26]=o.stackedAreaChart,e[32]=o.areaChart,e[33]=o.ribbonChart,e[34]=o.kpi,e[35]=o.decompositionTreeVisual,e}),a=new t(function(){var e={};return e[o.card.name]=3,e[o.lineClusteredColumnComboChart.name]=13,e[o.multiRowCard.name]=29,e[o.clusteredBarChart.name]=7,e[o.clusteredColumnChart.name]=10,e[o.donutChart.name]=20,e[o.funnel.name]=16,e[o.gauge.name]=30,e[o.heatMap.name]=22,e[o.hundredPercentStackedBarChart.name]=9,e[o.hundredPercentStackedColumnChart.name]=12,e[o.lineChart.name]=4,e[o.map.name]=1,e[o.filledMap.name]=19,e[o.matrix.name]=2,e[o.pivotTable.name]=2,e[o.pieChart.name]=5,e[o.scatterChart.name]=6,e[o.barChart.name]=8,e[o.columnChart.name]=11,e[o.table.name]=0,e[o.tableEx.name]=0,e[o.treemap.name]=17,e[o.waterfallChart.name]=23,e[o.stackedAreaChart.name]=26,e[o.areaChart.name]=32,e[o.ribbonChart.name]=33,e[o.kpi.name]=34,e[o.decompositionTreeVisual.name]=35,e}),r.getPlugin=function(e){return i.getValue()[e]},r.getType=function(e){return a.getValue()[e]}})(powerbi=powerbi||{}),(function(D){var e;(function(e){var t=D.visuals.plugins,l=D.explore.QueryProjectionBuilderCoreUtils.QueryProjectionBuilder;(e.QueryProjectionBuilderUtils||(e.QueryProjectionBuilderUtils={})).createProjectionBuilder=function(e,t,r){var i,a=D.explore.utils.visualUtil.getPlugin(e);if(null!=a){switch(e){case 3:case 29:case 0:i=new o(a,t,r);break;case 2:i=new j(a,t,r);break;case 20:case 16:case 4:case 26:case 32:case 5:i=new n(a,t,r);break;case 23:i=new u(a,t,r);break;case 7:case 10:case 9:case 12:case 8:case 11:case 33:case 13:i=new m(a,t,r);break;case 1:case 22:i=new S(a,t,r);break;case 19:i=new V(a,t,r);break;case 17:i=new w(a,t,r);break;case 6:i=new C(a,t,r);break;case 30:i=new g(a,t,r);break;default:return}return i}};var i,o=(__extends(r,i=l),r.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return 1===e.length&&e[0].name===l.ValuesRole},r.prototype.build=function(e){var t={};if(1===this.projectionsInfo.length)return l.addValuesRole(t,this.projectionsInfo[0]),t;e=e.Primary.Groupings;e.length;var r=e[0].Projections;r.length,this.projectionsInfo.length;for(var i=0,a=r.length;i<a;i++)l.addValuesRole(t,this.projectionsInfo[r[i]]);return t},r);function r(e,t,r){return i.call(this,e,t,r)||this}var a,n=(__extends(s,a=l),s.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return this.plugin.name===t.funnel.name?4===e.length&&e[0].name===l.CategoryRole&&e[1].name===l.YRole&&e[2].name===l.GradientRole&&e[3].name===l.TooltipRole:this.plugin.name===t.lineChart.name?5===e.length&&e[0].name===l.CategoryRole&&e[1].name===l.SeriesRole&&e[2].name===l.YRole&&e[3].name===l.Y2Role&&e[4].name===l.TooltipRole:4===e.length&&e[0].name===l.CategoryRole&&e[1].name===l.SeriesRole&&e[2].name===l.YRole&&e[3].name===l.TooltipRole},s.prototype.build=function(e){var t=e.Primary.Groupings;t.length;var r={};return this.processPrimaryGroup(t[0],r),e.Secondary&&((e=e.Secondary.Groupings).length,1===e.length&&this.processSecondaryGroup(e[0],r)),r},s.prototype.processPrimaryGroup=function(e,t){for(var r=e.Projections,i=0,a=r.length;i<a;i++){var o=r[i];this.projectionsInfo.length;o=this.projectionsInfo[o];0===o.metadata.kind?(l.addCategoryRole(t,o),t[l.CategoryRole].addActiveQueryReference(o.projection.queryRef)):1===o.metadata.kind&&l.addYRole(t,o)}},s.prototype.processSecondaryGroup=function(e,t){for(var r=e.Projections,i=0,a=r.length;i<a;i++){var o=r[i];this.projectionsInfo.length,l.addSeriesRole(t,this.projectionsInfo[o])}},s);function s(e,t,r){return a.call(this,e,t,r)||this}var p,u=(__extends(c,p=n),c.prototype.processSecondaryGroup=function(e,t){for(var r=e.Projections,i=0,a=r.length;i<a;i++){var o=r[i];this.projectionsInfo.length,l.addBreakdownRole(t,this.projectionsInfo[o])}},c);function c(e,t,r){return p.call(this,e,t,r)||this}var d,m=(__extends(v,d=n),v.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return this.plugin.name===t.ribbonChart.name?4===e.length&&e[0].name===l.CategoryRole&&e[1].name===l.SeriesRole&&e[2].name===l.YRole&&e[3].name===l.TooltipRole:5===e.length&&e[0].name===l.CategoryRole&&e[1].name===l.SeriesRole&&e[2].name===l.YRole&&e[3].name===l.GradientRole&&e[4].name===l.TooltipRole},v);function v(e,t,r){return d.call(this,e,t,r)||this}var f,g=(__extends(h,f=n),h.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return 5===e.length&&e[0].name===l.YRole&&e[1].name===l.MinValueRole&&e[2].name===l.MaxValueRole&&e[3].name===l.TargetValueRole&&e[4].name===l.TooltipRole},h.prototype.processPrimaryGroup=function(e,t){for(var r=0,i=0,a=e.Projections;i<a.length;i++){var o=a[i];this.projectionsInfo.length;var n=this.projectionsInfo[o];if(1===n.metadata.kind){switch(r){case 0:l.addYRole(t,n);break;case 1:l.addTargetValueRole(t,n);break;case 2:l.addMaxValueRole(t,n);break;case 3:l.addMinValueRole(t,n);break;case 4:l.addTooltipRole(t,n)}r++}}},h);function h(e,t,r){return f.call(this,e,t,r)||this}var y,C=(__extends(x,y=n),x.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return 8===e.length&&e[0].name===l.CategoryRole&&e[1].name===l.SeriesRole&&e[2].name===l.XRole&&e[3].name===l.YRole&&e[4].name===l.SizeRole&&e[5].name===l.GradientRole&&e[6].name===l.PlayRole&&e[7].name===l.TooltipRole},x.prototype.processPrimaryGroup=function(e,t){for(var r=e.Projections,i=0,a=0,o=r.length;a<o;a++){var n=r[a];this.projectionsInfo.length;var s=this.projectionsInfo[n];if(0===s.metadata.kind)l.addCategoryRole(t,s);else if(1===s.metadata.kind){switch(i){case 0:l.addXRole(t,s);break;case 1:l.addYRole(t,s);break;case 2:l.addSizeRole(t,s);break;case 3:l.addGradientRole(t,s);break;case 4:l.addTooltipRole(t,s)}i++}}},x);function x(e,t,r){return y.call(this,e,t,r)||this}var b,S=(__extends(E,b=n),E.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return 7===e.length&&e[0].name===l.CategoryRole&&e[1].name===l.SeriesRole&&e[2].name===l.YRole&&e[3].name===l.XRole&&e[4].name===l.SizeRole&&e[5].name===l.GradientRole&&e[6].name===l.TooltipRole},E.prototype.processPrimaryGroup=function(e,t){e=e.Projections;0<e.length&&e.length;for(var r=0,i=0,a=e;i<a.length;i++){var o=a[i];this.projectionsInfo.length;var n=this.projectionsInfo[o];if(0===n.metadata.kind)l.addCategoryRole(t,n);else if(1===n.metadata.kind){switch(r){case 0:l.addSizeRole(t,n);break;case 1:l.addXRole(t,n);break;case 2:l.addYRole(t,n);break;case 3:l.addGradientRole(t,n);break;case 4:l.addTooltipRole(t,n)}r++}}},E);function E(e,t,r){return b.call(this,e,t,r)||this}var N,V=(__extends(_,N=n),_.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return 6===e.length&&e[0].name===l.CategoryRole&&e[1].name===l.SeriesRole&&e[2].name===l.YRole&&e[3].name===l.XRole&&e[4].name===l.SizeRole&&e[5].name===l.TooltipRole},_.prototype.processPrimaryGroup=function(e,t){e=e.Projections;0<e.length&&e.length;for(var r=0,i=0,a=e;i<a.length;i++){var o=a[i];this.projectionsInfo.length;var n=this.projectionsInfo[o];if(0===n.metadata.kind)l.addCategoryRole(t,n);else if(1===n.metadata.kind){switch(r){case 0:l.addSizeRole(t,n);break;case 1:l.addXRole(t,n);break;case 2:l.addYRole(t,n);break;case 3:l.addTooltipRole(t,n)}r++}}},_);function _(e,t,r){return N.call(this,e,t,r)||this}var P,w=(__extends(T,P=n),T.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return 5===e.length&&e[0].name===l.GroupRole&&e[1].name===l.DetailsRole&&e[2].name===l.ValuesRole&&e[3].name===l.GradientRole&&e[4].name===l.TooltipRole},T.prototype.processPrimaryGroup=function(e,t){for(var r=e.Projections,i=0,a=r.length;i<a;i++){var o=r[i];this.projectionsInfo.length;o=this.projectionsInfo[o];0===o.metadata.kind?(l.addGroupRole(t,o),t[l.GroupRole].addActiveQueryReference(o.projection.queryRef)):1===o.metadata.kind&&l.addValuesRole(t,o)}},T.prototype.processSecondaryGroup=function(e,t){var r=e.Projections;r.length;for(var i=0,a=r.length;i<a;i++){var o=r[i];this.projectionsInfo.length,l.addDetailsRole(t,this.projectionsInfo[o])}},T);function T(e,t,r){return P.call(this,e,t,r)||this}var F,j=(__extends(R,F=l),R.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return 3===e.length&&e[0].name===l.RowsRole&&e[1].name===l.ColumnsRole&&e[2].name===l.ValuesRole},R.prototype.build=function(e){var t=e.Primary.Groupings,r={};return this.processPrimaryGroups(t,r),e.Secondary&&(e=e.Secondary.Groupings,this.processSecondaryGroups(e,r)),r},R.prototype.processPrimaryGroups=function(e,t){if(e)for(var r=0,i=e.length;r<i;r++)this.processPrimaryGroup(e[r],t)},R.prototype.processSecondaryGroups=function(e,t){if(e)for(var r=0,i=e.length;r<i;r++)this.processSecondaryGroup(e[r],t)},R.prototype.processPrimaryGroup=function(e,t){for(var r=e.Projections,i=0,a=r.length;i<a;i++){r[i];this.projectionsInfo.length;var o=this.projectionsInfo[r[i]];0===o.metadata.kind?(l.addRowsRole(t,o),t[l.RowsRole].addActiveQueryReference(o.projection.queryRef)):1===o.metadata.kind&&l.addValuesRole(t,o)}},R.prototype.processSecondaryGroup=function(e,t){for(var r=e.Projections,i=0,a=r.length;i<a;i++){var o=this.projectionsInfo[r[i]];o.metadata.kind,l.addColumnsRole(t,o),t[l.ColumnsRole].addActiveQueryReference(o.projection.queryRef)}},R);function R(e,t,r){return F.call(this,e,t,r)||this}})((e=D.explore||(D.explore={})).utils||(e.utils={}))})(powerbi=powerbi||{}),(function(e){var r,t,o,n;function a(i,a,o,n,s){return __awaiter(this,void 0,e.Promise,(function(){var t,r;return __generator(this,(function(e){switch(e.label){case 0:return t=s?u(i,a,0,0):l(i,a),s||t?[4,n.get(i.reportId,t.name)]:[2];case 1:return r=e.sent(),r=r&&r.words,_.isEmpty(r)?r=[o]:r[0]=o,[4,n.set(i.reportId,t.name,r)];case 2:return e.sent(),[2]}}))}))}function p(e,t){return e&&e.pods?_.findIndex(e.pods,(function(e){return e.boundSection===t})):-1}function l(e,t){t=p(e,t);if(-1!==t)return e.pods[t]}function s(e,t){return e&&e.parameters?_.findIndex(e.parameters,(function(e){return e.boundFilter===t})):-1}function u(e,t,r,i){var a=l(e,t);return a||c(e,t,r,i)}function c(e,t,r,i){e.pods||(e.pods=[]);i={name:(function(e){for(var t={},r=0,i=e;r<i.length;r++){var a=i[r];t[a.name]=!0}return o.findUniqueName(t,n)})(e.pods),boundSection:t,parameters:[],type:0,referenceScope:r,config:{acceptsFilterContext:i}};return e.pods.push(i),jsCommon.ArrayExtensions.hasUniqueNames(e.pods),i}function d(t,r,e,i){var a=t.pods[r];_.isEmpty(a.parameters)&&(a.type=0),!a.cortanaEnabled&&_.isEmpty(a.parameters)&&0===a.config.acceptsFilterContext&&0===a.referenceScope&&(i?e.get(t.reportId,a.name).then((function(e){e&&!_.isEmpty(e.words)||m(t,r)})):m(t,r))}function m(e,t){e.pods.splice(t,1),0===e.pods.length&&(e.pods=void 0)}r=e.explore||(e.explore={}),t=r.PodUtils||(r.PodUtils={}),o=jsCommon.StringExtensions,n="Pod",t.getLinguisticMetadata=function(e,t,r,i){var a=i.defer();return-1===(t=p(e,t))?a.resolve(void 0):r.get(e.reportId,e.pods[t].name).then((function(e){e=e&&e.words.slice();_.isEmpty(e)?a.resolve(void 0):(e.shift(),a.resolve({altNames:e}))})),a.promise},t.deleteLinguisticEntity=function(r,i,a){return __awaiter(this,void 0,e.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return-1<(t=p(r,i))?[4,a.set(r.reportId,r.pods[t].name,[])]:[3,2];case 1:e.sent(),d(r,t,a,!1),e.label=2;case 2:return[2]}}))}))},t.deletePod=function(r,i,a){return __awaiter(this,void 0,e.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return-1<(t=p(r,i))?[4,a.set(r.reportId,r.pods[t].name,[])]:[3,2];case 1:e.sent(),m(r,t),e.label=2;case 2:return[2]}}))}))},t.ensurePod=function(t,r,i){return __awaiter(this,void 0,e.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,a(t,r.name,r.displayName,i,!0)];case 1:return e.sent(),[2]}}))}))},t.updateLinguisticPrimaryName=a,t.updateLinguisticAltNames=function(r,i,a,o){return __awaiter(this,void 0,e.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return t=u(r,i.name,0,0),a.unshift(i.displayName),[4,o.set(r.reportId,t.name,a)];case 1:return e.sent(),[2]}}))}))},t.addParameter=function(e,t,r,i,a,o,n){(t=u(e,t,0,0)).parameters||(t.parameters=[]),t.parameters.push({name:"Param_"+r,boundFilter:r,fieldExpr:i,asAggregation:a,isLegacySingleSelection:o}),null!=t.type&&0!==t.type||0===n||(t.type=n)},t.deleteParameter=function(e,t,r,i){var a=p(e,t);-1<a&&(-1<(r=s(t=e.pods[a],r))&&(t.parameters.splice(r,1),d(e,a,i,!0)))},t.updateParameter=function(e,t,r,i){-1<(t=p(e,t))&&(-1<(r=s(t=e.pods[t],r))&&(t.parameters[r].asAggregation=i))},t.hasParameter=function(e,t,r){return-1!==(t=p(e,t))&&-1!==s(e.pods[t],r)},t.setCortanaEnabled=function(e,t,r,i){var a,o=p(e,t);-1===o&&!r||(-1===o?(a=c(e,t,0,0),o=e.pods.length-1):a=e.pods[o],a.cortanaEnabled=r,d(e,o,i,!0))},t.findPodIndexForPodName=function(e,t){if(e&&e.pods){e=e.pods,e=_.findIndex(e,(function(e){return e.name===t}));return-1!==e?e:void 0}},t.duplicatePod=function(e,t,r,i,a){if(e.sections.length,-1===(r=p(e,e.sections[r].name)))return a.resolve();var o,n,s,l,r=void 0!==(a=e.pods[r]).config?a.config.acceptsFilterContext:0;return(r=c(e,t.name,a.referenceScope,r)).cortanaEnabled=a.cortanaEnabled,r.parameters=_.cloneDeep(a.parameters),r.type=a.type,o=e.reportId,n=t,s=r,(l=i).get(o,a.name).then((function(e){e=e&&e.words.slice();_.isEmpty(e)||(e.shift(),e.unshift(n.displayName),l.set(o,s.name,e))}))},t.findPodIndexForSectionName=p,t.findPodForSectionName=l,t.updateConfig=function(e,t,r){var i=l(e,t);(i=!i&&0!==r?c(e,t,0,r):i)&&(null!=i.config?i.config.acceptsFilterContext!==r&&(i.config.acceptsFilterContext=r):i.config={acceptsFilterContext:r})},t.updateReferenceScope=function(e,t,r){var i=l(e,t);(i=!i&&0!==r?c(e,t,r,0):i)&&null!=r&&i.referenceScope!==r&&(i.referenceScope=r)},t.acceptsAllFiltersWhenLinked=function(e,t){return!e||!t||(!(t=l(e,t.name))||!t.config||0===t.config.acceptsFilterContext)},t.hasMeasureOrAsAggregation=function(e,t){return!(!e||!t)&&(!(!(t=l(e,t.name))||!t.config)&&r.DrillthroughUtils.hasMeasureOrAsAggregationPodParameter(t.type,t.parameters))},t.acceptsCrossReportDrillthrough=function(e,t){return!(!e||!t)&&(!!(t=l(e,t.name))&&1===t.referenceScope)},t.determineReferenceScope=function(e){return e?1:0},t.determineAcceptsFilterContextKind=function(e){return e?0:1},t.determineType=function(e){return 0===e.type||void 0===e.type?1:1===e.type?2:0},t.isLinkedAsAggregation=function(e,t,r){return!(!e||!t)&&(!(!(t=l(e,t.name))||_.isEmpty(t.parameters))&&(-1!==(r=s(t,r.name))&&t.parameters[r].asAggregation))},t.isPodEnabled=function(e,t){return t&&1===t.scopeType&&r.FilterUtils.isCategoricalFilter(e.type)&&!e.isTransient},t.updateType=function(e,t,r){-1!==(t=p(e,t))&&(t=e.pods[t],_.isEmpty(t.parameters)&&(t.type=0),t.type=r)}})(powerbi=powerbi||{}),(function(v){var e;(function(e){var t=v.data.SQColumnRefExpr,r=v.data.SQEntityExpr,a=v.data.SQExpr,i=v.data.SQExprConverter,o=v.data.SQExprRewriter;function n(e,t){e=i.asFieldPattern(e);return e.columnHierarchyLevelVariation&&e.columnHierarchyLevelVariation.source.entity===t.entity&&e.columnHierarchyLevelVariation.source.schema===t.schema&&e.columnHierarchyLevelVariation.source.name===t.property&&e.columnHierarchyLevelVariation.variationName===t.name}e.createSchemaChangeRewriters=function(e){for(var r=[],t=0,i=e;t<i.length;t++)!(function(t){t.measureMove&&r.push(new u(v.data.createMoveMeasureRewriter(t.measureMove))),t.entityRename&&r.push(new u(v.data.createEntityRenameRewriter(t.entityRename))),t.propertyRename&&r.push(new u(v.data.createPropertyRenameRewriter(t.propertyRename))),t.hierarchyLevelRename&&r.push(new u(v.data.createHierarchyLevelRenameRewriter(t.hierarchyLevelRename))),t.removeVariation&&r.push(new d(new l(t.removeVariation),t.removeVariation)),t.newMeasureCreated&&_.find(e,(function(e){return e.itemDelete&&e.itemDelete.property===t.newMeasureCreated.name&&e.itemDelete.entity===t.newMeasureCreated.entity&&e.itemDelete.schema!==t.newMeasureCreated.schema}))&&r.push(new u(v.data.createSetSchemaMeasureRewriter(t.newMeasureCreated)))})(i[t]);return r};var s,l=(__extends(p,s=o),p.prototype.visitHierarchyLevel=function(e){return n(e,this.change)?new t(new r(this.change.schema,this.change.entity),this.change.property):e},p);function p(e){var t=this;return(t=s.call(this)||this).change=e,t}var u=(c.prototype.rewriteQuery=function(e){var t=this,r=(r=e.defn).rewrite(this.exprRewriter);e.defn=r,e.expansionStates=_.map(e.expansionStates,(function(e){return e.rewrite(t.exprRewriter)}));r=e.getQueryFieldParameters();if(!_.isEmpty(r))for(var i=0,a=r;i<a.length;i++){var o=a[i];o.expr=o.expr.accept(this.exprRewriter)}return e},c.prototype.rewriteFilter=function(e){return e.rewrite(this.exprRewriter)},c.prototype.rewriteExpr=function(e){return e.accept(this.exprRewriter)},c);function c(e){this.exprRewriter=e}e.VisualQueryExprRewriter=u;var d=(m.prototype.rewriteQuery=function(e){var t=this;this.removeDuplicateSQHierarchyLevelExpr(e);var r=(r=e.defn).rewrite(this.exprRewriter);return e.defn=r,e.expansionStates=_.map(e.expansionStates,(function(e){return e.rewrite(t.exprRewriter)})),e},m.prototype.rewriteFilter=function(e){return e.rewrite(this.exprRewriter)},m.prototype.rewriteExpr=function(e){return e.accept(this.exprRewriter)},m.prototype.removeDuplicateSQHierarchyLevelExpr=function(e){for(var t=e.defn.select(),r=0;r<t.length;){var i=t[r];if(r++,a.isHierarchyLevel(i.expr)&&n(i.expr,this.change))for(;r<t.length&&a.isHierarchyLevel(t[r].expr)&&a.equals(i.expr.arg,t[r].expr.arg);)e.removeExpr(t[r].expr,!1),r++}},m);function m(e,t){this.exprRewriter=e,this.change=t}})((e=v.explore||(v.explore={})).schemaRewriterUtils||(e.schemaRewriterUtils={}))})(powerbi=powerbi||{}),(function(e){function p(e,t){var r=[];if(!e||!e.visualContainers)return r;for(var i=0,a=e.visualContainers;i<a.length;i++){var o=a[i];t.addScriptVisualInfo(o,r)}return r}(e=(e=(e=e.explore||(e.explore={})).util||(e.util={})).ScriptVisualsUtil||(e.ScriptVisualsUtil={})).defaultScript="##############################",e.getScriptVisualIdsInSection=p,e.getVisualStatsInExploration=function(e,t){var r={totalVisualsCount:0,info:[]};if(!e||!e.sections)return r;for(var i=0,a=e.sections;i<a.length;i++){var o,n=a[i];n.visualContainers&&(o=p(n,t),r.info=r.info.concat(o),r.totalVisualsCount+=n.visualContainers.length)}return r},e.getScriptVisualIds=function(e,t,r,i,a){var o=[];switch(e){case 0:if(!i)return o;a.addScriptVisualInfo(i,o);break;case 1:o=p(r,a);break;case 2:if(!t)return o;for(var n=0,s=t.sections;n<s.length;n++)var l=p(s[n],a),o=o.concat(l);break;default:return o}return o},e.visualContainerHasScriptVisuals=function(e,t){for(var r=0,i=e;r<i.length;r++){var a=i[r];if(a&&a.config&&a.config.singleVisual){a=a.config.singleVisual.visualType;if(a&&t.isScriptVisual(a))return!0}}return!1},e.confirmRefreshForRDataSource=function(e,t,r,i,a,o){var n=e.control(),s=t.get("SettingsDataset_RDataSource_RefreshConfirmationDialog_OkButton"),l=t.get("SettingsDataset_RDataSource_RefreshConfirmationDialog_CancelButton"),e=[new InJs.ModalDialogAction(s,function(){n.hideDialog(),a()}),new InJs.ModalDialogAction(l,function(){n.hideDialog(),o()})],s=t.get("SettingsDataset_RDataSource_RefreshConfirmationDialog_Title"),l=t.get("SettingsDataset_RDataSource_RefreshConfirmationDialog_WarningMessage"),t="<div><span>"+t.get("SettingsDataset_RDataSource_RefreshConfirmationDialog_ActionMessagePart1")+' </span><a href= "https://go.microsoft.com/fwlink/?LinkId=821887" target= "_blank">'+t.get("SettingsDataset_RDataSource_RefreshConfirmationDialog_ActionMessageLink1")+"</a><span> "+t.get("SettingsDataset_RDataSource_RefreshConfirmationDialog_ActionMessagePart2")+"</span><br/><span>"+t.get("SettingsDataset_RDataSource_RefreshConfirmationDialog_ActionMessagePart3")+' </span><a href= "https://go.microsoft.com/fwlink/?LinkId=821886" target= "_blank">'+t.get("SettingsDataset_RDataSource_RefreshConfirmationDialog_ActionMessageLink2")+"</a></div>";i.message=l,t={dialogName:s,isDismissable:!1,scope:i,template:"<custom-modal-dialog></custom-modal-dialog>",dialogCssClass:"customModalDialog",dialogActions:e,notificationType:jsCommon.ModalDialogNotificationType.SecurityWarning,notificationText:l,htmlMessageText:t,focusOnFirstButton:!1,noActiveButtons:!0,flipContentAndNotificationOrder:!0},r.showLegacyWebModalDialog(t)},e.getScriptVisualType=function(e){switch(e){case"scriptVisual":return 0;case"pythonVisual":return 1;default:return null}},e.getScriptVisualTypeName=function(e){switch(e){case 0:return"scriptVisual";case 1:return"pythonVisual";default:return null}}})(powerbi=powerbi||{}),(function(e){(function(e){var t=(Object.defineProperty(r.prototype,"position",{get:function(){},set:function(e){},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"max",{get:function(){},enumerable:!1,configurable:!0}),r.prototype.scrollItemIntoView=function(e,t,r){var i=this.getContainer(),a=this.getRange(i),o=this.getItems(),n=o[e];n&&(i=0===e,o=e===o.length-1,n=this.getRange($(n),!0),i?t=0:o?t=r||0:null==t&&(t=this.getDefaultOverscroll()),a&&n&&(t=this.calculatePositionDelta(a,n,t),this.position=this.position+t))},r.prototype.getPageDownItemIndex=function(e){var t=this.getRange(this.getContainer());if(t){var r=this.getItems();if(0===r.length)return-1;for(var i=0,a=e;a<r.length-1;a++)if((i+=this.getRange(r.eq(a)).size)>t.size)return a;return r.length-1}return-1},r.prototype.getPageUpItemIndex=function(e){var t=this.getRange(this.getContainer());if(t){var r=this.getItems();if(0===r.length)return-1;for(var i=0,a=e;0<a;a--)if((i+=this.getRange(r.eq(a)).size)>t.size)return a;return 0}return-1},r.prototype.retainPosition=function(e){var t=this.position;try{e()}finally{this.position=t}},r.prototype.handleKeyDown=function(e,t,r){var i=!0,a=e,o=this.getItems().length-1;switch(t.keyCode){case $.ui.keyCode.PAGE_UP:var n=this.getPageUpItemIndex(e),a=Math.max(n,0);break;case $.ui.keyCode.PAGE_DOWN:n=this.getPageDownItemIndex(e);a=Math.min(n,o);break;case $.ui.keyCode.END:a=o;break;case $.ui.keyCode.HOME:a=0;break;default:i=void 0!==(a=this.getNewIndexOnKeyDown(e,o,t))}return void 0!==a&&a!==e&&(r(a),this.scrollItemIntoView(a)),i},r.prototype.onScroll=function(t){var r=this;this.getContainer().scroll((function(){var e=r.position/r.max;t(e)}))},r.prototype.getNewIndexOnKeyDown=function(e,t,r){},r.prototype.getRange=function(e,t){void 0===t&&(t=!1)},r.prototype.getDefaultOverscroll=function(){},r.prototype.getContainer=function(){return $(this.containerSelector)},r.prototype.getItems=function(){return this.retrieveItems()},r.prototype.retrieveItems=function(){return this.includeDescendants?this.getContainer().find(this.itemsSelector):this.getContainer().children(this.itemsSelector)},r.prototype.calculatePositionDelta=function(e,t,r){return t.min<e.min?-(e.min-t.min+r):t.max>e.max?t.max-e.max+r:0},r);function r(e,t,r){void 0===r&&(r=!0),this.containerSelector=e,this.itemsSelector=t,this.includeDescendants=r}e.BaseScrollHelper=t;var i,a=(__extends(o,i=t),Object.defineProperty(o.prototype,"position",{get:function(){return this.getContainer().scrollTop()},set:function(e){var t=this.getContainer();t.scrollTop()!==e&&t.scrollTop(e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"max",{get:function(){var e=this.getContainer()[0];return e?e.scrollHeight:void 0},enumerable:!1,configurable:!0}),o.prototype.getNewIndexOnKeyDown=function(e,t,r){switch(r.keyCode){case $.ui.keyCode.UP:return r.scrollHandled=!0,Math.min(Math.max(e-1,0),t);case $.ui.keyCode.DOWN:return Math.min(e+1,t)}},o.prototype.getRange=function(e,t){void 0===t&&(t=!1);var r=e.offset();if(r){e=t?e.outerHeight():e.innerHeight();return{min:r.top,max:r.top+e,size:e}}return null},o.prototype.getDefaultOverscroll=function(){return 0},o);function o(){return null!==i&&i.apply(this,arguments)||this}e.VerticalScrollHelper=a;var n,t=(__extends(s,n=t),Object.defineProperty(s.prototype,"position",{get:function(){return this.getContainer().scrollLeft()},set:function(e){var t=this.getContainer();t.scrollLeft()!==e&&t.scrollLeft(e)},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"max",{get:function(){var e=this.getContainer()[0];return e?e.scrollWidth:void 0},enumerable:!1,configurable:!0}),s.prototype.getNewIndexOnKeyDown=function(e,t,r){var i=0;switch(r.keyCode){case $.ui.keyCode.LEFT:i=-1;break;case $.ui.keyCode.RIGHT:i=1}if(0!==(i=this.isRtl?-i:i))return e=t<(e=(e+=i)<0?0:e)?t:e},s.prototype.getRange=function(e,t){void 0===t&&(t=!1);var r=e.offset();if(r){e=t?e.outerWidth():e.innerWidth();return{min:r.left,max:r.left+e,size:e}}return null},s.prototype.getDefaultOverscroll=function(){return 16},s.prototype.calculatePositionDelta=function(e,t,r){r=n.prototype.calculatePositionDelta.call(this,e,t,r);return this.isRtl?-r:r},s);function s(e,t,r,i){void 0===r&&(r=!1);i=n.call(this,e,t,i=void 0===i?!0:i)||this;return i.isRtl=r,i}e.HorizontalScrollHelper=t;l.prototype.dispose=function(){this.scrollPanel.removeEventListener("scroll",this.onScroll)},l.prototype.onScroll=function(){var e=this;this.syncOptions.syncDelay?(clearTimeout(this.timeoutId),this.timeoutId=setTimeout((function(){e.syncScrollPositions()}),this.syncOptions.syncDelay)):this.syncScrollPositions()},l.prototype.syncScrollPositions=function(){var e;!this.syncOptions.syncX||(e=this.scrollPanel.scrollLeft)!==this.lastScrollLeft&&(this.syncedPanel.scrollLeft=e,this.lastScrollLeft=e),!this.syncOptions.syncY||(e=this.scrollPanel.scrollTop)!==this.lastScrollTop&&(this.syncedPanel.scrollTop=e,this.lastScrollTop=e)},t=l;function l(e,t,r){var i=this;this.lastScrollLeft=0,this.lastScrollTop=0,this.scrollPanel=e,this.syncedPanel=t,this.syncOptions=r,this.onScroll=this.onScroll.bind(this),jsCommon.Zone.runOutsideAngular((function(){i.scrollPanel.addEventListener("scroll",i.onScroll)}))}e.ScrollSyncHelper=t})((e=e.explore||(e.explore={})).utils||(e.utils={}))})(powerbi=powerbi||{}),(function(e){!(function(e){var s,p;function t(e,t,r,i,a,o,n){void 0===i&&(i=!0),this._hasFocus=!1,this.selection=s.createTreeSelectionManager(e,a),this.scrollHelper=null!=n?n:new s.VerticalScrollHelper(t,r,!0),this.getVisibleNodes=e,this.allowMultiSelect=i,this.onFocusedItemChanged=null!=o?o:_.noop}s=e.utils||(e.utils={}),p=jsCommon.BrowserUtils,t.prototype.hasFocus=function(){return this._hasFocus},t.prototype.onNodeClick=function(e,t){var r=t.shiftKey,i=p.isCtrlOrMeta(t);r&&i?this.shiftSelect(e):r?(this.selection.clear(),this.shiftSelect(e)):i?this.selection.toggle(e):_.isEqual(this.selection.getSelectedItems(),[e])||(this.selection.clear(),this.selection.select(e)),r||(this.shiftSelectionStartNode=e),this.focus(e),t.preventDefault(),t.stopPropagation()},t.prototype.onBackgroundClick=function(e){this.selection.clear(),e.stopPropagation()},t.prototype.onFocus=function(){this.focus(this.getFocusedNode()||this.getVisibleNodes()[0]),this._hasFocus=!0},t.prototype.onBlur=function(){this.getVisibleNodes().map((function(e){return e.isFocused=!1})),this._hasFocus=!1,this.onFocusedItemChanged(void 0)},t.prototype.onKeyDown=function(e){var t,r,i,a=this,o=e.shiftKey,n=p.isCtrlOrMeta(e),s=!1,l=this.lastFocusedNode;n&&"KeyA"===e.code&&this.allowMultiSelect?(this.selection.selectAll(),s=!0):"Escape"===e.code?(this.selection.clear(),s=!0):"Space"===e.code&&l?(n&&o?this.shiftSelectionStartNode&&(t=this.getVisibleNodes(),t=this.getNodesInRange(t,this.shiftSelectionStartNode,l),this.selection.selectRange(t)):n?this.selection.toggle(l):this.selection.select(l),s=!0):"ArrowLeft"===e.code&&l?(l.isExpanded?this.setExpandValue(l,!1):l.parent&&(r=l.parent,this.selectAndScrollTo([r]),this.focus(r)),s=!0):"ArrowRight"===e.code&&l?(_.isEmpty(l.children)||(l.isExpanded?(r=l.children[0],this.selectAndScrollTo([r]),this.focus(r)):this.setExpandValue(l,!0)),s=!0):l&&(s=!0,0<=(l=(i=this.getVisibleNodes()).indexOf(l))&&(s=this.scrollHelper.handleKeyDown(l,e,(function(e){e=i[e];a.allowMultiSelect?o&&n?a.shiftSelect(e):o?(a.selection.clear(),a.shiftSelect(e)):n||(a.selection.clear(),a.selection.select(e)):(a.selection.clear(),a.selection.select(e)),o||(a.shiftSelectionStartNode=e),a.focus(e)})))),s&&(e.stopPropagation(),e.preventDefault())},t.prototype.toggleExpandCollapse=function(e,t){this.setExpandValue(e,!e.isExpanded),t&&t.stopPropagation()},t.prototype.selectAndScrollTo=function(t){var r=this;this.selection.clear(),this.selection.selectRange(t),requestAnimationFrame((function(){var e=r.getVisibleNodes().indexOf(t[0]);r.scrollHelper.scrollItemIntoView(e,30)}))},t.prototype.syncManagedNodes=function(e){var t=this;this.hasNode(e,this.shiftSelectionStartNode)||(this.shiftSelectionStartNode=void 0),this.hasNode(e,this.lastFocusedNode)||(this.lastFocusedNode=void 0),this.selection.clear();var r=[];_.forEach(e,(function(e){t.collectSelectedNodes(e,r)})),_.forEach(r,(function(e){e.isSelected=!1})),this.selection.selectRange(r)},t.prototype.shiftSelect=function(e){var t=this.getVisibleNodes(),r=null!==(r=this.shiftSelectionStartNode)&&void 0!==r?r:_.first(t);this.selection.selectRange(this.getNodesInRange(t,r,e))},t.prototype.collectSelectedNodes=function(e,t){var r=this;e&&(e.isSelected&&t.push(e),_.forEach(e.children,(function(e){r.collectSelectedNodes(e,t)})))},t.prototype.hasNode=function(e,t){for(var r=0,i=null!=e?e:[];r<i.length;r++){var a=i[r];if(a===t)return!0;if(this.hasNode(a.children,t))return!0}return!1},t.prototype.getNodesInRange=function(e,t,r){var i=e.indexOf(t),t=e.indexOf(r),r=Math.min(i,t),a=Math.max(i,t);if(-1<r)for(var o=[],n=r;n<=a;n++)o.push(e[n]);return o},t.prototype.focus=function(e){e&&(this.getVisibleNodes().map((function(e){return e.isFocused=!1})),e.isFocused=!0,this.lastFocusedNode=e,this.onFocusedItemChanged(e))},t.prototype.getFocusedNode=function(){var e=this.getVisibleNodes(),t=_.find(e,(function(e){return e.isSelected}));return null!=t?t:_.find(e,(function(e){return e.isFocused}))},t.prototype.setExpandValue=function(e,t){e.isExpanded!==t&&(e.isExpanded=t,e.isExpanded||(null===(t=this.shiftSelectionStartNode)||void 0===t?void 0:t.parent)!==e||(this.shiftSelectionStartNode=e))},s.TreeHelper=t})(e.explore||(e.explore={}))})(powerbi=powerbi||{}),(function(e){var t;t=e.explore||(e.explore={}),(function(){(t.utils||(t.utils={})).createTreeSelectionManager=function(e,t){return new r(e,t)};var r=(Object.defineProperty(e.prototype,"lastSelected",{get:function(){return _.last(this.selectedItems)},enumerable:!1,configurable:!0}),e.prototype.getSelectedItems=function(){return __spreadArray([],this.selectedItems||[])},e.prototype.select=function(e){this.selectInternal(e)&&this.onSelectionChanged(this.selectedItems)},e.prototype.selectRange=function(e){for(var t=!1,r=0,i=e;r<i.length;r++)var a=i[r],t=this.selectInternal(a)||t;t&&this.onSelectionChanged(this.selectedItems)},e.prototype.selectAll=function(){this.selectRange(this.getItems())},e.prototype.toggle=function(e){e.isSelected?(e.isSelected=!1,this.selectedItems.splice(this.selectedItems.indexOf(e),1)):(e.isSelected=!0,this.selectedItems.push(e)),this.onSelectionChanged(this.selectedItems)},e.prototype.clear=function(){for(var e=!_.isEmpty(this.selectedItems),t=0,r=this.selectedItems;t<r.length;t++)r[t].isSelected=!1;this.selectedItems.splice(0),e&&this.onSelectionChanged([])},e.prototype.selectInternal=function(e){return!e.isSelected&&(e.isSelected=!0,this.selectedItems.push(e),!0)},e);function e(e,t){this.selectedItems=[],this.getItems=e,this.onSelectionChanged=null!=t?t:_.noop}})()})(powerbi=powerbi||{}),(function(N){var e,n,r,V,s,l,p,u,P;function c(e,t){t=m(e.expr,t);return t!==e.expr?r(t):e}function w(e,t){if(e instanceof P)for(var r=e,i=0,a=t;i<a.length;i++)if((r=a[i].rewriteExpr(r))!==e)return 1}function T(e,t){for(var r=0,i=e.textRuns;r<i.length;r++)if(w(i[r].value,t))return 1}function i(e,t){var r=e.expression,i=e.filter,a=e.cachedValueItems;r&&(e.expression=m(r,t)),i&&(e.filter=d(i,t)),a&&o(a,t)}function o(e,t){for(var r=0,i=e;r<i.length;r++){var a=i[r],o=c(a.identity,t);o!==a.identity&&(a.identity=o)}}function d(e,t){return _.reduce(t,(function(e,t){return t.rewriteFilter(e)}),e)}function m(e,t){return _.reduce(t,(function(e,t){return t.rewriteExpr(e)}),e)}e=(e=N.explore||(N.explore={})).util||(e.util={}),n=jsCommon.ArrayExtensions,r=N.data.createDataViewScopeIdentity,V=N.data.DataViewObjectDefinitions,s=N.data.DataViewObjectDescriptors,l=N.data.DataViewScopeTotal,p=N.data.DataViewScopeWildcard,u=N.data.Selector,P=N.data.SQExpr,e.rewriteDataRepetitionSelectors=function(e,o){return _.isEmpty(e)?e:n.rewriteArray(e,(function(e){return u.isScopeIdentity(e)?c(e,o):u.isScopeWildcard(e)?(r=e,i=o,(a=n.rewriteArray(r.exprs,(function(e){return m(e,i)})))!==r.exprs?p.fromExprs(a):r):!u.isRoleWildcard(e)&&!u.isWildcard(e)&&u.isScopeTotal(e)?(a=e,t=o,(r=n.rewriteArray(a.exprs,(function(e){return m(e,t)})))!==a.exprs?l.fromExprs(r):a):e;var t,r,i,a}))},e.rewriteVisualLink=function(e,t){},e.rewriteFilterContainer=function(e,t){i(e,t)},e.rewriteFilterContainerState=function(e,t){i(e,t)},e.rewriteFilterOutput=function(e,t,r){if(t=s.findFilterOutput(t)){e=N.data.DataViewObjectDefinitions.getPropertyContainer(e,t,null);if(e){t=t.propertyName;if(o=e[t]){for(var i=0,a=r;i<a.length;i++)var o=a[i].rewriteFilter(o);e[t]=o}}}},e.rewriteDataBoundPropertyDefinitions=function(e,t,C){function x(e){var t=b(e.value);return{textStyle:e.textStyle,url:e.url,value:t,mentionEmail:e.mentionEmail}}function b(e){var t=e;return t=e instanceof P?E(e,C):t}function S(e){return{textRuns:_.map(e.textRuns,x)}}function E(e,t){for(var r=0,i=t;r<i.length;r++)e=i[r].rewriteExpr(e);return e}e&&t&&(_.isEmpty(C)||V.visitPropertyDefinitions(e,t,(function(e,t,r,i,a){var o,n=a&&a.properties[t];if((p=e[t])instanceof P)for(var s=0,l=C;s<l.length;s++)var p=(d=l[s]).rewriteExpr(p);else if(V.isObjectPropertySQExprWithContext(p))for(var u=0,c=C;u<c.length;u++){var d=c[u];if(!_.isEmpty(null===(o=p.context)||void 0===o?void 0:o.filterContext))for(var m=0,v=p.context.filterContext;m<v.length;m++){var f=v[m];f.filter=d.rewriteFilter(f.filter)}p.value=d.rewriteExpr(p.value)}else{var g=n.type;if(g.fill&&g.fill.solid&&g.fill.solid.color){if(!N.StructuralObjectDefinition.isFillDefinition(p))return;a=p.solid.color;if(!a)return;n=a;(a=E(a,C))!==n&&(p={solid:{color:a}})}else if(g.paragraphs){if(!N.StructuralObjectDefinition.isParagraphsDefinition(p))return;if(!(function(e,t){for(var r=0,i=e;r<i.length;r++)for(var a=i[r].textRuns,o=0,n=a;o<n.length;o++){var s=n[o];if(N.ParagraphsDefinition.isTextRunDefinition(s)){if(w(s.value,t))return!0}else if(N.ParagraphsDefinition.isTextRunConditionalDefinition(s)){for(var l=0,p=s.cases;l<p.length;l++)if(function(e,t){if(T(e,t))return!0;if(w(e.pattern,t))return!0}(p[l],t))return!0;if(T(s.defaultCase,t))return!0;if(w(s.expression,t))return!0}}return!1})(p,C))return;p=_.map(p,(function(e){return{horizontalTextAlignment:e.horizontalTextAlignment,textRuns:_.map(e.textRuns,(function(e){return N.ParagraphsDefinition.isTextRunDefinition(e)?x(e):N.ParagraphsDefinition.isTextRunConditionalDefinition(e)?{cases:_.map(e.cases,(function(e){var t=e.pattern;t instanceof P&&(t=E(t,C));return __assign({pattern:t},S(e))})),defaultCase:S(e.defaultCase),expression:b(e.expression)}:void 0}))}}))}else if(g.icon){if(!N.StructuralObjectDefinition.isIconDefinition(p))return;var h={kind:"Icon",value:p.value&&E(p.value,C),layout:p.layout&&E(p.layout,C),verticalAlignment:p.verticalAlignment&&E(p.verticalAlignment,C)};p.value===h.value&&p.layout===h.layout&&p.layout===h.layout||(p=h)}else if(g.errorRange){if(!N.StructuralObjectDefinition.isErrorRangeDefinition(p))return;var y,h={kind:"ErrorRange"};p.explicit?(y=p.explicit,g=h.explicit={isRelative:E(y.isRelative,C)},y.lowerBound&&(g.lowerBound=E(y.lowerBound,C)),y.upperBound&&(g.upperBound=E(y.upperBound,C))):p.symmetricalExplicit?h.symmetricalExplicit={delta:E(p.symmetricalExplicit.delta,C)}:p.standardDeviation?(y=p.standardDeviation,h.standardDeviation={value:E(y.value,C),multiplier:E(y.multiplier,C)}):p.percentage?(y=p.percentage,h.percentage={lowerBoundDelta:E(y.lowerBoundDelta,C),upperBoundDelta:E(y.upperBoundDelta,C)}):p.percentile&&(y=p.percentile,h.percentile={lowerBound:E(y.lowerBound,C),upperBound:E(y.upperBound,C)}),p=h}}e[t]=p})))},e.rewriteDisplayNameIdentityPairs=o,e.rewriteSemanticFilter=d,e.rewriteExpr=m,e.rewriteLinkField=function(e,t){var r=e.fieldExpr;e.fieldExpr=m(r,t)},e.rewritePod=function(e,t){if(!_.isEmpty(e.parameters))for(var r=0,i=e.parameters;r<i.length;r++){var a=i[r];a.fieldExpr&&(a.fieldExpr=m(a.fieldExpr,t))}},e.rewriteFilterExpressionMetadata=function(e,t){e.expressions=n.rewriteArray(e.expressions,(function(e){return m(e,t)})),e.cachedValueItems&&(function(e,t){for(var r=0,i=e;r<i.length;r++){var a=i[r];a.identities=n.rewriteArray(a.identities,(function(e){return c(e,t)}))}})(e.cachedValueItems,t)}})(powerbi=powerbi||{}),(function(e){var t,o,n;function r(e){var t=e===n.InnerPosition,r=t?15:10,i=t?0:3,a=o.DefaultTransparency,e={};return e[n.BottomRightPreset]={angle:t?225:45,shadowDistance:10,shadowBlur:r,shadowSpread:i,transparency:a},e[n.BottomPreset]={angle:t?270:90,shadowDistance:10,shadowBlur:r,shadowSpread:i,transparency:a},e[n.BottomLeftPreset]={angle:t?315:135,shadowDistance:10,shadowBlur:r,shadowSpread:i,transparency:a},e[n.CenterRightPreset]={angle:t?180:0,shadowDistance:10,shadowBlur:r,shadowSpread:i,transparency:a},e[n.CenterPreset]={angle:0,shadowDistance:0,shadowBlur:t?20:15,shadowSpread:i,transparency:a},e[n.CenterLeftPreset]={angle:t?0:180,shadowDistance:10,shadowBlur:r,shadowSpread:i,transparency:a},e[n.TopRightPreset]={angle:t?135:315,shadowDistance:10,shadowBlur:r,shadowSpread:i,transparency:a},e[n.TopPreset]={angle:t?90:270,shadowDistance:10,shadowBlur:r,shadowSpread:i,transparency:a},e[n.TopLeftPreset]={angle:t?45:225,shadowDistance:10,shadowBlur:r,shadowSpread:i,transparency:a},e}function a(e,t){t=r(t||o.DefaultPosition);return t.hasOwnProperty(e)?t[e]:null}t=e.explore||(e.explore={}),e=t.util||(t.util={}),n=t.contracts.VisualDropShadow,(o=e.VisualDropShadowUtil||(e.VisualDropShadowUtil={})).DefaultShow=!1,o.DefaultPreset=n.BottomRightPreset,o.DefaultPosition=n.OuterPosition,o.DefaultTransparency=70,o.DefaultShadowSpread=3,o.DefaultShadowBlur=10,o.DefaultAngle=45,o.DefaultShadowDistance=10,o.DefaultColor="#000",o.getDefaultValues=function(e,t){var r=e&&e.preset?e.preset:o.DefaultPreset,i=e&&e.position?e.position:o.DefaultPosition,e=a(r,i),t=t?t.colorPalette.foreground.value:o.DefaultColor;return{show:o.DefaultShow,preset:r,position:i,color:{solid:{color:t}},shadowSpread:e?e.shadowSpread:o.DefaultShadowSpread,shadowBlur:e?e.shadowBlur:o.DefaultShadowBlur,angle:e?e.angle:o.DefaultAngle,shadowDistance:e?e.shadowDistance:o.DefaultShadowDistance,transparency:e?e.transparency:o.DefaultTransparency}},o.presetSettings=r,o.getPresetSettings=a})(powerbi=powerbi||{}),(function(w){var p,e,u,T,l,c,d,m,t,r,i,a,F,j,n,o;function v(e){return e&&e.config&&e.config.singleVisual?e.config.singleVisual.query:null}function s(e){return e&&e.config&&e.config.singleVisual}function f(e){e=e.config;if(e){e=e.singleVisual;if(e&&e.query)return e.query.defn.select()}}function g(e,t){if(e&&t){e=t.getPlugin(e);if(e)return e.capabilities}}function h(e,t){return g(u.getVisualType(e),t)}function y(e,t){if(e.role)t.push(e.role);else{var r=e;if(r.bind)r.bind.to&&t.push(r.bind.to);else if(e.for)e.for.in&&t.push(e.for.in);else{r=e;if(r.group){if(r.group.by&&t.push(r.group.by),r.group.select)for(var i=0,a=r.group.select;i<a.length;i++)y(a[i],t)}else{r=e;if(r.composite)for(var o=0,n=r.composite;o<n.length;o++)y(n[o],t);else if(e.select)for(var s=0,l=e.select;s<l.length;s++)y(l[s],t)}}}}function R(e){var t=[];return e&&(e.categorical&&(e.categorical.categories&&y(e.categorical.categories,t),e.categorical.values&&y(e.categorical.values,t)),e.table&&e.table.rows&&y(e.table.rows,t),e.single&&y(e.single,t),e.tree&&(e.tree.nodes&&y(e.tree.nodes,t),e.tree.values&&y(e.tree.values,t)),e.matrix&&(e.matrix.columns&&y(e.matrix.columns,t),e.matrix.rows&&y(e.matrix.rows,t),e.matrix.values&&y(e.matrix.values,t))),t=_.uniq(t)}function D(e){switch(e.extendedType){case 66048:return 67;case 131584:return 35}switch(e.primitiveType){case 1:return 2048;case 2:case 3:return 1;case 4:return 3;case 5:return 4096;case 6:return 20;case 7:return 4;case 9:return 8}}function A(e){return w.data.conceptualDataCategoryFromString(e.categoryString)}function C(e){return r.generateUniqueId(e)}function x(e){return e&&null!=e.size?a.fromPoint(e.size.pt):a.toString(u.DefaultTitleFontSizeInPixel)}function b(e){if(e&&e.defn){e=e.defn.groupBy();return!_.isEmpty(e)}return!1}function I(e){for(var t={},r=0,i=e.defn.select();r<i.length;r++){var a=i[r],o=void 0,o=j.isMeasure(a.expr)?w.VisualDataRoleKind.Measure:w.VisualDataRoleKind.Grouping;t[a.name]=o}return t}function S(e){for(var t=0,r=e.visualContainers;t<r.length;t++){var i=r[t];delete i.cachedData,i.disableCacheOnServerForInitialLoad=!0}}function E(e){e=s(e);return e&&e.columnProperties}p=w.explore||(w.explore={}),e=p.util||(p.util={}),l=jsCommon.CssConstants,c=w.data.DataViewObjectDefinitions,d=w.data.services.DataViewObjectSerializer,m=w.data.DataViewTransform,t=w.visuals.Units.FontSize,r=w.common.utils.IdUtility,i=w.data.InteractiveQueryCachingSettings,a=jsCommon.PixelConverter,F=w.data.SQExpr,j=w.data.SQExprUtils,n=p.contracts.VisualContainer,o=p.contracts.VisualTitleHeading,u=e.VisualContainerUtils||(e.VisualContainerUtils={}),T=jsCommon.ArrayExtensions,u.DefaultTitleFontSizeInPixel=12,u.DefaultTitleFontFamily="'Segoe UI', wf_segoe-ui_normal, helvetica, arial, sans-serif",u.DefaultTitleFontColor="#C8C8C8",u.DefaultTitleTextClass="largeTitle",u.DefaultTitleThemeColor="foreground",u.DefaultTitleFontSizeInPoints=jsCommon.PixelConverter.toPoint(u.DefaultTitleFontSizeInPixel),u.DefaultTitleFontProperties={size:t.createFromPt(u.DefaultTitleFontSizeInPoints),family:u.DefaultTitleFontFamily,color:u.DefaultTitleFontColor},u.DefaultTitleHeading=o.DefaultHeadingAttribute,u.getVisualType=function(e){if(e)return p.contracts.isVisualContainerGroup(e)?p.constants.GroupComponentType:e.config&&e.config.singleVisual?e.config.singleVisual.visualType:void 0},u.getVisualQuery=v,u.getSingleVisualConfig=s,u.isVisualTypeAutoSelect=function(e){return null===(e=null===(e=null==e?void 0:e.config)||void 0===e?void 0:e.singleVisual)||void 0===e?void 0:e.autoSelectVisualType},u.getSelectExprs=f,u.getFilterCapabilities=function(e,t){return g(e&&e.config&&e.config.singleVisual?e.config.singleVisual.visualType:null,t)},u.getVisualCapabilities=h,u.getDataRolesForVisual=function(e,t){if((t=h(e,t))&&!_.isEmpty(t.dataRoles))return t.dataRoles},u.getVisualQueryCachingSettings=function(e,t,r){if(e)return r||"UserAction_ChangeModel"===t||"UserAction_Refresh"===t?i.BypassCache:i.Default},u.setQueryKeepProjectionOrder=function(e){e.config&&e.config.singleVisual&&((e=e.config.singleVisual)&&e.query&&e.query.hasShowAll()&&(e.queryOptions=e.queryOptions||{},e.queryOptions.keepProjectionOrder=!0))},u.getDataRolesForVisualPlugin=function(e){if(e){e=e.capabilities;if(e&&!_.isEmpty(e.dataRoles))return e.dataRoles}},u.getNumberRangesForRoles=function(e,t,r){if(t=h(e,t)){e=v(e);if(e)return w.visualCapabilitiesHelperModuleFactory().create(t,r).getNumberRangesForRoles(e)}},u.isScriptVisual=function(e,t){return e=u.getVisualType(e),t&&t.isScriptVisual(e)},u.isSmallMultiplesVisual=function(e){if(0<=[w.visuals.plugins.lineChart.name,w.visuals.plugins.areaChart.name,w.visuals.plugins.stackedAreaChart.name,w.visuals.plugins.barChart.name,w.visuals.plugins.clusteredBarChart.name,w.visuals.plugins.hundredPercentStackedBarChart.name,w.visuals.plugins.columnChart.name,w.visuals.plugins.clusteredColumnChart.name,w.visuals.plugins.hundredPercentStackedColumnChart.name,w.visuals.plugins.lineClusteredColumnComboChart.name,w.visuals.plugins.lineStackedColumnComboChart.name].indexOf(e.visualType)){e=null===(e=e.query)||void 0===e?void 0:e.projections;if(e&&e[w.visuals.cartesianRoleNames.rows]&&0<e[w.visuals.cartesianRoleNames.rows].all().length)return!0}return!1},u.getObjectDefinitions=function(e){return null===(e=null===(e=e.config)||void 0===e?void 0:e.singleVisual)||void 0===e?void 0:e.objects},u.getContainerObjectDefinitions=function(e){return e.config&&e.config.singleVisual&&e.config.singleVisual.vcObjects},u.getQueryName=function(e,t,r){return(r=e.config.singleVisual.query.projections[t].all()[r]).queryRef},u.describeForPinning=function(e,t,r,i,a,o,n){if(r){var s=r.defn.select(),l=r.projections,p=[],u=[],c=I(r),d=w.DataViewAnalysis.chooseDataViewMappings(r.projections,a.dataViewMappings,c,o).supportedMappings;if(d){for(var m=0,v=d;m<v.length;m++){var f,g=v[m],h=1<d.length?R(g):null,y=[];for(f in l)if(null==h||_.includes(h,f))for(var C=l[f],x=0,b=C.all();x<b.length;x++){var S,E,N=b[x],V=T.indexWithName(s,N.queryRef),P=s[V];F.isTransformOutputRoleRef(P.expr)||(E=P.expr.getMetadata(t,j.buildExprEvaluationContext(r.defn.from())),S={Restatement:e.getDisplayName(P.expr,t,a,P.name,i),Name:N.queryRef,Type:D(E.type)},(P=j.getKpiMetadata(P.expr,t))&&(S.kpi=P),(P=N.format||E.format)&&(S.Format=P),(E=A(E.type))&&(S.DataCategory=E),p[V]=S,y.push({Name:f,Projection:V,isActive:_.includes(C.activeProjectionRefs,N.queryRef)}))}u.push({DataRoles:y})}return{queryMetadata:{Select:p,Filters:n},visualElements:u}}}},u.getRolesForDataViewMapping=R,u.toSemanticType=D,u.toConceptualDataCategory=A,u.hasGrouping=function(e,t){if(e&&e.config&&e.config.singleVisual&&e.config.singleVisual.query&&e.config.singleVisual.query.defn){var r=e.config.singleVisual.query.projections,i=e.config.singleVisual.query.defn.select();if(r&&0<i.length)for(var a in r)for(var o=0,n=r[a].all();o<n.length;o++){var s=n[o],s=jsCommon.ArrayExtensions.findItemWithName(i,s.queryRef);if(s){s=s.expr.getMetadata(t);if(s&&0===s.kind&&null==s.aggregate)return!0}}return!1}},u.contractEqualityComparator=function(t){return function(e){return t===e}},u.contractUnEqualityComparator=function(t){return function(e){return t!==e}},u.filterAffects=function(t,r,i,a){return function(e){return t===e||3!==(i&&i.relationshipFilterAction(r,t,e,a))}},u.clearDataSelection=function(e,t){e.publishToChannel(w.explore.services.events.dataSelectionChanged,{affectContainer:function(e){return e===t}})},u.createCacheEntry=function(e,t,r,i,a,o,n,s,l){if(o){var p,e=e.capabilities(o.visualType);return!e||(s=u.describeForPinning(t,a,o.query,o.columnProperties,e,n,s))&&(n=d.serializeObjects(o.objects,e.objects,n.serializeSpaceOptimization),(p=i.transforms&&e&&e.objects?w.data.services.DataViewTransformActionsSerializer.serializeDataViewTransformActions(i.transforms,e.objects):{objects:n}).objects=p.objects||n,p.visualElements=s.visualElements,p.queryMetadata=s.queryMetadata),{queryObject:i.options.query.command,dataObject:r,transformsObject:p,dataUpdatedTime:l}}},u.uniqueName=function(e){var t={};return p.contracts.traverseVisualContainerGroups(e,(function(e){e.name,t[e.name]=!0})),C(t)},u.nextUniqueName=C,u.getVisualContainerGroups=function(e){var t=[];return p.contracts.traverseVisualContainerGroups(e,(function(e){p.contracts.isVisualContainerGroup(e)&&t.push(e)})),t},u.isInHiddenGroup=function(e){for(var t=e.parentGroup;t;){if(p.contracts.VisualContainerGroup.isHidden(t))return!0;t=t.parentGroup}return!1},u.isVisualHiddenOrInHiddenGroup=function(e){return n.isHidden(e.config.singleVisual)||u.isInHiddenGroup(e)},u.getAbsoluteVisualContainerPosition=function(e,t,r){void 0===t&&(t=0);var i=_.cloneDeep(e),a=r;if(1===t)return i;for(;a;){if(!a.layouts.withId(t))return i;var o=a.layouts.withId(t).position;i.x+=o.x,i.y+=o.y,a=a.parentGroup}return i},u.getGroupRelativeVisualContainerPosition=function(e,t,r){void 0===r&&(r=0);for(var i=_.cloneDeep(e),a=t.parentGroup;a;){var o=a.layouts.withId(r).position;i.x-=o.x,i.y-=o.y,a=a.parentGroup}return i},u.notifyVisualContainersExceptSource=function(e,t,r,i,a){e.publishToChannel(w.explore.services.events.visualContainerChanged,{affectContainer:function(e){return e!==t},sourceLabelKey:r,parentActivity:i,parentContextActivity:a})},u.notifyVisualContainers=function(e,t,r,i,a){_.isEmpty(t)||e.publishToChannel(w.explore.services.events.visualContainerChanged,{affectContainer:function(e){return _.includes(t,e)},sourceLabelKey:r,parentActivity:i,parentContextActivity:a})},u.createCrossHighlightActivity=function(e,t){return e.createActivity({name:"Cross Highlight",operationType:t})},u.createChangeSlicerActivity=function(e){return e.createActivity({name:"Change Slicer"})},u.hasOnPremDataSource=function(e){return _.some(e,(function(e){return e.dsr&&e.dsr.vsName===w.common.constants.onPremiseVSName}))},u.getTitleFontSize=x,u.getTitleHeight=function(e){var t=x(e),t={fontFamily:e&&e.family||u.DefaultTitleFontFamily,fontSize:t};return w.TextMeasurementService.estimateSvgTextHeight(t)},u.evaluateObjectDefinitions=function(e,t,r,i,a,o,n){var s=r.config.singleVisual.visualType,l=r.config.singleVisual.vcObjects,r=c.getValue(l,{objectName:"stylePreset",propertyName:"name"},void 0);return(r=t.getVisualObjects(e,s,r&&F.isConstant(r)&&r.value,p.contracts.VisualContainer.CommonObjectDescriptors))&&(l=c.clone(l||{}),c.extend(l,r,!0)),e=t.getVisualStyle(e),o=m.evaluateMetadataOnceDataViewObjectDefinitions(l,p.contracts.VisualContainer.CommonObjectDescriptors,e,i,a,o,n),(n=c.getObjectDefinition(l,"visualLink",void 0))&&n.properties&&n.properties.qna&&(((l=o.dataViewObjects=o.dataViewObjects||{}).visualLink=l.visualLink||{}).qna=n.properties.qna),o},u.setHoverClass=function(e,t){t.toggleClass("showHover",e)},u.notifyContainerHoverEvent=function(e,t,r){e=e?w.common.events.canvasItemContainerShowHover:w.common.events.canvasItemContainerHideHover,r.publishToChannel(e,{containerName:t})},u.getVisualStyleAttributes=function(e,t,r,i,a,o,n){var s={};return s[l.transformProperty]=null!=t?"scale("+t+")":"",s[l.widthProperty]=e.width,s[l.heightProperty]=e.height,s[l.borderProperty]=i||"",s[l.paddingProperty]=o||"",s[l.borderRadiusProperty]=a||"",s[l.backgroundColorProperty]=r||"",s[l.boxShadowProperty]=n||"",s},u.getVisualBackgroundColor=function(e){if(e&&e.show){var t=w.visuals.visualBackgroundHelper.getDefaultValues();return!e.transparency&&0!==e.transparency||(t.transparency=e.transparency),e.color&&e.color.solid.color&&(t.color=e.color),w.common.utils.ColorUtility.applyTransparency(t.color.solid.color,(100-t.transparency)/100)}},u.getVisualBorder=function(e,t){return{show:(e||t).show,color:(e&&e.color&&e.color.solid&&e.color.solid.color?e:t).color,radius:e&&e.radius||t.radius}},u.getVisualDropShadow=function(e,t){return{show:(e||t).show,preset:(e&&e.preset?e:t).preset,position:(e&&e.position?e:t).position,color:(e&&e.color&&e.color.solid&&e.color.solid.color?e:t).color,transparency:(e&&void 0!==e.transparency?e:t).transparency,shadowBlur:(e&&void 0!==e.shadowBlur?e:t).shadowBlur,shadowSpread:(e&&void 0!==e.shadowSpread?e:t).shadowSpread,angle:(e&&void 0!==e.angle?e:t).angle,shadowDistance:(e&&void 0!==e.shadowDistance?e:t).shadowDistance}},u.isSegment=function(e){return null!=e&&null!=e.metadata&&null!=e.metadata.segment},u.hasGroupByItems=b,u.hasGroupByItemsInQuery=function(e){return b(u.getVisualQuery(e))},u.containSearchableField=function(e,t,r){if(t=u.getDataRolesForVisual(e,t),(e=v(e))&&!_.isEmpty(t)){t=t[0].name,t=e.tryGetExprs(t);return!_.isEmpty(t)&&!_.some(t,(function(e){e=e.getMetadata(r);if(e)return!e.type.text}))}},u.hasFilterMappingWithNonAggregatableColumns=function(e,t,r){if(r=(function(e,t){var r=v(e);if(r){var i=h(e,t);if(i&&i.filterMappings&&i.filterMappings.measureFilter&&i.filterMappings.measureFilter.targetRoles){for(var t=i.filterMappings.measureFilter.targetRoles,t=_.chain(i.dataRoles).filter((function(e){return e.kind===w.VisualDataRoleKind.Grouping})).map((function(e){return e.name})).difference(t).value(),a=[],o=0,n=t;o<n.length;o++){var s=n[o];r.projections[s]&&a.push.apply(a,r.projections[s].all())}e=f(e);if(!_.isEmpty(a))return _.chain(e).filter((function(t){return _.some(a,(function(e){return e.queryRef===t.name}))})).map((function(e){return e.expr})).value()}}})(e,r),_.isEmpty(r))return!1;for(var i=0,a=r;i<a.length;i++){var o=a[i];if(1===j.getAggregateBehavior(o,t))return!0}return!1},u.createRoleKindByQueryRef=I,u.clearExplorationQueryCaches=function(e){for(var t=0,r=e.sections;t<r.length;t++)S(r[t])},u.clearSectionQueryCaches=S,u.markInitialLoadQueriesDirty=function(e){for(var t=0,r=e.sections;t<r.length;t++)for(var i=0,a=r[t].visualContainers;i<a.length;i++)a[i].disableCacheOnServerForInitialLoad=!0},u.getVisualTypesAndCountsFromSection=function(a){function o(e,t){t=t.config.singleVisual.visualType;e[t]||(e[t]=0),e[t]++}function t(){for(var e=a&&a.visualContainers||[],t={},r=0,i=e=_.reject(e,(function(e){return n.isHidden(e.config.singleVisual)}));r<i.length;r++)o(t,i[r]);return t}try{return (function(){var e=a&&a.visualContainerGroups;if(_.isEmpty(e))return t();var r={},i={__hidden:r};return p.contracts.traverseVisualContainerGroups(a.visualContainerGroups,(function(e,t){p.contracts.isVisualContainer(e)&&o(t?r:i,e)})),i})()}catch(e){return jsCommon.Trace.error("Error getting visuals from groups "+(e&&e.message)+": "+(e&&e.stack)),t()}},u.getAutoVisualFilterContainers=function(e,t,r,i,a){if(void 0===a&&(a=!1),p.FilterUtils.supportsVisualFilters(e,t)){t=p.FilterUtils.supportsMeasureFilters(e,t),e=u.getSelectExprs(e);if(e=!t?_.filter(e,(function(e){return!j.isMeasure(e.expr)})):e)return _.chain(e).map((function(e){return e.expr})).filter((function(e){return j.isExprValidForFiltering(e)&&_.isEmpty(e.validate(r,i))})).map((function(e){return{name:void 0,expression:e,expanded:!1,howCreated:0,type:p.FilterUtils.getDefaultFilterType(e,r,0),isHiddenInViewMode:a}})).value()}},u.getAutoCrossDrillVisualFilterContainers=function(e,t,r,i){return i=r.getDrillCrossFiltersToApply(e,t,i),_.map(i,(function(e){return{name:void 0,type:e.type,filter:e.filter,expression:e.expression,expanded:!1,howCreated:6,precedence:e.precedence}}))},u.getVisualContainerCount=function(e,t){for(var r=0,i=0,a=e.sections;i<a.length;i++)for(var o=0,n=a[i].visualContainers;o<n.length;o++)n[o].config.singleVisual.visualType===t.name&&++r;return r},u.containsCustomVisuals=function(e){var t=e.resourcePackages;if(!t)return!1;for(var r=0,i=e.sections;r<i.length;r++){var a=i[r];if(a.visualContainers)for(var o=a.visualContainers,n=0,s=t;n<s.length;n++)for(var l=s[n],p=0,u=o;p<u.length;p++){var c=u[p];if(c.config&&c.config.singleVisual&&c.config.singleVisual.visualType){c=c.config.singleVisual.visualType;if(l.name===c)return!0}}}return!1},u.getImprovedFilterExperienceTelemetry=function(e,t){var r={usingImprovedFilterExperience:!0,viewMode:0===t},t=(function(e){if((e=e.objects)&&e.outspacePane){e=c.getValue(e,{objectName:"outspacePane",propertyName:"expanded"},null);return e&&e.value}})(e);return _.isUndefined(t)||(r.isOutspacePaneExpanded=t),e=(function(e){if((e=e.objects)&&e.outspacePane){e=c.getValue(e,{objectName:"outspacePane",propertyName:"visible"},null);return e&&e.value}})(e),_.isUndefined(e)||(r.isOutspacePaneVisible=e),r},u.shouldUseQueryCache=function(e,t){return e.id&&!t},u.getExecutionMetricsKind=function(e){return e?3:1},u.wrapContextActivity=function(e,t,r){var i;return t&&(i=t.createChildActivity(e)),r=r(),i&&i.resolve(),r},u.wrapContextActivityAsync=function(i,a,o){return __awaiter(this,void 0,w.Promise,(function(){var t,r;return __generator(this,(function(e){switch(e.label){case 0:return a&&(t=a.createChildActivity(i)),[4,o()];case 1:return r=e.sent(),t&&t.resolve(),[2,r]}}))}))},u.getColumnProperties=E,u.hasVisualColumnRename=function(e){if(_.isEmpty(e))return!1;for(var t=0,r=e;t<r.length;t++){var i=r[t];if(p.contracts.isVisualContainer(i)){var a=E(i);if(a)for(var o in a)if(a[o].displayName)return!0}}return!1},u.doesVisualSupportPersonalizeVisuals=function(e,t){return t=u.getVisualType(t),e.isQnaVisual(t)||e.isQueryVisual(t)}})(powerbi=powerbi||{}),(function(u){var r,e,p,a,i,c;function o(e,t,r){if(!t||!t.column||!t.column.groupingMetadata)return 0;if(r){t=r.getGroupingDesignState(e,t.name);if(!t)return 1;if(t.partitionTable)return 3;if(t.binItem)return 2}return 1}function n(e,t,r){if(!t||!t.column||!t.column.groupingMetadata)return!1;t=r.getGroupingDesignState(e,t.name);return!(!t||!t.groupItems&&!t.partitionTable)}function s(e,t){return m(e,t).capabilities.canEdit}function l(e){return e&&!!(e.type.dateTime||e.type.integer||e.type.numeric||e.type.text)}function d(e,t){return _.map(e.groupedColumns,(function(e){if(0===e.kind)return u.data.SQExprBuilder.columnRef(t,e.name)}))}function m(e,t){t=u.data.FieldExprPattern.getSchema(a.asFieldPattern(t));return e.schema(t)}function v(e,t){return p.isGroupRef(e)&&p.isColumn(t)&&f(e,t)?e:p.isGroupRef(t)&&p.isColumn(e)&&f(t,e)?t:p.isGroupRef(e)&&p.isGroupRef(t)?f(e,t)?e:f(t,e)?t:void 0:void 0}function f(e,t){return u.data.SQExprUtils.sequenceEqual(e.groupedExprs,[t])}r=u.explore||(u.explore={}),e=r.utils||(r.utils={}),p=u.data.SQExpr,a=u.data.SQExprConverter,i=jsCommon.StringExtensions,c=u.explore.util.VisualContainerUtils,(e=e.GroupUtils||(e.GroupUtils={})).getGroupMode=o,e.isGroupOrBinColumn=function(e,t,r){return 1===(r=o(e,t,r))||2===r},e.isClusteringColumn=function(e,t,r){return 3===o(e,t,r)},e.isGroupOrClusteringColumn=n,e.canExprBeGrouped=function(e,t){return!(!t||!s(e,t)||!p.isColumn(t)&&!p.isGroupRef(t))&&l(t.getConceptualProperty(e))},e.canEditSchema=s,e.canPropertyBeGrouped=l,e.generateGroupDisplayName=function(e,t){return i.constructNameFromList(e,t.get("GroupDefinition_And"),50)},e.hasGroupOnKeys=function(e){if(e&&e.column&&e.column.keys){var t=e.column.keys;return 1===t.length&&t[0].name!==e.name||1<t.length}return!1},e.findGroupingColumn=function(e,t){var r=t&&t.defn.select();if(r&&0<r.length&&e)for(var i=0,a=e;i<a.length;i++){var o=a[i];if(!o||!o.dataMap)return;var n=Object.keys(o.dataMap);if(2===_.size(n)){o=r.withName(n[0]),n=r.withName(n[1]);if(o&&n)return v(o.expr,n.expr)}}},e.ensureBlankDefaultPlaceholder=function(e,t){_.some(e,(function(e){return e.blankDefaultPlaceholder}))||e.splice(0,0,{name:t.get("NullValue"),blankDefaultPlaceholder:!0})},e.filterOutBlankDefaultPlaceholder=function(e){return _.filter(e,(function(e){return!e.blankDefaultPlaceholder}))},e.getValidGroupingRules=function(e,t,r){var i=[];if((t=c.getVisualCapabilities(e,t))&&t.grouping){e=c.getVisualQuery(e);if(!e)return i;for(var a=e.projections,o=c.createRoleKindByQueryRef(e),n=0,s=_.filter(t.grouping.groupingRules,(function(e){return e.kind===r}));n<s.length;n++){var l=s[n],p=u.DataViewAnalysis.checkForConditionErrors(a,l.condition,o,!1);_.isEmpty(p)&&i.push(l)}}return i},e.getGroupedColumns=function(e,t,r){var i=a.asFieldPattern(e);if(i.groupingColumn)return _.map(i.groupingColumn.groupedColumns,(function(e){return u.data.SQExprBuilder.fieldExpr(e)}));if(i.column){t=t.schema(i.column.schema).findProperty(i.column.entity,i.column.name);if(n(i.column.entity,t,r)){e=e.getTargetEntity();return d(t.column.groupingMetadata,e)}}},e.getGroupedColumnsFromMetadata=d,e.getConceptualSchema=m,e.canGroup=function(e,t){var r=t&&t.defn.select();if(_.isEmpty(r)||_.isEmpty(e))return!1;for(var i=0,a=e;i<a.length;i++){var o=a[i];if(!o||!o.dataMap)return!1;var n=Object.keys(o.dataMap),s=_.size(o.dataMap);if(2<s)return!1;if(2===s){var l=r.withName(n[0]),o=r.withName(n[1]);if(l&&o&&(l=l.expr,o=o.expr,!v(l,o)))return!1}else if(1===s){n=r.withName(n[0]);if(n&&!p.isColumn(n.expr)&&!p.isGroupRef(n.expr))return!1}}return!0},e.getGroupDataType=function(e){return e.dateTime?2:e.numeric?1:0},e.convertToTimeUnit=function(e){switch(e){case 4:return 3;case 6:return 2;case 8:return 0;case 9:return 7;case 10:return 6;case 11:return 5}},e.convertToBinUnit=function(e){switch(e){case 3:return 4;case 2:return 6;case 0:return 8;case 7:return 9;case 6:return 10;case 5:return 11}},e.ensureDataSources=function(e){var t;e.get()||(t=r.contracts.createDataSourceArray([{type:"dsr",id:1,name:void 0,dsr:{schemaName:void 0,vsName:"vsName",dbName:"dbName"}}]),e.set(t))},e.showQueryError=function(e,t){null!=t&&t.getDetails&&(t=t.getDetails(u.common.getLocalize()),e.error(t.message,"GroupDialog",{debugErrorInfo:t.debugErrorInfo,displayableErrorInfo:t.displayableErrorInfo,helpLink:t.helpLink}))}})(powerbi=powerbi||{}),(function(i){!(function(e){var r;function t(e){this.key=[],this.value=[],this.comparer=e}e=e.utils||(e.utils={}),r=i.data.SQExpr,t.prototype.add=function(e,t){this.key.push(e),this.value.push(t)},t.prototype.get=function(e){if(r.isHierarchyLevel(e))for(var t=0;t<this.key.length;t++)if(this.comparer(this.key[t],e))return this.value[t]},e.SQExprToRoleDictionary=t})(i.explore||(i.explore={}))})(powerbi=powerbi||{}),(function(e){(function(e){var l,t;(t=l=e.CanvasListOrderingConstants||(e.CanvasListOrderingConstants={})).negMinOrder=-1,t.posMinOrder=0,t.negMaxOrder=-1e7,t.posMaxOrder=1e7,t.defaultGap=1e3,t.minGap=5,e.createCanvasListOrderNormalizeService=function(){return new r};var r=(i.prototype.getContainerListOrders=function(e,t){for(var r={},i=0,a=e;i<a.length;i++){var o=a[i];r[o.name]=t(o)}return r},i.prototype.getSortedContainerNames=function(t,e){e=e?"asc":"desc";return _.chain(t).keys().orderBy((function(e){return t[e]}),e).value()},i.prototype.settingListOrder=function(e,t,r,i){for(var a=0,o=t;a<o.length;a++)e[o[a]]=r,r+=i;return r},i.prototype.checkIfExtremitiesSurpassed=function(e,t,r){var i,a,o=r?(i=l.posMinOrder,o=l.posMaxOrder,a=t[_.head(e)]<i,t[_.last(e)]>o):(i=l.negMinOrder,o=l.negMaxOrder,a=t[_.head(e)]>i,t[_.last(e)]<o);return!(!a&&!o)},i.prototype.shouldNormalizeListOrder=function(e,t){var r,i=this.getSortedContainerNames(e,t);if(this.checkIfExtremitiesSurpassed(i,e,t))return!0;if(_.some(e,(function(e){return void 0===e})))return!0;for(var a=0,o=i;a<o.length;a++){var n=e[o[a]];if(null!=r){var s=0<=n==0<=r;if(Math.abs(n-r)<l.minGap&&s)return!0}r=n}return!1},i.prototype.normalizeListOrder=function(e,t){var r=this.getSortedContainerNames(e,t),i=t?l.posMaxOrder-l.posMinOrder:l.negMaxOrder-l.negMinOrder,e=t?Math.min(i/r.length,l.defaultGap):Math.max(i/r.length,-l.defaultGap);Math.abs(e),l.minGap;i=t?l.posMinOrder:l.negMinOrder,t={},this.settingListOrder(t,r,i,e);return t},i);function i(){}e.CanvasListOrderNormalizeService=r})((e=e.explore||(e.explore={})).services||(e.services={}))})(powerbi=powerbi||{}),(function(S){var E;(function(l){var d=S.data.DataViewObjectDefinitions,m=S.explore.util.DisplayNameServiceUtils,p=S.data.FieldExprPattern,u=S.data.FilterPattern,c=S.formattingService,v=S.data.SQExpr,f=S.data.SQExprBuilder,g=jsCommon.StringExtensions;l.createDisplayNameService=function(e,t,r,i,a,o,n){return new s(e,t,r,i,a,o,n)};var s=(h.prototype.getOriginalDisplayName=function(e,t,r,i){if(S.data.SQExprConverter.asFieldPattern(e,t))return p.visit(e,new a(t,this.locOptions,this.aggrOps,r,this.visualTimeSynchronizationService,this.networkAvailabilityService,i),t)},h.prototype.getDisplayName=function(e,t,r,i,a,o){if(a&&i){i=a[i];if(i&&i.displayName)return i.displayName}return this.getOriginalDisplayName(e,t,r,o)},h.prototype.getQualifiedDisplayName=function(e,t,r,i){if(S.data.SQExprConverter.asFieldPattern(e,t))return o.run(e,t,this.locOptions,this.aggrOps,r,this.visualTimeSynchronizationService,this.networkAvailabilityService,i)},h.prototype.getFilterRestatement=function(e,t,r,i){e=S.data.SQFilterConverter.asFilterPattern(e,t);if(e&&e[0])return e.length,u.visit(e[0],new l.FilterRestatementVisitor(t,this.locOptions,this.visualTimeSynchronizationService,this.networkAvailabilityService,new a(t,this.locOptions,this.aggrOps,r,this.visualTimeSynchronizationService,this.networkAvailabilityService,i),i))},h.prototype.getFilterRestatementForOverlay=function(r,i,a,o,n){var s=this,l=S.data.SQFilterConverter.asFilterPattern(r.filter,i);return l&&l[0]?_.without(_.flatten(l.map((function(e){if(e.condition&&e.condition.complex&&r.restatement)return l.length,{fieldName:"",restatements:[r.restatement],fieldNameToolTip:""};var t=s.filterOverlayRestatementVisitorFactoryService.create(i,s.locOptions,a,s,r,o,n);return u.visit(e,t)}))),void 0):[]},h.prototype.getQualifiedFilterRestatement=function(e,t,r,i){e=S.data.SQFilterConverter.asFilterPattern(e,t);if(e&&e[0])return u.visit(e[0],new l.FilterRestatementVisitor(t,this.locOptions,this.visualTimeSynchronizationService,this.networkAvailabilityService,new o(t,this.locOptions,this.aggrOps,r,this.visualTimeSynchronizationService,this.networkAvailabilityService,i),i))},h.prototype.getVisualTitle=function(e,t,r,i,a,o){var n=!!o||!(!r||r.suppressDefaultTitle),s=S.Prototype.inherit(null!=i?i:{show:n});return E.contracts.VisualTitle.isHidden(s)?i:(null==s.show&&(s.show=n),void 0!==s.text||(r?(r=s.titleComponents=this.getRawTitleComponents(e,t,r,a),!(a=this.getTitleText(r))&&o&&(a=this.generateNonQueryTitle(e.visualType)),s.text=a,this.formatTitleComponents(r)):s.text=this.generateNonQueryTitle(e.visualType)),s)},h.prototype.getTitleText=function(e){return e.subtitle?g.format(this.locOptions.stringResourceProvider.get("VisualTitle_By_Template"),e.title,e.subtitle):e.title},h.prototype.generateNonQueryTitle=function(e){var t=this.visualPluginService.getPlugin(e);return t&&t.titleKey?S.data.getDisplayName(t.titleKey,this.locOptions.stringResourceProvider):t&&t.custom?t.displayName||t.name.match(/([A-z\s]+)/g)[0]:t&&t.displayName?t.displayName:e},h.prototype.formatTitleComponents=function(e){e.subtitle&&(e.subtitle=g.format(this.locOptions.stringResourceProvider.get("VisualTitle_By_Template"),"",e.subtitle).trim())},h.prototype.getRawTitleComponents=function(e,t,r,i){var a=d.getValue(e.vcObjects,{objectName:"title",propertyName:"text"},void 0);if(a){if(v.isConstantText(a))return{title:a.value};if(e.evaluatedObjects){var o=e.evaluatedObjects.title;if(o&&o.text)return{title:o.text.toString()}}return{title:null}}var n=[],s=[];if(e&&e.query){var l=e.query;if(l.projections&&r&&!r.suppressDefaultTitle&&r.dataRoles)for(var p=0,u=r.dataRoles;p<u.length;p++){var c=u[p];this.populateDisplayNamesByDataRole(c,l,t,r,e.columnProperties,n,s,i)}}a={},o="AndConjunction";return 0<n.length?(a.title=m.concatStrings(n,o,this.locOptions),0<s.length&&(a.subtitle=m.concatStrings(s,o,this.locOptions))):0<s.length&&(a.title=m.concatStrings(s,o,this.locOptions)),a},h.prototype.getDescription=function(e,t){return r.run(e,t)},h.prototype.populateDisplayNamesByDataRole=function(e,t,r,i,a,o,n,s){var l=t.defn.select(),p=t.projections[e.name];if(p)for(var u=0,c=_.isEmpty(p.activeProjectionRefs)?_.map(p.all(),(function(e){return e.queryRef})):p.activeProjectionRefs;u<c.length;u++){var d=c[u],m=l.withName(d);m&&m.expr&&(d=this.getDisplayName(m.expr,r,i,d,a,s),(e.kind===S.VisualDataRoleKind.Grouping||e.kind!==S.VisualDataRoleKind.Measure&&h.isRoleUsedAsGroup(e,t,r)?n:o).push(d))}},h.isRoleUsedAsGroup=function(e,t,r){e.kind,S.VisualDataRoleKind.GroupingOrMeasure;e=t.projections[e.name];if(e){e=_.head(e.all()),r=t.defn.select().withName(e.queryRef).expr.getMetadata(r);if(r)return 0===r.kind}return!1},h);function h(e,t,r,i,a,o,n){this.aggrOps=e,this.visualPluginService=t,this.visualTimeSynchronizationService=r,this.localizationService=i,this.networkAvailabilityService=a,this.filterOverlayRestatementVisitorFactoryService=o,this.locOptions=null!=n?n:{aggregateDisplayNames:{Sum:this.localizationService.get("DisplayName_Sum"),Avg:this.localizationService.get("DisplayName_Avg"),Count:this.localizationService.get("DisplayName_Count"),Min:this.localizationService.get("DisplayName_Min"),Max:this.localizationService.get("DisplayName_Max"),CountNonNull:this.localizationService.get("DisplayName_CountNonNull"),Median:this.localizationService.get("DisplayName_Median"),StandardDeviation:this.localizationService.get("DisplayName_StandardDeviation"),Variance:this.localizationService.get("DisplayName_Variance"),DateMin:this.localizationService.get("DisplayName_DateMin"),DateMax:this.localizationService.get("DisplayName_DateMax"),StringMin:this.localizationService.get("DisplayName_StringMin"),StringMax:this.localizationService.get("DisplayName_StringMax")},showValueAsDisplayNames:{PercentOfGrandTotal:this.localizationService.get("DisplayName_QuickCalc_PercentOfGrandTotal"),PercentOfGrandTotalTooltip:this.localizationService.get("DisplayName_QuickCalc_PercentOfGrandTotalTooltip"),PercentileExclusive:this.localizationService.get("DisplayName_QuickCalc_PercentileExclusive"),PercentileInclusive:this.localizationService.get("DisplayName_QuickCalc_PercentileInclusive")},qualifiedDisplayNameTemplate:this.localizationService.get("Field_Tooltip"),stringResourceProvider:this.localizationService}}var a=(y.prototype.visitColumn=function(e){return y.getDisplayNameForProperty(e,this.schema)},y.prototype.visitColumnAggr=function(e){return y.getDisplayNameForSQAggregate(e,f.fromColumnAggr(e),this.schema,this.locOptions,this.visualCapabilities,this.visualTimeSynchronizationService,this.aggrOps,this.displayOptions,this.networkAvailabilityService)},y.prototype.visitGroupingColumn=function(e){return y.getDisplayNameForProperty(e,this.schema)},y.prototype.visitGroupingColumnAggr=function(e){return y.getDisplayNameForSQAggregate(e,f.fromGroupingColumnAggr(e),this.schema,this.locOptions,this.visualCapabilities,this.visualTimeSynchronizationService,this.aggrOps,this.displayOptions,this.networkAvailabilityService)},y.prototype.visitColumnHierarchyVariation=function(e){return y.getVariationHierarchyName(e,this.schema,this.displayOptions,this.locOptions.stringResourceProvider)},y.prototype.visitColumnHierarchyLevelVariation=function(e){return y.getVariationLevelName(e,this.schema,this.displayOptions,this.locOptions.stringResourceProvider)},y.prototype.visitColumnSubquery=function(e){},y.prototype.visitColumnAggrSubquery=function(e){},y.prototype.visitColumnTransformRef=function(e){},y.prototype.visitEntity=function(e){return y.getDisplayNameForEntity(e,this.schema)},y.prototype.visitEntityAggr=function(e){return y.getDisplayNameForSQAggregate(e,f.fromEntityAggr(e),this.schema,this.locOptions,this.visualCapabilities,this.visualTimeSynchronizationService,this.aggrOps,this.displayOptions,this.networkAvailabilityService)},y.prototype.visitHierarchy=function(e){return y.getDisplayNameForHierarchy(e,this.schema)},y.prototype.visitHierarchyLevel=function(e){return y.getDisplayNameForHierarchyLevel(e,this.schema,this.displayOptions,this.locOptions.stringResourceProvider)},y.prototype.visitHierarchyLevelAggr=function(e){return y.getDisplayNameForSQAggregate(e,f.fromHierarchyLevelAggr(e),this.schema,this.locOptions,this.visualCapabilities,this.visualTimeSynchronizationService,this.aggrOps,this.displayOptions,this.networkAvailabilityService)},y.prototype.visitMeasure=function(e){return y.getDisplayNameForProperty(e,this.schema)},y.prototype.visitSelectRef=function(e){},y.prototype.visitPercentile=function(e){var t=this.locOptions.showValueAsDisplayNames;return c.format(e.exclusive?t.PercentileExclusive:t.PercentileInclusive,[p.visit(e.arg,this),e.k])},y.prototype.visitPercentOfGrandTotal=function(e){return c.format(this.locOptions.showValueAsDisplayNames.PercentOfGrandTotal,[p.visit(e.baseExpr,this)])},y.prototype.visitPercentOfRoleTotal=function(t){if(this.visualCapabilities,this.visualCapabilities.dataRoleTotals,this.visualCapabilities&&this.visualCapabilities.dataRoleTotals){var e=this.visualCapabilities.dataRoleTotals,e=_.find(e,(function(e){return _.isEqual(t.roles,e.roles)}));if(e){e=S.data.getDisplayName(e.shortDisplayName,this.locOptions.stringResourceProvider);return c.format(e,[p.visit(t.baseExpr,this)])}}},y.prototype.visitTransformOutputRoleRef=function(e){return e.expressionName},y.prototype.visitFilteredEval=function(e){for(var t=this.locOptions.stringResourceProvider.get("VisualTitle_For_Template"),r=p.visit(e.baseExpr,this),i=new l.FilterRestatementVisitor(this.schema,this.locOptions,this.visualTimeSynchronizationService,this.networkAvailabilityService,new y(this.schema,this.locOptions,this.aggrOps,this.visualCapabilities,this.visualTimeSynchronizationService,this.networkAvailabilityService,this.displayOptions),this.displayOptions),a=[],o=0,n=e.filters;o<n.length;o++){var s=n[o],s=u.visit(s,i);null!=s&&a.push(s)}if(!_.isEmpty(a)){e=m.concatStrings(a,"FilterRestatement_CompoundAnd",this.locOptions);return c.format(t,[r,e])}},y.prototype.visitArithmetic=function(e){return t(p.visit(e.left,this),p.visit(e.right,this),e,this.locOptions)},y.prototype.visitConstant=function(e){return S.visuals.valueFormatter.format(e.value,void 0)},y.prototype.visitSparklineData=function(e){return _.size(e.grouping),this.locOptions.stringResourceProvider.format("VisualTitle_By_Template",p.visit(e.measure,this),p.visit(e.grouping[0],this))},y.getDisplayNameForEntity=function(e,t){e=t.schema(e.schema).entities.withName(e.entity);if(e)return e.displayName},y.getDisplayNameForProperty=function(e,t){e=t.schema(e.schema).findProperty(e.entity,e.name);if(e)return e.displayName},y.getDisplayNameForHierarchyLevel=function(e,t,r,i){t=t.schema(e.schema).findHierarchy(e.entity,e.name);if(t){e=t.levels.withName(e.level);if(e){e=e.displayName||e.column.displayName;return r&&r.includeHierarchyName&&i&&(t=t.displayName,e=g.format(i.get("IncludeVariationSourceDisplayName"),t,e)),e}}},y.getDisplayNameForHierarchy=function(e,t){e=t.schema(e.schema).findHierarchy(e.entity,e.name);if(e)return e.displayName},y.getVariationHierarchyName=function(e,t,r,i){var a=t.schema(e.source.schema).findProperty(e.source.entity,e.source.name);if(a)for(var o=0,n=a.column.variations;o<n.length;o++){var s=n[o],l=s.defaultHierarchy;if(s.name===e.variationName&&l&&l.name===e.hierarchy.name){l=l.displayName;return r&&r.includeVariationSource&&i?g.format(i.get("IncludeVariationSourceDisplayName"),a.displayName,l):l}}},y.getVariationLevelName=function(e,t,r,i){var a=t.schema(e.source.schema).findProperty(e.source.entity,e.source.name);if(a)for(var o=0,n=a.column.variations;o<n.length;o++){var s=n[o];if(s.name===e.variationName)for(var l=0,p=s.defaultHierarchy.levels;l<p.length;l++){var u=p[l];if(u.name===e.level.level){u=u.column.displayName;return r&&r.includeVariationSource&&i?g.format(i.get("IncludeVariationSourceDisplayName"),a.displayName,u):u}}}},y.getDisplayNameForSQAggregate=function(e,t,r,i,a,o,n,s,l){e=r.schema(e.schema).entities.withName(e.entity);if(e){l=p.visit(t.arg,new y(r,i,n,a,o,l,s));return l?x(t,r,s,n)?l:b(l,t.func,t.arg.getMetadata(r),i):b(e.displayName,t.func,t.arg.getMetadata(r),i)}},y);function y(e,t,r,i,a,o,n){this.schema=e,this.locOptions=t,this.aggrOps=r,this.visualCapabilities=i,this.visualTimeSynchronizationService=a,this.networkAvailabilityService=o,this.displayOptions=n}l.DisplayNameServiceVisitor=a;var o=(C.run=function(e,t,r,i,a,o,n,s){return new C(t,r,i,a,o,n,s).accept(e,t)},C.prototype.accept=function(e,t){var r=e;if(v.isAggregation(r)){var i=p.visit(r.arg,this);return x(r,this.schema,this.displayOptions,this.aggrOps)?i:b(i,r.func,r.arg.getMetadata(this.schema),this.locOptions)}return p.visit(e,this,t)},C.prototype.visitEntity=function(e){var t=a.getDisplayNameForEntity(e,this.schema);return this.formatWithEntity(t,e)},C.prototype.visitColumn=function(e){var t=a.getDisplayNameForProperty(e,this.schema);return this.formatWithEntity(t,e)},C.prototype.visitColumnAggr=function(e){},C.prototype.visitGroupingColumn=function(e){var t=a.getDisplayNameForProperty(e,this.schema);return this.formatWithEntity(t,e)},C.prototype.visitGroupingColumnAggr=function(e){},C.prototype.visitColumnHierarchyVariation=function(e){var t=a.getVariationHierarchyName(e,this.schema,this.displayOptions,this.locOptions.stringResourceProvider);return this.formatWithEntity(t,e.source)},C.prototype.visitColumnHierarchyLevelVariation=function(e){var t=a.getVariationLevelName(e,this.schema,this.displayOptions,this.locOptions.stringResourceProvider);return this.formatWithEntity(t,e.source)},C.prototype.visitColumnSubquery=function(e){},C.prototype.visitColumnAggrSubquery=function(e){},C.prototype.visitColumnTransformRef=function(e){},C.prototype.visitEntityAggr=function(e){var t=a.getDisplayNameForSQAggregate(e,f.fromEntityAggr(e),this.schema,this.locOptions,this.visualCapabilities,this.visualTimeSynchronizationService,this.aggrOps,this.displayOptions,this.networkAvailabilityService);return this.formatWithEntity(t,e)},C.prototype.visitHierarchy=function(e){var t=a.getDisplayNameForHierarchy(e,this.schema);return this.formatWithEntity(t,e)},C.prototype.visitHierarchyLevel=function(e){var t=a.getDisplayNameForHierarchyLevel(e,this.schema,this.displayOptions,this.locOptions.stringResourceProvider);return this.formatWithEntity(t,e)},C.prototype.visitHierarchyLevelAggr=function(e){},C.prototype.visitMeasure=function(e){var t=this.locOptions.qualifiedDisplayNameTemplate,r=a.getDisplayNameForProperty(e,this.schema),e=a.getDisplayNameForEntity(e,this.schema);return e?g.format(t,e,r):r},C.prototype.visitSelectRef=function(e){},C.prototype.visitPercentile=function(e){var t=this.locOptions.showValueAsDisplayNames;return c.format(e.exclusive?t.PercentileExclusive:t.PercentileInclusive,[this.accept(f.fieldExpr(e.arg)),e.k])},C.prototype.visitPercentOfGrandTotal=function(e){return c.format(this.locOptions.showValueAsDisplayNames.PercentOfGrandTotalTooltip,[this.accept(f.fieldExpr(e.baseExpr))])},C.prototype.visitPercentOfRoleTotal=function(t){if(this.visualCapabilities,this.visualCapabilities.dataRoleTotals,this.visualCapabilities&&this.visualCapabilities.dataRoleTotals){var e=this.visualCapabilities.dataRoleTotals,e=_.find(e,(function(e){return _.isEqual(t.roles,e.roles)}));if(e){e=S.data.getDisplayName(e.tooltip,this.locOptions.stringResourceProvider);return c.format(e,[this.accept(f.fieldExpr(t.baseExpr))])}}},C.prototype.visitTransformOutputRoleRef=function(e){return e.expressionName},C.prototype.visitFilteredEval=function(e){for(var t=this.locOptions.stringResourceProvider.get("VisualTitle_For_Template"),r=this.accept(f.fieldExpr(e.baseExpr)),i=[],a=new l.FilterRestatementVisitor(this.schema,this.locOptions,this.visualTimeSynchronizationService,this.networkAvailabilityService,new C(this.schema,this.locOptions,this.aggrOps,this.visualCapabilities,this.visualTimeSynchronizationService,this.networkAvailabilityService,this.displayOptions),this.displayOptions),o=0,n=e.filters;o<n.length;o++){var s=n[o],s=u.visit(s,a);null!=s&&i.push(s)}if(!_.isEmpty(i)){e=m.concatStrings(i,"FilterRestatement_CompoundAnd",this.locOptions);return c.format(t,[r,e])}},C.prototype.visitArithmetic=function(e){return t(this.accept(f.fieldExpr(e.left)),this.accept(f.fieldExpr(e.right)),e,this.locOptions)},C.prototype.visitConstant=function(e){return S.visuals.valueFormatter.format(e.value,void 0)},C.prototype.visitSparklineData=function(e){return _.size(e.grouping),this.locOptions.stringResourceProvider.format("VisualTitle_By_Template",this.accept(f.fieldExpr(e.measure)),this.accept(f.fieldExpr(e.grouping[0])))},C.prototype.formatWithEntity=function(e,t){var r=this.locOptions.qualifiedDisplayNameTemplate,t=a.getDisplayNameForEntity(t,this.schema);return t?g.format(r,t,e):e},C);function C(e,t,r,i,a,o,n){this.schema=e,this.locOptions=t,this.aggrOps=r,this.visualCapabilities=i,this.visualTimeSynchronizationService=a,this.networkAvailabilityService=o,this.displayOptions=n}l.QualifiedDisplayNameVisitor=o;var r=(i.run=function(e,t){t=new i(t);return p.visit(e,t)},i.prototype.visitColumn=function(e){return this.getPropertyDescription(e)},i.prototype.visitColumnAggr=function(e){return this.getPropertyDescription(e)},i.prototype.visitGroupingColumn=function(e){return this.getPropertyDescription(e)},i.prototype.visitGroupingColumnAggr=function(e){return this.getPropertyDescription(e)},i.prototype.visitColumnHierarchyVariation=function(e){e=e.hierarchy,e=this.findHierarchy(e);if(e)return e.description},i.prototype.visitColumnHierarchyLevelVariation=function(e){return this.getHierarchyLevelDescription(e.level)},i.prototype.visitColumnSubquery=function(e){},i.prototype.visitColumnAggrSubquery=function(e){},i.prototype.visitColumnTransformRef=function(e){},i.prototype.visitEntity=function(e){return this.getEntityDescription(e)},i.prototype.visitEntityAggr=function(e){return this.getEntityDescription(e)},i.prototype.visitHierarchy=function(e){e=this.findHierarchy(e);if(e)return e.description},i.prototype.visitHierarchyLevel=function(e){return this.getHierarchyLevelDescription(e)},i.prototype.visitHierarchyLevelAggr=function(e){return this.getHierarchyLevelDescription(e)},i.prototype.visitMeasure=function(e){return this.getPropertyDescription(e)},i.prototype.visitPercentile=function(e){return p.visit(e.arg,this)},i.prototype.visitPercentOfGrandTotal=function(e){return p.visit(e.baseExpr,this)},i.prototype.visitPercentOfRoleTotal=function(e){return p.visit(e.baseExpr,this)},i.prototype.visitSelectRef=function(e){},i.prototype.visitTransformOutputRoleRef=function(e){},i.prototype.visitFilteredEval=function(e){},i.prototype.visitArithmetic=function(e){},i.prototype.visitConstant=function(e){},i.prototype.visitSparklineData=function(e){},i.prototype.getPropertyDescription=function(e){var t=this.schema.schema(e.schema);if(t){e=t.findProperty(e.entity,e.name);return e&&e.description}},i.prototype.getEntityDescription=function(e){var t=this.schema.schema(e.schema);if(t){e=t.entities.withName(e.entity);return e&&e.description}},i.prototype.getHierarchyLevelDescription=function(e){var t=this.findHierarchy(e);if(t){e=t.levels.withName(e.level);return e&&e.description}},i.prototype.findHierarchy=function(e){var t=this.schema.schema(e.schema);if(t)return t.findHierarchy(e.entity,e.name)},i);function i(e){this.schema=e}function x(e,t,r,i){return(!r||!r.includeDefaultAggregate)&&i.defaultAggregate(e,t,!1)===e.func}function b(e,t,r,i){r=n(t,r),r=i.aggregateDisplayNames[r];return c.format(r,[e])}function n(e,t){var r=S.data.aggregateFunctionName(e);return(3===e||4===e)&&t&&t.type&&(t.type.dateTime?r="Date"+r:t.type.text&&(r="String"+r)),r}function t(e,t,r,i){e=r.left.arithmetic?i.stringResourceProvider.format("BracketedValue",e):e,t=r.right.arithmetic?i.stringResourceProvider.format("BracketedValue",t):t,r=(function(e){switch(e){case 0:return"+";case 1:return"-";case 2:return"*";case 3:return"/"}})(r.operator);return i.stringResourceProvider.format("DisplayName_Arithmetic_Format",e,r,t)}l.getAggregateKey=n})((E=S.explore||(S.explore={})).services||(E.services={}))})(powerbi=powerbi||{}),(function(e){var i;e=(e=e.explore||(e.explore={})).util||(e.util={}),(i=e.DetailVisualUtils||(e.DetailVisualUtils={})).DetailVisualBorder=10,i.supportsVisualDetails=function(e,t,r){return!(!(t=t.capabilities(e))||!r.isQueryVisual(e)||r.isAnalysisVisual(e))&&(!t.disableVisualDetails&&_.some(t.dataViewMappings,(function(e){return e.categorical||e.matrix||e.table||e.tree})))},i.getDetailVisualViewport=function(e,t){var r,t=1===(t||1)?(r=e.width-2*i.DetailVisualBorder,e.height-i.DetailVisualBorder):(r=e.width-i.DetailVisualBorder,e.height-2*i.DetailVisualBorder);return{width:Math.max(r,0),height:Math.max(t,0),scale:e.scale}}})(powerbi=powerbi||{}),(function(c){var t;(function(r){var i=c.explore.util.DetailVisualUtils,d=c.explore.util.DrillUtils,a=jsCommon.EnumExtensions,p=c.visuals.plugins,u=t.util.VisualContainerUtils;r.createDrillService=function(e,t,r,i){return new o(e,t,r,i)};var o=(e.prototype.getSupportedDrillDirections=function(e,t){var r=this.getProjections(e);if(!r)return 0;var i=t?[t]:[];if(_.isEmpty(i)){t=e.config.singleVisual,t=this.visualPlugin.capabilities(t.visualType);if(!t||t.drilldown&&t.drilldown.suppresDrillOperations)return 0;i=d.getDrillableRoles(t)}for(var a=0,o=0,n=i;o<n.length;o++){var s,l,p,u=n[o],c=r[u];c&&(!c.activeProjectionRefs||1!==(s=c.all()).length&&(l=c.activeProjectionRefs,p=this.findActiveProjectionIndexInQueryCollection(s,l),_.isEmpty(l)||p+l.length===s.length||(this.canDrillDownLevel(e,2,u)&&(a|=2),this.canDrillDownLevel(e,3,u)&&(a|=4)),!_.isEmpty(c.activeProjectionRefs)&&(0!==p||1<l.length)&&(a|=1)))}return a},e.prototype.setDrillMode=function(e,t){e&&e.drillMode!==t&&(e.drillMode=t,this.raiseDrillModeChanged(e,t))},e.prototype.canSeeData=function(e){if(!(e&&e.config&&e.config.singleVisual&&e.config.singleVisual.query))return!1;var t=u.getVisualType(e),e=this.runningVisualService.getVisual(e);return!(e&&!!e.getErrorInfo())&&i.supportsVisualDetails(t,this.visualPlugin,this.visualPluginOps)},e.prototype.canDrillToDetails=function(e,t){if(!e)return!1;var r=u.getVisualQuery(e);if(!r)return!1;var i=u.getVisualType(e);if(i===p.lineChart.name||i===p.areaChart.name||i===p.stackedAreaChart.name)return!1;i=u.getVisualCapabilities(e,this.visualPlugin);if(!i||!1===i.supportsSelection)return!1;var a=_(u.getSelectExprs(e)).filter((function(e){return c.data.SQExpr.isAggregation(e.expr)})).map((function(e){return e.name})).value();if(_.isEmpty(a))return!1;if(!_.isEmpty(t)&&!_.includes(a,_.head(_.head(t).metadata)))return!1;i=i.dataRoles;if(_.isEmpty(i))return!1;for(var o=0,n=0,s=_(i).filter((function(e){return e.kind===c.VisualDataRoleKind.Measure&&0!==e.joinPredicate})).map((function(e){return e.name})).value();n<s.length;n++){var l=s[n],l=r.projections[l];if(!_.isEmpty(l)){if(1<++o)return!1;l=l.all();if(_.some(l,(function(e){return!_.includes(a,e.queryRef)})))return!1}}return 0!==o},e.prototype.canDrillByDirection=function(e,t,r){if(!e)return!1;var i=this.runningVisualService.getVisual(e);if(i&&!!i.getErrorInfo())return!1;r=this.getSupportedDrillDirections(e,r);return!!r&&a.hasFlag(r,t)},e.prototype.canDrillthrough=function(e){return!!e},e.prototype.isDrillModeEnabled=function(e,t){return!!e&&e.drillMode===t},e.prototype.canDrillDownLevel=function(r,i,a){var o=u.getVisualQuery(r);if(!o)return!1;var e=u.getVisualCapabilities(r,this.visualPlugin);if(!e)return!1;if(e.drilldown&&e.drilldown.suppresDrillOperations)return!1;if(!a)return!1;var n=o.projections[a],t=n.getLastActiveQueryReference();if(!t)return!1;for(var s=_.findIndex(n.all(),(function(e){return e.queryRef===t})),l=0;l<s;l++){var p=(function(e){var e=n.all()[e],t=o.defn.select().withName(e.queryRef).expr;if(0===_.filter(r.filters,(function(e){return r.name,null!=e&&2===e.howCreated&&c.data.SQExpr.equals(t,e.expression)})).length)return{value:o.currentDrillMode(a)===i}})(l);if("object"==typeof p)return p.value}return 3!==i||!_.find(o.expansionStates,(function(e){return _.find(e.roles,(function(e){return e===a}))&&e.isStateModified()}))},e.prototype.getProjections=function(e){return e&&e.config&&e.config.singleVisual&&e.config.singleVisual.query&&e.config.singleVisual.query.projections},e.prototype.findActiveProjectionIndexInQueryCollection=function(e,t){if(!_.isEmpty(t))for(var r=0;r<e.length;r++){for(var i=r,a=0;a<t.length&&i<e.length&&t[a]===e[i].queryRef;)a++,i++;if(a===t.length)return r}return-1},e.prototype.raiseDrillModeChanged=function(e,t){this.eventBridge.publishToChannel(r.events.drillModeChanged,{visualContainer:e})},e);function e(e,t,r,i){this.eventBridge=e,this.visualPlugin=t,this.visualPluginOps=r,this.runningVisualService=i}})((t=c.explore||(c.explore={})).services||(t.services={}))})(powerbi=powerbi||{}),(function(e){var t;t=e.explore||(e.explore={}),(t=(e=t.services||(t.services={})).SectionNavigationAction||(e.SectionNavigationAction={}))[t.Unknown=0]="Unknown",t[t.Swipe=1]="Swipe",(e=e.events||(e.events={})).modelChangeApplyingUpdate={type:4,name:"modelChangeApplyingUpdate"},e.explorationLoaded={type:1,name:"explorationLoaded"},e.explorationUnloaded={type:1,name:"explorationUnloaded"},e.explorationContainerReady={type:3,name:"explorationContainerReady"},e.explorationSlowDataSourceSettingsLoaded={type:1,name:"explorationSlowDataSourceSettingsLoaded"},e.explorationSettingsLoaded={type:1,name:"explorationSettingsLoaded"},e.updateNavButtonEvent={type:1,name:"updateNavButtonEvent"},e.userActionTriggered={type:2,name:"userActionTriggered"},e.filterContainerChanged={type:2,name:"filterContainerChanged"},e.applyAllBufferedFilterCardChanged={type:1,name:"applyAllBufferedFilterCardChange"},e.applyAllClicked={type:1,name:"applyAllClicked"},e.explorationFiltersContainerChanged={type:1,name:"explorationFiltersContainerChanged"},e.sectionFiltersContainerChanged={type:1,name:"sectionFiltersContainerChanged"},e.sectionDrillthroughLinkChanged={type:1,name:"sectionDrillthroughLinkChanged"},e.formFactorChanged={type:1,name:"formFactorChanged"},e.canvasLayoutChanged={type:1,name:"canvasLayoutChanged"},e.modelChanging={type:0,name:"modelChanging"},e.modelChanged={type:0,name:"modelChanged"},e.visualRelationshipsModeChanged={type:2,name:"visualRelationshipsModeChanged"},e.schemaItemActivationChanged={type:0,name:"schemaItemActivationChanged"},e.selectionChanged={type:2,name:"selectionChanged"},e.visualTypeChanged={type:2,name:"visualTypeChanged"},e.visualLinkButtonClicked={type:2,name:"visualLinkButtonClicked"},e.dataPointsSelected={type:2,name:"dataPointsSelected"},e.dataHyperlinkClicked={type:2,name:"dataHyperlinkClicked"},e.visualClicked={type:2,name:"visualClicked"},e.undoRedoStackUpdated={type:1,name:"undoRedoStackUpdated"},e.undoRedoStackCleared={type:1,name:"undoRedoStackCleared"},e.onReportChanged={type:1,name:"onReportChanged"},e.onReportChangedGlobal={type:4,name:"onReportChanged"},e.clipboardDataUpdated={type:1,name:"clipboardDataUpdated"},e.dataSelectionChanged={type:2,name:"dataSelectionChanged"},e.drillModeChanged={type:2,name:"drillModeChanged"},e.refreshExploration={type:2,name:"refreshExploration"},e.clearAnnotations={type:2,name:"clearAnnotations"},e.saveReportCompleted={type:0,name:"saveReportCompleted"},e.customSaveAsTriggered={type:0,name:"customSaveAsTriggered"},e.sectionLayoutRemoved={type:1,name:"sectionLayoutRemoved"},e.canvasChanged={type:1,name:"canvasChanged"},e.visualContainerParentActivityLinkingDone={type:2,name:"visualContainerParentActivityLinkingDone"},e.fieldWellFieldRemovedEvent={type:2,name:"fieldWellFieldRemoved"},e.visualContainerChanged={type:2,name:"visualContainerChanged"},e.dataRefreshTriggered={type:2,name:"triggerDataRefresh"},e.visualContainerGroupChanged={type:2,name:"visualContainerGroupChanged"},e.visualContainerGroupRendered={type:2,name:"visualContainerGroupRendered"},e.visualContainerDataRenderingStarted={type:2,name:"visualContainerDataRenderingStarted"},e.visualContainerDataRendered={type:2,name:"visualContainerDataRendered"},e.canvasItemContainerPositionChanged={type:2,name:"canvasItemContainerPositionChanged"},e.visualContainerLoadingStarted={type:2,name:"visualContainerLoadingStarted"},e.visualContainerLoadingStopped={type:2,name:"visualContainerLoadingStopped"},e.visualConversion={type:2,name:"visualConversion"},e.focusVisualContainerEvent={type:2,name:"focusVisualContainerEvent"},e.canvasSizeChangedEvent={type:2,name:"canvasSizeChanged"},e.visualPluginsChanged={type:2,name:"visualPluginsChanged"},e.addCustomVisual={type:2,name:"addCustomVisual"},e.deleteCustomVisual={type:2,name:"deleteCustomVisual"},e.modelingContextChanged={type:0,name:"modelingContextChanged"},e.changeViewMode={type:2,name:"changeViewMode"},e.requestViewModeChange={type:2,name:"requestViewModeChange"},e.editModeChanged={type:2,name:"editModeChanged"},e.getClusters={type:2,name:"getClusters"},e.toggleSortVisualContainer={type:2,name:"toggleSortVisualContainer"},e.toggleSortDirectionVisualContainer={type:2,name:"toggleSortDirectionVisualContainer"},e.saveKeyPressedEvent={type:1,name:"saveEventViaCtrlS"},e.highContrastModeChanged={type:1,name:"highContrastModeChanged"},e.canvasDisplayChanged={type:1,name:"canvasDisplayChanged"},e.canvasZoomChanged={type:1,name:"canvasZoomChanged"},e.canvasZoomScaleUpdated={type:1,name:"canvasZoomScaleUpdated"},e.canvasDimensionChanged={type:1,name:"canvasDimensionChanged"},e.explorationObjectsLoaded={type:3,name:"explorationObjectsLoaded"},e.explorationObjectsChanged={type:3,name:"explorationObjectsChanged"},e.sectionObjectsEvaluated={type:1,name:"sectionObjectsEvaluated"},e.sectionObjectsChanged={type:1,name:"sectionObjectsChanged"},e.datasourceVariablesEditClicked={type:3,name:"showDataSourceVariablesDialog"},e.themeDialogButtonClicked={type:3,name:"showThemeDialog"},e.visibilityChanged={type:2,name:"visibilityChanged"},e.canvasItemHiddenChanged={type:2,name:"canvasItemHiddenChanged"},e.align={type:1,name:"align"},e.deleteSectionInitiated={type:1,name:"deleteSectionInitiated"},e.sectionNameChanged={type:1,name:"sectionNameChanged"},e.sectionDeleted={type:1,name:"sectionDeleted"},e.renameSection={type:1,name:"renameSection"},e.sectionChanged={type:1,name:"sectionChanged"},e.podParameterChanged={type:1,name:"podParameterChanged"},e.missingTableRelationship={type:2,name:"missingTableRelationship"},e.addVisualContainer={type:1,name:"addVisualContainer"},e.addCustomVisualToCanvas={type:3,name:"addCustomVisualToCanvas"},e.deleteVisualContainer={type:2,name:"deleteVisualContainer"},e.addInsightContainer={type:1,name:"addInsightContainer"},e.addQnaContainer={type:1,name:"addQnaContainer"},e.showQnaPopout={type:1,name:"showQnaPopoutEventArgs"},e.canvasPinched={name:"canvasPinched",type:1},e.changeFormFactor={name:"changeFormFactor",type:1},e.arrangeVisualsOrder={type:1,name:"arrangeVisualsOrder"},e.createImage={type:1,name:"createImage"},e.createBasicShape={type:1,name:"createBasicShape"},e.createShape={type:1,name:"createShape"},e.createActionButton={type:1,name:"createActionButton"},e.createNavigator={type:1,name:"createPageNavigator"},e.createTextbox={type:1,name:"createTextbox"},e.importVisual={type:1,name:"importVisual"},e.addManagedCustomVisual={type:4,name:"addManagedCustomVisual"},e.installVisual={type:1,name:"installVisual"},e.downloadVisual={type:1,name:"downloadVisual"},e.newQueryCacheResultAvailable={type:2,name:"newQueryCacheResultAvailable"},e.exportVisualData={type:2,name:"exportVisualData"},e.exportVisualDataFromPane={type:1,name:"exportVisualDataFromPane"},e.addCommentVisual={type:2,name:"addCommentVisual"},e.shareToTeamsVisual={type:2,name:"shareToTeamsVisual"},e.reportSlidesChanged={type:1,name:"reportSlidesChanged"},e.createSection={type:1,name:"createSection"},e.deleteSection={type:1,name:"deleteSection"},e.duplicateSection={type:1,name:"duplicateSection"},e.insertSection={type:1,name:"insertSection"},e.reorderSection={type:1,name:"reorderSection"},e.switchSection={type:1,name:"switchSection"},e.explorationNextPage={type:3,name:"explorationNextPage"},e.explorationPreviousPage={type:3,name:"explorationPreviousPage"},e.startExplorationContainerLoading={type:3,name:"startExplorationContainerLoading"},e.stopExplorationContainerLoading={type:3,name:"stopExplorationContainerLoading"},e.copyTable={type:1,name:"copyDataTable"},e.showEnableScriptVisualsDialog={type:2,name:"showEnableScriptVisualsDialog"},e.CanvasResized={type:1,name:"canvasResized"},e.openReportFinished={type:4,name:"openReportFinished"},e.openReportLoadingScreenHidden={type:4,name:"openReportLoadingScreenHidden"},e.visualQueryThrottled={type:4,name:"visualQueryThrottled"},e.datasetNotFound={type:4,name:"datasetNotFound"},e.ShowVisuals={type:4,name:"ShowVisuals"},e.bookmarkApplied={type:1,name:"bookmarkApplied"},e.exploreCanvasVisualRendered={type:1,name:"exploreCanvasVisualRendered"},e.reportVisualError={type:2,name:"ReportVisualError"},e.reportVisualErrorGlobal={type:4,name:"ReportVisualError"},e.visualThumbnailDoubleClicked={type:3,name:"visualThumbnailDoubleClicked"},e.removeVisualContainerFromLayout={type:2,name:"removeVisualContainerFromLayout"},e.pauseQueriesChanged={type:1,name:"pauseQueriesChanged"},e.deleteVisual={type:2,name:"deleteVisual"},e.deleteCustomVisuals={type:2,name:"deleteCustomVisuals"},e.resetPersistentUserState={type:4,name:"resetPersistentUserState"},e.resetUserStateKeyPressedEvent={type:1,name:"resetUserStateKeyPressedEvent"},e.resetUserStateEvent={type:4,name:"resetUserStateEvent"},e.reloadPersistenState={type:3,name:"reloadPersistenState"},e.togglePaneVisibility={type:1,name:"togglePaneVisibility"},e.visualDrillFilterOtherVisualsSettingChanged={type:2,name:"visualDrillFilterOtherVisualsSettingChanged"},e.emulationChanged={type:0,name:"emulationChanged"},e.showOtherBookmarks={type:3,name:"showOtherBookmarks"},e.parentExpandCollapseAction={type:2,name:"parentExpandCollapseAction"},e.bookmarkViewStateChanged={type:3,name:"bookmarkViewStateChanged"},e.exportDataStarted={type:0,name:"exportDataStarted"},e.exportDataEnded={type:0,name:"exportDataEnded"},e.visualContainerControllerLinked={type:2,name:"visualContainerControllerLinked"},e.insightsInFocusPaneClose={type:4,name:"insightsInFocusPaneClose"},e.pinInsightContainer={type:4,name:"pinInsightContainer"},e.insightSelected={type:4,name:"insightSelected"},e.getRelatedInsights={type:4,name:"getRelatedInsights"},e.viewInsightInFocus={type:4,name:"viewInsightInFocus"},e.autoPageRefreshTriggered={type:0,name:"autoPageRefreshTriggered"},e.drillthroughActionTriggered={type:2,name:"drillthroughActionTriggered"},e.anchorTimeUpdated={type:4,name:"anchorTimeUpdated"},e.visualCancelLoadEvent={type:4,name:"visualCancelLoadEvent"},e.onObjectFormatFilterUpdated={type:3,name:"onObjectFormatFilterUpdated"},e.saveAsExploration={name:"saveAsExploration"},e.generateReportQR={name:"generateReportQR"},e.saveExploration={name:"saveExploration"},e.saveReportFromPinDialogEvent={type:4,name:"saveReportFromPinDialog"},e.findAnomalies={type:2,name:"findAnomalies"},e.forecast={type:2,name:"forecast"},e.toggleDataTable={type:2,name:"toggleDataTable"},e.affectsVisualContainer=function(e,t){return e.visualContainer===t}})(powerbi=powerbi||{}),(function(i){var a;(function(e){var l=i.data.ExpansionState,p=i.data.Selector,u=a.util.VisualContainerUtils;e.createExpandCollapseService=function(e,t){return new r(e)};var r=(t.prototype.getExpandCollapseRoles=function(e){i.contract.checkValue(e,"visual should have a value");e=this.visualPlugin.capabilities(u.getVisualType(e));if(e&&e.expandCollapse&&!_.isEmpty(e.expandCollapse.roles))return e.expandCollapse.roles},t.prototype.isSupported=function(e,t,r){if(!t||!e||!e.supportsInstanceFilters)return!1;var i=u.getVisualQuery(t);return!!i&&!(!_.isEmpty(r)&&_.some(r,(function(e){return 3===i.currentDrillMode(e)})))},t.prototype.isEnabled=function(e,t){if(i.contract.checkValue(e,"visual should have a value"),_.isEmpty(t))return!1;var r=this.getExpandCollapseRoles(e);return!_.isEmpty(r)&&!_.some(t,(function(e){return-1===_.indexOf(r,e)}))},t.prototype.getMaximumExpansionDepth=function(e,t){if(this.isEnabled(e,t)){e=u.getVisualQuery(e);if(e){t=e.getRolesProjectionRefs(t);return t.length}}},t.prototype.getAllowedActions=function(e,t,r){var i=u.getVisualQuery(e);if(i&&this.isEnabled(e,t)&&!_.isEmpty(r)&&1===r.length){var a=r[0];if(a&&a.dataMap&&!_.isEmpty(a.dataMap)){var o=p.toScopeIdentities(p.convertSelectorsByColumnToSelector(a));if(!_.isEmpty(o)){var n=i.getRolesUniqueProjectionRefs(t),s=i.getRolesUniqueActiveProjectionsRefs(t,this.canCollapseRoot(e)),r=s.length===n.length,e=_.some(t,(function(e){return 3===i.currentDrillMode(e)}));if(1===n.length||e)return{};a=this.getSelectorRefs(a);if(!_.some(a,(function(e){return!_.includes(s,e)}))){a=o.length,n=a===n.length,a=a===s.length,t=l.findExpansionState(i.expansionStates,t);if(t){o=t.getNodeLevelState(o,t.root,0);return{expandNode:!n&&!!o.isNodeCollapsed,collapseNode:!a&&!o.isNodeCollapsed,expandLevel:!n&&(o.levelHasToggledNodes||!!o.isNodeCollapsed),collapseLevel:!a&&(o.levelHasToggledNodes||!o.isNodeCollapsed),expandHierarchy:!r||!t.isHierarchyExpanded(),collapseHierarchy:!t.isWholeLevelCollapsed(0)}}return{expandNode:!n&&a,collapseNode:!a,expandLevel:!n&&a,collapseLevel:!a,expandHierarchy:!r,collapseHierarchy:1<s.length}}}}}},t.prototype.getSelectorRefs=function(e){if(!e||!e.dataMap||_.isEmpty(e.dataMap))return[];var t,r=[];for(t in e.dataMap)r.push(t);return r},t.prototype.expandNode=function(e,t,r){var i,a=this.setNodeState(e,t,r,!1);a&&(i=this.ensureExpansionState(e,t),r=this.getSelectorRefs(r),this.canCollapseRoot(e)||_.isEmpty(r),r=r.length-1,a=i.getVisibleDescendentsDepth(a,r),(r=u.getVisualQuery(e))&&r.getRolesUniqueActiveProjectionsRefs(t,this.canCollapseRoot(e)).length<a&&this.setActiveProjections(e,t,a))},t.prototype.collapseNode=function(e,t,r){this.setNodeState(e,t,r,!0);r=this.ensureExpansionState(e,t),r=r.getVisibleDescendentsDepth(r.root,-1);this.setActiveProjections(e,t,r)},t.prototype.expandLevel=function(e,t,r,i){void 0===i&&(i=!1);var a=this.ensureExpansionState(e,t);this.setLevelState(e,t,r,!1,i);a=a.getVisibleDescendentsDepth(a.root,-1);this.setActiveProjections(e,t,a)},t.prototype.collapseLevel=function(e,t,r,i){this.setLevelState(e,t,r,!0,i=void 0===i?!1:i),this.setActiveProjections(e,t,r+1)},t.prototype.expandAll=function(e,t){this.setAllLevelsState(e,t,!1);var r=this.ensureExpansionState(e,t).levels.length;this.setActiveProjections(e,t,r)},t.prototype.collapseAll=function(e,t){this.setAllLevelsState(e,t,!0),this.setActiveProjections(e,t,this.canCollapseRoot(e)?0:1)},t.prototype.pinLevels=function(e,t,r){this.ensureExpansionState(e,t).pinLevels(r)},t.prototype.unpinLevels=function(e,t,r){this.ensureExpansionState(e,t).unpinLevels(r)},t.prototype.lockLevels=function(e,t,r){this.ensureExpansionState(e,t).lockLevels(r)},t.prototype.unlockLevels=function(e,t,r){this.ensureExpansionState(e,t).unlockLevels(r)},t.prototype.setAILevelInformation=function(e,t,r,i,a){t=this.ensureExpansionState(e,t);_.isEqual(t.levels[r].queryRefs,i),t.setAILevelInformation(r,a)},t.prototype.getAILevelInformation=function(e,t,r){e=u.getVisualQuery(e);return l.getAILevelInformation(e.expansionStates,t,r)},t.prototype.clearAILevelsInformation=function(e,t){for(var r=this.ensureExpansionState(e,t),i=0;i<_.size(r.levels);i++)r.setAILevelInformation(i,void 0)},t.prototype.setNodeState=function(e,t,r,i){var a=this.ensureExpansionState(e,t),t=this.getSelectorRefs(r);if(!_.isEmpty(t)||this.canCollapseRoot(e))return t.length,a.levels.length,a.setNodeState(p.convertSelectorsByColumnToSelector(r),i)},t.prototype.setLevelState=function(e,t,r,i,a){var o=this.ensureExpansionState(e,t);if(o.levels,a)for(var n=0;n<r;n++)o.levels[n],o.setLevelState(n,!1);o.setLevelState(r,i)},t.prototype.setAllLevelsState=function(e,t,r){var i=this.ensureExpansionState(e,t);i.levels,this.canCollapseRoot(e)&&i.setLevelState(-1,r);for(var a=i.levels,o=0;o<a.length-1;o++)i.setLevelState(o,r)},t.prototype.ensureExpansionState=function(e,t){this.isEnabled(e,t);var r=u.getVisualQuery(e),i=this.visualPlugin.capabilities(u.getVisualType(e)),a=i&&i.expandCollapse&&i.expandCollapse.supportsMerge,i=i&&i.expandCollapse&&i.expandCollapse.collapseParentAfterRemovingChildLevel,e=this.canCollapseRoot(e),i=r.ensureExpansionState(t,{supportsMerge:a,canCollapseRoot:e,collapseParentAfterRemovingChildLevel:i});return i.levels,i},t.prototype.canCollapseRoot=function(e){e=this.visualPlugin.capabilities(u.getVisualType(e));return!(!e||!e.noDefaultProjections)},t.prototype.setActiveProjections=function(e,t,r){this.canCollapseRoot(e);e=u.getVisualQuery(e);e.setActiveProjections(t,r)},t);function t(e){this.visualPlugin=e}})((a=i.explore||(i.explore={})).services||(a.services={}))})(powerbi=powerbi||{}),(function(p){var u,e;function c(e,t,r){t&&(e.usageReportSection=r&&r.isNewUsageMetrics?t.displayName:void 0),r&&(e.isNewUsageMetrics=r.isNewUsageMetrics,e.isUsageMetrics=r.isUsageMetrics)}u=p.explore||(p.explore={}),((e=u.util||(u.util={})).ExplorationTelemetryUtil||(e.ExplorationTelemetryUtil={})).addExplorationInfoToEvent=function(e,t){var r,i,a,o={},n=t.getCurrentSection(),s=t.getCurrentExploration(),l=t.getExplorationTelemetryData();switch(n&&(o={activeSectionId:n.id,sectionGuid:n.objectId,sectionIndex:s&&s.activeSectionIndex},e.name!==p.telemetry.EXOpenExplorationEventName&&e.name!==p.telemetry.EXSwitchSectionEventName&&e.name!==p.telemetry.EXSwitchToAdjacentSectionEventName&&e.name!==p.telemetry.EXNavigateBackEventName&&e.name!==p.telemetry.EXNavigationButtonClickedEventName||(o.visualTypesAndCounts=JSON.stringify(u.util.VisualContainerUtils.getVisualTypesAndCountsFromSection(n)))),l&&(o.modelId=l.modelId,o.reportGuid=l.reportGuid,o.dataCacheMode=l.dataCacheMode,o.datasetHost=l.datasetHost,o.dbName=l.dbName,o.enterpriseCapacitySkuTier=l.enterpriseCapacitySkuTier,o.isDirectQuery=l.isDirectQuery,o.isOnPrem=l.isOnPrem,o.exid=l.exid,o.exsid=l.exsid),e.name){case p.telemetry.EXOpenExplorationEventName:r=o,(i=s)&&!_.isEmpty(i.sections)&&(r.areAnySectionQuickExplore=u.SectionUtils.areAnySectionQuickExplore(i.sections),r.creationSource=i.creationSource),c(o,n,l);break;case p.telemetry.EXSwitchSectionEventName:c(o,n,l)}_.isEmpty(o)||(a=e.formatted||function(){return{}},e.formatted=function(){return p.extendFormatted(a.apply(e),o)})}})(powerbi=powerbi||{}),(function(e){var v;v=e.explore||(e.explore={}),(function(){(v.services||(v.services={})).createFederatedSchemaValidator=function(e){return new t(e)};var t=(e.prototype.validate=function(e){if(e)for(var t=v.util.createNameValidator(e,this.localization),r=0,i=e.schemas;r<i.length;r++){var a=i[r];if(a.isExtensionSchema)for(var o=e.schema(a.extends),n=0,s=a.entities;n<s.length;n++){var l=s[n],p=!1;o.entities.withName(l.name)||(p=!0,l.errorMessage=this.localization.get("ReportMeasuresMissingTableErrorMessage"),l.queryable=1,l.isAbandoned=!0);for(var u=0,c=l.properties;u<c.length;u++){var d,m=c[u];1===m.kind&&((d=t.validateExistingMeasureName(m)).error===v.util.NameValidationError.DuplicatedName?(m.errorMessage=d.reason,m.queryable=1):p&&(m.errorMessage=this.localization.get("ReportMeasuresMissingTableMeasureErrorMessage"),m.queryable=1))}}}},e);function e(e){this.localization=e}})()})(powerbi=powerbi||{}),(function(C){var d;(function(m){var l=C.explore.contracts.CollectedFilterSource,t=C.data.DataViewObjectDescriptors,s=C.data.FilterKindDetector,c=C.visuals.plugins,a=C.explore.util.ScriptVisualsUtil,h=C.data.Selector,n=C.data.SemanticFilter,o=C.data.SemanticQuery,p=C.data.SQExprUtils,y=C.explore.util.VisualContainerUtils;m.createFilterGenerator=function(e,t,r,i,a,o,n,s,l){return new u(e,t,r,i,a,o,n,s)};var u=(e.prototype.collectVisualContainerFilters=function(e,t,r){var i=new m.FilterCollector(this.visualPlugins);i.collectFilters(r.filters,0,r),t&&(i.collectFilters(t.filters,1),this.collectCrossFilter(i,t,r)),this.collectSelfFilter(i,r,null),e&&i.collectFilters(e.filters,2);e=this.hostFilters.getSelectedHostFilters();return e&&i.collectFilters(e.filters,1),i.getCollectedFilters()},e.prototype.collectVisualContainerDrillFilters=function(t){var e=new m.FilterCollector(this.visualPlugins),r=_.filter(t.filters,(function(e){return t.name,null!=e&&2===e.howCreated}));return e.collectFilters(r,0,t),e.getCollectedFilters()},e.prototype.addVisualContainerFilters=function(e,t,r,i,a,o){void 0===o&&(o=!1),e.addCollectedFilters(this.collectVisualContainerFilters(t,r,i),!0,this.getShouldApplyFilter(i,a,r,o)),r&&(this.addHighlightFilter(e,r,i,a),this.addCrossDrillFilters(e,r,i,a))},e.prototype.calculateVisualContainerFilter=function(e,t,r,i,a,o){void 0===a&&(a=!1),void 0===o&&(o=!1);var n=new m.FilterBuilder(r);this.addVisualContainerFilters(n,e,t,r,i,a);o=n.getFilters(o);return o.queryRefsForSingleItemDrillFilters=d.FilterUtils.getQueryRefsForSingleItemDrillFilters(r,i,this.aggrOps),o},e.prototype.calculateDetailVisualFilter=function(e,t,r,i,a){var o=new m.FilterBuilder(r);this.addVisualContainerFilters(o,e,t,r,i),0===a&&(a=1);t=o.getHighlightFilters();t&&(o.clearHighlightFilters(),o.mergeHighlightFiltersBasedOnRelationship(t,a));o=o.getFilters();return o.queryRefsForSingleItemDrillFilters=d.FilterUtils.getQueryRefsForSingleItemDrillFilters(r,i,this.aggrOps),o},e.prototype.clearCrossHighlight=function(e,t,r){e=this.clearCrossHighlightOperation(e);y.notifyVisualContainers(this.eventBridge,e,"UserAction_CrossHighlight",t,r)},e.prototype.clearCrossHighlightForVisualContainers=function(e,t,r,i){t=this.clearCrossHighlightForVisualContainersOperation(e,t);y.notifyVisualContainers(this.eventBridge,t,"UserAction_CrossHighlight",r,i)},e.prototype.clearCrossHighlightForVisualContainersOperation=function(e,t){var r=e.crossFilterSource&&e.crossFilterSource.highlight;if(!_.isEmpty(r)){for(var i=[],a=0,o=_.chain(r).map((function(e){return e.sourceVisualContainer})).filter((function(e){return _.includes(t,e)})).valueOf();a<o.length;a++){var n=o[a],n=this.setCrossHighlightOperation(null,null,e,3,n);i.push.apply(i,n||[])}return _.uniq(i)}},e.prototype.clearFiltersFromVisualContainers=function(e,t,r){var i=this,a=e&&e.crossFilterSource,o=a&&a.drill,n=a&&a.highlight,a=[];!_.isEmpty(n)&&_.some(t,(function(t){return _.some(n,(function(e){return t===e.sourceVisualContainer}))}))&&(a=this.clearCrossHighlightOperation(e)),_.isEmpty(o)||(o=this.clearCrossDrillFromVisualContainersOperation(e,t),a=_.union(a,o)),_.some(t,(function(e){return i.supportsFilterOutput(e)}))?y.notifyVisualContainers(this.eventBridge,e.visualContainers,r):_.isEmpty(a)||y.notifyVisualContainers(this.eventBridge,a,r)},e.prototype.updateCrossHighlightCollectedFilters=function(e,t,r){var i=e&&e.crossFilterSource&&e.crossFilterSource.highlight;!i||(i=_.find(i,(function(e){return e.sourceVisualContainer===r})))&&!_.isEmpty(i.selection)&&(i.collectedFilters=this.collectVisualContainerFilters(t,e,r),y.notifyVisualContainersExceptSource(this.eventBridge,r))},e.prototype.calculateFilterContainerInputFilter=function(e,t,r,i,a){if(r&&t&&a){var o;0===a.scopeType&&(o=a.container);var n=new m.FilterCollector(this.visualPlugins);e&&n.collectFiltersForFilterContainer(e.filters,2,r),1===a.scopeType?(e=5===r.howCreated?_.filter(t.filters,(function(e){return null!=e&&5===e.howCreated})):t.filters,n.collectFiltersForFilterContainer(e,1,r)):2!==a.scopeType&&n.collectFiltersForFilterContainer(t.filters,1,r),this.collectSelfFilter(n,null,r),o&&(n.collectFiltersForFilterContainer(o.filters,0,r,o),this.collectCrossFilter(n,t,o));a=new m.FilterBuilder(o,r);return a.addCollectedFilters(n.getCollectedFilters(),!1,this.getShouldApplyFilterContainerInputFilter(r,o,i,t)),a.getFilters()}},e.prototype.getVisualContainerCrossFilters=function(e,t,r){var i=new m.FilterCollector(this.visualPlugins);this.collectCrossFilter(i,e,t);var a=new m.FilterBuilder(t);return a.addCollectedFilters(i.getCollectedFilters(),!1,this.getShouldApplyFilter(t,r,e)),this.addHighlightFilter(a,e,t,r),this.addCrossDrillFilters(a,e,t,r),{dataFilters:a.getCrossFilters()||[],highlightFilters:a.getHighlightFilters()}},e.prototype.checkSelectionLimit=function(e,t,r,i){i=this.countSelectedDataPoints(e,t,i),r=r.length;return{existingSelectionLength:i,newSelectionLength:r,allowed:!(this.featureSwitchService.featureSwitches.dataPointLassoSelect&&i+r>C.visuals.PlotAreaLassoSelectionLimit)}},e.prototype.logRFilterTelemetry=function(e,t,r,i){t=a.getScriptVisualIdsInSection(t,this.scriptVisuals);_.isEmpty(t)||this.telemetryService.logChildEvent(i&&i.event,e,{filterType:r,visualIds:JSON.stringify(t)})},e.prototype.setCrossHighlightOperation=function(e,t,r,i,a,o,n){var s,l,p=r.crossFilterSource&&r.crossFilterSource.highlight,u=!1;if(a?(u=!0,r.crossFilterSource||(r.crossFilterSource={highlight:[]}),r.crossFilterSource.highlight||(r.crossFilterSource.highlight=[]),s=r.crossFilterSource.highlight,l=void 0,3!==i&&1!==i||!this.newAndPreviousSelectionsSupportMultiVisualSelection(a,s)?(r.crossFilterSource.highlight=s=[],l=0):-1===(l=_.findIndex(s,(function(e){return e.sourceVisualContainer===a})))&&(l=s.length),null==t?(_.isEmpty(s)||((s=__spreadArray([],s||[])).splice(l,1),r.crossFilterSource.highlight=s),a=null):s[l]={sourceVisualContainer:a,selection:t,selectorFilter:h.filterFromSelectorsByColumn(t),collectedFilters:_.isEmpty(t)?[]:this.collectVisualContainerFilters(e,r,a),filterExpressionMetadata:o},this.logRFilterTelemetry(C.telemetry.EXCrossFilterScriptVisual,r,"Highlight",n)):p&&(u=!0,r.crossFilterSource.highlight=void 0),u){var c=r.crossFilterSource&&r.crossFilterSource.highlight;if(!_.isEmpty(p)){for(var d=this,m=0,v=p;m<v.length;m++)!(function(t){-1===_.findIndex(c,(function(e){return e.sourceVisualContainer===t.sourceVisualContainer}))&&y.clearDataSelection(d.eventBridge,t.sourceVisualContainer)})(v[m]);for(var f=0,g=p;f<g.length;f++)if("break"===(function(t){if(t.sourceVisualContainer!==a&&!(-1!==_.findIndex(c,(function(e){return e.sourceVisualContainer===t.sourceVisualContainer}))))return a=null,"break"})(g[f]))break}return _.filter(r.visualContainers,(function(e){return e!==a}))}},e.prototype.newAndPreviousSelectionsSupportMultiVisualSelection=function(e,t){return!!this.supportsMultiVisualSelection(e)&&!(1===t.length&&!this.supportsMultiVisualSelection(t[0].sourceVisualContainer))},e.prototype.supportsMultiVisualSelection=function(e){e=y.getVisualCapabilities(e,this.visualPlugins);return e&&e.supportsMultiVisualSelection},e.prototype.clearCrossHighlightOperation=function(e){if(e.crossFilterSource&&e.crossFilterSource.highlight)return this.setCrossHighlightOperation(null,null,e)},e.prototype.clearCrossDrillFromVisualContainersOperation=function(e,t){if(!_.isEmpty(t)){for(var r=[],i=0,a=t;i<a.length;i++)var o=a[i],o=this.updateCrossDrillFromVisualContainerOperation(e,o,!0),r=_.union(r,o);return r}},e.prototype.updateCrossDrillFromVisualContainerOperation=function(e,t,r){r||_.includes(e.visualContainers,t);var i,a=e.crossFilterSource&&e.crossFilterSource.drill,o=!1;r||(n=this.collectVisualContainerDrillFilters(t),_.isEmpty(n)||(i={sourceVisualContainer:t,collectedFilters:n}));var n=_.findIndex(a,(function(e){return e.sourceVisualContainer===t}));if(0<=n?(o=!0,i?a[n]=i:a.splice(n,1)):i&&(o=!0,e.crossFilterSource||(e.crossFilterSource={}),(e.crossFilterSource.drill||(e.crossFilterSource.drill=[])).push(i)),o)return _.filter(e.visualContainers,(function(e){return e!==t}))},e.prototype.collectSelfFilter=function(e,t,r){var i,a,o=this;!!t?(i=this.getFilterFromFilterPropertyInVisualContainer(t,(function(e){return o.tryGetSelfFilterProperty(e)})))&&((a=n.clone(i)).setIgnoreMParameter(),e.collectFilter(a,null,t,0,l.Self)):(i=this.getFilterFromFilterPropertyInFilterContainer(r,(function(e){return o.tryGetSelfFilterProperty(e)})))&&((a=n.clone(i)).setIgnoreMParameter(),e.collectFilter(a,r,null,0,l.Self))},e.prototype.collectCrossFilter=function(e,t,r){for(var i=this,a=0,o=t.visualContainers;a<o.length;a++){var n,s=o[a];s!==r&&((n=this.getFilterFromFilterPropertyInVisualContainer(s,(function(e,t){return i.tryGetFilterPropertyIdentifier(e,t)})))&&e.collectFilter(n,null,s,0,l.Slicer))}},e.prototype.getFilterFromFilterPropertyUtil=function(e,t,r){e=r(e,t&&t.visualType);if(e){t=t.objects;if(t)return C.data.DataViewObjectDefinitions.getValue(t,e,null)}},e.prototype.getFilterFromFilterPropertyInVisualContainer=function(e,t){var r=y.getVisualCapabilities(e,this.visualPlugins),e=e.config&&e.config.singleVisual;return this.getFilterFromFilterPropertyUtil(r,e,t)},e.prototype.getFilterFromFilterPropertyInFilterContainer=function(e,t){var r=y.getFilterCapabilities(e,this.visualPlugins),e=e.config&&e.config.singleVisual;return this.getFilterFromFilterPropertyUtil(r,e,t)},e.prototype.addHighlightFilter=function(e,t,r,i){var a=t.crossFilterSource&&t.crossFilterSource.highlight;if(!_.isEmpty(a)&&y.getVisualType(r)!==c.slicer.name)for(var o=0,n=a;o<n.length;o++){var s,l,p,u=n[o];u.sourceVisualContainer!==r&&((s=this.buildHighlightFiltersForRelatedTargets(u,i,t))&&(l=this.relationshipService.relationshipFilterAction(t,u.sourceVisualContainer,r,i),p=y.getVisualCapabilities(r,this.visualPlugins),0===l&&(l=this.relationshipService.defaultFilterAction(u.sourceVisualContainer,r)),e.mergeHighlightFiltersBasedOnRelationship(s,l,!p.supportsHighlight)))}},e.prototype.addCrossDrillFilters=function(r,e,t,i){var a=e.crossFilterSource&&e.crossFilterSource.drill;if(!_.isEmpty(a)){for(var o=[],n=0,s=a;n<s.length;n++){var l=s[n],p=l.sourceVisualContainer;if(this.relationshipService.shouldApplyCrossDrill(e,p,t,i)){var u=new m.FilterBuilder(p);u.addCollectedFilters(l.collectedFilters,!1,this.getShouldApplyDrillCrossFilter(p,i,e));u=u.getUnmergedDrillCrossFilter();if(u)for(var c=0,d=u;c<d.length;c++)!(function(t){r.addCrossFilter(t);var e=_.find(l.collectedFilters,(function(e){return e.filter===t.filter}));e&&o.push(e.filterContainer)})(d[c])}}return o}},e.prototype.buildHighlightFiltersForRelatedTargets=function(e,t,r){var i=new m.FilterBuilder(e.sourceVisualContainer);return e.selectorFilter&&i.setSelectorFilter({filter:e.selectorFilter,filterExpressionMetadata:e.filterExpressionMetadata,type:d.contracts.FilterType.Include}),i.addCollectedFilters(e.collectedFilters,!1,this.getShouldApplyHighlightFilter(e.sourceVisualContainer,t,r)),i.getCrossHighlightFilters()},e.prototype.getShouldApplyFilterContainerInputFilter=function(i,a,o,n){var s=this;return function(e,t,r){return s.shouldApplyFilterContainerInputFilter(e,t,r,i,a,o,n)}},e.prototype.shouldApplyFilterContainerInputFilter=function(e,t,r,i,a,o,n){if(t===i)return!0;if(!this.shouldApplyFilter(e,t,r,a,o,n))return!1;t=t&&t.expression;return(!t||!p.isMeasure(t))&&!_.some(e.conditions(),(function(e){return 3===s.runDetector(e)}))},e.prototype.getShouldApplyHighlightFilter=function(i,a,o){var n=this;return function(e,t,r){return n.shouldApplyHighlightFilter(e,t,r,i,a,o)}},e.prototype.getShouldApplyDrillCrossFilter=function(i,a,o){var n=this;return function(e,t,r){return n.shouldApplyDrillCrossFilter(e,t,r,i,a,o)}},e.prototype.shouldApplyHighlightFilter=function(e,t,r,i,a,o){return!!this.shouldApplyFilter(e,t,r,i,a,o)&&!_.some(e.conditions(),(function(e){return 1===s.runDetector(e)}))},e.prototype.shouldApplyDrillCrossFilter=function(e,t,r,i,a,o){return!!this.shouldApplyFilterForCrossDrill(e,t,r,i,a,o)&&!_.some(e.conditions(),(function(e){return 1===s.runDetector(e)}))},e.prototype.getShouldApplyFilter=function(i,a,o,n){var s=this;return void 0===n&&(n=!1),function(e,t,r){return s.shouldApplyFilter(e,t,r,i,a,o,n)}},e.prototype.shouldApplyFilter=function(e,t,r,i,a,o,n){var s=this;return this.shouldApplyFilterInternal(e,t,r,i,a,o,(n=void 0===n?!1:n)?function(){return 1}:function(e,t,r,i){return s.relationshipService.relationshipFilterAction(e,t,r,i)})},e.prototype.shouldApplyFilterForCrossDrill=function(e,t,r,i,a,o){var n=this;return this.shouldApplyFilterInternal(e,t,r,i,a,o,(function(e,t,r,i){return n.relationshipService.drillRelationshipFilterAction(e,t,r,i)}))},e.prototype.shouldApplyFilterInternal=function(e,t,r,i,a,o,n){if(t&&d.FilterUtils.shouldDisableFilter(t,a,r,this.aggrOps,this.visualPlugins))return!1;if(!(_.isEmpty(e.validate(a,this.aggrOps))||r&&r===i))return!1;if(r&&i&&r!==i){if(3===n(o,r,i,a))return!1;r=r.config.singleVisual.syncGroup,i=i.config.singleVisual.syncGroup;if(r&&i&&r.groupName===i.groupName)return!1}return!0},e.prototype.countSelectedDataPoints=function(r,e,t){e=null===(e=e.crossFilterSource)||void 0===e?void 0:e.highlight;return t?_.chain(e).reduce((function(e,t){return e+(t.sourceVisualContainer!==r?t.selection.length:0)}),0).value():0},e.prototype.setMultipleFiltersOnSelectData=function(e,t,r,i,a){for(var o=this.clearCrossHighlightOperation(t),n=0,s=r;n<s.length;n++)var l=s[n],o=_.union(o,this.setCrossHighlightOperation(e,l.selection,t,3,l.sourceVisualContainer,l.filterExpressionMetadata));y.notifyVisualContainers(this.eventBridge,o,"UserAction_CrossHighlight",i,a)},e.prototype.setFilterOnSelectData=function(e,t,r,i,a,o,n,s){this.supportsFilterOutput(i)?this.logRFilterTelemetry(C.telemetry.EXCrossFilterScriptVisual,r,"Data",a):(s=this.setCrossHighlightOperation(e,t,r,n,i,s,a),y.notifyVisualContainers(this.eventBridge,s,"UserAction_CrossHighlight",a,o))},e.prototype.updateCrossFilterOnDrill=function(e,t){t=this.updateCrossDrillFromVisualContainerOperation(e,t,!1);y.notifyVisualContainers(this.eventBridge,t)},e.prototype.updateCrossDrillFromVisualContainers=function(e,t){t=this.updateCrossDrillFromVisualContainersOperation(e,t);y.notifyVisualContainers(this.eventBridge,t)},e.prototype.updateCrossDrillFromVisualContainersOperation=function(e,t){if(!_.isEmpty(t)){for(var r=[],i=0,a=t;i<a.length;i++)var o=a[i],o=this.updateCrossDrillFromVisualContainerOperation(e,o,!1),r=_.union(r,o);return r}},e.prototype.updateCrossDrillOfSection=function(e){e=this.updateCrossDrillOfSectionOperation(e);y.notifyVisualContainers(this.eventBridge,e)},e.prototype.updateCrossDrillOfSectionOperation=function(e){return this.updateCrossDrillFromVisualContainersOperation(e,e.visualContainers)},e.prototype.getDrillCrossFiltersToApply=function(e,t,r){var i=new m.FilterBuilder(t);return this.addCrossDrillFilters(i,e,t,r)},e.prototype.supportsFilterOutput=function(e){return d.FilterUtils.supportsFilterOutput(y.getVisualCapabilities(e,this.visualPlugins))},e.prototype.tryGetFilterPropertyIdentifier=function(e,t){return d.FilterUtils.tryGetFilterPropertyIdentifier(e,t,this.visualPlugins)},e.prototype.tryGetSelfFilterEnabledProperty=function(e){if(e)return t.findSelfFilterEnabled(e.objects)},e.prototype.tryGetSelfFilterProperty=function(e){if(e)return t.findSelfFilter(e.objects)},e.prototype.resolveFilterTargets=function(e,t,r,i,a){if(!o.willFiltersAffectQuery(t.defn))return t.defn;e={dataRoles:r,mappings:i,queryProjections:t.projections,select:t.defn.select(),schema:e},e=new m.VisualFilterMappingResolver(e),t=t.defn;return a&&(t=t.addSemanticFilter(a)),e.resolveSemanticQuery(t)},e.prototype.applyFilterOutput=function(e){this.supportsFilterOutput(e)&&y.notifyVisualContainersExceptSource(this.eventBridge,e)},e);function e(e,t,r,i,a,o,n,s){this.eventBridge=e,this.visualPlugins=t,this.aggrOps=r,this.relationshipService=i,this.hostFilters=a,this.telemetryService=o,this.scriptVisuals=n,this.featureSwitchService=s,this.eventBridge,this.visualPlugins,this.aggrOps,this.relationshipService,this.hostFilters,this.telemetryService,this.scriptVisuals}})((d=C.explore||(C.explore={})).services||(d.services={}))})(powerbi=powerbi||{}),(function(e){var u,c,h,y,d,t,r;u=e.explore||(e.explore={}),c=u.services||(u.services={}),h=e.data.DataViewObjectDefinition,y=e.data.DataViewObjectDefinitions,d=e.data.SQExpr,t=e.explore.contracts.VisualContainer,r=e.explore.contracts.VisualContainerGroup,(function(e){function a(e){return"visualContainer"===e.canvasItemType}function o(e){return"group"===e.canvasItemType}e.isVisualContainerFormat=a,e.isGroupFormat=o,e.copyFormatCanvasItem=function(e,t,r,i){var a=c.selectionUtils.getSelectedCanvasItem(e);if(a){if(!u.contracts.isVisualContainer(a))return{canvasItemType:"group",objects:a.objects};var o=a,e=o.config.singleVisual.visualType;if(!t.isCustomVisual(e)){a=o.config.singleVisual,t=a.vcObjects,o=y.getValue(t,{objectName:"stylePreset",propertyName:"name"},void 0),o=i.getVisualObjects(r,e,o&&d.isConstant(o)&&o.value,u.contracts.VisualContainer.CommonObjectDescriptors);return o&&(t=y.clone(t||{}),y.extend(t,o,!0)),{canvasItemType:"visualContainer",visualType:a.visualType,objects:a.objects,vcObjects:t}}}};var n=t.CommonObjectDescriptors,s=r.objectDescriptors;function l(e,t,r){var i=r.config.singleVisual,r=e.capabilities(i.visualType),e=e.capabilities(t.visualType);r&&e&&(i.objects=p(r.objects,e.objects,t.objects,i.objects)),i.vcObjects=p(n,n,t.vcObjects,i.vcObjects)}function p(e,t,r,i){if(r===i)return i;for(var a in i=i||{},e){var o=e[a],n=t[a];if(n&&!o.suppressFormatPainterCopy&&!n.suppressFormatPainterCopy){var s,l=r&&r[a],p=i&&i[a];for(s in o.properties){var u=o.properties[s],c=n.properties[s];if(c&&!u.suppressFormatPainterCopy&&!c.suppressFormatPainterCopy&&_.isEqual(u.type,c.type)){if(p)for(var d=0,m=p;d<m.length;d++){var v=m[d];h.deleteSingleProperty(v,s)}if(l)for(var f=0,g=l;f<g.length;f++)(v=g[f]).properties[s]&&(y.ensure(i,a,v.selector).properties[s]=v.properties[s])}}}}return y.reduce(i)}e.pasteFormatCanvasItem=function(e,t,r){var i=c.selectionUtils.getSelectedCanvasItem(e);if(i&&r)return u.contracts.isVisualContainer(i)?a(r)?l(t,r,i):o(r)&&((e=i.config.singleVisual).vcObjects=p(n,s,r.objects,e.objects)):a(r)?u.contracts.traverseVisualContainerGroups([i],(function(e){u.contracts.isVisualContainer(e)&&l(t,r,e)})):o(r)&&(i.objects=p(s,s,r.objects,i.objects)),i},e.copyFormatObjects=p})(c.FormatPainter||(c.FormatPainter={}))})(powerbi=powerbi||{}),(function(e){var r;r=e.explore||(e.explore={}),(function(){(r.services||(r.services={})).createRunningVisualService=function(){return new e};var e=(t.prototype.getVisual=function(e){e&&e.name;var t=this.runningVisuals[e.name];if(null!=t&&t.contract===e)return t.visual},t.prototype.setVisual=function(e,t){e&&e.name,this.runningVisuals[e.name]={contract:e,visual:t}},t.prototype.removeVisual=function(e){e&&e.name,delete this.runningVisuals[e.name]},t);function t(){this.runningVisuals={}}})()})(powerbi=powerbi||{}),(function(e){var r;r=e.explore||(e.explore={}),(function(){(r.services||(r.services={})).createServicePauser=function(){return new e};var e=(t.prototype.register=function(e){e=jQuery.extend(!0,{},e);return this.updateService(e),e},t.prototype.pause=function(){this.isPaused=!0},t.prototype.resume=function(){this.isPaused=!1},t.prototype.updateService=function(i){var e,a=this;for(e in i)!(function(e){var t,r;_.isFunction(i[e])&&(t=i[e],r=a,i[e]=function(){if(!r.isPaused)return t.apply(i,arguments)})})(e)},t);function t(){this.isPaused=!1}})()})(powerbi=powerbi||{}),(function(r){var e;(function(e){var u,a=r.data.DataViewObjectDefinitions,p=r.visualHost.ResourcePackageReferenceResolver,l=r.visualHost.utils.ResourcePackageUtils,o=r.data.SQExpr,i=jsCommon.UrlUtils;function n(e,t,r){return e[t]||(e[t]={items:{},name:t,type:r}),e[t]}function s(e,t,r,i,a){r=n(e,t,r).items;return r[i]=r[i]||{name:i,type:a}}e.createStaticResourceReferenceService=function(e,t,r,i,a){return new c(e,t,r,i,a)},(e=u=e.StaticResourceReferences||(e.StaticResourceReferences={})).addObjectsReferences=function(e,t,r,i){e&&a.visitPropertyExprs({definitions:e,descriptors:t,visitor:function(e){var t;o.isResourcePackageItem(e)&&(t=l.findResourcePackage(r,e.packageType,e.packageName),(e=l.findItemInPackage(t,e.itemName))&&s(i,t.name,t.type,e.name,e.type))}})},e.ensurePackageReference=n,e.addItemReference=s,e.findItem=function(e,t,r){return(t=e[t])&&t.items&&t.items[r]},e.eraseItem=function(e,t,r){var i=e[t];i&&(delete(i=i.items)[r],0===_.size(i)&&delete e[t])},e.visitItemReferences=function(e,t){for(var r in e){var i,a=e[r];for(i in a.items)t(a,a.items[i])}};var c=(t.prototype.addReferenceSource=function(e){this.restorableReferenceSources.push(e)},t.prototype.removeReferenceSource=function(e){_.pull(this.restorableReferenceSources,e)},t.prototype.garbageCollectUnreferencedStaticResources=function(){var e=this.explorationNavigation.getCurrentExploration(),t=e&&e.resourcePackages;if(t){for(var r=this.explorationSerializer.getReferencedStaticResources(e),i=this.getRestorableReferences(),a=[],o=t.length-1;0<=o;o--){var n=t[o];l.isStaticResource(n)&&(this.garbageCollectItems(n,r,this.preservedReferences,i,a),_.isEmpty(n.items)&&_.pull(t,n))}return _.isEmpty(t)&&delete e.resourcePackages,this.cleanPreservedReferences(r,i),a}},t.prototype.cleanPreservedReferences=function(r,i){var a=this;u.visitItemReferences(this.preservedReferences,(function(e,t){!u.findItem(r,e.name,t.name)&&u.findItem(i,e.name,t.name)||u.eraseItem(a.preservedReferences,e.name,t.name)}))},t.prototype.getRestorableReferences=function(){for(var r={},e=0,t=this.restorableReferenceSources;e<t.length;e++){var i=t[e];u.visitItemReferences(i.getReferences(),(function(e,t){u.addItemReference(r,e.name,e.type,t.name,t.type)}))}return r},t.prototype.garbageCollectItems=function(e,t,r,i,a){for(var o=e.items,n=e.name,s=_.size(o)-1;0<=s;s--){var l=o[s],p=l.name;u.findItem(t,n,p)||(u.findItem(i,n,p)&&this.preserveItem(e,p,l.type),a.push(n+"/"+l.path),_.pull(o,l))}},t.prototype.preserveItem=function(e,t,r){r=u.addItemReference(this.preservedReferences,e.name,e.type,t,r);r.uri||(r.uri=p.loadAndResolveContent(e,t,this.resourceLoader,this.promiseFactory).then((function(e){return e=!i.isDataUri(e)?i.makeJsonDataUri(e):e})))},t.prototype.loadItemsContent=function(e){var t,r=[],i=this.explorationNavigation.getCurrentExploration(),a=i&&i.resourcePackages;for(t in e){var o=e[t];if(1===o.type){var n,s=o.items,l=this;for(n in s)!(function(e){var t=s[e];r.push(p.loadRegisteredResourceAsDataUri(l.promiseFactory,l.resourceLoader,a,t.name).then((function(e){t.content=e})))})(n)}}return this.promiseFactory.all(r).then((function(){}))},t.prototype.addItemsContent=function(e){var t,r=this.explorationNavigation.getCurrentExploration();for(t in e){var i,a=e[t],o=a.items;for(i in o){var n=o[i];this.addResource(r.resourcePackages,t,a.type,n.name,n.type,n.content)}}},t.prototype.needingRestore=function(e){var o=this;if(!_.isEmpty(e)){var t=this.explorationNavigation.getCurrentExploration();if(t){var n=t&&t.resourcePackages;if(!_.isEmpty(n)){var s={};return u.visitItemReferences(e,(function(e,t){var r=e.name,i=t.name,a=u.findItem(o.preservedReferences,r,i);a&&!l.findItemInPackages(n,e.type,t.name,r)&&(u.ensurePackageReference(s,r,e.type).items[i]=a)})),s}}}},t.prototype.addResource=function(e,t,r,i,a,o){l.findItemInPackages(e,r,i,t)||this.resourceRegistration.add(i,r,a,{content:o,skipUniqueName:!0})},t.prototype.restoreReferences=function(e){var i=this,e=this.needingRestore(e),a=[];return u.visitItemReferences(e,(function(t,r){a.push(r.uri.then((function(e){i.resourceRegistration.restore(r.name,t.type,r.type,e)})))})),this.promiseFactory.all(a).then((function(){}))},t);function t(e,t,r,i,a){this.promiseFactory=e,this.resourceLoader=t,this.explorationNavigation=r,this.explorationSerializer=i,this.resourceRegistration=a,this.restorableReferenceSources=[],this.preservedReferences={}}})((e=r.explore||(r.explore={})).services||(e.services={}))})(powerbi=powerbi||{}),(function(r){var e;(function(e){var o=jsCommon.FileUtils,n=r.visualHost.ResourcePackageReferenceResolver,s=r.explore.util.ResourcePackageUtils,l=r.visualHost.utils.ResourcePackageUtils,p=r.data.SQExprBuilder,u=jsCommon.UrlUtils;e.createResourceRegistrationService=function(e,t,r,i){return new a(e,t,r,i)};var a=(t.prototype.addResource=function(t,e,r,i){var a,o=this;return 1===t.type?(l.findItemInPackage(t,e),a={type:r,path:e,name:e,content:i}):2===t.type&&(l.findItemInPackage(t,e)||(a=s.newSharedResourceItem(e,r,i))),a&&(t.items.push(a),(_.isEmpty(i)?(t.type,n.loadAndResolveContent(t,e,this.resourceLoader,this.promiseFactory).then((function(e){return e=!u.isDataUri(e)?u.utoa(e):e}))):this.promiseFactory.resolve(u.getBase64ContentFromDataUri(i))).then((function(e){o.resourcePublishingService.publish(t.name,a.path,e)}))),p.resourcePackageItem(t.name,t.type,e)},t.prototype.restore=function(t,e,r,i){t.length;e=this.ensureResourcePackageExists(e);_.find(e.items,(function(e){return e.name===t}))||this.addResource(e,t,r,i)},t.prototype.add=function(e,t,r,i){e.length;var a=this.ensureResourcePackageExists(t);return 1!==t||i&&i.skipUniqueName||(e=this.getUniqueName(e,a)),this.addResource(a,e,r,i&&i.content)},t.prototype.getUniqueName=function(e,t){var e=e.replace(/[^a-zA-Z0-9:@\-._~!$&'()*+,;=]/g,"_"),r=o.getFileWithoutExtension(e),i=(i=o.getFileExtension(e))&&"."+i,r=r.substr(0,30);for(i=i.substr(0,11);;){var a=r+Math.random().toString().substr(2)+i;if(!_.find(t.items,(function(e){return e&&e.name&&e.name.toUpperCase()===a.toUpperCase()})))break}return a},t.prototype.ensureResourcePackageExists=function(e){var t=this.explorationNavigationService.getCurrentExploration();return s.ensureResourcePackageType(t,e)},t);function t(e,t,r,i){this.explorationNavigationService=e,this.promiseFactory=t,this.resourceLoader=r,this.resourcePublishingService=i}})((e=r.explore||(r.explore={})).services||(e.services={}))})(powerbi=powerbi||{}),(function(p){var e,a,t,r,i,o;function u(e){return Math.round(100*jsCommon.PixelConverter.toPoint(e))/100}function n(e,t){var r=c(e,t.objectName);!r||(e=r[t.propertyName])&&(s(e)?r[t.propertyName]=d(e):(e=i.deserializeExpr(e.expr),r[t.propertyName]=l(d(e))))}function c(e,t){if(e){t=e[t];if(t)for(var r=0,i=t;r<i.length;r++){var a=i[r];if(null==a.selector)return a.properties}}}function s(e){return e instanceof p.data.SQExpr&&p.data.SQExpr.isConstant(e)}function l(e){return{expr:i.serializeExpr(e)}}function d(e){e=u(e.value);return o.decimal(e)}function m(e){return Math.round(100*jsCommon.PixelConverter.fromPointToPixel(e))/100}e=(e=(e=p.explore||(p.explore={})).services||(e.services={})).upgrade||(e.upgrade={}),a=e.UpgradeUtils||(e.UpgradeUtils={}),t=p.visuals.fillStyle,r=p.visuals.outline,i=p.data.services.SemanticQuerySerializer,o=p.data.SQExprBuilder,a.pxToPt=u,a.convertAxisScaleProperty=function(e){return void 0!==e&&"log"===e},a.convertAxisPositionProperty=function(e){return void 0!==e&&"Right"===e},a.convertScatterChartFillPoint=function(e){return e?t.fillOnly:t.borderOnly},a.convertSuppressDefaultTooltip=function(e){return!e},a.convertOutlineValue=function(e){switch(e){case r.none:return 0;case r.topOnly:return 1;case r.bottomOnly:return 4;case r.leftOnly:return 8;case r.rightOnly:return 2;case r.topBottom:return 5;case r.leftRight:return 10;case r.frame:return 15;default:return 0}},a.pxToPtUpgrader=function(e){switch(typeof e){case"string":e=+e;case"number":return isNaN(e),u(e);default:return e}},a.updateSingleVisualConfigPxToPt=function(e){var t;e&&(e.objects&&(function(e){if(e)for(var t=0,r=a.visualPropertiesToUpdate;t<r.length;t++){var i=r[t];n(e,i)}})(e.objects),e.vcObjects&&(t=e.vcObjects)&&(!(e=t.visualTooltip&&t.visualTooltip[0]&&t.visualTooltip[0].properties)||(t=e.fontSize)&&(s(t)?e.fontSize=d(t):(t=i.deserializeExpr(t.expr),e.fontSize=l(d(t))))))},a.updateSingleVisualConfigTextboxPxToPt=function(e){e&&e.objects&&e.visualType===p.visuals.plugins.textbox.name&&(function(e){if(e){e=c(e,"general");if(e)for(var e=e.paragraphs,t=0,r=e;t<r.length;t++)for(var i=r[t],a=0,o=i.textRuns;a<o.length;a++){var n,s,l=o[a];p.ParagraphsDefinition.isTextRunDefinition(l)&&l.textStyle&&l.textStyle.fontSize&&(n=l.textStyle.fontSize,-1!==(s=n.indexOf("px"))&&(s=+n.substr(0,s),l.textStyle.fontSize=u(s)+"pt"))}}})(e.objects)},a.visualPropertiesToUpdate=[{objectName:"valueAxis",propertyName:"fontSize"},{objectName:"valueAxis",propertyName:"titleFontSize"},{objectName:"valueAxis",propertyName:"secFontSize"},{objectName:"valueAxis",propertyName:"secTitleFontSize"},{objectName:"categoryAxis",propertyName:"fontSize"},{objectName:"categoryAxis",propertyName:"titleFontSize"}],a.visualContainerPropertiesToUpdate=[{objectName:"visualTooltip",propertyName:"fontSize"}],a.upgradePropertyFromPxToPt=n,a.toExpr=l,a.pxToPtExpr=d,a.ptToPxWireExpr=function(e){return e=m(+i.deserializeExpr(e.expr).value),{expr:i.serializeExpr(o.decimal(e))}},a.ptToPx=m})(powerbi=powerbi||{}),(function(e){var t,r,i;t=e.explore||(e.explore={}),r=t.services||(t.services={}),e=r.upgrade||(r.upgrade={}),(r=t=e.ExplorationStateVersions||(e.ExplorationStateVersions={})).v1_0="1.0",r.v1_1="1.1",r.v1_2="1.2",r.v1_3="1.3",r.v1_4="1.4",r.v1_5="1.5",r.v1_6="1.6",r.v1_7="1.7",r.v1_8="1.8",r.v1_9="1.9",r.v1_10="1.10",r.v1_11="1.11",r.v1_12="1.12",r.v1_13="1.13",r.v1_14="1.14",r.v1_15="1.15",(i=e.ExplorationStateFeatureVersions||(e.ExplorationStateFeatureVersions={})).AllowMobileVisualFormatting=t.v1_8,i.FieldParameters=t.v1_11,i.OnObject=t.v1_15,i.setAllowMobileVisualFormatting=function(e){i.AllowMobileVisualFormatting=e}})(powerbi=powerbi||{}),(function(F){var j,e;j=F.explore||(F.explore={}),(function(u){var e=F.visuals.AnomalyDetectionObjectConstants,t=F.visuals.AnomalyDetectionVisualPlugin,c=F.data.DataViewObjectDefinitions,r=F.visuals.legendPosition,l=F.data.ObjectPropertyVersionWildcard,i=F.visuals.plugins,a=F.data.Selector,o=F.data.SQConstantExpr,n=F.data.SQExpr,s=F.visuals.standardGeoJson,d=jsCommon.Version,p=j.contracts.VisualLink,m=j.contracts.VisualTooltip;u.ExplorationVersions={v1_0:"1.0",v2_0:"2.0",v2_2:"2.2",v2_3:"2.3",v2_5:"2.5",v3_0:"3.0",v3_1:"3.1",v3_2:"3.2",v3_3:"3.3",v3_4:"3.4",v3_5:"3.5",v3_6:"3.6",v3_6_1:"3.6.1",v3_7:"3.7",v3_8:"3.8",v3_9:"3.9",v3_10:"3.10",v3_11:"3.11",v3_12:"3.12",v3_12_1:"3.12.1",v3_13:"3.13",v3_14:"3.14",v3_14_1:"3.14.1",v3_15:"3.15",v3_16:"3.16",v3_17:"3.17",v3_18:"3.18",v3_19:"3.19",v3_20:"3.20",v3_21:"3.21",v3_22:"3.22",v3_23:"3.23",v3_24:"3.24",v4_0:"4.0",v4_1:"4.1",v4_2:"4.2",v5_0:"5.0",v5_1:"5.1",v5_2:"5.2",v5_3:"5.3",v5_4:"5.4",v5_5:"5.5",v5_6:"5.6",v5_7:"5.7",v5_8:"5.8",v5_9:"5.9",v5_10:"5.10",v5_11:"5.11",v5_12:"5.12",v5_13:"5.13",v5_14:"5.14",v5_15:"5.15",v5_16:"5.16",v5_17:"5.17",v5_18:"5.18",v5_19:"5.19",v5_20:"5.20",v5_21:"5.21",v5_22:"5.22",v5_23:"5.23",v5_24:"5.24",v5_25:"5.25",v5_26:"5.26",v5_27:"5.27",v5_28:"5.28",v5_29:"5.29",v5_30:"5.30",v5_31:"5.31",v5_32:"5.32",v5_33:"5.33",v5_34:"5.34",v5_35:"5.35",v5_36:"5.36"},u.SQExprVersions={},u.SQExprVersions[41]=u.ExplorationVersions.v3_5,u.SQExprVersions[42]=u.ExplorationVersions.v3_7,u.SQExprVersions[33]=u.ExplorationVersions.v3_8;var v,f=(v=F.data.DefaultSQExprVisitorWithTraversal,__extends(g,v),g.prototype.visitAllRolesRef=function(e){this.highestVersion=d.max(this.highestVersion,u.ExplorationVersions.v5_1),v.prototype.visitAllRolesRef.call(this,e)},g.prototype.visitRangePercent=function(e){this.highestVersion=d.max(this.highestVersion,u.ExplorationVersions.v5_1),v.prototype.visitRangePercent.call(this,e)},g.prototype.visitArithmetic=function(e){n.isScopedEval(e.right)||(this.highestVersion=d.max(this.highestVersion,u.ExplorationVersions.v5_15)),v.prototype.visitArithmetic.call(this,e)},g.prototype.visitSparklineData=function(e){this.highestVersion=d.max(this.highestVersion,h.Sparklines),v.prototype.visitSparklineData.call(this,e)},g);function g(e){var t=v.call(this)||this;return t.highestVersion=e,t}var h,y=(C.getVersionForSQExpr=function(e){var t=u.SQExprVersions[e.kind]||d.ZeroStr,r=new f(t);return e.accept(r),r.highestVersion},C.getVersionForSQExprWithDescriptor=function(e,t){var r=this.getVersionForSQExpr(e);return r=t&&t.fill&&t.fill.solid&&t.fill.solid.color?d.max(r,this.getVersionForFillDefinition(e)):r},C.getVersionForFillDefinition=function(e){if(n.isFillRule(e)&&e.input&&!n.isSelectRef(e.input))return h.ConditionalFormattingSource;if(n.isConditional(e)){var t=function(e){return n.isCompare(e)&&!n.isSelectRef(e.left)};if(_.some(e.cases,(function(e){return e=e.condition,!!t(e)||!(!n.isAnd(e)||!t(e.left)&&!t(e.right))})))return h.ConditionalFormattingSource}return n.isMeasure(e)||n.isAggregation(e)?h.ConditionalFormattingByValue:d.ZeroStr},C.getVersionForSortDefinitions=function(e){if(!_.isEmpty(e))for(var t=0,r=e;t<r.length;t++){var i=r[t];if(n.isScopedEval(i.expr))return u.ExplorationVersions.v5_23}return d.ZeroStr},C.getVersionForVisualContainerGroup=function(e){return e.objects&&void 0!==e.objects.lockAspect?h.VisualContainerGroupLockAspect:h.VisualContainerGrouping},C);function C(){}u.ExplorationVersionHelper=y,(x=h=u.ExplorationFeatureVersions||(u.ExplorationFeatureVersions={})).bookmarks=u.ExplorationVersions.v3_6,x.visualHidden=u.ExplorationVersions.v3_6,x.slowDataSource=u.ExplorationVersions.v3_7,x.ExplorationState_v1_1=u.ExplorationVersions.v3_8,x.description=u.ExplorationVersions.v3_8,x.BookmarkOptions=u.ExplorationVersions.v3_8,x.SectionCrossDrill=u.ExplorationVersions.v3_8,x.SectionVisibility=u.ExplorationVersions.v3_9,x.ExplorationState_v1_2=u.ExplorationVersions.v3_10,x.VisualSyncGroup=u.ExplorationVersions.v3_11,x.ExplorationSettings=u.ExplorationVersions.v3_11,x.CanvasTooltips=u.ExplorationVersions.v3_12,x.ActionButton=u.ExplorationVersions.v3_13,x.QnaLink=u.ExplorationVersions.v3_13,x.ConditionalFormattingSource=u.ExplorationVersions.v3_14,x.MeasureDrillthrough=u.ExplorationVersions.v3_14,x.OutspaceFormatting=u.ExplorationVersions.v3_15,x.StylableVisualContainerHeader=u.ExplorationVersions.v3_15,x.BookmarkGroup=u.ExplorationVersions.v3_17,x.ConditionalFormattingByValue=u.ExplorationVersions.v3_17,x.BuiltInThemes=u.ExplorationVersions.v3_18,x.DotPlotVisual=u.ExplorationVersions.v3_18,x.ExportDataMode=u.ExplorationVersions.v3_19,x.ExpandCollapse=u.ExplorationVersions.v3_20,x.CartesianConditionalFormatting=u.ExplorationVersions.v3_20,x.FilterContainerVisibilityControl=u.ExplorationVersions.v3_20,x.OutspacePaneFormatting=u.ExplorationVersions.v3_20,x.ExplorationState_v1_3=u.ExplorationVersions.v3_20,x.NewFilterPaneExperience=u.ExplorationVersions.v3_20,x.VisualTabOrders=u.ExplorationVersions.v3_21,x.VisualLinkTooltip=u.ExplorationVersions.v3_21,x.FilterRequireSingleSelect=u.ExplorationVersions.v3_21,x.DefaultFilterAction=u.ExplorationVersions.v3_22,x.KeyDriversVisual=u.ExplorationVersions.v3_22,x.TitleWordWrap=u.ExplorationVersions.v3_22,x.VisualBorderRadius=u.ExplorationVersions.v3_22,x.WebUrlAction=u.ExplorationVersions.v3_23,x.StrictSingleSelect=u.ExplorationVersions.v3_23,x.DefaultTooltipFormatting=u.ExplorationVersions.v3_23,x.DisplayAreaVerticalAlignment=u.ExplorationVersions.v3_23,x.FilterContainerFilterMetadata=u.ExplorationVersions.v3_23,x.FiltersSort=u.ExplorationVersions.v3_23,x.CrossReportDrillthrough=u.ExplorationVersions.v3_24,x.AllowChangeFilterTypes=u.ExplorationVersions.v3_24,x.RenameFilters=u.ExplorationVersions.v3_24,x.ExpressionBoundVisualTitles=u.ExplorationVersions.v4_0,x.ColorConditionalFormatting=u.ExplorationVersions.v4_2,x.VisualLevelSlicerFilters=u.ExplorationVersions.v4_2,x.GaugeConditionalFormatting=u.ExplorationVersions.v4_2,x.VisualHeaderTooltip=u.ExplorationVersions.v4_2,x.ExplorationState_v1_4=u.ExplorationVersions.v4_2,x.ReportAnnotations=u.ExplorationVersions.v4_2,x.ExpressionBoundVisualBackground=u.ExplorationVersions.v5_0,x.KeyDriversCounting=u.ExplorationVersions.v5_1,x.KeyDriversDetails=u.ExplorationVersions.v5_2,x.MigrateFilterPaneExperience=u.ExplorationVersions.v5_2,x.VisualContainerGrouping=u.ExplorationVersions.v5_2,x.ExpressionBoundBorderColor=u.ExplorationVersions.v5_3,x.ExpressionBoundAltText=u.ExplorationVersions.v5_3,x.ExpressionBoundGaugeColors=u.ExplorationVersions.v5_3,x.AutomaticPageRefresh=u.ExplorationVersions.v5_4,x.ExpressionBoundActions=u.ExplorationVersions.v5_5,x.AdditionalKPISettings=u.ExplorationVersions.v5_6,x.FilterPaneSearchBoxFormatting=u.ExplorationVersions.v5_7,x.VisualFilterExpressionMetadata=u.ExplorationVersions.v5_8,x.DisableFilterPaneSearch=u.ExplorationVersions.v5_8,x.DecompTreeBarsPerLevel=u.ExplorationVersions.v5_8,x.HierarchicalSlicer=u.ExplorationVersions.v5_8,x.LineChartDualAxis=u.ExplorationVersions.v5_8,x.ChangeDetectionRefresh=u.ExplorationVersions.v5_9,x.FilterPaneHiddenInEditMode=u.ExplorationVersions.v5_9,x.AllowInlineExploration=u.ExplorationVersions.v5_9,x.RelativeTimeFilter=u.ExplorationVersions.v5_9,x.LinguisticSchemaSyncVersion=u.ExplorationVersions.v5_9,x.FilterSelectAll=u.ExplorationVersions.v5_9,x.ApplyAll=u.ExplorationVersions.v5_10,x.KpiScalingIndicatorIcon=u.ExplorationVersions.v5_10,x.LineChartExplicitDots=u.ExplorationVersions.v5_11,x.BingMapStyling=u.ExplorationVersions.v5_11,x.ConditionalParagraphs=u.ExplorationVersions.v5_12,x.DecompositionTreeVisual=u.ExplorationVersions.v5_12,x.GradientLegend=u.ExplorationVersions.v5_13,x.QnaWarningUnderlineColor=u.ExplorationVersions.v5_13,x.SlicerHeaderText=u.ExplorationVersions.v5_13,x.QnaActionButtonsColor=u.ExplorationVersions.v5_14,x.DropShadow=u.ExplorationVersions.v5_14,x.PersonalizeVisualPerspective=u.ExplorationVersions.v5_14,x.GeneralizedArithmetic=u.ExplorationVersions.v5_15,x.PersonalizeVisualPerspectiveToggle=u.ExplorationVersions.v5_15,x.KeepLayerOrder=u.ExplorationVersions.v5_15,x.PagesPosition=u.ExplorationVersions.v5_15,x.NarrativeVisual=u.ExplorationVersions.v5_15,x.StackedTotalDataLabels=u.ExplorationVersions.v5_15,x.SerializationOptimization=u.ExplorationVersions.v5_16,x.FilterPaneCheckboxAndApplyColor=u.ExplorationVersions.v5_16,x.AnomalyDetection=u.ExplorationVersions.v5_16,x.CartesianSmallMultiples=u.ExplorationVersions.v5_16,x.AxisZoom=u.ExplorationVersions.v5_16,x.DecompositionInsights=u.ExplorationVersions.v5_16,x.AzureMapConditionalColor=u.ExplorationVersions.v5_16,x.QuickExplore=u.ExplorationVersions.v5_17,x.IsEmptyFilterOperator=u.ExplorationVersions.v5_18,x.CartesianSmallMultiplesGridlines=u.ExplorationVersions.v5_18,x.MapGeocodingCulture=u.ExplorationVersions.v5_18,x.CartesianSmallMultiplesSubheaderFormatting=u.ExplorationVersions.v5_19,x.AzureMapSelectionControl=u.ExplorationVersions.v5_19,x.VisualContainerGroupLockAspect=u.ExplorationVersions.v5_19,x.lineChartVerticalReferenceLine=u.ExplorationVersions.v5_19,x.CartesianSmallMultiplesPadding=u.ExplorationVersions.v5_20,x.CartesianSmallMultiplesCombo=u.ExplorationVersions.v5_20,x.ShapeVisual=u.ExplorationVersions.v5_20,x.InvertAxis=u.ExplorationVersions.v5_20,x.EnhancedTooltips=u.ExplorationVersions.v5_21,x.ShowLassoButton=u.ExplorationVersions.v5_21,x.RdlVisual=u.ExplorationVersions.v5_22,x.ShapeMapFranceUpdatedRegions=u.ExplorationVersions.v5_22,x.LineChartExplicitDotsDefault=u.ExplorationVersions.v5_22,x.SmallMultiplesResponsive=u.ExplorationVersions.v5_22,x.EnhancedTooltipsForVisualHeaderTooltip=u.ExplorationVersions.v5_22,x.AreaChartTransparency=u.ExplorationVersions.v5_22,x.QuickExploreLayout=u.ExplorationVersions.v5_23,x.ConditionalFormattingUpdates=u.ExplorationVersions.v5_23,x.SuppressDefaultTooltip=u.ExplorationVersions.v5_23,x.ShapeFormattingFeatures=u.ExplorationVersions.v5_24,x.XAxisRefLineImprovements=u.ExplorationVersions.v5_24,x.AccessibilityTopLevelNav=u.ExplorationVersions.v5_24,x.GokSupportForCV=u.ExplorationVersions.v5_24,x.ButtonTileFormatting=u.ExplorationVersions.v5_25,x.LineChartSeriesLabels=u.ExplorationVersions.v5_25,x.WaterfallChartTotals=u.ExplorationVersions.v5_25,x.AzureMapHeatmapLayer=u.ExplorationVersions.v5_26,x.AllowAutomatedInsightsNotification=u.ExplorationVersions.v5_26,x.NavigatorVisuals=u.ExplorationVersions.v5_27,x.PieChartMarginBetweenSlices=u.ExplorationVersions.v5_27,x.TextboxSuperSubScriptBulletedList=u.ExplorationVersions.v5_27,x.BoldItalicUnderlineComponent=u.ExplorationVersions.v5_27,x.DonutChartStartAngle=u.ExplorationVersions.v5_27,x.ScorecardVisual=u.ExplorationVersions.v5_27,x.AzureMapHeatmapOpacityToTransparency=u.ExplorationVersions.v5_28,x.RdlVisualToolbarConfig=u.ExplorationVersions.v5_28,x.ScorecardCommandBarToggle=u.ExplorationVersions.v5_28,x.Sparklines=u.ExplorationVersions.v5_28,x.AllowMobileVisualFormatting=u.ExplorationVersions.v5_29,x.AzureMapsGeocoding=u.ExplorationVersions.v5_30,x.SlicerAccessibility=u.ExplorationVersions.v5_30,x.AxisScaleToLogAxisScale=u.ExplorationVersions.v5_31,x.PositionToSwitchAxisPosition=u.ExplorationVersions.v5_31,x.LegendPositionNewFormatPane=u.ExplorationVersions.v5_31,x.FillPointShowToStyle=u.ExplorationVersions.v5_31,x.ShowDefaultTooltip=u.ExplorationVersions.v5_31,x.RemoveDefaultToCircleToggle=u.ExplorationVersions.v5_31,x.OutlineDropdownToCheckboxes=u.ExplorationVersions.v5_31,x.SplitHelpTooltip=u.ExplorationVersions.v5_31,x.splitGrandTotals=u.ExplorationVersions.v5_31,x.splitSubTotals=u.ExplorationVersions.v5_31,x.UpgradeOutlineProperties=u.ExplorationVersions.v5_31,x.QueryFieldParameters=u.ExplorationVersions.v5_32,x.RemainingCategoryLogAxisScale=u.ExplorationVersions.v5_33,x.NewAlternatingRowsStyle=u.ExplorationVersions.v5_33,x.AltTextColumns=u.ExplorationVersions.v5_33,x.RowWithReferenceText=u.ExplorationVersions.v5_33,x.ErrorBars=u.ExplorationVersions.v5_34,x.GaugeChartCalloutTextFormatting=u.ExplorationVersions.v5_34,x.SlicerSliderColors=u.ExplorationVersions.v5_34,x.ShapeButtonTextFormatting=u.ExplorationVersions.v5_34,x.HelpTooltipBIU=u.ExplorationVersions.v5_34,x.AzureMapsFilledMap=u.ExplorationVersions.v5_34,x.ConditionalFormattingDataLabels=u.ExplorationVersions.v5_35,x.CartesianBiuFontProperties=u.ExplorationVersions.v5_35,x.OnObject=u.ExplorationVersions.v5_36,x.DefaultAggregateDisplayName=u.ExplorationVersions.v5_36,x.VisualTitleContainerPadding=u.CurrentExplorationVersion,x.TotalDataBars=u.CurrentExplorationVersion,x.TextboxAtMention=u.CurrentExplorationVersion,x.GoalVisual=u.CurrentExplorationVersion,u.ExplorationStateVersionToExplorationVersion=((y={})[u.ExplorationStateVersions.v1_8]=u.ExplorationVersions.v5_29,y[u.ExplorationStateVersions.v1_9]=u.ExplorationVersions.v5_30,y[u.ExplorationStateVersions.v1_10]=u.ExplorationVersions.v5_31,y[u.ExplorationStateVersions.v1_11]=u.ExplorationVersions.v5_32,y[u.ExplorationStateVersions.v1_12]=u.ExplorationVersions.v5_33,y[u.ExplorationStateVersions.v1_13]=u.ExplorationVersions.v5_34,y[u.ExplorationStateVersions.v1_14]=u.ExplorationVersions.v5_35,y[u.ExplorationStateVersions.v1_15]=u.ExplorationVersions.v5_36,y),u.setExplorationStateVersionToExplorationVersion=function(e){u.ExplorationStateVersionToExplorationVersion=e},u.DefaultCategoryColorVisualsToUpgrade=["barChart","clusteredBarChart","clusteredColumnChart","columnChart","comboChart","dataDotClusteredColumnComboChart","dataDotStackedColumnComboChart","funnel","hundredPercentStackedBarChart","hundredPercentStackedColumnChart","lineStackedColumnComboChart","lineClusteredColumnComboChart","map","filledMap","shapeMap","scatterChart"],u.ComboSmallMultipleFormattingVisualTypes=[i.lineClusteredColumnComboChart.name,i.lineStackedColumnComboChart.name];var x=[i.areaChart.name,i.barChart.name,i.clusteredBarChart.name,i.clusteredColumnChart.name,i.columnChart.name,i.hundredPercentStackedBarChart.name,i.hundredPercentStackedColumnChart.name,i.lineChart.name,i.stackedAreaChart.name,i.ribbonChart.name],y=__spreadArray(__spreadArray([],x),u.ComboSmallMultipleFormattingVisualTypes);function b(e){if(e&&!_.isEmpty(e.data)&&1===e.data.length&&a.isWildcard(e.data[0]))return e.data[0].matchingOption}u.CartesianExpressionBasedFormattingVisualTypes=[i.areaChart.name,i.lineChart.name,i.stackedAreaChart.name,i.realTimeLineChart.name,i.scatterChart.name,i.waterfallChart.name,i.dataDotChart.name,i.columnChart.name,i.clusteredColumnChart.name,i.hundredPercentStackedColumnChart.name,i.barChart.name,i.clusteredBarChart.name,i.hundredPercentStackedBarChart.name,i.ribbonChart.name,i.comboChart.name,i.lineClusteredColumnComboChart.name,i.lineStackedColumnComboChart.name,i.dataDotClusteredColumnComboChart.name,i.dataDotStackedColumnComboChart.name,i.histogram.name],u.CartesianExpressionBasedFormattingLabelVisualTypes=_.without(u.CartesianExpressionBasedFormattingVisualTypes,i.realTimeLineChart.name,i.scatterChart.name,i.histogram.name),u.CartesianExpressionBasedFormattingDataPointAndAxisExtentVisualTypes=_.without(u.CartesianExpressionBasedFormattingVisualTypes,i.realTimeLineChart.name),u.CartesianExpressionBasedFormattingTotalsVisualTypes=[F.visuals.plugins.stackedAreaChart.name,F.visuals.plugins.columnChart.name,F.visuals.plugins.clusteredColumnChart.name,F.visuals.plugins.barChart.name,F.visuals.plugins.clusteredBarChart.name,F.visuals.plugins.lineClusteredColumnComboChart.name,F.visuals.plugins.lineStackedColumnComboChart.name,F.visuals.plugins.dataDotClusteredColumnComboChart.name,F.visuals.plugins.dataDotStackedColumnComboChart.name],u.CartesianExpressionBasedFormattingValueAxisSecVisualTypes=[F.visuals.plugins.lineClusteredColumnComboChart.name,F.visuals.plugins.lineStackedColumnComboChart.name,F.visuals.plugins.dataDotClusteredColumnComboChart.name,F.visuals.plugins.dataDotStackedColumnComboChart.name],u.ErrorBarsVisualTypes=[F.visuals.plugins.lineChart.name,F.visuals.plugins.clusteredBarChart.name,F.visuals.plugins.clusteredColumnChart.name,F.visuals.plugins.barChart.name,F.visuals.plugins.columnChart.name,F.visuals.plugins.hundredPercentStackedBarChart.name,F.visuals.plugins.hundredPercentStackedColumnChart.name,F.visuals.plugins.ribbonChart.name,F.visuals.plugins.lineStackedColumnComboChart.name,F.visuals.plugins.lineClusteredColumnComboChart.name],u.AddedObjectPropertyVersions=[{property:{objectName:"general",propertyName:"altText"},version:u.ExplorationVersions.v3_1},{property:{objectName:"visualLink",propertyName:"type"},version:u.ExplorationVersions.v3_5},{property:{objectName:"visualLink",propertyName:"type",matchByContents:function(e){return e.value===p.Bookmark}},version:h.bookmarks},{property:{objectName:"labels",propertyName:"enableBackground"},version:u.ExplorationVersions.v3_9},{property:{objectName:"labels",propertyName:"backgroundColor"},version:u.ExplorationVersions.v3_9},{property:{objectName:"labels",propertyName:"backgroundTransparency"},version:u.ExplorationVersions.v3_9},{property:{objectName:"categoryLabels",propertyName:"labelEnableBackground"},version:u.ExplorationVersions.v3_9},{property:{objectName:"categoryLabels",propertyName:"labelBackgroundColor"},version:u.ExplorationVersions.v3_9},{property:{objectName:"categoryLabels",propertyName:"labelBackgroundTransparency"},version:u.ExplorationVersions.v3_9},{property:{objectName:"dateRange",propertyName:"anchorDate"},version:u.ExplorationVersions.v3_9},{property:{objectName:"categoryAxis",propertyName:"maxMarginFactor"},version:u.ExplorationVersions.v3_9},{property:{objectName:"categoryAxis",propertyName:"innerPadding"},version:u.ExplorationVersions.v3_9},{property:{objectName:"columnFormatting",propertyName:"labelDisplayUnits"},version:u.ExplorationVersions.v3_12},{property:{objectName:"columnFormatting",propertyName:"labelPrecision"},version:u.ExplorationVersions.v3_12},{property:{objectName:"visualTooltip",propertyName:"type",matchByContents:function(e){return e.value===m.Canvas}},version:h.CanvasTooltips},{property:{objectName:"lineStyles",propertyName:"lineStyle"},version:u.ExplorationVersions.v3_13,types:[F.visuals.plugins.lineClusteredColumnComboChart.name,F.visuals.plugins.lineStackedColumnComboChart.name]},{property:{objectName:"legend",propertyName:"legendMarkerRendering"},version:u.ExplorationVersions.v3_13,types:[F.visuals.plugins.lineClusteredColumnComboChart.name,F.visuals.plugins.lineStackedColumnComboChart.name]},{property:{objectName:"legend",propertyName:"defaultToCircle"},version:u.ExplorationVersions.v3_13,types:[F.visuals.plugins.lineClusteredColumnComboChart.name,F.visuals.plugins.lineStackedColumnComboChart.name]},{property:{objectName:"legend",propertyName:"matchLineColor"},version:u.ExplorationVersions.v3_13,types:[F.visuals.plugins.lineClusteredColumnComboChart.name,F.visuals.plugins.lineStackedColumnComboChart.name]},{property:{objectName:"visualLink",propertyName:"type",matchByContents:function(e){return e.value===p.Qna}},version:h.QnaLink},{property:{objectName:"labels",propertyName:"funnelLabelStyle"},version:u.ExplorationVersions.v3_14,types:[F.visuals.plugins.funnel.name]},{property:{objectName:"dataPoint",propertyName:"fillRule",matchByContents:P},version:u.ExplorationVersions.v3_15},{property:{objectName:"values",propertyName:"backColor",matchByContents:P},version:u.ExplorationVersions.v3_15},{property:{objectName:"values",propertyName:"fontColor",matchByContents:P},version:u.ExplorationVersions.v3_15},{property:{objectName:"outspace",propertyName:l},version:h.OutspaceFormatting,types:["page"]},{property:{objectName:"visualHeader",propertyName:l},version:h.StylableVisualContainerHeader},{property:{objectName:"visualTooltip",propertyName:"show"},version:u.ExplorationVersions.v3_16},{property:{objectName:"categoryAxis",propertyName:"axisType",matchByContents:function(e){return e.value===F.visuals.axisType.categorical}},version:h.DotPlotVisual,types:[F.visuals.plugins.scatterChart.name]},{property:{objectName:"searchBox",propertyName:l},version:u.ExplorationVersions.v3_19,types:[F.visuals.plugins.slicer.name]},{property:{objectName:"rowHeaders",propertyName:"showExpandCollapseButtons"},version:h.ExpandCollapse,types:[F.visuals.plugins.pivotTable.name]},{property:{objectName:"dataPoint",propertyName:"fill",matchByContents:function(e,t){return t&&t.data&&1===t.data.length&&a.isWildcard(t.data[0])}},version:h.CartesianConditionalFormatting,types:u.DefaultCategoryColorVisualsToUpgrade},{property:{objectName:"filterCard",propertyName:l},version:h.OutspacePaneFormatting,types:["page"]},{property:{objectName:"outspacePane",propertyName:l},version:h.OutspacePaneFormatting,types:["page"]},{property:{objectName:"outspacePane",propertyName:"expanded"},version:h.OutspacePaneFormatting,types:["report"]},{property:{objectName:"outspacePane",propertyName:"visible"},version:h.OutspacePaneFormatting,types:["report"]},{property:{objectName:"visualLink",propertyName:"tooltip"},version:h.VisualLinkTooltip},{property:{objectName:"general",propertyName:"requireSingleSelect"},version:h.FilterRequireSingleSelect,types:["filter"]},{property:{objectName:"title",propertyName:"titleWrap"},version:h.TitleWordWrap},{property:{objectName:"border",propertyName:"radius"},version:h.VisualBorderRadius},{property:{objectName:"visualLink",propertyName:"webUrl"},version:h.WebUrlAction},{property:{objectName:"selection",propertyName:"strictSingleSelect"},version:h.StrictSingleSelect,types:[F.visuals.plugins.slicer.name]},{property:{objectName:"visualTooltip",propertyName:"fontColor"},version:h.DefaultTooltipFormatting},{property:{objectName:"visualTooltip",propertyName:"fontSize"},version:h.DefaultTooltipFormatting},{property:{objectName:"visualTooltip",propertyName:"fontFamily"},version:h.DefaultTooltipFormatting},{property:{objectName:"visualTooltip",propertyName:"background"},version:h.DefaultTooltipFormatting},{property:{objectName:"visualTooltip",propertyName:"transparency"},version:h.DefaultTooltipFormatting},{property:{objectName:"displayArea",propertyName:"verticalAlignment"},version:h.DisplayAreaVerticalAlignment,types:["page"]},{property:{objectName:"section",propertyName:"verticalAlignment"},version:h.DisplayAreaVerticalAlignment,types:["report"]},{property:{objectName:"title",propertyName:"text",isExprBound:!0},version:h.ExpressionBoundVisualTitles},{property:{objectName:"indicator",propertyName:"fontSize"},version:u.ExplorationVersions.v4_1,types:[F.visuals.plugins.kpi.name]},{property:{objectName:"labels",propertyName:"labelPosition"},version:u.ExplorationVersions.v4_1,types:[F.visuals.plugins.lineChart.name]},{property:{objectName:"title",propertyName:"fontColor",matchByContents:function(e,t){e=e&&e.solid&&e.solid.color;return!(n.isConstant(e)||n.isThemeDataColor(e))}},version:h.ColorConditionalFormatting},{property:{objectName:"title",propertyName:"background",matchByContents:function(e,t){e=e&&e.solid&&e.solid.color;return!(n.isConstant(e)||n.isThemeDataColor(e))}},version:h.ColorConditionalFormatting},{property:{objectName:"labels",propertyName:"color",matchByContents:function(e,t){e=e&&e.solid&&e.solid.color;return!(n.isConstant(e)||n.isThemeDataColor(e))}},version:h.ColorConditionalFormatting,types:[F.visuals.plugins.card.name]},{property:{objectName:"categoryLabels",propertyName:"color",matchByContents:function(e,t){e=e&&e.solid&&e.solid.color;return!(n.isConstant(e)||n.isThemeDataColor(e))}},version:h.ColorConditionalFormatting,types:[F.visuals.plugins.card.name]},{property:{objectName:"subTotals",propertyName:"rowSubtotalsLabel"},types:[F.visuals.plugins.pivotTable.name],version:u.ExplorationVersions.v4_2},{property:{objectName:"subTotals",propertyName:"columnSubtotalsLabel"},types:[F.visuals.plugins.pivotTable.name],version:u.ExplorationVersions.v4_2},{property:{objectName:"subTotals",propertyName:"levelSubtotalLabel"},types:[F.visuals.plugins.pivotTable.name],version:u.ExplorationVersions.v4_2},{property:{objectName:"total",propertyName:"label"},types:[F.visuals.plugins.tableEx.name],version:u.ExplorationVersions.v4_2},{property:{objectName:"visualHeader",propertyName:"showTooltipButton"},version:h.VisualHeaderTooltip},{property:{objectName:"visualHeaderTooltip",propertyName:"section"},version:h.VisualHeaderTooltip},{property:{objectName:"visualHeaderTooltip",propertyName:"text"},version:h.VisualHeaderTooltip},{property:{objectName:"visualHeaderTooltip",propertyName:"titleFontColor"},version:h.VisualHeaderTooltip},{property:{objectName:"visualHeaderTooltip",propertyName:"fontSize"},version:h.VisualHeaderTooltip},{property:{objectName:"visualHeaderTooltip",propertyName:"fontFamily"},version:h.VisualHeaderTooltip},{property:{objectName:"visualHeaderTooltip",propertyName:"background"},version:h.VisualHeaderTooltip},{property:{objectName:"visualHeaderTooltip",propertyName:"transparency"},version:h.VisualHeaderTooltip},{property:{objectName:"dataPoint",propertyName:"fill",matchByContents:function(e,t){return!n.isConstant(e&&e.solid&&e.solid.color)}},version:h.GaugeConditionalFormatting,types:[F.visuals.plugins.gauge.name]},{property:{objectName:"background",propertyName:"color",matchByContents:function(e,t){e=e&&e.solid&&e.solid.color;return!(n.isConstant(e)||n.isThemeDataColor(e))}},version:h.ExpressionBoundVisualBackground},{property:{objectName:"keyDrivers",propertyName:"allowKeyDriversCounting",matchByContents:function(e){return!0===e.value}},version:h.KeyDriversCounting},{types:[F.visuals.plugins.pivotTable.name,F.visuals.plugins.tableEx.name],property:{objectName:"values",propertyName:"icon"},version:u.ExplorationVersions.v5_1},{property:{objectName:"text",propertyName:"fontFamily"},types:[F.visuals.plugins.textbox.name],version:u.ExplorationVersions.v5_3},{property:{objectName:"text",propertyName:"fontSize"},types:[F.visuals.plugins.textbox.name],version:u.ExplorationVersions.v5_3},{property:{objectName:"text",propertyName:"color"},types:[F.visuals.plugins.textbox.name],version:u.ExplorationVersions.v5_3},{property:{objectName:"general",propertyName:"altText",isExprBound:!0},version:h.ExpressionBoundAltText},{property:{objectName:"border",propertyName:"color",isExprBound:!0},version:h.ExpressionBoundBorderColor},{property:{objectName:"dataPoint",propertyName:"target",isExprBound:!0},version:h.ExpressionBoundGaugeColors,types:[F.visuals.plugins.gauge.name]},{property:{objectName:"labels",propertyName:"color",isExprBound:!0},version:h.ExpressionBoundGaugeColors,types:[F.visuals.plugins.gauge.name]},{property:{objectName:"target",propertyName:"color",isExprBound:!0},version:h.ExpressionBoundGaugeColors,types:[F.visuals.plugins.gauge.name]},{property:{objectName:"calloutValue",propertyName:"color",isExprBound:!0},version:h.ExpressionBoundGaugeColors,types:[F.visuals.plugins.gauge.name]},{property:{objectName:"pageRefresh",propertyName:"show"},version:h.AutomaticPageRefresh,types:["page"]},{property:{objectName:"pageRefresh",propertyName:"duration"},version:h.AutomaticPageRefresh,types:["page"]},{property:{objectName:"text",propertyName:"text",isExprBound:!0},version:h.ExpressionBoundActions,types:[F.visuals.plugins.actionButton.name]},{property:{objectName:"text",propertyName:"fontColor",isExprBound:!0},version:h.ExpressionBoundActions,types:[F.visuals.plugins.actionButton.name]},{property:{objectName:"icon",propertyName:"lineColor",isExprBound:!0},version:h.ExpressionBoundActions,types:[F.visuals.plugins.actionButton.name]},{property:{objectName:"outline",propertyName:"lineColor",isExprBound:!0},version:h.ExpressionBoundActions,types:[F.visuals.plugins.actionButton.name]},{property:{objectName:"fill",propertyName:"fillColor",isExprBound:!0},version:h.ExpressionBoundActions,types:[F.visuals.plugins.actionButton.name]},{property:{objectName:"visualLink",propertyName:"tooltip",isExprBound:!0},version:h.ExpressionBoundActions},{types:[F.visuals.plugins.kpi.name],property:{objectName:"indicator",propertyName:"fontFamily"},version:h.AdditionalKPISettings},{types:[F.visuals.plugins.kpi.name],property:{objectName:"indicator",propertyName:"fontColor"},version:h.AdditionalKPISettings},{types:[F.visuals.plugins.kpi.name],property:{objectName:"indicator",propertyName:"verticalAlignment"},version:h.AdditionalKPISettings},{types:[F.visuals.plugins.kpi.name],property:{objectName:"indicator",propertyName:"horizontalAlignment"},version:h.AdditionalKPISettings},{types:[F.visuals.plugins.kpi.name],property:{objectName:"trendline",propertyName:"transparency"},version:h.AdditionalKPISettings},{types:[F.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"goalText"},version:h.AdditionalKPISettings},{types:[F.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"fontSize"},version:h.AdditionalKPISettings},{types:[F.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"goalFontFamily"},version:h.AdditionalKPISettings},{types:[F.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"goalFontColor"},version:h.AdditionalKPISettings},{types:[F.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"distanceLabel"},version:h.AdditionalKPISettings},{types:[F.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"percentageLabelPrecision"},version:h.AdditionalKPISettings},{types:[F.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"titleFontSize"},version:h.AdditionalKPISettings},{types:[F.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"distanceFontFamily"},version:h.AdditionalKPISettings},{types:[F.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"distanceFontColor"},version:h.AdditionalKPISettings},{types:[F.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"direction"},version:h.AdditionalKPISettings},{types:[F.visuals.plugins.kpi.name],property:{objectName:"period",propertyName:"show"},version:h.AdditionalKPISettings},{types:[F.visuals.plugins.kpi.name],property:{objectName:"period",propertyName:"fontSize"},version:h.AdditionalKPISettings},{types:[F.visuals.plugins.kpi.name],property:{objectName:"period",propertyName:"periodFontFamily"},version:h.AdditionalKPISettings},{types:[F.visuals.plugins.kpi.name],property:{objectName:"period",propertyName:"periodFontColor"},version:h.AdditionalKPISettings},{types:[F.visuals.plugins.pivotTable.name,F.visuals.plugins.tableEx.name],property:{objectName:"values",propertyName:"webURL"},version:u.ExplorationVersions.v5_6},{types:[F.visuals.plugins.decompositionTreeVisual.name],property:{objectName:F.visuals.decompositionTreeObjectNames.categoryLabels,propertyName:F.visuals.decompositionTreeObjectPropertyNames.categoryLabelFontColor},version:u.ExplorationVersions.v5_6},{types:[F.visuals.plugins.decompositionTreeVisual.name],property:{objectName:F.visuals.decompositionTreeObjectNames.categoryLabels,propertyName:F.visuals.decompositionTreeObjectPropertyNames.categoryLabelFontFamily},version:u.ExplorationVersions.v5_6},{types:[F.visuals.plugins.decompositionTreeVisual.name],property:{objectName:F.visuals.decompositionTreeObjectNames.categoryLabels,propertyName:F.visuals.decompositionTreeObjectPropertyNames.categoryLabelFontSize},version:u.ExplorationVersions.v5_6},{types:[F.visuals.plugins.decompositionTreeVisual.name],property:{objectName:F.visuals.decompositionTreeObjectNames.dataLabels,propertyName:F.visuals.decompositionTreeObjectPropertyNames.dataLabelFontColor},version:u.ExplorationVersions.v5_6},{types:[F.visuals.plugins.decompositionTreeVisual.name],property:{objectName:F.visuals.decompositionTreeObjectNames.dataLabels,propertyName:F.visuals.decompositionTreeObjectPropertyNames.dataLabelFontFamily},version:u.ExplorationVersions.v5_6},{types:[F.visuals.plugins.decompositionTreeVisual.name],property:{objectName:F.visuals.decompositionTreeObjectNames.dataLabels,propertyName:F.visuals.decompositionTreeObjectPropertyNames.dataLabelFontSize},version:u.ExplorationVersions.v5_6},{types:[F.visuals.plugins.decompositionTreeVisual.name],property:{objectName:F.visuals.decompositionTreeObjectNames.dataLabels,propertyName:F.visuals.decompositionTreeObjectPropertyNames.dataLabelDisplayUnits},version:u.ExplorationVersions.v5_6},{types:[F.visuals.plugins.decompositionTreeVisual.name],property:{objectName:F.visuals.decompositionTreeObjectNames.dataLabels,propertyName:F.visuals.decompositionTreeObjectPropertyNames.dataLabelPrecision},version:u.ExplorationVersions.v5_6},{types:[F.visuals.plugins.decompositionTreeVisual.name],property:{objectName:F.visuals.decompositionTreeObjectNames.dataBars,propertyName:F.visuals.decompositionTreeObjectPropertyNames.dataBarBackgroundColor},version:u.ExplorationVersions.v5_6},{types:[F.visuals.plugins.decompositionTreeVisual.name],property:{objectName:F.visuals.decompositionTreeObjectNames.dataBars,propertyName:F.visuals.decompositionTreeObjectPropertyNames.dataBarWidthPercent},version:u.ExplorationVersions.v5_6},{types:[F.visuals.plugins.decompositionTreeVisual.name],property:{objectName:F.visuals.decompositionTreeObjectNames.levelHeader,propertyName:F.visuals.decompositionTreeObjectPropertyNames.levelHeaderBackgroundColor},version:u.ExplorationVersions.v5_6},{types:[F.visuals.plugins.decompositionTreeVisual.name],property:{objectName:F.visuals.decompositionTreeObjectNames.levelHeader,propertyName:F.visuals.decompositionTreeObjectPropertyNames.levelTitleFontColor},version:u.ExplorationVersions.v5_6},{types:[F.visuals.plugins.decompositionTreeVisual.name],property:{objectName:F.visuals.decompositionTreeObjectNames.levelHeader,propertyName:F.visuals.decompositionTreeObjectPropertyNames.levelTitleFontFamily},version:u.ExplorationVersions.v5_6},{types:[F.visuals.plugins.decompositionTreeVisual.name],property:{objectName:F.visuals.decompositionTreeObjectNames.levelHeader,propertyName:F.visuals.decompositionTreeObjectPropertyNames.levelTitleFontSize},version:u.ExplorationVersions.v5_6},{types:[F.visuals.plugins.decompositionTreeVisual.name],property:{objectName:F.visuals.decompositionTreeObjectNames.levelHeader,propertyName:F.visuals.decompositionTreeObjectPropertyNames.levelSubtitleFontColor},version:u.ExplorationVersions.v5_6},{types:[F.visuals.plugins.decompositionTreeVisual.name],property:{objectName:F.visuals.decompositionTreeObjectNames.levelHeader,propertyName:F.visuals.decompositionTreeObjectPropertyNames.levelSubtitleFontFamily},version:u.ExplorationVersions.v5_6},{types:[F.visuals.plugins.decompositionTreeVisual.name],property:{objectName:F.visuals.decompositionTreeObjectNames.levelHeader,propertyName:F.visuals.decompositionTreeObjectPropertyNames.levelSubtitleFontSize},version:u.ExplorationVersions.v5_6},{types:[F.visuals.plugins.decompositionTreeVisual.name],property:{objectName:F.visuals.decompositionTreeObjectNames.levelHeader,propertyName:F.visuals.decompositionTreeObjectPropertyNames.showSubtitles},version:u.ExplorationVersions.v5_6},{types:[F.visuals.plugins.decompositionTreeVisual.name],property:{objectName:F.visuals.decompositionTreeObjectNames.tree,propertyName:F.visuals.decompositionTreeObjectPropertyNames.connectorDefaultColor},version:u.ExplorationVersions.v5_6},{types:["page"],property:{objectName:"outspacePane",propertyName:"inputBoxColor"},version:h.FilterPaneSearchBoxFormatting},{types:["page"],property:{objectName:"outspacePane",propertyName:"searchTextSize"},version:h.FilterPaneSearchBoxFormatting},{types:[F.visuals.plugins.actionButton.name],property:{objectName:"visualLink",propertyName:"navigationSection"},version:u.ExplorationVersions.v5_8},{types:[F.visuals.plugins.actionButton.name],property:{objectName:"visualLink",propertyName:"drillthroughSection"},version:u.ExplorationVersions.v5_8},{property:{objectName:"y2Axis",propertyName:"show"},version:h.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secAxisLabel"},version:h.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secLogAxisScale"},version:h.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secStart"},version:h.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secEnd"},version:h.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secShowAxisTitle"},version:h.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secAxisStyle"},version:h.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secLabelColor"},version:h.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secFontFamily"},version:h.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secFontSize"},version:h.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secLabelDisplayUnits"},version:h.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secLabelPrecision"},version:h.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secTitleColor"},version:h.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secTitleFontFamily"},version:h.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secTitleFontSize"},version:h.LineChartDualAxis},{property:{objectName:"y2Axis",propertyName:"secTitleText"},version:h.LineChartDualAxis},{types:[F.visuals.plugins.decompositionTreeVisual.name],property:{objectName:F.visuals.decompositionTreeObjectNames.tree,propertyName:F.visuals.decompositionTreeObjectPropertyNames.barsPerLevel},version:h.DecompTreeBarsPerLevel},{types:["page"],property:{objectName:"pageRefresh",propertyName:"refreshType"},version:h.ChangeDetectionRefresh},{property:{objectName:"visualHeader",propertyName:"showPersonalizeVisualButton"},version:h.AllowInlineExploration},{property:{objectName:"general",propertyName:"isInvertedSelectionMode"},version:h.FilterSelectAll,types:["filter"]},{types:[F.visuals.plugins.slicer.name],property:{objectName:"data",propertyName:"mode",matchByContents:function(e){return e.value===F.visuals.slicerMode.relativeTime}},version:h.RelativeTimeFilter},{types:["tableEx","pivotTable"],property:{objectName:"values",propertyName:"backColor",matchByContents:function(e,t){return void 0!==b(t)}},version:u.ExplorationVersions.v5_9},{types:["tableEx","pivotTable"],property:{objectName:"values",propertyName:"fontColor",matchByContents:function(e,t){return void 0!==b(t)}},version:u.ExplorationVersions.v5_9},{types:["tableEx","pivotTable"],property:{objectName:"values",propertyName:"icon",matchByContents:function(e,t){t=b(t);return void 0!==t&&1!==t}},version:u.ExplorationVersions.v5_9},{types:["tableEx","pivotTable"],property:{objectName:"values",propertyName:"webURL",matchByContents:function(e,t){t=b(t);return void 0!==t&&1!==t}},version:u.ExplorationVersions.v5_9},{types:[F.visuals.plugins.actionButton.name],property:{objectName:"fill",propertyName:"image"},version:u.ExplorationVersions.v5_10},{types:[F.visuals.plugins.actionButton.name],property:{objectName:"visualLink",propertyName:"enabledTooltip",isExprBound:!0},version:u.ExplorationVersions.v5_10},{types:[F.visuals.plugins.actionButton.name],property:{objectName:"visualLink",propertyName:"disabledTooltip",isExprBound:!0},version:u.ExplorationVersions.v5_10},{types:[F.visuals.plugins.actionButton.name],property:{objectName:"visualLink",propertyName:"drillthroughSection",isExprBound:!0},version:u.ExplorationVersions.v5_10},{types:[F.visuals.plugins.actionButton.name],property:{objectName:"visualLink",propertyName:"navigationSection",isExprBound:!0},version:u.ExplorationVersions.v5_10},{types:[F.visuals.plugins.image.name,F.visuals.plugins.basicShape.name],property:{objectName:"visualLink",propertyName:"navigationSection"},version:u.ExplorationVersions.v5_10},{types:[F.visuals.plugins.slicer.name,F.visuals.plugins.filterSlicer.name],property:{objectName:"items",propertyName:"steppedLayoutIndentation"},version:u.ExplorationVersions.v5_10},{types:[F.visuals.plugins.slicer.name,F.visuals.plugins.filterSlicer.name],property:{objectName:"items",propertyName:"expandCollapseToggleType"},version:u.ExplorationVersions.v5_10},{types:[F.visuals.plugins.kpi.name],property:{objectName:"indicator",propertyName:"iconSize"},version:h.KpiScalingIndicatorIcon},{types:[F.visuals.plugins.kpi.name],property:{objectName:"indicator",propertyName:"showIcon"},version:h.KpiScalingIndicatorIcon},{types:[F.visuals.plugins.lineChart.name,F.visuals.plugins.areaChart.name,F.visuals.plugins.stackedAreaChart.name],property:{objectName:"dataPoint",propertyName:"showAllDataPoints"},version:h.LineChartExplicitDots},{types:[F.visuals.plugins.map.name,F.visuals.plugins.filledMap.name,F.visuals.plugins.heatMap.name],property:{objectName:"dataPoint",propertyName:"transparency"},version:h.BingMapStyling},{types:[F.visuals.plugins.map.name,F.visuals.plugins.filledMap.name,F.visuals.plugins.heatMap.name],property:{objectName:"mapControls",propertyName:"minZoom"},version:h.BingMapStyling},{types:[F.visuals.plugins.map.name,F.visuals.plugins.filledMap.name,F.visuals.plugins.heatMap.name],property:{objectName:"mapControls",propertyName:"maxZoom"},version:h.BingMapStyling},{types:[F.visuals.plugins.map.name,F.visuals.plugins.filledMap.name,F.visuals.plugins.heatMap.name],property:{objectName:"mapStyles",propertyName:"showLabels"},version:h.BingMapStyling},{types:[F.visuals.plugins.filledMap.name],property:{objectName:"stroke",propertyName:"show"},version:h.BingMapStyling},{types:[F.visuals.plugins.filledMap.name],property:{objectName:"stroke",propertyName:"strokeColor"},version:h.BingMapStyling},{types:[F.visuals.plugins.filledMap.name],property:{objectName:"stroke",propertyName:"strokeWidth"},version:h.BingMapStyling},{types:[F.visuals.plugins.textbox.name],property:__assign(__assign({},F.visuals.textboxProps.general.paragraphs),{matchByContents:function(e,t){if(F.StructuralObjectDefinition.isParagraphsDefinition(e))for(var r=0,i=e;r<i.length;r++){var a=i[r];if(a&&!_.isEmpty(a.textRuns))for(var o=0,n=a.textRuns;o<n.length;o++){var s=n[o];if(F.ParagraphsDefinition.isTextRunConditionalDefinition(s))return!0}}return!1}}),version:h.ConditionalParagraphs},{types:[F.visuals.plugins.decompositionTreeVisual.name],property:{objectName:F.visuals.decompositionTreeObjectNames.tree,propertyName:F.visuals.decompositionTreeObjectPropertyNames.defaultClickAction},version:h.DecompositionTreeVisual},{types:[F.visuals.plugins.decompositionTreeVisual.name],property:{objectName:F.visuals.decompositionTreeObjectNames.tree,propertyName:F.visuals.decompositionTreeObjectPropertyNames.responsiveLayout},version:h.DecompositionTreeVisual},{types:[F.visuals.plugins.decompositionTreeVisual.name],property:{objectName:F.visuals.decompositionTreeObjectNames.tree,propertyName:F.visuals.decompositionTreeObjectPropertyNames.effectiveBarsPerLevel},version:h.DecompositionTreeVisual},{types:[F.visuals.plugins.decompositionTreeVisual.name],property:{objectName:F.visuals.decompositionTreeObjectNames.dataBars,propertyName:F.visuals.decompositionTreeObjectPropertyNames.dataBarColor},version:h.DecompositionTreeVisual},{types:[F.visuals.plugins.decompositionTreeVisual.name],property:{objectName:F.visuals.decompositionTreeObjectNames.dataBars,propertyName:F.visuals.decompositionTreeObjectPropertyNames.axisStart},version:h.DecompositionTreeVisual},{types:[F.visuals.plugins.decompositionTreeVisual.name],property:{objectName:F.visuals.decompositionTreeObjectNames.dataBars,propertyName:F.visuals.decompositionTreeObjectPropertyNames.axisEnd},version:h.DecompositionTreeVisual},{types:[F.visuals.plugins.decompositionTreeVisual.name],property:{objectName:"general",propertyName:"formatString"},version:h.DecompositionTreeVisual},{types:[F.visuals.plugins.qnaVisual.name],property:{objectName:"inputBox",propertyName:"warningColor"},version:h.QnaWarningUnderlineColor},{types:[F.visuals.plugins.slicer.name,F.visuals.plugins.filterSlicer.name],property:{objectName:"header",propertyName:"text"},version:h.SlicerHeaderText},{types:[F.visuals.plugins.barChart.name,F.visuals.plugins.columnChart.name,F.visuals.plugins.clusteredBarChart.name,F.visuals.plugins.clusteredColumnChart.name,F.visuals.plugins.hundredPercentStackedBarChart.name,F.visuals.plugins.hundredPercentStackedColumnChart.name,F.visuals.plugins.scatterChart.name],property:{objectName:"legend",propertyName:"showGradientLegend"},version:h.GradientLegend},{types:[F.visuals.plugins.qnaVisual.name],property:{objectName:"inputBox",propertyName:"commitButtonBackgroundColor"},version:h.QnaActionButtonsColor},{property:{objectName:"dropShadow",propertyName:"*"},version:h.DropShadow},{types:["page"],property:{objectName:"personalizeVisual",propertyName:"perspectiveRef"},version:h.PersonalizeVisualPerspective},{types:["page"],property:{objectName:"personalizeVisual",propertyName:"show"},version:h.PersonalizeVisualPerspectiveToggle},{property:{objectName:"general",propertyName:"keepLayerOrder"},version:h.KeepLayerOrder},{property:F.visuals.textboxProps.values.expr,types:[F.visuals.plugins.textbox.name],version:h.NarrativeVisual},{property:F.visuals.textboxProps.values.formatString,types:[F.visuals.plugins.textbox.name],version:h.NarrativeVisual},{types:[F.visuals.plugins.areaChart.name,F.visuals.plugins.barChart.name,F.visuals.plugins.columnChart.name,F.visuals.plugins.dataDotStackedColumnComboChart.name,F.visuals.plugins.lineStackedColumnComboChart.name,F.visuals.plugins.hundredPercentStackedBarChart.name,F.visuals.plugins.hundredPercentStackedColumnChart.name,F.visuals.plugins.stackedAreaChart.name],property:{objectName:"totals",propertyName:"show"},version:h.StackedTotalDataLabels},{types:[F.visuals.plugins.barChart.name,F.visuals.plugins.columnChart.name,F.visuals.plugins.dataDotStackedColumnComboChart.name,F.visuals.plugins.lineStackedColumnComboChart.name,F.visuals.plugins.hundredPercentStackedBarChart.name,F.visuals.plugins.hundredPercentStackedColumnChart.name,F.visuals.plugins.stackedAreaChart.name],property:{objectName:"totals",propertyName:"color"},version:h.StackedTotalDataLabels},{types:[F.visuals.plugins.barChart.name,F.visuals.plugins.columnChart.name,F.visuals.plugins.dataDotStackedColumnComboChart.name,F.visuals.plugins.lineStackedColumnComboChart.name,F.visuals.plugins.hundredPercentStackedBarChart.name,F.visuals.plugins.hundredPercentStackedColumnChart.name,F.visuals.plugins.stackedAreaChart.name],property:{objectName:"totals",propertyName:"labelDisplayUnits"},version:h.StackedTotalDataLabels},{types:[F.visuals.plugins.barChart.name,F.visuals.plugins.columnChart.name,F.visuals.plugins.dataDotStackedColumnComboChart.name,F.visuals.plugins.lineStackedColumnComboChart.name,F.visuals.plugins.hundredPercentStackedBarChart.name,F.visuals.plugins.hundredPercentStackedColumnChart.name,F.visuals.plugins.stackedAreaChart.name],property:{objectName:"totals",propertyName:"labelPrecision"},version:h.StackedTotalDataLabels},{types:[F.visuals.plugins.barChart.name,F.visuals.plugins.columnChart.name,F.visuals.plugins.dataDotStackedColumnComboChart.name,F.visuals.plugins.lineStackedColumnComboChart.name,F.visuals.plugins.hundredPercentStackedBarChart.name,F.visuals.plugins.hundredPercentStackedColumnChart.name,F.visuals.plugins.stackedAreaChart.name],property:{objectName:"totals",propertyName:"enableBackground"},version:h.StackedTotalDataLabels},{types:[F.visuals.plugins.barChart.name,F.visuals.plugins.columnChart.name,F.visuals.plugins.dataDotStackedColumnComboChart.name,F.visuals.plugins.lineStackedColumnComboChart.name,F.visuals.plugins.hundredPercentStackedBarChart.name,F.visuals.plugins.hundredPercentStackedColumnChart.name,F.visuals.plugins.stackedAreaChart.name],property:{objectName:"totals",propertyName:"backgroundColor"},version:h.StackedTotalDataLabels},{types:[F.visuals.plugins.barChart.name,F.visuals.plugins.columnChart.name,F.visuals.plugins.dataDotStackedColumnComboChart.name,F.visuals.plugins.lineStackedColumnComboChart.name,F.visuals.plugins.hundredPercentStackedBarChart.name,F.visuals.plugins.hundredPercentStackedColumnChart.name,F.visuals.plugins.stackedAreaChart.name],property:{objectName:"totals",propertyName:"backgroundTransparency"},version:h.StackedTotalDataLabels},{types:[F.visuals.plugins.barChart.name,F.visuals.plugins.columnChart.name,F.visuals.plugins.dataDotStackedColumnComboChart.name,F.visuals.plugins.lineStackedColumnComboChart.name,F.visuals.plugins.hundredPercentStackedBarChart.name,F.visuals.plugins.hundredPercentStackedColumnChart.name,F.visuals.plugins.stackedAreaChart.name],property:{objectName:"totals",propertyName:"fontSize"},version:h.StackedTotalDataLabels},{types:[F.visuals.plugins.barChart.name,F.visuals.plugins.columnChart.name,F.visuals.plugins.dataDotStackedColumnComboChart.name,F.visuals.plugins.lineStackedColumnComboChart.name,F.visuals.plugins.hundredPercentStackedBarChart.name,F.visuals.plugins.hundredPercentStackedColumnChart.name,F.visuals.plugins.stackedAreaChart.name],property:{objectName:"totals",propertyName:"fontFamily"},version:h.StackedTotalDataLabels},{types:[F.visuals.plugins.barChart.name,F.visuals.plugins.columnChart.name,F.visuals.plugins.dataDotStackedColumnComboChart.name,F.visuals.plugins.lineStackedColumnComboChart.name,F.visuals.plugins.hundredPercentStackedBarChart.name,F.visuals.plugins.hundredPercentStackedColumnChart.name],property:{objectName:"totals",propertyName:"showPositiveAndNegative"},version:h.StackedTotalDataLabels},{property:{objectName:"outspacePane",propertyName:"checkboxAndApplyColor"},types:["page"],version:h.FilterPaneCheckboxAndApplyColor},{types:[F.visuals.plugins.lineChart.name],property:{objectName:e.capabilityObjectName,propertyName:t.anomalyDetectionPropertyNames.show},version:h.AnomalyDetection},{types:[F.visuals.plugins.lineChart.name],property:{objectName:e.capabilityObjectName,propertyName:t.anomalyDetectionPropertyNames.transform},version:h.AnomalyDetection},{types:[F.visuals.plugins.lineChart.name],property:{objectName:e.capabilityObjectName,propertyName:e.sensitivitySliceName},version:h.AnomalyDetection},{types:[F.visuals.plugins.lineChart.name],property:{objectName:e.capabilityObjectName,propertyName:t.anomalyDetectionPropertyNames.displayName},version:h.AnomalyDetection},{types:[F.visuals.plugins.lineChart.name],property:{objectName:e.capabilityObjectName,propertyName:t.anomalyDetectionPropertyNames.markerShape},version:h.AnomalyDetection},{types:[F.visuals.plugins.lineChart.name],property:{objectName:e.capabilityObjectName,propertyName:t.anomalyDetectionPropertyNames.markerShapeSize},version:h.AnomalyDetection},{types:[F.visuals.plugins.lineChart.name],property:{objectName:e.capabilityObjectName,propertyName:t.anomalyDetectionPropertyNames.markerColor},version:h.AnomalyDetection},{types:[F.visuals.plugins.lineChart.name],property:{objectName:e.capabilityObjectName,propertyName:t.anomalyDetectionPropertyNames.confidenceBandStyle},version:h.AnomalyDetection},{types:[F.visuals.plugins.lineChart.name],property:{objectName:e.capabilityObjectName,propertyName:t.anomalyDetectionPropertyNames.transparency},version:h.AnomalyDetection},{types:[F.visuals.plugins.lineChart.name],property:{objectName:e.capabilityObjectName,propertyName:t.anomalyDetectionPropertyNames.confidenceBandColor},version:h.AnomalyDetection},{types:[F.visuals.plugins.lineChart.name],property:{objectName:e.capabilityObjectName,propertyName:F.visuals.AnomalyDetectionColumns.CategoryValue},version:h.AnomalyDetection},{types:[F.visuals.plugins.lineChart.name],property:{objectName:e.capabilityObjectName,propertyName:F.visuals.AnomalyDetectionColumns.Value},version:h.AnomalyDetection},{types:[F.visuals.plugins.lineChart.name],property:{objectName:e.capabilityObjectName,propertyName:F.visuals.AnomalyDetectionColumns.ExpectedValue},version:h.AnomalyDetection},{types:[F.visuals.plugins.lineChart.name],property:{objectName:e.capabilityObjectName,propertyName:F.visuals.AnomalyDetectionColumns.ExpectedLow},version:h.AnomalyDetection},{types:[F.visuals.plugins.lineChart.name],property:{objectName:e.capabilityObjectName,propertyName:F.visuals.AnomalyDetectionColumns.ExpectedHigh},version:h.AnomalyDetection},{types:[F.visuals.plugins.lineChart.name],property:{objectName:e.capabilityObjectName,propertyName:F.visuals.AnomalyDetectionColumns.BatchStart},version:h.AnomalyDetection},{types:[F.visuals.plugins.lineChart.name],property:{objectName:e.capabilityObjectName,propertyName:F.visuals.AnomalyDetectionColumns.BatchEnd},version:h.AnomalyDetection},{types:[F.visuals.plugins.lineChart.name],property:{objectName:e.capabilityObjectName,propertyName:e.explainByPropertyName},version:h.AnomalyDetection},{types:[F.visuals.plugins.lineChart.name],property:{objectName:e.capabilityObjectName,propertyName:e.isAnomalyHighlighted},version:h.AnomalyDetection},{types:[F.visuals.plugins.decompositionTreeVisual.name],property:{objectName:F.visuals.decompositionTreeObjectNames.insights,propertyName:F.visuals.decompositionTreeObjectPropertyNames.isAINode},version:h.DecompositionInsights},{types:[F.visuals.plugins.areaChart.name,F.visuals.plugins.barChart.name,F.visuals.plugins.clusteredBarChart.name,F.visuals.plugins.clusteredColumnChart.name,F.visuals.plugins.columnChart.name,F.visuals.plugins.comboChart.name,F.visuals.plugins.dataDotClusteredColumnComboChart.name,F.visuals.plugins.dataDotStackedColumnComboChart.name,F.visuals.plugins.hundredPercentStackedBarChart.name,F.visuals.plugins.hundredPercentStackedColumnChart.name,F.visuals.plugins.lineChart.name,F.visuals.plugins.lineClusteredColumnComboChart.name,F.visuals.plugins.lineStackedColumnComboChart.name,F.visuals.plugins.ribbonChart.name,F.visuals.plugins.scatterChart.name,F.visuals.plugins.stackedAreaChart.name],property:{objectName:"zoom",propertyName:"*"},version:h.AxisZoom},{types:x,property:{objectName:"subheader",propertyName:"fontFamily"},version:h.CartesianSmallMultiples},{types:x,property:{objectName:"subheader",propertyName:"fontSize"},version:h.CartesianSmallMultiples},{types:x,property:{objectName:"subheader",propertyName:"fontColor",isExprBound:!1},version:h.CartesianSmallMultiples},{types:x,property:{objectName:"subheader",propertyName:"alignment"},version:h.CartesianSmallMultiples},{types:x,property:{objectName:"subheader",propertyName:"position"},version:h.CartesianSmallMultiples},{types:x,property:{objectName:"smallMultiplesLayout",propertyName:"layoutType"},version:h.CartesianSmallMultiples},{types:x,property:{objectName:"smallMultiplesLayout",propertyName:"rowCount"},version:h.CartesianSmallMultiples},{types:x,property:{objectName:"smallMultiplesLayout",propertyName:"columnCount"},version:h.CartesianSmallMultiples},{property:{objectName:"dataPoint",propertyName:"fill",isExprBound:!0},version:h.AzureMapConditionalColor,types:[F.visuals.plugins.azureMap.name]},{types:x,property:{objectName:"smallMultiplesLayout",propertyName:"backgroundColor",isExprBound:!1},version:h.CartesianSmallMultiplesGridlines},{types:x,property:{objectName:"smallMultiplesLayout",propertyName:"backgroundTransparency"},version:h.CartesianSmallMultiplesGridlines},{types:x,property:{objectName:"smallMultiplesLayout",propertyName:"gridLineType"},version:h.CartesianSmallMultiplesGridlines},{types:x,property:{objectName:"smallMultiplesLayout",propertyName:"gridLineColor"},version:h.CartesianSmallMultiplesGridlines},{types:x,property:{objectName:"smallMultiplesLayout",propertyName:"gridLineWidth"},version:h.CartesianSmallMultiplesGridlines},{types:x,property:{objectName:"smallMultiplesLayout",propertyName:"gridLineStyle"},version:h.CartesianSmallMultiplesGridlines},{types:[i.map.name,i.filledMap.name,i.heatMap.name],property:{objectName:"mapControls",propertyName:"geocodingCulture"},version:h.MapGeocodingCulture},{types:[F.visuals.plugins.azureMap.name],property:{objectName:"mapControls",propertyName:"showSelectionControl"},version:h.AzureMapSelectionControl},{types:x,property:{objectName:"subheader",propertyName:"titleWrap"},version:h.CartesianSmallMultiplesSubheaderFormatting},{types:["group"],property:{objectName:"lockAspect",propertyName:"show"},version:h.VisualContainerGroupLockAspect},{types:[F.visuals.plugins.lineChart.name],property:{objectName:"xAxisReferenceLine",propertyName:"*"},version:h.lineChartVerticalReferenceLine},{types:y,property:{objectName:"smallMultiplesLayout",propertyName:"gridPadding"},version:h.CartesianSmallMultiplesPadding},{types:y,property:{objectName:"smallMultiplesLayout",propertyName:"advancedPaddingOptions"},version:h.CartesianSmallMultiplesPadding},{types:y,property:{objectName:"smallMultiplesLayout",propertyName:"columnPaddingInner"},version:h.CartesianSmallMultiplesPadding},{types:y,property:{objectName:"smallMultiplesLayout",propertyName:"columnPaddingOuter"},version:h.CartesianSmallMultiplesPadding},{types:y,property:{objectName:"smallMultiplesLayout",propertyName:"rowPaddingInner"},version:h.CartesianSmallMultiplesPadding},{types:y,property:{objectName:"smallMultiplesLayout",propertyName:"rowPaddingOuter"},version:h.CartesianSmallMultiplesPadding},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"subheader",propertyName:"fontFamily"},version:h.CartesianSmallMultiplesCombo},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"subheader",propertyName:"fontSize"},version:h.CartesianSmallMultiplesCombo},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"subheader",propertyName:"fontColor",isExprBound:!1},version:h.CartesianSmallMultiplesCombo},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"subheader",propertyName:"alignment"},version:h.CartesianSmallMultiplesCombo},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"subheader",propertyName:"position"},version:h.CartesianSmallMultiplesCombo},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"smallMultiplesLayout",propertyName:"layoutType"},version:h.CartesianSmallMultiplesCombo},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"smallMultiplesLayout",propertyName:"rowCount"},version:h.CartesianSmallMultiplesCombo},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"smallMultiplesLayout",propertyName:"columnCount"},version:h.CartesianSmallMultiplesCombo},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"smallMultiplesLayout",propertyName:"backgroundColor",isExprBound:!1},version:h.CartesianSmallMultiplesCombo},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"smallMultiplesLayout",propertyName:"backgroundTransparency"},version:h.CartesianSmallMultiplesCombo},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"smallMultiplesLayout",propertyName:"gridLineType"},version:h.CartesianSmallMultiplesCombo},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"smallMultiplesLayout",propertyName:"gridLineColor"},version:h.CartesianSmallMultiplesCombo},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"smallMultiplesLayout",propertyName:"gridLineWidth"},version:h.CartesianSmallMultiplesCombo},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"smallMultiplesLayout",propertyName:"gridLineStyle"},version:h.CartesianSmallMultiplesCombo},{types:u.ComboSmallMultipleFormattingVisualTypes,property:{objectName:"subheader",propertyName:"titleWrap"},version:h.CartesianSmallMultiplesCombo},{types:[F.visuals.plugins.areaChart.name,F.visuals.plugins.barChart.name,F.visuals.plugins.clusteredBarChart.name,F.visuals.plugins.clusteredColumnChart.name,F.visuals.plugins.columnChart.name,F.visuals.plugins.comboChart.name,F.visuals.plugins.dataDotClusteredColumnComboChart.name,F.visuals.plugins.dataDotStackedColumnComboChart.name,F.visuals.plugins.hundredPercentStackedBarChart.name,F.visuals.plugins.hundredPercentStackedColumnChart.name,F.visuals.plugins.lineChart.name,F.visuals.plugins.lineClusteredColumnComboChart.name,F.visuals.plugins.lineStackedColumnComboChart.name,F.visuals.plugins.ribbonChart.name,F.visuals.plugins.scatterChart.name,F.visuals.plugins.stackedAreaChart.name],property:{objectName:"categoryAxis",propertyName:"invertAxis"},version:h.InvertAxis},{types:[F.visuals.plugins.areaChart.name,F.visuals.plugins.barChart.name,F.visuals.plugins.clusteredBarChart.name,F.visuals.plugins.clusteredColumnChart.name,F.visuals.plugins.columnChart.name,F.visuals.plugins.comboChart.name,F.visuals.plugins.dataDotClusteredColumnComboChart.name,F.visuals.plugins.dataDotStackedColumnComboChart.name,F.visuals.plugins.hundredPercentStackedBarChart.name,F.visuals.plugins.hundredPercentStackedColumnChart.name,F.visuals.plugins.lineChart.name,F.visuals.plugins.lineClusteredColumnComboChart.name,F.visuals.plugins.lineStackedColumnComboChart.name,F.visuals.plugins.ribbonChart.name,F.visuals.plugins.scatterChart.name,F.visuals.plugins.stackedAreaChart.name,F.visuals.plugins.waterfallChart.name],property:{objectName:"valueAxis",propertyName:"invertAxis"},version:h.InvertAxis},{types:[F.visuals.plugins.areaChart.name,F.visuals.plugins.barChart.name,F.visuals.plugins.clusteredBarChart.name,F.visuals.plugins.clusteredColumnChart.name,F.visuals.plugins.columnChart.name,F.visuals.plugins.comboChart.name,F.visuals.plugins.dataDotClusteredColumnComboChart.name,F.visuals.plugins.dataDotStackedColumnComboChart.name,F.visuals.plugins.hundredPercentStackedBarChart.name,F.visuals.plugins.hundredPercentStackedColumnChart.name,F.visuals.plugins.lineChart.name,F.visuals.plugins.lineClusteredColumnComboChart.name,F.visuals.plugins.lineStackedColumnComboChart.name,F.visuals.plugins.ribbonChart.name,F.visuals.plugins.scatterChart.name,F.visuals.plugins.stackedAreaChart.name],property:{objectName:"y2Axis",propertyName:"secInvertAxis"},version:h.InvertAxis},{types:[F.visuals.plugins.areaChart.name,F.visuals.plugins.barChart.name,F.visuals.plugins.clusteredBarChart.name,F.visuals.plugins.clusteredColumnChart.name,F.visuals.plugins.columnChart.name,F.visuals.plugins.comboChart.name,F.visuals.plugins.dataDotClusteredColumnComboChart.name,F.visuals.plugins.dataDotStackedColumnComboChart.name,F.visuals.plugins.hundredPercentStackedBarChart.name,F.visuals.plugins.hundredPercentStackedColumnChart.name,F.visuals.plugins.lineChart.name,F.visuals.plugins.lineClusteredColumnComboChart.name,F.visuals.plugins.lineStackedColumnComboChart.name,F.visuals.plugins.ribbonChart.name,F.visuals.plugins.scatterChart.name,F.visuals.plugins.stackedAreaChart.name],property:{objectName:"valueAxis",propertyName:"secInvertAxis"},version:h.InvertAxis},{property:{objectName:"visualTooltip",propertyName:"actionFontColor"},version:h.EnhancedTooltips},{property:{objectName:"visualTooltip",propertyName:"themedTitleFontColor"},version:h.EnhancedTooltips},{property:{objectName:"visualTooltip",propertyName:"themedValueFontColor"},version:h.EnhancedTooltips},{property:{objectName:"visualTooltip",propertyName:"themedBackground"},version:h.EnhancedTooltips},{property:{objectName:"fill",propertyName:"fillColor",isExprBound:!0},version:u.ExplorationVersions.v5_21,types:[F.visuals.plugins.shape.name]},{property:{objectName:"outline",propertyName:"lineColor",isExprBound:!0},version:u.ExplorationVersions.v5_21,types:[F.visuals.plugins.shape.name]},{property:{objectName:"text",propertyName:"text",isExprBound:!0},version:u.ExplorationVersions.v5_21,types:[F.visuals.plugins.shape.name]},{property:{objectName:"text",propertyName:"fontColor",isExprBound:!0},version:u.ExplorationVersions.v5_21,types:[F.visuals.plugins.shape.name]},{property:{objectName:"shadow",propertyName:"color",isExprBound:!0},version:u.ExplorationVersions.v5_21,types:[F.visuals.plugins.shape.name]},{property:{objectName:"glow",propertyName:"color",isExprBound:!0},version:u.ExplorationVersions.v5_21,types:[F.visuals.plugins.shape.name]},{types:[i.map.name,i.filledMap.name,F.visuals.plugins.heatMap.name],property:{objectName:"mapControls",propertyName:"showLassoButton"},version:h.ShowLassoButton},{types:[F.visuals.plugins.lineChart.name,F.visuals.plugins.areaChart.name,F.visuals.plugins.stackedAreaChart.name],property:{objectName:"dataPoint",propertyName:"fill",matchByContents:function(e,t){return!t||t.data&&1===t.data.length&&a.isWildcard(t.data[0])}},version:h.LineChartExplicitDotsDefault},{types:[i.shapeMap.name],property:{objectName:"shape",propertyName:"map",matchByContents:function(e){if(e){e=e.name;if(e)return e.value===s.franceRegionsV2}return!1}},version:h.ShapeMapFranceUpdatedRegions},{property:{objectName:"visualHeaderTooltip",propertyName:"themedTitleFontColor"},version:h.EnhancedTooltipsForVisualHeaderTooltip},{property:{objectName:"visualHeaderTooltip",propertyName:"themedBackground"},version:h.EnhancedTooltipsForVisualHeaderTooltip},{types:[F.visuals.plugins.lineChart.name,F.visuals.plugins.areaChart.name,F.visuals.plugins.stackedAreaChart.name],property:{objectName:"dataPoint",propertyName:"transparency"},version:h.AreaChartTransparency},{types:y,property:{objectName:"subheader",propertyName:"show"},version:h.SmallMultiplesResponsive},{types:y,property:{objectName:"subheader",propertyName:"fontColor",isExprBound:!0},version:u.ExplorationVersions.v5_22},{types:y,property:{objectName:"smallMultiplesLayout",propertyName:"backgroundColor",isExprBound:!0},version:u.ExplorationVersions.v5_22},{types:__spreadArray([F.visuals.plugins.azureMap.name,F.visuals.plugins.donutChart.name,F.visuals.plugins.pieChart.name,F.visuals.plugins.map.name,F.visuals.plugins.filledMap.name,F.visuals.plugins.shapeMap.name,F.visuals.plugins.treemap.name],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"legend",propertyName:"labelColor",isExprBound:!0},version:h.ConditionalFormattingUpdates},{types:__spreadArray([F.visuals.plugins.azureMap.name,F.visuals.plugins.donutChart.name,F.visuals.plugins.pieChart.name,F.visuals.plugins.funnel.name,F.visuals.plugins.map.name,F.visuals.plugins.filledMap.name,F.visuals.plugins.shapeMap.name],u.CartesianExpressionBasedFormattingDataPointAndAxisExtentVisualTypes),property:{objectName:"dataPoint",propertyName:"fill",isExprBound:!0},version:h.ConditionalFormattingUpdates},{types:__spreadArray([F.visuals.plugins.donutChart.name,F.visuals.plugins.pieChart.name,F.visuals.plugins.funnel.name,F.visuals.plugins.map.name,F.visuals.plugins.filledMap.name,F.visuals.plugins.sunburst.name,F.visuals.plugins.treemap.name],u.CartesianExpressionBasedFormattingLabelVisualTypes),property:{objectName:"labels",propertyName:"color",isExprBound:!0},version:h.ConditionalFormattingUpdates},{types:u.CartesianExpressionBasedFormattingTotalsVisualTypes,property:{objectName:"totals",propertyName:"color",isExprBound:!0},version:h.ConditionalFormattingUpdates},{types:[F.visuals.plugins.funnel.name],property:{objectName:"percentBarLabel",propertyName:"color",isExprBound:!0},version:h.ConditionalFormattingUpdates},{types:[F.visuals.plugins.funnel.name],property:{objectName:"categoryAxis",propertyName:"color",isExprBound:!0},version:h.ConditionalFormattingUpdates},{types:u.CartesianExpressionBasedFormattingDataPointAndAxisExtentVisualTypes,property:{objectName:"categoryAxis",propertyName:"start",isExprBound:!0},version:h.ConditionalFormattingUpdates},{types:u.CartesianExpressionBasedFormattingDataPointAndAxisExtentVisualTypes,property:{objectName:"categoryAxis",propertyName:"end",isExprBound:!0},version:h.ConditionalFormattingUpdates},{types:u.CartesianExpressionBasedFormattingDataPointAndAxisExtentVisualTypes,property:{objectName:"categoryAxis",propertyName:"titleColor",isExprBound:!0},version:h.ConditionalFormattingUpdates},{types:u.CartesianExpressionBasedFormattingDataPointAndAxisExtentVisualTypes,property:{objectName:"categoryAxis",propertyName:"gridlineColor",isExprBound:!0},version:h.ConditionalFormattingUpdates},{types:u.CartesianExpressionBasedFormattingVisualTypes,property:{objectName:"categoryAxis",propertyName:"labelColor",isExprBound:!0},version:h.ConditionalFormattingUpdates},{types:u.CartesianExpressionBasedFormattingDataPointAndAxisExtentVisualTypes,property:{objectName:"valueAxis",propertyName:"start",isExprBound:!0},version:h.ConditionalFormattingUpdates},{types:u.CartesianExpressionBasedFormattingDataPointAndAxisExtentVisualTypes,property:{objectName:"valueAxis",propertyName:"end",isExprBound:!0},version:h.ConditionalFormattingUpdates},{types:u.CartesianExpressionBasedFormattingDataPointAndAxisExtentVisualTypes,property:{objectName:"valueAxis",propertyName:"titleColor",isExprBound:!0},version:h.ConditionalFormattingUpdates},{types:u.CartesianExpressionBasedFormattingDataPointAndAxisExtentVisualTypes,property:{objectName:"valueAxis",propertyName:"gridlineColor",isExprBound:!0},version:h.ConditionalFormattingUpdates},{types:u.CartesianExpressionBasedFormattingVisualTypes,property:{objectName:"valueAxis",propertyName:"labelColor",isExprBound:!0},version:h.ConditionalFormattingUpdates},{types:u.CartesianExpressionBasedFormattingValueAxisSecVisualTypes,property:{objectName:"valueAxis",propertyName:"secStart",isExprBound:!0},version:h.ConditionalFormattingUpdates},{types:u.CartesianExpressionBasedFormattingValueAxisSecVisualTypes,property:{objectName:"valueAxis",propertyName:"secEnd",isExprBound:!0},version:h.ConditionalFormattingUpdates},{types:[F.visuals.plugins.areaChart.name,F.visuals.plugins.lineChart.name],property:{objectName:"y2Axis",propertyName:"secStart",isExprBound:!0},version:h.ConditionalFormattingUpdates},{types:[F.visuals.plugins.areaChart.name,F.visuals.plugins.lineChart.name],property:{objectName:"y2Axis",propertyName:"secEnd",isExprBound:!0},version:h.ConditionalFormattingUpdates},{types:[F.visuals.plugins.multiRowCard.name],property:{objectName:"cardTitle",propertyName:"color",isExprBound:!0},version:h.ConditionalFormattingUpdates},{types:[F.visuals.plugins.multiRowCard.name],property:{objectName:"dataLabels",propertyName:"color",isExprBound:!0},version:h.ConditionalFormattingUpdates},{types:[F.visuals.plugins.multiRowCard.name,F.visuals.plugins.treemap.name],property:{objectName:"categoryLabels",propertyName:"color",isExprBound:!0},version:h.ConditionalFormattingUpdates},{types:[F.visuals.plugins.gauge.name],property:{objectName:"axis",propertyName:"min",isExprBound:!0},version:h.ConditionalFormattingUpdates},{types:[F.visuals.plugins.gauge.name],property:{objectName:"axis",propertyName:"max",isExprBound:!0},version:h.ConditionalFormattingUpdates},{types:[F.visuals.plugins.gauge.name],property:{objectName:"axis",propertyName:"target",isExprBound:!0},version:h.ConditionalFormattingUpdates},{types:[F.visuals.plugins.slicer.name],property:{objectName:"slider",propertyName:"color",isExprBound:!0},version:h.ConditionalFormattingUpdates},{types:[F.visuals.plugins.slicer.name],property:{objectName:"header",propertyName:"fontColor",isExprBound:!0},version:h.ConditionalFormattingUpdates},{types:[F.visuals.plugins.slicer.name],property:{objectName:"header",propertyName:"background",isExprBound:!0},version:h.ConditionalFormattingUpdates},{property:{objectName:"visualLink",propertyName:"showDefaultTooltip"},version:h.SuppressDefaultTooltip},{property:{objectName:"shape",propertyName:"arrowheadSize"},version:h.ShapeFormattingFeatures,types:[F.visuals.plugins.shape.name,F.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"arrowStemWidth"},version:h.ShapeFormattingFeatures,types:[F.visuals.plugins.shape.name,F.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"chevronAngle"},version:h.ShapeFormattingFeatures,types:[F.visuals.plugins.shape.name,F.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"isocelesTriangleTipPosition"},version:h.ShapeFormattingFeatures,types:[F.visuals.plugins.shape.name,F.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"parallelogramSlant"},version:h.ShapeFormattingFeatures,types:[F.visuals.plugins.shape.name,F.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"trapezoidSlant"},version:h.ShapeFormattingFeatures,types:[F.visuals.plugins.shape.name,F.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"hexagonSlant"},version:h.ShapeFormattingFeatures,types:[F.visuals.plugins.shape.name,F.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"octagonSnipSize"},version:h.ShapeFormattingFeatures,types:[F.visuals.plugins.shape.name,F.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"speechBubbleHeight"},version:h.ShapeFormattingFeatures,types:[F.visuals.plugins.shape.name,F.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"speechBubbleTailPosition"},version:h.ShapeFormattingFeatures,types:[F.visuals.plugins.shape.name,F.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"speechBubbleTailAngle"},version:h.ShapeFormattingFeatures,types:[F.visuals.plugins.shape.name,F.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"rectangleRoundedCurve"},version:h.ShapeFormattingFeatures,types:[F.visuals.plugins.shape.name,F.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"tabCutCornerSnipSizeTopRight"},version:h.ShapeFormattingFeatures,types:[F.visuals.plugins.shape.name,F.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"tabCutCornerSnipSizeTop"},version:h.ShapeFormattingFeatures,types:[F.visuals.plugins.shape.name,F.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"tabCutCornerSnipSizeBottom"},version:h.ShapeFormattingFeatures,types:[F.visuals.plugins.shape.name,F.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"tabRoundCornerTopRight"},version:h.ShapeFormattingFeatures,types:[F.visuals.plugins.shape.name,F.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"tabRoundCornerTop"},version:h.ShapeFormattingFeatures,types:[F.visuals.plugins.shape.name,F.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"tabRoundCornerBottom"},version:h.ShapeFormattingFeatures,types:[F.visuals.plugins.shape.name,F.visuals.plugins.actionButton.name]},{property:{objectName:"xAxisReferenceLine",propertyName:"*"},version:h.XAxisRefLineImprovements,types:[F.visuals.plugins.areaChart.name,F.visuals.plugins.columnChart.name,F.visuals.plugins.barChart.name,F.visuals.plugins.clusteredBarChart.name,F.visuals.plugins.clusteredColumnChart.name,F.visuals.plugins.hundredPercentStackedBarChart.name,F.visuals.plugins.hundredPercentStackedColumnChart.name,F.visuals.plugins.comboChart.name,F.visuals.plugins.lineStackedColumnComboChart.name,F.visuals.plugins.lineClusteredColumnComboChart.name,F.visuals.plugins.ribbonChart.name,F.visuals.plugins.stackedAreaChart.name]},{property:{objectName:"xAxisReferenceLine",propertyName:"value",isExprBound:!0},version:h.XAxisRefLineImprovements,types:[F.visuals.plugins.lineChart.name]},{property:{objectName:"xAxisReferenceLine",propertyName:"shadeRegion"},version:h.XAxisRefLineImprovements,types:[F.visuals.plugins.lineChart.name]},{property:{objectName:"xAxisReferenceLine",propertyName:"shadeColor"},version:h.XAxisRefLineImprovements,types:[F.visuals.plugins.lineChart.name]},{property:{objectName:"xAxisReferenceLine",propertyName:"shadeTransparency"},version:h.XAxisRefLineImprovements,types:[F.visuals.plugins.lineChart.name]},{property:{objectName:"title",propertyName:"heading"},version:h.AccessibilityTopLevelNav},{property:{objectName:"text",propertyName:"leftMargin"},version:h.ButtonTileFormatting,types:[F.visuals.plugins.actionButton.name]},{property:{objectName:"text",propertyName:"rightMargin"},version:h.ButtonTileFormatting,types:[F.visuals.plugins.actionButton.name]},{property:{objectName:"text",propertyName:"topMargin"},version:h.ButtonTileFormatting,types:[F.visuals.plugins.actionButton.name]},{property:{objectName:"text",propertyName:"bottomMargin"},version:h.ButtonTileFormatting,types:[F.visuals.plugins.actionButton.name]},{property:{objectName:"icon",propertyName:"image"},version:h.ButtonTileFormatting,types:[F.visuals.plugins.actionButton.name]},{property:{objectName:"icon",propertyName:"leftMargin"},version:h.ButtonTileFormatting,types:[F.visuals.plugins.actionButton.name]},{property:{objectName:"icon",propertyName:"rightMargin"},version:h.ButtonTileFormatting,types:[F.visuals.plugins.actionButton.name]},{property:{objectName:"icon",propertyName:"topMargin"},version:h.ButtonTileFormatting,types:[F.visuals.plugins.actionButton.name]},{property:{objectName:"icon",propertyName:"bottomMargin"},version:h.ButtonTileFormatting,types:[F.visuals.plugins.actionButton.name]},{property:{objectName:"icon",propertyName:"placement"},version:h.ButtonTileFormatting,types:[F.visuals.plugins.actionButton.name]},{property:{objectName:"icon",propertyName:"iconSize"},version:h.ButtonTileFormatting,types:[F.visuals.plugins.actionButton.name]},{property:{objectName:"shape",propertyName:"*"},version:h.ButtonTileFormatting,types:[F.visuals.plugins.actionButton.name]},{property:{objectName:"shadow",propertyName:"*"},version:h.ButtonTileFormatting,types:[F.visuals.plugins.actionButton.name]},{property:{objectName:"glow",propertyName:"*"},version:h.ButtonTileFormatting,types:[F.visuals.plugins.actionButton.name]},{property:{objectName:"rotation",propertyName:"*"},version:h.ButtonTileFormatting,types:[F.visuals.plugins.actionButton.name]},{property:{objectName:"seriesLabels",propertyName:"*"},version:h.LineChartSeriesLabels,types:[F.visuals.plugins.comboChart.name,F.visuals.plugins.lineChart.name,F.visuals.plugins.areaChart.name,F.visuals.plugins.stackedAreaChart.name,F.visuals.plugins.lineClusteredColumnComboChart.name,F.visuals.plugins.lineStackedColumnComboChart.name]},{types:[F.visuals.plugins.waterfallChart.name],property:{objectName:"valueAxis",propertyName:"totalsEnabled"},version:h.WaterfallChartTotals},{types:[F.visuals.plugins.azureMap.name],property:{objectName:"heatMapLayer",propertyName:"*"},version:h.AzureMapHeatmapLayer},{types:[F.visuals.plugins.pageNavigator.name,F.visuals.plugins.bookmarkNavigator.name],property:{objectName:"background",propertyName:"show"},version:h.NavigatorVisuals},{types:[F.visuals.plugins.pageNavigator.name,F.visuals.plugins.bookmarkNavigator.name],property:{objectName:"visualHeader",propertyName:"show"},version:h.NavigatorVisuals},{property:{objectName:"slices",propertyName:"startAngle"},version:h.DonutChartStartAngle,types:[F.visuals.plugins.donutChart.name,F.visuals.plugins.pieChart.name]},{types:[F.visuals.plugins.donutChart.name,F.visuals.plugins.pieChart.name],property:{objectName:"slices",propertyName:"borderWidth"},version:h.PieChartMarginBetweenSlices},{types:[F.visuals.plugins.donutChart.name,F.visuals.plugins.pieChart.name],property:{objectName:"slices",propertyName:"borderColor"},version:h.PieChartMarginBetweenSlices},{types:[F.visuals.plugins.donutChart.name,F.visuals.plugins.pieChart.name],property:{objectName:"slices",propertyName:"explode"},version:h.PieChartMarginBetweenSlices},{types:[F.visuals.plugins.pieChart.name],property:{objectName:"slices",propertyName:"innerRadiusRatio"},version:h.PieChartMarginBetweenSlices},{types:__spreadArray([F.visuals.plugins.azureMap.name,F.visuals.plugins.donutChart.name,F.visuals.plugins.pieChart.name,F.visuals.plugins.map.name,F.visuals.plugins.filledMap.name,F.visuals.plugins.shapeMap.name,F.visuals.plugins.treemap.name,F.visuals.plugins.heatMap.name],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"legend",propertyName:"bold"},version:h.BoldItalicUnderlineComponent},{types:__spreadArray([F.visuals.plugins.azureMap.name,F.visuals.plugins.donutChart.name,F.visuals.plugins.pieChart.name,F.visuals.plugins.map.name,F.visuals.plugins.filledMap.name,F.visuals.plugins.shapeMap.name,F.visuals.plugins.treemap.name,F.visuals.plugins.heatMap.name],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"legend",propertyName:"italic"},version:h.BoldItalicUnderlineComponent},{types:__spreadArray([F.visuals.plugins.azureMap.name,F.visuals.plugins.donutChart.name,F.visuals.plugins.pieChart.name,F.visuals.plugins.map.name,F.visuals.plugins.filledMap.name,F.visuals.plugins.shapeMap.name,F.visuals.plugins.treemap.name,F.visuals.plugins.heatMap.name],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"legend",propertyName:"underline"},version:h.BoldItalicUnderlineComponent},{types:__spreadArray([F.visuals.plugins.funnel.name,F.visuals.plugins.scatterChart.name],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"categoryAxis",propertyName:"bold"},version:h.BoldItalicUnderlineComponent},{types:__spreadArray([F.visuals.plugins.funnel.name,F.visuals.plugins.scatterChart.name],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"categoryAxis",propertyName:"italic"},version:h.BoldItalicUnderlineComponent},{types:__spreadArray([F.visuals.plugins.funnel.name,F.visuals.plugins.scatterChart.name],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"categoryAxis",propertyName:"underline"},version:h.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"categoryAxis",propertyName:"titleBold"},version:h.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"categoryAxis",propertyName:"titleItalic"},version:h.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"categoryAxis",propertyName:"titleUnderline"},version:h.BoldItalicUnderlineComponent},{types:__spreadArray([F.visuals.plugins.scatterChart.name],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"valueAxis",propertyName:"bold"},version:h.BoldItalicUnderlineComponent},{types:__spreadArray([F.visuals.plugins.scatterChart.name],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"valueAxis",propertyName:"italic"},version:h.BoldItalicUnderlineComponent},{types:__spreadArray([F.visuals.plugins.scatterChart.name],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"valueAxis",propertyName:"underline"},version:h.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"valueAxis",propertyName:"titleBold"},version:h.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"valueAxis",propertyName:"titleItalic"},version:h.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"valueAxis",propertyName:"titleUnderline"},version:h.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"valueAxis",propertyName:"secBold"},version:h.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"valueAxis",propertyName:"secItalic"},version:h.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"valueAxis",propertyName:"secUnderline"},version:h.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"valueAxis",propertyName:"secTitleBold"},version:h.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"valueAxis",propertyName:"secTitleItalic"},version:h.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"valueAxis",propertyName:"secTitleUnderline"},version:h.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"y2Axis",propertyName:"secBold"},version:h.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"y2Axis",propertyName:"secItalic"},version:h.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"y2Axis",propertyName:"secUnderline"},version:h.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"y2Axis",propertyName:"secTitleBold"},version:h.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"y2Axis",propertyName:"secTitleItalic"},version:h.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"y2Axis",propertyName:"secTitleUnderline"},version:h.BoldItalicUnderlineComponent},{types:__spreadArray([F.visuals.plugins.azureMap.name,F.visuals.plugins.card.name,F.visuals.plugins.donutChart.name,F.visuals.plugins.funnel.name,F.visuals.plugins.gauge.name,F.visuals.plugins.pieChart.name,F.visuals.plugins.map.name,F.visuals.plugins.filledMap.name,F.visuals.plugins.shapeMap.name,F.visuals.plugins.treemap.name],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"labels",propertyName:"bold"},version:h.BoldItalicUnderlineComponent},{types:__spreadArray([F.visuals.plugins.azureMap.name,F.visuals.plugins.card.name,F.visuals.plugins.donutChart.name,F.visuals.plugins.funnel.name,F.visuals.plugins.gauge.name,F.visuals.plugins.pieChart.name,F.visuals.plugins.map.name,F.visuals.plugins.filledMap.name,F.visuals.plugins.shapeMap.name,F.visuals.plugins.treemap.name],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"labels",propertyName:"italic"},version:h.BoldItalicUnderlineComponent},{types:__spreadArray([F.visuals.plugins.azureMap.name,F.visuals.plugins.card.name,F.visuals.plugins.donutChart.name,F.visuals.plugins.funnel.name,F.visuals.plugins.gauge.name,F.visuals.plugins.pieChart.name,F.visuals.plugins.map.name,F.visuals.plugins.filledMap.name,F.visuals.plugins.shapeMap.name,F.visuals.plugins.treemap.name],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"labels",propertyName:"underline"},version:h.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"seriesLabels",propertyName:"bold"},version:h.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"seriesLabels",propertyName:"italic"},version:h.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"seriesLabels",propertyName:"underline"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.azureMap.name,F.visuals.plugins.card.name,F.visuals.plugins.multiRowCard.name,F.visuals.plugins.donutChart.name,F.visuals.plugins.scatterChart.name,F.visuals.plugins.pieChart.name,F.visuals.plugins.map.name,F.visuals.plugins.filledMap.name,F.visuals.plugins.shapeMap.name,F.visuals.plugins.treemap.name,F.visuals.plugins.heatMap.name],property:{objectName:"categoryLabels",propertyName:"bold"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.azureMap.name,F.visuals.plugins.card.name,F.visuals.plugins.multiRowCard.name,F.visuals.plugins.donutChart.name,F.visuals.plugins.scatterChart.name,F.visuals.plugins.pieChart.name,F.visuals.plugins.map.name,F.visuals.plugins.filledMap.name,F.visuals.plugins.shapeMap.name,F.visuals.plugins.treemap.name,F.visuals.plugins.heatMap.name],property:{objectName:"categoryLabels",propertyName:"italic"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.azureMap.name,F.visuals.plugins.card.name,F.visuals.plugins.multiRowCard.name,F.visuals.plugins.donutChart.name,F.visuals.plugins.scatterChart.name,F.visuals.plugins.pieChart.name,F.visuals.plugins.map.name,F.visuals.plugins.filledMap.name,F.visuals.plugins.shapeMap.name,F.visuals.plugins.treemap.name,F.visuals.plugins.heatMap.name],property:{objectName:"categoryLabels",propertyName:"underline"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.multiRowCard.name],property:{objectName:"dataLabels",propertyName:"bold"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.multiRowCard.name],property:{objectName:"dataLabels",propertyName:"italic"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.multiRowCard.name],property:{objectName:"dataLabels",propertyName:"underline"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.multiRowCard.name],property:{objectName:"cardTitle",propertyName:"bold"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.multiRowCard.name],property:{objectName:"cardTitle",propertyName:"italic"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.multiRowCard.name],property:{objectName:"cardTitle",propertyName:"underline"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.funnel.name],property:{objectName:"percentBarLabel",propertyName:"bold"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.funnel.name],property:{objectName:"percentBarLabel",propertyName:"italic"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.funnel.name],property:{objectName:"percentBarLabel",propertyName:"underline"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.gauge.name],property:{objectName:"target",propertyName:"bold"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.gauge.name],property:{objectName:"target",propertyName:"italic"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.gauge.name],property:{objectName:"target",propertyName:"underline"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.gauge.name],property:{objectName:"calloutValue",propertyName:"bold"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.gauge.name],property:{objectName:"calloutValue",propertyName:"italic"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.gauge.name],property:{objectName:"calloutValue",propertyName:"underline"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"bold"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"italic"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"underline"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"titleBold"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"titleItalic"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.kpi.name],property:{objectName:"goals",propertyName:"titleUnderline"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.kpi.name],property:{objectName:"lastDate",propertyName:"bold"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.kpi.name],property:{objectName:"lastDate",propertyName:"italic"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.kpi.name],property:{objectName:"lastDate",propertyName:"underline"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.kpi.name],property:{objectName:"indicator",propertyName:"bold"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.kpi.name],property:{objectName:"indicator",propertyName:"italic"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.kpi.name],property:{objectName:"indicator",propertyName:"underline"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.decompositionTreeVisual.name],property:{objectName:"categoryLabels",propertyName:"categoryLabelBold"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.decompositionTreeVisual.name],property:{objectName:"categoryLabels",propertyName:"categoryLabelItalic"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.decompositionTreeVisual.name],property:{objectName:"categoryLabels",propertyName:"categoryLabelUnderline"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.decompositionTreeVisual.name],property:{objectName:"dataLabels",propertyName:"dataLabelBold"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.decompositionTreeVisual.name],property:{objectName:"dataLabels",propertyName:"dataLabelItalic"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.decompositionTreeVisual.name],property:{objectName:"dataLabels",propertyName:"dataLabelUnderline"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.decompositionTreeVisual.name],property:{objectName:"levelHeader",propertyName:"levelTitleBold"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.decompositionTreeVisual.name],property:{objectName:"levelHeader",propertyName:"levelTitleItalic"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.decompositionTreeVisual.name],property:{objectName:"levelHeader",propertyName:"levelTitleUnderline"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.decompositionTreeVisual.name],property:{objectName:"levelHeader",propertyName:"levelSubtitleBold"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.decompositionTreeVisual.name],property:{objectName:"levelHeader",propertyName:"levelSubtitleItalic"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.decompositionTreeVisual.name],property:{objectName:"levelHeader",propertyName:"levelSubtitleUnderline"},version:h.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"subheader",propertyName:"bold"},version:h.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"subheader",propertyName:"italic"},version:h.BoldItalicUnderlineComponent},{types:__spreadArray([],u.CartesianExpressionBasedFormattingVisualTypes),property:{objectName:"subheader",propertyName:"underline"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.pivotTable.name,F.visuals.plugins.tableEx.name],property:{objectName:"columnHeaders",propertyName:"bold"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.pivotTable.name,F.visuals.plugins.tableEx.name],property:{objectName:"columnHeaders",propertyName:"italic"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.pivotTable.name,F.visuals.plugins.tableEx.name],property:{objectName:"columnHeaders",propertyName:"underline"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.pivotTable.name,F.visuals.plugins.tableEx.name],property:{objectName:"values",propertyName:"bold"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.pivotTable.name,F.visuals.plugins.tableEx.name],property:{objectName:"values",propertyName:"italic"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.pivotTable.name,F.visuals.plugins.tableEx.name],property:{objectName:"values",propertyName:"underline"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.tableEx.name],property:{objectName:"total",propertyName:"bold"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.tableEx.name],property:{objectName:"total",propertyName:"italic"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.tableEx.name],property:{objectName:"total",propertyName:"underline"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.pivotTable.name],property:{objectName:"rowTotal",propertyName:"bold"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.pivotTable.name],property:{objectName:"rowTotal",propertyName:"italic"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.pivotTable.name],property:{objectName:"rowTotal",propertyName:"underline"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.pivotTable.name],property:{objectName:"columnTotal",propertyName:"bold"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.pivotTable.name],property:{objectName:"columnTotal",propertyName:"italic"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.pivotTable.name],property:{objectName:"columnTotal",propertyName:"underline"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.pivotTable.name],property:{objectName:"rowHeaders",propertyName:"bold"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.pivotTable.name],property:{objectName:"rowHeaders",propertyName:"italic"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.pivotTable.name],property:{objectName:"rowHeaders",propertyName:"underline"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.pivotTable.name],property:{objectName:"subTotals",propertyName:"bold"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.pivotTable.name],property:{objectName:"subTotals",propertyName:"italic"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.pivotTable.name],property:{objectName:"subTotals",propertyName:"underline"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.barChart.name,F.visuals.plugins.columnChart.name,F.visuals.plugins.dataDotStackedColumnComboChart.name,F.visuals.plugins.lineStackedColumnComboChart.name,F.visuals.plugins.hundredPercentStackedBarChart.name,F.visuals.plugins.hundredPercentStackedColumnChart.name,F.visuals.plugins.stackedAreaChart.name],property:{objectName:"totals",propertyName:"bold"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.barChart.name,F.visuals.plugins.columnChart.name,F.visuals.plugins.dataDotStackedColumnComboChart.name,F.visuals.plugins.lineStackedColumnComboChart.name,F.visuals.plugins.hundredPercentStackedBarChart.name,F.visuals.plugins.hundredPercentStackedColumnChart.name,F.visuals.plugins.stackedAreaChart.name],property:{objectName:"totals",propertyName:"italic"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.barChart.name,F.visuals.plugins.columnChart.name,F.visuals.plugins.dataDotStackedColumnComboChart.name,F.visuals.plugins.lineStackedColumnComboChart.name,F.visuals.plugins.hundredPercentStackedBarChart.name,F.visuals.plugins.hundredPercentStackedColumnChart.name,F.visuals.plugins.stackedAreaChart.name],property:{objectName:"totals",propertyName:"underline"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.qnaVisual.name],property:{objectName:"inputBox",propertyName:"questionBold"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.qnaVisual.name],property:{objectName:"inputBox",propertyName:"questionItalic"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.qnaVisual.name],property:{objectName:"inputBox",propertyName:"questionUnderline"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.qnaVisual.name],property:{objectName:"suggestions",propertyName:"headerBold"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.qnaVisual.name],property:{objectName:"suggestions",propertyName:"headerItalic"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.qnaVisual.name],property:{objectName:"suggestions",propertyName:"headerUnderline"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.qnaVisual.name],property:{objectName:"suggestions",propertyName:"cardBold"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.qnaVisual.name],property:{objectName:"suggestions",propertyName:"cardItalic"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.qnaVisual.name],property:{objectName:"suggestions",propertyName:"cardUnderline"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.slicer.name,F.visuals.plugins.filterSlicer.name],property:{objectName:"header",propertyName:"bold"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.slicer.name,F.visuals.plugins.filterSlicer.name],property:{objectName:"header",propertyName:"italic"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.slicer.name,F.visuals.plugins.filterSlicer.name],property:{objectName:"header",propertyName:"underline"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.slicer.name,F.visuals.plugins.filterSlicer.name],property:{objectName:"items",propertyName:"bold"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.slicer.name,F.visuals.plugins.filterSlicer.name],property:{objectName:"items",propertyName:"italic"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.slicer.name,F.visuals.plugins.filterSlicer.name],property:{objectName:"items",propertyName:"underline"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.slicer.name,F.visuals.plugins.filterSlicer.name],property:{objectName:"date",propertyName:"bold"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.slicer.name,F.visuals.plugins.filterSlicer.name],property:{objectName:"date",propertyName:"italic"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.slicer.name,F.visuals.plugins.filterSlicer.name],property:{objectName:"date",propertyName:"underline"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.slicer.name,F.visuals.plugins.filterSlicer.name],property:{objectName:"numericInputStyle",propertyName:"bold"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.slicer.name,F.visuals.plugins.filterSlicer.name],property:{objectName:"numericInputStyle",propertyName:"italic"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.slicer.name,F.visuals.plugins.filterSlicer.name],property:{objectName:"numericInputStyle",propertyName:"underline"},version:h.BoldItalicUnderlineComponent},{property:{objectName:"title",propertyName:"bold"},version:h.BoldItalicUnderlineComponent},{property:{objectName:"title",propertyName:"italic"},version:h.BoldItalicUnderlineComponent},{property:{objectName:"title",propertyName:"underline"},version:h.BoldItalicUnderlineComponent},{property:{objectName:"visualTooltip",propertyName:"bold"},version:h.BoldItalicUnderlineComponent},{property:{objectName:"visualTooltip",propertyName:"italic"},version:h.BoldItalicUnderlineComponent},{property:{objectName:"visualTooltip",propertyName:"underline"},version:h.BoldItalicUnderlineComponent},{types:[F.visuals.plugins.textbox.name],property:__assign(__assign({},F.visuals.textboxProps.general.paragraphs),{matchByContents:function(e,t){if(F.StructuralObjectDefinition.isParagraphsDefinition(e))for(var r=0,i=e;r<i.length;r++){var a=i[r];if(a&&!_.isEmpty(a.listType))return!0}return!1}}),version:h.TextboxSuperSubScriptBulletedList},{types:[i.rdlVisual.name],property:{objectName:"toolbar",propertyName:"pageNavigation"},version:h.RdlVisualToolbarConfig},{types:[i.rdlVisual.name],property:{objectName:"toolbar",propertyName:"useFloatingToolbar"},version:h.RdlVisualToolbarConfig},{types:[i.rdlVisual.name],property:{objectName:"toolbar",propertyName:"openReportButton"},version:h.RdlVisualToolbarConfig},{types:[i.rdlVisual.name],property:{objectName:"toolbar",propertyName:"position"},version:h.RdlVisualToolbarConfig},{types:[i.rdlVisual.name],property:{objectName:"export",propertyName:"show"},version:h.RdlVisualToolbarConfig},{types:[i.rdlVisual.name],property:{objectName:"export",propertyName:"exportExcel"},version:h.RdlVisualToolbarConfig},{types:[i.rdlVisual.name],property:{objectName:"export",propertyName:"exportPDF"},version:h.RdlVisualToolbarConfig},{types:[i.rdlVisual.name],property:{objectName:"export",propertyName:"exportAccessiblePDF"},version:h.RdlVisualToolbarConfig},{types:[i.rdlVisual.name],property:{objectName:"export",propertyName:"exportCSV"},version:h.RdlVisualToolbarConfig},{types:[i.rdlVisual.name],property:{objectName:"export",propertyName:"exportPPTX"},version:h.RdlVisualToolbarConfig},{types:[i.rdlVisual.name],property:{objectName:"export",propertyName:"exportWord"},version:h.RdlVisualToolbarConfig},{types:[i.rdlVisual.name],property:{objectName:"export",propertyName:"exportMHTML"},version:h.RdlVisualToolbarConfig},{types:[i.rdlVisual.name],property:{objectName:"export",propertyName:"exportXML"},version:h.RdlVisualToolbarConfig},{property:F.visuals.scorecardProps.scorecard.showCommandBar,types:[i.scorecard.name],version:h.ScorecardCommandBarToggle},{types:[F.visuals.plugins.azureMap.name],property:{objectName:"heatMapLayer",propertyName:"mapTransparency"},version:h.AzureMapHeatmapOpacityToTransparency},{types:[F.visuals.plugins.tableEx.name,F.visuals.plugins.pivotTable.name],property:{objectName:"sparklines",propertyName:"*"},version:h.Sparklines},{types:[F.visuals.plugins.slicer.name,F.visuals.plugins.filterSlicer.name],property:{objectName:"date",propertyName:"hideDatePickerButton"},version:h.SlicerAccessibility},{types:[F.visuals.plugins.slicer.name,F.visuals.plugins.filterSlicer.name],property:{objectName:"items",propertyName:"padding"},version:h.SlicerAccessibility},{types:[F.visuals.plugins.slicer.name,F.visuals.plugins.filterSlicer.name],property:{objectName:"items",propertyName:"accessibilityContrastProperties"},version:h.SlicerAccessibility},{types:[F.visuals.plugins.azureMap.name],property:{objectName:"mapControls",propertyName:"geocodingCulture"},version:h.AzureMapsGeocoding},{types:[F.visuals.plugins.comboChart.name,F.visuals.plugins.dataDotClusteredColumnComboChart.name,F.visuals.plugins.dataDotStackedColumnComboChart.name,F.visuals.plugins.lineClusteredColumnComboChart.name,F.visuals.plugins.lineStackedColumnComboChart.name],property:{objectName:"legend",propertyName:"legendMarkerRendering"},version:h.RemoveDefaultToCircleToggle},{types:[F.visuals.plugins.tableEx.name,F.visuals.plugins.pivotTable.name],property:{objectName:"grid",propertyName:"outlineStyle"},version:h.UpgradeOutlineProperties},{types:[F.visuals.plugins.tableEx.name,F.visuals.plugins.pivotTable.name],property:{objectName:"columnHeaders",propertyName:"outlineWeight"},version:h.UpgradeOutlineProperties},{types:[F.visuals.plugins.tableEx.name,F.visuals.plugins.pivotTable.name],property:{objectName:"columnHeaders",propertyName:"outlineColor"},version:h.UpgradeOutlineProperties},{types:[F.visuals.plugins.pivotTable.name],property:{objectName:"rowHeaders",propertyName:"outlineWeight"},version:h.UpgradeOutlineProperties},{types:[F.visuals.plugins.pivotTable.name],property:{objectName:"rowHeaders",propertyName:"outlineColor"},version:h.UpgradeOutlineProperties},{types:[F.visuals.plugins.tableEx.name],property:{objectName:"total",propertyName:"outlineWeight"},version:h.UpgradeOutlineProperties},{types:[F.visuals.plugins.tableEx.name],property:{objectName:"total",propertyName:"outlineColor"},version:h.UpgradeOutlineProperties},{types:[F.visuals.plugins.tableEx.name,F.visuals.plugins.pivotTable.name],property:{objectName:"values",propertyName:"outlineWeight"},version:h.UpgradeOutlineProperties},{types:[F.visuals.plugins.tableEx.name,F.visuals.plugins.pivotTable.name],property:{objectName:"values",propertyName:"outlineColor"},version:h.UpgradeOutlineProperties},{property:{objectName:"visualHeaderTooltip",propertyName:"type"},version:h.SplitHelpTooltip},{property:{objectName:"legend",propertyName:"position",matchByContents:function(e,t){e=e&&e.value;return e===r.topRight||e===r.bottomRight}},version:h.LegendPositionNewFormatPane,types:[F.visuals.plugins.areaChart.name,F.visuals.plugins.azureMap.name,F.visuals.plugins.barChart.name,F.visuals.plugins.clusteredBarChart.name,F.visuals.plugins.clusteredColumnChart.name,F.visuals.plugins.columnChart.name,F.visuals.plugins.donutChart.name,F.visuals.plugins.filledMap.name,F.visuals.plugins.hundredPercentStackedBarChart.name,F.visuals.plugins.hundredPercentStackedColumnChart.name,F.visuals.plugins.lineChart.name,F.visuals.plugins.lineClusteredColumnComboChart.name,F.visuals.plugins.lineStackedColumnComboChart.name,F.visuals.plugins.map.name,F.visuals.plugins.pieChart.name,F.visuals.plugins.ribbonChart.name,F.visuals.plugins.scatterChart.name,F.visuals.plugins.shapeMap.name,F.visuals.plugins.stackedAreaChart.name,F.visuals.plugins.treemap.name,F.visuals.plugins.waterfallChart.name]},{types:[F.visuals.plugins.pivotTable.name,F.visuals.plugins.tableEx.name],property:{objectName:"stylePreset",propertyName:"name",matchByContents:function(e){return e.value===F.visuals.stylePresets.TablixStylePresetsName.AlternatingRowsNew}},version:h.NewAlternatingRowsStyle},{types:[F.visuals.plugins.tableEx.name],property:{objectName:"accessibility",propertyName:"altTextColumns"},version:h.AltTextColumns},{types:[F.visuals.plugins.tableEx.name],property:{objectName:"accessibility",propertyName:"rowWithReferenceText"},version:h.RowWithReferenceText},{types:[F.visuals.plugins.lineChart.name,F.visuals.plugins.clusteredBarChart.name,F.visuals.plugins.clusteredColumnChart.name,F.visuals.plugins.lineStackedColumnComboChart.name,F.visuals.plugins.lineClusteredColumnComboChart.name,F.visuals.plugins.barChart.name,F.visuals.plugins.columnChart.name,F.visuals.plugins.hundredPercentStackedBarChart.name,F.visuals.plugins.hundredPercentStackedColumnChart.name,F.visuals.plugins.ribbonChart.name],property:{objectName:"error",propertyName:"*"},version:h.ErrorBars},{types:[F.visuals.plugins.gauge.name],property:{objectName:"calloutValue",propertyName:"fontFamily"},version:h.GaugeChartCalloutTextFormatting},{types:[F.visuals.plugins.gauge.name],property:{objectName:"calloutValue",propertyName:"bold"},version:h.GaugeChartCalloutTextFormatting},{types:[F.visuals.plugins.gauge.name],property:{objectName:"calloutValue",propertyName:"italic"},version:h.GaugeChartCalloutTextFormatting},{types:[F.visuals.plugins.gauge.name],property:{objectName:"calloutValue",propertyName:"underline"},version:h.GaugeChartCalloutTextFormatting},{types:[F.visuals.plugins.slicer.name,F.visuals.plugins.filterSlicer.name],property:{objectName:"slider",propertyName:"handleBorderColor",isExprBound:!0},version:h.SlicerSliderColors},{types:[F.visuals.plugins.slicer.name,F.visuals.plugins.filterSlicer.name],property:{objectName:"slider",propertyName:"handleFillColor",isExprBound:!0},version:h.SlicerSliderColors},{types:[F.visuals.plugins.slicer.name,F.visuals.plugins.filterSlicer.name],property:{objectName:"slider",propertyName:"secondaryLineColor",isExprBound:!0},version:h.SlicerSliderColors},{types:[F.visuals.plugins.actionButton.name,F.visuals.plugins.shape.name,F.visuals.plugins.pageNavigator.name,F.visuals.plugins.bookmarkNavigator.name],property:{objectName:"text",propertyName:"italic"},version:h.ShapeButtonTextFormatting},{types:[F.visuals.plugins.actionButton.name,F.visuals.plugins.shape.name,F.visuals.plugins.pageNavigator.name,F.visuals.plugins.bookmarkNavigator.name],property:{objectName:"text",propertyName:"bold"},version:h.ShapeButtonTextFormatting},{types:[F.visuals.plugins.actionButton.name,F.visuals.plugins.shape.name,F.visuals.plugins.pageNavigator.name,F.visuals.plugins.bookmarkNavigator.name],property:{objectName:"text",propertyName:"underline"},version:h.ShapeButtonTextFormatting},{property:{objectName:"visualHeaderTooltip",propertyName:"bold"},version:h.HelpTooltipBIU},{property:{objectName:"visualHeaderTooltip",propertyName:"italic"},version:h.HelpTooltipBIU},{property:{objectName:"visualHeaderTooltip",propertyName:"underline"},version:h.HelpTooltipBIU},{types:[F.visuals.plugins.azureMap.name],property:{objectName:"filledMap",propertyName:"*"},version:h.AzureMapsFilledMap},{types:[F.visuals.plugins.waterfallChart.name,F.visuals.plugins.treemap.name,F.visuals.plugins.lineChart.name,F.visuals.plugins.areaChart.name,F.visuals.plugins.columnChart.name,F.visuals.plugins.barChart.name,F.visuals.plugins.pieChart.name,F.visuals.plugins.clusteredBarChart.name,F.visuals.plugins.clusteredColumnChart.name,F.visuals.plugins.comboChart.name,F.visuals.plugins.donutChart.name,F.visuals.plugins.funnel.name,F.visuals.plugins.hundredPercentStackedBarChart.name,F.visuals.plugins.hundredPercentStackedColumnChart.name,F.visuals.plugins.lineStackedColumnComboChart.name,F.visuals.plugins.lineClusteredColumnComboChart.name,F.visuals.plugins.ribbonChart.name,F.visuals.plugins.stackedAreaChart.name],property:{objectName:"labels",propertyName:"color",matchByContents:function(e,t){return!_.isEmpty(null==t?void 0:t.data)}},version:h.ConditionalFormattingDataLabels},{types:[F.visuals.plugins.treemap.name],property:{objectName:"categoryLabels",propertyName:"color",matchByContents:function(e,t){return!_.isEmpty(null==t?void 0:t.data)}},version:h.ConditionalFormattingDataLabels},{types:[F.visuals.plugins.hundredPercentStackedBarChart.name,F.visuals.plugins.hundredPercentStackedColumnChart.name,F.visuals.plugins.lineStackedColumnComboChart.name,F.visuals.plugins.stackedAreaChart.name,F.visuals.plugins.barChart.name,F.visuals.plugins.columnChart.name],property:{objectName:"totals",propertyName:"color",matchByContents:function(e,t){return!_.isEmpty(null==t?void 0:t.data)}},version:h.ConditionalFormattingDataLabels},{types:[F.visuals.plugins.scatterChart.name,F.visuals.plugins.waterfallChart.name],property:{objectName:"categoryAxis",propertyName:"titleItalic"},version:h.CartesianBiuFontProperties},{types:[F.visuals.plugins.scatterChart.name,F.visuals.plugins.waterfallChart.name],property:{objectName:"categoryAxis",propertyName:"titleBold"},version:h.CartesianBiuFontProperties},{types:[F.visuals.plugins.scatterChart.name,F.visuals.plugins.waterfallChart.name],property:{objectName:"categoryAxis",propertyName:"titleUnderline"},version:h.CartesianBiuFontProperties},{types:[F.visuals.plugins.scatterChart.name,F.visuals.plugins.waterfallChart.name],property:{objectName:"valueAxis",propertyName:"titleItalic"},version:h.CartesianBiuFontProperties},{types:[F.visuals.plugins.scatterChart.name,F.visuals.plugins.waterfallChart.name],property:{objectName:"valueAxis",propertyName:"titleBold"},version:h.CartesianBiuFontProperties},{types:[F.visuals.plugins.scatterChart.name,F.visuals.plugins.waterfallChart.name],property:{objectName:"valueAxis",propertyName:"titleUnderline"},version:h.CartesianBiuFontProperties},{property:{objectName:"title",propertyName:"paddingTop"},version:h.VisualTitleContainerPadding},{property:{objectName:"title",propertyName:"paddingBottom"},version:h.VisualTitleContainerPadding},{property:{objectName:"title",propertyName:"paddingLeft"},version:h.VisualTitleContainerPadding},{property:{objectName:"title",propertyName:"paddingRight"},version:h.VisualTitleContainerPadding},{property:{objectName:"border",propertyName:"paddingTop"},version:h.VisualTitleContainerPadding},{property:{objectName:"border",propertyName:"paddingBottom"},version:h.VisualTitleContainerPadding},{property:{objectName:"border",propertyName:"paddingLeft"},version:h.VisualTitleContainerPadding},{property:{objectName:"border",propertyName:"paddingRight"},version:h.VisualTitleContainerPadding},{types:[F.visuals.plugins.textbox.name],property:__assign(__assign({},F.visuals.textboxProps.general.paragraphs),{matchByContents:function(e,t){if(F.StructuralObjectDefinition.isParagraphsDefinition(e))for(var r=0,i=e;r<i.length;r++){var a=i[r];if(a&&!_.isEmpty(a.textRuns))for(var o=0,n=a.textRuns;o<n.length;o++){var s=n[o];if(F.ParagraphsDefinition.isTextRunDefinition(s)&&s.mentionEmail)return!0}}return!1}}),version:h.TextboxAtMention},{types:[i.scorecard.name],property:{objectName:"scorecard",propertyName:"displayMode"},version:h.GoalVisual},{types:[i.scorecard.name],property:{objectName:"scorecard",propertyName:"goalIds"},version:h.GoalVisual},{types:[i.scorecard.name],property:{objectName:"visualization",propertyName:l},version:h.GoalVisual}];var S,E,N,V=["minColor","midColor","maxColor","nullColor"];function P(t){if(t instanceof o)return!!_.find(V,(function(e){return e===t.value}));if(t instanceof Object&&!(t instanceof Function))for(var e=0,r=Object.keys(t);e<r.length;e++){var i=r[e];if(P(t[i]))return!0}return!1}function w(e,t,r){var i=r[e];r[e]||(i=r[e]={});var a=t.currentId.objectName,o=(o=i[a])||(i[a]={}),e=t.previousId,a=function(e,t){e=e&&e[t.objectName];return e&&e[t.propertyName]},e=a(i,e)||a(r[l],e);o[t.currentId.propertyName]=__assign(__assign({},t),{previous:e})}function T(e,t,r){var i=r[e];r[e]||(i=r[e]={});r=t.property.objectName,e=(e=i[r])||(i[r]={}),i=t.property.propertyName,r=e[i];(r=r||(e[i]=[])).push(t),1===r.length||d.lt(r[r.length-1].version,r[r.length-2].version)}u.RenamedObjectPropertyVersions=[{currentId:{objectName:"dataPoint",propertyName:"fill"},previousId:{objectName:"dataPoint",propertyName:"defaultCategoryColor"},version:u.ExplorationVersions.v3_19,types:u.DefaultCategoryColorVisualsToUpgrade},{currentId:{objectName:"columnTotal",propertyName:"fontColor"},previousId:{objectName:"total",propertyName:"fontColor"},types:[F.visuals.plugins.pivotTable.name],version:h.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"rowTotal",propertyName:"fontColor"},previousId:{objectName:"total",propertyName:"fontColor"},types:[F.visuals.plugins.pivotTable.name],version:h.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"columnTotal",propertyName:"fontFamily"},previousId:{objectName:"total",propertyName:"fontFamily"},types:[F.visuals.plugins.pivotTable.name],version:h.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"rowTotal",propertyName:"fontFamily"},previousId:{objectName:"total",propertyName:"fontFamily"},types:[F.visuals.plugins.pivotTable.name],version:h.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"columnTotal",propertyName:"fontSize"},previousId:{objectName:"total",propertyName:"fontSize"},types:[F.visuals.plugins.pivotTable.name],version:h.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"rowTotal",propertyName:"fontSize"},previousId:{objectName:"total",propertyName:"fontSize"},types:[F.visuals.plugins.pivotTable.name],version:h.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"columnTotal",propertyName:"bold"},previousId:{objectName:"total",propertyName:"bold"},types:[F.visuals.plugins.pivotTable.name],version:h.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"rowTotal",propertyName:"bold"},previousId:{objectName:"total",propertyName:"bold"},types:[F.visuals.plugins.pivotTable.name],version:h.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"columnTotal",propertyName:"italic"},previousId:{objectName:"total",propertyName:"italic"},types:[F.visuals.plugins.pivotTable.name],version:h.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"rowTotal",propertyName:"italic"},previousId:{objectName:"total",propertyName:"italic"},types:[F.visuals.plugins.pivotTable.name],version:h.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"columnTotal",propertyName:"underline"},previousId:{objectName:"total",propertyName:"underline"},types:[F.visuals.plugins.pivotTable.name],version:h.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"rowTotal",propertyName:"underline"},previousId:{objectName:"total",propertyName:"underline"},types:[F.visuals.plugins.pivotTable.name],version:h.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"columnTotal",propertyName:"backColor"},previousId:{objectName:"total",propertyName:"backColor"},types:[F.visuals.plugins.pivotTable.name],version:h.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"rowTotal",propertyName:"backColor"},previousId:{objectName:"total",propertyName:"backColor"},types:[F.visuals.plugins.pivotTable.name],version:h.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"columnTotal",propertyName:"applyToHeaders"},previousId:{objectName:"total",propertyName:"applyToHeaders"},types:[F.visuals.plugins.pivotTable.name],version:h.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"rowTotal",propertyName:"applyToHeaders"},previousId:{objectName:"total",propertyName:"applyToHeaders"},types:[F.visuals.plugins.pivotTable.name],version:h.splitGrandTotals,featureSwitch:"splitGrandTotals"},{currentId:{objectName:"visualLink",propertyName:"showDefaultTooltip"},previousId:{objectName:"visualLink",propertyName:"suppressDefaultTooltip"},types:[F.visuals.plugins.pivotTable.name],version:h.ShowDefaultTooltip,upgrader:u.UpgradeUtils.convertSuppressDefaultTooltip,featureSwitch:"showDefaultTooltip"},{currentId:{objectName:"fillPoint",propertyName:"style"},previousId:{objectName:"fillPoint",propertyName:"show"},types:[F.visuals.plugins.scatterChart.name],version:h.FillPointShowToStyle,upgrader:u.UpgradeUtils.convertScatterChartFillPoint,featureSwitch:"fillPointStyle"},{currentId:{objectName:"categoryAxis",propertyName:"switchAxisPosition"},previousId:{objectName:"categoryAxis",propertyName:"position"},types:[F.visuals.plugins.barChart.name,F.visuals.plugins.clusteredBarChart.name,F.visuals.plugins.clusteredColumnChart.name,F.visuals.plugins.columnChart.name,F.visuals.plugins.hundredPercentStackedBarChart.name,F.visuals.plugins.hundredPercentStackedColumnChart.name,F.visuals.plugins.ribbonChart.name],version:h.PositionToSwitchAxisPosition,upgrader:u.UpgradeUtils.convertAxisPositionProperty,featureSwitch:"switchAxisPosition"},{currentId:{objectName:"valueAxis",propertyName:"switchAxisPosition"},previousId:{objectName:"valueAxis",propertyName:"position"},version:h.PositionToSwitchAxisPosition,types:[F.visuals.plugins.areaChart.name,F.visuals.plugins.barChart.name,F.visuals.plugins.clusteredBarChart.name,F.visuals.plugins.clusteredColumnChart.name,F.visuals.plugins.columnChart.name,F.visuals.plugins.hundredPercentStackedBarChart.name,F.visuals.plugins.hundredPercentStackedColumnChart.name,F.visuals.plugins.lineChart.name,F.visuals.plugins.lineClusteredColumnComboChart.name,F.visuals.plugins.lineStackedColumnComboChart.name,F.visuals.plugins.ribbonChart.name,F.visuals.plugins.scatterChart.name,F.visuals.plugins.stackedAreaChart.name,F.visuals.plugins.waterfallChart.name],upgrader:u.UpgradeUtils.convertAxisPositionProperty,featureSwitch:"switchAxisPosition"},{currentId:{objectName:"categoryAxis",propertyName:"logAxisScale"},previousId:{objectName:"categoryAxis",propertyName:"axisScale"},version:h.AxisScaleToLogAxisScale,types:[F.visuals.plugins.barChart.name,F.visuals.plugins.clusteredBarChart.name,F.visuals.plugins.clusteredColumnChart.name,F.visuals.plugins.columnChart.name,F.visuals.plugins.hundredPercentStackedBarChart.name,F.visuals.plugins.hundredPercentStackedColumnChart.name,F.visuals.plugins.ribbonChart.name,F.visuals.plugins.waterfallChart.name],upgrader:u.UpgradeUtils.convertAxisScaleProperty,featureSwitch:"logAxisScale"},{currentId:{objectName:"valueAxis",propertyName:"logAxisScale"},previousId:{objectName:"valueAxis",propertyName:"axisScale"},version:h.AxisScaleToLogAxisScale,types:[F.visuals.plugins.areaChart.name,F.visuals.plugins.barChart.name,F.visuals.plugins.clusteredBarChart.name,F.visuals.plugins.clusteredColumnChart.name,F.visuals.plugins.columnChart.name,F.visuals.plugins.hundredPercentStackedBarChart.name,F.visuals.plugins.hundredPercentStackedColumnChart.name,F.visuals.plugins.lineChart.name,F.visuals.plugins.lineClusteredColumnComboChart.name,F.visuals.plugins.lineStackedColumnComboChart.name,F.visuals.plugins.ribbonChart.name,F.visuals.plugins.scatterChart.name,F.visuals.plugins.stackedAreaChart.name,F.visuals.plugins.waterfallChart.name],upgrader:u.UpgradeUtils.convertAxisScaleProperty,featureSwitch:"logAxisScale"},{currentId:{objectName:"y2Axis",propertyName:"secLogAxisScale"},previousId:{objectName:"y2Axis",propertyName:"secAxisScale"},version:h.AxisScaleToLogAxisScale,types:[F.visuals.plugins.areaChart.name,F.visuals.plugins.lineChart.name,F.visuals.plugins.lineClusteredColumnComboChart.name,F.visuals.plugins.lineStackedColumnComboChart.name,F.visuals.plugins.stackedAreaChart.name],upgrader:u.UpgradeUtils.convertAxisScaleProperty,featureSwitch:"logAxisScale"},{currentId:{objectName:"valueAxis",propertyName:"secLogAxisScale"},previousId:{objectName:"valueAxis",propertyName:"secAxisScale"},version:h.AxisScaleToLogAxisScale,types:[i.comboChart.name,i.dataDotClusteredColumnComboChart.name,i.dataDotStackedColumnComboChart.name,i.lineClusteredColumnComboChart.name,i.lineStackedColumnComboChart.name],upgrader:u.UpgradeUtils.convertAxisScaleProperty,featureSwitch:"logAxisScale"},{currentId:{objectName:"columnHeaders",propertyName:"outlineStyle"},previousId:{objectName:"columnHeaders",propertyName:"outline"},version:h.OutlineDropdownToCheckboxes,types:[F.visuals.plugins.pivotTable.name,F.visuals.plugins.tableEx.name],upgrader:u.UpgradeUtils.convertOutlineValue,featureSwitch:"outlineDropdownToCheckboxes"},{currentId:{objectName:"rowHeaders",propertyName:"outlineStyle"},previousId:{objectName:"rowHeaders",propertyName:"outline"},version:h.OutlineDropdownToCheckboxes,types:[F.visuals.plugins.pivotTable.name,F.visuals.plugins.tableEx.name],upgrader:u.UpgradeUtils.convertOutlineValue,featureSwitch:"outlineDropdownToCheckboxes"},{currentId:{objectName:"values",propertyName:"outlineStyle"},previousId:{objectName:"values",propertyName:"outline"},version:h.OutlineDropdownToCheckboxes,types:[F.visuals.plugins.pivotTable.name,F.visuals.plugins.tableEx.name],upgrader:u.UpgradeUtils.convertOutlineValue,featureSwitch:"outlineDropdownToCheckboxes"},{currentId:{objectName:"total",propertyName:"outlineStyle"},previousId:{objectName:"total",propertyName:"outline"},version:h.OutlineDropdownToCheckboxes,types:[F.visuals.plugins.tableEx.name],upgrader:u.UpgradeUtils.convertOutlineValue,featureSwitch:"outlineDropdownToCheckboxes"},{currentId:{objectName:"grid",propertyName:"outlineStyle"},previousId:{objectName:"grid",propertyName:"outline"},version:h.OutlineDropdownToCheckboxes,types:[F.visuals.plugins.pivotTable.name,F.visuals.plugins.tableEx.name],upgrader:u.UpgradeUtils.convertOutlineValue,featureSwitch:"outlineDropdownToCheckboxes"},{currentId:{objectName:"header",propertyName:"outlineStyle"},previousId:{objectName:"header",propertyName:"outline"},version:h.OutlineDropdownToCheckboxes,types:[F.visuals.plugins.slicer.name,F.visuals.plugins.filterSlicer.name],upgrader:u.UpgradeUtils.convertOutlineValue,featureSwitch:"outlineDropdownToCheckboxes"},{currentId:{objectName:"searchBox",propertyName:"outlineStyle"},previousId:{objectName:"searchBox",propertyName:"outline"},version:h.OutlineDropdownToCheckboxes,types:[F.visuals.plugins.slicer.name,F.visuals.plugins.filterSlicer.name],upgrader:u.UpgradeUtils.convertOutlineValue,featureSwitch:"outlineDropdownToCheckboxes"},{currentId:{objectName:"items",propertyName:"outlineStyle"},previousId:{objectName:"items",propertyName:"outline"},version:h.OutlineDropdownToCheckboxes,types:[F.visuals.plugins.slicer.name,F.visuals.plugins.filterSlicer.name],upgrader:u.UpgradeUtils.convertOutlineValue,featureSwitch:"outlineDropdownToCheckboxes"},{currentId:{objectName:"card",propertyName:"outlineStyle"},previousId:{objectName:"card",propertyName:"outline"},version:h.OutlineDropdownToCheckboxes,types:[F.visuals.plugins.multiRowCard.name],upgrader:u.UpgradeUtils.convertOutlineValue,featureSwitch:"outlineDropdownToCheckboxes"},{currentId:{objectName:"categoryAxis",propertyName:"logAxisScale"},previousId:{objectName:"categoryAxis",propertyName:"axisScale"},version:h.RemainingCategoryLogAxisScale,types:[i.areaChart.name,i.lineChart.name,i.lineClusteredColumnComboChart.name,i.lineStackedColumnComboChart.name,i.scatterChart.name,i.stackedAreaChart.name],upgrader:u.UpgradeUtils.convertAxisScaleProperty,featureSwitch:"remainingCartesianCategoryLogAxisScale"}],u.UpdatedObjectPropertyVersions=[{property:{objectName:"categoryAxis",propertyName:"fontSize"},version:u.ExplorationVersions.v4_2,upgrader:u.UpgradeUtils.pxToPtUpgrader},{property:{objectName:"categoryAxis",propertyName:"titleFontSize"},version:u.ExplorationVersions.v4_2,upgrader:u.UpgradeUtils.pxToPtUpgrader},{property:{objectName:"valueAxis",propertyName:"fontSize"},version:u.ExplorationVersions.v4_2,upgrader:u.UpgradeUtils.pxToPtUpgrader},{property:{objectName:"valueAxis",propertyName:"titleFontSize"},version:u.ExplorationVersions.v4_2,upgrader:u.UpgradeUtils.pxToPtUpgrader},{property:{objectName:"valueAxis",propertyName:"secFontSize"},version:u.ExplorationVersions.v4_2,upgrader:u.UpgradeUtils.pxToPtUpgrader},{property:{objectName:"valueAxis",propertyName:"secTitleFontSize"},version:u.ExplorationVersions.v4_2,upgrader:u.UpgradeUtils.pxToPtUpgrader},{property:{objectName:"visualTooltip",propertyName:"fontSize"},version:u.ExplorationVersions.v4_2,upgrader:u.UpgradeUtils.pxToPtUpgrader},{property:{objectName:"outspacePane",propertyName:"titleSize"},version:u.ExplorationVersions.v5_1,upgrader:u.UpgradeUtils.pxToPtUpgrader},{property:{objectName:"outspacePane",propertyName:"headerSize"},version:u.ExplorationVersions.v5_1,upgrader:u.UpgradeUtils.pxToPtUpgrader},{property:{objectName:"filterCard",propertyName:"textSize"},version:u.ExplorationVersions.v5_1,upgrader:u.UpgradeUtils.pxToPtUpgrader}],u.ObjectVersioning=(S=u.AddedObjectPropertyVersions,E=u.RenamedObjectPropertyVersions,N=u.UpdatedObjectPropertyVersions,_.find(E,(function(t){return _.find(S,(function(e){return(!t.types||!e.types||_.find(t.types,(function(t){return _.find(e.types,(function(e){return e===t}))})))&&e.property.objectName===t.previousId.objectName&&e.property.propertyName===t.previousId.propertyName&&d.lt(e.version,t.version)}))})),{added:(function(e){for(var t={},r=0;r<e.length;r++){var i=e[r];if(r&&d.lt(i.version,e[r-1].version),null!=i.types)for(var a=0,o=i.types;a<o.length;a++)T(o[a],i,t);else T(l,i,t)}return t})(S),renamed:(function(e){for(var t={},r=0,i=e.length;r<i;r++){var a=e[r];if(a.currentId.objectName!==a.previousId.objectName||(a.currentId.propertyName,a.previousId.propertyName),r&&d.lt(a.version,e[r-1].version),null!=a.types)for(var o=0,n=a.types;o<n.length;o++)w(s=n[o],a,t);else for(var s in w(l,a,t),t)w(s,a,t)}return t})(E),updated:N}),u.getVersionForObjectDefinitions=function(n,e,s,l,p){return c.visitPropertyExprs({definitions:n,descriptors:e,visitor:function(e,t,r,i){l=d.max(u.ExplorationVersionHelper.getVersionForSQExprWithDescriptor(e,i),l)}}),c.visitPropertyDefinitions(n,e,(function(e,t,r,i,a){var o=a&&a.properties[t],e=e[t];l=d.max(l,F.data.DataViewObjectVersioning.getVersionForDefinition(u.ObjectVersioning.added,e,r,s,i,t,l,(function(){var e=c.getValue(n,{objectName:i,propertyName:t},r);if(e){e=c.getDataBoundExprs(e,o.type,r,p);if(!_.isEmpty(e))return!0}return!1}))),c.isObjectPropertySQExprWithContext(e)&&(l=d.max(l,h.NarrativeVisual))})),l}})((e=j.services||(j.services={})).upgrade||(e.upgrade={}))})(powerbi=powerbi||{}),(function(e){((e=(e=(e=e.explore||(e.explore={})).services||(e.services={})).upgrade||(e.upgrade={})).UtteranceDefinitionVersions||(e.UtteranceDefinitionVersions={})).v1_0="1.0"})(powerbi=powerbi||{}),(function(n){var e,t,r,i,s,l,a;e=(e=n.explore||(n.explore={})).util||(e.util={}),i=n.explore.services.upgrade.CurrentExplorationVersion,s=n.data.DataViewObjectDefinitions,l=n.explore.contracts.ExplorationObjectDescriptors,a=n.explore.services.upgrade.ExplorationVersions,t=e.ThemeUtils||(e.ThemeUtils={}),r="CY18SU07",t.baseThemeVersions={CY17SU10:a.v3_6,CY17SU12:a.v3_7,CY18SU04:a.v3_12,CY18SU07:a.v3_15,CY19SU06:a.v5_3,CY19SU12:a.v5_6,CY20SU07:a.v5_13,CY20SU09:a.v5_15,CY21SU02:a.v5_18,CY21SU03:a.v5_19,CY21SU04:a.v5_20,CY21SU07:a.v5_24,CY21SU11:a.v5_27,CY22SU03:a.v5_30,CY22SU08:a.v5_35},t.ClassicBaseThemeName="Classic",t.DefaultBaseThemeName="Default",t.CustomThemeName="Custom",t.ClassicBaseThemeBuiltInThemeNames=["Classic","CityPark","Classroom","ColorblindSafe","Electric","HighContrast","Sunset","Twilight"],t.getVersionForBaseTheme=function(e){return t.baseThemeVersions[e]||a.v3_6},t.getThemeMetadata=function(e,t,r){return n.getThemeMetadata(e,t,r||i)},t.getCurrentBaseThemeMetadata=function(e){return{name:e&&e.featureSwitches&&e.featureSwitches.useNewCY19SU06BaseTheme?"CY22SU08":r,version:i,type:2}},t.getClassicBaseThemeMetadata=function(){return{name:r,version:t.baseThemeVersions[r],type:2}},t.evaluateObjects=function(e,t,r){var i=e.themeCollection,a=n.explore.constants.ExplorationComponentType,o=e.objects;(a=t.getVisualObjects(i,a,void 0,l))&&(o=s.clone(o||{}),s.extend(o,a)),i=t.getVisualStyle(i),r=n.data.DataViewTransform.evaluateMetadataOnceDataViewObjectDefinitions(o,l,i,r),e.evaluatedObjects=r.dataViewObjects}})(powerbi=powerbi||{}),(function(e){(function(t){var u=jsCommon.Version;t.createExplorationDowngrader=function(e){return new r(e)};var r=(e.prototype.getFinalExplorationVersion=function(e,t){t=u.max(t,this.getFinalExplorationForObjectsVersion(e,t));for(var r=0,i=this.downgraders;r<i.length;r++){var a=i[r];t=u.max(t,a.getMinDowngradeVersionForContract(e))}return t},e.prototype.downgrade=function(e,t){this.downgradeVisualObjects(e,t);for(var r=0,i=this.downgraders;r<i.length;r++)i[r].downgrade(e,t)},e.prototype.downgradeVisualObjects=function(e,t){e=e&&e.sections;if(e)for(var r=0,i=e;r<i.length;r++){var a=i[r],a=a&&a.visualContainers;if(!a)return;for(var o=0,n=a;o<n.length;o++){var s,l=n[o],p=l&&l.config&&l.config.singleVisual;p&&(s=p.visualType,(l=p.vcObjects)&&this.objectsDowngrader.downgrade(2,l,s,t),(p=p.objects)&&this.objectsDowngrader.downgrade(1,p,s,t))}}},e.prototype.getFinalExplorationForObjectsVersion=function(e,t){e=e&&e.sections;if(e){for(var r=0,i=e;r<i.length;r++){var a=i[r],a=a&&a.visualContainers;if(!a)return;for(var o=0,n=a;o<n.length;o++){var s,l=n[o],p=l&&l.config&&l.config.singleVisual;p&&(s=p.visualType,(l=p.vcObjects)&&(t=u.max(t,this.objectsDowngrader.getFinalVisualObjectsVersion(2,l,t,s))),(p=p.objects)&&(t=u.max(t,this.objectsDowngrader.getFinalVisualObjectsVersion(1,p,t,s))))}}return t}},e);function e(e){this.downgraders=e,this.objectsDowngrader=t.createVisualObjectsDowngrader(this.downgraders)}t.ExplorationDowngrader=r})((e=(e=e.explore||(e.explore={})).services||(e.services={})).downgrade||(e.downgrade={}))})(powerbi=powerbi||{}),(function(G){var Q;(function(m){var d=jsCommon.ArrayExtensions,o=G.explore.contracts.BookmarkExtensions,v=G.explore.services.upgrade.ComboSmallMultipleFormattingVisualTypes,h=G.explore.contracts,n=G.explore.services.upgrade.CurrentExplorationVersion,f=G.common.contracts.DataCacheModeType,g=G.data.DataViewObjectDefinitions,y=G.data.services.DataViewObjectSerializer,C=G.data.services.DisplayNameSerializer,x=G.data.ExpansionState,b=G.data.services.ExpansionStateSerializer,S=G.explore.services.upgrade.ExplorationFeatureVersions,a=G.explore.services.upgrade.ExplorationStateFeatureVersions,s=G.explore.services.upgrade.ExplorationStateVersions,E=G.explore.services.upgrade.ExplorationVersions,N=G.data.services.FilterExpressionMetadataSerializer,l=h.FilterContainer.ObjectType,p=h.FilterContainer.CommonObjectDescriptors,V=jsCommon.JsonExtensions,u=h.LinguisticSchemaSyncVersion,P=G.data.QueryProjectionCollection,c=G.contracts.ResourcePackageItemType,w=G.visualHost.utils.ResourcePackageUtils,T=G.data.services.SemanticQuerySerializer,i=G.data.SQExpr,F=G.data.SQExprUtils,j=jsCommon.StringExtensions,R=G.visualHost.ThemeUtils,D=jsCommon.Version,A=h.VisualContainer,I=h.VisualContainerGroup,O=Q.util.VisualContainerUtils,k=h.VisualQuery,M="Gradient";m.createExplorationSerializer=function(e,t,r,i,a,o,n){return new B(e,t,r,i,a,o,n)};var B=(e.prototype.deepCopyExploration=function(e,t){return this.deserializeExploration(this.serializeExploration(e,t),[],!0)},e.prototype.ensureInitialized=function(){return this.visualPlugins.ensureBuiltInPlugins()},e.prototype.deserializeExploration=function(e,t,r,i,a,o){var n=this;if(e){var s=void 0;o&&(s=o.createChildActivity({name:"Upgrade Exploration"}));t=this.explorationUpgrader.upgrade(e,t,r,a);if(s&&(s.setProperty("upgraderCount",null==a?void 0:a.upgraderCount),s.resolve()),!t)return;t.config;var l,p,u=t.config,c={id:t.id,width:void 0,height:void 0,sections:void 0,dataSources:void 0,reportId:t.reportId,themeCollection:R.cloneThemeCollection(u.themeCollection),bookmarks:[],mwcToken:t.mwcToken,capacityUri:t.capacityUri,publicCustomVisuals:t.publicCustomVisuals};u.tags&&(c.tags=_.cloneDeep(u.tags)),u.slowDataSourceSettings&&(c.slowDataSourceSettings=_.cloneDeep(u.slowDataSourceSettings)),u.settings&&(c.settings=_.cloneDeep(u.settings)),u.objects&&(c.objects=y.deserializeObjects(u.objects,h.ExplorationObjectDescriptors)),u.bookmarks&&(s=jsCommon.PerfTimer.logTime((function(){var e=n.deserializeBookmarks(u.bookmarks);d.hasUniqueNames(e),c.bookmarks=e})),o&&o.setProperty("bookmarkDeserializationDuration",s)),this.contextActivityService.upsertExplorationProperties({bookmarkCount:c.bookmarks?c.bookmarks.length:0}),t.userState&&(c.userState=this.deserializeUserState(t.userState)),t.activeWebBookmark&&(c.activeWebBookmark=this.deserializeWebBookmark(t.activeWebBookmark,r)),t.sections&&(r=_.sortBy(t.sections,(function(e){return void 0!==e.ordinal?e.ordinal:0})),l=c.settings&&c.settings.useStylableVisualContainerHeader,c.sections=_.map(r,(function(e){return n.deserializePage(e,l)})),c.filters=this.deserializeFilterContainers(t.filters),c.dataSources=h.createDataSourceArray(),t.resourcePackages&&(c.resourcePackages=this.deserializeResourcePackages(t.resourcePackages)),t.pods&&(c.pods=_.map(t.pods,(function(e){return n.deserializePod(e)})),d.hasUniqueNames(c.pods)),_.isNumber(u.activeSectionIndex)&&u.activeSectionIndex<t.sections.length&&(c.activeSectionIndex=u.activeSectionIndex),u.modelExtensions&&(c.modelExtensions=this.deserializeModelExtensions(u.modelExtensions)),i&&(i.lastTimeAModelChangeWasDetectedInTheCluster&&!_.isEmpty(i.onPremModelConnectionString)?(p=jsCommon.DateExtensions.deserializeDate(i.lastTimeAModelChangeWasDetectedInTheCluster),this.updateVisualContainerCachingOptions(c,p,(function(e){e.useInitialCachedQuery=!0}),(function(e){e.useInitialCachedQuery=!1}))):_.isEmpty(i.onPremModelConnectionString)&&i.dataCacheMode===f.Import&&i.lastRefreshTime&&(p=jsCommon.DateExtensions.deserializeDate(i.lastRefreshTime),this.updateVisualContainerCachingOptions(c,p,(function(e){e.disableCacheOnServerForInitialLoad=!0}),(function(e){e.disableCacheOnServerForInitialLoad=!1}))))),t.report&&(c.report=G.Prototype.inherit(t.report),t.report.linguisticSchemaId&&(c.reportHasLinguisticSchema=!0)),null!=u.defaultDrillFilterOtherVisuals&&(c.defaultDrillFilterOtherVisuals=u.defaultDrillFilterOtherVisuals),u.filterSortOrder&&(c.filterSortOrder=u.filterSortOrder),u.dataSourceVariables&&(c.dataSourceVariables=u.dataSourceVariables),u.creationSource&&(c.creationSource=u.creationSource),c.linguisticSchemaSyncVersion=this.deserializeLinguisticSchemaSyncVersion(u.linguisticSchemaSyncVersion)}return c},e.prototype.deserializeLinguisticSchemaSyncVersion=function(e){return null==e?u.Unspecified:(0 in u,e)},e.prototype.updateVisualContainerCachingOptions=function(e,t,r,i){for(var a=0,o=e.sections;a<o.length;a++)for(var n=0,s=o[a].visualContainers;n<s.length;n++){var l=s[n];(l.cachedData&&l.cachedData.dataUpdatedTime&&l.cachedData.data&&0<=+l.cachedData.dataUpdatedTime-+t?r:i)(l)}},e.prototype.deserializeResourcePackages=function(e){for(var t=[],r=0,i=e;r<i.length;r++){var a=i[r];this.upgradeResourcePackage(a.resourcePackage),t.push(a.resourcePackage)}for(var o=0;o<t.length;++o)if(t[o])for(var n=t.length;--n>o;)t[n]&&t[o].name===t[n].name&&(t[n].id>t[o].id&&(t[o]=t[n]),t.splice(n,1));return t},e.prototype.deserializeLinkField=function(e){var t=T.deserializeExpr(e.fieldExpr);return i.isMeasure(t)&&!1===e.asAggregation||i.isColumn(t)||i.isHierarchyLevel(t),{asAggregation:e.asAggregation,fieldExpr:t}},e.prototype.deserializePage=function(e,t){var r=this;if(e){var i={id:e.id,objectId:e.objectId,name:e.name,displayName:e.displayName,visualContainers:void 0,visualContainerGroups:void 0,size:{displayOption:void 0!==e.displayOption?e.displayOption:0,height:e.height||Q.constants.ExploreCanvasConstants.DefaultCanvasHeight,width:e.width||Q.constants.ExploreCanvasConstants.DefaultCanvasWidth},filters:this.deserializeFilterContainers(e.filters)};e.transient&&(i.transient=e.transient);var a=e.config;return i.acceptsAllFiltersWhenLinked=a.acceptsAllFiltersWhenLinked,a.objects&&(i.objects=y.deserializeObjects(a.objects,h.Section.objectDescriptors)),null!=a.visibility&&(i.visibility=a.visibility),null!=a.type&&(i.type=a.type),null!=a.filterSortOrder&&(i.filterSortOrder=a.filterSortOrder),_.isEmpty(a.linkFields)||(i.linkFields=_.map(a.linkFields,(function(e){return r.deserializeLinkField(e)}))),a.dynamicConfig&&(i.dynamicConfig=this.deserializeDynamicConfig(a.dynamicConfig)),e.visualContainers&&((t=this.deserializeCanvasItems(e.visualContainers,null,t))?(i.visualContainers=t.visualContainers,i.visualContainerGroups=t.visualContainerGroups):(i.visualContainers=[],i.visualContainerGroups=[]),a.relationships&&(i.relationships=this.deserializeRelationships(a.relationships,i.visualContainers))),i}},e.prototype.deserializePod=function(e){if(e)return{id:e.id,name:e.name,boundSection:e.boundSection,parameters:this.deserializePodParameters(e.parameters),cortanaEnabled:e.cortanaEnabled,type:void 0===e.type?0:e.type,referenceScope:void 0===e.referenceScope?0:e.referenceScope,config:this.deserializePodConfig(e.config)}},e.prototype.deserializeRelationships=function(e,t){if(!_.isEmpty(e)){for(var r,i=0,a=e;i<a.length;i++){var o=a[i],o=this.deserializeRelationship(o,t);o&&(r=r||[]).push(o)}return r}},e.prototype.deserializeBookmarks=function(e){var i=this;if(e)return _.map(e,(function(e){if(q(e)){var t={displayName:e.displayName,name:e.name,children:i.deserializeBookmarks(e.children)};return _.each(t.children,(function(e){return e.parentGroup=t})),t}var r=e.explorationState,r={displayName:e.displayName,name:e.name,explorationState:m.ExplorationState.deserialize(r,i.visualPlugins,i.featureSwitchService)};return e.options&&(r.options=i.deserializeBookmarkOptions(e.options)),r}))},e.prototype.deserializeBookmarkOptions=function(e){return e},e.prototype.deserializeUserState=function(e){if(!j.isNullOrUndefinedOrWhiteSpaceString(e)){e=V.tryParseJSON(e);if(e)try{return this.userState.deserialize(e,this.visualPlugins,this.featureSwitchService)}catch(e){return e&&this.telemetryService.logEvent(G.telemetry.PersistentStateSerializationError,{stack:e.stack,message:e.message}),{explorationState:null}}}},e.prototype.deserializeWebBookmark=function(e,t){e=m.WebBookmark.deserialize(e,this.visualPlugins,this.featureSwitchService);if(e.errors&&!t)for(var r=0,i=e.errors;r<i.length;r++){var a=i[r];this.telemetryService.logEvent(G.telemetry.SerializationError,{type:"WebBookmark",errorCode:a.code,stack:a.stack,message:a.message})}return e.contract},e.prototype.deserializeModelExtensions=function(e){var r=this;return d.extendWithName(_.map(e,(function(e){var t={name:e.name,extends:e.extends};return e.entities&&(t.entities=r.deserializeModelExtensionEntities(e.entities)),t})))},e.prototype.deserializeModelExtensionEntities=function(e){var r=this;return d.extendWithName(_.map(e,(function(e){var t=e.extends?{name:e.name,extends:e.extends}:{name:e.name};return e.measures&&(t.measures=r.deserializeModelExtensionMeasures(e.measures)),t})))},e.prototype.deserializeModelExtensionMeasures=function(e){var r=this;return d.extendWithName(_.map(e,(function(e){var t={name:e.name,dataCategory:e.dataCategory,dataType:e.dataType,expression:e.expression,errorMessage:e.errorMessage,hidden:e.hidden,references:r.deserializeExpressionReferences(e.references),formulaOverride:e.formulaOverride,formatInformation:e.formatInformation,displayFolder:e.displayFolder};return e.annotations&&(t.annotations=r.deserializeModelExtensionAnnotations(e.annotations)),e.measureTemplate&&(t.measureTemplate={daxTemplateName:e.measureTemplate.daxTemplateName,version:e.measureTemplate.version}),e.description&&(t.description=e.description),t})))},e.prototype.deserializeExpressionReferences=function(e){return e?{unrecognizedReferences:!!e.unrecognizedReferences,measures:e.measures||[]}:{unrecognizedReferences:!1,measures:[]}},e.prototype.deserializeModelExtensionAnnotations=function(e){return d.extendWithName(_.map(e,(function(e){return{name:e.name,value:e.value}})))},e.prototype.deserializeDynamicConfig=function(e){var t,r,i;return e.quickExplore&&(t=e.quickExplore.selectedFields,r=e.quickExplore.visualContainerConfigurations,e=e.quickExplore.layout,(i=i||{}).quickExplore={selectedFields:_.map(t,(function(e){return T.deserializeExpr(e)})),visualContainerConfigurations:_.map(r,(function(e){return{name:e.name,fields:_.map(e.fields,(function(e){return T.deserializeExpr(e)}))}}))},e&&(i.quickExplore.layout=this.deserializeQuickExploreLayout(e))),i},e.prototype.deserializeQuickExploreLayout=function(e){if(e.combination){var t={version:e.combination.version};return e.combination.dataTableName&&(t.dataTableName=e.combination.dataTableName),{combination:t}}if(e.related){t={version:e.related.version};return e.related.dataTableName&&(t.dataTableName=e.related.dataTableName),{related:t}}},e.prototype.deserializeFilterCollection=function(e,t,r){if(e){r=this.explorationUpgrader.upgradeFilterCollection(e,t,r);if(r)return this.deserializeFilterContainers(r.filters)}},e.prototype.deserializeFilterContainer=function(e){return{name:e.name,type:h.FilterType[e.type],expression:e.expression?T.deserializeExpr(e.expression):void 0,filter:e.filter&&e.filter.Where?T.deserializeFilter(e.filter):void 0,restatement:e.restatement,cachedValueItems:C.deserializeFilterLabelIdPairs(e.cachedDisplayNames),howCreated:e.howCreated,isLinkedAsAggregation:e.isLinkedAsAggregation,isTransient:e.isTransient,isHiddenInViewMode:e.isHiddenInViewMode,objects:e.objects?y.deserializeObjects(e.objects,p):void 0,isLockedInViewMode:e.isLockedInViewMode,filterExpressionMetadata:e.filterExpressionMetadata?N.deserializeFilterExpressionMetadata(e.filterExpressionMetadata):void 0,displayName:e.displayName,ordinal:e.ordinal}},e.prototype.deserializeCanvasItems=function(e,t,r,i){if(!_.isEmpty(e)){for(var a=[],o=[],n={},s={},l=0,p=e;l<p.length;l++){var u=p[l];u&&u.config;var c=u.config,d=c.name,m=i&&i(u),u=this.deserializeCanvasItem(u,t,m),m=u.name;s[d]=m,h.isVisualContainer(u)&&a.push(u),void 0===c.parentGroupName?o.push(u):(n[c.parentGroupName]||(n[c.parentGroupName]=[]),n[c.parentGroupName].push(u))}var v,f={};for(v in n){var g=s[v];g?f[g]=n[v]:o.push.apply(o,n[v]||[])}return this.ensureVisualContainerGrouping(o,f,r),this.ensureNames(a),r?(this.ensureGroupZIndexNormalized(o),this.featureSwitchService.featureSwitches.accessibilityTopLevelNav?this.ensureGroupTabOrderNormalized(o,a):this.ensureListOrderNormalized(a,!1)):(o=__spreadArray([],a||[]),this.ensureListOrderNormalized(a)),{visualContainerGroups:o,visualContainers:a}}},e.prototype.deserializeCanvasItem=function(e,t,r){e&&e.config;var i=e.config;return i.singleVisual?this.deserializeVisualContainer(e,t,r):i.singleVisualGroup?this.deserializeVisualContainerGroup(e,t,r):void this.telemetryService.logEvent(G.telemetry.EXEmptyVisualContainerConfig)},e.prototype.deserializeVisualContainer=function(e,t,r){var i=e.config,t={name:r||i.name,id:t?void 0:e.id,layouts:d.createWithId(),config:{singleVisual:this.deserializeSingleVisual(i.singleVisual,e.prototypeQuery)}};null!=e.visibility&&(t.visibility=e.visibility),null!=e.detailVisualLayout&&(t.detailVisualLayout=e.detailVisualLayout),void 0===e.dataBinaryBase64Encoded&&void 0===e.query&&void 0===e.dataTransforms||(t.cachedData={data:e.dataBinaryBase64Encoded,query:e.query,transforms:e.dataTransforms,dataUpdatedTime:e.dataUpdatedTime?jsCommon.DateExtensions.parseUtcDate(e.dataUpdatedTime):void 0}),t.filters=this.deserializeFilterContainers(e.filters);var e=i.singleVisual.drillFilterOtherVisuals;null!=e&&(t.drillFilterOtherVisuals=e);e=i.singleVisual.filterSortOrder;return null!=e&&(t.filterSortOrder=e),(e=t.layouts).push.apply(e,_.cloneDeep(i.layouts)||[]),_.forEach(t.layouts,(function(e){e.position&&L(e.position)})),t},e.prototype.deserializeVisualContainerGroup=function(e,t,r){var i=e.config,a=i.singleVisualGroup,t={name:r||i.name,id:t?void 0:e.id,children:[],displayName:a.displayName,groupMode:a.groupMode,layouts:d.createWithId(),isHidden:a.isHidden};return(e=t.layouts).push.apply(e,_.cloneDeep(i.layouts)||[]),a.objects&&(t.objects=y.deserializeObjects(a.objects,I.objectDescriptors)),t},e.prototype.deserializeRelationship=function(e,t){var r=d.findItemWithName(t,e.source),t=d.findItemWithName(t,e.target);if(0!==e.type&&r&&t)return{source:r,target:t,type:e.type}},e.prototype.deserializeFilterContainers=function(e){var t=this;if(!j.isNullOrUndefinedOrWhiteSpaceString(e)){var r=[],e=V.tryParseJSON(e);return r=e?e.map((function(e){return t.deserializeFilterContainer(e)})):r}},e.prototype.deserializePodParameters=function(e){var t=this,r=[];return j.isNullOrUndefinedOrWhiteSpaceString(e)||(e=V.tryParseJSON(e))&&(r=e.map((function(e){return t.deserializePodParameter(e)}))),r},e.prototype.deserializePodParameter=function(e){return{name:e.name,boundFilter:e.boundFilter,fieldExpr:e.fieldExpr?T.deserializeExpr(e.fieldExpr):void 0,asAggregation:e.asAggregation,isLegacySingleSelection:e.isLegacySingleSelection}},e.prototype.deserializePodConfig=function(e){if(j.isNullOrUndefinedOrWhiteSpaceString(e))return{acceptsFilterContext:0};e=V.tryParseJSON(e);return void 0===e.acceptsFilterContext&&(e.acceptsFilterContext=0),e},e.prototype.deserializeVisualQuery=function(e,t,r,i,a,o){var n=this.visualPlugins.capabilities(e.visualType),s=n&&n.expandCollapse&&n.expandCollapse.supportsMerge,l=n&&n.expandCollapse&&n.expandCollapse.collapseParentAfterRemovingChildLevel,n=n&&n.noDefaultProjections,l=new k(t,this.convertProjections(r,t.select(),a,o),b.deserializeExpansionStates(i,{supportsMerge:s,canCollapseRoot:n,collapseParentAfterRemovingChildLevel:l}));this.upgradeVisualQuery(l,e.visualType),e.query=l},e.prototype.deserializeSingleVisual=function(e,t){var r={visualType:e.visualType||e.visualConfig.visualType};r.visualType,null!=e.autoSelectVisualType&&(r.autoSelectVisualType=e.autoSelectVisualType);var i=e.visualConfig?e.visualConfig.projections:void 0,a=e.projections||{};if(i)for(var o=0,n=i;o<n.length;o++)(l=a[(s=n[o]).role])||(a[s.role]=l=[]),l.push(s);else if(a&&0<a.length)for(var s,l,i=a,a={},p=0,u=i;p<u.length;p++)(l=a[(s=u[p]).role])||(a[s.role]=l=[]),l.push(s);t=e.prototypeQuery||(t?V.tryParseJSON(t):null);t&&(c=T.deserializeQuery(t),this.deserializeVisualQuery(r,c,a,e.expansionStates,e.showAllRoles,e.queryFieldParametersByRole));var c=e.display;null!=e.display&&(r.display=c),e.columnProperties&&(r.columnProperties=_.cloneDeep(e.columnProperties));c=e.queryOptions;c&&(r.queryOptions=_.cloneDeep(c));c=e.syncGroup;null!=c&&(r.syncGroup=_.cloneDeep(c));c=e.hasDefaultSort;null!=c&&(r.hasDefaultSort=c);var d,c=this.visualPlugins.capabilities(r.visualType);return c&&e.objects?r.objects=y.deserializeObjects(e.objects,c.objects):(d=e.objects)&&(r.objects=y.deserializeObjects(d,null)),e.vcObjects&&(r.vcObjects=y.deserializeObjects(e.vcObjects,A.CommonObjectDescriptors),(c=g.getObjectDefinition(r.vcObjects,"visualLink",void 0))&&(d=(d=e.vcObjects.visualLink[0].properties.qna)&&d.suggestedUtterances,_.isEmpty(d)||(c.properties.qna={suggestedUtterances:_.map(d,(function(e){return m.UtteranceDefinitionSerializer.deserialize(e)}))}))),this.featureSwitchService.featureSwitches.mobileAuthoringFormattingUI&&this.deserializeMobileState(r,e),e.cachedFilterDisplayItems&&(r.cachedFilterDisplayItems=C.deserializeFilterLabelIdPairs(e.cachedFilterDisplayItems)),e.filterExpressionMetadata&&(r.filterExpressionMetadata=N.deserializeFilterExpressionMetadata(e.filterExpressionMetadata)),r},e.prototype.deserializeMobileState=function(e,t){t.mobileVcObjects&&(e.mobileVcObjects=y.deserializeObjects(t.mobileVcObjects,A.CommonObjectDescriptors)),t.mobileObjects&&(e.mobileObjects=y.deserializeObjects(t.mobileObjects,null===(e=this.visualPlugins.capabilities(e.visualType))||void 0===e?void 0:e.objects))},e.prototype.ensureVisualContainerGrouping=function(e,t,r,i){for(var a=0,o=e;a<o.length;a++){var n,s,l=o[a];i&&(l.parentGroup=i),!r&&h.isVisualContainer(l)&&l.parentGroup&&(n=l.layouts.withId(0),s=O.getAbsoluteVisualContainerPosition(n.position,0,l.parentGroup),n.position=s,l.parentGroup=void 0),h.isVisualContainerGroup(l)&&(t[l.name],l.children=t[l.name]||[],this.ensureVisualContainerGrouping(l.children,t,r,l))}},e.prototype.ensureGroupZIndexNormalized=function(e){if(!_.isEmpty(e)){this.ensureListOrderNormalizedInternal(e,!0,"z");for(var t=0,r=e;t<r.length;t++){var i=r[t];h.isVisualContainerGroup(i)&&this.ensureGroupZIndexNormalized(i.children)}}},e.prototype.ensureGroupTabOrderNormalized=function(e,t){_.isEmpty(e)||_.every(t,(function(e){e=e.layouts.withId(0);return e&&e.position&&null==e.position.tabOrder}))||(this.ensureGroupsHaveTabOrders(e)||this.upgradeTabOrderToHierarchy(e),this.ensureGroupTabOrderNormalizedHelper(e))},e.prototype.upgradeTabOrderToHierarchy=function(e){var i=this;_.map(e,(function(t){var e,r;h.isVisualContainerGroup(t)&&void 0===(null===(e=null===(e=t.layouts)||void 0===e?void 0:e.withId(0).position)||void 0===e?void 0:e.tabOrder)&&(i.upgradeTabOrderToHierarchy(t.children),r=Number.NEGATIVE_INFINITY,h.traverseVisualContainerGroups([t],(function(e){e=null===(e=null===(e=e.layouts)||void 0===e?void 0:e.withId(0).position)||void 0===e?void 0:e.tabOrder;(r=e?_.max([r,e]):r)!==Number.NEGATIVE_INFINITY&&(t.layouts.withId(0).position.tabOrder=r)})))}))},e.prototype.ensureGroupsHaveTabOrders=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t];if(h.isVisualContainerGroup(i)){var a=i.layouts.withId(0);if(void 0===(null===(a=null==a?void 0:a.position)||void 0===a?void 0:a.tabOrder))return!1;if(!this.ensureGroupsHaveTabOrders(i.children))return!1}}return!0},e.prototype.ensureGroupTabOrderNormalizedHelper=function(e){this.ensureTabOrderNormalized(e,!0),this.ensureTabOrderNormalized(e,!1);for(var t=0,r=e;t<r.length;t++){var i=r[t];h.isVisualContainerGroup(i)&&this.ensureGroupTabOrderNormalizedHelper(i.children)}},e.prototype.ensureListOrderNormalized=function(e,t){void 0===t&&(t=!0),_.isEmpty(e)||(t&&this.ensureListOrderNormalizedInternal(e,!0,"z"),_.every(e,(function(e){e=e.layouts.withId(0);return e&&e.position&&null==e.position.tabOrder}))||(this.ensureTabOrderNormalized(e,!0),this.ensureTabOrderNormalized(e,!1)))},e.prototype.ensureTabOrderNormalized=function(e,t){var r=this,e=_.filter(e,(function(e){e=r.getListOrderPropertyFunction(e,"tabOrder");return t?0<=e||void 0===e:e&&e<0}));this.ensureListOrderNormalizedInternal(e,t,"tabOrder")},e.prototype.getListOrderPropertyFunction=function(e,t){e=e.layouts.withId(0);return e&&e.position&&e.position[t]},e.prototype.setListOrderPropertyFunction=function(e,t,r){e=e.layouts.withId(0);e&&e.position&&(e.position[t]=r)},e.prototype.ensureListOrderNormalizedInternal=function(e,t,r){var i=this,a=this.canvasListOrderNormalizeService.getContainerListOrders(e,(function(e){return i.getListOrderPropertyFunction(e,r)}));this.canvasListOrderNormalizeService.shouldNormalizeListOrder(a,t)&&(a=this.canvasListOrderNormalizeService.normalizeListOrder(a,t,(function(e){return i.getListOrderPropertyFunction(e,r)})),this.updateListOrders(e,a,r))},e.prototype.updateListOrders=function(e,t,r){for(var i=0,a=e;i<a.length;i++){var o=a[i],n=t[o.name];null!=n&&n!==this.getListOrderPropertyFunction(o,r)&&this.setListOrderPropertyFunction(o,r,n)}},e.prototype.ensureNames=function(e){for(var t,r=e.length,i={},a=0;a<r;a++){var o=e[a].name;_.isEmpty(o)?t=!0:i[o]=!0}if(t)for(a=0;a<r;a++){var n=e[a],s=n.name;_.isEmpty(s)&&(n.name=O.nextUniqueName(i),i[n.name]=!0)}},e.prototype.convertProjections=function(e,t,r,i){for(var a={},o=_.keys(i),n=_.keys(e),s=0,l=_.union(o,n);s<l.length;s++){var p=l[s],u=_.includes(r,p);a[p]=this.convertProjectionArray(e[p],t,u,i?i[p]:void 0)}return a},e.prototype.convertProjectionArray=function(e,t,r,i){var a,o=[];if(!_.isEmpty(e))for(var n=0,s=e;n<s.length;n++){var l=s[n],p=this.convertProjection(l,t);l.active&&(a=a||[]).push(p.queryRef),o.push(p)}var u=[];if(!_.isEmpty(i))for(var c=0,d=i;c<d.length;c++){var m=d[c],m={index:m.index,length:m.length,expr:T.deserializeExpr(m.expr)};u.push(m)}return new P(o,a,r,u)},e.prototype.convertProjection=function(e,t){var r=e.queryRef,r={queryRef:r=_.isNumber(e.queryRef)?t[e.queryRef].name:r};return e.format&&(r.format=e.format),r},e.prototype.serializeExploration=function(e,t){return this.createSerializer().serializeExploration(e,t)},e.prototype.serializeModelExtensions=function(e){return this.createSerializer().serializeModelExtensions(e)},e.prototype.serializePage=function(e,t,r){return this.createSerializer().serializePage(e,t,r)},e.prototype.serializePageShallow=function(e,t,r){return this.createSerializer().serializePageShallow(e,t,r)},e.prototype.serializeVisualContainer=function(e,t){return this.createSerializer().serializeVisualContainer(e,t)},e.prototype.serializeVisualContainerGroup=function(e){return this.createSerializer().serializeVisualContainerGroup(e)},e.prototype.serializePod=function(e){return this.createSerializer().serializePod(e)},e.prototype.serializeFilterCollection=function(e){return this.createSerializer().serializeFilterCollection(e)},e.prototype.serializeResourcePackages=function(e){return this.createSerializer().serializeResourcePackages(e)},e.prototype.createSerializer=function(){return new t(this.visualPlugins,this.explorationDowngrader,this.telemetryService,this.featureSwitchService)},e.prototype.upgradeVisualQuery=function(e,t){if(t===G.visuals.plugins.filledMap.name&&e.projections[M]){var r=e.projections[M],i=e.projections.Size;if(i&&0<i.all.length)for(var a=i.all().length-1;0<=a;a--)e.removeProjection("Size",{fieldIndex:a});e.projections.Size=r,delete e.projections[M]}r=this.visualPlugins.capabilities(t);if(r){r=Q.util.DrillUtils.getDrillableRoles(r),r=e.ensureDrillableRoles(r);if(!_.isEmpty(r)){for(var o={},n=0,s=r;n<s.length;n++){var l=s[n],p=e.projections[l],u=0;p&&(u=_.size(p.all())),o[l]=u}this.telemetryService.logEvent(G.telemetry.EXVisualDrillableRoleActiveItemsFixed,{visualType:t,fixedRoleByProjectionCount:JSON.stringify(o)})}}},e.prototype.upgradeResourcePackage=function(e){void 0===e.type&&(e.type=0)},e.prototype.getReferencedStaticResources=function(e){var t={},r=e.themeCollection.customTheme,i=e.themeCollection.baseTheme;if(this.addItemReference(t,e.resourcePackages,r&&r.type,r&&r.name),this.addItemReference(t,e.resourcePackages,i&&i.type,i&&i.name),!_.isEmpty(e.sections))for(var a=0,o=e.sections;a<o.length;a++){var n=o[a];if(m.StaticResourceReferences.addObjectsReferences(n.objects,h.Section.objectDescriptors,e.resourcePackages,t),!_.isEmpty(n.visualContainers))for(var s=0,l=n.visualContainers;s<l.length;s++){var p=l[s].config.singleVisual,u=p.objects,p=this.visualPlugins.capabilities(p.visualType);m.StaticResourceReferences.addObjectsReferences(u,p&&p.objects,e.resourcePackages,t)}}return t},e.prototype.addItemReference=function(e,t,r,i){var a;i&&r&&((a=w.findItemInPackages(t,r,i))&&(t=w.ensurePackageName(r),m.StaticResourceReferences.addItemReference(e,t,r,i,a.type)))},e.prototype.parseExplorationConfigs=function(e){var t=this;if(e){var r=this.parseConfig(e);return r.sections=_.map(e.sections,(function(e){return t.parsePageConfigs(e)})),r}},e.prototype.parseConfig=function(e){var t=_.clone(e);return t.config=V.tryParseJSON(e.config)||{},t},e.prototype.parsePageConfigs=function(e){var t=this,r=this.parseConfig(e);return r.visualContainers=_.map(e.visualContainers,(function(e){return t.parseConfig(e)})),r},e.prototype.stringifyExplorationConfigs=function(e){var t=this,r=this.stringifyConfig(e);return r.sections=_.map(e.sections,(function(e){return t.stringifyPageConfigs(e)})),r},e.prototype.stringifyConfig=function(e){var t=_.clone(e);return t.config=JSON.stringify(e.config),t},e.prototype.stringifyPageConfigs=function(e){var t=this,r=this.stringifyConfig(e);return r.visualContainers=_.map(e.visualContainers,(function(e){return t.stringifyConfig(e)})),r},e.prototype.parseFilterCollectionConfig=function(e){if(e)return this.parseConfig(e)},e.prototype.stringifyFilterCollectionConfig=function(e){if(e)return this.stringifyConfig(e)},e);function e(e,t,r,i,a,o,n){this.visualPlugins=e,this.telemetryService=t,this.featureSwitchService=r,this.canvasListOrderNormalizeService=i,this.contextActivityService=a,this.userState=o,this.explorationUpgrader=m.upgrade.createExplorationUpgrader(r),this.explorationDowngrader=m.downgrade.createExplorationDowngrader(n)}var U=E.v3_14;m.getOldestSaveVersion=function(){return U},m.setOldestSaveVersion=function(e){U=e};var t=(z.prototype.serializeExploration=function(e,r){var i=this,t=e.sections;r&&r.withTransientPages||(t=h.Section.filterTransient(t));var a,t=_.map(t,(function(e,t){return i.serializePage(e,t,r)}));_.isEmpty(e.pods)||(this.removeInvalidPods(e.sections,e.pods,this.telemetryService),a=_.map(e.pods,(function(e){return i.serializePod(e)})),d.hasUniqueNames(e.pods));e=this.serializeExplorationShallowWithResourcePackages(e,r);return e.sections=t,e.pods=a,r&&r.forSave&&this.explorationDowngrader.downgrade(e,this.version),this.version,e.config.version,e},z.prototype.serializeBookmarks=function(e,r,i){var a=this;if(e){var t=_.map(e,(function(e){var t=!1;if(o.isBookmarkGroup(e)||(t=m.ExplorationState.clearUnusedReferences(e.explorationState,r)),a.featureSwitchService.featureSwitches.bookmarkCacheEnabled&&i){t&&i.deleteCache("bookmark",e);t=i.getSerializedObject("bookmark",e);return t||(t=a.serializeBookmark(e,r,i),i.setSerializedObject("bookmark",e,t)),t}return a.serializeBookmark(e,r,i)})),e=z.getVersion(e,t);return this.version=D.max(this.version,e),t}},z.prototype.serializeBookmark=function(e,t,r){if(o.isBookmarkGroup(e))return{displayName:e.displayName,name:e.name,children:this.serializeBookmarks(e.children,t,r)};r={displayName:e.displayName,name:e.name,explorationState:m.ExplorationState.serialize(e.explorationState,this.featureSwitchService)};return e.options&&(r.options=this.serializeBookmarkOptions(e.options)),r},z.prototype.serializeBookmarkOptions=function(e){return e},z.getVersion=function(e,t){var r=s.v1_0,i=s.v1_0;switch(t.forEach((function(e){q(e)||(r=D.max(e.explorationState.version,r))})),e.forEach((function(e){o.isBookmarkGroup(e)?i=D.max(i,S.BookmarkGroup):e.options&&(i=D.max(i,S.BookmarkOptions))})),r){case s.v1_0:i=D.max(i,S.bookmarks);break;case s.v1_1:i=D.max(i,S.ExplorationState_v1_1);break;case s.v1_2:i=D.max(i,S.ExplorationState_v1_2);break;case s.v1_3:i=D.max(i,S.ExplorationState_v1_3);break;case s.v1_4:i=D.max(i,S.ExplorationState_v1_4);break;case s.v1_5:i=D.max(i,S.VisualFilterExpressionMetadata);break;case s.v1_6:i=D.max(i,S.AllowInlineExploration);break;case a.FieldParameters:i=D.max(i,S.QueryFieldParameters);break;case a.OnObject:i=D.max(i,S.OnObject)}return i},z.prototype.serializeQnaAction=function(e){if(e){e=e.suggestedUtterances;if(!_.isEmpty(e))return{suggestedUtterances:_.map(e,(function(e){return m.UtteranceDefinitionSerializer.serialize(e)}))}}},z.prototype.serializeExplorationShallowWithResourcePackages=function(e,t){var r=e.activeSectionIndex,i=this.createVersionedElementConfig(U);this.version=D.max(this.version,i.version),i.themeCollection=R.cloneThemeCollection(e.themeCollection),_.isNumber(r)&&(i.activeSectionIndex=r),_.isEmpty(e.modelExtensions)||(this.version=D.max(this.version,E.v3_0),i.modelExtensions=this.serializeModelExtensions(e.modelExtensions)),_.isEmpty(e.bookmarks)||(a=this.serializeBookmarks(e.bookmarks,e,null==t?void 0:t.cache),i.bookmarks=a),t&&t.excludeHighContrastTheme&&delete i.themeCollection.highContrastTheme,t&&t.forSave&&delete i.themeCollection.transientUserSetTheme;var a=e.themeCollection.baseTheme;a&&(this.version=D.max(this.version,G.explore.util.ThemeUtils.getVersionForBaseTheme(a.name))),j.isNullOrUndefinedOrWhiteSpaceString(e.dataSourceVariables)||(this.version=D.max(this.version,E.v4_2),i.dataSourceVariables=e.dataSourceVariables),e.tags&&(i.tags=e.tags),null!=e.defaultDrillFilterOtherVisuals&&(i.defaultDrillFilterOtherVisuals=e.defaultDrillFilterOtherVisuals,e.defaultDrillFilterOtherVisuals&&(this.version=D.max(this.version,S.SectionCrossDrill))),null!=e.filterSortOrder&&(i.filterSortOrder=e.filterSortOrder,e.filterSortOrder&&(this.version=D.max(this.version,S.FiltersSort))),e.slowDataSourceSettings&&(((a=_.cloneDeep(e.slowDataSourceSettings)).isCrossHighlightingDisabled||a.isFieldWellButtonEnabled||a.isFilterSelectionsButtonEnabled||a.isSlicerSelectionsButtonEnabled||a.isApplyAllButtonEnabled)&&(this.version=a.isApplyAllButtonEnabled?D.max(this.version,S.ApplyAll):D.max(this.version,S.slowDataSource)),i.slowDataSourceSettings=a),null!=e.linguisticSchemaSyncVersion&&(i.linguisticSchemaSyncVersion=e.linguisticSchemaSyncVersion,e.linguisticSchemaSyncVersion!==u.Unspecified&&(this.version=D.max(this.version,S.LinguisticSchemaSyncVersion))),e.settings&&(((o=_.cloneDeep(e.settings)).isPersistentUserStateDisabled||o.hideVisualContainerHeader)&&(this.version=D.max(this.version,S.ExplorationSettings)),o.useStylableVisualContainerHeader&&(this.version=D.max(this.version,S.StylableVisualContainerHeader)),void 0!==o.exportDataMode&&0!==o.exportDataMode&&(this.version=D.max(this.version,S.ExportDataMode)),o.useNewFilterPaneExperience&&(this.version=D.max(this.version,S.NewFilterPaneExperience)),o.isReportAnnotationsDisabled&&(this.version=D.max(this.version,S.ReportAnnotations)),!0===o.defaultFilterActionIsDataFilter&&(this.version=D.max(this.version,S.DefaultFilterAction)),o.useCrossReportDrillthrough&&(this.version=D.max(this.version,S.CrossReportDrillthrough)),o.allowChangeFilterTypes&&(this.version=D.max(this.version,S.AllowChangeFilterTypes)),o.allowInlineExploration&&(this.version=D.max(this.version,S.AllowInlineExploration)),o.optOutNewFilterPaneExperience&&(this.version=D.max(this.version,S.MigrateFilterPaneExperience)),o.filterPaneHiddenInEditMode&&(this.version=D.max(this.version,S.FilterPaneHiddenInEditMode)),o.disableFilterPaneSearch&&(this.version=D.max(this.version,S.DisableFilterPaneSearch)),o.pagesPosition&&(this.version=D.max(this.version,S.PagesPosition)),o.useEnhancedTooltips&&(this.version=D.max(this.version,S.EnhancedTooltips)),o.allowAutomatedInsightsNotification&&(this.version=D.max(this.version,S.AllowAutomatedInsightsNotification)),o.useDefaultAggregateDisplayName&&(this.version=D.max(this.version,S.DefaultAggregateDisplayName)),i.settings=o),e.objects&&(i.objects=this.serializeObjects(e.objects,h.ExplorationObjectDescriptors,"report")),t&&t.forSave?(this.version=this.explorationDowngrader.getFinalExplorationVersion(e,this.version),D.lt(this.version,i.version)):this.version=n;var o=this.serializeFilterContainers(e.filters,t);return e.creationSource&&(i.creationSource=e.creationSource,this.version=D.max(this.version,S.QuickExplore)),i.version=this.version,{id:e.id,report:e.report,reportId:e.reportId,theme:e.themeCollection.customTheme&&e.themeCollection.customTheme.name,filters:o,resourcePackages:this.serializeResourcePackages(e.resourcePackages,t),sections:void 0,config:i,layoutOptimization:this.getLayoutOptimizations(e),publicCustomVisuals:e.publicCustomVisuals}},z.prototype.serializeLinkField=function(e){var t=e.fieldExpr;return i.isMeasure(t)&&!1===e.asAggregation||i.isColumn(t)||i.isHierarchyLevel(t),{asAggregation:e.asAggregation,fieldExpr:T.serializeExpr(t)}},z.prototype.serializeFilterCollection=function(e){if(!_.isEmpty(e)){var t=this.createVersionedElementConfig(U);return{filters:this.serializeFilterContainers(e),config:t}}},z.prototype.serializePage=function(e,t,r){var i=this.serializePageShallow(e,t,r);if(i.visualContainers=[],e.visualContainerGroups)this.serializeVisualContainerTreeToList(e.visualContainerGroups,i.visualContainers,r);else for(var a=0,o=e.visualContainers;a<o.length;a++){var n=o[a];i.visualContainers.push(this.serializeVisualContainer(n,r))}return i},z.prototype.serializeVisualContainerTreeToList=function(e,t,r){for(var i=!1,a=0,o=e;a<o.length;a++){var n=o[a];h.isVisualContainerGroup(n)?(i||(this.version=D.max(m.upgrade.ExplorationVersionHelper.getVersionForVisualContainerGroup(n),this.version),i=!0),t.push(this.serializeVisualContainerGroup(n)),this.serializeVisualContainerTreeToList(n.children,t,r)):t.push(this.serializeVisualContainer(n,r))}},z.prototype.isRegularPageUsingMeasureDrillthrough=function(e){var t=!1,r=!1;return e.type&&0!==e.type||(t=!0===e.acceptsAllFiltersWhenLinked,r=_.some(e.filters,(function(e){return 5===e.howCreated&&!e.isTransient&&(e.isLinkedAsAggregation||e.expression&&i.isMeasure(e.expression))}))),t||r},z.prototype.isMeasureDrillthroughPod=function(e){var t=!1,r=!1;return 1===e.type&&(t=e.config&&0===e.config.acceptsFilterContext,r=_.some(e.parameters,(function(e){return e.asAggregation||e.fieldExpr&&i.isMeasure(e.fieldExpr)}))),t||r},z.prototype.serializePageShallow=function(e,t,r){var i=this;_(e.visualContainers).map((function(e){return e.name})).uniq().value().length,e.visualContainers.length;var a={id:e.id,name:e.name,displayName:e.displayName,filters:this.serializeFilterContainers(e.filters,r),ordinal:t,visualContainers:void 0,transient:e.transient,objectId:e.objectId,config:{}};e.size&&(a.displayOption=e.size.displayOption,a.width=e.size.width,a.height=e.size.height);var t=a.config;return _.isEmpty(e.relationships)||(t.relationships=this.serializeRelationships(e.relationships),r&&r.featureUsage&&(r.featureUsage.hasVisualRelationships=!0)),e.objects&&(t.objects=this.serializeObjects(e.objects,h.Section.objectDescriptors,"page")),null!=e.visibility&&(t.visibility=e.visibility,this.version=D.max(this.version,S.SectionVisibility)),null!=e.type&&(t.type=e.type,this.version=D.max(this.version,S.CanvasTooltips)),null!=e.filterSortOrder&&(t.filterSortOrder=e.filterSortOrder,this.version=D.max(this.version,S.FiltersSort)),t.acceptsAllFiltersWhenLinked=e.acceptsAllFiltersWhenLinked,this.isRegularPageUsingMeasureDrillthrough(e)&&(this.version=D.max(this.version,S.MeasureDrillthrough)),_.isEmpty(e.linkFields)||(t.linkFields=_.map(e.linkFields,(function(e){return i.serializeLinkField(e)})),this.version=D.max(this.version,S.CanvasTooltips)),e.dynamicConfig&&(t.dynamicConfig=this.serializePageDynamicConfig(e.dynamicConfig),this.version=D.max(this.version,S.QuickExplore),null!==(t=t.dynamicConfig.quickExplore)&&void 0!==t&&t.layout&&(this.version=D.max(this.version,S.QuickExploreLayout))),a},z.prototype.serializePod=function(e){var t=this.serializePodParameters(e.parameters);return this.isMeasureDrillthroughPod(e)&&(this.version=D.max(this.version,S.MeasureDrillthrough)),1===e.referenceScope&&(this.version=D.max(this.version,S.CrossReportDrillthrough)),{id:e.id,name:e.name,boundSection:e.boundSection,parameters:_.isEmpty(t)?void 0:JSON.stringify(t),cortanaEnabled:e.cortanaEnabled||void 0,type:0!==e.type?e.type:void 0,referenceScope:0!==e.referenceScope?e.referenceScope:void 0,config:this.serializePodConfig(e.config)}},z.prototype.serializeVisualContainer=function(e,t){var r;_.forEach(e.layouts,(function(e){e.position&&L(e.position)}));var i=this.serializeVisualContainerConfig(e,t),a=e.layouts&&e.layouts.withId(0);return a?(a.position,r={id:e.id,x:a.position.x,y:a.position.y,z:a.position.z,width:a.position.width,height:a.position.height,config:i,filters:this.serializeFilterContainers(e.filters)},a.position.tabOrder&&(r.tabOrder=a.position.tabOrder)):r={id:e.id,config:i,filters:this.serializeFilterContainers(e.filters)},_.isEmpty(e.filters)||(i=this.visualPlugins.capabilities(e.config.singleVisual.visualType),Q.FilterUtils.supportsFilterOutput(i)&&(this.version=D.max(this.version,S.VisualLevelSlicerFilters))),t&&t.withVisibility&&(null!=e.visibility&&(r.visibility=e.visibility),null!=e.detailVisualLayout&&(r.detailVisualLayout=e.detailVisualLayout)),t&&e.cachedData&&((t.withQuery||t.withData)&&(r.query=e.cachedData.queryObject?JSON.stringify(e.cachedData.queryObject):e.cachedData.query,r.dataTransforms=e.cachedData.transformsObject?G.data.services.DataViewTransformActionsSerializer.serializeTransformActions(e.cachedData.transformsObject):e.cachedData.transforms,r.dataUpdatedTime=e.cachedData.dataUpdatedTime?e.cachedData.dataUpdatedTime.toISOString():void 0),t.withData&&(r.dataBinaryBase64Encoded=e.cachedData.dataObject?jsCommon.GzipUtility.compress(JSON.stringify(e.cachedData.dataObject)):e.cachedData.data)),r},z.prototype.serializeVisualContainerGroup=function(e){this.version=D.max(this.version,S.VisualContainerGrouping);var t,r={name:e.name,layouts:_.cloneDeep(e.layouts),singleVisualGroup:{displayName:e.displayName,groupMode:e.groupMode,isHidden:e.isHidden}};e.parentGroup&&(r.parentGroupName=e.parentGroup.name),e.objects&&(r.singleVisualGroup.objects=this.serializeObjects(e.objects,I.objectDescriptors,I.objectType));var i=e.layouts&&e.layouts.withId(0);return i?(i.position,t={id:e.id,x:i.position.x,y:i.position.y,z:i.position.z,width:i.position.width,height:i.position.height,config:r},this.featureSwitchService.featureSwitches.accessibilityTopLevelNav&&i.position.tabOrder&&(t.tabOrder=i.position.tabOrder)):t={id:e.id,config:r},t},z.prototype.serializeModelExtensions=function(e){var t=this;if(e)return _.map(e,(function(e){return{name:e.name,extends:e.extends,entities:t.serializeModelExtensionEntities(e.entities)}}))},z.prototype.serializeRelationship=function(e){return e.source.name,e.target.name,{source:e.source.name,target:e.target.name,type:e.type}},z.prototype.serializeVisualContainerConfig=function(e,t){var r=e.config&&e.config.singleVisual;e.name,r.visualType;var i=r.query,a=i?i.projections:void 0,o={name:e.name,layouts:_.cloneDeep(e.layouts),singleVisual:{visualType:r.visualType,projections:this.serializeQueryProjections(a),prototypeQuery:i?T.serializeQuery(i.defn):void 0}};null!=r.autoSelectVisualType&&(this.version=D.max(this.version,S.OnObject),o.singleVisual.autoSelectVisualType=r.autoSelectVisualType);a=this.serializeQueryFieldParameters(a);_.isEmpty(a)||(this.version=D.max(this.version,S.QueryFieldParameters),o.singleVisual.queryFieldParametersByRole=a),_.some(e.layouts,(function(e){return e.position&&void 0!==e.position.tabOrder}))&&(this.version=D.max(this.version,S.AccessibilityTopLevelNav)),i&&x.hasExpansionState(i.expansionStates)&&(n=b.serializeExpansionStates(i.expansionStates),_.isEmpty(n)||(o.singleVisual.expansionStates=n,this.version=D.max(this.version,S.ExpandCollapse)));var n=r.columnProperties;if(n&&!_.isEmpty(n)&&(this.version=D.max(this.version,E.v3_4),o.singleVisual.columnProperties=_.cloneDeep(n)),r.queryOptions&&(null!=r.queryOptions.allowBinnedLineSample&&(this.version=D.max(this.version,E.v3_3)),null!=r.queryOptions.allowOverlappingPointsSample&&(this.version=D.max(this.version,E.v3_5)),null!=r.queryOptions.keepProjectionOrder&&(this.version=D.max(this.version,E.v4_1)),o.singleVisual.queryOptions=_.cloneDeep(r.queryOptions)),r.display&&(this.version=D.max(this.version,S.visualHidden),o.singleVisual.display=_.cloneDeep(r.display)),i&&i.defn){r.visualType!==G.visuals.plugins.slicer.name||(u=i.projections)&&u[G.visuals.slicerRoles.value]&&1<u[G.visuals.slicerRoles.value].all().length&&(this.version=D.max(this.version,S.HierarchicalSlicer)),O.isSmallMultiplesVisual(r)&&(_.some(v,(function(e){return e===r.visualType}))?this.version=D.max(this.version,S.CartesianSmallMultiplesCombo):this.version=D.max(this.version,S.CartesianSmallMultiples));for(var s=0,l=i.defn.select();s<l.length;s++){var p=l[s];this.version=D.max(this.version,m.upgrade.ExplorationVersionHelper.getVersionForSQExpr(p.expr))}this.version=D.max(this.version,m.upgrade.ExplorationVersionHelper.getVersionForSortDefinitions(i.defn.orderBy()))}var u=this.serializeShowAllRoles(i?i.projections:void 0);_.isEmpty(u)||(o.singleVisual.showAllRoles=u,t&&t.featureUsage&&(t.featureUsage.hasShowAllEnabled=!0)),r.visualType===G.visuals.plugins.ribbonChart.name&&(this.version=D.max(this.version,E.v3_5)),r.visualType===G.visuals.plugins.actionButton.name&&(this.version=D.max(this.version,S.ActionButton)),r.visualType===G.visuals.plugins.pythonVisual.name&&(this.version=D.max(this.version,E.v3_17)),r.visualType===G.visuals.plugins.keyDriversVisual.name&&(this.version=D.max(this.version,E.v4_1),r.query&&!_.isEmpty(r.query.tryGetExprs(G.visuals.keyDriverRoleNames.details))&&(this.version=D.max(this.version,S.KeyDriversDetails))),r.visualType===G.visuals.plugins.qnaVisual.name&&(this.version=D.max(this.version,E.v5_4)),r.visualType===G.visuals.plugins.decompositionTreeVisual.name&&(this.version=D.max(this.version,E.v5_5)),r.visualType===G.visuals.plugins.azureMap.name&&(this.version=D.max(this.version,E.v5_13)),r.visualType===G.visuals.plugins.shape.name&&(this.version=D.max(this.version,S.ShapeVisual)),r.visualType===G.visuals.plugins.pageNavigator.name&&(this.version=D.max(this.version,S.NavigatorVisuals)),r.visualType===G.visuals.plugins.bookmarkNavigator.name&&(this.version=D.max(this.version,S.NavigatorVisuals)),r.visualType===G.visuals.plugins.rdlVisual.name&&(this.version=D.max(this.version,S.RdlVisual)),r.visualType===G.visuals.plugins.scorecard.name&&(this.version=D.max(this.version,S.ScorecardVisual)),r.syncGroup&&(o.singleVisual.syncGroup=_.cloneDeep(r.syncGroup),this.version=D.max(this.version,S.VisualSyncGroup)),null!=e.drillFilterOtherVisuals&&(o.singleVisual.drillFilterOtherVisuals=e.drillFilterOtherVisuals,this.version=D.max(this.version,S.SectionCrossDrill)),null!=e.filterSortOrder&&(o.singleVisual.filterSortOrder=e.filterSortOrder,this.version=D.max(this.version,S.FiltersSort)),e.parentGroup&&(o.parentGroupName=e.parentGroup.name,this.version=D.max(this.version,S.VisualContainerGrouping)),r.hasDefaultSort&&(o.singleVisual.hasDefaultSort=r.hasDefaultSort);var c,e=i?r.query.defn.select():jsCommon.ArrayExtensions.createWithName();r.objects&&(d=(i=this.visualPlugins.capabilities(r.visualType))&&i.objects,o.singleVisual.objects=this.serializeObjects(r.objects,d,r.visualType,e),(i=r).visualType===G.visuals.plugins.scatterChart.name&&i.query&&i.query.projections.Play&&!_.isEmpty(i.query.projections.Play.all())&&(c=!1,g.visitPropertyDefinitions(r.objects,d,(function(e,t,r,i,a){"fill"===t&&"dataPoint"===i&&null!=r&&(c=!0)})),c&&(this.version=D.max(this.version,E.v5_1))),this.supportsScalarMarkers(r)&&D.lt(this.version,S.LineChartExplicitDots)&&this.upgradeIfScalarMarkersAreSet(r.objects));var d=r.vcObjects;return d&&(o.singleVisual.vcObjects=this.serializeObjects(d,A.CommonObjectDescriptors,r.visualType,e),(d=(d=g.getObjectDefinition(d,"visualLink",void 0))&&d.properties.qna)&&(o.singleVisual.vcObjects.visualLink[0].properties.qna=this.serializeQnaAction(d))),this.featureSwitchService.featureSwitches.mobileAuthoringFormattingUI&&this.serializeMobileState(r,o.singleVisual,null==t?void 0:t.forSave),r.cachedFilterDisplayItems&&(o.singleVisual.cachedFilterDisplayItems=C.serializeFilterLabelIdPairs(r.cachedFilterDisplayItems)),r.filterExpressionMetadata&&(o.singleVisual.filterExpressionMetadata=N.serializeFilterExpressionMetadata(r.filterExpressionMetadata,this.featureSwitchService.featureSwitches.serializeSpaceOptimization),this.version=D.max(this.version,S.VisualFilterExpressionMetadata)),this.version<S.DotPlotVisual&&(function(e){if(e.visualType!==G.visuals.plugins.scatterChart.name)return!1;var t=G.visuals.scatterRoleNames.x,r=e.query,e=r?r.getRolesProjectionRefs([t]):void 0,e=_.size(e);if(1<e)return!0;if(1===e){t=r.tryGetExpr(t,0);if(t&&!F.isMeasure(t))return!0}return!1})(r)&&(this.version=S.DotPlotVisual),o},z.prototype.serializeMobileState=function(e,t,r){r||(e.mobileVcObjects&&(t.mobileVcObjects=y.serializeObjects(e.mobileVcObjects,A.CommonObjectDescriptors,this.featureSwitchService.featureSwitches.serializeSpaceOptimization)),e.mobileObjects&&(t.mobileObjects=y.serializeObjects(e.mobileObjects,null===(e=this.visualPlugins.capabilities(e.visualType))||void 0===e?void 0:e.objects,this.featureSwitchService.featureSwitches.serializeSpaceOptimization)))},z.prototype.serializeObjects=function(e,t,r,i){var a=y.serializeObjects(e,t,this.featureSwitchService.featureSwitches.serializeSpaceOptimization);return this.isAtLatestVersion()||(this.version=D.max(this.version,m.upgrade.getVersionForObjectDefinitions(e,t,r,this.version,i))),a},z.prototype.isAtLatestVersion=function(){return this.version===n},z.prototype.serializeShowAllRoles=function(e){if(e){e=_.pickBy(e,(function(e){return!0===e.showAll}));return _.keys(e)}},z.prototype.serializeQueryProjections=function(e){if(e){var t,r={};for(t in e){var i=e[t].all(),a=e[t].activeProjectionRefs;if(0<i.length){r[t]=[];for(var o=0,n=i;o<n.length;o++){var s=n[o],l=s.queryRef,p={queryRef:l};s.format&&(p.format=s.format),_.includes(a,l)&&(p.active=!0),r[t].push(p)}}}return r}},z.prototype.serializeQueryFieldParameters=function(e){if(e){var t,r={};for(t in e){var i=e[t].getFieldParameters();if(0<i.length){r[t]=[];for(var a=0,o=i;a<o.length;a++){var n=o[a],n={index:n.index,length:n.length,expr:T.serializeExpr(n.expr)};r[t].push(n)}}}return r}},z.prototype.serializeModelExtensionEntities=function(e){var r=this;if(e)return _.map(e,(function(e){var t={name:e.name};return e.extends&&(t.extends=e.extends),e.measures&&(t.measures=r.serializeModelExtensionMeasures(e.measures)),t}))},z.prototype.serializeExpressionReferences=function(e){if(e&&(e.unrecognizedReferences||!_.isEmpty(e.measures))){var t={unrecognizedReferences:e.unrecognizedReferences};return _.isEmpty(e.measures)||(t.measures=e.measures),t}},z.prototype.serializeModelExtensionAnnotations=function(e){if(e)return _.map(e,(function(e){return{name:e.name,value:e.value}}))},z.prototype.serializeModelExtensionMeasures=function(e){var r=this;if(e)return _.map(e,(function(e){var t={name:e.name,dataType:e.dataType,dataCategory:e.dataCategory,expression:e.expression,errorMessage:e.errorMessage,hidden:e.hidden,references:r.serializeExpressionReferences(e.references),formulaOverride:e.formulaOverride,formatInformation:e.formatInformation,displayFolder:e.displayFolder};return e.annotations&&(t.annotations=r.serializeModelExtensionAnnotations(e.annotations)),e.measureTemplate&&(t.measureTemplate={daxTemplateName:e.measureTemplate.daxTemplateName,version:e.measureTemplate.version}),e.description&&(t.description=e.description,r.version=D.max(r.version,S.description)),t}))},z.prototype.serializeFilterContainers=function(e,t){var r;if(e){for(var i=[],a=0,o=e;a<o.length;a++){var n,s=o[a];s&&(0!==s.howCreated||Q.FilterUtils.isFilterModified(s))&&(!s.isTransient||t&&t.withTransientFilters)&&(7===s.howCreated&&t&&t.forSave&&(s.howCreated=1),5===s.howCreated&&(this.version=D.max(this.version,E.v3_5)),s.isHiddenInViewMode&&(this.version=D.max(this.version,S.FilterContainerVisibilityControl)),s.isLockedInViewMode&&(this.version=D.max(this.version,S.FilterContainerVisibilityControl)),s.displayName&&(this.version=D.max(this.version,S.RenameFilters)),s.ordinal&&(this.version=D.max(this.version,S.FiltersSort)),s.type===h.FilterType.RelativeTime&&(this.version=D.max(this.version,S.RelativeTimeFilter)),s.type===h.FilterType.Advanced&&null!==(r=s.filter)&&void 0!==r&&r.conditions().some((function(e){e=G.data.SQExpr.isNot(e)?e.arg:e;return G.data.SQExpr.isCompare(e)&&G.data.SQExpr.isConstantText(e.right)&&""===e.right.value}))&&(this.version=D.max(this.version,S.IsEmptyFilterOperator)),!s.filterExpressionMetadata||_.isEmpty(s.filterExpressionMetadata.expressions)||_.isEmpty(s.filterExpressionMetadata.cachedValueItems)||(_.isEmpty(s.filterExpressionMetadata.jsonFilter)?this.version=D.max(this.version,S.FilterContainerFilterMetadata):this.version=D.max(this.version,S.GokSupportForCV)),n=s.filterExpressionMetadata?N.serializeFilterExpressionMetadata(s.filterExpressionMetadata,this.featureSwitchService.featureSwitches.serializeSpaceOptimization):void 0,i.push({name:s.name,expression:s.expression?T.serializeExpr(s.expression):void 0,filter:s.filter?T.serializeFilter(s.filter):void 0,type:h.FilterType[s.type],restatement:s.restatement,cachedDisplayNames:C.serializeFilterLabelIdPairs(s.cachedValueItems),howCreated:s.howCreated,isLinkedAsAggregation:s.isLinkedAsAggregation,isTransient:s.isTransient,objects:s.objects?this.serializeObjects(s.objects,p,l):void 0,isHiddenInViewMode:s.isHiddenInViewMode,isLockedInViewMode:s.isLockedInViewMode,filterExpressionMetadata:n,displayName:s.displayName,ordinal:s.ordinal}))}return JSON.stringify(i)}},z.prototype.createVersionedElementConfig=function(e){return{version:e}},z.prototype.serializeResourcePackages=function(e,a){if(!_.isEmpty(e)){for(var o=[],t=0,r=e;t<r.length;t++)!(function(e){var t=_.find(e.items,(function(e){return e.type===c.CustomVisualMetadata}));!t||void 0===t.content||(i=_.isString(t.content)?jsCommon.JsonExtensions.tryParseJSON(t.content):t.content)&&(i.content=void 0,t.content=JSON.stringify(i));var r,i=e.items;i&&(r=["contentBlob","contentBlobUrl","promise"],a&&a.excludeResourceItemContent&&r.push("content"),i=_.map(i,(function(e){return _.omit(e,r)}))),o.push({resourcePackage:{id:e.id,name:e.name,type:e.type,items:i,disabled:!!e.disabled}})})(r[t]);return o}},z.prototype.getLayoutOptimizations=function(e){e=this.getDistinctLayouts(e);return this.getLayoutOptimizationFromLayouts(e)},z.prototype.getLayoutOptimizationFromLayouts=function(e){for(var t=0,r=0,i=e;r<i.length;r++)1===i[r].id&&(t|=1);return t},z.prototype.getDistinctLayouts=function(e){for(var e=e.sections,t=d.createWithId(),r=0,i=e;r<i.length;r++)for(var a=0,o=i[r].visualContainers;a<o.length;a++)for(var n=0,s=o[a].layouts;n<s.length;n++){var l=s[n];t.withId(l.id)||t.push(l)}return t},z.prototype.serializePodParameters=function(e){if(!_.isEmpty(e)){for(var t=[],r=0,i=e;r<i.length;r++){var a=i[r];t.push({name:a.name,boundFilter:a.boundFilter,fieldExpr:a.fieldExpr?T.serializeExpr(a.fieldExpr):void 0,asAggregation:a.asAggregation||void 0,isLegacySingleSelection:a.isLegacySingleSelection||void 0})}return t}},z.prototype.serializePodConfig=function(e){return _.isEmpty(e)||0===e.acceptsFilterContext?"{}":JSON.stringify(e)},z.prototype.serializeRelationships=function(e){if(!_.isEmpty(e)){for(var t,r=0,i=e;r<i.length;r++){var a=i[r],a=this.serializeRelationship(a);a&&(t=t||[]).push(a)}return t}},z.prototype.removeInvalidPods=function(e,o,t){var n,r=_.map(e,(function(e){return e.name})),i=_.remove(o,(function(e){return!_.includes(r,e.boundSection)})),i=_.size(i);0<i&&t.logEvent(G.telemetry.PodSerializationErrorFixed,{errorType:"NonExistingBoundSection",count:i}),_.size(o)<=_.size(e)||(i=_.groupBy(o,(function(e){return e.boundSection})),n=0,_.forEach(i,(function(e){var t=e.length;if(1<t){n++;for(var r=e[0].boundSection,i=_.findLastIndex(o,(function(e){return e.boundSection===r})),a=t-1;0<a&&0<=i;)o.splice(i,1),a--,i=_.findLastIndex(o,(function(e){return e.boundSection===r}),i-1)}})),0<n&&t.logEvent(G.telemetry.PodSerializationErrorFixed,{errorType:"DuplicateBoundSection",count:n}),0<(i=_.size(o)-_.size(e))&&(o=o.slice(0,_.size(e)),t.logEvent(G.telemetry.PodSerializationErrorFixed,{errorType:"ExceedingPodsNumberAfterInitialFix",count:i})))},z.prototype.supportsScalarMarkers=function(t){var e=[G.visuals.plugins.lineChart.name,G.visuals.plugins.areaChart.name,G.visuals.plugins.stackedAreaChart.name];return _.some(e,(function(e){return e===t.visualType}))},z.prototype.upgradeIfScalarMarkersAreSet=function(e){var t=g.getValue(e,{objectName:"categoryAxis",propertyName:"axisType"},null);!t||"Scalar"!==G.data.SQConstantExpr.getTextValue(t)||(e=g.getValue(e,{objectName:"lineStyles",propertyName:"showMarker"},null))&&G.data.SQConstantExpr.getBooleanValue(e)&&(this.version=D.max(this.version,S.LineChartExplicitDots))},z.prototype.serializePageDynamicConfig=function(e){var t,r,i;return e.quickExplore&&(t=e.quickExplore.selectedFields,r=e.quickExplore.visualContainerConfigurations,e=e.quickExplore.layout,(i=i||{}).quickExplore={selectedFields:_.map(t,(function(e){return T.serializeExpr(e)})),visualContainerConfigurations:_.map(r,(function(e){return{name:e.name,fields:_.map(e.fields,(function(e){return T.serializeExpr(e)}))}}))},e&&(i.quickExplore.layout=this.serializeQuickExploreLayout(e),this.version=D.max(this.version,S.QuickExploreLayout))),i},z.prototype.serializeQuickExploreLayout=function(e){if(e.combination){var t={version:e.combination.version};return e.combination.dataTableName&&(t.dataTableName=e.combination.dataTableName),{combination:t}}if(e.related){t={version:e.related.version};return e.related.dataTableName&&(t.dataTableName=e.related.dataTableName),{related:t}}},z);function z(e,t,r,i){this.visualPlugins=e,this.explorationDowngrader=t,this.telemetryService=r,this.featureSwitchService=i,this.version=U}function L(e){null!=e.x&&null!=e.y&&null!=e.width&&null!=e.height||(jsCommon.Trace.error("deserializeVisualContainer found null in layout position: "+JSON.stringify({x:e.x,y:e.y,width:e.width,height:e.height})),null==e.x&&(e.x=0),null==e.y&&(e.y=0),null==e.width&&(e.width=0),null==e.height&&(e.height=0))}function q(e){return void 0!==e.children}})((Q=G.explore||(G.explore={})).services||(Q.services={}))})(powerbi=powerbi||{}),(function(e){(function(c){var d=jsCommon.Version,t=jsCommon.JsonExtensions;c.createExplorationUpgrader=function(e){return new r(e)};var r=(e.prototype.upgrade=function(e,t,r,i){if(this.upgradeElement(e,t,r,(function(e,t,r){return e.upgrade(t,r)}),i)){i=e;return this.upgradeVisualObjects(i,e.config.version),e.config.version=c.CurrentExplorationVersion,i}},e.prototype.upgradeFilterCollection=function(e,t,r){if(this.upgradeElement(e,t,r,(function(e,t){return e.upgradeFilterCollection(t)})))return e.config.version=c.CurrentExplorationVersion,e},e.prototype.getVersionUpgraders=function(){return this.versionUpgraders},e.prototype.upgradeElement=function(e,t,r,i,a){t&&_.isEmpty(t);var o=this.getVersionedElementConfig(e),n=o.version&&_.isString(o.version)?o.version:d.ZeroStr;if(d.gt(n,c.CurrentExplorationVersion)){if(t.push({errorType:0}),!r)return}else for(var s=0,l=this.versionUpgraders;s<l.length;s++){var p=l[s],u=p.getVersion();(d.lt(u,"2.2")||d.gt(u,n))&&(i(p,e,n),a&&a.upgraderCount++)}return e},e.prototype.upgradeVisualObjects=function(e,t){t=t||d.ZeroStr;e=e&&e.sections;if(e)for(var r=0,i=e;r<i.length;r++){var a=i[r],a=a&&a.visualContainers;if(!a)return;for(var o=0,n=a;o<n.length;o++){var s,l=n[o],p=l&&l.config&&l.config.singleVisual;p&&(s=p.visualType,(l=p.vcObjects)&&this.objectsUpgrader.upgrade(2,l,s,t),(p=p.objects)&&this.objectsUpgrader.upgrade(1,p,s,t))}}},e.prototype.getVersionedElementConfig=function(e){return _.isString(e.config)&&(e.config=t.tryParseJSON(e.config)),e.config||(e.config={version:d.ZeroStr}),e.config},e);function e(e){this.versionUpgraders=[c.v1_0.createVersionUpgrader(),c.v2_0.createVersionUpgrader(),c.v2_2.createVersionUpgrader(),c.v2_3.createVersionUpgrader(),c.v2_5.createVersionUpgrader(),c.v3_6_1.createVersionUpgrader(),c.v3_12_1.createVersionUpgrader(),c.v3_14.createVersionUpgrader(e),c.v3_14_1.createVersionUpgrader(),c.v3_15.createVersionUpgrader(),c.v3_18.createVersionUpgrader(),c.v3_19.createVersionUpgrader(),c.v3_20.createVersionUpgrader(e),c.v3_24.createVersionUpgrader(),c.v4_1.createVersionUpgrader(),c.v4_2.createVersionUpgrader(),c.v5_1.createVersionUpgrader(),c.v5_3.createVersionUpgrader(),c.v5_9.createVersionUpgrader(e),c.v5_11.createVersionUpgrader(),c.v5_16.createVersionUpgrader(e),c.v5_25.createVersionUpgrader(e),c.v5_28.createVersionUpgrader(),c.v5_31.createVersionUpgrader(e),c.v5_33.createVersionUpgrader(e)],this.objectsUpgrader=c.createVisualObjectsUpgrader(this.versionUpgraders)}c.ExplorationUpgrader=r})((e=(e=e.explore||(e.explore={})).services||(e.services={})).upgrade||(e.upgrade={}))})(powerbi=powerbi||{}),(function(v){var e,f;e=(e=v.explore||(v.explore={})).services||(e.services={}),(function(e){var p=v.data.services.DataViewObjectSerializer,l=v.visuals.GradientUtils,a=jsCommon.JsonExtensions,u=v.visuals.labelStyle,i=v.visuals.plugins,c=v.data.services.SemanticQuerySerializer,d=v.data.SQExprBuilder,o=jsCommon.Version;e.createVersionUpgrader=function(){return new t};var r,t=(n.prototype.upgrade=function(e,t){if(e&&(e.filters=this.upgradeFilterContainers(e.filters),e.sections))for(var r=0,i=e.sections;r<i.length;r++){var a=i[r];if(a.filters=this.upgradeFilterContainers(a.filters),a.visualContainers)for(var o=0,n=a.visualContainers;o<n.length;o++){var s=n[o];s.filters=this.upgradeFilterContainers(s.filters);var l=s.config.singleVisual;l&&(s=l.visualType||l.visualConfig.visualType,l.objects=this.upgradeObjects(l.objects,s,t))}}},n.prototype.upgradeVisualObjects=function(e,t,r,i){},n.prototype.upgradeFilterCollection=function(e){e&&e.filters&&(e.filters=this.upgradeFilterContainers(e.filters))},n.prototype.getVersion=function(){return f.ExplorationVersions.v1_0},n.prototype.upgradeFilterContainers=function(e){if(!_.isEmpty(e)){e=a.tryParseJSON(e);if(e)for(var t=0,r=e;t<r.length;t++){var i=r[t];this.upgradeFilterContainer(i)}return JSON.stringify(e)}},n.prototype.upgradeFilterContainer=function(e){var t;e.expression||!e.field||(t=r.fieldDef(e.field))&&(e.expression=c.serializeExpr(t)),void 0===e.howCreated&&(e.howCreated=e.autoGenerated?0:1)},n.prototype.upgradeObjects=function(e,t,r){switch(this.dropMalformedSelectors(e),t){case i.filledMap.name:return this.upgradeObjectsFilledMap(e);case i.card.name:return this.upgradeObjectsCard(e);case i.donutChart.name:case i.pieChart.name:return r&&o.gt(r,"1.0")?e:this.upgradeObjectsDonutChart(e)}return e},n.prototype.dropMalformedSelectors=function(e){if(e)for(var t in e){var r=e[t];if(r)for(var i=r.length-1;0<=i;i--){var a=r[i].selector;a&&(a.metadata||delete a.metadata,_.isEmpty(Object.keys(a))&&r.splice(i,1))}}},n.prototype.upgradeObjectsFilledMap=function(e){var t,r="dataPoint",i="fillRule",a=(e=e||{})[r];a||(e[r]=a=[]);for(var o=0,n=a;o<n.length;o++){var s=n[o];if(!s.selector){t=s;break}}return t||a.push(t={selector:null,properties:{}}),null==t.properties[i]&&(t.properties[i]=p.serializeObjectProperty(l.getDefaultFillRuleDefinition(),v.visuals.getFilledMapCapabilities().objects[r].properties[i])),e},n.prototype.upgradeObjectsCard=function(e){var t;return!e||(t=e.cardTitle)&&(e.categoryLabels=t,delete e.cardTitle),e},n.prototype.upgradeObjectsDonutChart=function(e){var t="categoryLabels",r="labels",i="labelStyle",a="show";if(e){var o,n=this.getMetadataOnceObjectDefn(e,r),s=this.getPropertyExpr(n,a),l=!!s&&c.deserializeExpr(s).value,s=this.getMetadataOnceObjectDefn(e,t);return s?(a=!!(a=this.getPropertyExpr(s,a))&&c.deserializeExpr(a).value,l&&a?o=u.categoryAndData:l&&!a?o=u.data:!l&&a&&(o=u.category),delete e[t]):n&&n.properties[i]||(o=l?u.categoryAndData:u.category),null!=o&&(t=v.visuals.getDonutChartCapabilities().objects[r].properties,n||((l=e[r])||(e[r]=l=[]),(n=_.find(l,(function(e){return!e.selector})))||l.push(n={properties:{}})),n.properties.show=p.serializeObjectProperty(d.boolean(!0),t.show),n.properties[i]=p.serializeObjectProperty(d.text(o),t[i])),e}},n.prototype.getMetadataOnceObjectDefn=function(e,t){if(e){t=e[t];if(!_.isEmpty(t))return _.find(t,(function(e){return!e.selector}))}},n.prototype.getPropertyExpr=function(e,t){if(e){t=e.properties[t];if(t)return t.expr}},n);function n(){}function s(e){var t=e.column;if(t){e=m(e);if(e)return d.columnRef(e,t)}}function m(e){return d.entity(e.schema,e.entity,e.entityVar)}e.VersionUpgrader=t,(r||(r={})).fieldDef=function(e){return (function(e){var t=e.aggregate;if(void 0!==t){e=s(e)||m(e);if(e)return d.aggregate(e,t)}})(e)||s(e)||(function(e){var t=e.measure;if(t){e=m(e);if(e)return d.measureRef(e,t)}})(e)||m(e)}})((f=e.upgrade||(e.upgrade={})).v1_0||(f.v1_0={}))})(powerbi=powerbi||{}),(function(e){var r;e=(e=e.explore||(e.explore={})).services||(e.services={}),r=e.upgrade||(e.upgrade={}),(function(){(r.v2_0||(r.v2_0={})).createVersionUpgrader=function(){return new e};var e=(t.prototype.upgrade=function(e){if(e&&e.sections)for(var t=0,r=e.sections;t<r.length;t++){var i=r[t];if(i.visualContainers)for(var a=0,o=i.visualContainers;a<o.length;a++){var n=o[a],s=n.config;s.layouts||(n={x:n.x,y:n.y,z:n.z,width:n.width,height:n.height},s.layouts=[{id:0,position:n}])}}},t.prototype.upgradeFilterCollection=function(e){},t.prototype.upgradeVisualObjects=function(e,t,r,i){},t.prototype.getVersion=function(){return r.ExplorationVersions.v2_0},t);function t(){}})()})(powerbi=powerbi||{}),(function(e){var i;e=(e=e.explore||(e.explore={})).services||(e.services={}),(function(e){var a=jsCommon.JsonExtensions;e.createVersionUpgrader=function(){return new t};var t=(r.prototype.upgrade=function(e){},r.prototype.upgradeFilterCollection=function(e){e&&e.filters&&(e.filters=this.upgradeFilterContainers(e.filters))},r.prototype.upgradeFilterContainers=function(e){if(!_.isEmpty(e)){e=a.tryParseJSON(e);if(e)for(var t=0,r=e;t<r.length;t++){var i=r[t];this.upgradeFilterContainer(i)}return JSON.stringify(e)}},r.prototype.upgradeFilterContainer=function(e){2!==e.howCreated||e.precedence||(e.precedence=0)},r.prototype.upgradeVisualObjects=function(e,t,r,i){},r.prototype.getVersion=function(){return i.ExplorationVersions.v2_2},r);function r(){}})((i=e.upgrade||(e.upgrade={})).v2_2||(i.v2_2={}))})(powerbi=powerbi||{}),(function(l){var e,p;e=(e=l.explore||(l.explore={})).services||(e.services={}),(function(e){var i=l.data.DataViewObjectDefinitions,a=l.data.services.DataViewObjectSerializer,r=l.visuals.plugins,o=l.visuals.slicerMode,n=l.data.SQExprBuilder;e.createVersionUpgrader=function(){return new t};var t=(s.prototype.upgrade=function(e){if(e&&e.sections)for(var t=0,r=e.sections;t<r.length;t++){var i=r[t];if(i.visualContainers)for(var a=0,o=i.visualContainers;a<o.length;a++){var n,s=o[a].config.singleVisual;s&&(n=s.visualType||s.visualConfig.visualType,s.objects=this.upgradeObjects(s.objects,n))}}},s.prototype.upgradeFilterCollection=function(e){},s.prototype.upgradeVisualObjects=function(e,t,r,i){},s.prototype.getVersion=function(){return p.ExplorationVersions.v2_3},s.prototype.upgradeObjects=function(e,t){return t===r.slicer.name?this.upgradeSlicerObjects(e):e},s.prototype.upgradeSlicerObjects=function(e){var t=i.ensure(e=e||{},"data",null),r=l.visuals.getSlicerCapabilities().objects.data.properties;return null==t.properties.mode&&(t.properties.mode=a.serializeObjectProperty(n.text(o.basic),r.mode)),e},s);function s(){}e.VersionUpgrader=t})((p=e.upgrade||(e.upgrade={})).v2_3||(p.v2_3={}))})(powerbi=powerbi||{}),(function(a){var e,o;e=(e=a.explore||(a.explore={})).services||(e.services={}),(function(e){var n=a.data.DataViewObjectDefinitions,r=a.visuals.plugins;e.createVersionUpgrader=function(){return new t};var t=(i.prototype.upgrade=function(e){if(e&&e.sections)for(var t=0,r=e.sections;t<r.length;t++){var i=r[t];if(i.visualContainers)for(var a=0,o=i.visualContainers;a<o.length;a++){var n,s=o[a].config.singleVisual;s&&(n=s.visualType||s.visualConfig.visualType,s.objects=this.upgradeObjects(s.objects,n))}}},i.prototype.upgradeFilterCollection=function(e){},i.prototype.upgradeVisualObjects=function(e,t,r,i){},i.prototype.getVersion=function(){return o.ExplorationVersions.v2_5},i.prototype.upgradeObjects=function(e,t){return t===r.gauge.name?this.upgradeGaugeTarget(e):e},i.prototype.upgradeGaugeTarget=function(e){var t=n.getObjectDefinition(e=e||{},"labels",null);if(!t)return e;for(var r=n.ensure(e,"target",null),i=0,a=["show","labelDisplayUnits","labelPrecision","color"];i<a.length;i++){var o=a[i];null!=t.properties[o]&&(r.properties[o]=t.properties[o])}return e},i);function i(){}e.VersionUpgrader=t})((o=e.upgrade||(e.upgrade={})).v2_5||(o.v2_5={}))})(powerbi=powerbi||{}),(function(i){var e,a;e=(e=i.explore||(i.explore={})).services||(e.services={}),(function(e){var l=i.GeoJsonTypes,d=i.visualHost.utils.ResourcePackageUtils,m=i.contracts.ResourcePackageItemType;e.createVersionUpgrader=function(){return new t};var t=(r.prototype.upgrade=function(e){if(e){var t=e.resourcePackages||[],r=_.find(t,(function(e){return 2===e.resourcePackage.type})),i=!r,a=(r=r||{resourcePackage:{id:void 0,items:[],name:d.ensurePackageName(2),type:2}}).resourcePackage.items;if(e.sections)for(var o=0,n=e.sections;o<n.length;o++){var s=n[o];if(s.visualContainers)for(var l=0,p=s.visualContainers;l<p.length;l++){var u=p[l].config.singleVisual;u&&this.upgradeSharedResourcePackages(u.objects,a)}}var c=e.config&&e.config.baseTheme;c&&(_.find(a,(function(e){return e.name===c}))||a.push({name:c,type:m.BaseTheme,path:"BaseThemes/"+c+".json"})),i&&0<r.resourcePackage.items.length&&(t.push(r),e.resourcePackages||(e.resourcePackages=t))}},r.prototype.upgradeFilterCollection=function(){},r.prototype.upgradeVisualObjects=function(e,t,r,i){},r.prototype.getVersion=function(){return a.ExplorationVersions.v3_6_1},r.prototype.upgradeSharedResourcePackages=function(e,i){for(var t in e)for(var r=0,a=e[t];r<a.length;r++){var o,n=a[r],s=this;for(o in n.properties)!(function(e){var t,r=n.properties[e],e=r&&r.geoJson;!e||(r=(r=e.type.expr).Literal&&r.Literal.Value)&&s.removeQuotes(r)===l.shared&&(t=s.removeQuotes(e.name.expr.Literal.Value),_.find(i,(function(e){return e.name===t}))||i.push({name:t,type:m.ShapeMap,path:"Shapemaps/"+t+".json"}))})(o)}},r.prototype.removeQuotes=function(e){return e.substr(1,e.length-2)},r);function r(){}e.VersionUpgrader=t})((a=e.upgrade||(e.upgrade={})).v3_6_1||(a.v3_6_1={}))})(powerbi=powerbi||{}),(function(e){var i;e=(e=e.explore||(e.explore={})).services||(e.services={}),(function(e){var n=jsCommon.JsonExtensions;e.createVersionUpgrader=function(e){return new t(e)};var t=(r.prototype.upgrade=function(e){if(e&&e.sections)for(var t=0,r=e.sections;t<r.length;t++){var i=r[t],a=i.config,o=n.tryParseJSON(i.filters)||[];1===a.type?this.upgradeTooltipPage(o,a):0!==a.type&&null!=a.type||this.upgradeRegularPage(o,a),i.filters=JSON.stringify(o)}},r.prototype.upgradeFilterCollection=function(){},r.prototype.upgradeVisualObjects=function(e,t,r,i){},r.prototype.getVersion=function(){return i.ExplorationVersions.v3_14},r.prototype.upgradeTooltipPageLinkFields=function(e,t){var r=_.map(t.linkFields,(function(e){return{howCreated:5,isTransient:!1,isLinkedAsAggregation:e.asAggregation,expression:e.fieldExpr}}));e.push.apply(e,r||[]),t.linkFields=[]},r.prototype.upgradeTooltipPage=function(e,t){t.acceptsAllFiltersWhenLinked=!0,this.upgradeTooltipPageLinkFields(e,t)},r.prototype.upgradeRegularPage=function(e,t){if(t.acceptsAllFiltersWhenLinked=!1,e)for(var r=0,i=e;r<i.length;r++)i[r].isLinkedAsAggregation=!1},r);function r(e){}e.VersionUpgrader=t})((i=e.upgrade||(e.upgrade={})).v3_14||(i.v3_14={}))})(powerbi=powerbi||{}),(function(e){var i;e=(e=e.explore||(e.explore={})).services||(e.services={}),(function(e){e.createVersionUpgrader=function(){return new t};var t=(r.prototype.upgrade=function(e){if(e&&e.sections)for(var t=0,r=e.sections;t<r.length;t++){var i=r[t];if(i.visualContainers)for(var a=0,o=i.visualContainers;a<o.length;a++){var n=o[a].config.singleVisual;n&&this.upgradeSQExprToInt(n.objects)}}},r.prototype.upgradeFilterCollection=function(){},r.prototype.getVersion=function(){return i.ExplorationVersions.v3_14_1},r.prototype.upgradeVisualObjects=function(e,t,r,i){},r.prototype.upgradeSQExprToInt=function(e){for(var t in e)if("labels"===t||"bubbles"===t||"categoryLabels"===t)for(var r=0,i=e[t];r<i.length;r++){var a,o,n=i[r];for(a in n.properties)"bubbleSize"!==a&&"labelDensity"!==a&&"backgroundTransparency"!==a||(o=(o=n.properties[a])&&o.expr&&o.expr.Literal)&&(o.Value,/^'\d+(\.\d+)?'$/.test(o.Value)&&(o.Value=this.convertLiteralSQTextIntoNumber(o.Value)+"L"))}},r.prototype.convertLiteralSQTextIntoNumber=function(e){return Math.floor(_.parseInt(e.substr(1,e.length-2)))},r);function r(){}e.VersionUpgrader=t})((i=e.upgrade||(e.upgrade={})).v3_14_1||(i.v3_14_1={}))})(powerbi=powerbi||{}),(function(a){var e,o;e=(e=a.explore||(a.explore={})).services||(e.services={}),(function(e){var t=a.data.services.SemanticQuerySerializer,c=a.data.SQExprBuilder;e.createVersionUpgrader=function(){return new r};var r=(i.prototype.upgrade=function(e){if(e&&e.sections)for(var t=0,r=e.sections;t<r.length;t++){var i=r[t];if(i.visualContainers)for(var a=0,o=i.visualContainers;a<o.length;a++){var n,s,l,p,u=o[a].config.singleVisual;u&&(u.vcObjects,n={},u.altText&&(n.general=[{properties:{altText:this.toExpr(c.text(u.altText))}}],delete u.altText),u.aspectRatio&&(s=u.aspectRatio,n.lockAspect=[{properties:{show:null!=s.show?this.toExpr(c.boolean(s.show)):void 0}}],delete u.aspectRatio),u.background&&(s=u.background,n.background=[{properties:{color:null!=s.color?{solid:{color:this.toExpr(c.text(s.color))}}:void 0,show:null!=s.show?this.toExpr(c.boolean(s.show)):void 0,transparency:null!=s.transparency?this.toExpr(c.integer(s.transparency)):void 0}}],delete u.background),u.border&&(l=u.border,n.border=[{properties:{color:null!=l.color?{solid:{color:this.toExpr(c.text(l.color))}}:void 0,show:null!=l.show?this.toExpr(c.boolean(l.show)):void 0}}],delete u.border),u.stylePresetName&&(n.stylePreset=[{properties:{name:this.toExpr(c.text(u.stylePresetName))}}],delete u.stylePresetName),u.title&&((l=u.title).show=null!=l.hidden?!l.hidden:l.show,n.title=[{properties:{alignment:null!=l.alignment?this.toExpr(c.text(l.alignment)):void 0,background:null!=l.background?{solid:{color:this.toExpr(c.text(l.background))}}:void 0,fontColor:null!=l.fontColor?{solid:{color:this.toExpr(c.text(l.fontColor))}}:void 0,fontFamily:null!=l.fontFamily?this.toExpr(c.text(l.fontFamily)):void 0,fontSize:null!=l.fontSize?this.toExpr(c.integer(l.fontSize)):void 0,show:null!=l.show?this.toExpr(c.boolean(l.show)):void 0,text:null!=l.text?this.toExpr(c.text(l.text)):void 0}}],delete u.title),u.visualLink&&(p=u.visualLink,n.visualLink=[{properties:{bookmark:null!=p.bookmark?this.toExpr(c.text(p.bookmark)):void 0,qna:p.qna,show:null!=p.show?this.toExpr(c.boolean(p.show)):void 0,type:null!=p.type?this.toExpr(c.text(p.type)):void 0}}],delete u.visualLink),u.visualTooltip&&(p=u.visualTooltip,n.visualTooltip=[{properties:{section:null!=p.section?this.toExpr(c.text(p.section)):void 0,type:null!=p.type?this.toExpr(c.text(p.type)):void 0}}],delete u.visualTooltip),this.clearUndefinedPropertiesVCObjects(n),_.isEmpty(n)||(u.vcObjects=n))}}},i.prototype.toExpr=function(e){return{expr:t.serializeExpr(e)}},i.prototype.clearUndefinedPropertiesVCObjects=function(e){for(var t in e){var r,i=e[t][0].properties;for(r in i)i[r]||delete i[r];_.isEmpty(i)&&delete e[t]}},i.prototype.upgradeFilterCollection=function(){},i.prototype.upgradeVisualObjects=function(e,t,r,i){},i.prototype.getVersion=function(){return o.ExplorationVersions.v3_15},i);function i(){}e.VersionUpgrader=r})((o=e.upgrade||(e.upgrade={})).v3_15||(o.v3_15={}))})(powerbi=powerbi||{}),(function(a){var e,o;e=(e=a.explore||(a.explore={})).services||(e.services={}),(function(e){var i=a.explore.util.ThemeUtils;e.createVersionUpgrader=function(){return new t};var t=(r.prototype.upgrade=function(e){var t,r;e&&((r=e.config).themeCollection=t={},e.theme&&(t.customTheme=i.getThemeMetadata(e.theme,1,this.getVersion()),delete e.theme),r.baseTheme&&(t.baseTheme=i.getThemeMetadata(r.baseTheme,2,this.getVersion()),delete r.baseTheme))},r.prototype.upgradeFilterCollection=function(){},r.prototype.upgradeVisualObjects=function(e,t,r,i){},r.prototype.getVersion=function(){return o.ExplorationVersions.v3_18},r);function r(){}e.VersionUpgrader=t})((o=e.upgrade||(e.upgrade={})).v3_18||(o.v3_18={}))})(powerbi=powerbi||{}),(function(e){var i;e=(e=e.explore||(e.explore={})).services||(e.services={}),(function(e){var l=jsCommon.JsonExtensions;e.createVersionUpgrader=function(){return new t};var t=(r.prototype.upgrade=function(e){if(e)for(var t=0,r=e.sections;t<r.length;t++)for(var i=0,a=r[t].visualContainers;i<a.length;i++){var o,n=a[i],s=n.config.singleVisual;s&&(o=s.objects,u(s.visualType)&&(p(o),(o=l.tryParseJSON(n.dataTransforms))&&(p(o.objects),n.dataTransforms=JSON.stringify(o))))}},r.prototype.upgradeFilterCollection=function(){},r.prototype.upgradeVisualObjects=function(e,t,r,i){},r.prototype.getVersion=function(){return i.ExplorationVersions.v3_19},r);function r(){}function p(e){var t="defaultCategoryColor";if(e&&e.dataPoint)for(var r=0,i=e.dataPoint;r<i.length;r++){var a=i[r];null==a.selector&&a.properties[t]&&(a.properties.fill=a.properties[t],delete a.properties[t])}}function u(e){return _.includes(i.DefaultCategoryColorVisualsToUpgrade,e)}e.VersionUpgrader=t,e.upgradeDefaultCategoryColorToFill=p,e.needsToUpgradeDefaultCategoryColor=u})((i=e.upgrade||(e.upgrade={})).v3_19||(i.v3_19={}))})(powerbi=powerbi||{}),(function(e){var n;e=(e=e.explore||(e.explore={})).services||(e.services={}),(function(e){e.createVersionUpgrader=function(){return new t};var t=(r.prototype.upgrade=function(e){if(e&&!_.isEmpty(e.sections))for(var t=0,r=e.sections;t<r.length;t++)for(var i=0,a=r[t].visualContainers;i<a.length;i++){var o=a[i],o=o.config&&o.config.singleVisual;n.UpgradeUtils.updateSingleVisualConfigPxToPt(o)}},r.prototype.upgradeFilterCollection=function(){},r.prototype.upgradeVisualObjects=function(e,t,r,i){},r.prototype.getVersion=function(){return n.ExplorationVersions.v4_2},r);function r(){}e.VersionUpgrader=t})((n=e.upgrade||(e.upgrade={})).v4_2||(n.v4_2={}))})(powerbi=powerbi||{}),(function(r){var e,n;e=(e=r.explore||(r.explore={})).services||(e.services={}),(function(a){var o=r.data.services.SemanticQuerySerializer;a.createVersionUpgrader=function(){return new e};var e=(t.prototype.upgrade=function(e){if(e&&!_.isEmpty(e.sections))for(var t=0,r=e.sections;t<r.length;t++){var i=r[t];!(function(e){if(e&&e.config&&e.config.objects)for(var t=0,r=a.outspacePanePropertiesToUpdate;t<r.length;t++){var i=r[t];n.UpgradeUtils.upgradePropertyFromPxToPt(e.config.objects,i)}})(i),(function(e){if(e&&e.config&&e.config.objects&&e.config.objects.filterCard)for(var e=e.config.objects.filterCard,t=0,r=e;t<r.length;t++){var i=r[t],a=i&&i.properties;!a||(i=a.textSize)&&(i=o.deserializeExpr(i.expr),a.textSize=n.UpgradeUtils.toExpr(n.UpgradeUtils.pxToPtExpr(i)))}})(i)}},t.prototype.upgradeFilterCollection=function(){},t.prototype.upgradeVisualObjects=function(e,t,r,i){},t.prototype.getVersion=function(){return n.ExplorationVersions.v5_1},t);function t(){}a.VersionUpgrader=e,a.outspacePanePropertiesToUpdate=[{objectName:"outspacePane",propertyName:"titleSize"},{objectName:"outspacePane",propertyName:"headerSize"}]})((n=e.upgrade||(e.upgrade={})).v5_1||(n.v5_1={}))})(powerbi=powerbi||{}),(function(e){var n;e=(e=e.explore||(e.explore={})).services||(e.services={}),(function(e){e.createVersionUpgrader=function(){return new t};var t=(r.prototype.upgrade=function(e){if(e&&!_.isEmpty(e.sections))for(var t=0,r=e.sections;t<r.length;t++)for(var i=0,a=r[t].visualContainers;i<a.length;i++){var o=a[i],o=o.config&&o.config.singleVisual;n.UpgradeUtils.updateSingleVisualConfigTextboxPxToPt(o)}},r.prototype.upgradeFilterCollection=function(){},r.prototype.upgradeVisualObjects=function(e,t,r,i){},r.prototype.getVersion=function(){return n.ExplorationVersions.v5_3},r);function r(){}e.VersionUpgrader=t})((n=e.upgrade||(e.upgrade={})).v5_3||(n.v5_3={}))})(powerbi=powerbi||{}),(function(e){var t,r;t=e.explore||(e.explore={}),e=(e=t.services||(t.services={})).UtteranceDefinitionSerializer||(e.UtteranceDefinitionSerializer={}),r=t.services.upgrade.UtteranceDefinitionVersions,e.serialize=function(e){return{Version:r.v1_0,Utterance:e.utterance}},e.deserialize=function(e){return{utterance:e.Utterance}}})(powerbi=powerbi||{}),(function(e){var t,r,a,o,n;t=e.explore||(e.explore={}),r=t.services||(t.services={}),o=e.data.FieldExprPattern,n=e.data.SQExprConverter,(t=r.schemaItemActivationUtils||(r.schemaItemActivationUtils={})).setActiveSchemaItem=function(e,t,r){var i=n.asFieldPattern(t,r),r=(t=o.toFieldExprEntityItemPattern(i)).schema,t=t.entity,i=a.createActiveSchemaItem(r,t,i);e.setActiveItem(i)},t.trackItemThroughModelChange=function(e,t,r){if(e){for(var i=0,a=t.changes;i<a.length;i++){var o=a[i];if(o.itemDelete&&o.itemDelete.entity===e.entity&&(!o.itemDelete.property||e.property&&e.property===o.itemDelete.property||e.hierarchy&&e.hierarchy===o.itemDelete.property))return;o.entityRename&&e.entity===o.entityRename.before?e=__assign(__assign({},e),{entity:o.entityRename.after}):o.propertyRename&&e.entity===o.propertyRename.entity?((e=e.property&&e.property===o.propertyRename.before?__assign(__assign({},e),{property:o.propertyRename.after}):e).hierarchy||e.hierarchyLevel)&&e.hierarchy===o.propertyRename.before&&"Hierarchy"===o.propertyRename.objectType&&(e=__assign(__assign({},e),{hierarchy:o.propertyRename.after})):o.hierarchyLevelRename&&e.entity===o.hierarchyLevelRename.entity&&e.hierarchy===o.hierarchyLevelRename.hierarchy&&e.hierarchyLevel===o.hierarchyLevelRename.before?e=__assign(__assign({},e),{hierarchyLevel:o.hierarchyLevelRename.after}):o.measureMove&&e.entity===o.measureMove.source&&e.property===o.measureMove.property&&(e=__assign(__assign({},e),{entity:o.measureMove.destination}))}t=r.schema(e.schema);if(t){r=t.entities.withName(e.entity);if(r)return e.property?t.findProperty(e.entity,e.property)&&e:e.hierarchyLevel?t.findHierarchyLevel(e.entity,e.hierarchy,e.hierarchyLevel)&&e:(!e.hierarchy||t.findHierarchy(e.entity,e.hierarchy))&&e}}},(a=r.ActiveSchemaItemFactory||(r.ActiveSchemaItemFactory={})).createActiveSchemaItem=function(e,t,r){return{schema:e,entity:t,property:o.getPropertyName(r),hierarchy:o.getHierarchyName(r)||r.hierarchyLevel&&r.hierarchyLevel.name,hierarchyLevel:r.hierarchyLevel&&r.hierarchyLevel.level}}})(powerbi=powerbi||{}),(function(e){var p;(function(e){var a,t,i=p.util.VisualContainerUtils,r=p.contracts.isVisualContainer;function o(e,t,r){e=_.map(e,(function(e){return a.createSelectableCanvasItem(e)}));t.selectElements(e,0,r)}function n(e){return _.chain(e.getSelectedElements()).map((function(e){return e.canvasItem})).compact().value()}(t=e.selectionUtils||(e.selectionUtils={})).selectCanvasItem=function(e,t,r,i){void 0===r&&(r=0),e=a.createSelectableCanvasItem(e),t.selectElement(e,r,i)},t.unselectCanvasItem=function(e,t){var r=n(t);_.includes(r,e)&&o(_.without(r,e),t)},t.selectSubSelection=function(e,t,r,i){r=a.createSubSelectableCanvasItem(t,r),e.selectElement(r,i)},t.selectCanvasItems=o,t.isCanvasItemSelected=function(e,t){return t=n(t),_.includes(t,e)},t.getSelectedCanvasItem=function(e){return _.first(n(e))},t.getSelectedCanvasItems=n,t.getSelectedVisualContainers=function(e){return _.chain(e.getSelectedElements()).filter((function(e){return p.contracts.isVisualContainer(e.canvasItem)})).map((function(e){return e.canvasItem})).compact().value()},t.hasMultipleVisualContainerSelection=function(e){return 1<n(e).length},t.getSelectedVisual=function(e){if(1===(e=n(e)).length){e=e[0];return r(e)?e:void 0}},t.getDefaultSelectedVisualInSingleOrMultiCase=function(e){var t=n(e);if(e=t[0]){var r=i.getVisualType(e);return _.every(t,(function(e){return i.getVisualType(e)===r}))?e:void 0}},(t=a=e.SelectableItemFactory||(e.SelectableItemFactory={})).createSelectableCanvasItem=function(e){return s.createFromCanvasItem(e)},t.createSubSelectableCanvasItem=function(e,t){return s.createFromSubSelections(e,t)},(e.SelectableUtils||(e.SelectableUtils={})).equals=function(e,t){if(e.length!==t.length)return!1;for(var r=0,i=e.length;r<i;r++)if(!s.equals(e[r],t[r]))return!1;return!0};var s=(Object.defineProperty(l.prototype,"id",{get:function(){if(this._canvasItem)return this._canvasItem.id},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"canvasItem",{get:function(){return this._canvasItem},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"subSelections",{get:function(){return this._subSelections},enumerable:!1,configurable:!0}),l.createFromCanvasItem=function(e){var t=new l;return t._canvasItem=e,t},l.createFromSubSelections=function(e,t){e=l.createFromCanvasItem(e);return e._subSelections=t,e},l.equals=function(e,t){return(e=e||null)===(t=t||null)||!e==!t&&!(e.id!==t.id||e.canvasItem!==t.canvasItem||!_.isEqual(e.subSelections,t.subSelections))},l);function l(){}e.SelectableItem=s})((p=e.explore||(e.explore={})).services||(p.services={}))})(powerbi=powerbi||{}),(function(r){var e;(function(e){var i=r.explore.util.ScriptVisualsUtil,a=r.explore.util.VisualContainerUtils;e.createScriptVisualsService=function(e,t,r,i,a,o){return new n(e,t,r,i,a,o)};var n=(t.prototype.addScriptVisualInfo=function(e,t){var r=a.getVisualType(e);this.services.visualPlugin.isScriptVisual(r)&&e.id&&(r={id:e.id,scriptType:i.getScriptVisualType(r)},t.push(r))},t.prototype.showEnableScriptVisualDialogIfRequiredAsync=function(e,t,r){return null},t.prototype.getScriptVisualErrorDetails=function(e,t){var r,i=this.services.localizationService,a=this.services.featureSwitchService.featureSwitches;if(0===e&&!a.scriptVisualEnabled)r=this.buildErrorDetails(i.get(this.getLocalizationKey("Error_VisualsNotSupported",e)));else{if(this.services.embedModeService&&this.services.embedModeService.isAnonymousLiveEmbed())return r=!a.scriptVisualAnonymousEmbeddingEnabled?this.buildErrorDetails(i.get(this.getLocalizationKey("Error_VisualsNotSupportedInEmbedReports",e))):r;var o,n=this.getUserInfoForErrorDetails();n&&n.isViralTenant?r=this.buildErrorDetails(i.get(this.getLocalizationKey("Error_VisualsNotSupportedForViralTenant",e))):!1===a.rScriptVisualEnabled?r=this.buildErrorDetails(i.get(this.getLocalizationKey("Error_VisualsDisabledByAdmin",e))):(o=!1,a=this.services.embedModeService&&this.services.embedModeService.isReportEmbedScenario(),!this.services.licenseServiceExtend||Array.isArray(this.services.licenseServiceExtend)||a||(o=t&&this.services.licenseServiceExtend.isReportInPremiumCapacity(t)),n&&!1===n.isPremiumUser&&!o?r=this.buildErrorDetails(i.get(this.getLocalizationKey("Error_VisualsIsProFeature",e))):n&&void 0===n.isPremiumUser&&void 0===n.isViralTenant&&void 0===t&&(r=this.buildErrorDetails(i.get(this.getLocalizationKey("Error_VisualsNotSupportedWithThisOperation",e)))))}return r},t.prototype.overrideEmbeddedErrorDetails=function(e,t){var r=this.services.embedModeService&&(this.services.embedModeService.isAppTokenEmbed()||this.services.embedModeService.isSaasOrPaasEmbed()||this.services.embedModeService.isSecurePublishToWeb()),i=this.services&&this.services.localizationService;if(r&&t){t=t;return t.helpLink="",t.message=i.get(this.getLocalizationKey("Error_VisualsEmbeddedText",e)),t.displayableErrorInfo=[{errorInfoKey:i.get(this.getLocalizationKey("Error_VisualsEmbeddedText",e)),errorInfoValue:i.get(this.getLocalizationKey("Error_VisualsErrorInEmbedReports",e))}],t}},t.prototype.getLocalizationKey=function(e,t){var r;switch(t){case 0:r="R";break;case 1:r="Py";break;default:r=""}return r+e},t.prototype.shouldBlockScriptVisual=function(e,t){var r=this.services.featureSwitchService.featureSwitches,i=this.getUserInfoForErrorDetails(),a=this.services.embedModeService&&this.services.embedModeService.isAnonymousLiveEmbed(),o=this.services.embedModeService&&this.services.embedModeService.isReportEmbedScenario();switch(e){case 0:if(a)return!r.scriptVisualAnonymousEmbeddingEnabled||!r.scriptVisualEnabled;var n=!1;return(n=this.services.licenseServiceExtend&&!Array.isArray(this.services.licenseServiceExtend)&&!o?t&&this.services.licenseServiceExtend.isReportInPremiumCapacity(t):n)?!1:!r.scriptVisualEnabled||i&&i.isViralTenant||!r.rScriptVisualEnabled||i&&!i.isPremiumUser;case 1:return a?!r.scriptVisualAnonymousEmbeddingEnabled:!(n=!this.services.licenseServiceExtend||Array.isArray(this.services.licenseServiceExtend)||o?n:t&&this.services.licenseServiceExtend.isReportInPremiumCapacity(t))&&(i&&i.isViralTenant||i&&!i.isPremiumUser)}},t.prototype.canLaunchExternalIDE=function(){return!1},t.prototype.launchExternalIDE=function(e){return null},t.prototype.openOptionsDialogAsync=function(){return null},t.prototype.refreshScriptCustomVisuals=function(e){},t.prototype.triggerDataRefresh=function(){var e="Visual_Error_RefreshFailed",t=this.services.localizationService.get(e),r=this.services.localizationService.get("Visual_Warning_AutoRefreshNotSupported");return{message:r,displayableErrorInfo:[{errorInfoKey:t,errorInfoValue:r}],helpLink:"https://go.microsoft.com/fwlink/?linkid=2188979",helpLinkType:1,hideDebugInfo:!0,resourceKey:e}},t.prototype.buildErrorDetails=function(e){return{message:e,displayableErrorInfo:[],helpLink:"https://go.microsoft.com/fwlink/?linkid=829101",errorType:1}},t.prototype.getUserInfoForErrorDetails=function(){var e=this.services.userInfo,t=this.services.embedModeService&&this.services.embedModeService.isReportEmbedScenario();if(e&&!Array.isArray(e)&&!t)return{isViralTenant:e.userMetadata&&e.userMetadata.tenantMetadata&&0===e.userMetadata.tenantMetadata.tenantType,isPremiumUser:e.isPremiumUser}},t);function t(e,t,r,i,a,o){this.services={visualPlugin:e,featureSwitchService:t,localizationService:r,userInfo:i,embedModeService:a,licenseServiceExtend:o}}})((e=r.explore||(r.explore={})).services||(e.services={}))})(powerbi=powerbi||{}),(function(e){(function(e){function t(){}e=e.undoRedoStrategy||(e.undoRedoStrategy={}),t.prototype.register=function(e,t,r){t=t();return{actionResult:t,succeeded:!(_.isBoolean(t)&&!t)}},t.prototype.getTopUndoFrame=function(){},t.prototype.canRedo=function(){return!1},t.prototype.canUndo=function(){return!1},t.prototype.canClear=function(){return!1},t.prototype.undo=function(){return!1},t.prototype.redo=function(){return!1},t.prototype.clear=function(){return!1},t.prototype.getReferences=function(){return{}},e.UndoRedoNoOp=t})((e=e.explore||(e.explore={})).services||(e.services={}))})(powerbi=powerbi||{}),(function(e){(function(i){var e=(t.prototype.equals=function(e){return!!e&&this.action===e.action&&this.visualContainerName===e.visualContainerName},t);function t(e,t){this.visualContainerName=e,this.action=t}i.ActionIdentifier=e,i.createUndoRedoService=function(e,t,r){return void 0===r&&(r=new i.undoRedoStrategy.UndoRedoNoOp),new a(e,t,r)};var a=(r.prototype.setStrategy=function(e){this.clear(),this.strategy=e},r.prototype.undo=function(){var e=this;this.verifyStrategy()&&this.canUndo()&&setTimeout((function(){e.strategy&&e.strategy.undo()&&(e.runSideEffects(),e.fireEvents())}))},r.prototype.redo=function(){var e=this;this.verifyStrategy()&&this.canRedo()&&setTimeout((function(){e.strategy&&e.strategy.redo()&&(e.runSideEffects(),e.fireEvents())}))},r.prototype.registerSideEffect=function(e){this.sideEffects||(this.sideEffects=[]),this.sideEffects.push(e)},r.prototype.clear=function(){this.verifyStrategy()&&(this.strategy.canClear()&&this.strategy.clear(),this.eventBridge.publishToChannel(i.events.undoRedoStackUpdated))},r.prototype.canRedo=function(){return this.verifyStrategy()&&this.strategy.canRedo()},r.prototype.canUndo=function(){return this.verifyStrategy()&&this.strategy.canUndo()},r.prototype.getTopUndoFrame=function(){return this.verifyStrategy()&&this.strategy.getTopUndoFrame()},r.prototype.undoRedoPostProcessing=function(e){this.loggerService.addUserAction({message:e,type:"UndoRedo"}),setTimeout(_.noop)},r.prototype.register=function(e,t,r){var i;return(this.verifyStrategy()?(i=(r=this.strategy.register(e,t,r)).actionResult,r.succeeded):(i=t(),!(_.isBoolean(i)&&!i)))&&(this.runSideEffects(e),this.fireEvents()),this.undoRedoPostProcessing(e),i},r.prototype.fireEvents=function(){this.eventBridge.publishToChannel(i.events.onReportChanged,{explorationContentChanged:!0}),this.eventBridge.publishToChannel(i.events.undoRedoStackUpdated)},r.prototype.runSideEffects=function(e){if(!_.isEmpty(this.sideEffects))for(var t=0,r=this.sideEffects;t<r.length;t++)r[t].run(e)},r.prototype.verifyStrategy=function(){return this.strategy,!!this.strategy},r);function r(e,t,r){this.eventBridge=e,this.loggerService=t,this.strategy=r}})((e=e.explore||(e.explore={})).services||(e.services={}))})(powerbi=powerbi||{}),(function(p){var e;(function(e){var i=jsCommon.CircularStack,a=p.telemetry.EXUndoEventTime,t=(r.prototype.register=function(e,t,r){var i=this,a=this.withTelemetry((function(){return i.captureUndoFrame(i.handler)}),"Capture",e);a.recurringActionInfo=r;e=this.canMergeWithTopFrame(r),r=this.startTransaction(a),a=t();this.isIPromise(a);t=!(_.isBoolean(a)&&!a);return t?this.endTransaction(r,e):this.cancelTransaction(r),{succeeded:t,actionResult:a}},r.prototype.getReferences=function(){return this.addStackReferences(this.undoStack,this.addStackReferences(this.redoStack))},r.prototype.addStackReferences=function(e,t){t=t||{};for(var r=e.length;0<r--;)_.merge(t,e.item(r).getReferences());return t},r.prototype.undo=function(){var e=this,t=!1;return t=this.canUndo()?this.withTelemetry((function(){return e.rollbackTop(e.undoStack,e.redoStack)}),"Undo",""):t},r.prototype.redo=function(){var e=this,t=!1;return t=this.canRedo()?this.withTelemetry((function(){return e.rollbackTop(e.redoStack,e.undoStack)}),"Redo",""):t},r.prototype.clear=function(){return this.undoStack.clear(),this.redoStack.clear(),!0},r.prototype.canRedo=function(){return 0<this.redoStack.length},r.prototype.canUndo=function(){return 0<this.undoStack.length},r.prototype.canClear=function(){return!0},r.prototype.getTopUndoFrame=function(){var e=this.undoStack.peek();return e?e.getFrame():void 0},r.prototype.withTelemetry=function(e,t,r){t=this.telemetry.startEvent(a,{description:r,event:t}),e=e();return t.resolve(),e},r.prototype.canMergeWithTopFrame=function(e){if(!e)return!1;if(this.canUndo()){var t=this.getTopUndoFrame();if(t&&void 0!==t.recurringActionInfo&&t.recurringActionInfo.equals(e))return!0}return!1},r.prototype.rollbackTop=function(e,t){var r=e.pop();if(r){e=r.rollbackFrame(),r=this.validTransactionCheck(e);return r&&t.push(e),r}},r.prototype.isIPromise=function(e){return e&&e.finally},r.prototype.startTransaction=function(e){var t=new s;return this.currentTransaction||(this.currentTransaction=t,this.currentTransaction.addUndoFrame(e)),this.currentTransaction},r.prototype.endTransaction=function(e,t){this.currentTransaction,t||(this.redoStack.clear(),this.validTransactionCheck(this.currentTransaction)&&this.undoStack.push(this.currentTransaction)),this.currentTransaction=void 0},r.prototype.cancelTransaction=function(e){this.currentTransaction,this.currentTransaction=void 0},r.prototype.captureUndoFrame=function(e){return new o(e)},r.prototype.validTransactionCheck=function(e){return!!e},r);function r(e,t,r){this.handler=e,this.staticResourceReferences=t,this.telemetry=r,this.undoStack=new i(30),this.redoStack=new i(30),this.staticResourceReferences.addReferenceSource(this)}e.UndoRedoStack=t;var o=(n.prototype.rollbackFrame=function(){var e=new n(this.handler,this.snapshot);return this.handler.rollback(this.snapshot),e},n.prototype.getReferences=function(){return this.snapshot.getReferences&&this.snapshot.getReferences()},n);function n(e,t){this.handler=e,this.snapshot=this.handler.takeSnapshot(t)}var s=(l.prototype.addUndoFrame=function(e){this.frames.push(e)},l.prototype.rollbackFrame=function(){return new l(_.map(this.frames,(function(e){if(e)return e.rollbackFrame()})))},l.prototype.getFrame=function(){return this.frames.length,this.frames[0]},l.prototype.getReferences=function(){for(var e={},t=0,r=this.frames;t<r.length;t++){var i=r[t];_.merge(e,i.getReferences())}return e},l);function l(e){this.frames=e||[]}})((e=(e=p.explore||(p.explore={})).services||(e.services={})).undoRedoStrategy||(e.undoRedoStrategy={}))})(powerbi=powerbi||{}),(powerbi||(powerbi={})).columnPropertiesAuthoringModuleFactory=function(){return{getColumnPropertiesForExprs:function(e,t){var r=[];if(t.columnProperties)for(var i=0,a=e;i<a.length;i++){var o=a[i],n=t.query.defn.selectNameOf(o),n=t.columnProperties[n];n&&r.push({originalExpr:o,columnProperty:n})}return r},applyColumnPropertiesByExpr:function(t,e,r,i){(i=_.find(i,(function(e){return e.originalExpr===t})))&&(e=r.query.defn.selectNameOf(e),r.columnProperties[e]||(r.columnProperties[e]=i.columnProperty))}}},(function(k){var M;(function(e){var D=jsCommon.ArrayExtensions,S=k.data.DataViewObjectDefinition,E=k.data.DataViewObjectDefinitions,m=k.data.DataViewObjectDescriptors,d=k.data.DataViewRoleWildcard,N=k.explore.util.DrillUtils,i=k.data.FieldExprPattern,t=k.visuals.GradientUtils,b=M.util.HierarchyUtils,V=jsCommon.JsonComparer,o=k.data.QueryProjectionCollection,P=k.data.QueryProjectionsByRole,f=k.data.ScopeIdentityExtractor,v=k.data.Selector,g=k.data.dsr.SelectToIdentityExpressionsVisitor,h=k.data.SemanticFilter,n=k.data.SemanticQuery,w=M.contracts.SingleVisualConfig,s=k.visuals.SmallMultiplesUtils,A=k.data.SQExpr,y=k.data.SQExprBuilder,l=k.data.SQExprConverter,T=k.explore.utils.SQExprToRoleDictionary,F=k.data.SQExprUtils,j=k.data.SQHierarchyExprUtils,C=k.explore.util.VisualContainerUtils,R=M.contracts.VisualQuery;function a(e){return void 0!==e.expr}function p(e){return void 0!==e.role}function u(e,t,r){if(e.name!==k.visuals.cartesianRoleNames.rows)return!0;if(!s.supportsSmallMultiplesDataViewMapping(null==r?void 0:r.dataViewMappings))return!0;r=t.query;if(!r||!r.defn)return!1;e=k.data.QueryProjectionsByRole.getRole(r.projections,e.name);return!!e&&0<_.size(e.all())||t.hasUsedSmallMultiples}function I(e,t,r){var i,a=e.properties[t];return r&&r[e.objectName]&&r[e.objectName].properties[t]&&(i=r[e.objectName].properties[t].type),E.encodePropertyValue(a,i||{})}e.createVisualAuthoringCore=function(e,t,r,i,a){return new c(e,t,r,i,a)},e.isRemoveExpressionOptions=a,e.isRemoveFieldOptions=p,e.applyPropertyChanges=function(e,t,r,a){if(!e)return!1;var i=!1;function o(e,t,r,i){a&&a(e.objectName,e.selector,t,r,i,i&&e.properties&&e.properties[t])}if(e.replace)for(var n=0,s=e.replace;n<s.length;n++){var l=s[n],p=E.ensure(r,l.objectName,l.selector),u={};for(C in l.properties)S.isValidPropertyName(C)&&(u[C]=I(l,C,t));var c=p.properties;if(!E.allPropertiesAreEqual(c,u)){for(var i=!0,d=0,m=E.getUnequalProperties(c,u);d<m.length;d++)o(l,C=m[d],c[C],u[C]);p.properties=u}}if(e.merge)for(var v=0,f=e.merge;v<f.length;v++){var g,l=f[v],p=E.ensure(r,l.objectName,l.selector);for(C in l.properties)S.isValidPropertyName(C)&&(g=I(l,C,t),E.propertiesAreEqual(p.properties[C],g)||(i=!0,o(l,C,p.properties[C],g),p.properties[C]=g))}if(e.remove)for(var h=0,y=e.remove;h<y.length;h++){l=y[h];if(p=E.getObjectDefinition(r,l.objectName,l.selector))for(var C in l.properties)S.isValidPropertyName(C)&&p.properties.hasOwnProperty(C)&&(i=!0,o(l,C,p.properties[C],void 0),delete p.properties[C])}if(e.removeObject)for(var x=0,b=e.removeObject;x<b.length;x++){l=b[x];if(p=E.getObjectDefinition(r,l.objectName,l.selector)){if(a)for(var C in p.properties)o(l,C,p.properties[C],void 0);i=E.deleteObjectDefinition(r,l.objectName,l.selector)||i}}return i},e.isRoleAllowedForSmallMultiples=u;var c=(O.prototype.create=function(e){var t=this.visualPluginService.capabilities(e.visualType),r=k.visualCapabilitiesHelperModuleFactory().create(t,this.geoTaggingService);if(r){var i,a=e.query||new R(n.create(),{},[]),o={visualType:e.visualType,query:a};for(i in e.autoSelectVisualType&&(o.autoSelectVisualType=!0),this.visualAuthoringCustomizeOperations.customizeOptions(o,e.schema),o.query.projections)this.ensureDependentObjectDefn(r.objectDescs,i,o);a=e.expr,t=!e.inFilterVisualContainer&&a&&!_.isArray(a)&&F.shouldUseAsFieldParameter(this.featureSwitchService.featureSwitches.fieldParametersAuthoring,e.schema,e.expr,this.featureSwitchService.featureSwitches.fieldParameterDynamicSlicer||!M.FilterUtils.supportsFilterOutput(t),this.visualPluginOps.isAnalysisVisual(e.visualType));if(_.isEmpty(a)||this.tryAdd(r,o,t,e))return{singleVisual:o}}},O.prototype.add=function(e,t,r){var i=t.singleVisual;if(!i)return!1;t=this.visualPluginService.capabilities(i.visualType),t=k.visualCapabilitiesHelperModuleFactory().create(t,this.geoTaggingService);return!!t&&(i.query||(i.query=new R(n.create(),{},[])),!!this.tryAdd(t,i,r,e)&&(this.visualAuthoringCustomizeOperations.customizeOptions(i,e.schema),O.clearConversionSourceContext(i),!0))},O.prototype.remove=function(e,t,r){t=t.singleVisual;return!!t&&(!!this.tryRemove(t.query,t.columnProperties,e,r)&&(O.clearConversionSourceContext(t),!0))},O.prototype.removeAllParametersAndProjectionsFromRole=function(e,t,r,i,a){var o=t&&t.config;if(o){var n=o&&o.singleVisual&&o.singleVisual.query;if(n){var s=n.getQueryFieldParametersByRole(e);if(s&&0<s.length){for(var n={},l=n[e]=[],p=0,u=s;p<u.length;p++){var c=u[p];l.push({parameter:c,result:[]})}this.resolveParameters(r,t,n,i,a,void 0);for(var d=s.length-1;0<=d;d--){c=s[d];this.remove({count:void 0,projOptions:{parameter:c},role:e,shouldRemoveParameter:!0},o,r)}}}}},O.prototype.move=function(e,t){var r;_.isNumber(e.sourceIndex)&&_.isNumber(e.targetIndex)&&0<=e.targetIndex&&e.sourceIndex,_.isNumber(e.sourceCount)&&e.sourceCount;var i=t.singleVisual;if(!i)return!1;if(e.sourceRole===e.targetRole&&!e.replacementExpressions)return!!i.query.moveProjection(e.targetRole,e.sourceIndex,e.targetIndex,e.sourceCount)&&(O.clearConversionSourceContext(i),!0);var a=[];if(!(null===(r=i.query)||void 0===r?void 0:r.getParameterByFieldIndex(e.sourceIndex,e.sourceRole)))for(var o=0;o<e.sourceCount;o++)if(a[o]=i.query.tryGetExpr(e.sourceRole,e.sourceIndex+o),!a[o])return!1;return this.moveProjectionCore(t,a,e)},O.prototype.convert=function(e){var t=e.source;if(!t)return!1;var r=(r=t.conversionSourceContext)||(t.conversionSourceContext=this.createConversionSourceContext(t.query,t.visualType,t.syncGroup)),i=this.visualPluginService.capabilities(r.visualType),a=this.visualPluginService.capabilities(e.target);if(!i||!a||_.isEmpty(a.dataRoles))return!1;if(V.equals(i,a)){var o=this.visualPluginService.capabilities(t.visualType);return this.convertRoleWildCardProperties(o,a,t.objects),t.query=r.query,t.visualType=e.target,t.visualType===e.target&&a.supportsSynchronizingFilterState&&(t.syncGroup=r.syncGroup),!0}var n=e.schema,s=this.convertDrillableRoles(r.query,i,a,e.target,n),l=s.query,p=N.getDrillableRoles(a),u=this.getUniqueQueryFields(r.query,a,e.target),u=_.differenceWith(u,s.convertedFields,R.isEqualQueryFields),c=k.visualCapabilitiesHelperModuleFactory().create(a,this.geoTaggingService),o=k.visualCapabilitiesHelperModuleFactory().create(i,this.geoTaggingService);c.orderByRolePreferences(n,u);s=P.clone(l.projections),u=this.getExpressionRoleMappings(t.query,u),s=this.getConversionExprRoleList(u,o,c,n,e.target,t,s,p);if(_.isEmpty(s)&&_.isEmpty(l.projections))return!1;for(var d=0,m=s;d<m.length;d++){var v=m[d];v.isFieldParameter?l.addParameter(v.expr,v.roleName):l.add(v.expr,v.roleName),this.ensureDependentObjectDefn(c.objectDescs,v.roleName,t)}var f,s=N.getDrillableRoles(this.visualPluginService.capabilities(t.visualType)),g=_.isEmpty(s)?(f=N.getDrillableRoles(i),r.query):(f=s,t.query);if(!_.isEmpty(p))for(var h=0,y=p;h<y.length;h++){var C=y[h];if(l.projections[C]&&(l.ensureActiveItems(C),!_.isEmpty(f)))for(var x=0,b=f;x<b.length;x++){var S=b[x];g.projections[S]&&(l.projections[C].activeProjectionRefs=g.projections[S].activeProjectionRefs)}}return this.updateTargetShowAllInfo(r,l,c),l.removeUnusedOrderBy(),l.resetExpansionStates(),this.convertRoleWildCardProperties(i,a,t.objects),this.upgradePivotTableProperties(t.objects,t.visualType,e.target),t.query=l,t.visualType=e.target,this.visualAuthoringCustomizeOperations.customizeOptions(t,n),!0},O.prototype.convertRoleWildCardProperties=function(e,t,r){if(!_.isEmpty(r)){var i=_.chain(e.dataRoles).filter((function(e){return e.kind!==k.VisualDataRoleKind.Measure})).map((function(e){return e.name})).value(),a=_.chain(t.dataRoles).filter((function(e){return e.kind!==k.VisualDataRoleKind.Measure})).map((function(e){return e.name})).value();if(!_.isEmpty(i)&&!_.isEmpty(a))for(var o in r){o=r[o];if(!_.isEmpty(o))for(var n=0,s=o;n<s.length;n++){var l=s[n].selector;if(l&&!_.isEmpty(l.data))for(var p=0,u=l.data.length;p<u;p++){var c=l.data[p];v.isRoleWildcard(c)&&_.isEqual(_.sortBy(c.roles),_.sortBy(i))&&(l.data[p]=d.fromRoles(a))}}}}},O.prototype.upgradePivotTableProperties=function(e,t,r){"matrix"!==t&&"table"!==t||"pivotTable"!==r&&"tableEx"!==r||(E.moveProperty(e,"general",void 0,"textSize","grid"),E.moveProperty(e,"general",void 0,"autoSizeColumnWidth","columnHeaders")),"matrix"===t&&"pivotTable"===r&&(E.moveProperty(e,"general",void 0,"columnSubtotals","subTotals"),E.moveProperty(e,"general",void 0,"rowSubtotals","subTotals")),"table"===t&&"tableEx"===r&&E.moveProperty(e,"general",void 0,"totals","total")},O.prototype.setAggregate=function(e,t){return!!t.singleVisual.query.setAggregate(e.role,e.index,e.newAggregate)&&(O.clearConversionSourceContext(t.singleVisual),!0)},O.prototype.removeAggregate=function(e,t){return!!t.singleVisual.query.removeAggregate(e.role,e.index)&&(O.clearConversionSourceContext(t.singleVisual),!0)},O.prototype.setPercentOfGrandTotal=function(e,t){return!!t.singleVisual.query.setPercentOfGrandTotal(e.role,e.index)&&(O.clearConversionSourceContext(t.singleVisual),!0)},O.prototype.removePercentOfGrandTotal=function(e,t){return!!t.singleVisual.query.removePercentOfGrandTotal(e.role,e.index)&&(O.clearConversionSourceContext(t.singleVisual),!0)},O.prototype.setPercentOfRoleTotal=function(e,t){return!!t.singleVisual.query.setPercentOfRoleTotal(e.roleRefs,e.role,e.index)&&(O.clearConversionSourceContext(t.singleVisual),!0)},O.prototype.removePercentOfRoleTotal=function(e,t){return!!t.singleVisual.query.removePercentOfRoleTotal(e.role,e.index)&&(O.clearConversionSourceContext(t.singleVisual),!0)},O.prototype.toggleShowAll=function(e,t){t.singleVisual.query.toggleShowAll(e),O.clearConversionSourceContext(t.singleVisual)},O.prototype.changeActiveProjection=function(e,t,r){var i=t.query.projections[e];if(i){var a,o=_.uniqBy(i.all(),(function(e){return e.queryRef})),n=_.uniq(i.activeProjectionRefs),e=(a=!_.isEmpty(n)?n.length:a)&&_.findIndex(o,(function(e){return e.queryRef===n[a-1]}));if(!(null==e||e<0)){if(1===r){if(!(1<=e))return;n.pop(),1!==a&&n[a-2]===o[e-1].queryRef||n.push(o[e-1].queryRef)}else{if(3===r&&(n.length=0),o.length,!(o.length>e+1))return;n.push(o[e+1].queryRef)}return O.clearConversionSourceContext(t),i.activeProjectionRefs=n}}},O.prototype.addDrillFilter=function(e,t,r,i,a){this.addDrill(e,t,r,i,a,2,!0)},O.prototype.addDrillToDetailsFilter=function(e,t,r,i,a){_.remove(t,(function(e){return!!e.expression&&F.isMeasure(e.expression)})),this.addDrill(e,t,r,i,a,0,!1)},O.prototype.addDrill=function(p,u,c,e,d,m,v){if(u&&c&&!_.isEmpty(e)&&d)for(var t=function(e){var t=c.defn.select().withName(e).expr,r=d.expr,i=A.isNot(r);i&&(r=r.arg);var a=f.getInExpr(r),o=[],n=void 0,s=t.getKeyColumns(p);if(!_.isEmpty(a.values))for(var l=0;l<a.args.length;l++)!(function(t){var e=a.args[t];e&&-1!==F.indexOfExpr(s,e)&&(o.push(e),e=_.map(a.values,(function(e){return[e[t]]})),n=_.isEmpty(n)?e:_.chain(n).zip(e).map((function(e){return _.flatten(e)})).value())})(l);_.isEmpty(o)||_.isEmpty(n)||(e=y.inValues(o,n||[]),i&&(e=y.not(e)),r=k.DataViewScopeIdentity.filterFromIdentity([{kind:1,expr:e,key:d.key}]),i=_.filter(u,(function(e){return A.equals(t,e.expression)})),e=void 0,(e=v?_.find(i,(function(e){return e.howCreated===m})):e)?(e.filter&&e.howCreated,e.filter=r,e.howCreated=m,e.precedence=0):(r={name:null,expression:t,filter:r,type:M.contracts.FilterType.Categorical,howCreated:m,precedence:0},u.push(r)))},r=0,i=e;r<i.length;r++)t(i[r])},O.prototype.removeDrillFilter=function(e,t){if(!e)return!1;var r;this.ensureFiltersArrayIsValid(e);for(var i=0,a=e.length;i<a;i++){var o=e[i];if(o&&(2===o.howCreated&&A.equals(t,o.expression))){r=i;break}}return void 0!==r&&(e.splice(r,1),!0)},O.prototype.setMatchingFilterToAuto=function(t,e){!e.filters||(e=_.find(e.filters,(function(e){return null!=e&&A.equals(e.expression,t)})))&&(e.howCreated=0)},O.prototype.removeAutoFilterFromContract=function(r,e,t){var i,a;!r||(i=r.filters)&&(a=r.config.singleVisual.query,e=null!=t?t:this.getRemoveOptionsQueryRefs(e,a),_.forEach(e,(function(e){var e=a.defn.select().withName(e),t=e?e.expr:void 0,e=D.filterArray(i,(function(e){return r.name,null!=e&&0===e.howCreated&&A.equals(e.expression,t)}));0<e.length&&(e.length,M.FilterUtils.isFilterModified(e[0])?e[0].howCreated=1:_.remove(r.filters,e[0]))})),this.ensureFiltersArrayIsValid(i))},O.prototype.ensureFiltersArrayIsValid=function(e){if(null!=e)for(var t=e.length-1;0<=t;t--)null==e[t]&&e.splice(t,1)},O.prototype.getRemoveOptionsQueryRefs=function(e,t){var r,i,a=[],o=e,n=o.projOptions;if(o.role&&null!==n.fieldIndex){var s=n.fieldIndex,l=n.parameter;if(l)for(var p=null!==(r=l.length)&&void 0!==r?r:0,u=0;u<p;u++){var c=t.getQueryRef(o.role,{parameter:l,indexInParameter:u});a.push(c)}else for(var d=null!==(r=o.count)&&void 0!==r?r:1,u=0;u<d;u++){c=t.getQueryRef(o.role,{fieldIndex:s+u});a.push(c)}}else e.expr&&(e=D.ensureArray(e.expr),i=t.defn.select(),_.forEach(e,(function(t){var e=_.filter(i,(function(e){e=e.expr;return A.isAggregation(e)&&(e=e.arg),A.equals(e,t)}));_.forEach(e,(function(e){e&&e.name&&a.push(e.name)}))})));return a},O.prototype.isEmptyQueryVisual=function(e){var t=e.config.singleVisual;if(t&&this.visualPluginOps.isQueryVisual(t.visualType)&&t.query&&0===t.query.defn.select().length&&_.isEmpty(t.query.getQueryFieldParameters())){e=this.visualPluginService.capabilities(t.visualType);if(e){t=k.ScriptResultUtil.extractScriptResultFromVisualConfig(e.dataViewMappings,t.objects);return t&&!jsCommon.StringExtensions.isNullOrUndefinedOrWhiteSpaceString(t.source)?!1:!0}return!1}return!1},O.prototype.setDefaultSort=function(e,t,r,i){if(e.config&&e.config.singleVisual){var a=e.config.singleVisual,e=i.capabilities(a.visualType);if(r.shouldApplyDefaultSort(a,e)){i=a.query;if(i){var r=i.defn,o=i.projections,n=r.select(),s=[],e=_.filter(e.dataRoles,(function(e){return!(_.has(e,"joinPredicate")||0===e.joinPredicate)}));if(_.some(e,(function(e){e=P.getRole(o,e.name);if(e){e=_.map(e.all(),(function(e){return n.withName(e.queryRef)}));return _.some(e,(function(e){return e.expr&&!_.isEmpty(e.expr.getOrderByColumns(t))}))}})))a.hasDefaultSort&&(a.query=new R(r.orderBy([]),i.projections,i.expansionStates),a.hasDefaultSort=!1);else{for(var l=!1,p=0,u=e;p<u.length;p++){var c=u[p],c=P.getRole(o,c.name);if(c){c=_.map(c.all(),(function(e){return e.queryRef}));if(c){for(var d=!1,m={direction:1,expr:null},v=0,f=c;v<f.length;v++){var g=f[v],h=n.withName(g),y=h&&h.expr;if(y&&F.isExprValidForSorting(y)){g=y.getMetadata(t);if(g){h=1===g.kind&&g.type.numeric;if(null==m.expr&&(y&&h&&(m.direction=2),m.expr=y),g.type.temporal){d=l=!0;break}if(h){d=!0;break}}}}if(d&&(_.isEmpty(s)||l)&&(m.expr,s=[m]),l)break}}}_.isEmpty(s)||(a.hasDefaultSort=!0,a.query=new R(r.orderBy(s),i.projections,i.expansionStates))}}}}},O.prototype.ensureValidDrillState=function(e,t,r){for(var i=0,a=t;i<a.length;i++){var o=a[i];this.removeDrillFilter(e.filters,o.expr);var n=e.config.singleVisual.query,o=n.projections[o.roleName];!o||null!=(o=_.last(o.activeProjectionRefs))&&(o=n.defn.select().withName(o).expr,this.removeDrillFilter(e.filters,o))}this.ensureValidDrillMode(e,r)},O.prototype.ensureValidDrillMode=function(e,t){var r=e.drillMode;(1===r&&0===t.getSupportedDrillDirections(e)||2===r&&!t.canDrillToDetails(e))&&t.setDrillMode(e,0)},O.prototype.resolveParameters=function(x,b,e,S,E,N){var V={queryChange:!1,aliasChange:!1,totalAddAttemptCount:0,totalAddSuccessCount:0,totalRemoveAttemptCount:0,totalRemoveSuccessCount:0,totalSuccessColumnCount:0,totalSuccessDateHierarchyCount:0,totalSuccessMeasureCount:0},P=b&&b.config&&b.config.singleVisual&&b.config.singleVisual.query;if(!P)return V;var w,T=[];for(w in e)for(var F=P.projections[w],j=F.getFieldParameters(),R=this,t=0,r=e[w];t<r.length;t++)!(function(e){var t=e.parameter,r=e.result,i=_.find(j,(function(e){return e.index===t.index}));A.equals(t.expr,i.expr);for(var a,o=F.getParameterProjections(i),n=_.map(o,(function(e){return P.defn.select().withName(e.queryRef).expr})),s=_.map(r,(function(e){return e.expr})),l=D.getLongestCommonSubsequence(s,n,A.equals),p=l.length-1,u=[],c=[],d=[],m=n.length-1;0<=m;m--)0<=p&&A.equals(n[m],l[p])?p--:(C={role:w,projOptions:{parameter:i,indexInParameter:m}},c.push(C),u.push(o[m].queryRef),a={expr:n[m],roleName:w},d.push(a));0<c.length&&(e=R.removeWithValidation(P,u,c,b,x,d,S,E,void 0,!0),V.totalRemoveSuccessCount+=e.removeSuccessCount,V.totalRemoveAttemptCount+=e.removeAttemptCount);for(var p=0,v=0,f=0,m=0;m<s.length;m++){var g,h,y=r[m].alias,C={parameter:i,indexInParameter:m-(v-f)};0<l.length&&A.equals(s[m],l[p])?(p++,N&&(V.aliasChange=N(P.getQueryRef(w,C),b,y)||V.aliasChange)):(h={expr:g=s[m],schema:x,targetRole:w,projOptions:C},v++,R.add(h,b.config,!1)&&(f++,A.isColumn(g)?V.totalSuccessColumnCount++:A.isMeasure(g)?V.totalSuccessMeasureCount++:A.isHierarchyLevel(g)&&V.totalSuccessDateHierarchyCount++,T.push(g),N&&(V.aliasChange=N(P.getQueryRef(w,C),b,y)||V.aliasChange)))}V.totalAddAttemptCount+=v})(r[t]);return V.totalAddSuccessCount=T.length,0<V.totalAddSuccessCount&&this.runAddFieldValidation(b,x,T,S,E,void 0,!0),(0<V.totalAddSuccessCount||0<V.totalRemoveSuccessCount)&&(this.setDefaultSort(b,x,E,this.visualPluginService),C.setQueryKeepProjectionOrder(b),V.queryChange=!0),V},O.prototype.runAddFieldValidation=function(e,t,r,i,a,o,n){if(this.ensureValidDrillMode(e,i),n&&!this.featureSwitchService.featureSwitches.fieldParameterDynamicSlicer||(o||this.updateFilterState.bind(this))(t,e,!1,!0,!0),n||(this.setDefaultSort(e,t,a,this.visualPluginService),C.setQueryKeepProjectionOrder(e)),_.isArray(r))for(var s=0,l=r;s<l.length;s++){var p=l[s];this.setMatchingFilterToAuto(p,e)}else this.setMatchingFilterToAuto(r,e)},O.prototype.removeWithValidation=function(e,t,r,i,a,o,n,s,l,p){var u=0,c=[];this.removeAutoFilterFromContract(i,void 0,t);for(var d=0;d<r.length;d++){var m=this.remove(r[d],i.config,a);u+=m?1:0,m||c.push(d)}if(0<u){if(0<c.length){t=_.clone(t);for(var v=c.length-1;0<=v;v--)t.splice(c[v],1)}this.ensureValidDrillState(i,o,n),this.isEmptyQueryVisual(i)?e=i.config.singleVisual.query=void 0:p||(this.setDefaultSort(i,a,s,this.visualPluginService),C.setQueryKeepProjectionOrder(i)),p&&!this.featureSwitchService.featureSwitches.fieldParameterDynamicSlicer||(l||this.updateFilterState.bind(this))(a,i,!0,!0,!0,null),p||this.clearUnusedObjectDefinitions(i,e,t)}return{removeAttemptCount:r.length,removeSuccessCount:u}},O.prototype.clearUnusedObjectDefinitions=function(e,t,r){_.forEach(r,(function(i){var a;t&&t.isUsed(i)||(a=e.config.singleVisual.objects,_.forEach(a,(function(e,t){var r=[];_.forEach(e,(function(e){e.selector&&e.selector.metadata===i&&r.push(e.selector)})),_.forEach(r,(function(e){E.deleteObjectDefinition(a,t,e)}))})))}))},O.prototype.updateFilterState=function(e,t,r,i,a,o){var n=t.config.singleVisual,s=this.visualPluginService.capabilities(n.visualType),s=s?s.objects:null;if(i&&this.ensureDefaultFilterApplied(e,n,r))return{clearOrDefault:!0,updateAll:!1};r=!1;if(a){e=this.updateFilterOutput(n,s,e);if(2===e)return{clearOrDefault:!0,updateAll:!1};r=1===e}t=t.config.singleVisual;return{clearOrDefault:!1,updateAll:r=!r&&o&&t&&t.objects&&E.getValue(t.objects,o,null)?!0:r}},O.prototype.ensureDefaultFilterApplied=function(e,t,r){var i=this.visualPluginService.capabilities(t.visualType),a=i?i.objects:null,o=m.findDefaultValue(a),i=t.query&&t.query.getUniqueQueryRefs();if(!o||_.isEmpty(i))return this.clearDefaultFilterOutput(t,a);for(var n=t.query.defn.select(),s=[],l=[],p=!0,u=0,c=_.map(i,(function(e){return n.withName(e).expr}));u<c.length;u++){var d=c[u];F.getDefaultValue(d,e)?p?s.push.apply(s,this.getExprKeyColumns(d,e)):l.push.apply(l,this.getExprKeyColumns(d,e)):p=!1}if(_.isEmpty(s)&&_.isEmpty(l)||r)return this.clearDefaultFilterOutput(t,a);t.objects||(t.objects={});r=m.findFilterOutput(a),a=h.getDefaultAnyValueFilter(s,l);return E.setValue(t.objects,r,null,a),!0},O.prototype.getExprKeyColumns=function(e,t){var r=l.asFieldPattern(e);return r.column||r.groupingColumn||r.hierarchyLevel?e.getKeyColumns(t):[e]},O.prototype.clearDefaultFilterOutput=function(e,t){if(!e.objects)return!1;var r=m.findFilterOutput(t);if(!r)return!1;t=E.getValue(e.objects,r,null);return!(!t||!h.isDefaultFilter(t))&&(E.deleteProperty(e.objects,r.objectName,null,r.propertyName),!0)},O.prototype.updateFilterOutput=function(e,t,r){if(!e.objects)return 0;var i=m.findFilterOutput(t);if(!i)return 0;t=E.getValue(e.objects,i,null);if(t){if(!this.featureSwitchService.featureSwitches.fieldParameterDynamicSlicer||!e.query)return E.deleteProperty(e.objects,i.objectName,null,i.propertyName),2;r=this.updateFilterOutputForVisual(e.query,t,r);return h.isSameFilter(r,t)?0:r?(E.setValue(e.objects,i,null,r),1):(E.deleteProperty(e.objects,i.objectName,null,i.propertyName),2)}return 0},O.prototype.updateFilterOutputForVisual=function(e,t,r){var i=e.getUniqueQueryRefs();if(!_.isEmpty(i)){var a=new g,o=e.defn.select(),n=_.map(i,(function(e){return o.withName(e).expr.accept(a,r)})).reduce((function(e,t){return e.concat(t)}),[]);if(!_.isEmpty(n)){for(var s,l=[],p=0,u=t.where();p<u.length;p++){var c=u[p],d=F.syncSQExprWithFilterIdenities(n,c.condition);d&&(c={target:c.target,condition:d,annotations:c.annotations},l.push(c))}return s=0<l.length?new h(t.from(),l):s}}},O.prototype.moveProjectionCore=function(e,t,r){var i=e.singleVisual;if(!i||!i.query)return!1;var a=r.sourceRole,o=r.targetRole,n=r.sourceIndex,s=r.targetIndex,l=r.replacementExpressions,p=r.schema,u=r.allowPartialReplace,c=w.clone(i),d=c.query.getParameterByFieldIndex(n,a);d||t.length;var r=c.query.defn.orderBy(),m=l||t,v=k.columnPropertiesAuthoringModuleFactory(),f=v.getColumnPropertiesForExprs(m,c),t={role:a,projOptions:{fieldIndex:n,parameter:d},count:t.length,shouldRemoveParameter:!0};if(!this.tryRemoveProjections(c.query,c.columnProperties,t))return!1;0<r.length&&c.query.orderBy(r);var t=this.visualPluginService.capabilities(i.visualType),g=k.visualCapabilitiesHelperModuleFactory().create(t,this.geoTaggingService);if(!g)return!1;var h=g.roles.withName(o);if(!h)return!1;r=a===o&&s===n,n=!1;if(r){if(1===m.length&&F.shouldUseAsFieldParameter(this.featureSwitchService.featureSwitches.fieldParametersAuthoring,p,m[0],this.featureSwitchService.featureSwitches.fieldParameterDynamicSlicer||!M.FilterUtils.supportsFilterOutput(t),this.visualPluginOps.isAnalysisVisual(c.visualType))){var y={expr:m[0],schema:p,targetRole:o,projOptions:{fieldIndex:s}};if(!(n=this.tryAdd(g,c,!0,y)))return!1}}else if(d){y={expr:d.expr,schema:p,targetRole:o,projOptions:{fieldIndex:s}};if(!(n=this.tryAdd(g,c,!0,y)))return!1}if(!n)for(var C=0;C<m.length;C++){var x=m[C];m[C]=this.aggregateIfNecessary(m[C],h,p);var b,y={expr:m[C],schema:p,targetRole:o,projOptions:{fieldIndex:s+C}};if(!this.tryAdd(g,c,!1,y)){if(0<C&&u)break;return!1}i.query.projections[a].showAll&&(b=m[C].getMetadata(p),this.isShowAllRole(h.kind)&&b&&1!==b.kind&&(c.query.projections[o].showAll=!0)),v.applyColumnPropertiesByExpr(x,m[C],c,f)}return e.singleVisual=c,this.visualAuthoringCustomizeOperations.customizeOptions(e.singleVisual,p),O.clearConversionSourceContext(e.singleVisual),!0},O.prototype.aggregateIfNecessary=function(e,t,r){return null!=i.getAggregate(e,r)||t.kind!==k.VisualDataRoleKind.Measure||F.discourageAggregation(e,r)?t.kind===k.VisualDataRoleKind.Grouping?y.removeAggregate(e,r):e:this.aggrOps.createExprWithAggregate(e,r,!0,t.requiredTypes)},O.clearConversionSourceContext=function(e){e.conversionSourceContext=null},O.prototype.getConversionExprRoleList=function(o,n,s,l,p,u,c,d){function e(e){for(var t=[],r=0,i=o;r<i.length;r++){var a=i[r];a.isFieldParameter?t.push({expr:a.expr,isFieldParameter:a.isFieldParameter,roleName:a.roleName}):(a=e(a.expr))&&t.push({expr:a})}if(!_.isEmpty(t))return m.getCompatRolesForExprs(t,n,s,l,p,u,!0,c,d)}var m=this,t=this.getCompatRolesForExprs(o,n,s,l,p,u,!1,c,d);return _.isEmpty(t)&&(t=e((function(e){return F.isMeasure(e)?e:m.aggrOps.createExprWithAggregate(e,l,!0,null)}))),(t=_.isEmpty(t)?e((function(e){return F.isMeasure(e)?y.removeAggregate(e,l):e})):t)||[]},O.prototype.getCompatRolesForExprs=function(e,t,r,i,a,o,n,s,l){for(var p=[],u=s||{},c=new T(b.hierarchyLevelComparer),d=0,m=e;d<m.length;d++){var v=m[d],f=void 0,g=v.expr,h=v.isFieldParameter,y=v.roleName;y&&(f=t.roles.withName(y));v=this.getTargetRoleForConversion(v,t,r);if(f=r.findCompatibleRole({queryProjections:u,schema:i,expr:g,targetRole:v,preferDrillableRoles:!1,roleToExprMap:c,useStrict:!0,isFieldParameter:h,sourceRole:h&&f})){f=this.ensureCorrectKeyInfluencersRole(a,f,void 0),f=this.ensureCorrectSmallMultiplesRole(o,r.capabilities,f,t.capabilities,y).name;if(!h){this.updateProjections(u,f,l);y=r.getNumberRangesForRoles(u)[f];if(this.shouldUseVariation(g,i,f,l,y,_.size(e))){y=j.getSourceVariationExpr(g);return p.push({expr:y,roleName:f}),p}}if(p.push({expr:g,isFieldParameter:h,roleName:f}),n)return p}}return p},O.prototype.shouldUseVariation=function(e,t,r,i,a,o){if(!_.includes(i,r)&&a&&a.max<o){t=l.asFieldPattern(e,t);if(t&&t.columnHierarchyLevelVariation)return!0}return!1},O.prototype.getExpressionRoleMappings=function(t,e){return _.map(e,(function(e){return{expr:e.expr,roleName:t.getRoleNameForExpr(e.expr),isFieldParameter:e.isFieldParameter}}))},O.prototype.getTargetRoleForConversion=function(e,t,r){if(!r.hasPreferredTypes()){var i=e.roleName,a=t.roles,e=t.capabilities,t=r.roles,r=r.capabilities,a=a.withName(i),t=t.withName(i);if(a&&t&&_.isEqual(a.kind,t.kind)){e=this.getDataViewMappingConditions(e),r=this.getDataViewMappingConditions(r);if(!e&&!r||this.getDoesTargetRoleMatchSourceRole(i,e,r))return i}}},O.prototype.getDoesTargetRoleMatchSourceRole=function(r,e,i){return e&&i&&!e.some((function(e,t){e=_.get(e,r,null),t=_.get(i[t],r,null);return e&&t&&!_.isEqual(e,t)}))},O.prototype.getDataViewMappingConditions=function(e){e=e.dataViewMappings&&e.dataViewMappings[0];return e&&e.conditions},O.prototype.updateProjections=function(e,t,r){var i={queryRef:t},a=P.getRole(e,t);a||(e[t]=a=new o([])),a.addProjection(i),_.includes(r,t)&&a.addActiveQueryReference(a.all()[0].queryRef)},O.prototype.createConversionSourceContext=function(e,t,r){return{query:e,visualType:t,syncGroup:r}},O.prototype.convertDrillableRoles=function(e,t,r,i,a){var o=new R(e.defn.select([]),{},[]),t=N.getDrillableRoles(t);return _.isEmpty(t)?{query:o,convertedFields:[]}:{query:o,convertedFields:this.convertDrillableProjections(r,i,e,a,t,o)}},O.prototype.convertDrillableProjections=function(e,t,r,i,a,o){for(var n=N.getDrillableRoles(e),s=[],l=0,p=a;l<p.length;l++){var u=p[l],u=this.getQueryFieldsForRole(r,u,e,t),u=this.convertDrillableFields(u,i,e,o),s=_.unionWith(s,u,R.isEqualQueryFields);if(_.isEmpty(n))break}return o.ensureDrillableRoles(n),s},O.prototype.supportsFieldParameters=function(e){return this.featureSwitchService.featureSwitches.fieldParameters&&this.featureSwitchService.featureSwitches.fieldParametersAuthoring&&e.hasQueryFieldParameters()},O.prototype.getQueryFieldsForRole=function(e,t,r,i){var a=e.projections[t];return a?this.getQueryFields(e,r,i,(function(){return _.map(a.all(),(function(e){return e.queryRef}))}),(function(){return e.tryGetFieldExprs(t)})):[]},O.prototype.getUniqueQueryFields=function(e,t,r){return this.getQueryFields(e,t,r,(function(){return e.getUniqueQueryRefs()}),(function(){return e.getUniqueQueryFields()}))},O.prototype.getQueryFields=function(e,t,r,i,a){var o=e.defn.select();if(this.supportsFieldParameters(e)){a=a();if(M.FilterUtils.supportsFilterOutput(t)||this.visualPluginOps.isAnalysisVisual(r))for(var n=0,s=a;n<s.length;n++)s[n].isFieldParameter=!1;return a}i=i();return _.map(i,(function(e){return{expr:o.withName(e).expr,queryName:e,isFieldParameter:!1}}))},O.prototype.convertDrillableFields=function(p,u,e,c){for(var d,m=k.visualCapabilitiesHelperModuleFactory().create(e,this.geoTaggingService),v=m.getNumberRangesForRoles(c),f=N.getDrillableRoles(e),g=_.isEmpty(f),h=new T(b.hierarchyLevelComparer),y=[],C=[],x=this,t=0,r=p;t<r.length;t++)!(function(e){var t=e.expr,r=e.queryName;if(A.isHierarchyLevel(t)){var i=j.getSourceVariationExpr(e.expr);if(i&&_.find(C,(function(e){return A.equals(e,i)})))return y.push(e)}var a=m.findCompatibleRole({queryProjections:c.projections,schema:u,expr:t,preferDrillableRoles:!0,roleToExprMap:h,useStrict:!0,isFieldParameter:e.isFieldParameter});if(a){var o=a.name,n=v[o],s=-1;if(e.isFieldParameter)s=c.addParameter(t,a.name),y.push(e);else{var l=c.projections[o];if(g&&l&&(d=l.all().length,n&&n.max&&n.max<=d))return;if(x.shouldUseVariation(e.expr,u,a.name,f,n,_.size(p))){n=j.getSourceVariationExpr(e.expr);return C.push(n),s=c.add(n,o,{exprName:r})}s=c.add(t,o,{exprName:r})}-1<s&&y.push(e)}})(r[t]);return y},O.prototype.tryRemove=function(e,t,r,i){return p(r)?this.tryRemoveProjections(e,t,r):!!a(r)&&this.tryRemoveExpressions(e,r,i)},O.prototype.tryRemoveExpressions=function(e,t,r){var i,a=!1,o=t.fieldParameter;if(_.isArray(t.expr))for(var n=0,s=t.expr;n<s.length;n++)var l=s[n],a=e.removeExpr(l,!!t.ignoreAggregates,r,null==o?void 0:o.expr)||a;else a=e.removeExpr(t.expr,!!t.ignoreAggregates,r,null==o?void 0:o.expr);return a=t.shouldRemoveParameter&&o&&0===(null!==(i=o.length)&&void 0!==i?i:0)?e.removeParameter(o)||a:a},O.prototype.tryRemoveProjections=function(e,t,r){var i=r.role,a=r.projOptions.parameter,o=!1;if(a)var n=r.shouldRemoveParameter,s=r.projOptions.indexInParameter,o=this.removeParameterProjections(e,t,a,i,n,s);else for(var l=r.projOptions.fieldIndex,p=(null!==(r=r.count)&&void 0!==r?r:1)-1;0<=p;p--)if(!(o=this.removeProjection(e,t,i,{fieldIndex:l})))return!1;return o},O.prototype.removeParameterProjections=function(e,t,r,i,a,o){var n=!1;if(null!=o)var s={parameter:r,indexInParameter:o},n=this.removeProjection(e,t,i,s);else for(var l=(null!==(o=r.length)&&void 0!==o?o:0)-1;0<=l;l--){s={parameter:r,indexInParameter:l};if(!(n=this.removeProjection(e,t,i,s)))return!1}return n=a&&0===(null!==(a=r.length)&&void 0!==a?a:0)?e.removeParameterByRoleName(r,i)||n:n},O.prototype.removeProjection=function(e,t,r,i){var a=e.getQueryRef(r,i),i=e.removeProjection(r,i);return a&&!e.isUsed(a)&&t&&t[a]&&delete t[a],i},O.prototype.tryAdd=function(e,t,r,i){var a=i.expr,o=new T(b.hierarchyLevelComparer),n=!1,s=i.projOptions;if(_.isArray(a))for(var l=s&&s.fieldIndex,p=0,u=a;p<u.length;p++){var c=u[p],n=null!=this.tryAddQuery(e,t,i,c,s,o,r)||n;null!=l&&s.fieldIndex++}else if(null==this.tryAddQuery(e,t,i,a,s,o,r))return!1;if(!r){var d=N.getDrillableRoles(e.capabilities);if(t.query.ensureDrillableRoles(d),_.isArray(a))return n}return!0},O.prototype.tryAddQuery=function(e,t,r,i,a,o,n){var s=e.findCompatibleRole({queryProjections:t.query.projections,schema:r.schema,expr:i,preferDrillableRoles:!1,roleToExprMap:o,targetRole:r.targetRole,isFieldParameter:n});if(s&&(s=this.ensureCorrectKeyInfluencersRole(t.visualType,s,r.targetRole),this.featureSwitchService.featureSwitches.cartesianMultiplesAuthoring||u(s,t,e.capabilities)||(s=this.ensureCorrectSmallMultiplesRole(t,e.capabilities,s,void 0,void 0)),e.validateDuplicateColumnsInRole(s,i,t.query,n))){var l=s.name,r=void 0,r=n?t.query.addParameter(i,l,a&&a.fieldIndex):t.query.add(i,l,a);return this.ensureDependentObjectDefn(e.objectDescs,l,t),o.add(i,s),r}},O.prototype.ensureCorrectKeyInfluencersRole=function(e,t,r){return e!==k.visuals.plugins.keyDriversVisual.name||t.name!==k.visuals.keyDriverRoleNames.details||r?t:_.find(k.visuals.getKeyDriversCapabilities().dataRoles,(function(e){return e.name===k.visuals.keyDriverRoleNames.explainBy}))},O.prototype.ensureCorrectSmallMultiplesRole=function(e,t,r,i,a){var o;return null!==(o=this.featureSwitchService.featureSwitches)&&void 0!==o&&o.cartesianMultiplesAuthoring||!s.supportsSmallMultiplesDataViewMapping(null==t?void 0:t.dataViewMappings)||r.name!==k.visuals.cartesianRoleNames.rows||i&&a===k.visuals.cartesianRoleNames.rows&&s.supportsSmallMultiplesDataViewMapping(null==i?void 0:i.dataViewMappings)||e.hasUsedSmallMultiples?r:_.find(t.dataRoles,(function(e){return e.name===k.visuals.cartesianRoleNames.category}))},O.prototype.ensureDependentObjectDefn=function(e,t,r){if(e)for(var i in e){var a,o=e[i];for(a in o.properties){var n,s=o.properties[a];s.rule&&s.rule.inputRole===t&&(n=(n=r.objects)||(r.objects={}),(n=E.ensure(n,i,null)).properties[a]||(n.properties[a]=this.createDefaultDefinition(s.type)))}}},O.prototype.createDefaultDefinition=function(e){if(e.fillRule)return t.getDefaultFillRuleDefinition()},O.prototype.getSourceShowAllInfo=function(e){for(var t={},r=0,i=_.values(e);r<i.length;r++)for(var a=i[r],o=a.showAll,n=0,s=a.all();n<s.length;n++)t[s[n].queryRef]=o;return t},O.prototype.updateTargetShowAllInfo=function(e,t,r){for(var i=this.getSourceShowAllInfo(e.query.projections),a=0,o=_.keys(t.projections);a<o.length;a++){var n=o[a],s=r.roles.withName(n).kind;if(this.isShowAllRole(s))for(var l=0,p=t.projections[n].all();l<p.length;l++){var u=i[p[l].queryRef];u&&(t.projections[n].showAll=u)}}},O.prototype.isShowAllRole=function(e){return e===k.VisualDataRoleKind.Grouping||e===k.VisualDataRoleKind.GroupingOrMeasure},O);function O(e,t,r,i,a){this.visualPluginService=e,this.geoTaggingService=t,this.aggrOps=r,this.featureSwitchService=i,this.visualAuthoringCustomizeOperations=a,this.visualPluginOps=k.explore.services.createVisualPluginOps(e,i)}})((M=k.explore||(k.explore={})).services||(M.services={}))})(powerbi=powerbi||{}),(function(C){var E;(function(e){var v=C.DataViewMapping,u=C.data.QueryProjectionsByRole,f=C.visuals.SmallMultiplesUtils,b=C.data.SQExpr,r=C.data.SQExprBuilder,S=C.data.SQExprUtils,g=C.explore.util.VisualContainerUtils,c=E.contracts.VisualQuery;e.createSortService=function(e,t,r){return new i(e,t,r)};var i=(h.prototype.getSortableFields=function(e){var t=e.visualType,r=this.visualPluginService.capabilities(t);if(!r||!this.isVisualSortable(r))return{sortableFields:[],sortGroups:[]};t=this.createIsRoleSortableDelegate(t,e.compiledMappings);return this.getGroupedSortableFieldsFromProjections(e.query,e.schema,r,e.columnProperties,t)},h.prototype.createIsRoleSortableDelegate=function(e,t){var r=this.visualPluginService.getPlugin(e),e=this.visualPluginService.capabilities(e);if(!r.getSortableRoles||!e.sorting)return function(e){return!0};var t={dataViewMappings:t,featureSwitches:this.featureSwitches.featureSwitches},i=r.getSortableRoles(t);return _.isEmpty(i)?function(e){return!1}:function(e){return 0<=i.indexOf(e)}},h.prototype.addSort=function(e,t){e&&e.defn&&t&&(e.defn=e.defn.orderBy(t))},h.prototype.removeSort=function(e,t){if(e&&e.defn&&t)for(var r=0,i=t;r<i.length;r++){var a=i[r];e.defn=e.defn.removeOrderBy(a.expr)}},h.prototype.resetSort=function(e){var t;e&&e.defn&&(t=e.defn.orderBy(),this.removeSort(e,t))},h.prototype.applyImplicitSort=function(e,t){if(!t)return e;var r=e.defn;if(!r)return e;for(var t=t.clauses,i=r.select(),a=[],o=0,n=t;o<n.length;o++){var s,l=n[o],p=u.getRole(e.projections,l.role);p&&(s=l.direction,a.push.apply(a,_.map(p.all(),(function(e){return{expr:i.withName(e.queryRef).expr,direction:s}}))))}return _.isEmpty(a)?e:new c(r.orderBy(a),e.projections,e.expansionStates)},h.prototype.shouldApplyDefaultSort=function(e,t){if(null!==(r=t.sorting)&&void 0!==r&&r.custom||null!==(i=t.sorting)&&void 0!==i&&i.implicit)return!1;var r=e.query;if(!r)return!1;var i=g.createRoleKindByQueryRef(r),i=null===(i=C.DataViewAnalysis.chooseDataViewMappings(r.projections,t.dataViewMappings,i,this.featureSwitches.featureSwitches).supportedMappings)||void 0===i?void 0:i[0];return!((null==i?void 0:i.matrix)&&f.isSmallMultiplesDataViewMapping(i))&&(e.hasDefaultSort||_.isEmpty(e.query.defn.orderBy()))},h.prototype.ensureValidSorting=function(e){var t=e.query,r=t.defn;if(!r)return t;var i=r.orderBy();if(_.isEmpty(i))return t;var e=this.getSortableFields(e).sortableFields,a=[];if(!_.isEmpty(e))for(var o=0,n=e;o<n.length;o++){var s=n[o];a.push.apply(a,this.createSortDefinitions(s))}for(var l=!1,p=i.length-1;0<=p;p--)!(function(t){if(_.find(a,(function(e){return b.equals(e.expr,i[t].expr)})))return;i.splice(t,1),l=!0})(p);return l?new c(r.orderBy(i),t.projections,t.expansionStates):t},h.prototype.isVisualSortable=function(e){return _.some(e.dataRoles,(function(e){return e.kind!==C.VisualDataRoleKind.Measure}))},h.prototype.getGroupedSortableFieldsFromProjections=function(a,o,n,s,e){var t,l=this,p=a.defn.select(),u=a.defn.orderBy(),r=g.createRoleKindByQueryRef(a),r=C.DataViewAnalysis.chooseDataViewMappings(a.projections,n.dataViewMappings,r,this.featureSwitches.featureSwitches),i=new y(e,function(e,t,r,i){e=a.getRolesActiveProjectionsRefs([e],!1);return _.isEmpty(e)?[]:l.createSortableFieldsForQueryRefs(o,p,e,u,n,s,0!==r,t,i)},this.featureSwitches);if(r.supportedMappings)for(var c=0,d=r.supportedMappings;c<d.length;c++){var m=d[c];m.matrix&&f.isSmallMultiplesDataViewMapping(m)?v.visitMatrix(m.matrix,i):m.categorical&&null!==(t=this.featureSwitches.featureSwitches)&&void 0!==t&&t.sortLegend&&v.visitCategorical(m.categorical,i)}return _.isEmpty(i.groups)?this.getDefaultGroupSortableFieldsFromProjections(a,r,o,n,s,e):{sortableFields:i.allSortableFields,sortGroups:i.groups}},h.prototype.getDefaultGroupSortableFieldsFromProjections=function(e,t,r,i,a,o){i.dataRoles;for(var n=[],s=e.defn.select(),l=e.defn.orderBy(),p=_.some(t.supportedMappings,(function(e){return e.categorical})),u=0,c=i.dataRoles;u<c.length;u++){var d,m=c[u].name;o(m)&&(d=e.getRolesActiveProjectionsRefs([m],!1),_.isEmpty(d)||(m=!_.isEmpty(e.projections[m].activeProjectionRefs),m=this.createSortableFieldsForQueryRefs(r,s,d,l,i,a,p&&m,h.DefaultSortGroupKey),n.push.apply(n,m)))}return this.createResultWithSortGroup(n)},h.prototype.createSortableFieldsForQueryRefs=function(n,s,e,l,p,u,c,d,m){for(var v,f=!1,g=Number.MAX_VALUE,h=[],y=[],C=[],x=this,t=0,r=e;t<r.length;t++)!(function(e){var t=s.withName(e),r=null==t?void 0:t.expr;if(!r||!S.isExprValidForSorting(r))return;var i=x.getDisplayNameFromQueryRef(n,s,e,p,u),a=x.applySortingScope(r,m),o=_.findIndex(l,(function(e){return b.equals(e.expr,a)}));o!==E.constants.invalidSortExprIndex&&(g=Math.min(g,o)),c?((f=f||o!==E.constants.invalidSortExprIndex)&&!v&&(E.constants.invalidSortExprIndex,v=l[o].direction),y.push({name:e,expr:r}),C.push(i)):(f=o!==E.constants.invalidSortExprIndex,v=f?l[o].direction:void 0,h.push({displayName:i,exprs:[t],active:f,orderByIndex:f?o:void 0,sortDirection:v,groupKey:d,scope:m}))})(r[t]);return c?_.isEmpty(y)?[]:[{displayName:C.join(" "),exprs:y,active:f,orderByIndex:f?g:void 0,sortDirection:f?v:void 0,groupKey:d,scope:m}]:h},h.prototype.getDisplayNameFromQueryRef=function(e,t,r,i,a){t=null===(t=t.withName(r))||void 0===t?void 0:t.expr;return t?this.displayNameService.getDisplayName(t,e,i,r,a):""},h.prototype.createResultWithSortGroup=function(e){var t=[];return _.isEmpty(e)||t.push({key:h.DefaultSortGroupKey,displayName:null,fields:e,isDefaultGroup:!0}),{sortableFields:e,sortGroups:t}},h.prototype.createSortDefinitions=function(e){for(var t=[],r=0,i=e.exprs;r<i.length;r++){var a=i[r];t.push({expr:this.applySortingScope(a.expr,e.scope),direction:null!==(a=e.sortDirection)&&void 0!==a?a:2})}return t},h.prototype.applySortingScope=function(e,t){return _.isEmpty(t)?e:r.scopedEval(e,t)},h.DefaultSortGroupKey="Default",h);function h(e,t,r){this.displayNameService=e,this.featureSwitches=t,this.visualPluginService=r}e.SortService=i;var y=(n.prototype.visitRole=function(e,t){if(this.isRoleSortable(e))switch(t){case"MatrixColumnsGroup":case"CategoricalSeries":this.featureSwitchService.featureSwitches.sortLegend&&this.addRole(e,"Legend",1);break;case"MatrixRowsGroup":return void this.addRole(e,e,1);case"CategoricalCategory":return void this.addRole(e,"Category",1);case"MatrixIntersection":case"MatrixRowsScopedValue":return void this.addRole(e,"Rows",0,!0,[r.roleRef("Rows")]);case"CategoricalValue":case"CategoricalValueGroup":return void this.addRole(e,"Category",0,!0);default:return}},n.prototype.addRole=function(e,t,r,i,a){var o;if(i=void 0===i?!1:i){if(!(o=_.find(this.groups,(function(e){return e.key===t}))))return}else o={key:t,displayName:n.RoleToSortGroupDisplayName[t],fields:[]};r=this.getSortableFieldsForRole(e,t,r,a);_.isEmpty(r)||(_.includes(this.uniqueRoles,e)||((a=this.allSortableFields).push.apply(a,r),this.uniqueRoles.push(e)),(e=o.fields).push.apply(e,r),i||_.includes(this.uniqueGroupKeys,o.key)||(this.groups.push(o),this.uniqueGroupKeys.push(o.key)))},n.prototype.visitReduction=function(){},n.prototype.enterComposite=function(){},n.prototype.exitComposite=function(){},n.RoleToSortGroupDisplayName=((e={}).Rows="Sort_Group_Small_multiples",e.Category="Sort_Group_Axis",e.Legend="Sort_Group_Legend",e),n);function n(e,t,r){this.isRoleSortable=e,this.getSortableFieldsForRole=t,this.featureSwitchService=r,this.groups=[],this.allSortableFields=[],this.uniqueGroupKeys=[],this.uniqueRoles=[]}})((E=C.explore||(C.explore={})).services||(E.services={}))})(powerbi=powerbi||{}),(function(S){S.visualCapabilitiesHelperModuleFactory=function(){var a=S,e=a.data,t=(r=a.explore).contracts,r=r.util,i=jsCommon.ArrayExtensions,n=a.DataViewMapping,o=a.DataViewAnalysis,c=r.DrillUtils,h=jsCommon.MathExtensions,s=e.SQExpr,l=e.SQExprConverter,y=t.VisualQuery,v=a.ValueType;function p(e){return e&&e.geography&&(e.geography.latitude||e.geography.longitude)}function u(e){return _.some(e.preferredTypes,(function(e){return p(e)||e.numeric}))}function d(e){return 0===e.cartesianKind||1===e.cartesianKind}var m=(f.prototype.findCompatibleRole=function(e){e.queryProjections,e.schema,e.expr,e.targetRole,e.roleToExprMap;var t=e.expr,r=e.roleToExprMap,i=e.targetRole,a=e.preferDrillableRoles;if(s.isHierarchyLevel(t)){var a=!0,o=this.getExistingTargetRoleForHierarchyLevelIfAny(t,r);if(o){if(i&&i!==o.name)return;i=o.name}}var n,o=l.asFieldPattern(t,e.schema);o&&(n=o.column||o.columnAggr||o.groupingColumn||o.groupingColumnAggr||o.measure);a={projections:e.queryProjections,metadata:t.getMetadata(e.schema),columnName:n?n.name:void 0,preferDrillableRoles:a,targetRole:i,isFieldParameter:e.isFieldParameter,useStrict:e.useStrict,sourceRole:e.sourceRole},i=this.findRole(a);return i||(a.preferDrillableRoles=!e.preferDrillableRoles,i=this.findRole(a)),i&&r&&r.add(t,i),i},f.prototype.findRole=function(e){var t=this.roleMappings;if(!_.isEmpty(t))for(var r=t[0].getValueType(e.metadata?e.metadata.type:void 0,e.columnName),i=this.roles.allRolesWithPreference(r?r.extendedType:void 0,e.projections,e.preferDrillableRoles,e.useStrict,e.sourceRole),a=0,o=e.targetRole?[e.targetRole]:i;a<o.length;a++)for(var n=o[a],s=0,l=t;s<l.length;s++){var p=l[s].checkRoleCompatibility(e,n,i);if(p)return p}},f.prototype.getExistingTargetRoleForHierarchyLevelIfAny=function(e,t){return t.get(e)},f.prototype.orderByRolePreferences=function(e,t){for(var r=this.roles.defns,i=0,a=t.length,o=0,n=r.length;o<n;o++){var s=r[o].preferredTypes;if(!_.isEmpty(s))for(var l=i;l<a;l++){var p=t[l],u=p.expr.getMetadata(e);if(u){var c=u.type;if(c)for(var d=0,m=s.length;d<m;d++)if(c.extendedType===v.fromDescriptor(s[d]).extendedType){t.splice(l,1),t.splice(i,0,p),i++;break}}}}},f.prototype.getNumberRangesForRoles=function(e){for(var t=_.map(this.roles.defns,(function(e){return e.name})),r=e instanceof y?e.projections:e,i={},a=0,o=t;a<o.length;a++)i[c=o[a]]={min:1/0,max:0};for(var n=0,s=_.filter(this.roleMappings,(function(e){return e.projectionsAreCompatible({projections:r,roleNames:t,preferDrillableRoles:!0,ignoreMin:!0})}));n<s.length;n++)for(var l=s[n].getCondition(),p=0,u=t;p<u.length;p++){var c=u[p],d=l&&l[c],m=void 0,m=d?{min:h.max(d.min,0),max:h.min(d.max,1/0)}:{min:0,max:1/0};(v=i[c]).min=Math.min(m.min,v.min),v.max=Math.max(m.max,v.max)}for(var v,f=0,g=_.values(i);f<g.length;f++)(v=g[f]).min=Math.min(v.min,v.max);return i},f.prototype.getNonLatLongRoles=function(){var e=this.getLatLongRoleNames();return this.getFilteredRoleNames(e)},f.prototype.getFilteredRoleNames=function(e){for(var t=this.capabilities.dataViewMappings,r=[],i=0,a=t;i<a.length;i++){var o=a[i];o.categorical&&n.visitCategoricalCategories(o.categorical.categories,{visitRole:function(e){r.push(e)}}),o.matrix&&n.visitMatrixRows(o.matrix.rows,{visitRole:function(e){r.push(e)}})}return _.without.apply(_,__spreadArray([_.uniq(r)],e||[]))},f.prototype.getLatLongRoleNames=function(){return this.getRoleNames(u)},f.prototype.getCartesianGroupingOrMeasureRoleNames=function(){return this.getRoleNames(d)},f.prototype.getRoleNames=function(e){return _.chain(this.capabilities.dataRoles).filter(e).map((function(e){return e.name})).value()},f.prototype.hasPreferredTypes=function(){return _.some(this.capabilities.dataRoles,(function(e){return!_.isEmpty(e.preferredTypes)}))},f.prototype.validateDuplicateColumnsInRole=function(e,t,r,i){if(!e.noDuplicates)return!0;var a=e.name,e=r.projections;if(e&&e[a]){var o;return!(i?(i=e[a].getFieldParameters(),i=_.map(i,(function(e){return e.expr})),_.some(i,(function(e){return s.equals(t,e)}))):(a=e[a].all(),a=_.map(a,(function(e){return e.queryRef})),o=r&&r.defn&&r.defn.select(),a=_.map(a,(function(e){return o.withName(e).expr})),_.some(a,(function(e){return s.equals(t,e)}))))}return!0},f);function f(e,t,r,i){this.capabilities=e,this.roles=t,this.objectDescs=r,this.roleMappings=i}var g=(C.prototype.getCondition=function(){return this.condition},C.prototype.checkRoleCompatibility=function(e,t,r){if(e.projections,e.metadata,e.metadata){var i=this.roles.withName(t);return i&&(e.isFieldParameter||this.exprIsCompatible(i,e.metadata,o.getPropertyCount(t,e.projections)+1,e.preferDrillableRoles)&&this.projectionsAreCompatible({projections:e.projections,roleNames:_.without(r,t),preferDrillableRoles:e.preferDrillableRoles,ignoreMin:!1}))?i:void 0}},C.prototype.getValueType=function(e,t){return!e||null!=e.categoryString||null!=(t=t&&this.geoTaggingService.getFieldType(t))&&(e=v.fromPrimitiveTypeAndCategory(e.primitiveType,t)),e},C.prototype.projectionsAreCompatible=function(e){e.projections,e.roleNames;for(var t=0,r=e.roleNames;t<r.length;t++){var i=r[t],a=this.roles.withName(i);if(!a)return!1;i=o.getPropertyCount(i,e.projections);if(!this.isCardinalityValid({count:i,roleName:a.name,preferDrillableRoles:e.preferDrillableRoles,ignoreMin:e.ignoreMin}))return!1}return!0},C.prototype.exprIsCompatible=function(e,t,r,i){if(!this.isCardinalityValid({count:r,roleName:e.name,preferDrillableRoles:i,ignoreMin:!1}))return!1;i=e.kind;if(1===t.kind){if(i===a.VisualDataRoleKind.Grouping)return!1}else if(i===a.VisualDataRoleKind.Measure)return!1;i=e.requiredTypes;return!(i&&!v.isCompatibleTo(t.type,i))&&!(null!==(t=null===(t=t.type)||void 0===t?void 0:t.misc)&&void 0!==t&&t.sparkline&&!e.supportsSparklines)},C.prototype.isRoleDrillable=function(e){return _.includes(this.drillableRoles,e)&&(!this.condition[e]||void 0===this.condition[e].max||1===this.condition[e].max)},C.prototype.isCardinalityValid=function(e){if(!this.condition||e.preferDrillableRoles&&this.isRoleDrillable(e.roleName))return!0;var t=this.condition[e.roleName];return!t||null==o.validateRange(e.count,t,e.ignoreMin)},C);function C(e,t,r,i){this.roles=e,this.geoTaggingService=t,this.condition=i,this.drillableRoles=r}var x=(b.prototype.withName=function(e){return i.findItemWithName(this.defns,e)},b.prototype.allRolesWithPreference=function(t,r,i,e,a){var o=this,n=_.map(this.defns,(function(e){return e.name}));return a?this.promoteAndPenalize(n,(function(e){return o.getRoleWeight(a,e)})):this.promoteAndPenalize(n,(function(e){return o.getTypeWeightForRole(t,e.preferredTypes)}),e),this.promoteAndPenalize(n,(function(e){return o.getProjectionWeightForRole(e,r,i)})),n},b.prototype.promoteAndPenalize=function(e,t,r){for(var i=0,a=0,o=this.defns;a<o.length;a++){var n=o[a],s=t(n);null!=s&&(n=e.splice(e.indexOf(n.name),1)[0],s!==b.penalize||r?s===b.promote&&e.splice(i++,0,n):e.push(n))}},b.prototype.getRoleWeight=function(e,t){return e.kind===t.kind||this.hasCommonTypes(e.requiredTypes,t.requiredTypes)||this.hasCommonTypes(e.requiredTypes,t.preferredTypes)||this.hasCommonTypes(e.preferredTypes,t.requiredTypes)||this.hasCommonTypes(e.preferredTypes,t.preferredTypes)?b.promote:b.penalize},b.prototype.hasCommonTypes=function(e,t){return!_.isEmpty(e)&&!_.isEmpty(t)&&!_.isEmpty(_.intersectionWith(e,t,_.isEqual))},b.prototype.getTypeWeightForRole=function(e,t){if(t){for(var r=b.penalize,i=0,a=t;i<a.length;i++){var o=a[i];if(e===v.fromDescriptor(o).extendedType){r=b.promote;break}}return r}},b.prototype.getProjectionWeightForRole=function(e,t,r){t=t[e.name];return!r&&t&&e.kind!==S.VisualDataRoleKind.Measure||r&&e.kind===S.VisualDataRoleKind.Measure?b.penalize:void 0},b.penalize=-1,b.promote=1,b);function b(e){this.defns=e}return{create:function(e,t){if(e&&!_.isEmpty(e.dataRoles)){for(var r=e.dataViewMappings,i=new x(e.dataRoles),a=[],o=0,n=r;o<n.length;o++){var s=n[o].conditions;if(_.isEmpty(s))a.push(new g(i,t,c.getDrillableRoles(e)));else for(var l=0,p=s;l<p.length;l++){var u=p[l];a.push(new g(i,t,c.getDrillableRoles(e),u))}}return new m(e,i,e.objects,a)}},dataRoleWrapper:function(e){return new x(e)},isValueTypeDescriptorLatLong:p,isRoleCompatibleWithLatLong:u,isRoleCompatibleWithScatterXY:d}}})(powerbi=powerbi||{}),(function(c){var e;(function(e){var r=jsCommon.PerfTimer,i=c.visuals.plugins,o=c.data.segmentation.DataViewMerger,a=c.data.WindowExpansionState,n=c.data.WindowExpansionStateBuilder,s=(t.prototype.endsBeforeNode=function(e){this.hierarchyLastNodeIndex;for(var t=this.hierarchyLastNodeIndex,r=Math.min(t.length,e.length),i=0;i<r;i++){var a=t[i],o=e[i];if(a<o)return!0;if(o<a)return!1}return e.length>t.length},t);function t(e,t,r){this.index=e,this.restartToken=t,r&&(this.hierarchyLastNodeIndex=r)}e.DataSegment=s,e.createExploreVisualDataProxyService=function(e,t,r,i,a){return new l(e,t,r,i,a=void 0===a?!1:a)};var l=(p.prototype.generateQuery=function(e){var t=r.start("visualQueryGenerator("+e.config.visualType+")"),e=e.visualQueryGenerator.execute({config:e.config,dataSources:e.dataSources,schema:e.schema,additionalFilters:e.hostServices.getFilters(this.filterGenerator,e.schema),restartToken:this.getRestartToken(e),cacheResponseOnServer:!(!e.isInitialLoad&&!e.cacheResponseOnServer),allowResultFromClientCache:e.allowResultFromClientCache,dataWindow:e.viewport,cacheOptions:e.cacheOptions,dataSourceVariables:e.hostServices.getDataSourceVariables(),performanceActivity:e.performanceActivity,executionMetricsKind:e.executionMetricsKind,telemetryV2Enabled:this.telemetryV2Enabled,requestPriority:e.requestPriority,applicationContext:e.applicationContext,windowExpansion:this.getWindowExpansion(e),disableAnchorTime:!!e.hostServices.disableAnchorTime||e.config.visualType===i.qnaVisual.name,drillableRoles:e.drillableRoles});return t(),e},p.prototype.getSegmentRestartToken=function(e){if(!(e<=0))return this.dataSegments.length,this.dataSegments[e-1].restartToken},p.prototype.runQuery=function(t){var r=this;t.config,1!==t.executionType||t.preferCurrentData;var e=this.promiseFactory.defer(this.telemetryV2Enabled),i=_.last(this.dataSegments),i=i&&i.restartToken;if(1!==t.executionType||i){var a=t.generatedQuery||this.generateQuery(t);if(a)if(t.additionalDataViewKinds&&(a.options.kinds|=t.additionalDataViewKinds),a.error)e.reject(a.error),this.generatedQuery=void 0;else{if(!(this.generatedQuery&&this.hasExecutedQuery&&t.preferCurrentData&&c.data.areEquivalentOptions(a.options,this.generatedQuery.options))){if(a=this.ensureRestartToken(t,a),this.shouldDelayExecution(t,a))return this.resolveEmptyResult(a,e),c.createRejectablePromise2(e);a.options.isColdLoad=u(t.performanceActivity);var o=this.dataProxy.execute(a.options);return o.then((function(e){return r.handleQueryResult(e,a,o,t.config.query)}),(function(e){throw r.generatedQuery=void 0,e}))}this.generatedQuery=a,e.resolve(null)}else this.generatedQuery=void 0,e.reject()}else e.reject();return c.createRejectablePromise2(e)},p.prototype.cancelQuery=function(e){this.dataProxy.cancelQuery(e)},p.prototype.ensureRestartToken=function(e,t){return 1!==e.executionType&&(this.dataSegments=[],e.preferCurrentData&&(t=this.generateQuery(e),e.additionalDataViewKinds&&(t.options.kinds|=e.additionalDataViewKinds))),t},p.prototype.getRestartToken=function(e){var t=this.dataSegments.length-1;return e.preferCurrentData?this.getSegmentRestartToken(t):1===e.executionType?this.getSegmentRestartToken(1+t):void 0},p.prototype.getWindowExpansion=function(e){if(e.config&&e.config.query&&e.config.query.expansionStates){var t=e.config.visualType,t=this.visualPluginService.capabilities(t);if(_.some(t.dataViewMappings,(function(e){return e&&e.matrix&&e.matrix.rows&&e.matrix.rows.dataReductionAlgorithm&&e.matrix.rows.dataReductionAlgorithm.topNPerLevel}))){t=this.windowExpansionState;return(3===e.executionType&&(e.windowExpansionState,t=e.windowExpansionState),e.windowExpansionTransform)?e.windowExpansionTransform(t):(_.size(e.config.query.expansionStates),a.mergeWithExpansionState(_.first(e.config.query.expansionStates),t,e.config.query.defn.select(),e.schema))}e.executionType}},p.prototype.shouldDelayExecution=function(e,t){return!t.options.query.command||t.deferred&&1!==e.executionType&&2!==e.executionType},p.prototype.resolveEmptyResult=function(e,t){this.generatedQuery=e,this.hasExecutedQuery=!1,t.resolve({dataReaderResult:{dataView:{metadata:{columns:[]}}}})},p.prototype.handleQueryResult=function(e,t,r,i){return this.hasExecutedQuery=!0,this.generatedQuery=t,r.matchesLastExecuteQuery&&(e=this.rewriteQueryResultWithoutPerformanceActivities(e)),this.addNewDataSegment(e&&e.dataReaderResult),this.addWindowExpansionState(t,i,e&&e.dataReaderResult),e},p.prototype.addWindowExpansionState=function(e,t,r){1===_.size(e.compiledMappings)&&e.compiledMappings[0].matrix&&e.compiledMappings[0].matrix.rows&&e.compiledMappings[0].matrix.rows.dataReductionAlgorithm&&e.compiledMappings[0].matrix.rows.dataReductionAlgorithm.topNPerLevel?(_.size(t.expansionStates),this.windowExpansionState=n.fromDataview(r.dataView)):this.windowExpansionState=null},p.prototype.addNewDataSegment=function(e){var t=e&&e.restartToken,r=e&&e.dataView,i=r&&r.matrix&&r.matrix.rows&&r.matrix.rows.root,e=this.dataSegments.length,a=_.isEmpty(i&&i.children)?new s(e,t):(a=void 0,a=(r=_.last(this.dataSegments))?(r.hierarchyLastNodeIndex,_.clone(r.hierarchyLastNodeIndex)):[],o.updateTreeLastNodeIndex(i,a),r&&r.endsBeforeNode(a),new s(e,t,a));this.dataSegments.push(a)},p.prototype.rewriteQueryResultWithoutPerformanceActivities=function(e){if(e&&e.dataReaderResult&&e.dataReaderResult.performanceActivities){var t=__assign({},e.dataReaderResult);return delete t.performanceActivities,__assign(__assign({},e),{dataReaderResult:t})}return e},p.prototype.canLoadMore=function(){var e=_.last(this.dataSegments);return null!=e&&null!=e.restartToken},p.prototype.lastExecutedQuery=function(){return this.generatedQuery},p.prototype.getNodeSegment=function(t){return _.some(this.dataSegments,(function(e){return _.isEmpty(e.hierarchyLastNodeIndex)})),_.find(this.dataSegments,(function(e){return!e.endsBeforeNode(t)}))},p.prototype.discardSegmentsFrom=function(e){this.dataSegments.length,this.dataSegments.length=e},p.prototype.getLastNodeIndex=function(){if(!_.isEmpty(this.dataSegments))return _.last(this.dataSegments).hierarchyLastNodeIndex},p.prototype.getSecondToLastNodeIndex=function(){if(this.dataSegments&&!(this.dataSegments.length<2))return __spreadArray([],this.dataSegments[this.dataSegments.length-2].hierarchyLastNodeIndex)},p);function p(e,t,r,i,a){this.hasExecutedQuery=!0,this.dataProxy=e,this.promiseFactory=r,this.filterGenerator=t,this.dataSegments=[],this.telemetryV2Enabled=a,this.visualPluginService=i}function u(e){e=contextActivity.getAncestorActivityPropertiesOfEvent((function(e){return"Open Report"===e.name}),e);return e&&e.includesBootstrap}e.isColdLoad=u})((e=c.explore||(c.explore={})).services||(e.services={}))})(powerbi=powerbi||{}),(function(L){var q;(function(e){var n=L.data.CacheOptions,J=jsCommon.ArrayExtensions,i=L.ClientErrorStrings,v=L.data.CompiledDataViewMapping,I=L.data.DataBoundObjectQueryExtender,x=L.data.DataReaderUtils,b=L.explore.contracts.DataSource,c=L.DataViewAnalysis.DataViewMappingMatchErrorCode,f=L.data.DataViewObjectDefinitions,r=L.data.DataViewObjectDescriptors,d=L.data.services.DataViewObjectSerializer,m=L.data.FieldExprPattern,a=L.data.FilterKindDetector,g=L.data.DataViewObjectDefinitions.isObjectPropertySQExpr,h=L.data.DataViewObjectDefinitions.isObjectPropertySQExprWithContext,s=L.data.PrimitiveValueEncoding,o=L.data.RelativeDateFilterPattern,y=L.data.ScalarKeyUtils,C=L.data.Selector,l=L.data.SemanticFilter,p=L.data.SemanticQuery,Y=L.data.SQExpr,S=L.data.SQExprBuilder,E=L.data.SQExprConverter,t=L.data.SQExprRewriter,Z=L.data.SQExprUtils,u=jsCommon.StringExtensions,N=q.util.VisualContainerUtils,V=L.data.WindowExpansionState;e.createVisualQueryGenerator=function(e){return e.dataReaders,e.displayNameService,e.plugin,e.pluginOps,e.sortService,e.aggrOps,e.filterGenerator,e.featureSwitchService,e.transformPluginService,e.telemetryService,e.visualTimeSynchronizationService,new P(e.dataReaders,e.displayNameService,e.plugin,e.pluginOps,e.sortService,e.filterGenerator,e.aggrOps,e.featureSwitchService,e.transformPluginService,e.telemetryService,e.visualTimeSynchronizationService,e.visualQueryCapabilitiesService,e.cachePolicyProviderService,e.localizationService)};var O,P=(w.prototype.shouldExecute=function(e,t){if(!e||_.isEmpty(t)||q.contracts.VisualContainer.isHidden(e))return!1;var r=e.visualType,i=this.visualPluginService.capabilities(r);if(!i||this.pluginOps.isQueryDisabled(r,i))return!1;if(!this.getQueryGenerator(t,e))return!1;if(null!=e.query)return this.pluginOps.isQueryVisual(r)&&!this.pluginOps.isAnalysisVisual(r);e=A(e,i),i=[e.visual];return i.push(e.visualContainer),!_.isEmpty(i)&&I.needsToExtend(p.create(),i)},w.prototype.execute=function(e){var t;e.performanceActivity&&e.performanceActivity.isRunning()&&(t=e.performanceActivity.createChildActivity({name:"Query Generation"}));var r=e.config,i=e.dataSources;if(!_.isEmpty(i)){var a=x.findTypes(i,r.query&&r.query.defn);if(!_.isEmpty(a)){var o=this.getAnchorTimeQueryOptions(e.cacheOptions,!e.disableAnchorTime,e.additionalFilters,e.config),n=o.anchorTime,s=o.cacheOptions,l=o.relativeTimeError;if(l)return{options:null,error:l};var p=this.dataReaders.queryGenerator(a),u=this.getCompileMappingsResult(r,r&&r.visualType,e.schema,p,e.additionalFilters,e.dataViewMappingsOverride,e.performanceActivity),c=this.dataReaders.queryExtensionLookup(i);if(u){if(u.error)return{options:null,error:u.error};var d=u.compiled;if(d){if(d.query&&d.query.defn&&!_.isEmpty(d.query.defn.select())&&!_.isEmpty(d.query.defn.transforms()))for(var m={},v=0,f=d.query.defn.select();v<f.length;v++){var g=f[v];Y.isTransformOutputRoleRef(g.expr)||(m[g.name]=g)}var h=this.getVisualCapabilities(e.config.visualType),y=w.compileFilters(e.additionalFilters,h),C=this.generateQuery(p,e.schema,d,h.dataRoles,r.queryOptions&&r.queryOptions.keepProjectionOrder,h.filterMappings,y.dataFilter,y.highlightFilter,e.restartToken,e.dataWindow,e.dataSourceVariables,null,c,e.executionMetricsKind,h.noDefaultProjections,this.getWindowExpansionState(r,e.windowExpansion,e.schema),n),o=C.result,l=C.query,i=C.resolvedQuery,c=e.additionalFilters?e.additionalFilters.queryRefsForSingleItemDrillFilters:void 0,n=this.dataReaders.readerType(a);if(n){a=b.queried(e.dataSources,i);x.uniqueReaderTypes(a).length;s={type:n,query:{dataSources:b.dataReaderDataSources(a),command:o.command,cacheOptions:s,cacheResponseOnServer:e.cacheResponseOnServer,allowResultFromClientCache:e.allowResultFromClientCache,allowClientSideFilters:this.getAllowClientSideFiltersOrDefault(e,h),ignoreViewportForCache:e.ignoreViewportForCache,performanceActivity:e.performanceActivity,applicationContext:e.applicationContext},perfId:e.config.visualType};s.kinds=this.pluginOps.targetedDataViewKinds(e.config.visualType,l);d=(function(v,f,g,h,e,t,y,C,x,r,i,a,b,o,n,s,S,l,E,N,p){var u=l?l.dataFilter:null,V={},P=Z.buildExprEvaluationContext(e.defn.from());i&&(V.objects=i,b&&_.some(b,(function(e){return e.selectExprReplaced}))&&((i=new $(e.defn,b,i,P)).rewrite(),V.objects=i.rewrittenObjects));a&&(V.splits=a);_.isEmpty(e.expansionStates)||(V.expansionStates=e.expansionStates);var w,n={options:v,transforms:V,warnings:o,compiledMappings:n,deferred:E},e=(function(e,t){if(_.isEmpty(t))return{queryForTransformActions:e,internalToPublicSelectNameMappingsByRole:{}};for(var r=e.clone(),i=0,a=t;i<a.length;i++){var o,n,s=a[i];s.selectExprAdded?(o=r.defn.select(),n=s.selectExprAdded,o.length,n.selectIndex,o[n.selectIndex]=n.namedSQExpr,r.defn=r.defn.select(o)):s.projectionQueryRefChanged?(n=s.projectionQueryRefChanged,r.projections[n.role].replaceQueryRef(n.oldQueryRef,n.newInternalQueryRef)):s.aggregatesAdded||s.selectExprReplaced||JSON.stringify(s)}t=_.reduce(t,(function(e,t){var r=t.projectionQueryRefChanged;return r&&((t=e[r.role])||(e[r.role]=t={}),t[r.newInternalQueryRef]=r.oldQueryRef),e}),{});return{queryForTransformActions:r,internalToPublicSelectNameMappingsByRole:t}})(e,b),T=e.queryForTransformActions,F=e.internalToPublicSelectNameMappingsByRole,j=T.defn.select(),R=T.defn.orderBy(),c=T.projections;if(u){var e=u.where(),d=Z.buildExprEvaluationContext(u.from());if(_.some(e,(function(e){return e.condition&&!_.isEmpty(e.condition.validate(f,C,void 0,d))})))return n.error=new re("Broken_Filters",r),n}if(n.filterContext={dataFilters:l.dataFiltersUnmerged,highlightFilters:l.highlightFilter,highlightFiltersUnmerged:l.highlightFiltersUnmerged,query:t},c){var m,D=[],A={},I=void 0;for(m in c){var O=A[m]=[],k=c[m];_.isEmpty(k.activeProjectionRefs)||((I=I||{})[m]=_.map(k.activeProjectionRefs,(function(e){return{queryRef:e}})));for(var M=0,B=k.all();M<B.length;M++){var U=B[M],z=J.indexWithName(j,U.queryRef);D.push({queryRef:U.queryRef,format:U.format,queryIndex:z,roleName:m,displayName:U.displayName}),O.push(z)}}V.selects=[];for(var L=[],t=T.defn.transforms(),q=!_.isEmpty(t),G=function(e,t){var r,i=(n=D,r=e,_.chain(n).compact().filter((function(e){return e.queryIndex===r})).value()),a=j[e],o=S&&S[a.name];if(!q||o){o&&(a=o);var n=Z.buildExprEvaluationContext(T.defn.from());if(!_.isEmpty(a.expr.validate(f,C,void 0,n)))return L.push(a.expr),"continue";var e=a.expr.getMetadata(f,P),s={type:e.type,expr:a.expr};!Z.isMeasure(a.expr)&&(_.isEmpty(v.query.command)||E||x.keepAllMetadataColumns)&&(s.identityExprs=g.produceIdentities(a.expr,f));o=Z.getKpiMetadata(a.expr,f);o&&(s.kpi=o);n=(function(e,t){if(t)for(var r=0,i=t;r<i.length;r++){var a=i[r].projectionQueryRefChanged;if(a)if(a.newInternalQueryRef===e)return a.oldQueryRef}return e})(a.name,b),o=_.find(i,(function(e){return e.queryRef===a.name&&e.displayName}));s.displayName=o?o.displayName:y.getDisplayName(a.expr,f,x,n,h);n=i[0];!n||(c=n.format||e.format)&&(s.format=c)}else s={expr:a.expr,displayName:a.name};s.roles||(s.roles={});for(var l=0,p=i;l<p.length;l++){var u=p[l];u&&u.roleName&&(s.roles[u.roleName]=!0)}w=a.name,s.queryName=_.chain(Object.keys(s.roles)).map((function(e){return F[e]&&F[e][w]})).filter(_.isString).value()[0]||w;var c=_.find(N,(function(e){return e.queryName===s.queryName}));_.isEmpty(null==c?void 0:c.relatedProjectionsQueryName)||(s.relatedSelects=_.map(c.relatedProjectionsQueryName,(function(e){return{queryName:e}})));var d,c=(i=R,d=a.expr,_.findIndex(i,(function(e){return Y.equals(e.expr,d)})));-1!==c&&(i=R[c],s.sort=i.direction,s.sortOrder=c);c=Z.getDefaultValue(a.expr,f);c&&(s.defaultValue={value:c},m=a.expr.getKeyColumns(f),s.defaultValue.identityFieldsValues=Z.getDefaultValues(m,f)),1===Z.getAggregateBehavior(a.expr,f)&&(s.discourageAggregationAcrossGroups=!0);var m=Z.getParameterMetadata(a.expr,f);m&&(s.parameter=m),V.selects.push(s)},Q=0,H=j.length;Q<H;Q++)G(Q);if(b)for(var W=0,X=b;W<X.length;W++){var K=X[W];K.aggregatesAdded&&(function(e,t){for(var r=0,i=e;r<i.length;r++){var a=i[r];if(a.queryName===t.originalQueryRef){var o={},n=t.aggregates;n.min&&(o.min=ee(n.min)),n.max&&(o.max=ee(n.max)),a.aggregateSources=o;break}}var s=t.aggregates;te(e,s.min),te(e,s.max)})(V.selects,K.aggregatesAdded)}V.roles={ordering:A,drillableRoles:p},I&&(V.roles.activeItems=I,(function(e,t){var e=e&&e.roles,r=e&&e.activeItems;if(r)for(var i in r)for(var i=r[i],a=0,o=i;a<o.length;a++){var n=o[a];n.suppressConcat=_.includes(t,n.queryRef)}})(V,s)),n.error=re.create(L,f,r)}return n})(s,e.schema,p,r.columnProperties,l,i,this.displayNames,this.aggrOps,h,this.localizationService,d.objectDefinitions,o.splits,o.queryRewrites,u.warnings,d.mappings,c,m,y,C.deferred,d.additionalProjections,e.drillableRoles);return t&&t.resolve(),d.options.query&&(d.options.query.telemetryV2Enabled=e.telemetryV2Enabled,null!=e.requestPriority&&(d.options.query.requestPriority=e.requestPriority)),d}}}}}},w.prototype.getCompiledDataViewMapping=function(e){var t=e.config,r=this.getQueryGenerator(e.dataSources,t);if(r){r=this.getCompileMappingsResult(t,t&&t.visualType,e.schema,r);if(r&&!r.error)return r.compiled.mappings}},w.prototype.getAnchorTimeQueryOptions=function(e,t,r,i){var a,o=!(null===(o=this.visualQueryCapabilitiesService)||void 0===o||!o.getCapabilities().disableAnchorTime),i=t&&this.hasRelativeTimeFilters(r,i),e=e;return o&&i?{anchorTime:null,cacheOptions:e,relativeTimeError:new re("NoSupportRTS_PublishToWeb",this.localizationService)}:(i&&(e=this.cachePolicyProviderService?this.cachePolicyProviderService.getRelativeTimeFilterQueryPolicy():n.AllowQuery,a=this.visualTimeSynchronizationService.getAnchorTime(),a=s.toTypeEncoded(a,L.ValueType.fromExtendedType(519))),{anchorTime:a,cacheOptions:e,relativeTimeError:null})},w.prototype.hasRelativeTimeFilters=function(e,t){return!(!e||!o.hasRelativeTimeFilter(e.dataFilter))||!!t&&!!t.query&&!!t.query.defn&&o.hasRelativeTimeFilter(t.query.defn)},w.prototype.executeForFlattenedQuery=function(e,t){var r=e.config,i=this.getQueryGenerator(e.dataSources,r);if(i){var a=this.getCompileMappingsResult(r,r&&r.visualType,e.schema,i,e.additionalFilters,e.dataViewMappingsOverride,e.performanceActivity);if(a&&!a.error){var o=a.compiled;if(o){var n=this.getVisualCapabilities(e.config.visualType),a=w.compileFilters(e.additionalFilters,n);return this.generateFlattenedQuery(i,e.schema,o,n.dataRoles,r.queryOptions&&r.queryOptions.keepProjectionOrder,n.filterMappings,a.dataFilter,a.highlightFilter,e.restartToken,e.dataWindow,e.dataSourceVariables,t,n.noDefaultProjections,e.windowExpansion)}}}},w.prototype.getQueryGenerator=function(e,t){if(!_.isEmpty(e)){t=t.query,t=x.findTypes(e,t&&t.defn);if(t)return this.dataReaders.queryGenerator(t)}},w.prototype.getVisualCapabilities=function(e){if(e){e=this.visualPluginService.getPlugin(e);return e&&e.capabilities}},w.prototype.getCompileMappingsResult=function(e,t,r,i,a,o,n){if(e&&t&&r){var s=this.visualPluginService.getPlugin(t);if(s){var l=this.getVisualCapabilities(t),p=o||l.dataViewMappings,u=e.query,c=l.sorting?l.sorting.implicit:null,d=u?N.createRoleKindByQueryRef(u):{};if(p&&u){var m=L.DataViewAnalysis.chooseDataViewMappings(u.projections,p,d,this.featureSwitchService.featureSwitches,l.objects,e.objects,u.defn.select(),r);if(!m.supportedMappings){o=M(s,m.mappingErrors,this.localizationService,this.featureSwitchService);if(o)return{error:o,compiled:null};var v,f=L.data.QueryProjectionsByRole.clone(u.projections);for(v in f){var g=f[v];g.activeProjectionRefs=_.map(g.activeProjectionRefs,(function(e){return"select"+L.obfuscate(e)}));for(var h=0,y=g.all();h<y.length;h++)y[h]?g.assignProjection({queryRef:"select"+L.obfuscate(y[h].queryRef)},h):g.assignProjection(null,h)}o=new re("ClientError_NoSupportedDataViewMappingFound",this.localizationService);return o.addDebugInfo("VisualType",t),o.addDebugInfo("QueryProjectionsByRole",JSON.stringify(f)),this.telemetryService.logEvent(L.telemetry.EXVisualQueryGeneratorError,{code:t,debugInfo:JSON.stringify(o.getDetails(this.localizationService).debugErrorInfo)}),{error:o,compiled:null}}m=this.compileMappingsWithProperties(t,r,u,m.supportedMappings,d,l.dataRoles,l,e.queryOptions,e.columnProperties,A(e,l),a,s.customizeQuery,c,i)}else var C=A(e,l),m=this.compileNoMappingsWithProperties(r,u,d,p,l.dataRoles,C,a);C=[];if(m){if(m.error)return{error:m.error,compiled:null};C.push.apply(C,B.validateAndAdjustRolesIfNecessary(m.mappings,m.query,r,this.displayNames,l)||[]),C.push.apply(C,U.validateAndAdjustHighlightIfNecessary(a)||[]),m.warnings&&C.push.apply(C,m.warnings||[]);for(var x=this.telemetryService.getOpenActivityById(n&&n.getProperty("telemetryActivityId")),b=0,S=C;b<S.length;b++){var E=S[b];this.telemetryService.logChildEvent(x&&x.event,L.telemetry.EXVisualQueryGeneratorWarning,{code:E.code})}}return{compiled:m,warnings:C}}}},w.compileFilters=function(e,t){var r,i,a,o;return e&&(i=e.dataFilter,a=e.dataFiltersUnmerged,r=e.highlightFilter,o=e.highlightFiltersUnmerged),r&&t.supportsHighlight,{dataFilter:i,dataFiltersUnmerged:a,highlightFilter:r,highlightFiltersUnmerged:o}},w.prototype.getAllowClientSideFiltersOrDefault=function(e,t){return _.isBoolean(e.allowClientSideFilters)?e.allowClientSideFilters:!!r.findSelfFilter(t.objects)},w.prototype.compileMappingsWithProperties=function(e,t,r,i,a,o,n,s,l,p,u,c,d,m){r=q.TransformGeneratorUtils.addTransforms(p.visual.objects,i,r,this.transformPluginService,n);var v=L.data.compileDataView({mappings:i,queryDefn:r.defn,queryProjections:r.projections,schema:t,objectDescriptors:p.visual.descriptors,objectDefinitions:p.visual.objects,roles:o,featureSwitches:this.featureSwitchService.featureSwitches,transformPluginService:this.transformPluginService});if(this.hasMappedColumnsInHierarchySlicer(e,v))return{error:new re("DQP_No_MappedColumns_In_HierarchySlicers",this.localizationService),query:void 0,mappings:void 0,additionalProjections:void 0,objectDefinitions:void 0};if(c){n=this.getSorts(v),i=this.featureSwitchService.featureSwitches,i=c({dataViewMappings:v,scopedAggregates:i.scopedAggregates,cartesianMultiples:i.cartesianMultiples});if(i&&i.error){var f=i.error.code;return{error:k(this.localizationService.get(f),f),query:void 0,mappings:void 0,additionalProjections:void 0,objectDefinitions:void 0}}if(!_.isEmpty(r.expansionStates)){var g=[];v.length;f=v[0].matrix;!f||(P=f.rows).for&&(g=_.map(P.for.in.items,(function(e){return e})));for(var h=0,y=r.expansionStates;h<y.length;h++){var C=y[h];if(!_.isEmpty(C.root.children))for(var x=0,b=C.levels.length;x<b;x++)for(var S=C.levels[x],E=0,N=g;E<N.length;E++){var V=N[E];V.queryName===S.queryRefs[0]&&2!==V.subtotalType&&(V.subtotalType=1)}}}var P=this.getSorts(v);r=this.updateSorts(r,n,P)}!(function(e,t,r){for(var i=0,a=e;i<a.length;i++){var o=a[i];t&&!1===t.allowBinnedLineSample&&(function(e){e=e.categorical;e&&e.dataReductionAlgorithm&&e.dataReductionAlgorithm.binnedLineSample&&(e.dataReductionAlgorithm=void 0,e.categories&&(e.categories.dataReductionAlgorithm={sample:{}}),!e.values||(e=e.values).group&&(e.group.dataReductionAlgorithm={top:{}}))})(o),t&&!1===t.allowOverlappingPointsSample&&(function(e){var t=e.categorical,e=e.matrix;{var r;t&&t.dataReductionAlgorithm&&t.dataReductionAlgorithm.overlappingPointsSample?(r=t.dataReductionAlgorithm.overlappingPointsSample.count,t.dataReductionAlgorithm={sample:{}},r&&(t.dataReductionAlgorithm.sample.count=r)):e&&e.rows&&e.rows.dataReductionAlgorithm&&e.rows.dataReductionAlgorithm.overlappingPointsSample&&(r=e.rows.dataReductionAlgorithm.overlappingPointsSample.count,e.rows.dataReductionAlgorithm={sample:{}},r&&(e.rows.dataReductionAlgorithm.sample.count=r))}})(o),(function(e){return _.every(e.schemas,(function(e){return e.capabilities&&e.capabilities.supportsTopNPerLevel}))})(r)||(function(e){var t=e.matrix;t&&t.rows&&t.rows.dataReductionAlgorithm&&t.rows.dataReductionAlgorithm.topNPerLevel&&(e=t.rows.dataReductionAlgorithm.topNPerLevel.fallbackTopCount,t.rows.dataReductionAlgorithm={top:{}},e&&(t.rows.dataReductionAlgorithm.top.count=e))})(o)}})(v,s,t),r=q.TransformGeneratorUtils.removeUnsupportedTransforms(this.transformPluginService,r,v),r=this.sortService.applyImplicitSort(r,d),r=this.sortService.ensureValidSorting({query:r,schema:t,visualType:e,columnProperties:l,compiledMappings:v});e=O.setProperties(t,v,r,p.visual.objects,p.visual.descriptors),l=e.modifiedObjectDefinitions,e=e.addedScalarKeys,l=this.setFilteredToUniqueValueProperties(u,m,t,v,r,l);p.visual.objects=l;l=this.getQueryRefsByRole(r,o),o=[p.visual];p.visualContainer&&o.push(p.visualContainer);u=I.extend(r.defn,t,o,l,r.projections,a,u&&u.dataFilter,!0);if(u){for(var w=new q.contracts.VisualQuery(u.queryDefn,r.projections,r.expansionStates),T=u.additionalProjections,F=u.warnings,j=0,R=e;j<R.length;j++){var D=R[j],A=w.defn.selectNameOf(D.expr);D.roleItem.scalarKeyInfo||(D.roleItem.scalarKeyInfo={}),D.roleItem.scalarKeyInfo.scalarKeyQueryName=A}p.visual=this.addDefaultFormatStringsForDataBoundProperties(p.visual,t,Z.buildExprEvaluationContext(r.defn.from())),p.visual=this.rewriteObjectDefinitions(u.objectDefinitionRewrites,p.visual)}return{query:w||r,mappings:v,additionalProjections:T,warnings:F,objectDefinitions:p.visual.objects}},w.prototype.addDefaultFormatStringsForDataBoundProperties=function(e,t,r){var i={};for(u in e.objects){var a=e.descriptors[u];if(a)for(var o=0,n=e.objects[u];o<n.length;o++)for(d in(c=n[o]).properties){var s=a.properties[d];if(s&&s.formatStringProperty){var l=c.properties[d],p=void 0;if(g(l))p=l;else{if(!h(l))continue;p=l.value}f.getValue(e.objects,s.formatStringProperty,c.selector)||(!(l=p.getMetadata(t,r))||!l.type&&!l.format||(l=null!==(p=l.format)&&void 0!==p?p:L.visuals.valueFormatter.getDefaultFormatString(l.type))&&f.setValue(i,s.formatStringProperty,c.selector,S.text(l)))}}}if(!_.isEmpty(i))for(var u in e.objects=f.clone(e.objects),i)for(var c,d,m=0,v=i[u];m<v.length;m++)for(d in(c=v[m]).properties)f.setValue(e.objects,{objectName:u,propertyName:d},c.selector,c.properties[d]);return e},w.prototype.hasMappedColumnsInHierarchySlicer=function(e,t){if(e!==L.visuals.plugins.slicer.name)return!1;for(var r=0,i=t;r<i.length;r++){var a=i[r],a=null===(a=null==a?void 0:a.metadata)||void 0===a?void 0:a.columns;if(1!==(null==a?void 0:a.length)&&_.some(a,(function(e){return 1===(null===(e=null==e?void 0:e.parameter)||void 0===e?void 0:e.kind)})))return!0}return!1},w.prototype.rewriteObjectDefinitions=function(e,t){if(!_.isEmpty(e)){t.objects=f.clone(t.objects);for(var r=0,i=e;r<i.length;r++){var a,o=i[r];for(a in t.objects)for(var n=0,s=t.objects[a];n<s.length;n++){var l=s[n];if(C.equals(l.selector,o.selector))for(var p in l.properties){var u=l.properties[p],c=void 0;if(g(u))c=u;else{if(!h(u))continue;c=u.value}Y.equals(c,o.from)&&(l.properties[p]=o.to)}}}}return t},w.prototype.getSorts=function(e){for(var t=[],r=0,i=e;r<i.length;r++){for(var a=[],o=0,n=i[r].metadata.columns;o<n.length;o++){var s=n[o];s.sort&&a.push({queryName:s.queryName,sort:s.sort,sortOrder:s.sortOrder})}t.push(a)}return t},w.prototype.updateSorts=function(e,t,r){if(_.isEqual(t,r))return e;for(var i=[],a=e.defn.select(),o=0,n=r;o<n.length;o++)for(var s=n[o],l=0,p=_.sortBy(s,(function(e){return e.sortOrder}));l<p.length;l++){var u=p[l],c=a.withName(u.queryName);i.push({direction:u.sort,expr:c.expr})}return new q.contracts.VisualQuery(e.defn.orderBy(i),e.projections,e.expansionStates)},w.prototype.getQueryRefsByRole=function(t,e){var r={};if(_.isEmpty(e))return r;for(var i=0,a=e;i<a.length;i++){var o=a[i],n=t.tryGetExprs(o.name);r[o.name]=_.map(n,(function(e){return t.defn.selectNameOf(e)}))}return r},w.prototype.setFilteredToUniqueValueProperties=function(e,o,n,t,r,s){var l=this;if(!e||!e.dataFilter)return s;for(var p,u=r.defn.select(),c=e.dataFilter.where(),d=e.queryRefsForSingleItemDrillFilters,i=0,a=t;i<a.length;i++){var m=a[i];m&&m.categorical&&m.categorical.categories&&v.visitCategoricalCategories(m.categorical.categories,{visitRole:function(e){if(!_.isEmpty(e.items))for(var t=0,r=e.items;t<r.length;t++){var i=r[t],a=i.queryName;i.filteredToUniqueValueProperty&&_.includes(d,a)&&(a=u.withName(a),(a=l.isColumnFilteredToUniqueValue(a.expr,c,n,o))&&(p=p||(s?f.clone(s):{}),l.setFilteredToUniqueValueProperty(a,i,p)))}}})}return p||s},w.prototype.isColumnFilteredToUniqueValue=function(e,r,t,i){if(!i||!i.hasAmbiguousEqualitySemantics)return!0;t=e.getKeyColumns(t);return _.every(t,(function(t){return _.some(r,(function(e){e=q.FilterUtils.getFilterValuesForColumn(t,e);if(1===_.size(e)){e=e[0];if(Y.isConstant(e)&&!i.hasAmbiguousEqualitySemantics(e))return!0}return!1}))}))},w.prototype.setFilteredToUniqueValueProperty=function(e,t,r){var i=t.filteredToUniqueValueProperty,e=S.boolean(e),t={metadata:t.queryName};f.setValue(r,i,t,e)},w.prototype.compileNoMappingsWithProperties=function(e,t,r,i,a,o,n){if(!t&&_.isEmpty(i)){t=new q.contracts.VisualQuery(p.create(),{},[]);var s=this.getQueryRefsByRole(t,a),i=[o.visual];i.push(o.visualContainer);s=I.extend(t.defn,e,i,s,t.projections,r,n&&n.dataFilter,!0);if(s){r=new q.contracts.VisualQuery(s.queryDefn,t.projections,t.expansionStates),n=s.additionalProjections,a=L.data.compileDataView({mappings:[{table:{rows:{for:{in:"*"}}}}],queryDefn:t.defn,queryProjections:t.projections,schema:e,objectDescriptors:o.visual.descriptors,objectDefinitions:o.visual.objects,roles:a,featureSwitches:this.featureSwitchService.featureSwitches,transformPluginService:this.transformPluginService});return o.visual=this.addDefaultFormatStringsForDataBoundProperties(o.visual,e,Z.buildExprEvaluationContext(t.defn.from())),o.visual=this.rewriteObjectDefinitions(s.objectDefinitionRewrites,o.visual),{query:r||t,mappings:a,additionalProjections:n,warnings:s.warnings,objectDefinitions:o.visual.objects}}}},w.prototype.generateQuery=function(e,t,r,i,a,o,n,s,l,p,u,c,d,m,v,f,g){g=this.getQueryGeneratorOptions(t,r,i,a,o,n,s,l,p,u,c,d,m,v,f,g),e=e.execute(g);return{result:e,query:r.query,resolvedQuery:g.query,deferred:e.deferred}},w.prototype.generateFlattenedQuery=function(e,t,r,i,a,o,n,s,l,p,u,c,d,m){m=this.getQueryGeneratorOptions(t,r,i,a,o,n,s,l,p,u,c,void 0,void 0,d,m);return e.executeForQueryOnly?e.executeForQueryOnly(m):m.query},w.prototype.getQueryGeneratorOptions=function(e,t,r,i,a,o,n,s,l,p,u,c,d,m,v,f){var g=t.query,o=this.filterGenerator.resolveFilterTargets(e,g,r,a,o),r=(function(e){var t=e.orderBy();if(_.isEmpty(t))return e;for(var r=!1,i=0,a=t;i<a.length;i++){var o=a[i];Y.isSparklineData(o.expr)&&(o.expr=o.expr.measure,r=!0)}return r?e.orderBy(t):e})(r=q.TransformGeneratorUtils.rewriteTransform(this.transformPluginService,o,g.projections,r,this.getQueryRefsByRole(t.query,r),t.additionalProjections,t.mappings)),e=new F(e,t.mappings,r);return r=r.rewrite(e),{query:u?u(r):r,queryExtensionLookup:c,mappings:t.mappings,additionalProjections:t.additionalProjections,highlightFilter:n,restartToken:s,dataWindow:l,highVolumeOverride:this.featureSwitchService&&this.featureSwitchService.featureSwitches.highVolume,expansionStates:t.query.expansionStates,dataSourceVariables:p,executionMetricsKinds:d,keepProjectionOrder:i,noDefaultProjections:m,windowExpansion:v,anchorTime:f}},w.prototype.getWindowExpansionState=function(e,t,r){var i=this.visualPluginService.capabilities(e.visualType);if(_.some(i.dataViewMappings,(function(e){return e&&e.matrix&&e.matrix.rows&&e.matrix.rows.dataReductionAlgorithm&&e.matrix.rows.dataReductionAlgorithm.topNPerLevel})))return t||(_.size(e.query.expansionStates),V.mergeWithExpansionState(_.first(e.query.expansionStates),void 0,e.query.defn.select(),r))},w);function w(e,t,r,i,a,o,n,s,l,p,u,c,d,m){this.dataReaders=e,this.displayNames=t,this.visualPluginService=r,this.pluginOps=i,this.sortService=a,this.filterGenerator=o,this.aggrOps=n,this.featureSwitchService=s,this.transformPluginService=l,this.telemetryService=p,this.visualTimeSynchronizationService=u,this.visualQueryCapabilitiesService=c,this.cachePolicyProviderService=d,this.localizationService=m}(O||(O={})).setProperties=function(o,e,n,s,l){for(var p,u=[],t=0,r=e;t<r.length;t++){var i=r[t];v.visitMapping(i,{visitRole:function(e){if(e.items)for(var t=0,r=e.items;t<r.length;t++){var i,a=r[t];a.scalarKeyInfo&&a.scalarKeyInfo.scalarKeyMinProperty&&(p=p||(s?(i=d.serializeObjects(s,l),d.deserializeObjects(i,l)):{}),u.push(function(e,t,r,i){var a=r.scalarKeyInfo.scalarKeyMinProperty;L.contract.check(r.scalarKeyInfo.hasScalarKey,"Scalar key requested when not available");t=t.defn.select().withName(r.queryName).expr,t=S.aggregate(y.getScalarKeyExpr(t,e),3),e=r.scalarKeyInfo.selector;return f.setValue(i,a,e,t),{roleItem:r,expr:t}}(o,n,a,p)))}}})}return{modifiedObjectDefinitions:p||s,addedScalarKeys:u}};var T,F=(__extends(j,T=t),j.prototype.visitSparklineData=function(t){_.size(t.grouping);var e,r,i=this.pointsPerSparkline+1,a=t.grouping[0];Y.isHierarchyLevel(a)&&(null==(r=null==(r=a.getMetadata(this.schema))?void 0:r.type)||!r.temporal||(o=L.data.ScalarKeyUtils.getScalarKeyExpr(a,this.schema))&&(e=S.aggregate(o,3)));for(var o=_.find(this.query.select(),(function(e){return Y.equals(e.expr,t)})),n=o.name,s=!1,l=0,p=this.compiledMappings;l<p.length;l++){var u=p[l];v.visitMapping(u,{visitRole:function(e){var e=_.find(e.items,(function(e){return e.queryName===n}));null!==(e=null==e?void 0:e.sparklineInfo)&&void 0!==e&&e.includeMinGroupingInterval&&(s=!0)}})}return S.sparklineData(t.measure,t.grouping,e,i,s)},j);function j(e,t,r){var i=T.call(this)||this;return i.schema=e,i.compiledMappings=t,i.query=r,i.pointsPerSparkline=52,i}var R,$=(__extends(D,R=t),D.prototype.rewrite=function(){for(var e in this.objects)for(var t=0;t<this.objects[e].length;t++){var r=this.objects[e][t];if(r.selector){r=r.selector,r=C.toScopeIdentities(r);if(!_.isEmpty(r)){this.rewrittenObjects||(this.rewrittenObjects=f.clone(this.objects));for(var i=0,a=r;i<a.length;i++){var o=a[i].expr;this.rewrittenObjects[e][t].selector={data:[L.data.createDataViewScopeIdentity(o.accept(this))]}}}}}},D.prototype.visitSelectRef=function(e){var t=e.expressionName,t=this.query.select().withName(t),r=t.expr;t&&Y.isColumn(t.expr)&&Y.isSubqueryRef(t.expr.source)&&(r=Z.getSubqueryExpression(t.expr,this.context));t=_.find(this.queryRewrites,(function(e){return e.selectExprReplaced&&Y.equals(e.selectExprReplaced.originalExpr,r)}));return t?t.selectExprReplaced.replacedExpr:e},D);function D(e,t,r,i){var a=R.call(this)||this;return a.query=e,a.queryRewrites=t,a.objects=r,a.context=i,a}function ee(e){return{index:e.index}}function te(e,t){var r;t&&(e[r=t.index]||(e[r]={displayName:"",queryName:t.queryName,expr:t.expr}))}function k(e,t){return{code:t,getDetails:function(){return{displayableErrorInfo:[],message:e}}}}function A(e,t){return{visual:{objects:e.objects,descriptors:t.objects},visualContainer:{objects:e.vcObjects,descriptors:q.contracts.VisualContainer.CommonObjectDescriptors}}}function M(e,t,r,i){var a,o,n,s,l,p=[];switch(e.name){case L.visuals.plugins.map.name:case L.visuals.plugins.azureMap.name:a=(function(e){var t=_.some(e,(function(e){return"Category"===e.roleName&&e.code===c.conditionRangeTooLarge})),r=_.some(e,(function(e){return"X"===e.roleName&&e.code===c.conditionKindExpectedGrouping})),e=_.some(e,(function(e){return"Y"===e.roleName&&e.code===c.conditionKindExpectedGrouping}));{if(t)return"DataViewMappingError_LocationAndLatLongGroup";if(r||e)return"DataViewMappingError_LatLongAggregateWithNoLocation"}})(t);break;case L.visuals.plugins.scatterChart.name:o=t,n=i,s=_.some(o,(function(e){return e.roleName===L.visuals.scatterRoleNames.category&&e.code===c.conditionRangeTooLarge})),l=_.some(o,(function(e){return e.roleName===L.visuals.scatterRoleNames.play&&e.code===c.conditionRangeTooLarge})),o=_.some(o,(function(e){return e.roleName===L.visuals.scatterRoleNames.x&&(e.code===c.conditionKindExpectedGrouping||e.code===c.conditionKindExpectedMeasure)})),a=s?n.featureSwitches.useModernFormatPane?"DataViewMappingError_ScatterGroupingValues":"DataViewMappingError_ScatterGroupingDetails":l?"DataViewMappingError_ScatterGroupingPlayAxis":o?"DataViewMappingError_ScatterXMismatchType":void 0}if(!a&&!_.isEmpty(t)){var u=t[0];switch(u.code){case c.conditionRangeTooLarge:a="DataViewMappingError_ConditionRangeTooLarge";break;case c.conditionRangeTooSmall:a="DataViewMappingError_ConditionRangeTooSmall";break;case c.conditionKindExpectedMeasure:a="DataViewMappingError_ConditionKindExpectedMeasure";break;case c.conditionKindExpectedGrouping:a="DataViewMappingError_ConditionKindExpectedGrouping";break;case c.conditionNotHierarchicallyRelated:return new re(a="DataViewMappingError_ConditionNotHierarchicallyRelated",r);case c.conditionSchemaCapabilities_TupleFilters_InstanceFilters:a="DataViewMappingError_ConditionSchemaCapabilities_TupleFilters";break;case c.conditionKindExpectedGroupingOrMeasure:break;default:u.code}p=[u.roleName]}if(a)return k(r.format(a,p),a)}e.getDataViewMappingErrorFromFailures=M;var B,U,re=(z.create=function(e,t,r){if(!_.isEmpty(e)){for(var i=[],a=function(e,t){return e.hierarchy?e.hierarchy.name:e.hierarchyLevel?e.hierarchyLevel.name+"."+e.hierarchyLevel.level:t},o=0,n=e;o<n.length;o++){var s=n[o],l=E.asFieldPattern(s),s=void 0;if(l.sparklineData){var p=l.sparklineData.measure;_.size(l.sparklineData.grouping);var u=_.first(l.sparklineData.grouping),p=a(p,m.getPropertyName(p)),u=a(u,m.getPropertyName(u)),s=r.format("VisualTitle_By_Template",p,u)}else{p=m.toFieldExprEntityItemPattern(l);if(!p)continue;u=a(l,m.getPropertyName(l));s="("+p.entity+") "+u;l=t.schema(p.schema),u=l&&l.findProperty(p.entity,u);u&&u.errorMessage&&(s+=": "+u.errorMessage)}i.push(s)}return new z("Missing_References",r,i.join(", "))}},Object.defineProperty(z.prototype,"code",{get:function(){return this.errorCode},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"source",{get:function(){return this.errorSource},enumerable:!1,configurable:!0}),z.prototype.addDebugInfo=function(e,t){this.debugErrorInfo||(this.debugErrorInfo=[]),this.debugErrorInfo.push({errorInfoKey:e,errorInfoValue:t})},z.prototype.getDetails=function(e){var t=e.get(this.displayableErrorInfo[0].errorInfoKey),r=this.displayableErrorInfo[0].errorInfoValue;return this.detailsMessageFormat&&(r=u.format(e.get(this.detailsMessageFormat),r)),{message:e.get(this.messageId),displayableErrorInfo:[{errorInfoKey:t,errorInfoValue:r}],debugErrorInfo:(r=[{errorInfoKey:i.ClientErrorCode,errorInfoValue:this.code}]).concat.apply(r,this.debugErrorInfo||[]),hideErrorHelperText:this.hideErrorHelperText,hideDebugInfo:this.hideDebugInfo,helpLink:this.helperLink}},z);function z(e,t,r){this.localizationService=t,this.messageId="VisualContainer_FailedToLoadVisual",this.displayableErrorInfo=[{errorInfoKey:"",errorInfoValue:""}],this.errorCode=e,this.hideErrorHelperText=!1,"Missing_References"===e?(this.displayableErrorInfo[0].errorInfoKey="Missing_References_Details_Title",this.displayableErrorInfo[0].errorInfoValue=r,this.detailsMessageFormat="Missing_References_Details_Message",this.messageId="Missing_References_Message",this.errorSource="User"):"Broken_Filters"===e?(this.displayableErrorInfo[0].errorInfoKey="ServiceError_CannotLoadVisual",this.displayableErrorInfo[0].errorInfoValue=this.localizationService.get("Broken_Filters_Details_Message"),this.messageId="Broken_Filters_Message"):"ClientError_NoSupportedDataViewMappingFound"===e?(this.displayableErrorInfo[0].errorInfoKey="VisualDisplayError_Title",this.displayableErrorInfo[0].errorInfoValue=this.localizationService.get("ClientError_NoSupportedDataViewMappingFound_Message"),this.messageId="ClientError_NoSupportedDataViewMappingFound_Message"):"NoSupportRTS_PublishToWeb"===e?(this.displayableErrorInfo[0].errorInfoKey="VisualContainer_UnableToFindVisualKey",this.displayableErrorInfo[0].errorInfoValue=this.localizationService.get("NoSupportRTS_PublishToWeb_Message"),this.messageId="NoSupportRTS_PublishToWeb_Title",this.errorSource="User",this.hideErrorHelperText=!0):"DQP_No_MappedColumns_In_HierarchySlicers"===e?(this.displayableErrorInfo[0].errorInfoKey="VisualContainer_FailedToLoadVisual",this.displayableErrorInfo[0].errorInfoValue=this.localizationService.get("DQP_No_MappedColumns_In_HierarchySlicers"),this.errorSource="User",this.hideErrorHelperText=!0,this.hideDebugInfo=!0,this.helperLink="https://go.microsoft.com/fwlink/?linkid=2139315"):"DataViewMappingError_ConditionNotHierarchicallyRelated"===e&&(this.messageId="DataViewMappingError_ConditionNotHierarchicallyRelated",this.displayableErrorInfo[0].errorInfoKey="VisualContainer_FailedToLoadVisual",this.displayableErrorInfo[0].errorInfoValue=this.localizationService.get("DataViewMappingError_ConditionNotHierarchicallyRelated_Details"),this.errorSource="User",this.hideErrorHelperText=!0,this.hideDebugInfo=!0,this.helperLink="https://go.microsoft.com/fwlink/?linkid=2114278")}e.VisualQueryClientError=re,(function(){(B||(B={})).validateAndAdjustRolesIfNecessary=function(e,t,r,i,a){for(var o=new p(t.defn,r,i,a),n=0,s=e;n<s.length;n++){var l=s[n];v.visitMapping(l,o)}return o.warnings};var p=(e.prototype.visitRole=function(e){e.showAll&&0<this.incompatibleExprInfo.length&&(e.showAll=!1,this.warnings.push(new t(this.incompatibleExprInfo)))},e);function e(e,t,r,i){this.displayNameService=r,this.incompatibleExprInfo=[];for(var a=0,o=e.select();a<o.length;a++){var n=o[a],s=E.asFieldPattern(n.expr);s&&s.percentOfGrandTotal&&this.incompatibleExprInfo.push({basePropertyName:m.getPropertyName(s),fieldDisplayName:this.displayNameService.getQualifiedDisplayName(n.expr,t,i)})}this.warnings=[]}var t=(Object.defineProperty(r.prototype,"code",{get:function(){return"ShowAllDiabledWarning"},enumerable:!1,configurable:!0}),r.prototype.getDetails=function(e){var t=e.get("ShowAllDisabledWarning_Value"),r=_.map(this.errorInfos,(function(e){return e.fieldDisplayName})).join(", ");return{message:e.get("ShowAllDisabledWarning_Message"),displayableErrorInfo:[{errorInfoKey:e.get("ShowAllDiabledWarning_ErrorInfoKey"),errorInfoValue:u.format(t,r)}]}},r);function r(e){this.errorInfos=e}})(),(function(){(U||(U={})).validateAndAdjustHighlightIfNecessary=function(e){if(e&&e.highlightFilter){var t=e.highlightFilter.where(),r=_.find(t,(function(e){return 3===a.runDetector(e.condition)})),t=_.find(t,(function(e){return Y.isExists(e.condition)}));if(r||t)return e.dataFilter=e.dataFilter?l.merge([e.dataFilter,e.highlightFilter]):e.highlightFilter,e.highlightFilter=void 0,[new i(r?0:1)]}};var i=(Object.defineProperty(e.prototype,"code",{get:function(){switch(this.highlightDisableType){case 0:return"HighlightWithTOPNDisabledWarning";case 1:return"HighlightWithExistsFiltersDisabledWarning"}},enumerable:!1,configurable:!0}),e.prototype.getDetails=function(e){var t=0===this.highlightDisableType,r=t?"HighlightWithTOPNDisabledWarning_ErrorInfoKey":"HighlightWithExistFiltersDisabledWarning_ErrorInfoKey",i=t?"HighlightWithTOPNDisabledWarning_Value":"HighlightWithExistFiltersDisabledWarning_Value";return{message:e.get(t?"HighlightWithTOPNDisabledWarning_Message":"HighlightWithExistFiltersDisabledWarning_Message"),displayableErrorInfo:[{errorInfoKey:e.get(r),errorInfoValue:e.get(i)}]}},e);function e(e){this.highlightDisableType=e}})()})((q=L.explore||(L.explore={})).services||(q.services={}))})(powerbi=powerbi||{}),(function(s){var i;(function(e){var a=s.visuals.plugins,n=i.util.VisualContainerUtils;e.createVisualRelationshipService=function(e,t,r,i,a){return new o(e,t,r,i,a)};var o=(t.prototype.relationship=function(e,t,r){return this.getRelationship(e.relationships,t,r)},t.prototype.drillRelationship=function(e,t,r){t=this.getRelationship(e.relationships,t,r);if(t){r=t;return r=2===t.type?{source:t.source,target:t.target,type:1}:r}},t.prototype.getRelationship=function(e,t,r){return _.find(e,(function(e){return e.source.name===t.name&&e.target.name===r.name}))},t.prototype.getIsCrossHighlightingDisabled=function(){var e=this.explorationNavigationService&&this.explorationNavigationService.getCurrentExploration(),e=e&&e.slowDataSourceSettings;return e&&e.isCrossHighlightingDisabled},t.prototype.relationshipFilterAction=function(e,t,r,i){e=this.relationship(e,t,r);return this.getRelationshipFilterAction(e,t,r,i)},t.prototype.drillRelationshipFilterAction=function(e,t,r,i){if(!t.drillFilterOtherVisuals)return 3;e=this.drillRelationship(e,t,r);e&&e.type;i=this.getRelationshipFilterAction(e,t,r,i);return i},t.prototype.shouldApplyCrossDrill=function(e,t,r,i){if(t===r)return!1;if(n.getVisualType(r)===a.slicer.name)return!1;i=this.drillRelationshipFilterAction(e,t,r,i);if(1===i)return!0;if(0===i&&1===this.defaultDrillFilterAction(t,r))return!0;return!1},t.prototype.getRelationshipFilterAction=function(e,t,r,i){if(e&&this.supportsFilterActionTarget(t,r,e.type))return e.type;var a=r&&r.config&&r.config.singleVisual,o=a&&r.config.singleVisual.visualType,e=this.visualPluginService.capabilities(o);if(this.getIsCrossHighlightingDisabled()&&!this.isSlicer(e,o)){var n=t&&t.config&&t.config.singleVisual,r=n&&t.config.singleVisual.visualType,t=this.visualPluginService.capabilities(r);if(!this.isFilter(t,r,n&&n.objects))return 3}if(e){n=a.query;if(n){o=this.visualPluginService.getPlugin(o);if(o&&o.isCrossFilteredByDefault){a=a.objects,e={mappings:e.dataViewMappings,queryDefn:n.defn,queryProjections:n.projections,schema:i,objectDescriptors:e.objects,objectDefinitions:a,roles:e.dataRoles,featureSwitches:this.featureSwitchService.featureSwitches,transformPluginService:s.data.transforms.createTransformPluginService()},e=s.data.compileDataView(e);if(o.isCrossFilteredByDefault({dataViewMappings:e}))return 3}}}return 0},t.prototype.isSlicer=function(e,t){return!!i.FilterUtils.tryGetFilterPropertyIdentifier(e,t,this.visualPluginService)},t.prototype.isFilter=function(e,t,r){return e?this.isSlicer(e,t):null!=i.FilterUtils.tryGetFilterProperty(e,t,this.visualPluginService,r)},t.prototype.supportsFilterActionTarget=function(e,t,r){var i=n.getVisualType(t),a=n.getVisualType(e);if(!_.isEmpty(a)&&!_.isEmpty(i))switch(r){case 1:case 3:return!0;case 2:var o=this.visualPluginService.capabilities(i);return(!o||o.supportsHighlight)&&!this.visualCapabilitiesService.hasFilterCapabilities(a)}return!1},t.prototype.supportsAnyFilterAction=function(e){e=n.getVisualType(e);if(_.isEmpty(e)||!this.pluginOps.isQueryVisual(e)&&!this.pluginOps.isQnaVisual(e))return!1;e=this.visualPluginService.capabilities(e);return!e||!1!==e.supportsSelection},t.prototype.defaultFilterAction=function(e,t){var r=this.explorationNavigationService&&this.explorationNavigationService.getCurrentExploration(),r=r&&r.settings;return r&&!!r.defaultFilterActionIsDataFilter||!this.supportsFilterActionTarget(e,t,2)?this.supportsFilterActionTarget(e,t,1)?1:void 0:2},t.prototype.defaultDrillFilterAction=function(e,t){t=this.defaultFilterAction(e,t);return t=2===t?1:t},t);function t(e,t,r,i,a){this.visualPluginService=e,this.pluginOps=t,this.explorationNavigationService=r,this.featureSwitchService=i,this.visualCapabilitiesService=a}})((i=s.explore||(s.explore={})).services||(i.services={}))})(powerbi=powerbi||{}),(function(r){!(function(e){var n;function t(e){this.visualPlugins=e,this.collectedFilters=[]}e=e.services||(e.services={}),n=r.explore.util.VisualContainerUtils,t.prototype.collectFilters=function(e,t,r){if(!_.isEmpty(e))for(var i=0,a=e;i<a.length;i++){var o=a[i];o&&o.filter&&this.collectFilter(o.filter,o,r,t)}},t.prototype.collectFiltersForFilterContainer=function(e,t,r,i){if(e)for(var a=0,o=e;a<o.length;a++){var n=o[a];n.filter&&n!==r&&this.collectFilter(n.filter,n,i,t)}},t.prototype.collectFilter=function(e,t,r,i,a){var o;e&&(r&&(o=n.getVisualCapabilities(r,this.visualPlugins)),this.collectedFilters.push({filter:e,filterContainer:t,sourceVisualContainer:r,sourceVisualContainerCapabilities:o,scopeType:i,collectedFilterSource:a}))},t.prototype.getCollectedFilters=function(){return this.collectedFilters},e.FilterCollector=t})(r.explore||(r.explore={}))})(powerbi=powerbi||{}),(function(p){var v;(function(t){var e=jsCommon.ArrayExtensions,c=p.explore.contracts.CollectedFilterSource,r=p.data.SemanticFilter,i=p.data.services.SemanticQuerySerializer,a=p.data.SubqueryRewriter,o=p.data.TopNFilterPruner,n=v.util.VisualContainerUtils;function u(e,t,r,i,a,o,n){var s={filter:e,scope:t,filterExpressionMetadata:n};if(r)s.restatement=r.restatement,s.type=r.type,s.isHidden=!!r.isHiddenInViewMode,s.filterExpressionMetadata=r.expression?{expressions:[r.expression]}:void 0,s.displayName=r.displayName,r.cachedValueItems&&s.filterExpressionMetadata?s.filterExpressionMetadata.cachedValueItems=m(r.cachedValueItems,0):r.filterExpressionMetadata&&(s.filterExpressionMetadata=r.filterExpressionMetadata);else if(i&&v.FilterUtils.supportsFilterOutput(a)&&i.config.singleVisual.query){r=i.config.singleVisual.query.defn.select(),a=i.config.singleVisual.cachedFilterDisplayItems,i=i.config.singleVisual.filterExpressionMetadata;if(1<=r.length&&a&&o===c.Slicer)s.filterExpressionMetadata={expressions:[r[0].expr],cachedValueItems:m(a,0)};else if(i)s.filterExpressionMetadata=i;else{s.filterExpressionMetadata={expressions:[]};for(var l=0,p=r;l<p.length;l++){var u=p[l];s.filterExpressionMetadata.expressions.push(u.expr)}}}return s}function d(e){if(null!=e){var t={Restatement:e.restatement,type:e.type};return e.expression&&(t.expression=i.serializeExpr(e.expression)),t}}function m(e,t){for(var r=[],i=0,a=e;i<a.length;i++){var o=a[i],n={identities:[o.identity],valueMap:{}};n.valueMap[t]=o.displayName,r.push(n)}return r}t.toFilterData=u,t.generateSingleFilterMetadata=d,t.generateFilterMetadata=function(e){if(!_.isEmpty(e)){for(var t=[],r=0,i=e;r<i.length;r++){var a=i[r];t.push(d(a))}return t}};var s=(l.prototype.setSelectorFilter=function(e){this.selectorFilter,this.selectorFilter=e,this.shouldPruneUnnecessaryFilters=!0},l.prototype.addDrillFilter=function(e){this.drillFilters=this.drillFilters||[],this.drillFilters.push(e)},l.prototype.addVisualFilter=function(e){this.visualSemanticQuery&&(e.filter=a.rewriteSubqueriesForContainingQuery(e.filter,this.visualSemanticQuery)),this.visualFilters=this.visualFilters||[],this.visualFilters.push(e),this.needToEnsurePrecedence=!0,this.shouldPruneUnnecessaryFilters=!0},l.prototype.addDrillthroughFilter=function(e){this.drillthroughFilters=this.drillthroughFilters||[],this.drillthroughFilters.push(e),this.needToEnsurePrecedence=!0},l.prototype.addSectionFilter=function(e){this.sectionFilters=this.sectionFilters||[],this.sectionFilters.push(e),this.needToEnsurePrecedence=!0},l.prototype.addReportFilter=function(e){this.reportFilters=this.reportFilters||[],this.reportFilters.push(e),this.needToEnsurePrecedence=!0},l.prototype.addCrossFilter=function(e){this.crossFilters=this.crossFilters||[],this.crossFilters.push(e),this.needToEnsurePrecedence=!0},l.prototype.addHighlight=function(e){this.highlightFilters=this.highlightFilters||[],this.highlightFilters.push(e)},l.prototype.addCollectedFilters=function(e,t,r){for(var i=0,a=e;i<a.length;i++){var o,n=a[i],s=n.filter,l=n.filterContainer,p=n.sourceVisualContainer;r&&!r(s,l,p)||(o=l,n.filterContainer&&n.filterContainer===this.filterContainer&&(o=null),p=u(s,n.scopeType,o,p,n.sourceVisualContainerCapabilities,n.collectedFilterSource),!l||2!==l.howCreated&&0!==l.precedence?n.sourceVisualContainer?n.sourceVisualContainer===this.visualContainer?this.addVisualFilter(p):this.addCrossFilter(p):5===l.howCreated?this.addDrillthroughFilter(p):1===n.scopeType?this.addSectionFilter(p):2===n.scopeType?this.addReportFilter(p):n.filterContainer&&n.filterContainer===this.filterContainer&&this.addVisualFilter(p):this.addDrillFilter(p),t&&l&&(this.metadata=this.metadata||[],this.metadata.push(d(l))))}},l.prototype.mergeHighlightFiltersBasedOnRelationship=function(e,t,r){var i=this;switch(t){case 0:case 2:if(!r){_.each(e,(function(e){return i.addHighlight(e)}));break}case 1:e&&_.each(e,(function(e){return i.addCrossFilter(e)}))}},l.prototype.getFilters=function(e){var t=this.getFilterData(e),e=this.highlightFilters&&r.merge(this.highlightFilters.map((function(e){return e.filter})));return{dataFilter:t?r.merge(_.map(t,(function(e){return e.filter}))):void 0,dataFiltersUnmerged:t,highlightFilter:e,highlightFiltersUnmerged:this.highlightFilters,filterMetadata:this.metadata}},l.prototype.getFilterData=function(e){if(this.selectorFilter,this.pruneUnnecessaryFilters(),e||this.ensurePrecedence(),this.drillFilters||this.sectionFilters||this.reportFilters||this.visualFilters||this.crossFilters||this.drillthroughFilters){var t=this.drillFilters||[],r=this.visualFilters||[],i=this.sectionFilters||[],a=this.drillthroughFilters||[],o=this.reportFilters||[],e=this.crossFilters||[];return t.concat(r).concat(e).concat(i).concat(a).concat(o)}},l.prototype.getCrossHighlightFilters=function(){if(this.pruneUnnecessaryFilters(),this.ensurePrecedence(),this.selectorFilter||this.visualFilters){var e=this.selectorFilter?[this.selectorFilter]:[],t=this.visualFilters||[];return e.concat(t)}},l.prototype.getHighlightFilters=function(){return this.highlightFilters},l.prototype.clearHighlightFilters=function(){this.highlightFilters=void 0},l.prototype.getUnmergedDrillCrossFilter=function(){return this.pruneUnnecessaryFilters(),this.ensurePrecedence(),this.drillFilters},l.prototype.getCrossFilters=function(){return this.crossFilters},l.prototype.ensurePrecedence=function(){var e;this.needToEnsurePrecedence&&(this.visualFilters&&(e={visualFilters:this.visualFilters,crossFilters:this.crossFilters,reportFilters:this.reportFilters,drillThroughFilters:this.drillthroughFilters,sectionFilters:this.sectionFilters},this.visualFilters=t.FilterPrecedenceResolver.resolve(e)),this.needToEnsurePrecedence=!1)},l.prototype.pruneUnnecessaryFilters=function(){var r=this;this.shouldPruneUnnecessaryFilters&&(this.visualFilters&&this.selectorFilter&&this.visualFilters&&this.selectorFilter&&(this.visualFilters=e.filterArray(this.visualFilters,(function(e,t){return e.filter=o.removeUnnecessaryTopNFilters(e.filter,r.selectorFilter.filter),0<e.filter.where().length}))),this.shouldPruneUnnecessaryFilters=!1)},l);function l(e,t){this.visualContainer=e,this.filterContainer=t,!e||(e=n.getVisualQuery(e))&&(this.visualSemanticQuery=e.defn),this.needToEnsurePrecedence=!1,this.shouldPruneUnnecessaryFilters=!1}t.FilterBuilder=s})((v=p.explore||(p.explore={})).services||(v.services={}))})(powerbi=powerbi||{}),(function(d){var m;(function(v){var f=d.data.CacheOptions,t=d.common,o=d.data.segmentation.DataViewMerger,n=d.data.services.DataViewTransformActionsSerializer,r=jsCommon.DateExtensions,a=m.util.ExplorationTelemetryUtil,u=d.data.dsr,l=d.explore.services.generateFilterMetadata,e=d.PbiPromise,s=d.visualHost.ResourcePackageReferenceResolver,i=d.explore.util.ResourcePackageUtils,p=d.visualHost.utils.ResourcePackageUtils,g=m.util.VisualContainerUtils,c=d.explore.util.VisualPerformanceActivityUtil;v.createVisualContainerQueryHandler=function(e,t,r,i,a,o,n,s,l,p,u,c,d,m,v,f,g,h,y,C,x,b,S){return new E(e,t,r,i,a,o,n,s,l,p,u,c,d,m,v,f,g,S,b,h,y,C,x)};var E=(h.prototype.attach=function(e){this.queryExecutionServices=e},h.prototype.cancelQuery=function(e){this.visualDataProxyExecutionService.cancelQuery(e),this.visualParameterService.cancelResolve(e)},h.prototype.generateApplicationContext=function(e,t){var r=this.explorationNavigation&&this.explorationNavigation.getCurrentExploration()&&this.explorationNavigation.getCurrentExploration().report,i=r&&r.objectId;return{DatasetId:r&&r.model&&r.model.dbName,Sources:[{ReportId:i,Operation:e,VisualId:t&&t.name}]}},h.prototype.runQuery=function(t){var e,r=this,i=c.updateParentWithNewLinkingActivity(t.performanceActivity,d.telemetry.EXRunQuery,this.telemetryService),a=t.performanceActivity;this.featureSwitchService.featureSwitches.resolveParametersEvent&&(e=this.startResolveParametersPerformanceActivity(a));var o=this.startQueryPerformanceActivity(a),n=this.dataSources.get(),s=t.contract,l=s.config.singleVisual,p=l.query&&l.query.hasQueryFieldParameters();if(this.visualValidationService.shouldBlockVisualQuery&&this.visualValidationService.shouldBlockVisualQuery(s)||!(t.skipShouldRunQueryVerification||this.visualQueryGenerator.shouldExecute(l,n)||this.visualParameterService.shouldExecute(l,n)))return this.featureSwitchService.featureSwitches.resolveParametersEvent&&this.transitionResolveParametersToQuery(!1,e,o),o&&o.queryActivity.resolve(),i&&i.resolve(),!1;a=o&&o.telemetryActivity;this.queryExecutionServices.notifyStart(a);a=this.resolveQueryParameters(t,e);return(this.visualInsightsAnalysisHandler.supportsInsights(s)?a.then((function(){if(r.featureSwitchService.featureSwitches.resolveParametersEvent&&r.transitionResolveParametersToQuery(!0,e,o),!p||r.visualQueryGenerator.shouldExecute(l,n))return r.visualInsightsAnalysisHandler.runInsights(s).then((function(e){if(e){if(e.error)throw e.error;e.queryExecutionOptions&&_.merge(t,e.queryExecutionOptions)}return r.runQueryImpl(t,n,s,o,e&&e.warnings)}))})):a.then((function(){if(r.featureSwitchService.featureSwitches.resolveParametersEvent&&r.transitionResolveParametersToQuery(!0,e,o),!p||r.visualQueryGenerator.shouldExecute(l,n))return r.runQueryImpl(t,n,s,o,void 0)}))).catch((function(e){r.queryExecutionServices.handleErrors(e,o)})).finally((function(){r.queryExecutionServices.notifyEnd(),i&&i.resolve()})),!0},h.prototype.transitionResolveParametersToQuery=function(e,t,r){t&&(e?(t.resolve(),r&&r.queryActivity.setProperty("start",jsCommon.performance.now())):t.cancel(!0))},h.prototype.resolveQueryParameters=function(i,a){var o=this,n=this.dataSources.get();return this.conceptualSchemaProxy.get(n).then((function(e){var t=o.generateApplicationContext(i.queryOperation,i.contract),r=o.getDatasetCacheOptions(i,n,!1),t={dataSources:n,schema:e,additionalFilters:o.hostServices.getFilters(o.filterGenerator,e),config:i.contract.config.singleVisual,cacheOptions:r,allowResultFromClientCache:i.allowResultFromClientCache,applicationContext:t,cacheResponseOnServer:i.cacheResponseOnServer,visual:i.contract,performanceActivity:a,metricsKind:i.executionMetricsKind};return o.visualParameterService.resolve(t)}))},h.prototype.runQueryImpl=function(a,o,n,s,r){var l=this;!a.initialLoad&&this.hostServices&&this.updateCachedData(a);var p,u=this.getDatasetCacheOptions(a,o,!0),e=a.initialLoad&&this.featureSwitchService.featureSwitches.verboseTelemetry;e&&(p=this.startVisualFirstLoadTelemetryEvent(u,o,n.name,s&&s.telemetryActivity));var t=this.generateApplicationContext(a.queryOperation,n),i=this.visualDataProxyExecutionService.runQuery({dataSources:o,contract:n,viewport:a.viewport,hostServices:this.hostServices,initialLoad:a.initialLoad,useVisualContainerCache:a.useVisualContainerCache,preferCurrentData:a.preferCurrentData,allowResultFromClientCache:a.allowResultFromClientCache,cacheResponseOnServer:a.cacheResponseOnServer,cacheResponseOnContract:a.cacheResponseOnContract,cacheOptions:u,visualFirstLoadEvent:p,performanceActivity:s&&s.queryActivity,executionMetricsKind:a.executionMetricsKind,canDefer:a.canDefer,requestPriority:a.requestPriority,applicationContext:t,windowExpansionTransform:a.windowExpansionTransform,skipShouldRunQueryVerification:a.skipShouldRunQueryVerification,previewGate:a.previewGate}),c=n.config.singleVisual.visualType,t=n.config.singleVisual.objects,d=this.loadResourcePackageReferences(c,t);a.geocodingTracker&&a.geocodingTracker.newQuery(s&&s.rootActivity);var m=!1;return i.previewPromise.then((function(t){t&&!m&&l.resolveResourcePackageReferences(c,t.dataProxyQuery.transforms.objects,s&&s.rootActivity).then((function(e){l.handleQueryResult(n,t.result,t.dataProxyQuery,e,null,null,!0,s,r)}))}),(function(e){e.ignorable})),i.finalPromise.then((function(e){var t=e&&e.result&&e.result.dataReaderResult,r=!!(u&f.AllowCache);t&&r&&p&&(p.event.info.cacheResultFromServer=e.result.dataReaderResult.fromCache);var i=l.getLastRefreshTime(o);if(r&&t&&l.isResultStale(i,e.result.dataReaderResult.timestamp)){t=!!(u&f.PreventRefresh),i=f.AllowQuery|f.CacheResult,i=t?i|f.PreventRefresh:i;return p&&(p.event.info.staleCacheResultFromServer=!0),l.visualDataProxyExecutionService.runQuery({dataSources:o,contract:n,viewport:a.viewport,hostServices:l.hostServices,initialLoad:a.initialLoad,useVisualContainerCache:!1,preferCurrentData:a.preferCurrentData,allowResultFromClientCache:!1,cacheResponseOnServer:!1,cacheOptions:i,visualFirstLoadEvent:p,performanceActivity:s&&s.queryActivity,executionMetricsKind:a.executionMetricsKind,requestPriority:a.requestPriority,canDefer:a.canDefer}).finalPromise}return e})).then((function(e){return d.then((function(){l.processQueryResult(a,e,s,r)}))})).finally((function(){m=!0,e&&p&&p.resolve()}))},h.prototype.startQueryPerformanceActivity=function(e){if(e)return{rootActivity:e,queryActivity:e.createChildActivity({name:"Query"}),telemetryActivity:this.telemetryService.getOpenActivityById(e&&e.getProperty("telemetryActivityId"))}},h.prototype.startResolveParametersPerformanceActivity=function(e){if(e)return e.createChildActivity({name:"Resolve Parameters"})},h.prototype.startVisualFirstLoadTelemetryEvent=function(e,t,r,i){e=!!(e&f.AllowCache),t=g.hasOnPremDataSource(t),r=i?this.telemetryService.startChildEvent(i.event,d.telemetry.EXVisualFirstLoad,{onPrem:t,isServerCacheEligible:e,visualName:r}):this.telemetryService.startEvent(d.telemetry.EXVisualFirstLoad,{onPrem:t,isServerCacheEligible:e,visualName:r});return a.addExplorationInfoToEvent(r.event,this.explorationNavigation),r},h.prototype.getCachedQueryOrGenerate=function(a){return __awaiter(this,void 0,d.Promise,(function(){var t,r,i;return __generator(this,(function(e){switch(e.label){case 0:if(t=c.updateParentWithNewLinkingActivity(a.performanceActivity,d.telemetry.EXGetCachedQueryOrGenerate,this.telemetryService),r=this.dataProxyService.lastExecutedQuery())return this.cachedQueryResult=void 0,[2,r];e.label=1;case 1:return e.trys.push([1,,4,5]),(i=this.cachedQueryResult)?[3,3]:[4,this.generateQuery(a)];case 2:i=e.sent(),e.label=3;case 3:return[2,i];case 4:return t&&t.resolve(),[7];case 5:return[2]}}))}))},h.prototype.generateQuery=function(i){return __awaiter(this,void 0,e,(function(){var t,r;return __generator(this,(function(e){switch(e.label){case 0:return t=this.dataSources.get(),[4,this.conceptualSchemaProxy.get(t)];case 1:return r=e.sent(),r={dataSources:t,schema:r,config:i.contract.config.singleVisual,hostServices:this.hostServices,visualQueryGenerator:this.visualQueryGenerator,executionType:0,preferCurrentData:null==i.preferCurrentData||i.preferCurrentData,viewport:i.viewport,allowResultFromClientCache:null==i.allowResultFromClientCache||i.allowResultFromClientCache,cacheOptions:void 0,performanceActivity:i.performanceActivity,executionMetricsKind:i.executionMetricsKind},r=this.visualDataProxyExecutionService.generateQuery(r),this.dataProxyService.lastExecutedQuery()?this.cachedQueryResult=void 0:this.cachedQueryResult=r,[2,r]}}))}))},h.prototype.updateCachedData=function(a){return __awaiter(this,void 0,d.Promise,(function(){var t,r,i;return __generator(this,(function(e){switch(e.label){case 0:return!1===a.cacheResponseOnContract?[2]:[4,this.generateQuery(__assign(__assign({},a),{performanceActivity:void 0}))];case 1:return(t=e.sent(),r=a.contract,t&&!t.error&&r.cachedData)?(r.cachedData.dataUpdatedTime=void 0,i=this.visualPlugin.capabilities(r.config.singleVisual.visualType),r.cachedData.transformsObject=n.serializeDataViewTransformActions(t.transforms,i.objects),r.cachedData.queryObject=t.options.query.command,r.cachedData.dataObject=void 0,[2]):[2]}}))}))},h.prototype.loadMoreData=function(t){var r=this,e=this.startQueryPerformanceActivity(t.performanceActivity);this.queryExecutionServices.notifyStart(),this.getNextDataSegment(t,e).then((function(e){e&&r.mergeMoreData(e.result,e.dataProxyQuery,t.currentData,e.performanceActivityContext)})).catch((function(){e&&e.queryActivity.reject()})).finally((function(){r.queryExecutionServices.notifyEnd()}))},h.prototype.canLoadMoreData=function(){return this.visualDataProxyExecutionService.canLoadMoreData()},h.prototype.loadWindow=function(t){var r=this,i=this.startQueryPerformanceActivity(t.performanceActivity);this.queryExecutionServices.notifyStart(),this.visualDataProxyExecutionService.loadWindow({dataSources:this.dataSources.get(),contract:t.contract,hostServices:this.hostServices,viewport:t.viewport,useVisualContainerCache:t.useVisualContainerCache,performanceActivity:null==i?void 0:i.queryActivity,executionMetricsKind:t.executionMetricsKind,windowExpansionState:t.windowExpansionState}).then((function(e){r.handleLoadMoreDataWarnings(e&&e.result,e&&e.dataProxyQuery),r.processQueryResult(t,e,i,void 0)})).catch((function(e){r.queryExecutionServices.handleErrors(e),i&&i.queryActivity.reject()})).finally((function(){r.queryExecutionServices.notifyEnd()}))},h.prototype.getNextDataSegment=function(e,t){var r=this,i=t||this.startQueryPerformanceActivity(e.performanceActivity),a=this.promiseFactory.defer();return this.visualDataProxyExecutionService.canLoadMoreData()?this.visualDataProxyExecutionService.loadMoreData({dataSources:this.dataSources.get(),contract:e.contract,hostServices:this.hostServices,viewport:e.viewport,useVisualContainerCache:e.useVisualContainerCache,performanceActivity:null==i?void 0:i.queryActivity,executionMetricsKind:e.executionMetricsKind}).then((function(e){r.handleLoadMoreDataWarnings(e&&e.result,e&&e.dataProxyQuery);var t=e;i&&(t=__assign(__assign({},e),{performanceActivityContext:i})),a.resolve(t)}),(function(e){r.queryExecutionServices.handleErrors(e),i&&i.queryActivity.reject(),a.reject(e)})):(i&&i.queryActivity.reject(),a.reject("Cannot load more data")),a.promise},h.prototype.reloadDataSegment=function(e,t){var r=e.currentData&&e.currentData.dataView&&e.currentData.dataView.matrix&&e.currentData.dataView.matrix.rows&&e.currentData.dataView.matrix.rows.root;r&&(t=this.dataProxyService.getNodeSegment(t))&&0!==t.index?(this.dataProxyService.discardSegmentsFrom(t.index),t=this.dataProxyService.getLastNodeIndex(),o.pruneTree(r,t)?this.loadMoreData(e):this.runQuery(e)):this.runQuery(e)},h.prototype.mergeMoreData=function(e,t,r,i){var a=h.getDataProxyQueryExecutionResultWarnings(e,t),t=e&&e.dataReaderResult?e.dataReaderResult.dataView:null;t?(null!=r&&r.dataView,r=r.dataView,o.mergeDataViews(r,t),e={dataView:r,dataViewSource:e&&e.dataViewSource,performanceActivities:e&&e.dataReaderResult&&e.dataReaderResult.performanceActivities,isFirstSegment:!1},_.isEmpty(a)||(e.warnings=a),this.queryExecutionServices.loadMergedData(e,i)):i&&i.queryActivity.resolve()},h.prototype.visualizeDataViewSource=function(r,i,a,e){var o,n,s=this,l=this.startQueryPerformanceActivity(e),e=r.config.singleVisual,e=this.visualPluginOps.targetedDataViewKinds(e.visualType,e.query),p=u.read(e,i.data,t.utils.getDsrReaderSwitches(this.featureSwitchService.featureSwitches)),e=p.error;e?this.queryExecutionServices.handleErrors(e):(o=this.dataSources.get(),n=r&&r.config&&r.config.singleVisual,o&&n&&this.conceptualSchemaProxy.get(o).then((function(e){var t=s.visualQueryGenerator.execute({config:n,dataSources:o,schema:e,additionalFilters:s.hostServices.getFilters(s.filterGenerator,e),restartToken:p.restartToken,dataWindow:a,dataSourceVariables:s.hostServices.getDataSourceVariables(),disableAnchorTime:!!s.hostServices.disableAnchorTime||s.visualPluginOps.isQnaVisual(n.visualType)});t&&((e=s.promiseFactory.defer()).resolve(t.options),s.handleQueryResult(r,{dataViewSource:i,dataReaderResult:p},{transforms:t.transforms,error:t.error,warnings:t.warnings,options:e.promise},null,{updateContractCache:!0},null,!1,l))})))},h.prototype.updateNonQueryVisual=function(e,t,r){var i,a=this,o=this.startQueryPerformanceActivity(r),n={dataView:null,dataViewSource:null};t?(i=e.config.singleVisual.visualType,e=e.config.singleVisual.objects,this.queryExecutionServices.notifyStart(),this.resolveResourcePackageReferences(i,e,r).then((function(e){a.queryExecutionServices.applyUpdate(n,t,e,o)})).finally((function(){a.queryExecutionServices.notifyEnd()}))):this.queryExecutionServices.applyUpdate(n,t,null,o)},h.prototype.updateContractCache=function(r,e,i){var a=this;if(!r)return this.promiseFactory.reject(null);var t=this.dataSources.get();if(!t)return this.promiseFactory.reject(null);var o=r.cachedData&&r.cachedData.dataUpdatedTime?r.cachedData.dataUpdatedTime:null,n=e&&e.dataViewSource?e.dataViewSource.data:void 0,s=i&&i.error;return e&&e.dataReaderResult&&e.dataReaderResult.disallowPersisting&&(n=o=null,s=new d.IgnorableClientError("VisualContainerQueryHandler.updateContractCache() cachingError")),this.conceptualSchemaProxy.get(t).then((function(t){return i.options.then((function(e){e={transforms:i.transforms,error:s,warnings:i.warnings,options:e,compiledMappings:i.compiledMappings};r.cachedData=g.createCacheEntry(a.visualPlugin,a.displayNameService,n,e,t,r.config.singleVisual,a.featureSwitchService.featureSwitches,l(r.filters),o)}))}))},h.prototype.getLastRefreshTime=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t];if(i&&i.dsr&&i.dsr.lastRefreshTime)return i.dsr.lastRefreshTime}},h.prototype.processQueryResult=function(t,r,i,a){var e,o,n=this;r&&(o={updateContractCache:null===(e=t.cacheResponseOnContract)||void 0===e||e,updateServerCache:r.updateServerVisualContainerCache},this.resolveResourcePackageReferences(t.contract.config.singleVisual.visualType,r.dataProxyQuery.transforms.objects,i&&i.rootActivity).then((function(e){n.handleQueryResult(t.contract,r&&r.result,r.dataProxyQuery,e,o,t.currentData,!1,i,a)})))},h.prototype.isResultStale=function(e,t){e=r.tryDeserializeDate(e),t=r.parseIsoDate(t);return!(!e||!t)&&t<e},h.prototype.getDatasetCacheOptions=function(e,t,r){var i=e.contract.id,a=e.initialLoad,r=this.visualLifecycleService&&this.visualLifecycleService.has(i,r);if(this.featureSwitchService.featureSwitches.expandQueryCaching){if(this.isQueryCachingEnabledForAnyDataset(t))return this.cachePolicyProviderService.getInteractiveQueryPolicy(a&&r,e.interactiveQueryCachingSetting)}else if(a&&r&&this.isQueryCachingEnabledForAnyDataset(t))return f.AllowCache|f.AllowQuery|f.CacheResult},h.prototype.isQueryCachingEnabledForAnyDataset=function(e){return!!_.some(e,(function(e){return e.dsr&&e.dsr.isQueryCachingEnabled}))},h.prototype.handleQueryResult=function(t,e,r,i,a,o,n,s,l){var p,u,c,d,m=this;void 0===a&&(a={}),void 0===n&&(n=!1),this.queryExecutionServices.clearErrors(),e?(c={dataView:e.dataReaderResult?e.dataReaderResult.dataView:null,dataViewSource:e.dataViewSource||null,performanceActivities:e.dataReaderResult?e.dataReaderResult.performanceActivities:null},d=h.getDataProxyQueryExecutionResultWarnings(e,r)||[],l&&(d=_.concat(d,l)),_.isEmpty(d)||(c.warnings=d),(p=g.isSegment(c.dataView))&&(c.isFirstSegment=p),null!==(p=null===(p=this.featureSwitchService)||void 0===p?void 0:p.featureSwitches)&&void 0!==p&&p.queryContext&&(u=null===(u=e.dataReaderResult)||void 0===u?void 0:u.queryContext)&&(c.queryContext=u)):(c={dataView:o&&o.dataView,dataViewSource:o&&o.dataViewSource,isFirstSegment:o&&o.isFirstSegment},d=o&&o.warnings||[],l&&(d=_.concat(d,l)),_.isEmpty(d)||(c.warnings=d),null!==(l=null===(l=this.featureSwitchService)||void 0===l?void 0:l.featureSwitches)&&void 0!==l&&l.queryContext&&(u=null==o?void 0:o.queryContext)&&(c.queryContext=u)),this.queryExecutionServices.handleWarnings(d,r&&r.transforms),this.queryExecutionServices.applyUpdate(c,r.transforms,i,s,n),a&&a.updateContractCache&&(e=e&&e.dataViewSource?e.dataViewSource.data:void 0,e=this.updateContractCache(t,e,r),a.updateServerCache&&e.then((function(){r.options.then((function(e){_.isEmpty(e.query.command)||(e={visualContainerId:t.id,query:JSON.stringify(e.query.command),dataTransforms:m.getCachedTransformsString(t)},m.eventBridge.publishToChannel(v.events.newQueryCacheResultAvailable,e))}))})))},h.prototype.handleLoadMoreDataWarnings=function(e,t){this.queryExecutionServices.clearErrors();e=h.getDataProxyQueryExecutionResultWarnings(e,t)||[];this.queryExecutionServices.handleWarnings(e,t&&t.transforms)},h.prototype.getCachedTransformsString=function(e){e=e.cachedData;if(e){e=e.transformsObject;if(e)return n.serializeTransformActions(e)}},h.prototype.loadResourcePackageReferences=function(e,t){var r=this,e=this.visualPlugin.capabilities(e),e=e&&e.objects,i=this.explorationNavigation.getCurrentExploration();return i||s.hasResourceReferencesToResolve(t,e),s.loadFromDataViewObjects(t,e,(function(){return i?i.resourcePackages:null}),this.resourceLoader,this.promiseFactory,(function(e,t){return r.ensureSharedResource(i,e,t)}))},h.prototype.ensureSharedResource=function(e,t,r){this.resourceRegistration&&(e=i.ensureResourcePackageType(e,2),p.findItemInPackage(e,t)||this.resourceRegistration.add(t,2,r))},h.prototype.resolveResourcePackageReferences=function(e,t,r){var i=this.visualPlugin.capabilities(e),e=i&&i.objects,i=this.explorationNavigation.getCurrentExploration();return i||s.hasResourceReferencesToResolve(t,e),s.loadAndResolveFromDataViewObjects(t,e,i?i.resourcePackages:null,this.resourceLoader,this.promiseFactory,void 0,r)},h.getDataProxyQueryExecutionResultWarnings=function(e,t){var r;return t&&!_.isEmpty(t.warnings)&&(r=r||[]).push.apply(r,t.warnings||[]),e&&e.dataReaderResult&&!_.isEmpty(e.dataReaderResult.warnings)&&(r=r||[]).push.apply(r,e.dataReaderResult.warnings||[]),r},h);function h(e,t,r,i,a,o,n,s,l,p,u,c,d,m,v,f,g,h,y,C,x,b,S){this.queryExecutionServices=e,this.hostServices=t,this.promiseFactory=r,this.conceptualSchemaProxy=i,this.featureSwitchService=a,this.telemetryService=o,this.visualQueryGenerator=n,this.visualPlugin=s,this.visualPluginOps=l,this.filterGenerator=p,this.displayNameService=u,this.explorationNavigation=c,this.visualValidationService=d,this.resourceLoader=m,this.eventBridge=v,this.dataProxyService=f,this.dataSources=g,this.visualLifecycleService=h,this.resourceRegistration=y,this.cachePolicyProviderService=C,this.visualInsightsAnalysisHandler=x,this.visualParameterService=b,this.visualDataProxyExecutionService=S}v.VisualContainerQueryHandler=E})((m=d.explore||(d.explore={})).services||(m.services={}))})(powerbi=powerbi||{}),(function(e){var t,d,m,v;function f(e){if(_.isEmpty(e))return!1;for(var t=0,r=e;t<r.length;t++){var i=r[t];if(_.some(i.filter.where(),(function(e){return 3===d.runDetector(e.condition)})))return!0}return!1}t=(t=e.explore||(e.explore={})).services||(t.services={}),d=e.data.FilterKindDetector,m=e.data.SemanticFilter,v=e.data.SubqueryRewriter,(t.FilterPrecedenceResolver||(t.FilterPrecedenceResolver={})).resolve=function(e){if(f(e.sectionFilters),f(e.reportFilters),_.isEmpty(e.visualFilters))return e.visualFilters;for(var t=!1,r=[],i=0,a=e.visualFilters;i<a.length;i++){var o=(p=a[i]).filter.where().filter((function(e){return 0===d.runDetector(e.condition)})),t=t||f([p]);r.push.apply(r,o.map((function(e){return m.fromSQExpr(e.condition)})))}if(!t)return e.visualFilters;for(var n=[],s=0,l=e.visualFilters;s<l.length;s++){var p,u,c=p=l[s];f([p])&&(u=p.filter,_.isEmpty(r)||(u=v.makeSubqueriesLowerPrecedenceThanSpecificFilters(u,r)),_.isEmpty(e.crossFilters)||(u=v.makeSubqueriesLowerPrecedenceThanSpecificFilters(u,e.crossFilters.map((function(e){return e.filter})))),_.isEmpty(e.sectionFilters)||(u=v.makeSubqueriesLowerPrecedenceThanSpecificFilters(u,e.sectionFilters.map((function(e){return e.filter})))),_.isEmpty(e.drillThroughFilters)||(u=v.makeSubqueriesLowerPrecedenceThanSpecificFilters(u,e.drillThroughFilters.map((function(e){return e.filter})))),c={filter:u=!_.isEmpty(e.reportFilters)?v.makeSubqueriesLowerPrecedenceThanSpecificFilters(u,e.reportFilters.map((function(e){return e.filter}))):u}),n.push(c)}return n}})(powerbi=powerbi||{}),(function(s){var e;(function(e){var t=s.data.FilterKindDetector,i=s.data.SQScopedEvalExpr,r=(a.prototype.resolveSemanticQuery=function(e){return e?e.where(this.resolveFilters(e.where()),e.from()):null},a.prototype.resolveFilters=function(e){var t=this;return e?_.map(e,(function(e){return t.resolveFilter(e)})):null},a.prototype.resolveFilter=function(e){if(!e)return null;if(e.target)return e;if(e.condition)switch(t.runDetector(e.condition)){case 0:return this.resolveColumnFilter(e);case 2:return this.resolveExistsFilter(e);case 1:return this.resolveMeasureFilter(e);case 3:return this.resolveSubqueryFilter(e);default:return}},a.prototype.resolveColumnFilter=function(e){return{condition:e.condition,annotations:e.annotations}},a.prototype.resolveMeasureFilter=function(e){var t,r,i=this,a=null;(a=this.options.mappings&&this.options.mappings.measureFilter?this.options.mappings.measureFilter.targetRoles:a)&&_.some(a,(function(e){return i.options.queryProjections[e]}))||(a=this.getDefaultMeasureFilterTargetRoles());var o=e.condition;if(a){for(var n=0,s=a;n<s.length;n++){var l=s[n],l=this.options.queryProjections[l];if(l)for(var p=0,u=l.all();p<u.length;p++){var c=u[p],d=this.options.select.filter((function(e){return e.name===c.queryRef}));_.isEmpty(d)||d.length;var m=d[0].expr,v=d[0].name,f=m.getMetadata(this.options.schema),d=t&&t[v];f&&1!==f.kind&&!d&&(r||(r=[],t={}),r.push(m),t[v]=!0)}}o=g.rewrite(o,a)}return{target:r,condition:o,annotations:e.annotations}},a.prototype.resolveExistsFilter=function(e){return e.target,e},a.prototype.resolveSubqueryFilter=function(e){return{condition:e.condition,annotations:e.annotations}},a.prototype.getDefaultMeasureFilterTargetRoles=function(){return(this.options.dataRoles?this.options.dataRoles.filter((function(e){return e.kind===s.VisualDataRoleKind.Grouping||e.kind===s.VisualDataRoleKind.GroupingOrMeasure})):[]).map((function(e){return e.name}))},a);function a(e){this.options=e}e.VisualFilterMappingResolver=r;var o,g=(o=s.data.SQExprRewriter,__extends(n,o),n.rewrite=function(e,t){t=new n(t);return e.accept(t)},n.prototype.visitScopedEval=function(e){var t=this,r=_.filter(e.scope,(function(e){return!s.data.SQExpr.isRoleRef(e)||_.includes(t.filterTargetRoles,e.role)}));return r.length===e.scope.length?e:new i(e.expression,r)},n);function n(e){var t=o.call(this)||this;return t.filterTargetRoles=e,t}})((e=s.explore||(s.explore={})).services||(e.services={}))})(powerbi=powerbi||{}),(function(c){var l;(function(n){var r=c.explore.contracts.AutoPageRefreshOption,i=c.common.constants.MaxInt32,a=c.common.events.reportRefreshStateChanged,o=c.explore.util;n.AutoPageRefreshErrorId="apr_error_notification_bar",n.createReportRefreshService=function(e,t,r,i,a,o,n,s,l,p,u,c,d){return new m(e,t,r,i,a,o,n,s,l,p,u,c,d)};var s={autoRefreshEnabled:!0,refreshIntervalSeconds:1},m=(e.prototype.subscribeEvents=function(){var e=this;null==this.subscriptionManager&&(this.subscriptionManager=this.eventBridge.createChannelSubscriptionManager()),this.subscriptionManager.subscribe(n.events.sectionChanged,(function(){return e.onSectionChanged()})).subscribe(c.common.events.printSectionReady,(function(){return e.onVisualsLoaded()})).subscribe(n.events.sectionObjectsEvaluated,(function(){return e.onSectionsObjectsEvaluated()})).subscribe(n.events.modelChanged,(function(){return e.onModelChanged()}))},e.prototype.init=function(t){return void 0===t&&(t=!0),__awaiter(this,void 0,c.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return this.triggerNotifications=t,[4,this.loadPageSettings()];case 1:return e.sent(),[4,this.updateRefreshState()];case 2:return e.sent(),this.subscribeEvents(),[2]}}))}))},e.prototype.destroy=function(){var e;this.stopRefresh(),null!==(e=this.subscriptionManager)&&void 0!==e&&e.unsubscribeAll(),this.subscriptionManager=void 0},e.prototype.refreshData=function(){this.reportRefreshCacheService.tryClearDSRCache()&&this.eventBridge.publishToChannel(n.events.visualContainerChanged,{affectContainer:function(){return!0}})},e.prototype.getRefreshStats=function(){return{adminConfig:this.adminConfig,effectiveRefreshInterval:this.effectiveRefreshInterval,lastRefreshTimestamp:this.lastUpdateDate?this.lastUpdateDate.toLocaleTimeString():void 0}},e.prototype.loadAdminSettings=function(){var a;return __awaiter(this,void 0,c.Promise,(function(){var t,r,i;return __generator(this,(function(e){switch(e.label){case 0:return[4,this.isPageRefreshSupported()];case 1:if(!e.sent())return[2];if(!this.reportRefreshConfigProxy)return this.adminConfig=s,[2];t=null===(a=null===(a=this.explorationNavigation.getCurrentExploration())||void 0===a?void 0:a.report)||void 0===a?void 0:a.modelId,e.label=2;case 2:return e.trys.push([2,4,,5]),[4,(r=this).reportRefreshConfigProxy.getAPRConfig(t)];case 3:return r.adminConfig=e.sent(),[3,5];case 4:return i=e.sent(),this.telemetryService.logEvent(c.telemetry.EXGetAPRConfigFailure,{modelId:t}),this.sendNotification(this.localizationService.get("AutoPageRefresh_Error_GetAdminConfigErrorTryAgain"),!0,i,"FailedToGetAPRAdminConfig"),this.adminConfig=void 0,[2];case 5:return this.adminConfig?this.adminConfig.autoRefreshEnabled||this.sendNotification(this.localizationService.get("AutoPageRefresh_Error_AdminDisabled")):this.sendNotification(this.localizationService.get("AutoPageRefresh_Error_GetAdminConfigErrorTryAgain"),!0),[2]}}))}))},e.prototype.loadPageSettings=function(){return __awaiter(this,void 0,c.Promise,(function(){var t,r,i;return __generator(this,(function(e){switch(e.label){case 0:return r=this.explorationNavigation.getCurrentSection(),[4,this.isAPREnabledInSection(r)];case 1:return e.sent()?(t=this.refreshIntervalInMilliseconds,i=o.DurationParser.parseISODurationdString(r.evaluatedObjects.pageRefresh.duration||l.constants.ExploreCanvasConstants.DefaultTimeInterval),this.refreshIntervalInMilliseconds=o.DurationParser.durationParseResultAsMilliseconds(i)):this.refreshIntervalInMilliseconds=void 0,[2,this.refreshIntervalInMilliseconds!==t]}}))}))},e.prototype.onSectionsObjectsEvaluated=function(){return __awaiter(this,void 0,c.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return[4,this.loadPageSettings()];case 1:return t=e.sent(),this.refreshIntervalInMilliseconds&&t?this.updateRefreshState():!this.refreshIntervalInMilliseconds&&this.isRunning&&this.stopRefresh(),[2]}}))}))},e.prototype.onModelChanged=function(){return __awaiter(this,void 0,c.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return[4,this.getRefreshInterval()];case 1:return(t=e.sent())&&!this.isRunning?this.updateRefreshState():!t&&this.isRunning&&this.stopRefresh(),[2]}}))}))},e.prototype.getRefreshInterval=function(){return __awaiter(this,void 0,c.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return[4,this.isPageRefreshSupported()];case 1:return e.sent()?this.refreshIntervalInMilliseconds&&this.adminConfig&&this.adminConfig.autoRefreshEnabled?(t=_.max([this.refreshIntervalInMilliseconds,1e3*this.adminConfig.refreshIntervalSeconds]),[2,_.min([i,t])]):[2]:[2,null]}}))}))},e.prototype.isPageRefreshSupported=function(){return __awaiter(this,void 0,c.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.conceptualSchemaProxy.get(this.dataSourcesService.get())];case 1:return t=e.sent(),[3,3];case 2:return e.sent(),[2,!1];case 3:return[2,_.some(t.schemas,(function(e){return e.capabilities&&e.capabilities.supportsFastRefresh}))]}}))}))},e.prototype.updateRefreshState=function(){return __awaiter(this,void 0,c.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return this.stopRefresh(),this.isRunning=!0,this.adminConfig||null==this.refreshIntervalInMilliseconds?[3,2]:[4,this.loadAdminSettings()];case 1:e.sent(),e.label=2;case 2:return[4,this.getRefreshInterval()];case 3:return null!=(t=e.sent())?this.runTimer(t):this.isRunning=!1,[2]}}))}))},e.prototype.triggerRefreshUponSectionChange=function(){return __awaiter(this,void 0,c.Promise,(function(){var t,r;return __generator(this,(function(e){switch(e.label){case 0:return t=this.explorationNavigation.getCurrentSection(),(r=this.featureSwitchService.featureSwitches.shouldFlushClientCacheForAPR)?[4,this.isAPREnabledInSection(t)]:[3,2];case 1:r=e.sent(),e.label=2;case 2:return r&&this.triggerRefresh(),[2]}}))}))},e.prototype.onSectionChanged=function(){return __awaiter(this,void 0,c.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.triggerRefreshUponSectionChange()];case 1:return e.sent(),this.lastUpdateDate=void 0,[4,this.loadPageSettings()];case 2:return e.sent(),[4,this.updateRefreshState()];case 3:return e.sent(),[2]}}))}))},e.prototype.onVisualsLoaded=function(){this.visualsLoaded=!0,this.timerExpired&&this.isRunning&&this.onTimerExpired()},e.prototype.stopRefresh=function(){this.nextUpdateDate=void 0,this.isRunning=!1,this.timerExpired=!1,this.clearTimeoutAndAnimationFrame(),this.notifyReportRefreshStateChanged(),this.notificationBarService.hide(n.AutoPageRefreshErrorId)},e.prototype.clearTimeoutAndAnimationFrame=function(){clearTimeout(this.timeoutId),this.timeoutId=void 0,cancelAnimationFrame(this.animationFrameId),this.animationFrameId=void 0},e.prototype.runTimer=function(e){var t=this;this.clearTimeoutAndAnimationFrame(),this.nextUpdateDate=new Date(Date.now()+e),this.notifyReportRefreshStateChanged(),this.timeoutId=setTimeout((function(){t.timeoutId=void 0,t.animationFrameId=requestAnimationFrame((function(){t.animationFrameId=void 0,t.onTimerTriggered()}))}),e)},e.prototype.onTimerTriggered=function(){return __awaiter(this,void 0,c.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return this.timerExpired=!0,this.visualsLoaded?this.onTimerExpired():this.refreshDelayedCount+=1,[4,this.loadAdminSettings()];case 1:return e.sent(),[4,this.getRefreshInterval()];case 2:return null!=(t=e.sent())?this.runTimer(t):this.stopRefresh(),[2]}}))}))},e.prototype.triggerRefresh=function(){var e;this.featureSwitchService.featureSwitches.shouldFlushClientCacheForAPR&&(e=this.explorationNavigation.getCurrentSection(),this.reportRefreshCacheService.clearClientCache(e)),this.visualTimeSynchronizationService.setAnchorTimeToNow(),this.eventBridge.publishToChannel(n.events.dataRefreshTriggered)},e.prototype.calculateEffectiveInterval=function(){this.effectiveRefreshInterval=this.lastUpdateDate?(new Date).getTime()-this.lastUpdateDate.getTime():void 0},e.prototype.onTimerExpired=function(){this.logTriggerRefresh(this.refreshDelayedCount),this.calculateEffectiveInterval(),this.lastUpdateDate=new Date,this.triggerRefresh(),this.timerExpired=!1,this.visualsLoaded=!1,this.refreshDelayedCount=0,this.notifyReportRefreshStateChanged()},e.prototype.logTriggerRefresh=function(u){return __awaiter(this,void 0,c.Promise,(function(){var t,r,i,a,o,n,s,l,p;return __generator(this,(function(e){switch(e.label){case 0:return p=this.explorationNavigation.getCurrentSection(),t=this.explorationNavigation.getCurrentExploration().report,r=this.explorationNavigation.getExplorationTelemetryData(),a=-1,o=i="",s=n="-1",t&&t.model&&(l=t.model,i=l.dbName,o=t.objectId,a=l.id),l=p.objectId,[4,this.getRefreshInterval()];case 1:return p=e.sent(),r&&(n=r.exid,s=r.exsid),this.telemetryService.logEvent(c.telemetry.TriggerRefresh,{reportId:o,pageId:l,dbName:i,modelId:a,interval:p,delayCount:u,exid:n,exsid:s}),[2]}}))}))},e.prototype.notifyReportRefreshStateChanged=function(){var e,t;this.triggerNotifications&&(e=void 0,(t=this.explorationNavigation.getCurrentExploration().report)&&(e=t.objectId),this.globalEventBridge.publishToChannel(a,{reportId:e,nextUpdateDate:this.nextUpdateDate,lastUpdateDate:this.lastUpdateDate}))},e.prototype.sendNotification=function(e,t,r,i){var a=this;void 0===t&&(t=!1);var o={id:n.AutoPageRefreshErrorId,message:e,notificationType:1,actions:[]};r&&(o.secondaryLink={action:function(){a.errorService.error(e,i,{requestId:r.requestId,statusCode:r.status&&r.status.toString()})},displayText:this.localizationService.get("Generic_ShowDetails")}),t&&o.actions.push({action:function(){a.notificationBarService.hide(n.AutoPageRefreshErrorId),a.updateRefreshState()},displayText:this.localizationService.get("TryAgain")}),this.notificationBarService.notify(o)},e.prototype.isAPREnabledInSection=function(t){return __awaiter(this,void 0,c.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.isPageRefreshSupported()];case 1:return e.sent()?[2,t&&t.evaluatedObjects&&t.evaluatedObjects.pageRefresh&&t.evaluatedObjects.pageRefresh.show&&(null==t.evaluatedObjects.pageRefresh.refreshType||t.evaluatedObjects.pageRefresh.refreshType===r.APR)]:[2,!1]}}))}))},e);function e(e,t,r,i,a,o,n,s,l,p,u,c,d){this.telemetryService=e,this.eventBridge=t,this.explorationNavigation=r,this.dataSourcesService=i,this.conceptualSchemaProxy=a,this.globalEventBridge=o,this.visualTimeSynchronizationService=n,this.notificationBarService=s,this.localizationService=l,this.errorService=p,this.featureSwitchService=u,this.reportRefreshCacheService=c,this.reportRefreshConfigProxy=d,this.visualsLoaded=!1,this.timerExpired=!1,this.isRunning=!1,this.refreshDelayedCount=0,this.subscriptionManager=t.createChannelSubscriptionManager()}})((l=c.explore||(c.explore={})).services||(l.services={}))})(powerbi=powerbi||{}),(function(b){var e,S,E,v,r,N,V,P,w;function f(e,t){switch(e){case r.Forecast.name:return t.some((function(e){return b.DataViewMapping.isForecastDefined(e)}));case r.SampleAndDetectAnomaly.name:return t.some((function(e){return b.DataViewMapping.isAnomalyDefined(e)}));default:return 1}}e=(e=b.explore||(b.explore={})).TransformGeneratorUtils||(e.TransformGeneratorUtils={}),S=b.visuals.AnomalyDetectionTransformConstants,E=b.data.CompiledDataViewMapping,v=b.data.DataViewObjectDefinitions,r=b.data.transforms.plugins,N=b.data.SQExpr,V=b.data.SQExprBuilder,P=b.data.SQExprUtils,w=jsCommon.StringExtensions,e.addTransforms=function(a,e,o,t,r){if(!a)return o;function i(r){function e(t){var e;i.properties[t].type.queryTransform&&(e=_.filter(a[r],(function(e){return (function(e,t){if(!e.selector||!_.isString(e.selector.metadata))return!0;var r,i=t.projections;if(!i)return!1;for(r in i){var a=i[r];if(a){a=a.all();if(a)for(var o=0,n=a;o<n.length;o++)if(n[o].queryRef===e.selector.metadata)return!0}}return!1})(e,o)})),s.push.apply(s,_.map(e,(function(e){return{objectName:r,propertyName:t,object:e}}))))}var t,i=l[r];for(t in i.properties)e(t)}var n,s=[],l=r.objects;for(n in l)i(n);if(_.isEmpty(s))return o;for(var p=o.clone(),u=0,c=s;u<c.length;u++){var d=c[u],m=v.getValue(a,{objectName:d.objectName,propertyName:d.propertyName},d.object.selector);m&&f(m.algorithm,e)&&(d=t.getTransformPlugin(m.algorithm),p.addTransform(d,m.parameters,r))}return p},e.removeUnsupportedTransforms=function(e,t,r){var i=t.defn.transforms();if(_.isEmpty(i))return t;for(var a=t.clone(),o=0,n=i;o<n.length;o++){var s,l=n[o];f(l.algorithm,r)||(s=e.getTransformPlugin(l.algorithm),a.removeTransform(s,l.name))}return a},e.rewriteTransform=function(e,t,r,i,a,o,n){var s=t.transforms();if(_.isEmpty(s))return t;var l=t.select();if(_.isEmpty(l))return t;for(var p=(y=(function(e,n,s,l){for(var p=[],u=[],e=e.select(),t=0,r=e;t<r.length;t++)!(function(t){if(N.isTransformOutputRoleRef(t.expr))return p.push(t);var e=Object.keys(s),e=_.filter(e,(function(e){return _.includes(s[e],t.name)}));if(!_.isEmpty(e)){for(var r=!1,i=0,a=e;i<a.length;i++){var o=a[i];if(!n[o].activeProjectionRefs||_.includes(n[o].activeProjectionRefs,t.name)){p.push(t),r=!0;break}}return r||u.push(t)}_.isEmpty(l)||((e=_.find(l,(function(e){return e.queryName===t.name})))&&e.selector&&e.selector.data?p:u).push(t)})(r[t]);return{transformSelects:p,topLevelSelects:u}})(t,r,a,o)).transformSelects,o=y.topLevelSelects,u=[],c=0;c<s.length;c++){var d=s[c],m=e.getTransformPlugin(d.algorithm),v="input"+c,f="output"+c;d.input.parameters=(function(e,t){t=_.find(t,(function(e){return b.DataViewMapping.isAnomalyDefined(e)}));{var r;t&&(t=t.categorical.dataReductionAlgorithm.binnedLineSample.warningCount,r=S.transformParameterSampleCountName,t&&!_.find(e,(function(e){return e.name===r}))&&e.push({name:r,expr:V.integer(t)}))}return e})(d.input.parameters,n);v={algorithm:d.algorithm,name:d.name,input:{parameters:d.input.parameters,table:{name:v,columns:(function(e,t,r,i,a){var e=_.filter(e,(function(e){return!N.isTransformOutputRoleRef(e.expr)})),o=(function(e){for(var r,i,t=0,a=e;t<a.length;t++){var o=a[t];if(o.categorical&&(o=o.categorical.categories,_.isEmpty(o)||E.visitCategoricalCategories(o,{visitRole:function(e){var t=_.find(e.items,(function(e){return null===(e=e.scalarKeyInfo)||void 0===e?void 0:e.scalarKeyMinProperty}));t&&(r=e.role,i=t.scalarKeyInfo.scalarKeyQueryName)}})),r&&i)return{roleName:r,queryName:i}}})(a);return _.map(e,(function(e){return (function(t,e,r,i,a){var o=Object.keys(r),n=t.name===(null==e?void 0:e.queryName),s=n?e.roleName:_.find(o,(function(e){return _.includes(r[e],t.name)})),o=_.find(i,(function(e){return e.name===s})),i=!1;i=null==e?null!=o:n||null!=s&&s!==e.roleName;return{role:i?(function(t,e,r){e=_.find(e.inputRoles,(function(e){e=e.visualDataRoleMatching;return!e||(void 0===e.cartesianKind||e.cartesianKind===r.cartesianKind)&&((void 0===e.matchGrouping||e.matchGrouping!==P.isMeasure(t))&&((void 0===e.matchMeasure||e.matchMeasure===P.isMeasure(t))&&(!e.skipJoinPredicateNone||0!==r.joinPredicate)))}));if(e)return e.name})(t.expr,a,o):void 0,expression:t}})(e,o,t,r,i)}))})(p,a,i,m,n)}},output:{table:{name:f,columns:(function(e,s,l){for(var p={},t=0,r=e;t<r.length;t++){var i=r[t];N.isTransformOutputRoleRef(i.expr)||(p[i.name]=!0)}return _.map(e,(function(t){var e,r,i;if(N.isTransformOutputRoleRef(t.expr)){var a,o=void 0;for(a in l){var n=l[a].all();_.some(n,(function(e){return e.queryRef===t.name}))&&(o=a)}e=o,r=t.expr,i=w.findUniqueName(p,t.name)}else r=V.columnRef(V.transformTableRef(s),t.name),i=t.name;return{role:e,expression:{name:i,expr:r}}}))})(p,v,r)}}},p=_.map(v.output.table.columns,(function(e){var t=V.columnRef(V.transformTableRef(f),e.expression.name);return{name:e.expression.name,expr:t}}));u.push(v)}var g,h=_.last(u),y=t.orderBy();if(h&&!_.isEmpty(y)&&(g=_.map(y,(function(t){var e=_.find(l,(function(e){return N.equals(e.expr,t.expr)})),e=V.columnRef(V.transformTableRef(h.output.table.name),e.name);return{direction:t.direction,expr:e}}))),t=t.transforms(u),!_.isEmpty(o))for(var C=0,x=o;C<x.length;C++)!(function(t){var e=_.findIndex(l,(function(e){return e.name===t.name}));p.splice(e,0,t)})(x[C]);return t=t.select(p),t=g?t.orderBy(g):t},e.prototypeQueryFromRunnableQuery=function(i,e){if(_.isEmpty(i.transforms())||_.isEmpty(i.select()))return i;var a=[];return _.map(i.select().slice(0,e),(function(e){var t,r;N.isColumn(e.expr)&&N.isTransformTableRef(e.expr.source)?(t=e.expr.source.source,!(r=_.find(i.transforms(),(function(e){return(null===(e=e.output.table)||void 0===e?void 0:e.name)===t})))||(r=(function(e,t){e.output.table;var r=_.find(e.output.table.columns,(function(e){return e.expression.name===t.ref}));if(r){var i=r.expression.expr;if(N.isColumn(i)){e=_.find(null===(e=e.input.table)||void 0===e?void 0:e.columns,(function(e){return(null===(e=e.expression)||void 0===e?void 0:e.name)===i.ref}));return null==e?void 0:e.expression.expr}}})(r,e.expr))&&!N.isTransformOutputRoleRef(r)&&a.push({name:e.name,expr:r})):a.push(e)})),i.createModified({select:a,transforms:null})}})(powerbi=powerbi||{}),(function(e){var t,r;(t=(t=e.explore||(e.explore={})).constants||(t.constants={})).invalidSortExprIndex=-1,t.DefaultSchemaName=e.data.dsr.DefaultSchemaName,t.ExplorationSchemaName="extension",t.DefaultDrillFilterOtherVisuals=!0,t.SectionComponentType="page",t.ExplorationComponentType="report",t.GroupComponentType="group",t.MinContainerWidth=12,t.MinContainerHeight=12,(r=t.ExploreCanvasConstants||(t.ExploreCanvasConstants={})).DefaultCanvasWidth=960,r.DefaultCanvasHeight=720,r.DefaultCanvasBackgroundColor="#FFFFFF",r.DefaultCanvasOutspaceColor="#EAEAEA",r.DefaultCanvasOutspaceTransparency=0,r.DefaultOutspacePaneTransparency=0,r.DefaultControlForegroundColor="#000000",r.DefaultControlBackgroundColor="#ffffff",r.DefaultOutspacePaneCheckboxAndApplyColor="#F2C811",r.DefaultOutspacePaneWidth=200,r.OutspacePaneCollapsedWidth=32,r.OutspacePaneMinWidth=180,r.OutspacePaneMaxWidth=420,r.DefaultOutspacePaneBorder=!0,r.DefaultOutspacePaneBorderColor="#C8C8C8",r.DefaultOutspacePaneTitleSizePt=12,r.DefaultOutspaceSearchTextSizePt=10,r.DefaultOutspacePaneHeaderSizePt=9,r.DefaultOutspacePaneFontFamily="'Segoe UI', wf_segoe-ui_normal, helvetica, arial, sans-serif",r.DefaultAppliedFilterCardTransparency=0,r.DefaultAvailableFilterCardTransparency=0,r.DefaultFilterCardBorder=!0,r.DefaultFilterCardBorderColor="#C8C8C8",r.DefaultFilterCardTextSizePt=9,r.Available="Available",r.Applied="Applied",r.FilterCardSearchBoxBorderColor="#C8C6C4",r.FilterCardSearchBoxBackgroundColor="#FFFFFF",r.FilterCardFontColor="#252423",r.DefaultCanvasBackgroundTransparency=0,r.DefaultWidescreenWidth=1280,r.DefaultWidescreenHeight=720,r.DefaultCortanaWidth=296,r.DefaultCortanaHeight=592,r.DefaultLetterWidth=816,r.DefaultLetterHeight=1056,r.DefaultTooltipWidth=320,r.DefaultTooltipHeight=240,r.CanvasGutterSize=10,r.MobileFooterHeight=60,r.DefaultTimeInterval="PT30M",r.getDefaultCanvasBackground=function(){return{color:r.DefaultCanvasBackgroundColor,transparency:r.DefaultCanvasBackgroundTransparency}},r.getDefaultCanvasOutspace=function(){return{color:r.DefaultCanvasOutspaceColor,transparency:r.DefaultCanvasOutspaceTransparency}}})(powerbi=powerbi||{}),(function(v){var e,t,c,f,g,d,u,m;function a(){}e=v.explore||(v.explore={}),t=v.data,c=t.FieldExprPattern,f=t.SQExpr,g=jsCommon.StringExtensions,d=v.data.SQExprConverter,u=t.SQExprUtils,m=v.explore.util.VisualContainerUtils,a.getApplyStateInfoForInternallDrillthrough=function(e,t,r,i){void 0===r&&(r=!0);i=a.getFiltersState(e,{skipUnmatchedDrillthroughFilters:!1,filterMatchingBehavior:i=void 0===i?0:i},t);return{state:{activeSection:r?e.name:void 0,sections:((t={})[e.name]={filters:i},t)},options:{clearUnmatchedData:!1,suppressDataSourceVariables:!0,suppressActiveSection:!r}}},a.getFiltersState=function(e,i,t){var a=[],o=t?__spreadArray([],t||[]):[],n={},s=i.filterMatchingBehavior;if(!_.isEmpty(e.filters))for(var r=0,l=e.filters;r<l.length;r++)!(function(t){if(5!==t.howCreated||t.isTransient)return;t.expression;var e=_.find(o,(function(e){return(1===s||!e.isTransient)&&e.filterExpressionMetadata&&1===e.filterExpressionMetadata.expressions.length&&f.equals(e.filterExpressionMetadata.expressions[0],t.expression)})),r=v.explore.services.convertToFilterContainerState(t);if(e)_.remove(o,e),r.filter=e.filter,r.cachedValueItems=void 0;else{if(i.skipUnmatchedDrillthroughFilters)return;r.filter=void 0,r.cachedValueItems=void 0}a.push(r),n[t.name]=!0})(l[r]);e={exprIdentifiedMerges:a};if(0===s&&_.some(o,(function(e){return e.isTransient}))||1===s&&!_.isEmpty(o)){for(var p=[],u=0,c=o;u<c.length;u++){var d=c[u];1===s||d.isTransient;var m=g.findUniqueName(n,"transientFilter");n[m]=!0;d={name:m,expression:_.isEmpty(d.filterExpressionMetadata)||1!==d.filterExpressionMetadata.expressions.length?void 0:d.filterExpressionMetadata.expressions[0],type:d.type,restatement:d.restatement,filter:d.filter,howCreated:5,isTransient:!0,displayName:d.displayName};p.push(d)}e.transientFilters=p}return e},a.getMatchedLinkFieldsFromParameters=function(e,t,r,i){e=_.map(e,(function(e){e={fieldExpr:e.fieldExpr,asAggregation:e.asAggregation};return null!=e.fieldExpr&&f.isMeasure(e.fieldExpr)&&e.asAggregation,null==e.asAggregation&&e.fieldExpr&&f.isMeasure(e.fieldExpr)&&(e.asAggregation=!1),e}));if(!_.isEmpty(e))return this.getMatchedLinkFields(e,t,r,i)},a.getMatchedLinkFields=function(e,n,s,l){for(var p=[],t=0,r=e;t<r.length;t++)!(function(e){var t=e.fieldExpr;if(!t)return;if(f.isMeasure(t)||f.isColumn(t)||f.isGroupRef(t)||f.isHierarchyLevel(t),f.isMeasure(t))e.asAggregation,_.find(s,(function(e){return f.isMeasure(e)&&f.equals(e,t)}))&&p.push(e);else{var r=t.getKeyColumns(l);if(!_.isEmpty(r))if(e.asAggregation)for(var i=0,a=s;i<a.length;i++){var o=a[i];if(f.isAggregation(o)){o=o.arg.getKeyColumns(l);if(u.isSubset(r,o)){p.push(e);break}}}else u.isSubset(r,n)&&p.push(e)}})(r[t]);return p},a.getMeasuresFromSelectors=function(e,t,r){for(var i=[],a=m.getVisualQuery(t),o=0,n=e;o<n.length;o++){var s=n[o];if(s.metadata)for(var l=0,p=s.metadata;l<p.length;l++){var u=p[l],u=a.defn.select().withName(u);u&&u.expr&&(u=d.asFieldPattern(u.expr,r),u=c.getBaseSQExpr(u,r),i.push(u))}}return i},a.hasMeasureOrAsAggregationPodParameter=function(e,t){return(1===e||2===e)&&_.some(t,(function(e){return e.asAggregation||e.fieldExpr&&f.isMeasure(e.fieldExpr)}))},t=a,e.DrillthroughUtils=t})(powerbi=powerbi||{}),(function(e){var t,r,i,a,o,n,s;function l(e){var t=i.call(this)||this;return t.schema=e,t}t=e.explore||(e.explore={}),r=t.util||(t.util={}),a=e.data.SQEntityExpr,t=e.data.SQExprRewriter,o=e.data.SQHierarchyExpr,n=e.data.SQHierarchyLevelExpr,s=e.data.SQPropertyVariationSourceExpr,__extends(l,i=t),l.prototype.visitEntity=function(e){var t=this.getVariationMapping(e);return t?new a(e.schema,t.sourceEntity.name):e},l.prototype.visitColumnRef=function(t){var e=t.source.accept(this);if(e!==t.source){var r=this.getVariationMapping(t.source);if(r){var i=_.find(r.variation.defaultHierarchy.levels,(function(e){return e.column.name===t.ref}));if(i)return new n(new o(new s(e,r.variation.name,r.sourceProperty.name),r.variation.defaultHierarchy.name),i.name)}}return t},l.prototype.getVariationMapping=function(e){e=this.schema.schema(e.schema).findVariationToHierarchyMappings(e.entity);if(e)return _.last(e)},t=l,r.VariationToHierarchyRewriter=t})(powerbi=powerbi||{}),(function(a){var x;(function(e){var h=a.explore,y=h.services.events,C=y.explorationFiltersContainerChanged;e.createExplorationStateManagerService=function(e,t,r,i,a,o,n,s){return new l(e,t,r,i,a,o,n,s)};var l=(t.prototype.exploration=function(){return this.navigation.getCurrentExploration()},t.prototype.capture=function(e,t){var r=this.exploration();if(r)return this.state.capture(r,e,t)},t.prototype.apply=function(e,t,r){var i=this.exploration(),t=this.state.apply(e,i,t,r);return this.applyImpact(t,i,r),t},t.prototype.captureFilterState=function(e){return this.state.captureFilterState(e)},t.prototype.applyFilterState=function(e,t){var r,i=this;_.isEmpty(e)||(r=this.state.applyFilterState(e,t),this.explorationActivity.doActivity((function(e){i.eventBridge.publishToChannel(y.visualContainerChanged,{affectContainer:function(e){return _.includes(r.visualContainers,e)},parentActivity:e})}),(function(e){return i.telemetryService.startChildActivity(e&&e.event,a.telemetry.EXExplorationStateApplyImpact)})))},t.prototype.applyImpact=function(m,v,f){var g=this;this.explorationActivity.doActivity((function(e){var t=m.dataSourceVariables,r=[];t&&f.suppressDataSourceVariables,m.objects&&g.eventBridge.publishToChannel(y.explorationObjectsChanged),2===m.filterScope&&(f.suppressData,g.eventBridge.publishToChannel(C,{container:v}),t=!0),m.activeSection?(f.suppressActiveSection,g.navigation.updateActiveSection({targetSectionIndex:v.activeSectionIndex,forceUpdate:!0,parentActivity:e})):1===m.filterScope?(f.suppressData,s=g.navigation.getCurrentSection(),g.eventBridge.publishToChannel(h.services.events.sectionFiltersContainerChanged,{container:s}),r=_.union(r,s.visualContainers)):0!==m.filterScope&&_.isEmpty(m.visualContainers)||(f.suppressData&&f.suppressDisplay,r=_.union(r,m.visualContainers));var i=[];t?(g.eventBridge.publishToChannel(y.visualContainerChanged,{affectContainer:_.stubTrue,parentActivity:e}),s=g.navigation.getCurrentSection(),i.push.apply(i,s.visualContainers||[])):_.isEmpty(r)||(g.eventBridge.publishToChannel(y.visualContainerChanged,{affectContainer:function(e){return _.includes(r,e)},parentActivity:e}),i.push.apply(i,r||[]));var a=m.visualContainerGroups;if(_.isEmpty(a)||(g.eventBridge.publishToChannel(y.visualContainerGroupChanged,{affectContainer:function(e){return _.includes(a,e)}}),i.push.apply(i,a||[])),f.suppressDisplay||(m.visibility?g.visibility.set(m.visibility.visual,m.visibility.mode):f.targetVisualNames?(o=v.sections[v.activeSectionIndex],n=_.filter(o.visualContainers,(function(e){return _.includes(f.targetVisualNames,e.name)})),g.visibility.clearForVisualContainers(n)):g.visibility.clear(),_.isEmpty(i)||g.eventBridge.publishToChannel(y.canvasItemHiddenChanged,{changedItems:i})),!f.suppressData){var o,n,s=m.pendingHighlights,i=g.navigation.getCurrentSection();if(s){g.filterGenerator.setMultipleFiltersOnSelectData(v,i,s,e,void 0);for(var l=0,p=s;l<p.length;l++){var u=p[l],c=u.sourceVisualContainer,d=g.runningVisualService.getVisual(c),c=c.config.singleVisual;d?(u.filterExpressionMetadata&&x.FilterExpressionMetadataUtils.hydrateSelectorsByColumnWithValueDetails(u.selection,u.filterExpressionMetadata),d.setSelectedDatapoints(u.selection,!0)):c.pendingSelection=u.selection}}else f.targetVisualNames?(o=v.sections[v.activeSectionIndex],n=_.filter(o.visualContainers,(function(e){return _.includes(f.targetVisualNames,e.name)})),g.filterGenerator.clearCrossHighlightForVisualContainers(o,n,e,void 0)):g.filterGenerator.clearCrossHighlight(i,e,void 0)}}),(function(e){return g.telemetryService.startChildActivity(e&&e.event,a.telemetry.EXExplorationStateApplyImpact)}))},t);function t(e,t,r,i,a,o,n,s){this.state=e,this.navigation=t,this.eventBridge=r,this.visibility=i,this.filterGenerator=a,this.explorationActivity=o,this.telemetryService=n,this.runningVisualService=s}})((x=a.explore||(a.explore={})).services||(x.services={}))})(powerbi=powerbi||{}),(function(k){var e;(function(e){var f=k.data,t=k.explore,g=jsCommon.ArrayExtensions,u=k.explore.services.createVisualAuthoringCore,h=k.data.DataViewObjectDefinitions,c=k.data.DataViewObjectDescriptors,y=k.DataViewObjectProperty,d=f.DataViewTransform,r=k.explore.contracts.ExplorationObjectDescriptors,C=t.contracts,l=t.FilterUtils,x=t.PodUtils,m=f.ProjectionUtils,o=f.QueryProjectionCollection,a=k.data.dsr.SelectToIdentityExpressionsVisitor,b=k.data.SemanticFilter,S=k.data.SemanticQuery,E=k.data.SQExpr,N=k.explore.contracts.VisualContainer,V=t.util.VisualContainerUtils,v=t.util.PresentationUtils,P=k.explore.contracts.VisualQuery;function w(e,t,r){if(!_.isEmpty(e)){for(var i,a={},o=0,n=e;o<n.length;o++){var s=n[o];r(s)||(s.isTransient?(a.transientFilters||(a.transientFilters=[]),a.transientFilters.push(p(s))):R(s)&&!_.isEmpty(s.name)?(a.nameIdentifiedMerges||(a.nameIdentifiedMerges={}),a.nameIdentifiedMerges[s.name]=p(s)):s.expression?(a.exprIdentifiedMerges||(a.exprIdentifiedMerges=[]),a.exprIdentifiedMerges.push(p(s))):3===(i=s).howCreated||4===i.howCreated?(a.typeIdentifiedMerges||(a.typeIdentifiedMerges=[]),a.typeIdentifiedMerges.push(p(s))):(_.isEmpty(s.name)&&(s.name=l.getNextFilterName(e)),a.nameIdentifiedMerges||(a.nameIdentifiedMerges={}),a.nameIdentifiedMerges[s.name]=p(s)))}if(!_.isEmpty(a))return a}}function p(e){return{name:e.name,type:e.type,filter:e.filter,expression:e.expression,restatement:e.restatement,howCreated:e.howCreated,isTransient:e.isTransient,cachedValueItems:e.cachedValueItems,filterExpressionMetadata:_.cloneDeep(e.filterExpressionMetadata)}}function T(e){return name,{name:e.name,type:e.type,filter:e.filter,expression:e.expression,restatement:e.restatement,howCreated:e.howCreated,isTransient:e.isTransient,cachedValueItems:e.cachedValueItems,filterExpressionMetadata:_.cloneDeep(e.filterExpressionMetadata),displayName:e.displayName}}function F(e,t){e.filter=t.filter,e.cachedValueItems=t.cachedValueItems,e.filterExpressionMetadata=_.cloneDeep(t.filterExpressionMetadata),e.type=t.type}function j(e){e.filter=void 0,e.cachedValueItems=void 0,e.filterExpressionMetadata=void 0}function R(e){return e.isHiddenInViewMode||e.isLockedInViewMode}function i(e,t,r){if(t.filterState)return!0;r=c.findFilterOutput(r);return _.some([r],e)}function n(e){return _.some([{objectName:"outspacePane",propertyName:"expanded"},{objectName:"outspacePane",propertyName:"visible"}],e)}e.createExplorationStateService=function(e,t,r,i,a,o,n,s,l,p){return new D(e,t,r,i,a,o,n,s,l,p)},e.convertToFilterContainerState=p;var D=(s.prototype.capture=function(e,t,r){e.activeSectionIndex;var i=e.sections[e.activeSectionIndex],a={activeSection:i.name,filters:w(e.filters,0,this.nonDrillthroughIsLinkedAsAggregationCallback),sections:{}};if(this.featureSwitchService.featureSwitches.dataSourceVariablesOverride&&!r.suppressDataSourceVariables&&(a.dataSourceVariables=e.dataSourceVariables),e.objects&&(a.objects=this.captureExplorationObjects(e.objects)),r.captureAllSections)for(var o=0,n=e.sections;o<n.length;o++){var s=n[o];a.sections[s.name]=this.captureSection(s,t,e,r.capturePresentation)}else a.sections[i.name]=this.captureSection(i,t,e,r.capturePresentation);return a},s.prototype.captureExplorationObjects=function(e){return this.captureObjects(r,e,n)},s.prototype.captureFilterState=function(e){var t=this.captureFilterStateObjects(e.visualType,e.objects);return{visualType:e.visualType,objects:t,cachedFilterDisplayItems:e.cachedFilterDisplayItems}},s.prototype.captureSection=function(t,e,r,i){var a=this.getCrossHighlights(t);return{filters:w(t.filters,0,(function(e){return x.isLinkedAsAggregation(r,t,e)})),visualContainers:this.captureVisualContainers(t.visualContainers,a,e,i),visualContainerGroups:this.captureVisualContainerGroups(t.visualContainerGroups)}},s.prototype.getCrossHighlights=function(e){return e&&e.crossFilterSource&&e.crossFilterSource.highlight},s.prototype.captureVisualContainerGroups=function(e){for(var t,r=0,i=e;r<i.length;r++){var a,o,n=i[r];C.isVisualContainerGroup(n)&&(a={},null!=n.isHidden&&(a.isHidden=n.isHidden),_.isEmpty(n.children)||(o=this.captureVisualContainerGroups(n.children),a.children=o),null==a.isHidden&&null==a.children||((t=t||{})[n.name]=a))}return t},s.prototype.captureVisualContainers=function(e,o,n,s){for(var l={},p=this,t=0,r=e;t<r.length;t++)!(function(e){e.name;var t=e.config.singleVisual;if(!t)return;var r=void 0;_.isEmpty(o)||(a=_.find(o,(function(e){return e.sourceVisualContainer.config.singleVisual===t&&!_.isEmpty(e.selection)})))&&(r={selection:a.selection,filterExpressionMetadata:a.filterExpressionMetadata||void 0});var i={filters:w(_.union(e.filters,p.getAdditionalVisualFiltersToCapture(e,n)),0,p.nonDrillthroughIsLinkedAsAggregationCallback),singleVisual:{visualType:t.visualType,objects:p.captureVisualObjects(t.visualType,t.objects),cachedFilterDisplayItems:t.cachedFilterDisplayItems,filterExpressionMetadata:t.filterExpressionMetadata},highlight:r};null!=t.autoSelectVisualType&&(i.singleVisual.autoSelectVisualType=t.autoSelectVisualType);var a=e.visibility;null!=a&&0!==a&&(i.visibility=a),N.isHidden(t)&&(i.singleVisual.hidden=!0);r=t.query,a=s&&t.presentationChangesApplied;(a||r&&r.hasQueryFieldParameters())&&(i.singleVisual.targetType=t.visualType,null!=t.autoSelectVisualType&&(i.singleVisual.targetAutoSelectVisualType=t.autoSelectVisualType),r&&r.projections&&r.defn&&(i.singleVisual.projections=v.captureProjections(r,a))),r&&r.projections&&p.featureSwitchService.featureSwitches.fieldParameters&&(i.singleVisual.parameters=v.captureParameters(r)),r&&r.defn&&(i.singleVisual.orderBy=r.defn.orderBy()),r&&r.projections&&(i.singleVisual.activeProjections=p.captureActiveProjections(r)),r&&r.expansionStates&&(i.singleVisual.expansionStates=f.ExpansionState.clone(r.expansionStates)),l[e.name]=i})(r[t]);return l},s.prototype.captureActiveProjections=function(e){var t,r=e.defn.select();for(t in e.projections){var i,a=e.projections[t].activeProjectionRefs;_.isEmpty(a)||(a=_.map(a,(function(e){return r.withName(e).expr})),(i=i||{})[t]=a)}return i},s.prototype.captureVisualObjects=function(e,t){return this.captureFilterStateObjects(e,t)},s.prototype.captureFilterStateObjects=function(e,t){e=this.plugins.capabilities(e);return e&&e.objects?this.captureObjects(e.objects,t,i):{}},s.prototype.captureObjects=function(e,t,r){var i,a={};for(i in e){var o,n=e[i];for(o in n.properties){var s=n.properties[o],l={objectName:i,propertyName:o};!s.captureState&&!r(l,s,e)||(s=h.getValue(t,l,null))&&h.setValue(a,l,null,s)}}var p={};return _.isEmpty(a)||(p.merge=a),p},s.prototype.apply=function(e,t,r,i){var a,o,n={visualContainers:[],visualContainerGroups:[]};for(a in i.suppressActiveSection||this.applyActiveSection(e.activeSection,t,n),i.suppressData||i.targetVisualNames||this.applyFilters(e.filters,t,2,n,i.clearUnmatchedData,[],void 0,r,this.nonDrillthroughIsLinkedAsAggregationCallback),e.objects&&this.applyExplorationObjects(e.objects,t,n,i),e.sections){var s,l,p=g.findItemWithName(t.sections,a);p&&(s=e.sections[a],l=!i.suppressActiveSection||this.isActiveSection(p.name,t),this.applySection(t,s,p,r,n,i,l))}return n.activeSection&&null!=n.filterScope&&(o=t.sections[t.activeSectionIndex],V.clearSectionQueryCaches(o)),i.suppressDataSourceVariables||this.applyDataSourceVariables(e.dataSourceVariables,t,n),n},s.prototype.applyExplorationObjects=function(e,t,r,i){var a={};e&&e.merge&&(a.merge=h.clone(e.merge));var o,n=t.objects||{};for(o in a.merge)for(var s=0,l=a.merge[o];s<l.length;s++){var p,u=l[s],c=h.ensure(n,o,u.selector);for(p in u.properties){var d=u.properties[p];this.shouldApplyExplorationProperty(o,i)&&!h.propertiesAreEqual(c.properties[p],d)&&(r.objects=!0,c.properties[p]=d)}}return r.objects&&!t.objects&&(t.objects=n),r},s.prototype.isDisplayOptions=function(e){return void 0!==e&&void 0!==e.outspacePane&&void 0!==e.visuals},s.prototype.shouldApplyExplorationProperty=function(e,t){return"outspacePane"===e&&this.isDisplayOptions(t.suppressDisplay)?!t.suppressDisplay.outspacePane:!t.suppressDisplay},s.prototype.applyFilterState=function(e,t){for(var r={visualContainers:[],visualContainerGroups:[]},i=0,a=e;i<a.length;i++){var o=a[i],n=o.visual,s=o.state,l=n.config.singleVisual,p=this.plugins.capabilities(l.visualType),o=o.impacted;(o=this.applyObjects(s,l,s.objects,p.objects,t,r)||o)&&!_.includes(r.visualContainers,n)&&r.visualContainers.push(n)}return r},s.prototype.isActiveSection=function(e,t){return e===t.sections[t.activeSectionIndex].name},s.prototype.applyActiveSection=function(e,t,r){this.isActiveSection(e,t)||0<=(e=g.indexWithName(t.sections,e))&&(t.activeSectionIndex=e,r.activeSection=!0)},s.prototype.applyDataSourceVariables=function(e,t,r){e?(t.dataSourceVariables=e,r.dataSourceVariables=!0):t.dataSourceVariables=void 0},s.prototype.applyFilters=function(e,t,r,i,a,o,n,s,l){var p=!1,u=[],e={nameIdentifiedMerges:_.clone(e&&e.nameIdentifiedMerges||{}),exprIdentifiedMerges:__spreadArray([],e&&e.exprIdentifiedMerges||[]),typeIdentifiedMerges:__spreadArray([],e&&e.typeIdentifiedMerges||[]),transientFilters:__spreadArray([],e&&e.transientFilters||[])},p=this.applyRemainingFilters(e,t,0===r,i,u,o,n,s,l)||p;if(a&&t.filters)for(var c=t.filters.length-1;0<=c;c--){var d=t.filters[c];d?d.type!==C.FilterType.Passthrough&&(_.includes(u,d)||(2===d.howCreated?(t.filters.splice(c,1),this.addImpactCrossDrillSourceUpdate(n,t,0===r,i)):j(d),p=!0)):t.filters.splice(c,1)}return p&&this.setMinimumFilterScope(i,r),p},s.prototype.applyRemainingFilters=function(e,t,r,i,a,o,n,s,l){var p=this.applyTransientFilters(e,t,a),p=this.applyMatchingFilterByName(e,t,a)||p;if(!_.isEmpty(e.nameIdentifiedMerges)){for(var u in e.nameIdentifiedMerges)e.exprIdentifiedMerges.push(e.nameIdentifiedMerges[u]);e.nameIdentifiedMerges={}}p=this.applyMatchingFilterByExpr(e,t,r,a,s,l)||p,p=this.applyMatchingFilterByType(e,t,a)||p;o=this.applyDrillFilters(e,t,a,o);return p=o||p,o&&this.addImpactCrossDrillSourceUpdate(n,t,r,i),p},s.prototype.addImpactCrossDrillSourceUpdate=function(e,t,r,i){t&&r&&(t=this.filterGenerator.updateCrossDrillFromVisualContainersOperation(e,[t]),i.visualContainers=_.union(i.visualContainers,t))},s.prototype.applyMatchingFilterByName=function(i,a,o){if(_.isEmpty(i)||_.isEmpty(i.nameIdentifiedMerges)||_.isEmpty(a.filters))return!1;var e,n=!1,s=[];for(e in i.nameIdentifiedMerges)!(function(t){var r=i.nameIdentifiedMerges[t];r.name;var e=_.findIndex(a.filters,(function(e){return e.howCreated===r.howCreated&&!_.includes(o,e)&&e.name===t}));-1!==e&&(b.isSameFilter(a.filters[e].filter,r.filter)||(F(a.filters[e],r),n=!0),s.push(t),o.push(a.filters[e]))})(e);return s.forEach((function(e){delete i.nameIdentifiedMerges[e]})),n},s.prototype.applyMatchingFilterByExpr=function(p,u,c,d,m,v){if(_.isEmpty(p)||_.isEmpty(p.exprIdentifiedMerges))return!1;for(var f,g,h=!1,y=!1,C=__spreadArray([],p.exprIdentifiedMerges||[]),x=this;g=_.head(C);)!(function(){var r=g.howCreated;if(2===r)return C.splice(0,1);var e,t=_.remove(C,(function(e){return e===g||e.howCreated===r&&E.equals(e.expression,g.expression)})),i=[];if((u.filters||[]).forEach((function(e,t){!e||e.howCreated!==r||_.includes(d,e)||v(e)||!E.equals(e.expression,g.expression)||R(e)&&e.name!==g.name||i.push(t)})),_.isEmpty(i)&&c&&0===r&&(g.filter?(t.length,y||(y=!0,f=V.getAutoVisualFilterContainers(u,x.visualPluginOps,m,x.aggrOps)),(e=_.find(f,(function(e){return E.equals(e.expression,g.expression)})))&&((u.filters||(u.filters=[])).push(e),i.push(u.filters.length-1))):(_.remove(p.exprIdentifiedMerges,g),_.remove(t,g))),0<i.length){for(var a=Math.min(t.length,i.length);t.length>a;){var o=_.findIndex(t,(function(e){return _.isEmpty(e.filter)}));if(-1===o)break;t.splice(o,1)}for(var n=0;n<a;n++){var s=i[n];b.isSameFilter(u.filters[s].filter,t[n].filter)||(F(u.filters[s],t[n]),h=!0),d.push(u.filters[s])}for(n=a;n<t.length;n++){var l=T(t[n]);(u.filters||(u.filters=[])).push(l),d.push(l),h=!0}for(n=a;n<i.length;n++){s=i[n];j(u.filters[s]),h=!0}p.exprIdentifiedMerges=_.difference(p.exprIdentifiedMerges,t)}})();return h},s.prototype.applyDrillFilters=function(e,r,i,a){var o=!1;if(_.isEmpty(a)||_.isEmpty(e)||_.isEmpty(e.exprIdentifiedMerges))return o;for(var n=[],t=0,s=e.exprIdentifiedMerges;t<s.length;t++)!(function(t){if(2!==t.howCreated)return;if(!_.find(a,(function(e){return E.equals(t.expression,e)})))return;var e=_.find(r.filters,(function(e){return 2===e.howCreated&&!_.includes(i,e)&&E.equals(e.expression,t.expression)}));e?(b.isSameFilter(e.filter,t.filter)||(F(e,t),o=!0),i.push(e)):(e=T(t),(r.filters||(r.filters=[])).push(e),i.push(e),o=!0),n.push(t)})(s[t]);return e.exprIdentifiedMerges=_.difference(e.exprIdentifiedMerges,n),o},s.prototype.applyMatchingFilterByType=function(e,r,i){var a=!1;if(_.isEmpty(e)||_.isEmpty(e.typeIdentifiedMerges))return a;for(var o=[],t=0,n=e.typeIdentifiedMerges;t<n.length;t++)!(function(t){3===t.howCreated||t.howCreated;var e=_.find(r.filters,(function(e){return e.howCreated===t.howCreated&&!_.includes(i,e)}));e?(F(e,t),i.push(e)):(e=T(t),(r.filters||(r.filters=[])).push(e),i.push(e)),o.push(t),a=!0})(n[t]);return e.typeIdentifiedMerges=_.difference(e.typeIdentifiedMerges,o),a},s.prototype.applyTransientFilters=function(e,r,i){var a=!1;if(!_.isEmpty(e)&&!_.isEmpty(e.transientFilters)){for(var t=0,o=e.transientFilters;t<o.length;t++)!(function(t){5===t.howCreated&&t.isTransient;var e=_.find(r.filters,(function(e){return e.isTransient&&!_.includes(i,e)&&b.isSameFilter(e.filter,t.filter)}));e?(F(e,t),i.push(e)):(e=T(t),(r.filters||(r.filters=[])).push(e),i.push(e)),a=!0})(o[t]);e.transientFilters=[]}e=_.remove(r.filters,(function(e){return e&&e.isTransient&&!_.includes(i,e)}));return a=a||!_.isEmpty(e)},s.prototype.applySection=function(t,e,r,i,a,o,n){o.suppressData||o.targetVisualNames||this.applyFilters(e.filters,r,1,a,o.clearUnmatchedData,[],r,i,(function(e){return x.isLinkedAsAggregation(t,r,e)}));for(var s=0,l=r.visualContainers;s<l.length;s++){var p,u=l[s],c=u.name;o.targetVisualNames&&!_.includes(o.targetVisualNames,c)||(p=void 0,null!=(c=e.visualContainers&&e.visualContainers[c])?(p=this.applyVisualState(t,c,r,u,i,a,o,n,!0),c.highlight&&!o.suppressData&&n&&(_.isEmpty(c.highlight.selection),this.isSelectionValid(c.highlight.selection,u.config.singleVisual,i)&&(null==a.pendingHighlights&&(a.pendingHighlights=[]),o.suppressData,a.pendingHighlights.push({selection:c.highlight.selection,sourceVisualContainer:u,filterExpressionMetadata:c.highlight.filterExpressionMetadata})))):o.clearUnmatchedData&&(p=this.applyVisualState(t,{},r,u,i,a,o,n,!1)),_.isEmpty(p)||(u=_.without.apply(_,__spreadArray([p],a.visualContainers||[])),(p=a.visualContainers).push.apply(p,u||[])))}for(var d=this.getCrossHighlights(r),m=0,v=r.visualContainerGroups;m<v.length;m++){var f,g=v[m];C.isVisualContainerGroup(g)&&(null!=(f=e.visualContainerGroups&&e.visualContainerGroups[g.name])&&this.applyVisualGroupState(f,r,g,a,o,d))}},s.prototype.applyVisualState=function(e,t,r,i,a,o,n,s,l){var p,u,c,d,m,v,f,g=!1,h=t.singleVisual;n.suppressData||(d=null===(c=null===(v=n.defaultPresentationState)||void 0===v?void 0:v[r.name])||void 0===c?void 0:c[i.name],p=(f=this.presentationChangesAllowed(e,n,i,h,this.visualPluginOps))&&this.applyPresentationChanges(i,h,d,h&&h.parameters,a),y=!1,this.featureSwitchService.featureSwitches.fieldParameters&&(y=this.applyParameterStateByRole(a,i,h,f)),m=h&&h.orderBy,u=this.applySort(i.config.singleVisual,m,n.clearUnmatchedData),v=h&&h.activeProjections,c=this.applyActiveProjections(i.config.singleVisual,v,n.clearUnmatchedData),e=this.collectValidDrillExprs(i.config.singleVisual),d=this.applyFilters(t.filters,i,0,o,n.clearUnmatchedData,e,r,a,this.nonDrillthroughIsLinkedAsAggregationCallback),f=h&&h.expansionStates,m=this.applyExpansionStates(i,f,n.clearUnmatchedData,a),v=this.plugins.capabilities(i.config.singleVisual.visualType),e=h&&h.objects,f=!1,g=(f=v&&v.objects?this.applyObjects(h,i.config.singleVisual,e,v.objects,a,o):f)||p||u||c||d||m||y);var y=[];return this.getSuppressDisplayOptions(n).visuals||(null!=(t=t.visibility)&&s&&(o.visibility={visual:i,mode:t}),l&&!h||(l=!1,h?l=!!h.hidden:n.suppressUnmatchedClearHidden&&(l=N.isHidden(i.config.singleVisual)),y.push.apply(y,this.applyHidden(l,i,r)||[]))),g&&!_.includes(y,i)&&y.push(i),y},s.prototype.applyPresentationChanges=function(e,t,r,i,a){var o=e.config.singleVisual;if(!t)return!1;var n=!t.targetType;if(n&&!o.presentationChangesApplied)return!1;var s=!1,l=n?null==r?void 0:r.visualType:t.targetType,p=n?null==r?void 0:r.autoSelectVisualType:t.targetAutoSelectVisualType,t=n?null==r?void 0:r.projections:t.projections;l&&(s=l!==o.visualType,o.visualType=l),null!=p&&(s=s||p!==o.autoSelectVisualType,o.autoSelectVisualType=p),!o.query&&t&&(o.query=new P(S.create(),{},[]));p=o.query;return t&&p?(this.applyVisualQueryPresentationChanges(p,t,i,e,a),o.presentationChangesApplied=!n,!0):o.presentationChangesApplied=s},s.prototype.applyParameterStateByRole=function(e,t,n,s){if(!n||!n.parameters)return!1;var r=t.config.singleVisual;if(!r.query&&s)r.query=new P(S.create(),{},[]);else if(!r.query)return!1;var l,i=n.parameters,p=r.query,u={},c=p.getResolveParameterResultsByRole();for(l in i){var d=i[l];u[l]=[];var m=p.projections[l];if(m=!m&&s&&0<d.length?p.projections[l]=new o([]):m)for(var v=this,a=0;a<d.length;a++)!(function(e){var t=d[e];if(s){var r=p.addParameter(t.expr,l,t.index),i=m.getParameterByFieldIndex(r);(c[l]||(c[l]=[])).push({parameter:i,result:[]})}else{var a=_.find(u[l],(function(e){return E.equals(e.expr,t.expr)})),o=a?a.count:0,r=_.sortBy(m.findParameterBySQExpr(t.expr),(function(e){return e.index}));if(o>=r.length)return;i=r[o],a?a.count++:u[l].push({expr:t.expr,count:1})}a=c[l],a=_.find(a,(function(e){return e.parameter.index===i.index})),e=v.getProjectionsForParameter(d,e,n.projections,l);a.result=_.map(e,(function(e){return{expr:e,alias:void 0}}))})(a)}return this.visualAuthoringCore.resolveParameters(e,t,c,this.drillService,this.sortService,void 0).queryChange},s.prototype.getProjectionsForParameter=function(e,t,r,i){var a=[],o=e[t];if(void 0!==o.length&&0<o.length)for(var n=m.convertFieldIndexToProjectionIndexUsingParameters(o.index,e),s=n;s<n+o.length;s++)a.push(r[i][s]);return a},s.prototype.applyVisualQueryPresentationChanges=function(e,t,r,i,a){for(var o in e.projections)this.visualAuthoringCore.removeAllParametersAndProjectionsFromRole(o,i,a,this.drillService,this.sortService);for(var o in t){for(var n=this.getNonParameterExpressions(t[o],r,o),s=void 0,s=0;s<n.length;s++){var l=n[s],p=!1;if(e.projections[o])for(var u=e.tryGetExprs(o),c=s;c<u.length;c++){var d=u[c];if(f.SQExpr.equals(d,l,!0,!0,!0)){p=!0,c!==s&&e.moveProjection(o,c,s,1);break}}p||e.add(l,o,{fieldIndex:s})}if(e.projections[o])for(var m=e.tryGetExprs(o).length;m>n.length&&0<m;)e.removeProjection(o,{fieldIndex:--m})}for(var o in e.projections)if(null==(n=this.getNonParameterExpressions(t[o],r,o))||!n.length)for(var m=e.tryGetExprs(o).length,v=0;v<m;v++)e.removeProjection(o,{fieldIndex:0})},s.prototype.getNonParameterExpressions=function(e,t,a){if(e){for(var o=[],r=0;r<e.length;r++)!(function(r){var i=t&&t[a];if(i&&0<i.length&&_.find(i,(function(e){var t=m.convertFieldIndexToProjectionIndexUsingParameters(e.index,i);return void 0!==e.length&&0<e.length&&t<=r&&r<=t+e.length-1})))return;null!==e[r]&&o.push(e[r])})(r);return o}},s.prototype.applyVisualGroupState=function(i,a,o,n,s,l){var e,t,r=o.name;if(s.targetVisualNames&&!_.includes(s.targetVisualNames,r)||(e=void 0,this.getSuppressDisplayOptions(s).visuals||(t=i.isHidden,r=o.isHidden,null!=t&&t!==r&&(o.isHidden=t,e=!0),t&&!_.isEmpty(l)&&(t=this.clearCrossHighlightsForGroup(o,a,l),n.visualContainers=_.chain(n.visualContainers).concat(t).uniq().value())),e&&n.visualContainerGroups.push(o)),!_.isEmpty(i.children)){var p,u=this;for(p in i.children)!(function(t){var e=i.children[t],r=_.find(o.children,(function(e){return e.name===t}));if(!e||!r||!C.isVisualContainerGroup(r))return;u.applyVisualGroupState(e,a,r,n,s,l)})(p)}},s.prototype.getSuppressDisplayOptions=function(e){e=e.suppressDisplay;return this.isDisplayOptions(e)?e:{outspacePane:e,visuals:e}},s.prototype.applyFilterExpressionCache=function(e,t,r){r?this.clearFilterExpressionCache(t):(t.filterExpressionMetadata=e.filterExpressionMetadata,t.cachedFilterDisplayItems=e.cachedFilterDisplayItems)},s.prototype.clearFilterExpressionCache=function(e){e.filterExpressionMetadata=void 0,e.cachedFilterDisplayItems=void 0},s.prototype.applyHidden=function(e,t,r){var i=t.config.singleVisual;if(e!==N.isHidden(i)){N.setHidden(i,e);i=[t];return i=e?_.chain(i).concat(this.clearCrossHighlightsForVisual(t,r)).uniq().value():i}},s.prototype.clearCrossHighlightsForGroup=function(e,t,r){var i,a=[];return C.traverseVisualContainerGroups([e],(function(t){C.isVisualContainer(t)&&_.some(r,(function(e){return e.sourceVisualContainer===t}))&&a.push(t)})),(i=!_.isEmpty(a)?this.clearCrossHighlightsForVisuals(a,t):i)||[]},s.prototype.clearCrossHighlightsForVisual=function(e,t){return this.clearCrossHighlightsForVisuals([e],t)},s.prototype.clearCrossHighlightsForVisuals=function(e,t){var r=__spreadArray([],e||[]);return r.push.apply(r,this.filterGenerator.clearCrossHighlightForVisualContainersOperation(t,e)||[]),_.uniq(r)},s.prototype.collectValidDrillExprs=function(e){var t=e.query;if(!t)return[];var r=t.defn.select();if(_.isEmpty(r))return[];var i,a=[];for(i in t.projections)for(var o=t.projections[i],n=o.activeProjectionRefs||[],s=_.last(n),l=0,p=o.all();l<p.length;l++){var u=p[l];if(s&&u.queryRef===s)break;u=r.withName(u.queryRef);a.push(u.expr)}return a},s.prototype.applyActiveProjections=function(e,p,t){var u=e.query;if(!u)return!1;var c=u.defn.select(),e=this.plugins.capabilities(e.visualType),d=e&&e.drilldown&&e.drilldown.roles||[],m=!1,v={};for(r in p)!(function(e){if(!_.includes(d,e))return;var t=p[e];v[e]||(v[e]=[]);var r=u.projections[e];if(!r)return m=!0;var i=r.all();if(_.isEmpty(i))return m=!0;if(t.length>i.length)return m=!0;if(1===t.length){var a=t[0],r=_.find(i,(function(e){e=c.withName(e.queryRef);return E.equals(e.expr,a)}));if(!r)return m=!0;v[e].push(r.queryRef)}else for(var o=0;o<t.length;o++){i.length;var n=t[o],s=i[o],l=c.withName(s.queryRef);E.equals(l.expr,n)?v[e].push(s.queryRef):m=!0}})(r);if(m)for(var r in u.projections)v[r]=[];var i=!1;for(r in u.projections)if(_.includes(d,r)){var a=u.projections[r],o=v[r];if(_.isEmpty(o)){if(!t)continue;var n=a.all();_.isEmpty(n)||(o=[_.head(n).queryRef])}g.sequenceEqual(a.activeProjectionRefs,o,(function(e,t){return e===t}))||(a.activeProjectionRefs=o,i=!0)}return i},s.prototype.applySort=function(e,t,r){var i=e.query;if(!i)return!1;e=i.defn.orderBy()||[];return!(!t&&!r)&&(!g.sequenceEqual(e,t=t||[],f.SQUtils.sqSortDefinitionEquals)&&(i.orderBy(t),!0))},s.prototype.applyObjects=function(e,t,r,i,a,o){var n={};r&&(r.merge&&(n.merge=h.clone(r.merge)),r.remove&&(n.remove=r.remove.slice()));var s=t.objects||{},l=c.findFilterOutput(i),r=this.plugins.getPlugin(t.visualType);this.applyPluginUpdateSemantics(r,n,s,i),n.remove||(n.remove=this.getVisualPropertiesToRemove(t.visualType,s,n.merge));var a=this.mergeObjects(e,t,n.merge,s,o,a,l),p=p||a.visualImpacted;return n.remove=n.remove.concat(a.removeList),p=this.removeObjects(t,s,n.remove,o,l)||p},s.prototype.updateQueryProjectionsFromExpansionState=function(p,e,u){var c=this;if(_.isEmpty(e))return!1;for(var t=function(s){function l(e){return e=s.roles[e],p.projections[e],p.projections[e]&&p.projections[e].all()}var e=s.getVisibleDescendentsDepth(s.root,-1),t=Math.max(_.findLastIndex(s.levels,(function(e){return e.isPinned}))+1,e),r=function(t){for(var i=0,a=l(0),o=0,n=0;n<_.size(s.levels);n++,o++)if("break"===(function(){if(o===_.size(a)){if(o=0,++i>=_.size(s.roles))return"break";if(!(a=l(i)))return"break"}var r=s.levels[n];_.size(r.queryRefs);var e=_.findIndex(a,(function(e){var t=null===(t=m.tryGetExprByProjection(p.defn,e))||void 0===t?void 0:t.expr;return e.queryRef===_.first(r.queryRefs)&&c.verifyExpansionIdentities(r,t,u)}),t?o:0);if(-1===e)return"break";t&&o!==e&&p.moveProjection(s.roles[i],e,o,1)})())break;return n};if(!(t<=r(!1)))return{value:!1};_.remove(p.expansionStates,(function(e){return _.isEqual(e.roles,s.roles)})),r(!0);var i=s.clone();p.setActiveProjections(i.roles,e);t=p.getRolesUniqueProjectionRefs(i.roles),r=_.findIndex(i.levels,(function(e){return e.isCollapsed}));i.updateLevels(t,-1===r?e:r),p.expansionStates||(p.expansionStates=[]),p.expansionStates.push(i)},r=0,i=e;r<i.length;r++){var a=t(i[r]);if("object"==typeof a)return a.value}return!0},s.prototype.applyExpansionStates=function(r,e,t,a){var o=this,i=r.config.singleVisual,n=i.query;if(!n)return!1;var s=n.expansionStates||[];if(!e&&!t)return!1;if(f.ExpansionState.areEqual(s,e=e||[]))return!1;i=this.plugins.capabilities(i.visualType);return i&&i.expandCollapse&&i.expandCollapse.restoreProjectionsOrderFromBookmark?this.updateQueryProjectionsFromExpansionState(n,e,a):(n.expansionStates=f.ExpansionState.clone(_.filter(e,(function(e){e.roles.length;var t=n.projections[e.roles[0]],i=t&&t.all()||[];return!(!o.expandCollapse.isEnabled(r,e.roles)||1!==e.roles.length||i.length<e.levels.length)&&_.every(e.levels,(function(e,t){e.queryRefs.length;var r=i[t],t=null===(t=m.tryGetExprByProjection(n.defn,r))||void 0===t?void 0:t.expr;return r.queryRef===e.queryRefs[0]&&o.verifyExpansionIdentities(e,t,a)}))}))),!0)},s.prototype.verifyExpansionIdentities=function(e,t,r){var i=new a;return _.isEmpty(e.identityKeys)||g.sequenceEqual(e.identityKeys,t.accept(i,r),E.equals)},s.prototype.applyPluginUpdateSemantics=function(e,t,r,i){if(t&&e&&e.mergeObjects){var a=k.visuals.visualStyles.create(),r=d.evaluateMetadataOnceDataViewObjectDefinitions(r,i,a,this.featureSwitchService.featureSwitches).dataViewObjects,a=d.evaluateMetadataOnceDataViewObjectDefinitions(t.merge||{},i,a,this.featureSwitchService.featureSwitches).dataViewObjects,a=e.mergeObjects({objects:r,changes:a});if(a){if(null==a.removeObject&&a.replace,a.merge){t.merge={};for(var o=0,n=a.merge;o<n.length;o++)for(p in(l=n[o]).properties){var s=e.capabilities.objects[l.objectName].properties[p].type,s=h.encodePropertyValue(l.properties[p],s);h.setValue(t.merge,{objectName:l.objectName,propertyName:p},l.selector,s)}}if(a.remove){t.remove=[];for(var l,p,u=0,c=a.remove;u<c.length;u++)for(p in(l=c[u]).properties)t.remove.push({object:l.objectName,property:p,selector:l.selector})}}}},s.prototype.mergeObjects=function(e,t,r,i,a,o,n){var s,l={visualImpacted:!1,removeList:[]};if(_.isEmpty(r))return l;for(s in r)for(var p=0,u=r[s];p<u.length;p++){var c,d=u[p],m=h.ensure(i,s,d.selector);for(c in d.properties){var v=d.properties[c];if(!h.propertiesAreEqual(m.properties[c],v)){if(n&&y.propertyIdentifiersEqual(n,{objectName:s,propertyName:c})){var f=!!this.isFilterValid(v,t,o);if(this.applyFilterExpressionCache(e,t,!f),!f){l.removeList.push({object:n.objectName,property:n.propertyName,selector:null});continue}this.setMinimumFilterScope(a,1)}m.properties[c]=v,l.visualImpacted=!0,t.objects||(t.objects=i)}}}return l},s.prototype.removeObjects=function(e,t,r,i,a){if(_.isEmpty(r))return!1;for(var o=!1,n=0,s=r;n<s.length;n++){var l=s[n],p=l.selector,u=l.object,l=l.property;h.deleteProperty(t,u,p,l)&&(o=!0,a&&y.propertyIdentifiersEqual(a,{objectName:u,propertyName:l})&&(this.clearFilterExpressionCache(e),this.setMinimumFilterScope(i,1)))}return o},s.prototype.getVisualPropertiesToRemove=function(e,t,r){var i=this.plugins.capabilities(e);if(!i||!i.objects)return[];var a,o=c.findFilterOutput(i.objects),n=[];for(a in i.objects){var s,l=i.objects[a];for(s in l.properties){var p,u=l.properties[s];!this.featureSwitchService.featureSwitches.clearUnmatchedObjectState&&u.persistUnmatchedState||(u.filterState||u.captureState||o&&y.propertyIdentifiersEqual(o,{objectName:a,propertyName:s}))&&(u=h.getValue(r,p={objectName:a,propertyName:s},null),h.getValue(t,p,null)&&!u&&n.push({object:a,property:s,selector:null}))}}return n},s.prototype.isFilterValid=function(e,t,r){t=t.query;if(!t)return!1;r=new I(t.defn,r);return e.rewrite(r),r.valid},s.prototype.isSelectionValid=function(e,t,r){var i=f.Selector.filterFromSelectorsByColumn(e),a=new f.SemanticQueryRewriter(f.SQExprRemoveEntityVariablesRewriter.instance).rewriteFrom(i.from()),e=_.map(i.where(),(function(e){return{condition:e.condition.accept(f.SQExprRemoveEntityVariablesRewriter.instance)}})),i=new b(a,e);return this.isFilterValid(i,t,r)},s.prototype.setMinimumFilterScope=function(e,t){e.filterScope?e.filterScope=Math.max(t,e.filterScope):e.filterScope=t},s.prototype.getAdditionalVisualFiltersToCapture=function(e,t){for(var r=[],i=0,a=V.getAutoVisualFilterContainers(e,this.visualPluginOps,t,this.aggrOps)||[];i<a.length;i++)!(function(t){_.find(e.filters,(function(e){return E.equals(e.expression,t.expression)}))||r.push(t)})(a[i]);return r},s.prototype.presentationChangesAllowed=function(e,t,r,i,a){if(!e.settings||!e.settings.allowInlineExploration)return!1;if(!t.applyPresentationChanges)return!1;t=r&&r.config&&r.config.singleVisual;if(!t)return!1;var r=[function(e){return a.isQnaVisual(e)},function(e){return a.isQueryVisual(e)}],o=i&&i.visualType;if(!r.some((function(e){return e(o)})))return!1;t=t&&t.vcObjects,t=h.getValue(t,{objectName:"visualHeader",propertyName:"showPersonalizeVisualButton"},null);return!t||!1!==t.value},s);function s(e,t,r,i,a,o,n,s,l,p){this.expandCollapse=e,this.filterGenerator=t,this.plugins=r,this.visualPluginOps=i,this.aggrOps=a,this.featureSwitchService=o,this.sortService=n,this.drillService=s,this.nonDrillthroughIsLinkedAsAggregationCallback=function(e){return e.howCreated,!1},this.visualAuthoringCore=u(r,l,a,o,p)}var A,I=(A=f.SQExprRewriter,__extends(O,A),O.prototype.visitColumnRef=function(e){return this.valid=this.valid&&this.exprInSelects(e),e},O.prototype.exprInSelects=function(t){var e=_.some(this.query.select(),(function(e){return E.equals(e.expr,t,!0,!0)}));if(e)return!0;if(!this.schema)return e;for(var r=0,i=this.query.select();r<i.length;r++){var a=i[r].expr.getKeyColumns(this.schema);if(_.some(a,(function(e){return E.equals(t,e,!0,!0)})))return!0}return!1},O);function O(e,t){var r=this;return(r=A.call(this)||this).valid=!0,r.query=e,r.schema=t,r}})((e=k.explore||(k.explore={})).services||(e.services={}))})(powerbi=powerbi||{}),(function(a){var o,e,n,s,l,p,u;function c(e,t){var r=a.data.SQExprUtils.getDefaultValue(e,t);if(r){t=o.FilterUtils.getFormatter(e,t);return a.data.RestatementHelper.fromDefault(t.format(r.value))}}function d(e){return e.constant?e.constant.value:e.dateSpan?e.dateSpan.value:void 0}o=a.explore||(a.explore={}),e=(e=o.services||(o.services={})).filterRestatementUtil||(e.filterRestatementUtil={}),n=a.data.isFilterComparisonPattern,s=a.data.RelativeDateRangeHelper,l=a.data.SQExprBuilder,p=a.data.RelativeFilterType,u=a.data.RelativeDateFilterPattern,e.visitBetweenHelper=function(e){e.lower,e.upper;var t=e.lower.value,e=e.upper.value;return s.getDateRangeRestatement({min:t,max:e})},e.visitRelativeDateRangeHelper=function(e,t,r,i){return s.getRestatement(e.options,i,t,r)},e.visitComparisonFilterPatternHelper=function(e,t,r){var i=l.fieldExpr(e.arg);if(e.condition.defaultValue)return c(i,t);if(!e.condition.anyValue){t=o.FilterUtils.getFormatter(i,t),r=r||d(e.condition);return a.data.RestatementHelper.fromCondition([new a.data.Condition(e.filterOperator,r,t)],2)}},e.getDefaultValueRestatement=c,e.getAdvancedFilterPatternRestatement=function(e,t,r){return t=(function e(t,r){{if(n(t)){var i=l.fieldExpr(t.arg),i=o.FilterUtils.getFormatter(i,r);return[new a.data.Condition(t.filterOperator,d(t.condition),i)]}return __spreadArray(__spreadArray([],e(t.left,r)||[]),e(t.right,r)||[])}})(e,t),a.data.RestatementHelper.fromCondition(t,e.logicalOperator,void 0,r)},e.updateRelativeTimeRestatementOnToggle=function(e,t,r,i,a,o){t.get(e).then((function(){var e=i.contract,t=u.extractParametersFromSemanticFilter(e.filter,p.Time),e=t&&t.options;e&&(t=o&&i.isFilterExpanded(),t=s.getRestatement(e,t,(function(e,t){return r.format(e,t)}),a),i.setRestatement(t))}))}})(powerbi=powerbi||{}),(function(l){!(function(e){var t,a,o,n,s;function r(e,t,r,i,a,o){this.schema=e,this.locOptions=t,this.visualTimeSynchronizationService=r,this.networkAvailabilityService=i,this.displayNameServiceVisitor=a,this.displayOptions=o}t=e.services||(e.services={}),a=l.explore.util.DisplayNameServiceUtils,o=l.data.FieldExprPattern,n=l.data.SQExprBuilder,s=jsCommon.StringExtensions,r.prototype.visitIn=function(e){var r=this,i=e.args,t=e.values,t=_.map(t,(function(e){return _.map(e,(function(e,t){t=n.fieldExpr(i[t]),t=t&&t.getMetadata(r.schema);return l.visuals.valueFormatter.format(e.value,t&&t.format)})).join(" ")})),t=a.concatStrings(t,"Generic_Or",this.locOptions);if(this.displayOptions&&this.displayOptions.includeFieldNamesInFilter){e=e.args,e=_.map(e,(function(e){return o.visit(e,r.displayNameServiceVisitor)})).join(" ");return s.format(this.locOptions.stringResourceProvider.get("VisualTitle_Is_Template"),e,t)}return t},r.prototype.visitBetween=function(e){return t.filterRestatementUtil.visitBetweenHelper(e)},r.prototype.visitRelativeDateRange=function(e){var r=this;return t.filterRestatementUtil.visitRelativeDateRangeHelper(e,(function(e,t){return r.locOptions.stringResourceProvider.format(e,t)}),this.visualTimeSynchronizationService.getAnchorTime(),this.networkAvailabilityService.isNetworkAvailable())},r.prototype.visitTopN=function(e){},r.prototype.visitCompare=function(e){return t.filterRestatementUtil.visitComparisonFilterPatternHelper(e,this.schema)},r.prototype.visitAdvanced=function(e){return t.filterRestatementUtil.getAdvancedFilterPatternRestatement(e,this.schema)},r.prototype.visitComplex=function(e){},r.prototype.visitComposite=function(e){},r.prototype.visitHierarchical=function(e){},t.FilterRestatementVisitor=r})(l.explore||(l.explore={}))})(powerbi=powerbi||{}),(function(n){var t;(function(s){var a=t.util.VisualContainerUtils;s.createVisibilityService=function(e,t,r,i){return new o(e,t,r,i)};var o=(e.prototype.get=function(e){var t=this.explorationNavigation.getCurrentSection(),t=t&&t.poppedOutElement;if(t)return(e=e||11)&t.visibility?t.visualContainer:void 0},e.prototype.set=function(t,e,r){var i,a,o,n;void 0===r&&(r=!0),0!==e?(s.selectionUtils.selectCanvasItem(t,this.selectionService),i={visualContainer:t,visibility:e},o=this.explorationNavigation.getAllSections(),(a=_.find(o,(function(e){return 0<=e.visualContainers.indexOf(t)})))&&(n=a&&a.poppedOutElement,(o=(o=i)||null)===(n=(n=n)||null)||!o==!n&&o.visualContainer===n.visualContainer&&o.visibility===n.visibility||(this.clearInternal(!1,!1),this.setMode(i,e,r),a.poppedOutElement=i,this.poppableItem=i,this.raiseEvent(this.generateVisibilityChangedEventArgs(e))))):this.clearInternal(!0,r)},e.prototype.clear=function(){this.clearInternal()},e.prototype.clearForVisualContainers=function(e){var t=this.explorationNavigation.getCurrentSection(),r=t&&t.poppedOutElement;if(r)for(var i=0,a=e;i<a.length;i++){var o=a[i];if(r.visualContainer===o){this.clearInternal();break}}},e.prototype.clearInternal=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!0);var r,i=this.explorationNavigation.getCurrentSection(),a=i&&i.poppedOutElement;a&&(r=this.poppableItem.visibility,this.setMode(a,0,t),i.poppedOutElement=void 0,e&&this.raiseEvent(this.poppableItem&&this.poppableItem.visualContainer===a.visualContainer?this.generateVisibilityChangedEventArgs(r):void 0),this.poppableItem=void 0)},e.prototype.isSeeDataMode=function(e){return e&&(2===e||8===e)},e.prototype.updatePopOutMode=function(){var e=s.selectionUtils.getDefaultSelectedVisualInSingleOrMultiCase(this.selectionService);e&&t.contracts.isVisualContainer(e)&&null!=e.visibility&&0!==e.visibility?this.set(e,e.visibility,!1):this.clearInternal(!0,!1)},e.prototype.raiseEvent=function(e){this.eventBridge.publishToChannel(s.events.visibilityChanged,e)},e.prototype.setMode=function(e,t,r){var i=e.visualContainer;r&&(r=(function(e){switch(e){case 1:return"Maximized";case 2:return"MaximizedWithData";case 8:return"MaximizedWithAccessibleData";case 4:return"Spotlight";default:return"Normal"}})(t),this.telemetryService.logEvent(n.telemetry.EXToggleVisualDisplay,{visualType:a.getVisualType(i),displayType:r,visualName:e.visualContainer.name})),i.visibility=t},e.prototype.generateVisibilityChangedEventArgs=function(e){return{preserveScroll:4===e}},e);function e(e,t,r,i){var a=this;this.telemetryService=e,this.eventBridge=t,this.selectionService=r,this.explorationNavigation=i,this.selectionService=r,t.createChannelSubscriptionManager().subscribe(s.events.selectionChanged,(function(){return a.updatePopOutMode()}))}})((t=n.explore||(n.explore={})).services||(t.services={}))})(powerbi=powerbi||{}),(function(a){var e;(function(e){var t=a.data.DataViewObjectDescriptors;e.createVisualCapabilitiesService=function(e){return new r(e)};var r=(i.prototype.hasFilterCapabilities=function(e){e=this.visualPlugins.getPlugin(e);return!!(e&&e.capabilities&&e.capabilities.objects&&t.findFilterOutput(e.capabilities.objects))},i);function i(e){this.visualPlugins=e,this.visualPlugins}})((e=a.explore||(a.explore={})).services||(e.services={}))})(powerbi=powerbi||{}),(function(e){(function(e){e.createVisualLifecycleService=function(){return new t};var t=(r.prototype.add=function(e){this.visualIds[e]=1},r.prototype.delete=function(e){delete this.visualIds[e]},r.prototype.has=function(e,t){void 0===t&&(t=!0);var r=1===this.visualIds[e];return r&&t&&this.delete(e),r},r);function r(){this.visualIds={}}e.VisualLifecycleService=t})((e=e.explore||(e.explore={})).services||(e.services={}))})(powerbi=powerbi||{}),(function(n){var a;(function(e){var r=n.data.DataViewObjectDescriptors,o=a.util.VisualContainerUtils;e.createVisualPluginOps=function(e,t){return new i(e,t)};var i=(t.prototype.canEdit=function(e,t){e=this.plugins.capabilities(e);switch(e&&e.advancedEditModeSupport){case 1:return!0;case 2:return t;default:return!1}},t.prototype.dataViewKinds=function(e,t){if(e){var r=this.plugins.capabilities(e);if(r){var i=r.dataViewMappings,a=n.DataViewMapping.targetDataViewKinds(i);return t&&(r=o.createRoleKindByQueryRef(t),r=n.DataViewAnalysis.chooseDataViewMappings(t.projections,i,r,this.featureSwitchService.featureSwitches),a=n.DataViewMapping.targetDataViewKinds(r.supportedMappings),"map"===e&&1&a&&n.visuals.MapPluginMethods.mightRequireMatrixForUnpivot(t.projections,r.supportedMappings)&&(a|=2)),a||void 0}}},t.prototype.targetedDataViewKinds=function(e,t){var r=31;return r=!this.plugins.isCustomVisual(e)?this.dataViewKinds(e,t)||31:r},t.prototype.supportsFocusMode=function(e){e=this.plugins.capabilities(e);return e&&e.dataViewMappings&&!e.disableFocusMode},t.prototype.isSupportedVisual=function(e){e=o.getVisualType(e);return!!e&&!!this.plugins.getPlugin(e)},t.prototype.canConvertVisual=function(e){if(!e)return!1;var t=o.getVisualType(e);if(!t)return!1;var r=this.plugins.capabilities(t);return(this.isQueryVisual(t)||!(!r||!r.isConvertible))&&!o.hasGroupByItemsInQuery(e)},t.prototype.canFormatVisual=function(e){return!!e&&!o.hasGroupByItemsInQuery(e)},t.prototype.canSummarizeVisual=function(e){e=this.plugins.getPlugin(e);return!!e&&(this.isAnalysisVisualPlugin(e)?!!e.getAnalysisVisualNarrativeSummaryConfiguration:!!e.getNarrativeSummaryBindings)},t.prototype.isAnalysisVisualPlugin=function(e){return this.isAnalysisVisual(e.name)},t.prototype.isQueryVisual=function(e){var t=this.plugins.capabilities(e);return!t||!this.isQueryDisabled(e,t)&&null!=t.dataViewMappings},t.prototype.isQueryDisabled=function(e,t){if(t&&n.ScriptResultUtil.findScriptResultMapping(t.dataViewMappings))return!this.plugins.isScriptVisualQueryable(e)},t.prototype.supportVisualSearch=function(e){var t=this.plugins.capabilities(e);return!(!t||!this.isQueryVisual(e))&&!!r.findSelfFilter(t.objects)},t.prototype.isAnalysisVisual=function(e){return e===n.visuals.plugins.keyDriversVisual.name},t.prototype.isQnaVisual=function(e){return e===n.visuals.plugins.qnaVisual.name},t);function t(e,t){this.plugins=e,this.featureSwitchService=t}})((a=n.explore||(n.explore={})).services||(a.services={}))})(powerbi=powerbi||{}),(function(V){var e;(function(e){var s=V.explore.services.downgrade,t=V.explore,r=t.contracts,o=V.explore.services.upgrade.CurrentExplorationStateVersion,l=V.data.services.DataViewObjectSerializer,p=V.data.services.DisplayNameSerializer,u=V.data.services.ExpansionStateSerializer,c=t.services.upgrade.ExplorationStateVersions,n=t.services.upgrade.ExplorationStateFeatureVersions,d=t.contracts.VisualContainer,m=V.data.services.FilterExpressionMetadataSerializer,v=V.data.services.SemanticQuerySerializer,f=V.explore.services.upgrade,g=jsCommon.Version;function h(e){if(e){var t={};return e.byName&&(t.nameIdentifiedMerges=_.mapValues(e.byName,i)),e.byExpr&&(t.exprIdentifiedMerges=_.map(e.byExpr,i)),e.byType&&(t.typeIdentifiedMerges=_.map(e.byType,i)),e.byTransientState&&(t.transientFilters=_.map(e.byTransientState,i)),t}}function i(e){return{name:e.name,type:r.FilterType[e.type],filter:e.filter?v.deserializeFilter(e.filter):void 0,expression:e.expression?v.deserializeExpr(e.expression):void 0,restatement:e.restatement,howCreated:e.howCreated,precedence:e.precedence,isTransient:e.isTransient,cachedValueItems:p.deserializeFilterLabelIdPairs(e.cachedDisplayNames),filterExpressionMetadata:e.filterExpressionMetadata?m.deserializeFilterExpressionMetadata(e.filterExpressionMetadata):void 0}}function y(e){return{isHidden:e.isHidden,children:e.children&&_.mapValues(e.children,y)}}function C(e,t){if(e){var r,i,a,o,n={visualType:e.visualType};return null!=e.autoSelectVisualType&&(n.autoSelectVisualType=e.autoSelectVisualType),e.objects&&(n.objects=b(e.objects)),e.orderBy&&(n.orderBy=v.deserializeSortDefinitions(e.orderBy,null)),e.targetType&&(n.targetType=e.targetType),null!=e.targetAutoSelectVisualType&&(n.targetAutoSelectVisualType=e.targetAutoSelectVisualType),e.activeProjections&&(n.activeProjections=x(e.activeProjections)),_.isEmpty(e.parameters)||(n.parameters=(function(e){var t,r;for(r in e){var i=e[r];_.isEmpty(i)||((t=t||{})[r]=_.map(i,(function(e){return{expr:v.deserializeExpr(e.expr),index:e.index,length:e.length}})))}return t})(e.parameters)),e.projections&&(n.projections=x(e.projections)),e.display&&"hidden"===e.display.mode&&(n.hidden=!0),e.cachedFilterDisplayItems&&(n.cachedFilterDisplayItems=p.deserializeFilterLabelIdPairs(e.cachedFilterDisplayItems)),e.filterExpressionMetadata&&(n.filterExpressionMetadata=m.deserializeFilterExpressionMetadata(e.filterExpressionMetadata)),e.expansionStates&&(r=(o=t.capabilities(e.visualType))&&o.expandCollapse&&o.expandCollapse.supportsMerge,i=o&&o.expandCollapse&&o.expandCollapse.collapseParentAfterRemovingChildLevel,a=o&&o.noDefaultProjections,n.expansionStates=u.deserializeExpansionStates(e.expansionStates,{supportsMerge:r,canCollapseRoot:a,collapseParentAfterRemovingChildLevel:i})),e.mobileVcObjects&&(n.mobileVcObjects=l.deserializeObjects(e.mobileVcObjects,d.CommonObjectDescriptors)),e.mobileObjects&&(o=(o=t.capabilities(e.visualType))&&o.objects,n.mobileObjects=l.deserializeObjects(e.mobileObjects,o)),n}}function x(e){var t,r;for(r in e){var i=e[r];_.isEmpty(i)||((t=t||{})[r]=_.map(i,(function(e){return null===e?null:v.deserializeExpr(e)})))}return t}function b(e){var t={};return e.merge&&(t.merge=l.deserializeObjects(e.merge,null)),e.remove&&(t.remove=_.map(e.remove,a)),t}function a(e){return{object:e.object,property:e.property,selector:l.deserializeSelector(e.selector)}}function S(e,t,r,i){return new E(r).serializeSingleVisual(e,t,i)}e.clearUnusedReferences=function(e,t){for(var r,i,a={},o=!1,n=0,s=t.sections;n<s.length;n++)for(var l,p=0,u=(l=s[n]).visualContainers;p<u.length;p++)a[u[p].name]=!0;for(r in e.sections)for(i in(l=e.sections[r]).visualContainers)a[i]||(o=!0,delete l.visualContainers[i]);return o},e.cloneSingleVisual=function(e,t,r){return C(S(e,null,r,t),t)},e.deserialize=function(e,r,t,i){null!=i&&i.runUpgraders&&(a=f.ExplorationStateVersionToExplorationVersion[e.version],e=f.createExplorationStateUpgrader(t).upgrade(e,a));var a={activeSection:e.activeSection,filters:h(e.filters),sections:_.mapValues(e.sections,(function(e){return t=r,{filters:h((e=e).filters),visualContainers:_.mapValues(e.visualContainers,(function(e){return (function(e,t){t=C(e.singleVisual,t);return{filters:h(e.filters),singleVisual:t,visibility:e.singleVisual?(function(e){if(debug.assertAnyValue(e,"display"),e&&e.mode)switch(e.mode){case"maximize":switch(e.maximizedOptions&&e.maximizedOptions.dataTable){case"accessible":return 8;case"normal":return 2;default:return 1}case"spotlight":return 4}})(e.singleVisual.display):void 0,highlight:e.highlight?(function(e){return{selection:l.deserializeSelection(e.selection),filterExpressionMetadata:e.filterExpressionMetadata?m.deserializeFilterExpressionMetadata(e.filterExpressionMetadata):void 0}})(e.highlight):void 0}})(e,t)})),visualContainerGroups:e.visualContainerGroups&&_.mapValues(e.visualContainerGroups,y)};var t}))};return e.objects&&(a.objects=b(e.objects)),e.dataSourceVariables&&(a.dataSourceVariables=e.dataSourceVariables),a},e.serialize=function(e,t,r,i,a){var o,n=new E(t),t={version:void 0,activeSection:e.activeSection,filters:n.serializeFilters(e.filters),sections:_.mapValues(e.sections,(function(e){return n.serializeSection(e,r)}))};return e.objects&&(t.objects=n.serializeObjects(e.objects),n.version=g.max(n.version,c.v1_3)),e.dataSourceVariables&&(t.dataSourceVariables=e.dataSourceVariables,n.version=g.max(n.version,c.v1_4)),null!=i&&i.runDowngraders&&n.version!==f.CurrentExplorationStateVersion&&(a=s.createExplorationStateDowngrader(a),o=f.ExplorationStateVersionToExplorationVersion[n.version],o=a.getFinalExplorationVersion(e,o),a.downgrade(t,o),t.version=_.findKey(f.ExplorationStateVersionToExplorationVersion,(function(e){return e===o})),t.version),t.version=t.version||n.version,t},e.serializeFilterContainer=function(e,t){return new E(t).serializeFilterContainer(e)},e.serializeHighlightState=function(e,t){return new E(t).serializeHighlightState(e)},e.serializeSingleVisual=S;var E=(N.prototype.serializeFilters=function(e){var t=this;if(e){var r={};return e.nameIdentifiedMerges&&(r.byName=_.mapValues(e.nameIdentifiedMerges,(function(e){return t.serializeFilterContainer(e)}))),e.exprIdentifiedMerges&&(r.byExpr=_.map(e.exprIdentifiedMerges,(function(e){return t.serializeFilterContainer(e)}))),e.typeIdentifiedMerges&&(r.byType=_.map(e.typeIdentifiedMerges,(function(e){return t.serializeFilterContainer(e)}))),e.transientFilters&&(r.byTransientState=_.map(e.transientFilters,(function(e){return t.serializeFilterContainer(e)}))),r}},N.prototype.serializeFilterContainer=function(e){var t=e.filterExpressionMetadata?m.serializeFilterExpressionMetadata(e.filterExpressionMetadata,this.featureSwitchService&&this.featureSwitchService.featureSwitches.serializeSpaceOptimization):void 0;return{name:e.name,type:null!=e.type?r.FilterType[e.type]:void 0,filter:e.filter?v.serializeFilter(e.filter):void 0,expression:e.expression?v.serializeExpr(e.expression):void 0,restatement:e.restatement,howCreated:e.howCreated,isTransient:e.isTransient,cachedDisplayNames:p.serializeFilterLabelIdPairs(e.cachedValueItems),filterExpressionMetadata:t}},N.prototype.serializeSection=function(e,t){var r=this;return 1<_.chain(e.visualContainers).values().sumBy((function(e){return null==e.highlight?0:1})).value()&&(this.version=g.max(this.version,c.v1_2)),{filters:this.serializeFilters(e.filters),visualContainers:_.mapValues(e.visualContainers,(function(e){return r.serializeVisualContainer(e,t)})),visualContainerGroups:e.visualContainerGroups&&_.mapValues(e.visualContainerGroups,(function(e){return r.serializeVisualContainerGroup(e)}))}},N.prototype.serializeVisualContainer=function(e,t){return e.highlight&&(this.version=g.max(this.version,c.v1_1)),{filters:this.serializeFilters(e.filters),singleVisual:this.serializeSingleVisual(e.singleVisual,e.visibility,t),highlight:e.highlight?this.serializeHighlightState(e.highlight):void 0}},N.prototype.serializeVisualContainerGroup=function(e){var t=this;return{isHidden:e.isHidden,children:e.children&&_.mapValues(e.children,(function(e){return t.serializeVisualContainerGroup(e)}))}},N.prototype.serializeSingleVisual=function(e,t,r){if(e){var i={visualType:e.visualType};return null!=e.autoSelectVisualType&&(i.autoSelectVisualType=e.autoSelectVisualType,this.version=g.max(this.version,n.OnObject)),e.objects&&(i.objects=this.serializeObjects(e.objects)),e.orderBy&&(i.orderBy=v.serializeSortDefinitions(e.orderBy,!0)),e.activeProjections&&(i.activeProjections=this.serializeActiveProjections(e.activeProjections)),e.targetType&&(i.targetType=e.targetType,this.version=g.max(this.version,c.v1_6)),null!=e.targetAutoSelectVisualType&&(i.targetAutoSelectVisualType=e.targetAutoSelectVisualType,this.version=g.max(this.version,n.OnObject)),e.projections&&(i.projections=this.serializeActiveProjections(e.projections),this.version=g.max(this.version,c.v1_6)),_.isEmpty(e.parameters)||(i.parameters=this.serializeParameters(e.parameters),this.version=g.max(this.version,n.FieldParameters)),e.cachedFilterDisplayItems&&(i.cachedFilterDisplayItems=p.serializeFilterLabelIdPairs(e.cachedFilterDisplayItems)),e.filterExpressionMetadata&&(i.filterExpressionMetadata=m.serializeFilterExpressionMetadata(e.filterExpressionMetadata,this.featureSwitchService&&this.featureSwitchService.featureSwitches.serializeSpaceOptimization),this.version=g.max(this.version,c.v1_5)),e.mobileVcObjects&&(i.mobileVcObjects=this.serializeMobileObjects(e.mobileVcObjects,d.CommonObjectDescriptors,e.visualType)),e.mobileObjects&&r&&(r=(r=r.capabilities(e.visualType))&&r.objects,i.mobileObjects=this.serializeMobileObjects(e.mobileObjects,r,e.visualType)),_.isEmpty(e.expansionStates)||(i.expansionStates=u.serializeExpansionStates(e.expansionStates)),e.hidden,e.hidden?i.display={mode:"hidden"}:t&&(i.display=(function(e){switch(e){case 1:return{mode:"maximize"};case 2:return{mode:"maximize",maximizedOptions:{dataTable:"normal"}};case 8:return{mode:"maximize",maximizedOptions:{dataTable:"accessible"}};case 4:return{mode:"spotlight"}}})(t)),i}},N.prototype.serializeMobileObjects=function(e,t,r){this.version=g.max(this.version,n.AllowMobileVisualFormatting);var i=l.serializeObjects(e,t,this.featureSwitchService.featureSwitches.serializeSpaceOptimization);if(this.version===o)return i;var a=f.ExplorationStateVersionToExplorationVersion[this.version],a=f.getVersionForObjectDefinitions(e,t,r,a,jsCommon.ArrayExtensions.createWithName());return this.version=g.max(this.version,_.findKey(f.ExplorationStateVersionToExplorationVersion,(function(e){return e===a}))),this.version,i},N.prototype.serializeActiveProjections=function(e){var t,r;for(r in e){var i=e[r];_.isEmpty(i)||((t=t||{})[r]=_.map(i,(function(e){return null===e?null:v.serializeExpr(e)})))}return t},N.prototype.serializeParameters=function(e){var t,r;for(r in e){var i=e[r];_.isEmpty(i)||((t=t||{})[r]=_.map(i,(function(e){return{expr:v.serializeExpr(e.expr),index:e.index,length:e.length}})))}return t},N.prototype.serializeObjects=function(e){var t=this,r={};return e.merge&&(r.merge=l.serializeObjects(e.merge,null,this.featureSwitchService&&this.featureSwitchService.featureSwitches.serializeSpaceOptimization)),e.remove&&(r.remove=_.map(e.remove,(function(e){return t.serializeObjectPropSelector(e)}))),r},N.prototype.serializeObjectPropSelector=function(e){return{object:e.object,property:e.property,selector:l.serializeSelector(e.selector)||null}},N.prototype.serializeHighlightState=function(e){return e.filterExpressionMetadata&&(this.version=g.max(this.version,c.v1_3)),{selection:l.serializeSelection(e.selection,this.featureSwitchService&&this.featureSwitchService.featureSwitches.serializeSpaceOptimization),filterExpressionMetadata:e.filterExpressionMetadata?m.serializeFilterExpressionMetadata(e.filterExpressionMetadata,this.featureSwitchService&&this.featureSwitchService.featureSwitches.serializeSpaceOptimization):void 0}},N);function N(e){this.featureSwitchService=e,this.version=c.v1_0}})((e=(e=V.explore||(V.explore={})).services||(e.services={})).ExplorationState||(e.ExplorationState={}))})(powerbi=powerbi||{}),(function(e){var s;e=e.explore||(e.explore={}),(e=(s=e.services||(e.services={})).WebBookmark||(s.WebBookmark={})).deserialize=function(e,t,r,i){var a=[],o={objectId:e.objectId,name:e.objectId,type:e.type};e.creationTime&&(o.creationTime=new Date(Date.parse(e.creationTime))),e.expirationTime&&(o.expirationTime=new Date(Date.parse(e.expirationTime))),e.displayName&&(o.displayName=e.displayName),e.isDefault&&(o.isDefault=e.isDefault),null!=e.id&&(o.id=e.id);try{var n=void 0;e.explorationState&&((n=jsCommon.JsonExtensions.tryParseJSON(e.explorationState))||a.push({code:0})),n&&(o.explorationState=s.ExplorationState.deserialize(n,t,r,i))}catch(e){a.push({code:1,message:e.message,stack:e.stack})}return o={contract:o},_.isEmpty(a)||(o.errors=a),o},e.serialize=function(e,t,r,i,a){var o={objectId:e.objectId,type:e.type};return e.creationTime&&(o.creationTime=e.creationTime.toISOString()),e.expirationTime&&(o.expirationTime=e.expirationTime.toISOString()),e.displayName&&(o.displayName=e.displayName),e.isDefault&&(o.isDefault=e.isDefault),null!=e.id&&(o.id=e.id),e.explorationState&&(r=s.ExplorationState.serialize(e.explorationState,t,i,a,r),o.explorationState=JSON.stringify(r)),o}})(powerbi=powerbi||{}),(function(e){(function(t){var c=jsCommon.Version;t.createExplorationStateDowngrader=function(e){return new r(e)};var r=(e.prototype.getFinalExplorationVersion=function(e,t){var r=e&&e.sections;if(r){for(var i=0,a=Object.keys(r);i<a.length;i++)for(var o=r[a[i]],n=0,s=Object.keys(o.visualContainers);n<s.length;n++){var l=s[n],p=o.visualContainers[l],u=p.singleVisual;u&&(l=u.visualType,(u=null===(u=p.singleVisual)||void 0===u?void 0:u.mobileVcObjects)&&(t=c.max(t,this.objectsDowngrader.getFinalVisualObjectsVersion(2,u,t,l))),(p=null===(p=p.singleVisual)||void 0===p?void 0:p.mobileObjects)&&(t=c.max(t,this.objectsDowngrader.getFinalVisualObjectsVersion(1,p,t,l))))}return t}},e.prototype.downgrade=function(e,t){var r=e&&e.sections;if(r)for(var i=0,a=Object.keys(r);i<a.length;i++)for(var o=r[a[i]],n=0,s=Object.keys(o.visualContainers);n<s.length;n++){var l,p=s[n],u=o.visualContainers[p].singleVisual;u&&(l=u.visualType,(p=u.mobileVcObjects)&&this.objectsDowngrader.downgrade(2,p,l,t),(u=u.mobileObjects)&&this.objectsDowngrader.downgrade(1,u,l,t))}},e);function e(e){e=t.createExplorationDowngrader(e).downgraders;this.objectsDowngrader=t.createVisualObjectsDowngrader(e)}t.ExplorationStateDowngrader=r})((e=(e=e.explore||(e.explore={})).services||(e.services={})).downgrade||(e.downgrade={}))})(powerbi=powerbi||{}),(function(e){(function(t){t.createExplorationStateUpgrader=function(e){return new r(e)};var r=(e.prototype.upgrade=function(e,t){var r=e&&e.sections;if(r){for(var i=0,a=Object.keys(r);i<a.length;i++)for(var o=r[a[i]],n=0,s=Object.keys(o.visualContainers);n<s.length;n++){var l,p=s[n],u=o.visualContainers[p].singleVisual;u&&(l=u.visualType,(p=u.mobileVcObjects)&&this.objectsUpgrader.upgrade(2,p,l,t),(u=u.mobileObjects)&&this.objectsUpgrader.upgrade(1,u,l,t))}return e}},e);function e(e){this.objectsUpgrader=t.createVisualObjectsUpgrader(t.createExplorationUpgrader(e).getVersionUpgraders())}t.ExplorationStateUpgrader=r})((e=(e=e.explore||(e.explore={})).services||(e.services={})).upgrade||(e.upgrade={}))})(powerbi=powerbi||{}),(function(a){var e,o;e=(e=a.explore||(a.explore={})).services||(e.services={}),(function(e){var n=a.data.DataViewObjectDefinitions,r=a.visuals.plugins;e.createVersionUpgrader=function(){return new t};var t=(i.prototype.upgrade=function(e){if(e&&e.sections)for(var t=0,r=e.sections;t<r.length;t++){var i=r[t];if(i.visualContainers)for(var a=0,o=i.visualContainers;a<o.length;a++){var n,s=o[a].config.singleVisual;s&&(n=s.visualType||s.visualConfig.visualType,s.objects=this.upgradeObjects(s.objects,n))}}},i.prototype.upgradeFilterCollection=function(e){},i.prototype.upgradeVisualObjects=function(e,t,r,i){},i.prototype.getVersion=function(){return o.ExplorationVersions.v3_12_1},i.prototype.upgradeObjects=function(e,t){return t===r.slicer.name?this.upgradeSlicerObjects(e):e},i.prototype.upgradeSlicerObjects=function(e){var t,r,i=n.getObjectDefinition(e=e||{},"general",null),a=i&&i.properties.filter,o=a&&a.filter;return o&&this.isAndFilter(o)&&((r=n.getObjectDefinition(e,"data",null))&&(t=r.properties.startDate,i=r.properties.endDate,a=r.properties.numericStart,r=r.properties.numericEnd,(t&&!i||a&&!r)&&this.BetweenToBeforeOrAfterFilter(o,1),(i&&!t||r&&!a)&&this.BetweenToBeforeOrAfterFilter(o,0))),e},i.prototype.isAndFilter=function(e){if(1===e.Where.length){e=e.Where[0].Condition;if(e&&e.And)return!0}return!1},i.prototype.BetweenToBeforeOrAfterFilter=function(e,t){var r=e.Where[0].Condition;return e.Where[0].Condition=0===t?r.And.Right:r.And.Left,e},i);function i(){}e.VersionUpgrader=t})((o=e.upgrade||(e.upgrade={})).v3_12_1||(o.v3_12_1={}))})(powerbi=powerbi||{}),(function(v){var e,s;e=(e=v.explore||(v.explore={})).services||(e.services={}),(function(e){var a=v.data.services.wireContracts.DataViewObjectDefinitions,c=v.data.DataViewWildcard,u=jsCommon.JsonExtensions,o=v.data.services.SemanticQuerySerializer,n=v.data.SQExprBuilder;e.createVersionUpgrader=function(e){return new t(e)};var t=(r.prototype.upgrade=function(e){if(e)for(var t=0,r=e.sections;t<r.length;t++)for(var i=0,a=r[t].visualContainers;i<a.length;i++){var o,n,s,l=a[i],p=l.config.singleVisual;p&&(o=p.visualType,n=p.projections,this.featureSwitchService.featureSwitches.cartesianConditionalFormatting&&(p.objects=d(p.objects,n,o),m(p.objects,n,o,p.prototypeQuery)),(s=u.tryParseJSON(l.dataTransforms))&&(this.featureSwitchService.featureSwitches.cartesianConditionalFormatting&&(s.objects=d(s.objects,n,o),m(s.objects,n,o,p.prototypeQuery)),l.dataTransforms=JSON.stringify(s)))}},r.prototype.upgradeFilterCollection=function(){},r.prototype.upgradeVisualObjects=function(e,t,r,i){},r.prototype.getVersion=function(){return s.ExplorationFeatureVersions.CartesianConditionalFormatting},r);function r(e){this.featureSwitchService=e}function d(e,t,r){var i=g(r),i=t&&!_.isEmpty(t[i]);return"scatterChart"===r&&i&&null==a.getObjectDefinitionProperties(e,"fillPoint")&&((e=e||{}).fillPoint=[{properties:{show:{expr:o.serializeExpr(n.boolean(!0))}}}]),e}function g(e){switch(e){case"filledMap":return"Size";case"barChart":case"clusteredBarChart":case"clusteredColumnChart":case"columnChart":case"funnel":case"hundredPercentStackedBarChart":case"hundredPercentStackedColumnChart":case"map":case"treemap":case"scatterChart":return"Gradient"}}function h(e){switch(e){case"filledMap":case"barChart":case"clusteredBarChart":case"clusteredColumnChart":case"columnChart":case"funnel":case"hundredPercentStackedBarChart":case"hundredPercentStackedColumnChart":case"map":case"treemap":case"scatterChart":return"Tooltips"}}function y(e,t){return"filledMap"===e&&t&&!_.isEmpty(t.Series)&&!_.isEmpty(t.Size)}function m(e,t,r,i){var a,o=g(r);if(o){var n=t&&t[o];if(!_.isEmpty(n)){var s=n[0].queryRef;if(s){var l=_.cloneDeep(_.find(i&&i.Select,(function(e){return e.Name===s})));if(l){delete l.Name;var p=l.Aggregation||l.Measure;if(p){var u=p.Expression.Column&&p.Expression.Column.Expression.SourceRef||p.Expression.SourceRef;if(u){i=_.find(i.From,(function(e){return e.Name===u.Source}));if(i){u.Entity=i.Entity,delete u.Source;var c=e&&e.dataPoint;if(!_.isEmpty(c))for(var d=0,m=c;d<m.length;d++){var v,f=m[d];if(null==f.selector&&f.properties.fillRule){y(r,t)||(v=_.cloneDeep(f.properties.fillRule),c.push({selector:{data:[{dataViewWildcard:{matchingOption:1}}]},properties:((a={}).fill={solid:{color:{expr:{FillRule:{FillRule:(function(e){e.linearGradient2&&C(e.linearGradient2);e.linearGradient3&&C(e.linearGradient3);return e})(v),Input:l}}}}},a)})),c.splice(c.indexOf(f),1),delete t[o],(function(t,e){for(var r in e){r=e[r];if(_.some(r,(function(e){return e.queryRef===t})))return!0}return!1})(s,t)||(t[f=h(r)]||(t[f]=[]),(f=t[f]).push.apply(f,n||[]));break}}}}}}}}}}function i(e){e.color&&(e.color=e.color.expr);var t=e;t.value&&(t.value=t.value.expr);e.strategy&&(e.strategy=e.strategy.expr)}function C(e){i(e.min),i(e.max),e.mid&&i(e.mid),e.nullColoringStrategy&&i(e.nullColoringStrategy)}e.VersionUpgrader=t,e.getFillRuleInputRoleFromVisualType=g,e.upgradeGradientOnObjectDef=function(e,t,r){var i=g(r);if(i){var a=t.getQueryRef(i,{fieldIndex:0});if(a){t.defn;var o=t.defn.select().withName(a),n=e&&e.dataPoint;if(!_.isEmpty(n))for(var s=0,l=n;s<l.length;s++){var p=l[s],u=p.properties.fillRule;if(null==p.selector&&u){y(r,t.projections)||n.push({selector:{data:[c.create(1)]},properties:{fill:{solid:{color:v.data.SQExprBuilder.fillRule(o.expr,u)}}}}),n.splice(n.indexOf(p),1),1===t.getUsageCount(a)&&(u=t.tryGetExpr(i,0),p=h(r),t.add(u,p)),t.removeProjection(i,{fieldIndex:0});break}}}}},e.upgradeGradientOnWireContractObjectDef=m})((s=e.upgrade||(e.upgrade={})).v3_20||(s.v3_20={}))})(powerbi=powerbi||{}),(function(e){var i;e=(e=e.explore||(e.explore={})).services||(e.services={}),(function(e){var l=jsCommon.JsonExtensions,p=jsCommon.StringExtensions;e.createVersionUpgrader=function(){return new t};var t=(r.prototype.upgrade=function(e){if(e&&!_.isEmpty(e.sections)){for(var t=0,r=e.sections;t<r.length;t++){var i=r[t];this.upgradeSectionAcceptsAllFiltersWhenLinked(i)}for(var a=e.pods||[],o={},n=0,s=a;n<s.length;n++)o[s[n].name]=!0;for(var l=0,p=e.sections;l<p.length;l++){i=p[l];this.upgradeSection(i,a,o)}_.isEmpty(a)||(e.pods=a)}},r.prototype.upgradeFilterCollection=function(){},r.prototype.upgradeVisualObjects=function(e,t,r,i){},r.prototype.getVersion=function(){return i.ExplorationVersions.v3_24},r.prototype.upgradeSectionAcceptsAllFiltersWhenLinked=function(e){e.config||(e.config={}),null==e.config.acceptsAllFiltersWhenLinked&&(1===e.config.type?e.config.acceptsAllFiltersWhenLinked=!0:0===e.config.type||null==e.config.type?e.config.acceptsAllFiltersWhenLinked=!1:e.config.type)},r.prototype.upgradeSection=function(e,t,r){var i,a,o;e&&e.name&&(i=l.tryParseJSON(e.filters)||[],a=_.some(i,(function(e){return 5===e.howCreated})),(o=this.findPodForSectionName(t,e.name))?this.upgradeExistingPod(o,e.config,a):a&&(o=this.createPod(t,e.name,e.config,r)),e.config&&(e.config.acceptsAllFiltersWhenLinked=void 0),o&&(this.upgradeFilters(o,i),e.filters=JSON.stringify(i)))},r.prototype.upgradeFilters=function(e,t){var r=[];p.isNullOrUndefinedOrWhiteSpaceString(e.parameters)||(r=l.tryParseJSON(e.parameters));for(var i=0,a=t;i<a.length;i++){var o,n,s=a[i];s.name&&!s.isTransient&&(n=5===s.howCreated,(o=this.findParamForFilterName(r,s.name))?(o.fieldExpr=s.expression,o.asAggregation=s.isLinkedAsAggregation,n||(o.isLegacySingleSelection=!0)):n&&(n={name:"Param_"+s.name,boundFilter:s.name,fieldExpr:s.expression,asAggregation:s.isLinkedAsAggregation},r.push(n)),s.isLinkedAsAggregation=void 0)}e.parameters=JSON.stringify(r)},r.prototype.upgradeExistingPod=function(e,t,r){e.config=this.createPodConfig(t),e.referenceScope=0,e.type=r?this.determineType(t):0},r.prototype.findParamForFilterName=function(e,t){if(!_.isEmpty(e))return _.find(e,(function(e){return e.boundFilter===t}))},r.prototype.findPodForSectionName=function(e,t){if(!_.isEmpty(e))return _.find(e,(function(e){return e.boundSection===t}))},r.prototype.createPod=function(e,t,r,i){r={name:p.findUniqueName(i,this.podNamePrefix),boundSection:t,type:this.determineType(r),referenceScope:0,config:this.createPodConfig(r)};return e.push(r),i[r.name]=!0,jsCommon.ArrayExtensions.hasUniqueNames(e),r},r.prototype.createPodConfig=function(e){e=!e||e.acceptsAllFiltersWhenLinked?0:1;return JSON.stringify({acceptsFilterContext:e})},r.prototype.determineType=function(e){return e&&0!==e.type&&void 0!==e.type?e&&1===e.type?2:void 0:1},r);function r(){this.podNamePrefix="Pod"}e.VersionUpgrader=t})((i=e.upgrade||(e.upgrade={})).v3_24||(i.v3_24={}))})(powerbi=powerbi||{}),(function(n){var e,i;e=(e=n.explore||(n.explore={})).services||(e.services={}),(function(e){var a=n.data.services.DataViewObjectSerializer,o=n.visuals.keyDriversNumericAnalysis;e.createVersionUpgrader=function(){return new t};var t=(r.prototype.upgrade=function(e){if(e&&!_.isEmpty(e.sections))for(var t=0,r=e.sections;t<r.length;t++)for(var i=0,a=r[t].visualContainers;i<a.length;i++){var o=a[i],o=o.config&&o.config.singleVisual;o&&o.visualType===n.visuals.plugins.keyDriversVisual.name&&(o.objects=this.upgradeKeyDriversVisualObjects(o.objects))}},r.prototype.upgradeFilterCollection=function(){},r.prototype.upgradeVisualObjects=function(e,t,r,i){},r.prototype.getVersion=function(){return i.ExplorationVersions.v4_1},r.prototype.upgradeKeyDriversVisualObjects=function(e){var t,r,i=(e=e||{})[this.keyDriverObjectName];return(i=i||(e[this.keyDriverObjectName]=[{properties:{}}]))[0].properties[this.selectedNumericAnalysisPropertyName]||(t={enumeration:o.type},r=n.data.SQExprBuilder.typedConstant(o.categorical,t),i[0].properties[this.selectedNumericAnalysisPropertyName]=a.serializeObjectProperty(r,{type:t})),e},r);function r(){this.keyDriverObjectName="keyDrivers",this.selectedNumericAnalysisPropertyName="selectedNumericAnalysis"}e.VersionUpgrader=t})((i=e.upgrade||(e.upgrade={})).v4_1||(i.v4_1={}))})(powerbi=powerbi||{}),(function(i){var e,a;e=(e=i.explore||(i.explore={})).services||(e.services={}),(function(e){e.createVersionUpgrader=function(){return new t};var t=(r.prototype.upgrade=function(e){this.forAllSectionsAllContainers(e,[i.visuals.plugins.lineChart.name,i.visuals.plugins.areaChart.name,i.visuals.plugins.stackedAreaChart.name],this.upgradeLineChartDotProperties)},r.prototype.forAllSectionsAllContainers=function(e,r,i){if(e&&!_.isEmpty(e.sections))for(var t=0,a=e.sections;t<a.length;t++)for(var o=0,n=a[t].visualContainers;o<n.length;o++)!(function(e){e=e.config&&e.config.singleVisual;if(!e||!e.objects)return;var t=e&&e.visualType;if(_.findIndex(r,(function(e){return e===t}))<0)return;i(e.objects,e.projections)})(n[o])},r.prototype.upgradeLineChartDotProperties=function(e,t){var r=e.categoryAxis,i=e.dataPoint,e=e.lineStyles;if(r&&0!==r.length){var r=r[0].properties;if(r&&r.axisType){r=r.axisType.expr.Literal.Value.replace(/['"]+/g,"");if(i&&"Categorical"===r&&t&&t.Category&&1===t.Category.length&&t.Category[0]){var a=t.Category[0].queryRef;if(a)for(var o=0;o<i.length;o++){var n,s=i[o].properties;_.keys(s).length,!s||!s.fill||1<_.keys(s).length||(n=i[o].selector)&&n.data&&1===n.data.length&&n.data[0]&&((s=n.data[0]).scopeId&&s.scopeId.Comparison&&s.scopeId.Comparison.Left&&s.scopeId.Comparison.Left.Column&&((s=(n=s.scopeId.Comparison.Left.Column).Property)&&n.Expression&&n.Expression.SourceRef&&((n=n.Expression.SourceRef.Entity)&&n+"."+s===a&&(i.splice(o,1),o--))))}}if(e&&0<e.length&&"Scalar"===r)for(var l=0,p=e;l<p.length;l++){var u=p[l];u.selector||(u=u.properties)&&u.showMarker&&("true"===(u=u.showMarker).expr.Literal.Value&&(u.expr.Literal.Value="false"))}}}},r.prototype.upgradeFilterCollection=function(){},r.prototype.upgradeVisualObjects=function(e,t,r,i){},r.prototype.getVersion=function(){return a.ExplorationVersions.v5_11},r);function r(){}e.VersionUpgrader=t})((a=e.upgrade||(e.upgrade={})).v5_11||(a.v5_11={}))})(powerbi=powerbi||{}),(function(s){var e,i;e=(e=s.explore||(s.explore={})).services||(e.services={}),(function(e){var l=s.data.services.DataViewObjectSerializer,p=s.data.services.FilterExpressionMetadataSerializer,a=jsCommon.JsonExtensions;e.createVersionUpgrader=function(e){return new t(e)};var t=(r.prototype.upgrade=function(e){if(this.featureSwitchService&&this.featureSwitchService.featureSwitches&&this.featureSwitchService.featureSwitches.serializeSpaceOptimization&&e&&!(_.isEmpty(e.config.bookmarks)&&_.isEmpty(e.filters)&&_.isEmpty(e.sections))){_.isEmpty(e.config.bookmarks)||this.upgradeBookmarks(e.config.bookmarks),e.filters&&(e.filters=this.upgradeFilterContainers(e.filters));for(var t=0,r=e.sections;t<r.length;t++)for(var i=0,a=r[t].visualContainers;i<a.length;i++){var o=a[i],n=o.config&&o.config.singleVisual;n&&n.filterExpressionMetadata&&p.isFilterExpressionMetadata(n.filterExpressionMetadata)&&(n.filterExpressionMetadata=this.upgradeFilterExpressionMetadata(n.filterExpressionMetadata)),o.filters&&(o.filters=this.upgradeFilterContainers(o.filters));o=n&&n.visualType;n&&n.objects&&o===s.visuals.plugins.textbox.name&&this.upgradeFilterContextProperties(n.objects)}}},r.prototype.upgradeFilterContextProperties=function(e){var t,r=this;for(t in e)for(var i=0,a=e[t];i<a.length;i++){var o,n=a[i];for(o in n.properties){var s=n.properties[o];l.isObjectPropertyWithContext(s)&&(s=(s=s.context)&&s.filterContext,_.isEmpty(s)||_.forEach(s,(function(e){e.metadata&&p.isFilterExpressionMetadata(e.metadata)&&(e.metadata=r.upgradeFilterExpressionMetadata(e.metadata))})))}}},r.prototype.upgradeBookmarks=function(e){for(var t=0,r=e;t<r.length;t++){var i,a=r[t];o(a)?this.upgradeBookmarks(a.children):(i=a.explorationState.sections,this.upgradeSectionState(i),(a=a.explorationState.filters)&&this.upgradeFilters(a))}},r.prototype.upgradeSectionState=function(e){var r=this;_.forEach(e,(function(e){_.forEach(e.visualContainers,(function(e){var t=e.highlight;t&&t.selection&&l.isSelectorsByColumn(t.selection)&&(t.selection=r.upgradeSelectorsByColumn(t.selection)),t&&t.filterExpressionMetadata&&p.isFilterExpressionMetadata(t.filterExpressionMetadata)&&(t.filterExpressionMetadata=r.upgradeFilterExpressionMetadata(t.filterExpressionMetadata));e=e.singleVisual;e.filterExpressionMetadata&&p.isFilterExpressionMetadata(e.filterExpressionMetadata)&&(e.filterExpressionMetadata=r.upgradeFilterExpressionMetadata(e.filterExpressionMetadata))})),e.filters&&r.upgradeFilters(e.filters)}))},r.prototype.upgradeFilters=function(e){var t=this;e.byName&&_.forEach(e.byName,(function(e){e.filterExpressionMetadata&&p.isFilterExpressionMetadata(e.filterExpressionMetadata)&&(e.filterExpressionMetadata=t.upgradeFilterExpressionMetadata(e.filterExpressionMetadata))})),e.byExpr&&this.upgradeFilterContainerState(e.byExpr),e.byTransientState&&this.upgradeFilterContainerState(e.byTransientState),e.byType&&this.upgradeFilterContainerState(e.byType)},r.prototype.upgradeFilterContainerState=function(e){var t=this;_.forEach(e,(function(e){e.filterExpressionMetadata&&p.isFilterExpressionMetadata(e.filterExpressionMetadata)&&(e.filterExpressionMetadata=t.upgradeFilterExpressionMetadata(e.filterExpressionMetadata))}))},r.prototype.upgradeSelectorsByColumn=function(e){e=_.map(e,(function(e){return l.deserializeSelectorsByColumn(e)})),e=s.data.DecomposedIdentities.decomposeSelectorsByColumn(e);return l.serializeDecomposedSelectors(e)},r.prototype.upgradeFilterExpressionMetadata=function(e){e=p.deserializeOldFilterExpressionMetadata(e),e=s.data.DecomposedIdentities.decomposeFilterExpressionMetadata(e);return l.serializeDecomposedFilterExpressionMetadata(e)},r.prototype.upgradeFilterCollection=function(e){e&&e.filters&&(e.filters=this.upgradeFilterContainers(e.filters))},r.prototype.upgradeVisualObjects=function(e,t,r,i){},r.prototype.upgradeFilterContainers=function(e){if(!_.isEmpty(e)){e=a.tryParseJSON(e);if(e)for(var t=0,r=e;t<r.length;t++){var i=r[t];this.upgradeFilterContainer(i)}return JSON.stringify(e)}},r.prototype.upgradeFilterContainer=function(e){e.filterExpressionMetadata&&p.isFilterExpressionMetadata(e.filterExpressionMetadata)&&(e.filterExpressionMetadata=this.upgradeFilterExpressionMetadata(e.filterExpressionMetadata))},r.prototype.getVersion=function(){return i.ExplorationVersions.v5_16},r);function r(e){this.featureSwitchService=e}function o(e){return void 0!==e.children}e.VersionUpgrader=t,e.isBookmarkGroup=o,e.isStateBookmark=function(e){return!o(e)}})((i=e.upgrade||(e.upgrade={})).v5_16||(i.v5_16={}))})(powerbi=powerbi||{}),(function(a){var e,o;e=(e=a.explore||(a.explore={})).services||(e.services={}),(function(e){var t=a.data.services.SemanticQuerySerializer;e.createVersionUpgrader=function(e){return new r(e)};var r=(i.prototype.upgrade=function(e){if(this.featureSwitchService&&this.featureSwitchService.featureSwitches&&this.featureSwitchService.featureSwitches.buttonTileFormatting&&e&&e.sections)for(var t=0,r=e.sections;t<r.length;t++)for(var i=0,a=r[t].visualContainers;i<a.length;i++){var o=a[i],o=o.config&&o.config.singleVisual;if(o&&"actionButton"===o.visualType&&o.objects){var n=o.objects;if(n.text)for(var s,l,p=0,u=n.text;p<u.length;p++)(c=null==(h=u[p])?void 0:h.properties)&&(d=c.padding)&&(l=s=void 0,s=c.horizontalAlignment?C(c.horizontalAlignment):"right",l=c.verticalAlignment?C(c.verticalAlignment):"middle","left"===s?h.properties.leftMargin=d:"right"===s&&(h.properties.rightMargin=d),"top"===l?h.properties.topMargin=d:"bottom"===l&&(h.properties.bottomMargin=d),delete h.properties.padding);if(n.icon)for(var c,d,m=0,v=n.icon;m<v.length;m++)(c=null==(h=v[m])?void 0:h.properties)&&(d=c.padding)&&(h.properties.leftMargin=d,h.properties.rightMargin=d,h.properties.topMargin=d,h.properties.bottomMargin=d,delete h.properties.padding);if(n.outline)for(var f=0,g=n.outline;f<g.length;f++){var h,y=null==(h=g[f])?void 0:h.properties.roundEdge;y&&(n.shape=n.shape||[],n.shape.push({properties:{roundEdge:y},selector:h.selector}),delete h.properties.roundEdge)}}}},i.prototype.upgradeVisualObjects=function(e,t,r,i){},i.prototype.upgradeFilterCollection=function(){},i.prototype.getVersion=function(){return o.ExplorationVersions.v5_25},i);function i(e){this.featureSwitchService=e}function C(e){return t.deserializeExpr(e.expr).value}e.VersionUpgrader=r})((o=e.upgrade||(e.upgrade={})).v5_25||(o.v5_25={}))})(powerbi=powerbi||{}),(function(s){var e,l;e=(e=s.explore||(s.explore={})).services||(e.services={}),(function(e){var o=s.data.SQExprBuilder,n=s.data.services.SemanticQuerySerializer;e.createVersionUpgrader=function(){return new t};var t=(r.prototype.upgrade=function(e){if(e&&!_.isEmpty(e.sections))for(var t=0,r=e.sections;t<r.length;t++)for(var i=0,a=r[t].visualContainers;i<a.length;i++){var o=a[i],o=o.config&&o.config.singleVisual;o&&o.objects&&(o&&o.visualType)===s.visuals.plugins.azureMap.name&&this.upgradeAzureMapProperties(o.objects)}},r.prototype.upgradeVisualObjects=function(e,t,r,i){},r.prototype.upgradeAzureMapProperties=function(e){e=e.heatMapLayer;if(e&&0!==e.length)for(var t=0,r=e;t<r.length;t++){var i,a=r[t];a.selector||(i=a.properties)&&i.heatMapOpacity&&(a=i.heatMapOpacity,a=Number(n.deserializeExpr(a.expr).value),a=isNaN(a)?0:100-100*a,delete i.heatMapOpacity,i.mapTransparency=l.UpgradeUtils.toExpr(o.integer(a)))}},r.prototype.upgradeFilterCollection=function(){},r.prototype.getVersion=function(){return l.ExplorationVersions.v5_28},r);function r(){}e.VersionUpgrader=t})((l=e.upgrade||(e.upgrade={})).v5_28||(l.v5_28={}))})(powerbi=powerbi||{}),(function(j){var e,R;e=(e=j.explore||(j.explore={})).services||(e.services={}),(function(e){var a=j.visuals.cartesianChartProps,o=j.visuals.legendMarkerRendering,n=j.visuals.lineChartProps,s=j.visuals.plugins,t=j.data.services.SemanticQuerySerializer,c=j.data.SQExprBuilder;e.createVersionUpgrader=function(e){return new r(e)};var l=[s.tableEx.name,s.pivotTable.name,s.slicer.name,s.filterSlicer.name,s.multiRowCard.name],p=[s.barChart.name,s.clusteredBarChart.name,s.clusteredColumnChart.name,s.columnChart.name,s.hundredPercentStackedBarChart.name,s.hundredPercentStackedColumnChart.name,s.ribbonChart.name],u=[s.areaChart.name,s.barChart.name,s.clusteredBarChart.name,s.clusteredColumnChart.name,s.columnChart.name,s.hundredPercentStackedBarChart.name,s.hundredPercentStackedColumnChart.name,s.lineChart.name,s.lineClusteredColumnComboChart.name,s.lineStackedColumnComboChart.name,s.ribbonChart.name,s.scatterChart.name,s.stackedAreaChart.name,s.waterfallChart.name],d=[s.comboChart.name,s.dataDotClusteredColumnComboChart.name,s.dataDotStackedColumnComboChart.name,s.lineClusteredColumnComboChart.name,s.lineStackedColumnComboChart.name],m=[s.lineChart.name,s.areaChart.name,s.stackedAreaChart.name,s.lineStackedColumnComboChart.name,s.lineClusteredColumnComboChart.name],r=(i.prototype.upgrade=function(e){},i.prototype.upgradeVisualObjects=function(e,t,r,i){1===e&&(_.some(p,(function(e){return e===r}))&&(this.upgradeCartesianAxisScale(t,a.categoryAxis.logAxisScale.objectName),this.upgradeCartesianAxisPosition(t,a.categoryAxis.switchAxisPosition.objectName)),_.some(u,(function(e){return e===r}))&&(this.upgradeCartesianAxisScale(t,a.valueAxis.logAxisScale.objectName),this.upgradeCartesianAxisPosition(t,a.valueAxis.switchAxisPosition.objectName)),_.some(d,(function(e){return e===r}))&&this.upgradeCartesianSecAxisScale(t,a.valueAxis.secLogAxisScale.objectName),_.some(m,(function(e){return e===r}))&&(this.upgradeCartesianSecAxisScale(t,a.y2Axis.secLogAxisScale.objectName),this.upgradeDefaultToCircle(t,n.legend.legendMarkerRendering.objectName)),this.featureSwitchService.featureSwitches.outlineDropdownToCheckboxes&&_.some(l,(function(e){return e===r}))&&this.upgradeOutlineProperties(t,r),this.featureSwitchService.featureSwitches.splitSubTotals&&r===s.pivotTable.name&&this.upgradeSubTotalsProperties(t),this.featureSwitchService.featureSwitches.splitGrandTotals&&r===s.pivotTable.name&&this.upgradeTotalProperties(t),r===j.visuals.plugins.scatterChart.name&&this.upgradeScatterChartFillPoint(t)),2===e&&(this.featureSwitchService.featureSwitches.splitHelpTooltip&&this.upgradeVisualHeaderTooltip(t),this.featureSwitchService.featureSwitches.showDefaultTooltip&&this.upgradeVisualLink(t))},i.prototype.upgradeCartesianAxisScale=function(e,t){var r;this.featureSwitchService&&this.featureSwitchService.featureSwitches&&this.featureSwitchService.featureSwitches.logAxisScale&&(r=a.categoryAxis,this.upgradeAxisScale(e,t,r.axisScale.propertyName,r.logAxisScale.propertyName))},i.prototype.upgradeCartesianSecAxisScale=function(e,t){var r;this.featureSwitchService&&this.featureSwitchService.featureSwitches&&this.featureSwitchService.featureSwitches.logAxisScale&&(r=a.valueAxis,this.upgradeAxisScale(e,t,r.secAxisScale.propertyName,r.secLogAxisScale.propertyName))},i.prototype.upgradeVisualHeaderTooltip=function(e){e=e[y];if(e&&0<e.length)for(var t=0,r=e;t<r.length;t++){var i,a=r[t].properties;!a||!a[x]||a[C]||(i=(i=a[x])&&v(i))&&i!==h&&(a[C]=R.UpgradeUtils.toExpr(c.text(g)))}},i.prototype.upgradeSubTotalsProperties=function(e){var t=e.subTotals;if(t&&0<t.length)for(var r=t.length,i=0;i<r;i++){var a=t[i],o=a.properties,n={properties:{}};if(o&&!a.selector){for(var s=0,l=f;s<l.length;s++){var p=l[s],u=o[p.propertyName];u&&(n.properties[p.propertyName]=u,delete o[p.propertyName])}_.isEmpty(n.properties)||(t.push(__assign(__assign({},n),{selector:{id:"Column"}})),t.push(__assign(__assign({},n),{selector:{id:"Row"}})))}}},i.prototype.upgradeVisualLink=function(e){if(this.featureSwitchService.featureSwitches.useModernFormatPane){e=e[b];if(e&&0<e.length)for(var t=0,r=e;t<r.length;t++){var i,a=r[t].properties;a&&a[S]&&(i=(i=a[S])&&v(i),i=R.UpgradeUtils.convertSuppressDefaultTooltip(i),a[E]=R.UpgradeUtils.toExpr(c.boolean(i)),delete a[S])}}},i.prototype.upgradeOutlineProperties=function(e,t){for(var r=0,i=this.getPropertiesToUpgrade(t);r<i.length;r++){var a=i[r],o=a.objectName,n=a.propertyName,o=e[o];if(o&&0!==o.length)for(var s=0,l=o;s<l.length;s++){var p,u=l[s].properties;u&&u[n]&&(p=v(u[n]),p=R.UpgradeUtils.convertOutlineValue(p),u[N]=R.UpgradeUtils.toExpr(c.integer(p)),delete u[n])}}},i.prototype.upgradeTotalProperties=function(e){var t=e.total;t&&0<t.length&&(e.rowTotal=_.cloneDeep(t),e.columnTotal=_.cloneDeep(t),delete e.total)},i.prototype.getPropertiesToUpgrade=function(e){switch(e){case s.tableEx.name:return V;case s.pivotTable.name:return P;case s.slicer.name:return w;case s.filterSlicer.name:return T;case s.multiRowCard.name:return F;default:return[]}},i.prototype.upgradeDefaultToCircle=function(e,t){var r,i,a;this.featureSwitchService&&this.featureSwitchService.featureSwitches&&this.featureSwitchService.featureSwitches.removeDefaultToCircleToggle&&(a=e[t],r=n.legend.defaultToCircle.propertyName,i=n.legend.legendMarkerRendering.propertyName,a&&0<a.length&&((e=a[0].properties)&&e[r]&&(t=void 0,e[i]&&(t=v(e[i])),a=v(e[r]),t!==o.markerOnly&&t||a?t===o.markerOnly&&a&&(e[i]=R.UpgradeUtils.toExpr(c.text(o.markerCircleDefault))):e[i]=R.UpgradeUtils.toExpr(c.text(o.markerOnly)),delete e[r])))},i.prototype.upgradeAxisScale=function(e,t,r,i){this.featureSwitchService&&this.featureSwitchService.featureSwitches&&this.featureSwitchService.featureSwitches.logAxisScale&&((e=e[t])&&0<e.length&&((t=e[0].properties)&&t[r]&&(e=v(t[r]),e=R.UpgradeUtils.convertAxisScaleProperty(e),t[i]=R.UpgradeUtils.toExpr(c.boolean(e)),delete t[r])))},i.prototype.upgradeCartesianAxisPosition=function(e,t){var r,i;this.featureSwitchService&&this.featureSwitchService.featureSwitches&&this.featureSwitchService.featureSwitches.switchAxisPosition&&(i=e[t],r=a.categoryAxis.position.propertyName,e=a.categoryAxis.switchAxisPosition.propertyName,i&&0<i.length&&((t=i[0].properties)&&t[r]&&(i=v(t[r]),i=R.UpgradeUtils.convertAxisPositionProperty(i),t[e]=R.UpgradeUtils.toExpr(c.boolean(i)),delete t[r])))},i.prototype.upgradeScatterChartFillPoint=function(e){if(this.featureSwitchService&&this.featureSwitchService.featureSwitches&&this.featureSwitchService.featureSwitches.fillPointStyle){e=e.fillPoint;if(e&&0<e.length)for(var t=0,r=e;t<r.length;t++){var i,a=r[t];a.selector||(i=a.properties)&&i.show&&(a=v(i.show),a=R.UpgradeUtils.convertScatterChartFillPoint(a),i.style=R.UpgradeUtils.toExpr(c.text(a)),delete i.show)}}},i.prototype.upgradeFilterCollection=function(){},i.prototype.getVersion=function(){return R.ExplorationVersions.v5_31},i);function i(e){this.featureSwitchService=e}function v(e){return t.deserializeExpr(e.expr).value}e.VersionUpgrader=r;var f=[{objectName:"subTotals",propertyName:"fontColor"},{objectName:"subTotals",propertyName:"fontFamily"},{objectName:"subTotals",propertyName:"fontSize"},{objectName:"subTotals",propertyName:"bold"},{objectName:"subTotals",propertyName:"italic"},{objectName:"subTotals",propertyName:"underline"},{objectName:"subTotals",propertyName:"backColor"},{objectName:"subTotals",propertyName:"applyToHeaders"}],g="Canvas",h="none",y="visualHeaderTooltip",C="type",x="section",b="visualLink",S="suppressDefaultTooltip",E="showDefaultTooltip",N="outlineStyle",V=[{objectName:"grid",propertyName:"outline"},{objectName:"columnHeaders",propertyName:"outline"},{objectName:"values",propertyName:"outline"},{objectName:"total",propertyName:"outline"}],P=[{objectName:"grid",propertyName:"outline"},{objectName:"columnHeaders",propertyName:"outline"},{objectName:"values",propertyName:"outline"},{objectName:"rowHeaders",propertyName:"outline"}],w=[{objectName:"searchBox",propertyName:"outline"},{objectName:"items",propertyName:"outline"},{objectName:"header",propertyName:"outline"}],T=[{objectName:"searchBox",propertyName:"outline"},{objectName:"items",propertyName:"outline"},{objectName:"header",propertyName:"outline"}],F=[{objectName:"card",propertyName:"outline"}]})((R=e.upgrade||(e.upgrade={})).v5_31||(R.v5_31={}))})(powerbi=powerbi||{}),(function(l){var e,p;e=(e=l.explore||(l.explore={})).services||(e.services={}),(function(e){var a=l.visuals.cartesianChartProps,t=l.visuals.plugins,o=l.data.services.SemanticQuerySerializer,n=l.data.SQExprBuilder;e.createVersionUpgrader=function(e){return new r(e)};var s=[t.areaChart.name,t.lineChart.name,t.lineClusteredColumnComboChart.name,t.lineStackedColumnComboChart.name,t.scatterChart.name,t.stackedAreaChart.name],r=(i.prototype.upgrade=function(e){},i.prototype.upgradeVisualObjects=function(e,t,r,i){this.featureSwitchService&&this.featureSwitchService.featureSwitches&&this.featureSwitchService.featureSwitches.remainingCartesianCategoryLogAxisScale&&1===e&&_.some(s,(function(e){return e===r}))&&this.upgradeCartesianAxisScale(t,a.categoryAxis.logAxisScale.objectName)},i.prototype.upgradeCartesianAxisScale=function(e,t){var r=a.categoryAxis;this.upgradeAxisScale(e,t,r.axisScale.propertyName,r.logAxisScale.propertyName)},i.prototype.upgradeAxisScale=function(e,t,r,i){e=e[t];e&&0<e.length&&((t=e[0].properties)&&(t[i]&&t[r]?delete t[r]:t[r]&&(e=t[r],e=o.deserializeExpr(e.expr).value,e=p.UpgradeUtils.convertAxisScaleProperty(e),t[i]=p.UpgradeUtils.toExpr(n.boolean(e)),delete t[r])))},i.prototype.upgradeFilterCollection=function(){},i.prototype.getVersion=function(){return p.ExplorationVersions.v5_33},i);function i(e){this.featureSwitchService=e}e.VersionUpgrader=r})((p=e.upgrade||(e.upgrade={})).v5_33||(p.v5_33={}))})(powerbi=powerbi||{}),(function(e){var i;e=(e=e.explore||(e.explore={})).services||(e.services={}),(function(e){e.createVersionUpgrader=function(e){return new t(e)};var t=(r.prototype.upgrade=function(e){if(e&&!_.isEmpty(e.sections))for(var t=0,r=e.sections;t<r.length;t++)for(var i=0,a=r[t].visualContainers;i<a.length;i++){var o=a[i],n=o.config&&o.config.singleVisual;n&&n.objects&&("pivotTable"!==(o=n&&n.visualType)&&"tableEx"!==o||this.upgradeTablixProperties(n.objects,o))}},r.prototype.upgradeVisualObjects=function(e,t,r,i){},r.prototype.upgradeTablixProperties=function(e,t){e=e.values;if(e)for(var r=0,i=e;r<i.length;r++){var a=i[r];this.isValidRoleWildcard(a.selector,t)&&a.properties&&(a.properties.backColor||a.properties.fontColor)&&(a.selector.data=[{dataViewWildcard:{matchingOption:1}}])}},r.prototype.isValidRoleWildcard=function(e,t){return!(!e||_.isEmpty(e.data)||1!==e.data.length||_.isEmpty(e.data[0].roles))&&("tableEx"===t&&_.isEqual(e.data[0].roles,["Values"])||"pivotTable"===t&&_.isEqual(e.data[0].roles,["Rows","Columns"]))},r.prototype.upgradeFilterCollection=function(){},r.prototype.getVersion=function(){return i.ExplorationVersions.v5_9},r);function r(e){}e.VersionUpgrader=t})((i=e.upgrade||(e.upgrade={})).v5_9||(i.v5_9={}))})(powerbi=powerbi||{}),(function(e){(function(e){var s=jsCommon.Version;e.createVisualObjectsDowngrader=function(e){return new t(e)};var t=(r.prototype.getFinalVisualObjectsVersion=function(e,t,r,i){for(var a=0,o=this.downgraders;a<o.length;a++){var n=o[a];r=s.max(r,n.getMinDowngradeVersionForVisualObjects(e,t,i))}return r},r.prototype.downgrade=function(e,t,r,i){for(var a=0,o=this.downgraders;a<o.length;a++)o[a].downgradeVisualObjects(e,t,r,i)},r);function r(e){this.downgraders=e}e.VisualObjectsDowngrader=t})((e=(e=e.explore||(e.explore={})).services||(e.services={})).downgrade||(e.downgrade={}))})(powerbi=powerbi||{}),(function(e){(function(e){var l=jsCommon.Version;e.createVisualObjectsUpgrader=function(e){return new t(e)};var t=(r.prototype.upgrade=function(e,t,r,i){for(var a=0,o=this.upgraders;a<o.length;a++){var n=o[a],s=n.getVersion();l.gt(s,i)&&n.upgradeVisualObjects(e,t,r,i)}},r);function r(e){this.upgraders=e}e.VisualObjectsUpgrader=t})((e=(e=e.explore||(e.explore={})).services||(e.services={})).upgrade||(e.upgrade={}))})(powerbi=powerbi||{}),(function(A){!(function(r){var e=A.formattingService,t=jsCommon.Lazy,s=jsCommon.StringExtensions,i=(Object.defineProperty(a.prototype,"operator",{get:function(){return this.op},set:function(e){this.op!==e&&(this.op=e,this.onOperatorChanged())},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"valueRequired",{get:function(){return this.valRequired},enumerable:!1,configurable:!0}),a.prototype.accept=function(e){return e.visit(this)},a.empty=function(){return new a(0)},a.equals=function(e,t){return(e=e||null)===(t=t||null)||!e==!t&&(e.operator===t.operator&&V.equals(e.value,t.value))},a.prototype.onOperatorChanged=function(){this.valRequired=o.getValueRequired(this.operator),this.valRequired?this.cachedValue&&(this.value=this.cachedValue,this.cachedValue=void 0):this.value&&(this.cachedValue=this.value,this.value=void 0)},a);function a(e,t,r){this.op=e,this.onOperatorChanged(),this.isCalendarShown=!1,this.value=new V(t,r)}r.Condition=i;var o,n,l,p,u,c,d,m,v,f,g,h,y,C,x,b,S,E,N,V=(Object.defineProperty(P.prototype,"isDate",{get:function(){return null!=this.dateValue},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"hasValue",{get:function(){return null!=this.dateValue||!jsCommon.StringExtensions.isNullOrUndefinedOrWhiteSpaceString(this.stringValue)},enumerable:!1,configurable:!0}),P.prototype.isValidDate=function(){return this.isDate&&(!_.isString(this.value)||null!==e.parseDate(this.value))},P.equals=function(e,t){return(e=e||null)===(t=t||null)||!e==!t&&(P.compareDateTimeValue(e,t)&&e.stringValue===t.stringValue)},P.compareDateTimeValue=function(e,t){return(e.dateValue?e.dateValue.valueOf():0)===(t.dateValue?t.dateValue.valueOf():0)},P);function P(e,t){null!=e&&(e instanceof Date&&(this.dateValue=e),this.value=e,this.formatter=t,this.stringValue=this.formatter?this.formatter.format(this.value):this.value.toString()),this.dateValue?this.timeValue=new Date(this.dateValue.getTime()):(this.timeValue=new Date,this.timeValue.setHours(0,0,0,0))}function w(){var e=[];return e.push(n.getValue()),e}function T(e,t){var r;if(0<e.length){for(var i=[],a=0,o=e;a<o.length;a++){var n=o[a];i.push(j(n))}r=A.visuals.valueFormatter.formatListOr(i),r=t?s.format(A.common.getLocalize().get("FilterRestatement_NotEqual"),r):s.format(A.common.getLocalize().get("FilterRestatement_Equal"),r)}return r}function F(e,t){e=r.SQExprConverter.getFirstComparandValue(e);return t?t.format(e):e}function j(e){return null===e?null:_.isString(e)?e:e.displayName||("function"!=typeof e||"object"!=typeof e?e:void 0)}r.ConditionValue=V,i=o=r.OperatorHelper||(r.OperatorHelper={}),n=new t(function(){return{value:9,label:A.common.getLocalize().get("FilterOperator_Is"),tooltip:A.common.getLocalize().get("FilterOperator_IsTooltip")}}),l=new t(function(){return{value:10,label:A.common.getLocalize().get("FilterOperator_IsNot"),tooltip:A.common.getLocalize().get("FilterOperator_IsNotTooltip")}}),p=new t(function(){return{value:11,label:A.common.getLocalize().get("FilterOperator_IsBlank"),tooltip:A.common.getLocalize().get("FilterOperator_IsBlankTooltip")}}),u=new t(function(){return{value:12,label:A.common.getLocalize().get("FilterOperator_IsNotBlank"),tooltip:A.common.getLocalize().get("FilterOperator_IsNotBlankTooltip")}}),c=new t(function(){return{value:5,label:A.common.getLocalize().get("FilterOperator_Contains"),tooltip:A.common.getLocalize().get("FilterOperator_ContainsTooltip")}}),d=new t(function(){return{value:6,label:A.common.getLocalize().get("FilterOperator_DoesNotContain"),tooltip:A.common.getLocalize().get("FilterOperator_DoesNotContainTooltip")}}),m=new t(function(){return{value:7,label:A.common.getLocalize().get("FilterOperator_StartsWith"),tooltip:A.common.getLocalize().get("FilterOperator_StartsWithTooltip")}}),v=new t(function(){return{value:8,label:A.common.getLocalize().get("FilterOperator_DoesNotStartWith"),tooltip:A.common.getLocalize().get("FilterOperator_DoesNotStartWithTooltip")}}),f=new t(function(){return{value:13,label:A.common.getLocalize().get("FilterOperator_IsEmptyString"),tooltip:A.common.getLocalize().get("FilterOperator_IsEmptyStringTooltip")}}),g=new t(function(){return{value:14,label:A.common.getLocalize().get("FilterOperator_IsNotEmptyString"),tooltip:A.common.getLocalize().get("FilterOperator_IsNotEmptyStringTooltip")}}),h=new t(function(){return{value:3,label:A.common.getLocalize().get("FilterOperator_GreaterThan_DT"),tooltip:A.common.getLocalize().get("FilterOperator_GreaterThan_DT")}}),y=new t(function(){return{value:4,label:A.common.getLocalize().get("FilterOperator_GreaterThanOrEqual_DT"),tooltip:A.common.getLocalize().get("FilterOperator_GreaterThanOrEqual_DT")}}),C=new t(function(){return{value:1,label:A.common.getLocalize().get("FilterOperator_LessThan_DT"),tooltip:A.common.getLocalize().get("FilterOperator_LessThan_DT")}}),x=new t(function(){return{value:2,label:A.common.getLocalize().get("FilterOperator_LessThanOrEqual_DT"),tooltip:A.common.getLocalize().get("FilterOperator_LessThanOrEqual_DT")}}),b=new t(function(){return{value:3,label:A.common.getLocalize().get("FilterOperator_GreaterThan"),tooltip:A.common.getLocalize().get("FilterOperator_GreaterThan")}}),S=new t(function(){return{value:4,label:A.common.getLocalize().get("FilterOperator_GreaterThanOrEqual"),tooltip:A.common.getLocalize().get("FilterOperator_GreaterThanOrEqual")}}),E=new t(function(){return{value:1,label:A.common.getLocalize().get("FilterOperator_LessThan"),tooltip:A.common.getLocalize().get("FilterOperator_LessThan")}}),N=new t(function(){return{value:2,label:A.common.getLocalize().get("FilterOperator_LessThanOrEqual"),tooltip:A.common.getLocalize().get("FilterOperator_LessThanOrEqual")}}),i.getValueRequired=function(e){return 11!==e&&12!==e&&0!==e&&13!==e&&14!==e},i.getFilterOperators=function(e,t){return t?w():e.text?((r=[]).push(c.getValue()),r.push(d.getValue()),r.push(m.getValue()),r.push(v.getValue()),r.push(n.getValue()),r.push(l.getValue()),r.push(p.getValue()),r.push(u.getValue()),r.push(f.getValue()),r.push(g.getValue()),r):e.integer||e.numeric?((r=[]).push(E.getValue()),r.push(N.getValue()),r.push(b.getValue()),r.push(S.getValue()),r.push(n.getValue()),r.push(l.getValue()),r.push(p.getValue()),r.push(u.getValue()),r):e.dateTime?((e=[]).push(n.getValue()),e.push(l.getValue()),e.push(h.getValue()),e.push(y.getValue()),e.push(C.getValue()),e.push(x.getValue()),e.push(p.getValue()),e.push(u.getValue()),e):void 0;var r},i.isOperatorForColumnMappedToMParameter=function(t){return w().some((function(e){return e.value===t}))},(i=r.RestatementHelper||(r.RestatementHelper={})).fromCondition=function(e,t,r,i){for(var a,o=new R(t,r,i),n=0,s=e;n<s.length;n++){var l=s[n];null!=l.operator&&0!==l.operator&&(a=l.accept(o))}return a},i.fromLabels=T,i.fromDataViewScopeIdentities=function(e,t,r){for(var i=[],a=0,o=e;a<o.length;a++){var n=o[a];i.push(F(n,r))}return T(i,t)},i.getLabelFromScopeId=F,i.fromDefault=function(e){if(null!=e)return s.format(A.common.getLocalize().get("FilterRestatement_IsDefault"),j(e))};var R=(D.prototype.visit=function(e){e=this.conditionToString(e);if(e)return _.isEmpty(this.result)?this.result=e:(_.isEmpty(this.logicalOperatorResourceId),this.result=s.format(this.logicalOperatorResourceId,this.result,e)),this.result},D.prototype.conditionToString=function(e){var t,r=e.value;if(!o.getValueRequired(e.operator)||r&&r.hasValue)switch(r&&(t=this.formatter?this.formatter.format(r.value||r.stringValue):r.stringValue),e.operator){case 9:return s.format(this.localizationService.get("FilterRestatement_Equal"),t);case 10:return s.format(this.localizationService.get("FilterRestatement_NotEqual"),t);case 3:return r.isDate?s.format(this.localizationService.get("FilterRestatement_GreaterThan_DT"),t):s.format(this.localizationService.get("FilterRestatement_GreaterThan"),t);case 4:return r.isDate?s.format(this.localizationService.get("FilterRestatement_GreaterThanOrEqual_DT"),t):s.format(this.localizationService.get("FilterRestatement_GreaterThanOrEqual"),t);case 1:return r.isDate?s.format(this.localizationService.get("FilterRestatement_LessThan_DT"),t):s.format(this.localizationService.get("FilterRestatement_LessThan"),t);case 2:return r.isDate?s.format(this.localizationService.get("FilterRestatement_LessThanOrEqual_DT"),t):s.format(this.localizationService.get("FilterRestatement_LessThanOrEqual"),t);case 5:return s.format(this.localizationService.get("FilterRestatement_Contains"),t);case 6:return s.format(this.localizationService.get("FilterRestatement_DoesNotContain"),t);case 7:return s.format(this.localizationService.get("FilterRestatement_StartWith"),t);case 8:return s.format(this.localizationService.get("FilterRestatement_DoesNotStartWith"),t);case 11:return this.localizationService.get("FilterOperator_IsBlank");case 12:return this.localizationService.get("FilterOperator_IsNotBlank");case 13:return this.localizationService.get("FilterOperator_IsEmptyString");case 14:return this.localizationService.get("FilterOperator_IsNotEmptyString");default:return""}},D);function D(e,t,r){void 0===r&&(r=A.common.getLocalize()),this.localizationService=r,0===e?this.logicalOperatorResourceId=this.localizationService.get("FilterRestatement_CompoundAnd"):1===e&&(this.logicalOperatorResourceId=this.localizationService.get("Generic_Or")),this.formatter=t}})(A.data||(A.data={}))})(powerbi=powerbi||{}),(function(e){var i;function r(e,t){var r=e.value,i=e.unit,a=e.isTimeUnit;switch(i){case"S":return 1===r?t.get("TimeUnit_Second"):t.get("TimeUnit_Seconds");case"M":return a?1===r?t.get("TimeUnit_Minute"):t.get("TimeUnit_Minutes"):1===r?t.get("TimeUnit_Month"):t.get("TimeUnit_Months");case"H":return 1===r?t.get("TimeUnit_Hour"):t.get("TimeUnit_Hours");case"D":return 1===r?t.get("TimeUnit_Day"):t.get("TimeUnit_Days");case"W":return 1===r?t.get("TimeUnit_Week"):t.get("TimeUnit_Weeks");case"Y":return 1===r?t.get("TimeUnit_Year"):t.get("TimeUnit_Years");default:return""}}function a(e){switch(e){case"S":case"M":case"H":return!0;default:return!1}}function o(e,t){t=[{value:e,unit:t,isTimeUnit:a(t)}],t=i.DurationParser.durationParseResultItemsToDurationParseResult(t);return i.DurationParser.durationParseResultAsMilliseconds(t)}function n(e,t){t=Math.pow(10,t||0);return Math.round(e*t)/t}e=e.explore||(e.explore={}),(e=(i=e.util||(e.util={})).DurationDisplayHelper||(i.DurationDisplayHelper={})).isBelowMinimumValue=function(e,t,r){return o(e,t)<(r&&""!==r?i.DurationParser.durationParseResultAsMilliseconds(i.DurationParser.parseISODurationdString(r)):-Number.MAX_VALUE)},e.isAboveMaximumValue=function(e,t,r){return t=o(e,t),(r&&""!==r?i.DurationParser.durationParseResultAsMilliseconds(i.DurationParser.parseISODurationdString(r)):Number.MAX_VALUE)<t},e.getFullUnitName=r,e.getReadableTimeString=function(e,t){return e=i.DurationParser.parseISODurationdString(e),(e=i.DurationParser.durationParseResultToArray(e)).length<=0?"":e[0].value+" "+r(e[0],t)},e.isTimeUnit=a,e.convertSecondsToTimeString=function(e,t){return isNaN(e)?t.get("TwoDashes"):e<60?1===e?t.get("TimeUnit_One_second"):t.format("TimeUnit_seconds_with_value",[n(e,1)]):(e/=60)<60?1===e?t.get("TimeUnit_One_minute"):t.format("TimeUnit_minutes_with_value",[n(e,1)]):1===(e/=60)?t.get("SettingsDataset_ScheduleRefresh_RefreshFrequency_OneHour"):t.format("TimeUnit_hours_with_value",[n(e,1)])},e.getTimeString=function(e,t){var r=e.value,i=e.unit,a=e.isTimeUnit;switch(i){case"S":return 1===r?t.get("TimeUnit_One_second"):t.format("TimeUnit_seconds_with_value",r);case"M":return a?1===r?t.get("TimeUnit_One_minute"):t.format("CdsaAuthoring_Iframe_TheNumberOfHowManyMinutes",r):1===r?t.get("TimeUnit_One_month"):t.format("TimeUnit_months_with_value",r);case"H":return 1===r?t.get("SettingsDataset_ScheduleRefresh_RefreshFrequency_OneHour"):t.format("TimeUnit_hours_with_value",r);case"D":return 1===r?t.get("TimeUnit_One_day"):t.format("TimeUnit_days_with_value",r);case"W":return 1===r?t.get("TimeUnit_One_week"):t.format("TimeUnit_weeks_with_value",r);case"Y":return 1===r?t.get("TimeUnit_One_year"):t.format("TimeUnit_years_with_value",r);default:return""}}})(powerbi=powerbi||{}),(function(f){var e,a,g,h,y,o;function n(i,a){if(!i||!a)return i||a;for(var o={expressions:a.expressions.slice(),cachedValueItems:_.isEmpty(a.cachedValueItems)?[]:a.cachedValueItems.slice()},n={},e=0;e<i.expressions.length;e++)!(function(e){var t=i.expressions[e],r=_.findIndex(o.expressions,(function(e){return e===t||y.equals(e,t)}));-1===r&&(r=a.expressions.length,o.expressions.push(t)),n[e]=r})(e);if(!_.isEmpty(i.cachedValueItems))for(var t=0,r=i.cachedValueItems;t<r.length;t++){var s,l=r[t],p={};for(s in l.valueMap)p[n[s]]=l.valueMap[s];o.cachedValueItems.push({identities:l.identities,valueMap:p})}return o}function s(e,t){if(!_.isEmpty(e)){for(var r={expressions:[],cachedValueItems:[]},i=0,a=e;i<a.length;i++){var o,n=a[i],s={identities:[],valueMap:{}};n.valueDetails||(o=g.getDataViewKind(t),n.valueDetails=g.query([t],n,o,[],!0));for(var l=0,p=n.valueDetails;l<p.length;l++){var u,c=p[l];c.expr&&(y.isColumn(c.expr)||y.isHierarchyLevel(c.expr))&&((u=_.indexOf(r.expressions,c.expr))<0&&(r.expressions.push(c.expr),u=r.expressions.length-1),s.valueMap[u]=c.formattedValue)}if(!_.isEmpty(s.valueMap)){for(var d in n.dataMap)for(var m=0,v=jsCommon.ArrayExtensions.ensureArray(n.dataMap[d]);m<v.length;m++){var f=v[m];1===f.kind&&s.identities.push(f)}r.cachedValueItems.push(s)}}return r}}function l(e,t){if(!_.isEmpty(e))return r(_.map(e,(function(e){return h.convertSelectorsByColumnToSelector(e)})),t)}function r(e,t){if(!_.isEmpty(e)&&t&&t.query)for(var r=t.query.defn.select(),i=0,a=e;i<a.length;i++){var o=a[i],o=h.toScopeIdentities(o);if(_.isEmpty(o))return;for(var n=0,s=o;n<s.length;n++)for(var l=s[n].expr,l=f.data.ScopeIdentityExtractor.getKeys(l),p=0,u=l;p<u.length;p++)for(var c=u[p],d=0,m=r;d<m.length;d++){var v=m[d];if(!y.equals(c,v.expr))return!0}}}e=f.explore||(f.explore={}),a=e.FilterExpressionMetadataUtils||(e.FilterExpressionMetadataUtils={}),g=f.data.DataViewQueryEngine,h=f.data.Selector,y=f.data.SQExpr,o=f.data.SQExprBuilder,a.getSelectorsByColumnMetadata=function(e,t,r,i){if(void 0===i&&(i=!1),!_.isEmpty(e)&&l(e,t)){if(_.some(e,(function(e){return e.valueDetails}))&&i)return s(e,r);e=g.getDataPointsDescription(r,e);return a.convertToFilterExpressionMetadata(e)}},a.mergeFilterExpressionMetadata=n,a.mergeFilterExpressionMetadataArray=function(e){for(var t=null,r=0,i=e;r<i.length;r++)t=n(i[r],t);return t},a.convertCacheToFilterExpressionMetadata=function(e,t){if(!_.isEmpty(t)&&e){for(var r=[],i=0,a=t;i<a.length;i++){var o=a[i],n={identities:[o.identity],valueMap:{}};n.valueMap[0]=o.displayName,r.push(n)}return{expressions:[e],cachedValueItems:r}}},a.hydrateSelectorsByColumnWithValueDetails=function(m,v){if(m.length&&v.cachedValueItems&&v.cachedValueItems.length)for(var e=0;e<m.length;e++)!(function(e){var t=m[e],n=t.dataMap,r=e,i=v.cachedValueItems[r].identities,a=!0,o=0;for(u in n)for(var s=0,l=jsCommon.ArrayExtensions.ensureArray(n[u]);s<l.length;s++){var p=l[s];if(!i[o]||!f.DataViewScopeIdentity.equals(p,i[o])){a=!1;break}o++}if((r=!a?_.findIndex(v.cachedValueItems,(function(e){var t,r=0;for(t in n)for(var i=0,a=jsCommon.ArrayExtensions.ensureArray(n[t]);i<a.length;i++){var o=a[i];if(!e.identities[r]||!f.DataViewScopeIdentity.equals(o,e.identities[r]))return!1;r++}return!0})):r)<0)return;var u,c=[],d=v.cachedValueItems[r].valueMap;for(u in d)c.push({identity:v.cachedValueItems[r].identities[0],expr:v.expressions[u],formattedValue:d[u],value:d[u]});t.valueDetails=c})(e)},a.buildFilterExpressionMetadataFromSelectors=s,a.convertToFilterExpressionMetadata=function(e){if(!_.isEmpty(e)){for(var t={expressions:[],cachedValueItems:[]},r=0,i=e;r<i.length;r++){for(var a=i[r],o={identities:[],valueMap:{}},n=0,s=a.selector.data;n<s.length;n++){var l=s[n];1===l.kind&&o.identities.push(l)}for(var p=0,u=a.values;p<u.length;p++){var c,d=u[p];(d.expr instanceof f.data.SQColumnRefExpr||y.isHierarchyLevel(d.expr))&&((c=_.indexOf(t.expressions,d.expr))<0&&(t.expressions.push(d.expr),c=t.expressions.length-1),o.valueMap[c]=d.formattedValue)}_.isEmpty(o.valueMap)||t.cachedValueItems.push(o)}return t}},a.tryGetDisplayNameIdentityPairs=function(e){if(e&&!(_.isEmpty(e.expressions)||1<e.expressions.length)){for(var t=[],r=0,i=e.cachedValueItems;r<i.length;r++){var a=i[r];if(_.isEmpty(a.identities)||1<a.identities.length)return;a.valueMap[0];a={identity:a.identities[0],displayName:a.valueMap[0]};t.push(a)}return t}},a.hasGroupOnKeysByColumn=l,a.hasGroupOnKeys=r,a.isDecomposedFilterExpressionMetadata=function(e){return!!e.decomposedIdentities},a.isFilterExpressionMetadata=function(e){return!!e.cachedValueItems},a.makeIdentity=function(e,t){if(!e)return null;for(var r=0;r<e.length;r++)var i=o.equal(e[r],t[r]),a=a?o.and(a,i):i;return f.data.createDataViewScopeIdentity(a)}})(powerbi=powerbi||{}),(function(e){var r;function i(e,t){e=e&&parseFloat(e.replace(",","."));return(isNaN(e)?0:e)*t}e=(e=(e=e.explore||(e.explore={})).util||(e.util={})).DurationParser||(e.DurationParser={}),r=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/,e.parseISODurationdString=function(e){return t=e,e=r.exec(t)||new Array(9),t="-"===e[1]?-1:1,{years:i(e[2],t),months:i(e[3],t),weeks:i(e[4],t),days:i(e[5],t),hours:i(e[6],t),minutes:i(e[7],t),seconds:i(e[8],t)};var t},e.durationParseResultAsMilliseconds=function(e){return 31536e6*e.years+2592e6*e.months+6048e5*e.weeks+864e5*e.days+36e5*e.hours+6e4*e.minutes+1e3*e.seconds},e.durationParseResultItemsToDurationParseResult=function(e){for(var t={years:0,months:0,weeks:0,days:0,hours:0,minutes:0,seconds:0},r=0,i=e;r<i.length;r++){var a=i[r],o=a.value;a.isTimeUnit&&"S"===a.unit?t.seconds=o:a.isTimeUnit&&"M"===a.unit?t.minutes=o:a.isTimeUnit&&"H"===a.unit?t.hours=o:"D"===a.unit?t.days=o:"W"===a.unit?t.weeks=o:"M"===a.unit?t.months=o:"Y"===a.unit&&(t.years=o)}return t},e.durationParseResultToISODurationString=function(e){var t="P";return 0<e.years&&(t+=e.years+"Y"),0<e.months&&(t+=e.months+"M"),0<e.weeks&&(t+=e.weeks+"W"),0<e.days&&(t+=e.days+"D"),0===e.hours&&0===e.minutes&&0===e.seconds||(t+="T",0<e.hours&&(t+=e.hours+"H"),0<e.minutes&&(t+=e.minutes+"M"),0<e.seconds&&(t+=e.seconds+"S")),t},e.durationParseResultToArray=function(e){var t=[];return e.seconds&&t.push({value:e.seconds,unit:"S",isTimeUnit:!0}),e.minutes&&t.push({value:e.minutes,unit:"M",isTimeUnit:!0}),e.hours&&t.push({value:e.hours,unit:"H",isTimeUnit:!0}),e.days&&t.push({value:e.days,unit:"D",isTimeUnit:!1}),e.weeks&&t.push({value:e.weeks,unit:"W",isTimeUnit:!1}),e.months&&t.push({value:e.months,unit:"M",isTimeUnit:!1}),e.years&&t.push({value:e.years,unit:"Y",isTimeUnit:!1}),t}})(powerbi=powerbi||{}),(function(e){var i,t,a;function r(e){return!(null===(e=e.dynamicConfig)||void 0===e||!e.quickExplore)}i=e.explore||(e.explore={}),t=i.SectionUtils||(i.SectionUtils={}),a=e.explore.util.VisualContainerUtils,t.isQuickExploreSection=r,t.areAnySectionQuickExplore=function(e){return _.some(e,r)},t.getQuickExploreLayoutTelemetry=function(e){if(e=null===(e=null===(e=null==e?void 0:e.dynamicConfig)||void 0===e?void 0:e.quickExplore)||void 0===e?void 0:e.layout)return e.combination?"Combination."+e.combination.version:e.related?"Related."+e.related.version:void 0},t.setUniqueNewSectionCanvasItemNames=function(e,t){var r=_.flatMap(t,(function(e){return e.visualContainerGroups}));_.isEmpty(r)||i.contracts.traverseVisualContainerGroups(e.visualContainerGroups,(function(e){var t=a.uniqueName(r);e.name=t,r.push(e)}))}})(powerbi=powerbi||{});;
"use strict";var powerbi,__extends=this&&this.__extends||(function(){var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}})(),__awaiter=this&&this.__awaiter||function(e,o,s,l){return new(s=s||Promise)(function(i,t){function r(e){try{a(l.next(e))}catch(e){t(e)}}function n(e){try{a(l.throw(e))}catch(e){t(e)}}function a(e){var t;e.done?i(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(r,n)}a((l=l.apply(e,o||[])).next())})},__generator=this&&this.__generator||function(i,r){var n,a,o,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return (function(t){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(o=2&t[0]?a.return:t[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,t[1])).done)return o;switch(a=0,(t=o?[2&t[0],o.value]:t)[0]){case 0:case 1:o=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,a=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(o=0<(o=s.trys).length&&o[o.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!o||t[1]>o[0]&&t[1]<o[3])){s.label=t[1];break}if(6===t[0]&&s.label<o[1]){s.label=o[1],o=t;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(t);break}o[2]&&s.ops.pop(),s.trys.pop();continue}t=r.call(i,s)}catch(e){t=[6,e],a=0}finally{n=o=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}})([t,e])}}},__spreadArray=this&&this.__spreadArray||function(e,t){for(var i=0,r=t.length,n=e.length;i<r;i++,n++)e[n]=t[i];return e},__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};!(function(n){!(function(t){var e=jsCommon.Utility,i=n.telemetryEventFactory,r=n.telemetry.EventFactories;e?e.generateGuid:Function.prototype;t.EXNewExplorationEventName="PBI.EX.NewExploration",t.EXNewExploration=r[t.EXNewExplorationEventName]=function(e){return i({name:t.EXNewExplorationEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,optionalParameters:["enterpriseCapacitySkuTier"],loggers:t.EXNewExplorationLoggers})},t.EXRefreshReportEventName="PBI.EX.RefreshReport",t.EXRefreshReport=r[t.EXRefreshReportEventName]=function(e){return i({name:t.EXRefreshReportEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXRefreshReportLoggers})},t.EXSaveExplorationEventName="PBI.EX.SaveExploration",t.EXSaveExploration=r[t.EXSaveExplorationEventName]=function(e){return i({name:t.EXSaveExplorationEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,optionalParameters:["isPersonalization"],loggers:t.EXSaveExplorationLoggers})},t.EXInteractionVisualConversionEventName="PBI.EX.InteractionVisualConversion",t.EXInteractionVisualConversion=r[t.EXInteractionVisualConversionEventName]=function(e){return i({name:t.EXInteractionVisualConversionEventName,baseEvent:t.Verbose(e),info:e,category:n.TelemetryCategory.Verbose,loggers:t.EXInteractionVisualConversionLoggers})},t.EXInteractionExpandEventName="PBI.EX.InteractionExpand",t.EXInteractionExpand=r[t.EXInteractionExpandEventName]=function(e){return i({name:t.EXInteractionExpandEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXInteractionExpandLoggers})},t.EXInteractionDrillEventName="PBI.EX.InteractionDrill",t.EXInteractionDrill=r[t.EXInteractionDrillEventName]=function(e){return i({name:t.EXInteractionDrillEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXInteractionDrillLoggers,logExpAssignment:!0})},t.EXDrillToDetailsEventName="PBI.EX.DrillToDetails",t.EXDrillToDetails=r[t.EXDrillToDetailsEventName]=function(e){return i({name:t.EXDrillToDetailsEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXDrillToDetailsLoggers,logExpAssignment:!0})},t.EXAddFilterEventName="PBI.EX.AddFilter",t.EXAddFilter=r[t.EXAddFilterEventName]=function(e){return i({name:t.EXAddFilterEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXAddFilterLoggers})},t.EXClearFilterEventName="PBI.EX.ClearFilter",t.EXClearFilter=r[t.EXClearFilterEventName]=function(e){return i({name:t.EXClearFilterEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXClearFilterLoggers,logExpAssignment:!0})},t.EXRemoveFilterEventName="PBI.EX.RemoveFilter",t.EXRemoveFilter=r[t.EXRemoveFilterEventName]=function(e){return i({name:t.EXRemoveFilterEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXRemoveFilterLoggers})},t.EXHideFilterEventName="PBI.EX.HideFilter",t.EXHideFilter=r[t.EXHideFilterEventName]=function(e){return i({name:t.EXHideFilterEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXHideFilterLoggers})},t.EXLockFilterEventName="PBI.EX.LockFilter",t.EXLockFilter=r[t.EXLockFilterEventName]=function(e){return i({name:t.EXLockFilterEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXLockFilterLoggers})},t.EXTogglePaneExpandedEventName="PBI.EX.TogglePaneExpanded",t.EXTogglePaneExpanded=r[t.EXTogglePaneExpandedEventName]=function(e){return i({name:t.EXTogglePaneExpandedEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXTogglePaneExpandedLoggers})},t.EXToggleFilterCardExpandedEventName="PBI.EX.ToggleFilterCardExpanded",t.EXToggleFilterCardExpanded=r[t.EXToggleFilterCardExpandedEventName]=function(e){return i({name:t.EXToggleFilterCardExpandedEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,optionalParameters:["isInOutspacePane"],loggers:t.EXToggleFilterCardExpandedLoggers})},t.EXToggleFilterCardSortEventName="PBI.EX.ToggleFilterCardSort",t.EXToggleFilterCardSort=r[t.EXToggleFilterCardSortEventName]=function(e){return i({name:t.EXToggleFilterCardSortEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXToggleFilterCardSortLoggers})},t.EXFilterPaneAdvancedFilterAppliedEventName="PBI.EX.FilterPaneAdvancedFilterApplied",t.EXFilterPaneAdvancedFilterApplied=r[t.EXFilterPaneAdvancedFilterAppliedEventName]=function(e){return i({name:t.EXFilterPaneAdvancedFilterAppliedEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,optionalParameters:["isInOutspacePane","isDateTime"],loggers:t.EXFilterPaneAdvancedFilterAppliedLoggers})},t.EXFilterPaneTopNFilterAppliedEventName="PBI.EX.FilterPaneTopNFilterApplied",t.EXFilterPaneTopNFilterApplied=r[t.EXFilterPaneTopNFilterAppliedEventName]=function(e){return i({name:t.EXFilterPaneTopNFilterAppliedEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,optionalParameters:["isInOutspacePane"],loggers:t.EXFilterPaneTopNFilterAppliedLoggers})},t.EXFilterPaneRelativeDateFilterAppliedEventName="PBI.EX.FilterPaneRelativeDateFilterApplied",t.EXFilterPaneRelativeDateFilterApplied=r[t.EXFilterPaneRelativeDateFilterAppliedEventName]=function(e){return i({name:t.EXFilterPaneRelativeDateFilterAppliedEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,optionalParameters:["isInOutspacePane"],loggers:t.EXFilterPaneRelativeDateFilterAppliedLoggers})},t.EXFilterPaneRelativeTimeFilterAppliedEventName="PBI.EX.FilterPaneRelativeTimeFilterApplied",t.EXFilterPaneRelativeTimeFilterApplied=r[t.EXFilterPaneRelativeTimeFilterAppliedEventName]=function(e){return i({name:t.EXFilterPaneRelativeTimeFilterAppliedEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,optionalParameters:["isInOutspacePane"],loggers:t.EXFilterPaneRelativeTimeFilterAppliedLoggers})},t.EXFilterPaneBasicFilterChangedEventName="PBI.EX.FilterPaneBasicFilterChanged",t.EXFilterPaneBasicFilterChanged=r[t.EXFilterPaneBasicFilterChangedEventName]=function(e){return i({name:t.EXFilterPaneBasicFilterChangedEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,optionalParameters:["isInOutspacePane"],loggers:t.EXFilterPaneBasicFilterChangedLoggers,logExpAssignment:!0})},t.EXFilterPaneFilterDefaultRestoredEventName="PBI.EX.FilterPaneFilterDefaultRestored",t.EXFilterPaneFilterDefaultRestored=r[t.EXFilterPaneFilterDefaultRestoredEventName]=function(e){return i({name:t.EXFilterPaneFilterDefaultRestoredEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXFilterPaneFilterDefaultRestoredLoggers})},t.EXFilterPaneFilterClearedEventName="PBI.EX.FilterPaneFilterCleared",t.EXFilterPaneFilterCleared=r[t.EXFilterPaneFilterClearedEventName]=function(e){return i({name:t.EXFilterPaneFilterClearedEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXFilterPaneFilterClearedLoggers,logExpAssignment:!0})},t.EXFilterPaneFilterDeletedEventName="PBI.EX.FilterPaneFilterDeleted",t.EXFilterPaneFilterDeleted=r[t.EXFilterPaneFilterDeletedEventName]=function(e){return i({name:t.EXFilterPaneFilterDeletedEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXFilterPaneFilterDeletedLoggers})},t.EXFilterPaneInteractionEventName="PBI.EX.FilterPaneInteraction",t.EXFilterPaneInteraction=r[t.EXFilterPaneInteractionEventName]=function(e){return i({name:t.EXFilterPaneInteractionEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,optionalParameters:["isInOutspacePane"],loggers:t.EXFilterPaneInteractionLoggers,logExpAssignment:!0})},t.EXImprovedFilterExperienceToggleOutspacePaneExpansionEventName="PBI.EX.ImprovedFilterExperience.ToggleOutspacePaneExpansion",t.EXImprovedFilterExperienceToggleOutspacePaneExpansion=r[t.EXImprovedFilterExperienceToggleOutspacePaneExpansionEventName]=function(e){return i({name:t.EXImprovedFilterExperienceToggleOutspacePaneExpansionEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXImprovedFilterExperienceToggleOutspacePaneExpansionLoggers,logExpAssignment:!0})},t.EXImprovedFilterExperienceToggleOutspacePaneVisibilityEventName="PBI.EX.ImprovedFilterExperience.ToggleOutspacePaneVisibility",t.EXImprovedFilterExperienceToggleOutspacePaneVisibility=r[t.EXImprovedFilterExperienceToggleOutspacePaneVisibilityEventName]=function(e){return i({name:t.EXImprovedFilterExperienceToggleOutspacePaneVisibilityEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXImprovedFilterExperienceToggleOutspacePaneVisibilityLoggers})},t.EXImprovedFilterExperienceShowRestatementEventName="PBI.EX.ImprovedFilterExperience.ShowRestatement",t.EXImprovedFilterExperienceShowRestatement=r[t.EXImprovedFilterExperienceShowRestatementEventName]=function(e){return i({name:t.EXImprovedFilterExperienceShowRestatementEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXImprovedFilterExperienceShowRestatementLoggers,logExpAssignment:!0})},t.EXLoadFilterErrorEventName="PBI.EX.LoadFilterError",t.EXLoadFilterError=r[t.EXLoadFilterErrorEventName]=function(e){return i({name:t.EXLoadFilterErrorEventName,info:e,category:n.TelemetryCategory.CriticalError,loggers:t.EXLoadFilterErrorLoggers})},t.EXCreateVisualEventName="PBI.EX.CreateVisual",t.EXCreateVisual=r[t.EXCreateVisualEventName]=function(e){return i({name:t.EXCreateVisualEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXCreateVisualLoggers})},t.EXAddFieldEventName="PBI.EX.AddField",t.EXAddField=r[t.EXAddFieldEventName]=function(e){return i({name:t.EXAddFieldEventName,baseEvent:t.Verbose(e),info:e,category:n.TelemetryCategory.Verbose,loggers:t.EXAddFieldLoggers})},t.EXResolveParametersEventName="PBI.EX.ResolveParameters",t.EXResolveParameters=r[t.EXResolveParametersEventName]=function(e){return i({name:t.EXResolveParametersEventName,baseEvent:t.Verbose(e),info:e,category:n.TelemetryCategory.Verbose,loggers:t.EXResolveParametersLoggers,logRatio:.001})},t.EXSwitchQueryParameterEventName="PBI.EX.SwitchQueryParameter",t.EXSwitchQueryParameter=r[t.EXSwitchQueryParameterEventName]=function(e){return i({name:t.EXSwitchQueryParameterEventName,baseEvent:t.Verbose(e),info:e,category:n.TelemetryCategory.Verbose,loggers:t.EXSwitchQueryParameterLoggers})},t.EXChangeQuickCalcEventName="PBI.EX.ChangeQuickCalc",t.EXChangeQuickCalc=r[t.EXChangeQuickCalcEventName]=function(e){return i({name:t.EXChangeQuickCalcEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXChangeQuickCalcLoggers})},t.EXSetConditionalFormattingEventName="PBI.EX.SetConditionalFormatting",t.EXSetConditionalFormatting=r[t.EXSetConditionalFormattingEventName]=function(e){return i({name:t.EXSetConditionalFormattingEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXSetConditionalFormattingLoggers})},t.EXSetDataBarsEventName="PBI.EX.SetDataBars",t.EXSetDataBars=r[t.EXSetDataBarsEventName]=function(e){return i({name:t.EXSetDataBarsEventName,baseEvent:t.Verbose(e),info:e,category:n.TelemetryCategory.Verbose,loggers:t.EXSetDataBarsLoggers})},t.EXExplorationRefreshEventName="PBI.EX.ExplorationRefresh",t.EXExplorationRefresh=r[t.EXExplorationRefreshEventName]=function(e){return i({name:t.EXExplorationRefreshEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXExplorationRefreshLoggers})},t.EXSnapshotEmbedCreateEventName="PBI.EX.SnapshotEmbedCreate",t.EXSnapshotEmbedCreate=r[t.EXSnapshotEmbedCreateEventName]=function(e){return i({name:t.EXSnapshotEmbedCreateEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXSnapshotEmbedCreateLoggers})},t.EXPublicEmbedCreateEventName="PBI.EX.PublicEmbedCreate",t.EXPublicEmbedCreate=r[t.EXPublicEmbedCreateEventName]=function(e){return i({name:t.EXPublicEmbedCreateEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXPublicEmbedCreateLoggers})},t.EXSnapshotEmbedDeleteEventName="PBI.EX.SnapshotEmbedDelete",t.EXSnapshotEmbedDelete=r[t.EXSnapshotEmbedDeleteEventName]=function(e){return i({name:t.EXSnapshotEmbedDeleteEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXSnapshotEmbedDeleteLoggers})},t.EXSnapshotEmbedUpdateEventName="PBI.EX.SnapshotEmbedUpdate",t.EXSnapshotEmbedUpdate=r[t.EXSnapshotEmbedUpdateEventName]=function(e){return i({name:t.EXSnapshotEmbedUpdateEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXSnapshotEmbedUpdateLoggers})},t.EXImportCustomVizEventName="PBI.EX.ImportCustomViz",t.EXImportCustomViz=r[t.EXImportCustomVizEventName]=function(e){return i({name:t.EXImportCustomVizEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXImportCustomVizLoggers})},t.EXCdnVisualOverrideEventName="PBI.EX.CdnVisualOverride",t.EXCdnVisualOverride=r[t.EXCdnVisualOverrideEventName]=function(e){return i({name:t.EXCdnVisualOverrideEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXCdnVisualOverrideLoggers})},t.EXDeleteCustomVizEventName="PBI.EX.DeleteCustomViz",t.EXDeleteCustomViz=r[t.EXDeleteCustomVizEventName]=function(e){return i({name:t.EXDeleteCustomVizEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXDeleteCustomVizLoggers})},t.EXEnableCustomVizEventName="PBI.EX.EnableCustomViz",t.EXEnableCustomViz=r[t.EXEnableCustomVizEventName]=function(e){return i({name:t.EXEnableCustomVizEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXEnableCustomVizLoggers})},t.EXVisualRelationshipOverrideEventName="PBI.EX.VisualRelationshipOverride",t.EXVisualRelationshipOverride=r[t.EXVisualRelationshipOverrideEventName]=function(e){return i({name:t.EXVisualRelationshipOverrideEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXVisualRelationshipOverrideLoggers})},t.EXCodePaneUserRunScriptEventName="PBI.EX.CodePaneUserRunScript",t.EXCodePaneUserRunScript=r[t.EXCodePaneUserRunScriptEventName]=function(e){return i({name:t.EXCodePaneUserRunScriptEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXCodePaneUserRunScriptLoggers})},t.EXCodePaneUserEditScriptWithExternalIDEEventName="PBI.EX.CodePaneUserEditScriptWithExternalIDE",t.EXCodePaneUserEditScriptWithExternalIDE=r[t.EXCodePaneUserEditScriptWithExternalIDEEventName]=function(e){return i({name:t.EXCodePaneUserEditScriptWithExternalIDEEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXCodePaneUserEditScriptWithExternalIDELoggers})},t.EXCodePaneUserOpenOptionsDialogEventName="PBI.EX.CodePaneUserOpenOptionsDialog",t.EXCodePaneUserOpenOptionsDialog=r[t.EXCodePaneUserOpenOptionsDialogEventName]=function(e){return i({name:t.EXCodePaneUserOpenOptionsDialogEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXCodePaneUserOpenOptionsDialogLoggers})},t.EXCodePaneLaunchExternalIDEFailedEventName="PBI.EX.CodePaneLaunchExternalIDEFailed",t.EXCodePaneLaunchExternalIDEFailed=r[t.EXCodePaneLaunchExternalIDEFailedEventName]=function(e){return i({name:t.EXCodePaneLaunchExternalIDEFailedEventName,info:e,category:n.TelemetryCategory.CriticalError,loggers:t.EXCodePaneLaunchExternalIDEFailedLoggers})},t.EXCodePaneLaunchExternalIDESucceededEventName="PBI.EX.CodePaneLaunchExternalIDESucceeded",t.EXCodePaneLaunchExternalIDESucceeded=r[t.EXCodePaneLaunchExternalIDESucceededEventName]=function(e){return i({name:t.EXCodePaneLaunchExternalIDESucceededEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXCodePaneLaunchExternalIDESucceededLoggers})},t.EXCodePaneShowWarningEventName="PBI.EX.CodePaneShowWarning",t.EXCodePaneShowWarning=r[t.EXCodePaneShowWarningEventName]=function(e){return i({name:t.EXCodePaneShowWarningEventName,info:e,category:n.TelemetryCategory.CriticalError,loggers:t.EXCodePaneShowWarningLoggers})},t.EXExportVisualDataEventName="PBI.EX.ExportVisualData",t.EXExportVisualData=r[t.EXExportVisualDataEventName]=function(e){return i({name:t.EXExportVisualDataEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,optionalParameters:["requestId"],loggers:t.EXExportVisualDataLoggers,logExpAssignment:!0})},t.EXLoadReportWithScriptVisEventName="PBI.EX.LoadReportWithScriptVis",t.EXLoadReportWithScriptVis=r[t.EXLoadReportWithScriptVisEventName]=function(e){return i({name:t.EXLoadReportWithScriptVisEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXLoadReportWithScriptVisLoggers})},t.ExploreHostChangeReportPageEventName="PBI.ExploreHost.ChangeReportPage",t.ExploreHostChangeReportPage=r[t.ExploreHostChangeReportPageEventName]=function(e){return i({name:t.ExploreHostChangeReportPageEventName,baseEvent:t.Verbose(e),info:e,category:n.TelemetryCategory.Verbose,optionalParameters:["sectionGuid","groupObjectId","isReadonlyGroup","scrubUserInfo","newReport"],loggers:t.ExploreHostChangeReportPageLoggers})},t.EXRemoveMobileCanvasVisualsEventName="PBI.EX.RemoveMobileCanvasVisuals",t.EXRemoveMobileCanvasVisuals=r[t.EXRemoveMobileCanvasVisualsEventName]=function(e){return i({name:t.EXRemoveMobileCanvasVisualsEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXRemoveMobileCanvasVisualsLoggers})},t.EXLoadReportContainerEventName="PBI.EX.LoadReportContainer",t.EXLoadReportContainer=r[t.EXLoadReportContainerEventName]=function(e){return i({name:t.EXLoadReportContainerEventName,baseEvent:t.Verbose(e),info:e,category:n.TelemetryCategory.Verbose,loggers:t.EXLoadReportContainerLoggers})},t.EXLoadReportContainerDatasetMissingEventName="PBI.EX.LoadReportContainerDatasetMissing",t.EXLoadReportContainerDatasetMissing=r[t.EXLoadReportContainerDatasetMissingEventName]=function(e){return i({name:t.EXLoadReportContainerDatasetMissingEventName,baseEvent:t.Verbose(e),info:e,category:n.TelemetryCategory.Verbose,loggers:t.EXLoadReportContainerDatasetMissingLoggers})},t.EXInitExplorationEventName="PBI.EX.InitExploration",t.EXInitExploration=r[t.EXInitExplorationEventName]=function(e){return i({name:t.EXInitExplorationEventName,baseEvent:t.Verbose(e),info:e,category:n.TelemetryCategory.Verbose,loggers:t.EXInitExplorationLoggers})},t.EXLoadExplorationVisualsEventName="PBI.EX.LoadExplorationVisuals",t.EXLoadExplorationVisuals=r[t.EXLoadExplorationVisualsEventName]=function(e){return i({name:t.EXLoadExplorationVisualsEventName,baseEvent:t.Verbose(e),info:e,category:n.TelemetryCategory.Verbose,loggers:t.EXLoadExplorationVisualsLoggers,defaultTimeoutSec:60})},t.EXVisualContainerChangedEventName="PBI.EX.VisualContainerChanged",t.EXVisualContainerChanged=r[t.EXVisualContainerChangedEventName]=function(e){return i({name:t.EXVisualContainerChangedEventName,baseEvent:t.Verbose(e),info:e,category:n.TelemetryCategory.Verbose,loggers:t.EXVisualContainerChangedLoggers,logRatio:0})},t.EXRenderExplorationVisualEventName="PBI.EX.RenderExplorationVisual",t.EXRenderExplorationVisual=r[t.EXRenderExplorationVisualEventName]=function(e){return i({name:t.EXRenderExplorationVisualEventName,baseEvent:t.Verbose(e),info:e,category:n.TelemetryCategory.Verbose,loggers:t.EXRenderExplorationVisualLoggers,logRatio:.01})},t.EXFetchExplorationEventName="PBI.EX.FetchExploration",t.EXFetchExploration=r[t.EXFetchExplorationEventName]=function(e){return i({name:t.EXFetchExplorationEventName,baseEvent:t.Verbose(e),info:e,category:n.TelemetryCategory.Verbose,loggers:t.EXFetchExplorationLoggers})},t.EXChangeCanvasLayoutEventName="PBI.EX.ChangeCanvasLayout",t.EXChangeCanvasLayout=r[t.EXChangeCanvasLayoutEventName]=function(e){return i({name:t.EXChangeCanvasLayoutEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXChangeCanvasLayoutLoggers})},t.EXClusteringAddClusteringEventName="PBI.EX.Clustering.AddClustering",t.EXClusteringAddClustering=r[t.EXClusteringAddClusteringEventName]=function(e){return i({name:t.EXClusteringAddClusteringEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXClusteringAddClusteringLoggers})},t.EXClusteringEditClusteringEventName="PBI.EX.Clustering.EditClustering",t.EXClusteringEditClustering=r[t.EXClusteringEditClusteringEventName]=function(e){return i({name:t.EXClusteringEditClusteringEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXClusteringEditClusteringLoggers})},t.EXQuickMeasuresOpenDialogEventName="PBI.EX.QuickMeasures.OpenDialog",t.EXQuickMeasuresOpenDialog=r[t.EXQuickMeasuresOpenDialogEventName]=function(e){return i({name:t.EXQuickMeasuresOpenDialogEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXQuickMeasuresOpenDialogLoggers})},t.EXQuickMeasuresDialogResultEventName="PBI.EX.QuickMeasures.DialogResult",t.EXQuickMeasuresDialogResult=r[t.EXQuickMeasuresDialogResultEventName]=function(e){return i({name:t.EXQuickMeasuresDialogResultEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXQuickMeasuresDialogResultLoggers})},t.EXQuickMeasuresOnMeasureChangeEventName="PBI.EX.QuickMeasures.OnMeasureChange",t.EXQuickMeasuresOnMeasureChange=r[t.EXQuickMeasuresOnMeasureChangeEventName]=function(e){return i({name:t.EXQuickMeasuresOnMeasureChangeEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXQuickMeasuresOnMeasureChangeLoggers})},t.EXDrillthroughGotoTargetEventName="PBI.EX.Drillthrough.GotoTarget",t.EXDrillthroughGotoTarget=r[t.EXDrillthroughGotoTargetEventName]=function(e){return i({name:t.EXDrillthroughGotoTargetEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXDrillthroughGotoTargetLoggers,logExpAssignment:!0})},t.EXDrillthroughFilterUpdateEventName="PBI.EX.Drillthrough.FilterUpdate",t.EXDrillthroughFilterUpdate=r[t.EXDrillthroughFilterUpdateEventName]=function(e){return i({name:t.EXDrillthroughFilterUpdateEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXDrillthroughFilterUpdateLoggers})},t.EXRefreshHostDataEventName="PBI.EX.RefreshHostData",t.EXRefreshHostData=r[t.EXRefreshHostDataEventName]=function(e){return i({name:t.EXRefreshHostDataEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXRefreshHostDataLoggers})},t.EXBookmarkAddEventName="PBI.EX.BookmarkAdd",t.EXBookmarkAdd=r[t.EXBookmarkAddEventName]=function(e){return i({name:t.EXBookmarkAddEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXBookmarkAddLoggers})},t.EXBookmarkUpdateEventName="PBI.EX.BookmarkUpdate",t.EXBookmarkUpdate=r[t.EXBookmarkUpdateEventName]=function(e){return i({name:t.EXBookmarkUpdateEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXBookmarkUpdateLoggers})},t.EXBookmarkDeleteEventName="PBI.EX.BookmarkDelete",t.EXBookmarkDelete=r[t.EXBookmarkDeleteEventName]=function(e){return i({name:t.EXBookmarkDeleteEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXBookmarkDeleteLoggers})},t.EXBookmarkPlayEventName="PBI.EX.BookmarkPlay",t.EXBookmarkPlay=r[t.EXBookmarkPlayEventName]=function(e){return i({name:t.EXBookmarkPlayEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXBookmarkPlayLoggers})},t.EXBookmarkApplyEventName="PBI.EX.BookmarkApply",t.EXBookmarkApply=r[t.EXBookmarkApplyEventName]=function(e){return i({name:t.EXBookmarkApplyEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXBookmarkApplyLoggers})},t.EXBookmarkLoadErrorEventName="PBI.EX.Bookmark.LoadError",t.EXBookmarkLoadError=r[t.EXBookmarkLoadErrorEventName]=function(e){return i({name:t.EXBookmarkLoadErrorEventName,baseEvent:t.ErrorWithStackTrace(e),info:e,category:n.TelemetryCategory.CriticalError,loggers:t.EXBookmarkLoadErrorLoggers})},t.EXCopyPasteSyncGroupEventName="PBI.EX.CopyPasteSyncGroup",t.EXCopyPasteSyncGroup=r[t.EXCopyPasteSyncGroupEventName]=function(e){return i({name:t.EXCopyPasteSyncGroupEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXCopyPasteSyncGroupLoggers})},t.EXCustomDateTableOpenDialogEventName="PBI.EX.CustomDateTableOpenDialog",t.EXCustomDateTableOpenDialog=r[t.EXCustomDateTableOpenDialogEventName]=function(e){return i({name:t.EXCustomDateTableOpenDialogEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXCustomDateTableOpenDialogLoggers})},t.EXCustomDateTableCommitEventName="PBI.EX.CustomDateTableCommit",t.EXCustomDateTableCommit=r[t.EXCustomDateTableCommitEventName]=function(e){return i({name:t.EXCustomDateTableCommitEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXCustomDateTableCommitLoggers})},t.EXCustomDateTableValidationResultEventName="PBI.EX.CustomDateTableValidationResult",t.EXCustomDateTableValidationResult=r[t.EXCustomDateTableValidationResultEventName]=function(e){return i({name:t.EXCustomDateTableValidationResultEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXCustomDateTableValidationResultLoggers})},t.EXUpdateActiveSectionEventName="PBI.EX.UpdateActiveSection",t.EXUpdateActiveSection=r[t.EXUpdateActiveSectionEventName]=function(e){return i({name:t.EXUpdateActiveSectionEventName,baseEvent:t.Verbose(e),info:e,category:n.TelemetryCategory.Verbose,optionalParameters:["forceUpdate","suppressHistory","clearSelection","isCancelled1"],loggers:t.EXUpdateActiveSectionLoggers,defaultTimeoutSec:10})},t.EXVisualContainerApplyUpdateEventName="PBI.EX.VisualContainerApplyUpdate",t.EXVisualContainerApplyUpdate=r[t.EXVisualContainerApplyUpdateEventName]=function(e){return i({name:t.EXVisualContainerApplyUpdateEventName,baseEvent:t.Verbose(e),info:e,category:n.TelemetryCategory.Verbose,loggers:t.EXVisualContainerApplyUpdateLoggers,logRatio:0})},t.EXVisualDataChangedEventName="PBI.EX.VisualDataChanged",t.EXVisualDataChanged=r[t.EXVisualDataChangedEventName]=function(e){return i({name:t.EXVisualDataChangedEventName,baseEvent:t.Verbose(e),info:e,category:n.TelemetryCategory.Verbose,loggers:t.EXVisualDataChangedLoggers,logRatio:0})},t.EXApplySlicerEventName="PBI.EX.ApplySlicer",t.EXApplySlicer=r[t.EXApplySlicerEventName]=function(e){return i({name:t.EXApplySlicerEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXApplySlicerLoggers,logExpAssignment:!0})},t.EXApplyAllClickedEventName="PBI.EX.ApplyAllClicked",t.EXApplyAllClicked=r[t.EXApplyAllClickedEventName]=function(e){return i({name:t.EXApplyAllClickedEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXApplyAllClickedLoggers})},t.EXSelectDataPointEventName="PBI.EX.SelectDataPoint",t.EXSelectDataPoint=r[t.EXSelectDataPointEventName]=function(e){return i({name:t.EXSelectDataPointEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXSelectDataPointLoggers,logExpAssignment:!0})},t.EXRefreshSingleVisualEventName="PBI.EX.RefreshSingleVisual",t.EXRefreshSingleVisual=r[t.EXRefreshSingleVisualEventName]=function(e){return i({name:t.EXRefreshSingleVisualEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXRefreshSingleVisualLoggers})},t.EXPerformanceAnalyzerRefreshReportEventName="PBI.EX.PerformanceAnalyzerRefreshReport",t.EXPerformanceAnalyzerRefreshReport=r[t.EXPerformanceAnalyzerRefreshReportEventName]=function(e){return i({name:t.EXPerformanceAnalyzerRefreshReportEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXPerformanceAnalyzerRefreshReportLoggers})},t.EXPerformanceAnalyzerExportLogsEventName="PBI.EX.PerformanceAnalyzerExportLogs",t.EXPerformanceAnalyzerExportLogs=r[t.EXPerformanceAnalyzerExportLogsEventName]=function(e){return i({name:t.EXPerformanceAnalyzerExportLogsEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXPerformanceAnalyzerExportLogsLoggers})},t.EXPerformanceAnalyzerCopyQueriesEventName="PBI.EX.PerformanceAnalyzerCopyQueries",t.EXPerformanceAnalyzerCopyQueries=r[t.EXPerformanceAnalyzerCopyQueriesEventName]=function(e){return i({name:t.EXPerformanceAnalyzerCopyQueriesEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXPerformanceAnalyzerCopyQueriesLoggers})},t.EXPerformanceAnalyzerStopRecordingEventName="PBI.EX.PerformanceAnalyzerStopRecording",t.EXPerformanceAnalyzerStopRecording=r[t.EXPerformanceAnalyzerStopRecordingEventName]=function(e){return i({name:t.EXPerformanceAnalyzerStopRecordingEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXPerformanceAnalyzerStopRecordingLoggers})},t.EXThemeDialogClosedEventName="PBI.EX.ThemeDialogClosed",t.EXThemeDialogClosed=r[t.EXThemeDialogClosedEventName]=function(e){return i({name:t.EXThemeDialogClosedEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXThemeDialogClosedLoggers})},t.SettingsFavoriteResourcePackagesEventName="PBI.Settings.FavoriteResourcePackages",t.SettingsFavoriteResourcePackages=r[t.SettingsFavoriteResourcePackagesEventName]=function(e){return i({name:t.SettingsFavoriteResourcePackagesEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,optionalParameters:["favoriteResourcePackagePayload"],loggers:t.SettingsFavoriteResourcePackagesLoggers})},t.SettingsVisualPaneEventName="PBI.Settings.VisualPane",t.SettingsVisualPane=r[t.SettingsVisualPaneEventName]=function(e){return i({name:t.SettingsVisualPaneEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,optionalParameters:["visualPaneActionPayload"],loggers:t.SettingsVisualPaneLoggers})},t.SettingsOutOfBoxVisualsEventName="PBI.Settings.OutOfBoxVisuals",t.SettingsOutOfBoxVisuals=r[t.SettingsOutOfBoxVisualsEventName]=function(e){return i({name:t.SettingsOutOfBoxVisualsEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,optionalParameters:["outOfBoxVisuals"],loggers:t.SettingsOutOfBoxVisualsLoggers})},t.EXDrillthroughButtonClickedEventName="PBI.EX.DrillthroughButtonClicked",t.EXDrillthroughButtonClicked=r[t.EXDrillthroughButtonClickedEventName]=function(e){return i({name:t.EXDrillthroughButtonClickedEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXDrillthroughButtonClickedLoggers})},t.EXSmallMultiplesFirstFieldEventName="PBI.EX.SmallMultiplesFirstField",t.EXSmallMultiplesFirstField=r[t.EXSmallMultiplesFirstFieldEventName]=function(e){return i({name:t.EXSmallMultiplesFirstFieldEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXSmallMultiplesFirstFieldLoggers})},t.EXAnalyticsLoadSchemaErrorEventName="PBI.EX.AnalyticsLoadSchemaError",t.EXAnalyticsLoadSchemaError=r[t.EXAnalyticsLoadSchemaErrorEventName]=function(e){return i({name:t.EXAnalyticsLoadSchemaErrorEventName,info:e,category:n.TelemetryCategory.CriticalError,loggers:t.EXAnalyticsLoadSchemaErrorLoggers})},t.EXExecuteActionCommandsEventName="PBI.EX.ExecuteActionCommands",t.EXExecuteActionCommands=r[t.EXExecuteActionCommandsEventName]=function(e){return i({name:t.EXExecuteActionCommandsEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXExecuteActionCommandsLoggers})},t.EXUndefinedTooltipStyleInActionBarEventName="PBI.EX.UndefinedTooltipStyleInActionBar",t.EXUndefinedTooltipStyleInActionBar=r[t.EXUndefinedTooltipStyleInActionBarEventName]=function(e){return i({name:t.EXUndefinedTooltipStyleInActionBarEventName,info:e,category:n.TelemetryCategory.CriticalError,loggers:t.EXUndefinedTooltipStyleInActionBarLoggers})},t.EXActionBarShownEventName="PBI.EX.ActionBarShown",t.EXActionBarShown=r[t.EXActionBarShownEventName]=function(e){return i({name:t.EXActionBarShownEventName,baseEvent:t.Verbose(e),info:e,category:n.TelemetryCategory.Verbose,loggers:t.EXActionBarShownLoggers})},t.EXScanModeKeyPressedEventName="PBI.EX.ScanModeKeyPressed",t.EXScanModeKeyPressed=r[t.EXScanModeKeyPressedEventName]=function(e){return i({name:t.EXScanModeKeyPressedEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXScanModeKeyPressedLoggers})},t.EXGetInsightsMenuCommandEventName="PBI.EX.GetInsightsMenuCommand",t.EXGetInsightsMenuCommand=r[t.EXGetInsightsMenuCommandEventName]=function(e){return i({name:t.EXGetInsightsMenuCommandEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.EXGetInsightsMenuCommandLoggers})},t.SparklinesDeleteEventName="PBI.Sparklines.Delete",t.SparklinesDelete=r[t.SparklinesDeleteEventName]=function(e){return i({name:t.SparklinesDeleteEventName,info:e,loggers:t.SparklinesDeleteLoggers})}})(n.telemetry||(n.telemetry={}))})(powerbi=powerbi||{}),(function(i){!(function(r){var n,a,o,t,s;function e(e){this.field=e,this.conditions=[],this.operators=[],this.logicalOperator=2,this.logicalAndOperator=0,this.logicalOrOperator=1}n=r.viewModels||(r.viewModels={}),a=i.data.Condition,o=i.data.OperatorHelper,t=i.data.RestatementHelper,s=i.data.SQExprUtils,e.prototype.toSQExpr=function(e){var t=this.field,i=t.getMetadata(e);if(i){i=i.type,e=s.hasMappedMParameter(t,e);return n.FilterCardConverter.toSQExpr(t,i,this.conditions,this.logicalOperator,e)}},e.prototype.getRestatement=function(e){return t.fromCondition(this.conditions,this.logicalOperator,e)},e.prototype.areConditionsValid=function(e,t){var i=this.conditions;if(_.isEmpty(i))return!1;for(var r=0,n=i.length;r<n;r++){var a=i[r];if(null!=a.operator&&0!==a.operator){if(!e||a.value&&a.value.hasValue){if(o.getValueRequired(a.operator)&&a.value&&!a.value.hasValue)return!1;if(t&&!this.isConditionValid(t,a))return!1}}else if(r<n-1)return!1}return!0},e.prototype.loadOperators=function(e,t,i){var r=this.field;_.isEmpty(r.validate(e,t))&&(e=r.getMetadata(e),this.operators=o.getFilterOperators(e.type,i))},e.prototype.ensureConditions=function(e,t){var i=this.operators,r=0;this.conditions||(this.conditions=[]),_.isEmpty(this.conditions)&&!_.isEmpty(i)&&this.conditions.push(new a(i[0].value));var n=2;for(e&&(r=t?1:2,n=t?2:1,e=!o.isOperatorForColumnMappedToMParameter(this.conditions[0].operator),t=1<this.conditions.length&&!t,(0===this.logicalOperator||e||t)&&(this.conditions=[new a(9)],this.logicalOperator=r));this.conditions.length<n;)this.conditions.push(a.empty()),this.logicalOperator=r},e.prototype.isConditionValid=function(e,t){if(!e)return!1;var i=this.field,e=r.FilterUtils.getValueType(i,e);return!!e&&n.FilterCardConverter.isConditionValid(i,e,t)},n.AdvFilterCard=e})(i.explore||(i.explore={}))})(powerbi=powerbi||{}),(function(E){var e;(function(t){var e,o=E.data.Condition,i=E.data.ConditionValue,r=E.data.SQAndExpr,n=E.data.SQBetweenExpr,a=E.data.SQCompareExpr,s=E.data.SQConstantExpr,l=E.data.SQContainsExpr,u=E.data.SQDateSpanExpr,c=E.data.SQExpr,p=E.data.SQExprBuilder,d=E.data.SQInExpr,h=E.data.SQNotExpr,g=E.data.SQOrExpr,v=E.data.SQStartsWithExpr,m=/[0-9]*\.?[0-9]+%/;(e=t.FilterCardConverter||(t.FilterCardConverter={})).createAdvFilter=function(e,t,i){return e.accept(new y(t,i))},e.toSQExpr=function(e,t,i,r,n){for(var a,o=new S(e,t,r=void 0===r?0:r,n=void 0===n?!1:n),s=0,l=i;s<l.length;s++){var u=l[s];null!=u.operator&&0!==u.operator&&(a=u.accept(o))}return a},e.isConditionValid=function(e,t,i){return t=new S(e,t,void 0),null!=i.accept(t)};var f,y=(f=E.data.DefaultSQExprVisitor,__extends(C,f),C.prototype.visitColumnRef=function(e){if(null==this.field||c.equals(this.field,e))return this.createFilterCard(e)},C.prototype.visitGroupRef=function(e){if(null==this.field||c.equals(this.field,e))return this.createFilterCard(e)},C.prototype.visitMeasureRef=function(e){return this.createFilterCard(e)},C.prototype.visitAggr=function(e){return this.createFilterCard(e)},C.prototype.visitArithmetic=function(e){return this.createFilterCard(e)},C.prototype.visitHierarchyLevel=function(e){return this.supportsCategorical=!1,this.createFilterCard(e)},C.prototype.visitEntity=function(e){return this.createFilterCard(e)},C.prototype.visitIn=function(e){if(!e.table&&e.args&&1===e.args.length){e.args[0].accept(this);var t=this.filter;if(null==t&&null!=this.field)return this.createFilterCard(this.field);for(var i=this.context,r=0,n=e.values;r<n.length;r++){var a=n[r];i.condition=new o(i.isNegative?10:9),a[0].accept(this),t.conditions.push(i.condition)}if(2===t.logicalOperator){e=i.isNegative?0:1;return t.logicalOperator=e,t}}},C.prototype.visitBetween=function(e){this.supportsCategorical=!1,e.arg.accept(this);var t=this.filter,i=this.context;if(i.condition=new o(i.isNegative?1:4),e.lower.accept(this)&&(t.conditions.push(i.condition),i.condition=new o(i.isNegative?3:2),e.upper.accept(this)&&(t.conditions.push(i.condition),2===t.logicalOperator)))return t.logicalOperator=0,t},C.prototype.visitAnd=function(e){this.supportsCategorical=!1;var t=this.context,i=t.isNegative?1:0;if(2===t.logicalOperator)t.logicalOperator=i;else if(t.logicalOperator!==i)return;if(e.left.accept(this)&&e.right.accept(this))return this.filter},C.prototype.visitOr=function(e){var t=this.context,i=t.isNegative?0:1;if(2===t.logicalOperator)t.logicalOperator=i;else if(t.logicalOperator!==i)return;if(e.left.accept(this)&&e.right.accept(this))return this.filter},C.prototype.visitCompare=function(e){var t=this.context,i=this.getFilterOperator(e,t.isNegative);if(void 0!==i&&0!==i){t.condition=new o(this.getFilterOperator(e,t.isNegative));i=t.allowNot;if(t.allowNot=!1,e.left.accept(this)&&e.right.accept(this)&&(e.right instanceof s||e.right instanceof u)){e=this.filter;return e.conditions.push(this.context.condition),1<e.conditions.length&&2===e.logicalOperator&&(e.logicalOperator=0),t.allowNot=i,t.condition=null,e}}},C.prototype.visitNot=function(e){var t=this.context,i=e.arg;if((i instanceof a||i instanceof d||i instanceof n||t.allowNot&&(i instanceof r||i instanceof g||i instanceof l||i instanceof v||i instanceof h))&&(t.isNegative=!t.isNegative,e.arg.accept(this)))return t.isNegative=!t.isNegative,this.filter},C.prototype.visitConstant=function(e){if(this.context.condition){var t=this.context.condition;return 0!==e.type.primitiveType&&(t.value=new i(e.value,this.formatter)),this.filter}},C.prototype.visitDateSpan=function(e){if(this.supportsCategorical=!1,5===e.unit){var t=this.context,i=t.allowNot;t.allowNot=!1;e=e.arg.accept(this);return t.allowNot=i,e}},C.prototype.visitContains=function(e){this.supportsCategorical=!1;var t=this.context;t.condition=new o(t.isNegative?6:5);var i=t.allowNot;if(t.allowNot=!1,e.left.accept(this)&&e.right.accept(this)){e=this.filter;return e.conditions.push(this.context.condition),t.allowNot=i,e}},C.prototype.visitStartsWith=function(e){this.supportsCategorical=!1;var t=this.context;t.condition=new o(t.isNegative?8:7);var i=t.allowNot;if(t.allowNot=!1,e.left.accept(this)&&e.right.accept(this)){e=this.filter;return e.conditions.push(this.context.condition),t.allowNot=i,e}},C.prototype.getFilterOperator=function(e,t){switch(this.supportsCategorical=this.supportsCategorical&&0===e.comparison,e.comparison){case 3:return t?4:1;case 4:return t?3:2;case 1:return t?2:3;case 2:return t?1:4;case 0:return E.data.SQExpr.isConstantNull(e.right)?t?12:11:E.data.SQExpr.isConstantText(e.right)&&""===e.right.value?t?14:13:t?10:9}},C.prototype.createFilterCard=function(e){return this.filter||(this.filter=new t.AdvFilterCard(e),this.filter.supportsCategorical=this.supportsCategorical,this.filter.logicalOperator=this.context.logicalOperator),this.filter},C);function C(e,t){var i=f.call(this)||this;return i.supportsCategorical=!0,i.context={isNegative:!1,allowNot:!0,logicalOperator:2},i.formatter=e,i.field=t,i}var S=(b.prototype.visit=function(e){e=this.expandExpr(e);return e&&(this.result?0===this.logicalOperator?this.result=p.and(this.result,e):1===this.logicalOperator&&(this.result=p.or(this.result,e)):this.result=e),this.result},b.prototype.expandExpr=function(e){var t,i=11!==e.operator&&12!==e.operator&&13!==e.operator&&14!==e.operator;if((t=i?this.getValueExpr(e):t)||!i)switch(e.operator){case 9:return p.compare(0,this.propertyExpr,t);case 10:return p.not(p.compare(0,this.propertyExpr,t));case 11:return p.compare(0,this.propertyExpr,p.nullConstant());case 12:return p.not(p.compare(0,this.propertyExpr,p.nullConstant()));case 5:return p.contains(this.propertyExpr,t);case 6:return p.not(p.contains(this.propertyExpr,t));case 7:return p.startsWith(this.propertyExpr,t);case 8:return p.not(p.startsWith(this.propertyExpr,t));case 3:return p.compare(1,this.propertyExpr,t);case 4:return p.compare(2,this.propertyExpr,t);case 1:return p.compare(3,this.propertyExpr,t);case 2:return p.compare(4,this.propertyExpr,t);case 13:return p.compare(0,this.propertyExpr,p.text(""));case 14:return p.not(p.compare(0,this.propertyExpr,p.text("")))}},b.prototype.getValueExpr=function(e){var t=this.dataType;if(e.value){var i=e.value.stringValue;if((t.integer||t.numeric)&&i){var r=E.formattingService.parseFloat(i);return isNaN(r)?void 0:(i.match(m)&&(r/=100),2===t.primitiveType?p.decimal(r):_.isInteger(r)?p.integer(r):p.double(r))}if(t.text&&i)return p.text(i);if(t.dateTime){e=e.value.dateValue;if(e)return this.isMappedToMParameter?p.dateTime(e):p.dateSpan(5,p.dateTime(e))}}},b);function b(e,t,i,r){void 0===r&&(r=!1),this.propertyExpr=e,this.dataType=t,this.logicalOperator=i,this.isMappedToMParameter=r}})((e=E.explore||(E.explore={})).viewModels||(e.viewModels={}))})(powerbi=powerbi||{}),(function(e){!(function(e){function t(e,t){this._contract=e,this._state=t}e=e.viewModels||(e.viewModels={}),Object.defineProperty(t.prototype,"contract",{get:function(){return this._contract},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"readOnlyState",{get:function(){return this._state},enumerable:!1,configurable:!0}),t.prototype.updateViewState=function(){this.updateViewStateCore(this._state)},t.prototype.updateViewStateCore=function(e){},e.ViewModel=t})(e.explore||(e.explore={}))})(powerbi=powerbi||{}),(function(V){var e,t,o,p,w,m,x,P,u,s,f,l;function r(){}e=V.explore||(V.explore={}),t=e.util||(e.util={}),o=V.explore.constants.ExploreCanvasConstants.CanvasGutterSize,p=V.visuals.ColorHelper,w=V.common.utils.ColorUtility,e=jsCommon.CssConstants.createClassAndSelector,m=jsCommon.CssConstants,x=V.data.DataViewObjectDefinitions,P=V.explore.constants.ExploreCanvasConstants,u=V.explore.services,s=V.explore.constants.ExploreCanvasConstants.MobileFooterHeight,f=V.visualHost.ResourcePackageReferenceResolver,l=V.explore.contracts.SectionAlignmentOption,r.setScrollWidth=function(e){this.scrollWidth=e},r.fitToWidth=function(e,t,i,r,n,a,o){void 0===a&&(a=!1),null!=e.canvasOptions.overrideSectionAlignment&&(o=e.canvasOptions.overrideSectionAlignment);var s=t.get(0).getBoundingClientRect(),l=this.findParentElement(t,this.ExploreCanvasSelector).get(0).getBoundingClientRect(),u=t.find(".displayAreaViewport").get(0).getBoundingClientRect();s.width>u.width&&(v=s.width-u.width,null!=this.scrollWidth&&.01<Math.abs(this.scrollWidth-v)&&jsCommon.Trace.error("Multiple scroll bar widths detected, "+this.scrollWidth+" -> "+v),this.scrollWidth=v);var c=n.getConfig(),p=2*P.CanvasGutterSize,d=s.width-p,h=s.height-p,g=this.getFitToWidthScaledSize(e,d,r),v=t.find(this.DisplayAreaNameSelector.selector),n=1===e.viewModel.canvasLayout;g.height<=h&&!n?(e.canvasViewStyle=2,t.css(m.overflowXProperty,m.hiddenValue).css(m.overflowYProperty,m.hiddenValue),this.positionElement(v,u,g,o,!0,c.displayOptions.forceCenteredVerticalAlignment)):(p=c.displayOptions.scaleBackgroundImageToWidth?P.CanvasGutterSize/2+(this.scrollWidth||0):3*P.CanvasGutterSize/2+(this.scrollWidth||8),d=s.width-p,g=this.getFitToWidthScaledSize(e,d,r),e.canvasViewStyle=1,t.css(m.overflowXProperty,m.hiddenValue).css(m.overflowYProperty,m.scrollValue),this.clearElementPosition(v));d/=e.viewModel.width,l=this.getWallpaperScale(l,e.viewModel.width,e.viewModel.height,e.canvasOptions.scrollbarOffset,0);i.setDisplayAreaScaleFactor(d),i.setWallpaperScaleFactor(l),this.updateCanvasSize(e,g.width,g.height),v.attr("class",this.DisplayAreaNameSelector.class+" "+this.convertDisplayOptionToStyle(e)),this.setElementSize(v,g),a||c.displayOptions.preserveScrollPositionOnResize||(g=!1,(a=e.fitToWidthScrollPosition)&&((c=e.viewModel&&e.viewModel.contract)&&c.name===a.sectionName&&c.size&&c.size.width===a.sectionSize.width&&c.size.height===a.sectionSize.height&&(g=!0,t.scrollTop(a.relativeScroll*d)),g||(e.fitToWidthScrollPosition=void 0)),g||t.scrollTop(0),t.scrollLeft(0))},r.getWallpaperScale=function(e,t,i,r,n,a,o){if(0===n)return(e.width-r)/t;t=i;return(t=a&&o?a.getConfig().displayOptions.hideTileMenu?e.height:e.height-o:t)/i},r.getFitToWidthScaledSize=function(e,t,i){var r=t/e.viewModel.width,n=t,a=e.viewModel.height*r+i;return e.adjustScaleForLayout&&((t=e.adjustScaleForLayout({x:r,y:r})).x===r&&t.y===r||(n*=t=(e=Math.min(t.x,t.y))/r,a=(a-i)*t+i,r=e)),{width:n,height:a}},r.fitToPage=function(e,t,i,r,n,a){null!=e.canvasOptions.overrideSectionAlignment&&(a=e.canvasOptions.overrideSectionAlignment);var o=this.findParentElement(t,this.ExploreCanvasSelector).get(0).getBoundingClientRect(),s=e.outerViewport.width/e.viewModel.width,l=this.getFitToPageScaleY(e,r,n),l=Math.min(s,l),s=this.getWallpaperScale(o,e.viewModel.width,e.viewModel.height,e.canvasOptions.scrollbarOffset,l===s?0:1,r,n);e.adjustScaleForLayout&&((r=e.adjustScaleForLayout({x:l,y:l})).x===l&&r.y===l||(l=Math.min(r.x,r.y))),i.setDisplayAreaScaleFactor(l),i.setWallpaperScaleFactor(s),t.scrollTop(0).scrollLeft(0);s=e.viewModel.width*l,n=e.viewModel.height*l+n;e.canvasViewStyle=0,e.canvasViewStyle|=4,t.css(m.overflowXProperty,m.hiddenValue).css(m.overflowYProperty,m.hiddenValue),this.updateCanvasSize(e,s,n);t=t.find(this.DisplayAreaNameSelector.selector);t.attr("class",this.DisplayAreaNameSelector.class+" "+this.convertDisplayOptionToStyle(e));n={width:s,height:n};this.setElementSize(t,n),this.positionElement(t,e.outerViewport,n,a,!1)},r.getFitToPageScaleY=function(e,t,i){i=t.getConfig().displayOptions.hideTileMenu?e.outerViewport.height:e.outerViewport.height-i;return(i-=this.getCanvasOutlineSize(e,t))/e.viewModel.height},r.findParentElement=function(e,t){if(e)return e.hasClass(t.class)?e:this.findParentElement(e.parent(),t)},r.getVerticalAlignmentSetting=function(e,t,i){e=e.viewModel&&e.viewModel.contract&&e.viewModel.contract.evaluatedObjects&&e.viewModel.contract.evaluatedObjects.displayArea&&e.viewModel.contract.evaluatedObjects.displayArea.verticalAlignment&&e.viewModel.contract.evaluatedObjects.displayArea.verticalAlignment.toString();if(e)return l[e];i=i.getCurrentExploration(),i=i&&i.evaluatedObjects&&i.evaluatedObjects.section&&i.evaluatedObjects.section.verticalAlignment&&i.evaluatedObjects.section.verticalAlignment.toString();return i?l[i]:void 0},r.positionElement=function(e,t,i,r,n,a){a=null!=t.height&&null!=i.height?(t.height-(a?s:0)-i.height)/2:void 0,i=null!=t.width&&null!=i.width?(t.width-i.width)/2:void 0,i={position:"absolute",left:null!=i?i+"px":""};r===l.Top?_.extend(i,{top:null!=a?(n?o:0)+"px":""}):(l.Middle,_.extend(i,{top:null!=a?a+"px":""})),e.css(i)},r.setElementSize=function(e,t){e.css({height:t.height+"px",width:t.width+"px"})},r.clearElementPosition=function(e){e.css({position:"",top:"",left:""})},r.clearElementSize=function(e){e.css({height:"",width:""})},r.fitToScreen=function(e,t,i,r){var n=t.find(this.DisplayAreaNameSelector.selector);this.clearElementPosition(n),this.clearElementSize(n),e.canvasViewStyle=8,i.setDisplayAreaScaleFactor(1),i.setWallpaperScaleFactor(1),this.updateCanvasSize(e,e.outerViewport.width,e.outerViewport.height),t.css(m.overflowXProperty,m.hiddenValue).css(m.overflowYProperty,m.hiddenValue),n.attr("class",this.DisplayAreaNameSelector.class+" "+this.convertDisplayOptionToStyle(e))},r.getCanvasActualSize=function(e,t,i){i=r.getAutoLayoutVisualVCHeader(t,i),e=e.size;return{height:e.height+i,width:e.width}},r.displayInActualSize=function(e,t,i,r,n,a,o){void 0===o&&(o=1),null!=e.canvasOptions.overrideSectionAlignment&&(a=e.canvasOptions.overrideSectionAlignment);var s=t.find(this.DisplayAreaNameSelector.selector),l=e.isCanvasBackdropVisible();e.canvasViewStyle=0;var u=e.viewModel.width*o,c=e.viewModel.height*o+n,n={width:l?P.PhoneAuthoringViewportWidth:u,height:l?P.PhoneAuthoringViewportHeight:c};n.width>e.outerViewport.width?(e.canvasViewStyle|=512,t.css(m.overflowXProperty,m.autoValue)):(e.canvasViewStyle|=256,t.css(m.overflowXProperty,m.hiddenValue)),n.height>e.outerViewport.height?(e.canvasViewStyle|=128,t.css(m.overflowYProperty,m.autoValue)):(e.canvasViewStyle|=64,t.css(m.overflowYProperty,m.hiddenValue));t=e.canvasViewStyle;this.positionElement(s,e.outerViewport,{width:256&t?n.width:void 0,height:64&t?n.height:void 0},a,!0),e.canvasViewStyle|=256&t&&64&t?32:16,this.setElementSize(s,n),r.setDisplayAreaScaleFactor(o),r.setWallpaperScaleFactor(o),this.updateCanvasSize(e,u,c);e=this.convertDisplayOptionToStyle(e);s.attr("class",this.DisplayAreaNameSelector.class+" "+e),l&&i.attr("class",this.CanvasBackdropSelector.class+" "+e)},r.displayInActualSizeTopLeft=function(e,t,i,r){var n=t.find(this.DisplayAreaNameSelector.selector);e.canvasViewStyle=0,e.canvasViewStyle|=512,e.canvasViewStyle|=128,e.canvasViewStyle|=16,e.viewModel.width>=e.outerViewport.width?t.css(m.overflowXProperty,m.autoValue):t.css(m.overflowXProperty,m.hiddenValue),e.viewModel.height>=e.outerViewport.height?t.css(m.overflowYProperty,m.autoValue):t.css(m.overflowYProperty,m.hiddenValue),i.setDisplayAreaScaleFactor(1),i.setWallpaperScaleFactor(1);i=e.viewModel.width,r=e.viewModel.height+r;n.css({width:i+"px",height:r+"px"}),this.updateCanvasSize(e,i,r),n.attr("class",this.DisplayAreaNameSelector.class+" "+this.convertDisplayOptionToStyle(e))},r.updateCanvasSize=function(e,t,i){i={width:t,height:i};0<i.width&&0<i.height&&(e.size=i)},r.updateAndApplyBackground=function(e,t,i,r,n,a,o,s,l,u,c,p,d){var h,g,v,m,f,y,C=u.getConfig(),S=C.displayOptions.hideOutspaceFormatting,b=1===u.getMode()&&!t.isCanvasBackdropVisible(),E=!!d.get();switch(e){case 1:v=t.outspace=t.outspace||{},g="outspace",h=t.outspaceBackground,m=P.getDefaultCanvasOutspace(),f=l.getCurrentLayoutCapabilities().canShowCanvasOutspace();break;case 2:v=t.background=t.background||{},g="background",h=t.canvasBackground,m=P.getDefaultCanvasBackground(),f=l.getCurrentLayoutCapabilities().canShowCanvasBackground()}f?(y=r&&r[g],E?(v.color=P.DefaultCanvasBackgroundColor,v.transparency=0,v.image=null):y?(v.color=V.DataViewObject.getFillColorByPropertyName(y,"color",P.DefaultCanvasBackgroundColor),v.transparency=V.DataViewObject.getValue(y,"transparency",P.DefaultCanvasBackgroundTransparency),v.image=y.image):this.setDefaultBackgroundProperties(v,m),d=v.image,r=t.viewModel.contract.objects,(r=(y=x.getObjectDefinition(r,g,null))&&y.properties.image)&&V.data.SQExpr.isResourcePackageItem(r.url)?this.setImageFromPackage(t,h,v,d,r.url,y,a,o,s,p,b,c,S,e,E):this.setImage(h,v,d,d?d.url:"",E,p,b,c,S,e)):(this.setDefaultBackgroundProperties(v,m),this.setImage(h,m,null,"",E,p,b,c,S,e)),2===e&&(u&&C.displayOptions.extendBackgroundToWholeCanvas?i.css({"background-color":w.hexToRGBString(v.color,(100-v.transparency)/100)}):i.css({"background-color":""}))},r.setDefaultBackgroundProperties=function(e,t){e.color=t.color,e.image=t.image,e.transparency=t.transparency},r.setImage=function(e,t,i,r,n,a,o,s,l,u){void 0===l&&(l=!1),void 0===u&&(u=null);var c=i&&i.scaling,n=n?1:(100-t.transparency)/100;e.imageFitClass=c,e.imageSource=i&&r,e.imageStyle=c===V.visuals.imageScalingType.normal?{transform:"scale("+a.getWallpaperScaleFactor()+")"}:{},e.backgroundStyle||(e.backgroundStyle={}),e.backgroundStyle.opacity=n,e.backgroundStyle["background-color"]=l&&1===u?"transparent":w.hexToRGBString(t.color),2===u&&(s=p.getThemeColor(s,"foregroundNeutralSecondary"),e.displayAreaStyle||(e.displayAreaStyle={}),e.displayAreaStyle["box-shadow"]=l?"0 0 0":"0 0 10px rgba(200,200,200,"+n+")",e.displayAreaStyle.outline=o&&n<=.5?"2px dotted "+s:"none",e.imageStyle=c===V.visuals.imageScalingType.normal?{transform:"scale("+a.getDisplayAreaScaleFactor()+")"}:{})},r.setImageFromPackage=function(i,r,n,a,o,s,e,t,l,u,c,p,d,h,g){var v=this;void 0===d&&(d=!1);var m,t=t.getCurrentExploration();t&&(m=i.viewModel.contract,f.loadAndResolveFromSQExpr(o,t.resourcePackages,e,l).then((function(e){var t=s.properties.image;m===i.viewModel.contract&&t&&V.data.SQExpr.equals(t.url,o)&&v.setImage(r,n,a,e.value||"",g,u,c,p,d,h)})))},r.setDisplayAreaBackground=function(e,t,i){t&&t.outspace?e.canvasBackground.displayAreaStyle&&delete e.canvasBackground.displayAreaStyle["background-color"]:(e.canvasBackground.displayAreaStyle||(e.canvasBackground.displayAreaStyle={}),i=p.getThemeColor(i,"background"),e.canvasBackground.displayAreaStyle["background-color"]=i)},r.convertDisplayOptionToStyle=function(e){var t="";return e.useResponsiveLayout&&(t+=" responsive"),e.disableAnimations&&(t+=" disableAnimations"),8==(8&e.canvasViewStyle)&&(t+=" fitToScreen"),4==(4&e.canvasViewStyle)&&(t+=" fitToPage"),1==(1&e.canvasViewStyle)&&(t+=" fitToWidthOrigin"),2==(2&e.canvasViewStyle)&&(t+=" fitToWidthCentered"),256==(256&e.canvasViewStyle)&&(t+=" actualSizeAlignCenter"),512==(512&e.canvasViewStyle)&&(t+=" actualSizeAlignLeft"),64==(64&e.canvasViewStyle)&&(t+=" actualSizeAlignMiddle"),128==(128&e.canvasViewStyle)&&(t+=" actualSizeAlignTop"),32==(32&e.canvasViewStyle)&&(t+=" actualSizeCentered"),16==(16&e.canvasViewStyle)&&(t+=" actualSizeOrigin"),t.trim()},r.getAutoLayoutVisualVCHeader=function(e,t){return t&&t.getCapabilities().visualContainerOptions.useStylableHeader||e&&e.getCurrentLayoutCapabilities().canShowVisualContainerHeaderInset()?0:P.AutoLayoutVisualVCHeader},r.getCanvasOutlineSize=function(e,t){if(1===t.getMode()){e=e.background&&e.background.transparency;if(e&&e>=P.DisplayAreaTransparencyOutlineThreshold)return P.DisplayAreaOutlineSize}return 0},r.applyFitOption=function(e,t,i,r,n,a){if(e.viewModel&&e.viewModel.contract){var o=t.find(this.DisplayAreaContainerNameSelector.selector),s=this.findParentElement(t,this.ExploreCanvasSelector).find(this.CanvasBackdropSelector.selector),t=i.canvasScale.getDisplayOption();2!==t&&(e.fitToWidthScrollPosition=void 0);var l=this.getAutoLayoutVisualVCHeader(i.formFactor,i.explorationCapabilities);switch(t){case 2:this.fitToWidth(e,o,i.canvasScale,l,i.viewModeState,a,r);break;case 1:this.fitToPage(e,o,i.canvasScale,i.viewModeState,l,r);break;case 3:this.displayInActualSize(e,o,s,i.canvasScale,l,r,n);break;case 4:this.displayInActualSizeTopLeft(e,o,i.canvasScale,l);break;default:this.fitToScreen(e,o,i.canvasScale,l)}i.eventBridge.publishToChannel(u.events.CanvasResized)}},r.storeOverflowValuesAndChange=function(e,t){this.currentOverflowXCSSValue=e.css(m.overflowXProperty),this.currentOverflowYCSSValue=e.css(m.overflowYProperty),e.css(m.overflowXProperty,t),e.css(m.overflowYProperty,t)},r.restoreOverflowValues=function(e){e.css(m.overflowXProperty,this.currentOverflowXCSSValue),e.css(m.overflowYProperty,this.currentOverflowYCSSValue)},r.visualPositionToRect=function(e){return{left:e.x,top:e.y,width:e.width,height:e.height}},r.rectToVisualPosition=function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},r.isCortanaPageSize=function(e){return!1},r.DisplayAreaNameSelector=e("displayArea"),r.DisplayAreaContainerNameSelector=e("displayAreaContainer"),r.VisualContainerHostSelector=e("visualContainerHost"),r.OutspaceContainerSelector=e("outspaceContainer"),r.OutspaceImageSelector=e("outspaceImage"),r.VisualBackgroundContainerSelector=e("visualBackgroundContainer"),r.VisualBackgroundImageSelector=e("visualBackgroundImage"),r.DefaultVisualPosition={x:100,y:100,width:300,height:300},r.CanvasBackdropSelector=e("canvasBackdrop"),r.ExploreCanvasSelector=e("exploreCanvas"),r.currentOverflowXCSSValue="",r.currentOverflowYCSSValue="",e=r,t.CanvasDisplayUtility=e})(powerbi=powerbi||{}),(function(A){var T,o,i,D,s,l,t,n,u,a,c,I;function r(e,i){for(var t={},r=0,n=i;r<n.length;r++){var a=n[r];t[a.name]=!0}var o=[];T.viewModels.traverseVisualContainerGroups(e,(function(e){t[e.name]&&o.push(e)}));function s(t){return _.findIndex(i,(function(e){return e.name===t.name}))}return o.sort((function(e,t){return s(e)-s(t)})),o}function p(e,t){void 0===t&&(t=!1);for(var i=e.parentGroup,r=e;i;){if(i.isSelected||i.isChildSelected){t&&i.isSelected&&(r=i);break}i=(r=i).parentGroup}return r}function d(e,t){var i=e.filter;if((e.type===n.Include||e.type===n.Exclude)&&i){var r=i.rewrite(t);if(r!==i)return A.Prototype.inherit(e,(function(e){return e.filter=r}))}return e}function h(e,t,i){if(!_.isEmpty(e)){for(var r=t&&[],n=0,a=e;n<a.length;n++){var o=a[n].canvasItem;o&&(t&&T.contracts.isVisualContainerGroup(o)?r.push(o):i(o))}t&&!_.isEmpty(r)&&T.contracts.traverseVisualContainerGroups(r,(function(e){return i(e)}))}}function g(e,a,o,t,i,r,n,s,l,u){if(e){var c={},p=!!n,d=o.size,h=u?o.visualContainerGroups:o.visualContainers,g=_.flatMap(a.sections,(function(e){return u?e.visualContainerGroups:e.visualContainers})),v=[],m=i.getCurrentLayout();T.contracts.traverseVisualContainerGroups(h,(function(e){null==e.parentGroup&&(e=e.layouts.withId(m).position,v.push(e))})),T.contracts.traverseVisualContainerGroups(g,(function(e){c[e.name]=!0}));t=t.deserializeCanvasItems(e,!0,u,(function(){var e=I.nextUniqueName(c);return c[e],c[e]=!0,e}));if(t){var e=t.visualContainerGroups,t=t.visualContainers,f=M(h,m),y=O(o.visualContainers,m),C=D.createWithId(),S=[],b=function(e){var t,i=null!=e.parentGroup,r=e.layouts.withId(m),n=r.position;if(u||T.contracts.isVisualContainer(e),i&&u||(n.z=f++,S.push(e)),null!=n.tabOrder&&T.contracts.isVisualContainer(e)&&(t=0<=n.tabOrder,n.tabOrder=t?y.pos++:y.neg--),!i){for(;2!==(function(e,t){var i=t.width||0,r=t.height||0,t=0;e.x+e.width>i&&(e.x=Math.max(i-e.width,0),t++);e.y+e.height>r&&(e.y=Math.max(r-e.height,0),t++);return t})(n,d)&&(function(t,e){return _.some(e,(function(e){return t.x===e.x&&t.y===e.y}))})(n,v);)n.x+=10,n.y+=10;v.push(n)}e.layouts=D.extendWithId([r]),p&&T.contracts.isVisualContainer(e)&&(e=T.viewModels.ViewModelFactory.convertVisualContainer(a,o,e,m),C.push(e))};if(u)T.contracts.traverseVisualContainerGroups(e,b);else for(var E=0,V=t;E<V.length;E++){var w=V[E];b(w)}if((h=o.visualContainers).push.apply(h,t||[]),p&&(h=n.visualContainers).push.apply(h,C||[]),u?(o.visualContainerGroups=A.ItemGroupingManager.add.apply(A.ItemGroupingManager,__spreadArray([o.visualContainerGroups],e||[])),p&&(e=T.viewModels.ViewModelFactory.convertVisualContainerGroups(e,C,m),n.visualContainerGroups=A.ItemGroupingManager.add.apply(A.ItemGroupingManager,__spreadArray([n.visualContainerGroups],e||[])))):(o.visualContainerGroups=A.ItemGroupingManager.add.apply(A.ItemGroupingManager,__spreadArray([o.visualContainerGroups],t||[])),p&&(n.visualContainerGroups=A.ItemGroupingManager.add.apply(A.ItemGroupingManager,__spreadArray([n.visualContainerGroups],C||[])))),r.publishVisualContainerAddedEvent(),s&&T.services.selectionUtils.selectCanvasItems(S,s,!0),l)for(var x=0,P=S;x<P.length;x++){var F=P[x];T.contracts.isVisualContainer(F)&&l.applyFilterOutput(F)}return S}}}function M(e,t){return _.isEmpty(e)?0:_.chain(e).map((function(e){e=e.layouts.withId(t),e=e&&e.position;return e&&e.z||0})).max().value()+1}function O(e,t){var i=0,r=0;if(_.isEmpty(e))return{pos:i,neg:r};for(var n=0,a=e;n<a.length;n++){var o=a[n].layouts.withId(t),o=o&&o.position,o=o&&null!=o.tabOrder?o.tabOrder:void 0;null!=o&&(i=Math.max(i,o),r=Math.min(r,o))}return{pos:i+1,neg:r-1}}function f(e,t){t=e.layouts.withId(t);return t&&t.position}T=A.explore||(A.explore={}),o=T.util||(T.util={}),D=jsCommon.ArrayExtensions,s=A.data.DataViewObjectDefinitions,l=A.data.DataViewTransform,t=A.explore.constants.ExploreCanvasConstants,n=A.explore.contracts.FilterType,u=A.explore.services.selectionUtils,a=A.data.SQExpr,c=A.explore.services.StaticResourceReferences,I=A.explore.util.VisualContainerUtils,(i=o.CanvasVisualsUtility||(o.CanvasVisualsUtility={})).objectIsHidden=function(e,t,i){var r=i&&i[e],i=A.explore.viewModels.PropertySliceNames.Show;return r?r.hasOwnProperty(i)&&!r[i]:void 0!==(i=s.getValue(t,{objectName:e,propertyName:i},null))&&a.isConstant(i)&&!i.value},i.getSelectedCanvasItemViewModels=function(e,t){return t=u.getSelectedCanvasItems(t),r(e.visualContainerGroups,t)},i.findVisualContainerViewModel=function(e,t){for(var i=0,r=e;i<r.length;i++){var n=r[i];if(n.contract===t)return n}},i.findCanvasItemViewModels=r,i.syncCanvasItemViewModelsWithContracts=function e(t,i){t.length,i.length;for(var r=0,n=t;r<n.length;r++){var a=n[r],o=A.ItemGroupingManager.find(a.name,i);o&&T.viewModels.isVisualContainerGroup(a)&&T.contracts.isVisualContainerGroup(o)&&(a.contract!==o&&(a.contract.name,o.name,a.contract=o),e(a.children,o.children))}},i.addOffsetFromGroup=function(e,t){if(t.parentGroup)for(var i=t.parentGroup;i;){var r=i.position;e.left+=r.x,e.top+=r.y,i=i.parentGroup}return e},i.getContainerGroupDepth=function(e){var t=0;if(_.isEmpty(e))return t;if(e[0].parentGroup)for(var i=e[0].parentGroup;i;)t++,i=i.parentGroup;return (function e(t,i){i++;var r=i;for(var n=0,a=t;n<a.length;n++){var o=a[n];T.contracts.isVisualContainerGroup(o)&&(r=Math.max(e(o.children,i),r))}return r})(e,t)},i.toggleSelectContainer=function(e,t,i,r,n){r.hideAllDropdowns(),o.EventBubblingUtility.markAsHandled(e);var a=jsCommon.BrowserUtils.isCtrlOrMeta(e),r=u.isCanvasItemSelected(t.contract,i);if(a&&r&&1<u.getSelectedCanvasItems(i).length)u.unselectCanvasItem(t.contract,i);else{if(!n){var r=p(t);return r.parentGroup&&r.parentGroup.isSelected&&u.unselectCanvasItem(r.parentGroup.contract,i),u.selectCanvasItem(r.contract,i,jsCommon.SelectionUtility.getMultiSelectMode(e)),void(null!==(n=e.currentTarget,r=r.contract.name,r=$(n).parents('[name="'+r+'"]:first')[0])&&void 0!==r&&r.focus())}u.selectCanvasItem(t.contract,i,jsCommon.SelectionUtility.getMultiSelectMode(e))}},i.setHoverForParentGroup=function(e,t,i){if(e.parentGroup)if(t){var r=p(e);r!==e&&I.notifyContainerHoverEvent(t,r.name,i)}else for(var n=e.parentGroup;n;)I.notifyContainerHoverEvent(t,n.name,i),n=n.parentGroup},i.getContainerToSelect=p,i.selectIfNotSelected=function(e,t){u.isCanvasItemSelected(e,t)||u.selectCanvasItem(e,t)},i.serializeSelection=function(t,e,i,r){void 0===r&&(r=!0);var n=[];return h(e.getSelectedElements(),r,(function(e){T.contracts.isVisualContainerGroup(e)?n.push(t.serializeVisualContainerGroup(e)):(e=(function(e,t){if(!e.filters)return e;t=new o.VariationToHierarchyRewriter(t);return (function(e,t){var i=D.rewriteArray(e.filters,(function(e){return d(e,t)}));return i===e.filters?e:A.Prototype.inherit(e,(function(e){return e.filters=i}))})(e,t)})(e,i),n.push(t.serializeVisualContainer(e)))})),n},i.evaluateObjects=function(e,t,i,r,n,a){var o=e.objects;(i=n.getVisualObjects(r,i,void 0,t))&&(o=s.clone(o||{}),s.extend(o,i)),r=n.getVisualStyle(r),a=l.evaluateMetadataOnceDataViewObjectDefinitions(o,t,r,a.featureSwitches),e.evaluatedObjects=a.dataViewObjects},i.evaluateSectionObject=function(e,t,i,r,n,a,o){if(e=s.clone(e.objects||{}),r=n.getVisualObjects(r,A.explore.constants.SectionComponentType,void 0,((r={})[t]=i,r)),s.extend(e,r),e&&e[t]){e=s.getObjectDefinition(e,t,o);if(e){o=A.data.createEmptyEvalContext();return A.data.createDataViewObjectEvaluator(a.featureSwitches,A.visuals.visualStyles.create()).run(t,o,i,e.properties)}}},i.rewriteFilterContainer=d,i.getSelectionResources=function(e,t,i){void 0===i&&(i=!0);var r={};return h(e=e.getSelectedElements(),i,(function(e){e=e,T.contracts.isVisualContainer(e)&&(e=e.config.singleVisual.objects,c.addObjectsReferences(e,void 0,t,r))})),r},i.checkBoundaryForCharts=function(e,t,i){return 0<(i=(e=Math.max(0,e-t/2))+t-i)&&(e-=i),e},i.duplicateCanvasItem=function(e,t,i,r,n,a,o,s,l,u){return _.first(g([e],t,i,r,n,a,o,s,l,u))},i.duplicateCanvasItems=g,i.addVisualContainerToCanvas=function(i,r,n,a,o,s){var l;return __awaiter(this,void 0,A.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return i.expr?[3,1]:(t=o.addEmptyVisualContainer(r,n,i.visualType,i.position,i.shouldSummarize),[3,3]);case 1:return[4,o.addVisualContainer({expr:i.expr,visualType:i.visualType,targetRole:i.targetRole,dataSources:a,allowAggregate:null===(l=i.allowAggregate)||void 0===l||l,shouldSummarize:i.shouldSummarize},r,n)];case 2:t=e.sent(),e.label=3;case 3:return s.logEvent(A.telemetry.EXCreateVisual,{source:(function(e){switch(e){case 0:return"CheckboxTickedInFieldList";case 3:return"DraggedToFieldWell";case 1:return"DraggedToCanvas";case 2:return"VisualTypeIconClicked";case 4:return"InsertVisualButton";case 5:return"WhatIfParameterControl";case 8:return"QnaAppBar";case 6:return"QnaDoubleClick";case 7:return"QnaKeyboardShortcut";case 9:return"FieldParameterControl";case 10:return"CanvasBackgroundContextMenu"}})(i.telemetrySource),visualType:I.getVisualType(t),visualName:t.name}),[2,t]}}))}))},i.convertToScaledPosition=function(e,t,i){var r,n,a={x:e.x*t.x,y:e.y*t.y,z:e.z,width:e.width*t.x,height:e.height*t.y,angle:e.angle,tabOrder:e.tabOrder};return!0===i&&(r=Math.round(a.x),n=Math.round(a.y),t=Math.round(a.x+a.width),i=Math.round(a.y+a.height),a={x:r,y:n,z:a.z,width:t-r,height:i-n,angle:e.angle,tabOrder:e.tabOrder}),a},i.convertFromScaledPosition=function(e,t){return{x:e.x/t.x,y:e.y/t.y,z:e.z,width:e.width/t.x,height:e.height/t.y,angle:e.angle,tabOrder:e.tabOrder}},i.convertToScaledRect=function(e,t){return{left:e.left*t.x,top:e.top*t.y,width:e.width*t.x,height:e.height*t.y}},i.convertFromScaledRect=function(e,t){return{left:e.left/t.x,top:e.top/t.y,width:e.width/t.x,height:e.height/t.y}},i.getZIndexForNewCanvasItem=M,i.getNextTabOrders=O,i.getTabOrderForNewVisual=function(e,t,i){if(!e||_.isEmpty(e.visualContainers))return 0;var r=t?A.explore.services.CanvasListOrderingConstants.posMinOrder:A.explore.services.CanvasListOrderingConstants.negMinOrder;return _.forEach(e.visualContainers,(function(e){e=e.layouts.withId(i),e=e&&e.position;e&&e.tabOrder&&(e=e.tabOrder,r=t?Math.max(r,e):Math.min(r,e))})),r+(t?1:-1)},i.getDragRestrictElementRect=function(e,t,i){for(var r=0,n=0,a=0,o=0,s=null,l=0,u=0,c=i.length;u<c;u++){l=u;if((p=i[u])===e){d=(d=p.parentGroup)&&d.layouts.withId(t)?d:void 0,s=I.getAbsoluteVisualContainerPosition(f(p,t),t,d);break}}if(s){i.splice(l,1);for(var p,d,h=0,g=i;h<g.length;h++){d=(d=(p=g[h]).parentGroup)&&d.layouts.withId(t)?d:void 0;var v=I.getAbsoluteVisualContainerPosition(f(p,t),t,d),m=s.x-v.x,r=r<m?m:r,n=n<(m=v.y+v.height-(s.y+s.height))?m:n,a=a<(m=s.y-v.y)?m:a,o=o<(m=v.x+v.width-(s.x+s.width))?m:o}return{top:0-(0<a?a/s.height:0),left:0-(0<r?r/s.width:0),bottom:1+(0<n?n/s.height:0),right:1+(0<o?o/s.width:0)}}},i.getPosition=f,i.getCanvasItemsByLevel=function(e){for(var t={},i=0,r=u.getSelectedCanvasItems(e);i<r.length;i++){var n=r[i],a=n.parentGroup?n.parentGroup.name:"root";t[a]=t[a]||[],t[a].push(n)}return t},i.filterContractsByTabOrderSign=function(e,t){return _.filter(e,(function(e){e=i.getPosition(e,0).tabOrder;return t?void 0===e||0<=e:e&&e<0}))},i.getOutspacePaneWidth=function(e){return(e=e.getCurrentSection())&&e.evaluatedObjects&&e.evaluatedObjects.outspacePane&&e.evaluatedObjects.outspacePane.width||t.DefaultOutspacePaneWidth}})(powerbi=powerbi||{}),(function(n){var e,a,o;function s(e){e=e.solid.color;return jsCommon.Color.isHexString(e.value)?{solid:{color:e.value}}:null}function t(e,t){var i,r;return{minValue:i=void 0!==e.minValue?u(e.minValue,t):i,maxValue:r=void 0!==e.maxValue?u(e.maxValue,t):r,positiveColor:n.fillDefinitionHelpers.createSolidFillDefinition(e.positiveColor&&e.positiveColor.solid.color,"maxColor"),negativeColor:n.fillDefinitionHelpers.createSolidFillDefinition(e.negativeColor&&e.negativeColor.solid.color,"minColor"),axisColor:n.fillDefinitionHelpers.createSolidFillDefinition(e.axisColor&&e.axisColor.solid.color,"foreground"),reverseDirection:o.boolean(e.reverseDirection),hideText:o.boolean(e.hideText)}}function l(e,t){return n.VisualObjectRepetition.getDefinition(e,t)}function u(e,t){if(t.integer||t.numeric,t.integer){var i=Math.round(e);return o.integer(i)}return 2===t.primitiveType?o.decimal(e):(t.extendedType,o.double(e))}e=(e=n.explore||(n.explore={})).util||(e.util={}),o=n.data.SQExprBuilder,(a=e.DataBarsUtil||(e.DataBarsUtil={})).DefaultDataBarsSettings={reverseDirection:!1,hideText:!1},a.getDataBarsSettings=function(e,t){var i,r;return(e=l(e.objects,t))?((t=e.minValue)&&(i=t.value),t=e.maxValue,{minValue:i,maxValue:r=t?t.value:r,positiveColor:s(e.positiveColor),negativeColor:s(e.negativeColor),axisColor:s(e.axisColor),reverseDirection:e.reverseDirection.value,hideText:e.hideText.value}):a.DefaultDataBarsSettings},a.createDefaultDataBarsDefinition=function(){return t(a.DefaultDataBarsSettings,n.ValueType.fromPrimitiveTypeAndCategory(12))},a.createDataBarsDefinition=t,a.getDefinition=l,a.isDataBarsApplied=function(e,t){return void 0!==l(e,t)}})(powerbi=powerbi||{}),(function(e){var t;function i(e){return e in t?t[e]:0}e=(e=(e=e.explore||(e.explore={})).util||(e.util={})).ErrorDetailsUtility||(e.ErrorDetailsUtility={}),t={BlockedCustomVisual:1,ScriptVisualsNotEnabled:1,UnapprovedCustomVisual:1,CvApiVersionNotSupported:1},e.hasAdditionalErrorInfo=function(e){return!!e&&(e=e.displayableErrorInfo,!_.isEmpty(e)&&(!_.isEmpty(e[0].errorInfoKey)&&!_.isEmpty(e[0].errorInfoValue)))},e.getErrorOverlayType=i,e.shouldHideSeeDetails=function(e){return 1===i(e)}})(powerbi=powerbi||{}),(function(e){(e=(e=(e=e.explore||(e.explore={})).util||(e.util={})).EventBubblingUtility||(e.EventBubblingUtility={})).handled=function(e){var t;if(e){e=(null!==(t=e.originalEvent)&&void 0!==t?t:e).handled;return void 0!==e&&!0===e}},e.markAsHandled=function(e){var t;e&&((null!==(t=e.originalEvent)&&void 0!==t?t:e).handled=!0)}})(powerbi=powerbi||{}),(function(e){(e=(e=(e=e.explore||(e.explore={})).util||(e.util={})).ExplorationTrustedVisualUtil||(e.ExplorationTrustedVisualUtil={})).explorationContainsTrustedVisual=function(t,e,i){return!!i.isTrustedVisual(t)&&_.some(e.sections,(function(e){return _.some(e.visualContainers,(function(e){return e.config.singleVisual.visualType===t}))}))},e.acquireTrustedVisuals=function(e,t){for(var i=[],r=0,n=e.sections;r<n.length;r++)for(var a=0,o=n[r].visualContainers;a<o.length;a++){var s=o[a].config.singleVisual.visualType;s&&t.isTrustedVisual(s)&&i.push(s)}return t.getConsentAndLoadVisuals(i)}})(powerbi=powerbi||{}),(function(T){var D,I,M,r,O,N,R,L;D=T.explore||(T.explore={}),I=D.util||(D.util={}),M=T.explore.contracts.FilterType,r=T.explore.services.FormatPainter,O=jsCommon.JsonExtensions,N=T.common.dialog.MessageDialogBuilder,R=T.data.services.SemanticQuerySerializer,L=T.explore.util.VisualContainerUtils,(I.ExploreClipboardHandlerUtility||(I.ExploreClipboardHandlerUtility={})).createClipboardHandler=function(g,v,m,f,y,C,S,b,c,E,V,w,e,u,t,x){var i=this;function P(e){for(var t=0,i=e;t<i.length;t++)i[t].config.singleVisual.syncGroup=null}function F(e,t,i){var r,n,a=[],o=(r=g.exploration.contract.sections,n=e,_.find(r,(function(e){return e.name===n})));if(!o)return a;for(var s=0;s<i.length;s++){var l,u=i[s];D.contracts.isVisualContainer(u)&&((l=c.capabilities(u.config.singleVisual.visualType))&&l.supportsSynchronizingFilterState&&u.config.singleVisual.query&&!u.config.singleVisual.syncGroup&&((l=(function(e,t){return _.find(e,(function(e){return e.name===t}))})(o.visualContainers,v.deserializeCanvasItem(t[s]).name))&&a.push({sourceVisual:l,newVisual:u})))}return a}function A(l){return __awaiter(this,void 0,T.Promise,(function(){var t,i,r,n,a,o,s;return __generator(this,(function(e){switch(e.label){case 0:return[4,y.get(C.get())];case 1:for(t=e.sent(),i=(function(){for(var e={},t=0,i=g.exploration.contract.sections;t<i.length;t++)for(var r=0,n=i[t].visualContainers;r<n.length;r++){var a=n[r].config.singleVisual.syncGroup;a&&(e[a.groupName]=!0)}return e})(),r=0,n=l;r<n.length;r++)a=n[r],o=a.sourceVisual.config.singleVisual,(s=o.syncGroup)?a.newVisual.config.singleVisual.syncGroup=__assign({},s):(s=u.generateUniqueGroupName(t,o,i),o.syncGroup={groupName:s,fieldChanges:!0,filterChanges:!0},a.newVisual.config.singleVisual.syncGroup={groupName:s,fieldChanges:!0,filterChanges:!0},i[s]=!0);return[2]}}))}))}return{deleteSelection:function(){g.exploration&&g.exploration.exploreCanvas&&b.deleteSelectedVisuals(g.exploration.exploreCanvas)},deserializeAndDuplicateData:function(c,p,d,h){return __awaiter(i,void 0,void 0,(function(){var t,i,r,n,a,o,s,l,u;return __generator(this,(function(e){switch(e.label){case 0:return g.exploration&&g.exploration.exploreCanvas&&d.length?h?[3,2]:[4,y.get(C.get())]:[2];case 1:for(t=e.sent(),i=0,r=d;i<r.length;i++)!(function(e,t){if(e.filters){for(var i=O.tryParseJSON(e.filters),r=0,n=i;r<n.length;r++){var a,o=n[r];o.type===M[M.Categorical]&&null!=o.filter&&((a=(function(e,t){var i=e&&e.HierarchyLevel,e=i&&i.Expression&&i.Expression.Hierarchy,i=e&&e.Expression&&e.Expression.PropertyVariationSource;if(i){e=R.deserializeExpr(i.Expression).getTargetEntity(),e=e&&e.entity;return (function(e,t,i,r){for(var n=0,a=e.schemas;n<a.length;n++)for(var o=a[n],s=0,l=o.entities;s<l.length;s++){var u=l[s];if(u.name===t)for(var c=0,p=u.properties;c<p.length;c++){var d=p[c];if(d.name===i){d=d.column;if(d&&d.variations)for(var h=0,g=d.variations;h<g.length;h++){var v=g[h];if(v.name===r)return v.navigationProperty.targetEntity.name}}}}})(t,e,i.Property,i.Name)}})(o.expression,t))&&(o.filter.From.length,o.filter.From[0].Entity=a))}e.filters=JSON.stringify(i)}})(r[i],t);e.label=2;case 2:return(n=g.exploration,a=n.contract,o=n.exploreCanvas,u=a&&a.settings&&a.settings.useStylableVisualContainerHeader,u=I.CanvasVisualsUtility.duplicateCanvasItems(d,n.contract,o.contract,v,V,b,o,S,E,u))?(!h&&x&&L.hasVisualColumnRename(u)&&x.syncVisualColumnRenames(a),1===c?[2]:(s=_.filter(u,(function(e){return D.contracts.isVisualContainer(e)&&e.config.singleVisual.syncGroup})),p===g.exploration.exploreCanvas.contract.name?(P(s),[2]):(l=F(p,d,u),_.isEmpty(s)&&_.isEmpty(l)?[2]:[4,new N(f).show("syncVisuals",{titleText:m.get("SyncVisualsDialog_Title"),messageText:m.get("SyncVisualsDialog_Message"),okButtonText:m.get("SyncVisualsDialog_Sync"),cancelButtonText:m.get("SyncVisualsDialog_DoNotSync")})]))):[2];case 3:return u=0===e.sent(),w.logEvent(T.telemetry.EXCopyPasteSyncGroup,{keepSynced:u,visualGroupCount:l.length}),u?[4,A(l)]:[3,5];case 4:return e.sent(),[3,6];case 5:P(s),e.label=6;case 6:return[2]}}))}))},serializeSelection:function(){return __awaiter(i,void 0,void 0,(function(){var t,i,r;return __generator(this,(function(e){switch(e.label){case 0:return i=(t=I.CanvasVisualsUtility).serializeSelection,r=[v,S],[4,y.get(C.get())];case 1:return[2,i.apply(t,r.concat([e.sent()]))]}}))}))},getSelectionResources:function(){return I.CanvasVisualsUtility.getSelectionResources(S,g.exploration.contract.resourcePackages)},getSelectionSectionName:function(){return g.exploration.exploreCanvas.contract.name},deserializeVisualContainer:function(e){return v.deserializeCanvasItem(e,!0)},copyCanvasItemFormat:function(){return r.copyFormatCanvasItem(S,c,g.exploration.contract.themeCollection,t)},pasteCanvasItemFormat:function(e){e=r.pasteFormatCanvasItem(S,c,e);e&&b.raiseCanvasItemChanged(e)},isReady:function(){return null!=g.exploration}}}})(powerbi=powerbi||{}),(function(i){!(function(e){function t(){}e=e.util||(e.util={}),t.getDefaultVisualPlugin=function(e){return e&&e.featureSwitches&&e.featureSwitches.pivotTableVisualEnabled?i.visuals.plugins.tableEx:i.visuals.plugins.table},e.FieldWellUtility=t})(i.explore||(i.explore={}))})(powerbi=powerbi||{}),(function(a){var r,e,t,n,o,s;function i(e,t,i){if(0===e.displayOption)return s.Dynamic;if(e.width===r.constants.ExploreCanvasConstants.DefaultCanvasWidth&&e.height===o.DefaultCanvasHeight)return s.Standard;if(e.width===r.constants.ExploreCanvasConstants.DefaultWidescreenWidth&&e.height===o.DefaultWidescreenHeight)return s.Widescreen;if(n.isCortanaPageSize(e)){i=r.PodUtils.findPodIndexForSectionName(t,i.name);return-1!==i&&t.pods[i].cortanaEnabled?s.Cortana:s.Custom}return e.width===r.constants.ExploreCanvasConstants.DefaultLetterWidth&&e.height===o.DefaultLetterHeight?s.Letter:(e=e).width===r.constants.ExploreCanvasConstants.DefaultTooltipWidth&&e.height===r.constants.ExploreCanvasConstants.DefaultTooltipHeight?s.Tooltip:s.Custom}r=a.explore||(a.explore={}),e=r.util||(r.util={}),n=a.explore.util.CanvasDisplayUtility,o=r.constants.ExploreCanvasConstants,s=a.explore.contracts.SectionPageSizeTypes.PageSizeTypes,(t=e.PropertyPaneUtils||(e.PropertyPaneUtils={})).PageSizeTypesToSectionSize=((e={})[s.Dynamic]={displayOption:0,width:r.constants.ExploreCanvasConstants.DefaultCanvasWidth,height:r.constants.ExploreCanvasConstants.DefaultCanvasHeight},e[s.Standard]={displayOption:1,width:r.constants.ExploreCanvasConstants.DefaultCanvasWidth,height:r.constants.ExploreCanvasConstants.DefaultCanvasHeight},e[s.Widescreen]={displayOption:1,width:r.constants.ExploreCanvasConstants.DefaultWidescreenWidth,height:r.constants.ExploreCanvasConstants.DefaultWidescreenHeight},e[s.Cortana]={displayOption:3,width:r.constants.ExploreCanvasConstants.DefaultCortanaWidth,height:r.constants.ExploreCanvasConstants.DefaultCortanaHeight},e[s.Letter]={displayOption:1,width:r.constants.ExploreCanvasConstants.DefaultLetterWidth,height:r.constants.ExploreCanvasConstants.DefaultLetterHeight},e[s.Tooltip]={displayOption:1,width:r.constants.ExploreCanvasConstants.DefaultTooltipWidth,height:r.constants.ExploreCanvasConstants.DefaultTooltipHeight},e[s.Custom]={displayOption:3,width:r.constants.ExploreCanvasConstants.DefaultCanvasWidth,height:r.constants.ExploreCanvasConstants.DefaultCanvasHeight},e),t.getDisplayNames=function(e){for(var t=[],i=0,r=e;i<r.length;i++){var n=r[i];t.push(__assign(__assign({},n),{value:""+n.value,displayName:a.explore.viewModels.ViewModelFactory.getDisplayName(n.displayName)}))}return t},t.getDisplayUnits=function(e){for(var t=[],i=0,r=a.visuals.valueFormatter.getDisplayUnits(e=void 0===e?!1:e);i<r.length;i++){var n=r[i];t.push({displayName:n.title,value:n.value.toString()})}return t},t.getPageSizeType=function(e,t){return i(e,t.getCurrentExploration(),t.getCurrentSection())},t.getPageSizeTypeBySection=i,t.getDefaultSectionSize=function(e){return t.PageSizeTypesToSectionSize[e]}})(powerbi=powerbi||{}),(function(e){(e=(e=e.explore||(e.explore={})).ScopeUtils||(e.ScopeUtils={})).getSchemaPromise=function(e,t,i){return e?i.get(e):t.reject()},e.defineDataSourcesOnScopeLegacy=function(e,t){Object.defineProperty(e,"dataSources",{get:function(){return t.get()},set:function(e){return t.set(e)}})}})(powerbi=powerbi||{}),(function(e){var t,l,r;t=(t=e.explore||(e.explore={})).util||(t.util={}),l=e.data.SQExpr,r=e.explore.util.VisualContainerUtils,(t=t.SparklinesUtil||(t.SparklinesUtil={})).containsSparklineData=function(e){return _.some(r.getSelectExprs(e),(function(e){return l.isSparklineData(e.expr)}))},t.replaceSparklineDataWithMeasure=function(n,a,o){var e=r.getSelectExprs(a);if(!_.isEmpty(e))for(var s=r.getVisualQuery(a),t=0,i=e;t<i.length;t++)!(function(e){var t,i,r=e.expr;l.isSparklineData(r)&&(t=r.measure,i=s.getRoleNameForExpr(r),e=_.chain(s.tryGetExprs(i)).map((function(e,t){return{expr:e,index:t}})).filter((function(e){return l.equals(e.expr,r)})).map((function(e){return e.index})).value(),_.forEach(e,(function(e){return o.replaceField(n,t,i,e,a)})))})(i[t])},t.getFieldCharacteristics=function(e,t){var i,t=null===(t=e.grouping[0].getMetadata(t))||void 0===t?void 0:t.type;return{groupingType:i=t?t.dateTime||t.temporal?"Date":t.numeric?"Numeric":"Categorical":i,measureType:l.isAggregation(e.measure)?"Aggregate":"Measure"}}})(powerbi=powerbi||{}),(function(j){var z;(function(d){var u=j.visuals.plugins,a=j.visuals.ActionButtonType,o=jsCommon.ArrayExtensions,y=j.explore.constants,h=j.data.DataBoundExprExtractor,C=j.data.DataViewObjectDefinitions,S=j.data.DataViewRoleWildcard,v=j.explore.util.DrillUtils,g=z.services.events,b=j.explore.constants.ExploreCanvasConstants,l=j.data.FieldExprPattern,c=z.contracts.FilterType,m=j.explore.util.HierarchyUtils,s=j.data.QueryProjectionsByRole,r=j.contracts.ResourcePackageItemType,f=z.services.selectionUtils,E=j.data.SemanticFilter,p=j.visuals.SmallMultiplesUtils,V=j.data.SQExpr,w=j.data.SQExprBuilder,x=j.data.SQExprConverter,P=j.data.SQExprHierarchyToHierarchyLevelConverter,F=j.data.SQExprUtils,A=j.data.SQHierarchyExprUtils,t=j.data.SQScopedEvalExpr,T=j.visuals.TablixProperties,D=j.explore.contracts.VisualContainer,n=j.explore.contracts.VisualContainerGroup,I=j.explore.util.VisualContainerUtils,M=j.explore.contracts.VisualLink,O=z.contracts.VisualQuery;d.createVisualAuthoringOperations=function(e,t,i,r,n,a,o,s,l,u,c,p,d,h,g,v,m,f,y,C,S,b,E,V,w,x,P){return new N(e,t,i,r,n,a,o,s,l,u,c,p,d,h,g,v,m,f,y,C,S,b,E,V,w,x,P)};var N=(R.prototype.logSmallMultiplesTelemetry=function(e,t,i,r,n){var a=null===(a=e.config)||void 0===a?void 0:a.singleVisual;!1!=!!a&&r===j.visuals.cartesianRoleNames.rows&&(!p.supportsSmallMultiplesDataViewMapping(null==i?void 0:i.dataViewMappings)||(a=null===(a=a.query)||void 0===a?void 0:a.projections)&&a[j.visuals.cartesianRoleNames.rows]&&1===a[j.visuals.cartesianRoleNames.rows].all().length&&this.telemetry.logEvent(j.telemetry.EXSmallMultiplesFirstField,{source:n,targetVisualType:t,visualName:e.name}))},R.prototype.switchQueryParameter=function(e,t,i,r,n){var a,o=t.config.singleVisual.query,s=o.tryGetFieldExprs(r)[i],l=s.isFieldParameter;if(l)u=null==(a=o.getParameterByFieldIndex(i,r))?void 0:a.expr;else{var u=(u=V.isAggregation(s.expr)?s.expr.arg.getTargetColumnRef(e):u)||s.expr;if(!F.shouldUseAsFieldParameter(this.featureSwitchService.featureSwitches.fieldParametersAuthoring,e,u,this.featureSwitchService.featureSwitches.fieldParameterDynamicSlicer||!this.filterGenerator.supportsFilterOutput(t),this.isAnalysisVisual(t)))return!1}return!!u&&(!!this.removeFieldFromRole({role:r,projOptions:{fieldIndex:i,parameter:a}},e,t)&&(!!this.addFieldInRole(e,u,r,t,i,!1,!1,l)&&(this.isVisualRecommendationAllowed(t)&&null!=n&&n.updateWithRecommendation(t,void 0,e),this.telemetry.logEvent(j.telemetry.EXSwitchQueryParameter,{fromMetadataToData:l,visualType:I.getVisualType(t),visualName:t.name,role:r}),!0)))},R.prototype.addFieldToVisual=function(e,t,i,r,n){if(!i)return!1;this.core.ensureFiltersArrayIsValid(i.filters);var a,o=i.config.singleVisual,s=o.query,l=this.visualPluginService.capabilities(o.visualType),u=F.shouldUseAsFieldParameter(this.featureSwitchService.featureSwitches.fieldParametersAuthoring,e,t,this.featureSwitchService.featureSwitches.fieldParameterDynamicSlicer||!this.filterGenerator.supportsFilterOutput(i),this.isAnalysisVisual(i));u?(a=this.addExpressionToVisual(e,i,t,u),this.isVisualRecommendationAllowed(i)&&a&&null!=r&&r.updateWithRecommendation(i,void 0,e)):a=this.isVisualRecommendationAllowed(i)?null!=(c=null==r?void 0:r.updateWithRecommendation(i,{toAdd:t},e)):this.addHierarchyLevelToExistingHierarchiesInVisual(e,l,i.config,t)||this.addExpressionToVisualWithoutAggregation(e,i,l,t)||this.addExpressionToVisualForcingAggregation(e,i,t)||this.addExpressionToVisual(e,i,t,u);var c,p=t.getConceptualProperty(e),r=p&&p.measure&&p.measure.template&&p.measure.template.name,p=u?"FieldParameter":G(t);return a?(this.runAddFieldValidation(i,e,t,u),void 0!==n&&(c=I.getVisualType(i),this.telemetry.logEvent(j.telemetry.EXAddField,{source:n,targetVisualType:c,fieldKind:p,drillToDetailsMode:I.hasGroupByItemsInQuery(i),success:!0,quickMeasureTemplateName:r,visualName:i.name}),t=o.query.getRoleNameForExpr(t),this.logSmallMultiplesTelemetry(i,c,l,t,n)),!0):(i.config.singleVisual.query=s,void 0!==n&&this.telemetry.logEvent(j.telemetry.EXAddField,{source:n,targetVisualType:I.getVisualType(i),fieldKind:p,drillToDetailsMode:I.hasGroupByItemsInQuery(i),success:!1,quickMeasureTemplateName:r,visualName:i.name}),!1)},R.prototype.addFieldInRole=function(e,t,i,r,n,a,o,s,l){this.core.ensureFiltersArrayIsValid(r.filters);var u,c=!s&&F.shouldUseAsFieldParameter(this.featureSwitchService.featureSwitches.fieldParametersAuthoring,e,t,this.featureSwitchService.featureSwitches.fieldParameterDynamicSlicer||!this.filterGenerator.supportsFilterOutput(r),this.isAnalysisVisual(r));this.isVisualRecommendationAllowed(r)&&null==i?c?(u=this.addExpressionToVisual(e,r,t,c),null!=l&&l.updateWithRecommendation(r,void 0,e)):u=!(null==l||!l.updateWithRecommendation(r,{toAdd:t},e)):(s=void 0,l=this.getVisualDataRole(r,i),c||this.shouldPreferGroupToAggregate(e,t,c,r,l)||a||(t=this.createExprWithAggregate(t,e,!0,l),s=!0),p=void 0,p=c?t:(l=this.canHierarchyLevelJoinExistingGroup(e,r.config.singleVisual.query,i,t,n),o=this.getTargetRoleAndExpressionsForAdd(e,r,t,i,o),s||l?t:o&&o.expressions),(u=this.core.add({expr:p,schema:e,targetRole:i,projOptions:{fieldIndex:n}},r.config,c))&&(I.getSingleVisualConfig(r).autoSelectVisualType=void 0));var p=t.getConceptualProperty(e),n=p&&p.measure&&p.measure.template&&p.measure.template.name,p=c?"FieldParameter":G(t);if(u){this.runAddFieldValidation(r,e,t,c);t=I.getVisualType(r);this.telemetry.logEvent(j.telemetry.EXAddField,{source:"DraggedToFieldWell",targetVisualType:t,fieldKind:p,drillToDetailsMode:I.hasGroupByItemsInQuery(r),success:!0,quickMeasureTemplateName:n,visualName:r.name});c=this.visualPluginService.capabilities(t);return this.logSmallMultiplesTelemetry(r,t,c,i,"DraggedToFieldWell"),!0}return this.telemetry.logEvent(j.telemetry.EXAddField,{source:"DraggedToFieldWell",targetVisualType:I.getVisualType(r),fieldKind:p,drillToDetailsMode:I.hasGroupByItemsInQuery(r),success:!1,quickMeasureTemplateName:n,visualName:r.name}),!1},R.prototype.resolveParameters=function(e,t,i){var r=this.core.resolveParameters(e,t,i,this.drill,this.sortService,this.setDisplayNameAlias),n=r.queryChange,a=r.aliasChange,o=r.totalAddAttemptCount,s=r.totalAddSuccessCount,l=r.totalRemoveAttemptCount,u=r.totalRemoveSuccessCount,c=r.totalSuccessColumnCount,p=r.totalSuccessDateHierarchyCount,i=r.totalSuccessMeasureCount;return n?(this.notifyVisualContainers([t],void 0,!1,e,1),r=I.getVisualType(t),this.telemetry.logEvent(j.telemetry.EXResolveParameters,{targetVisualType:r,addSuccessTotalCount:s,addAttemptTotalCount:o,addSuccessTotalColumnCount:c,addSuccessTotalDateHierarchyCount:p,addSuccessTotalMeasureCount:i,removeSuccessCount:u,removeAttemptCount:l,visualName:t.name})):a&&this.notifyVisualContainers([t],void 0,!1,e,1),n},R.prototype.setDisplayNameAlias=function(e,t,i){var r,n=t.config.singleVisual,t=n.columnProperties;if(i){n.columnProperties||(n.columnProperties=t={}),(r=t[e])||(t[e]=r={});var a=r.displayName;return r.displayName=i,r.displayName!==a}if(t){if(r=t[e]){a=r.displayName;return delete r.displayName,void 0!==a}return!1}},R.prototype.runAddFieldValidation=function(e,t,i,r,n){r?this.notifyVisualContainers([e],"UserAction_EditVisual",!1,t):this.core.runAddFieldValidation(e,t,i,this.drill,this.sortService,this.updateFilterState,n)},R.prototype.expandHierarchy=function(e,t,i,r,n){var a=(t.config.singleVisual.query.tryGetExprs(i)||[]).slice(r,r+n);if(_.isEmpty(a))return!1;a=a[0];if(V.isHierarchyLevel(a)){var a=a.arg,o=A.expandExpr(e,a);if(_.isArray(o)){var s=o.length;if(n<s){for(var l=t.config.singleVisual.query,u=!1,c=0;c<s;c++)if(!V.equals(l.tryGetExpr(i,r+c),o[c])){var p={expr:o[c],schema:e,targetRole:i,projOptions:{fieldIndex:r+c}};if(!this.core.add(p,t.config,!1))break;this.core.setMatchingFilterToAuto(o[c],t),u=!0}return u&&this.notifyVisualContainers([t]),u}}}return!1},R.prototype.removeFieldFromAllRoles=function(e,t,i,r){var n=r||f.getSelectedVisualContainers(this.selectionService),a=!1,r=this.tryGetParameterExprs(e,n);if(!_.isEmpty(r))for(var o=0,s=r;o<s.length;o++)var l=s[o],u=l.exprs,l=l.parameter,a=this.removeFieldImpl(u,n,t,i,l)||a;a=this.removeFieldImpl(e,n,t,i)||a;e=A.expandExpr(t,e,!0);return a=_.isArray(e)&&!_.isEmpty(e)?this.removeFieldImpl(e,n,t,i)||a:a},R.prototype.tryGetParameterExprs=function(e,t){for(var i=[],r=t.length-1;-1<r;r--){var n=t[r].config.singleVisual.query;n&&(n=n.getParameterProjectionExprs(e),i.push.apply(i,n))}return i},R.prototype.removeFieldFromRole=function(e,t,i,r){var n=i;if(n){var a=e.role,o=n.config.singleVisual.query,s=e.projOptions,i=s.fieldIndex,a=s.parameter||o.getParameterByFieldIndex(i,a);return a&&(e.projOptions.parameter=a,e.shouldRemoveParameter=!0),this.invokeRemoveOnSelectedVisuals(e,[n],t,r)}return!1},R.prototype.removeInvalidExpressions=function(e,t,i){var r=t.config.singleVisual;if(!r||!r.query)return!1;for(var n=[],a=r.query.defn.select(),o=0,s=a;o<s.length;o++){var l=s[o].expr;_.isEmpty(l.validate(e,this.aggrOps))||n.push(l)}for(var u=0,c=n;u<c.length;u++){var p=c[u];this.removeFiltersWithExpr(p,t)}return this.removeFieldImpl(n,[t],e,i),this.removeInvalidDataBoundProperty(r.vcObjects,e,a),this.removeInvalidDataBoundProperty(r.objects,e,a),!0},R.prototype.removeInvalidDataBoundProperty=function(u,c,p){var e;!u||(e=(function(l){function e(s){var e=u[s];if(!_.isEmpty(e))for(var t=function(e){var t,a=e.properties,o=e.selector;for(t in a){var i=(function(e){var t=a[e],t=h.getDataBoundExprs(t,o,p);if(!_.isEmpty(t))for(var i=0,r=t;i<r.length;i++){var n=r[i];if(null==n.expr||!_.isEmpty(n.expr.validate(c,l)))return{value:function(){C.deleteProperty(u,s,o,e)}}}})(t);if("object"==typeof i)return i}},i=0,r=e;i<r.length;i++){var n=t(r[i]);if("object"==typeof n)return n}}for(var t in u){t=e(t);if("object"==typeof t)return t.value}})(this.aggrOps))&&(e(),this.eventBridge.publishToChannel(g.visualContainerChanged,{affectContainer:function(){return!0}}))},R.prototype.moveField=function(e,t,i,r,n,a,o){var s=o||f.getSelectedVisual(this.selectionService);if(!s)return!1;var l=s.config.singleVisual.query,o=l.getParameterByFieldIndex(r,t);if(!o&&t!==i){var u=this.getVisualDataRole(s,i),c=m.getHierarchyReplacementExpressions(s.config,t,r,a,u);if(_.isEmpty(c))return!1;u=c}c={sourceRole:t,targetRole:i,sourceIndex:r,targetIndex:n,sourceCount:a,replacementExpressions:u,schema:e,allowPartialReplace:!0},l=v.getDrillFilterRemovalInfoList(l,c,1),a={projOptions:{fieldIndex:r,parameter:o},role:t,count:a};if(this.core.removeAutoFilterFromContract(f.getSelectedVisual(this.selectionService),a),this.core.move(c,s.config)){this.core.ensureValidDrillState(s,l,this.drill),this.core.setDefaultSort(s,e,this.sortService,this.visualPluginService),I.setQueryKeepProjectionOrder(s),this.updateFilterState(e,s,!0,!0,!0);n=s.config.singleVisual.query.tryGetExpr(i,n);if(this.logReportMeasureMoveTelemetry(e,s,t,i,n),u&&0<u.length)for(var p=0,d=u;p<d.length;p++){var h=d[p];this.core.setMatchingFilterToAuto(h,s)}n=I.getVisualType(s),u=this.visualPluginService.capabilities(n);return this.logSmallMultiplesTelemetry(s,n,u,i,"DraggedToFieldWell"),!0}return!1},R.prototype.drillDownLevel=function(e,t,i){if(t){var r=I.getVisualType(t),n=this.telemetry.startEvent(j.telemetry.EXInteractionExpand,{sourceVisualType:r,isInlineHierarchyEnabled:2===i,visualName:t.name}),a=t.config.singleVisual,r=_.isEmpty(e)?[]:[e];if(_.isEmpty(r)&&(e=this.visualPluginService.capabilities(a.visualType),r=v.getDrillableRoles(e)),!_.isEmpty(r))for(var o=0,s=r;o<s.length;o++){var l=s[o];if(l){var u=this.core.changeActiveProjection(l,a,i);if(u)return 2===i&&this.expandCollapse.isEnabled(t,[l])&&(u.length,this.expandCollapse.expandLevel(t,[l],u.length-2,!0)),this.notifyVisualContainers([t],"UserAction_Drill"),void n.resolve()}}n.reject()}},R.prototype.replaceField=function(e,t,i,r,n){var a={sourceRole:i,targetRole:i,sourceIndex:r,targetIndex:r,sourceCount:1,replacementExpressions:[t],schema:e},i={projOptions:{fieldIndex:r,parameter:n.config.singleVisual.query.getParameterByFieldIndex(r,i)},role:i};if(this.core.removeAutoFilterFromContract(f.getSelectedVisual(this.selectionService),i),this.core.move(a,n.config)){this.resetSearchProperties(n);a=F.shouldUseAsFieldParameter(this.featureSwitchService.featureSwitches.fieldParametersAuthoring,e,t,this.featureSwitchService.featureSwitches.fieldParameterDynamicSlicer||!this.filterGenerator.supportsFilterOutput(n),this.isAnalysisVisual(n));return this.runAddFieldValidation(n,e,t,a),!(I.getSingleVisualConfig(n).autoSelectVisualType=void 0)}return!1},R.prototype.drillDown=function(l,e,u,t){var i=I.getVisualType(u),c=this.telemetry.startEvent(j.telemetry.EXInteractionDrill,{sourceVisualType:i,isDrillDown:!0,visualName:u.name}),p=u.config.singleVisual;if(this.runningVisualService.getVisual(u).clearSelectedDatapoints(),_.isEmpty(e)||_.isEmpty(e[0].dataMap))return!1;u.filters||(u.filters=[]);var d=e[0].dataMap,h=p.query,e=_.isEmpty(t)?[]:[t];if(_.isEmpty(e)&&(t=this.visualPluginService.capabilities(p.visualType),e=v.getDrillableRoles(t)),!_.isEmpty(e))for(var g=this,r=0,n=e;r<n.length;r++){var a=(function(e){var t=h.projections[e],i=t&&t.activeProjectionRefs,r=_.filter(d,(function(e,t){return _.includes(i,t)}));if(!_.isEmpty(r)){var n=h.currentDrillMode(e)||2,t=g.core.changeActiveProjection(e,p,n);if(t){2===n&&g.expandCollapse.isEnabled(u,[e])&&(t.length,t=_.uniq(t),g.expandCollapse.expandLevel(u,[e],t.length-2,!0));for(var a=0,o=r;a<o.length;a++){var s=o[a];g.core.addDrillFilter(l,u.filters,h,i,R.chooseRepetitionSelectorForDrill(s))}r=g.explorationNavigationService.getCurrentSection();return g.filterGenerator.updateCrossFilterOnDrill(r,u),g.notifyVisualContainers([u],"UserAction_Drill"),c.resolve(),{value:!0}}}})(n[r]);if("object"==typeof a)return a.value}return c.reject(),!1},R.chooseRepetitionSelectorForDrill=function(e){if(1===(e=o.ensureArray(e)).length)return e[0];for(var t=0,i=e;t<i.length;t++){var r=i[t],n=n||r;r.key.length>n.key.length&&(n=r)}return n},R.prototype.drillUp=function(e,t){if(t){var i=I.getVisualType(t),r=this.telemetry.startEvent(j.telemetry.EXInteractionDrill,{sourceVisualType:i,isDrillDown:!1,visualName:t.name}),n=t.config.singleVisual,a=n.query,i=_.isEmpty(e)?[]:[e];if(_.isEmpty(i)&&(e=this.visualPluginService.capabilities(t.config.singleVisual.visualType),i=v.getDrillableRoles(e)),!_.isEmpty(i))for(var o=0,s=i;o<s.length;o++){var l=s[o],u=this.core.changeActiveProjection(l,n,1);if(!_.isEmpty(u)){var c=_.last(u),c=a.defn.select().withName(c).expr;return 2===(a.currentDrillMode(l)||2)&&this.expandCollapse.isEnabled(t,[l])&&(u=_.uniq(u),this.expandCollapse.collapseLevel(t,[l],u.length-1)),this.core.removeDrillFilter(t.filters,c)&&(c=this.explorationNavigationService.getCurrentSection(),this.filterGenerator.updateCrossFilterOnDrill(c,t)),this.notifyVisualContainers([t],"UserAction_Drill"),void r.resolve()}}r.reject()}},R.prototype.setDrillFilterOtherVisualsSetting=function(e){var t=f.getSelectedVisual(this.selectionService);t&&this.setVisualDrillFilterOtherVisualsSetting(t,e)},R.prototype.drillToDetails=function(e,t,i,r,n,a){var o,s=i;do{if(!(o=this.drillToDetailsCore(e,t,s,r,n,a)))return}while(!o.targetQueryHasColumns&&1<s.length&&(s=s.slice(0,-1),!0));return o.targetVisualContainer},R.prototype.drillToDetailsCore=function(e,t,i,r,n,a){var o=!1;if(o=_.some(i)?V.isAggregation(_.head(i))&&1===i.length||_.every(i,(function(e){return V.isMeasure(e)})):o){o=D.clone(n,this.explorationSerializer);this.addDrillToDetailsFilters(t,o,r);var r=o.config.singleVisual,s={name:e,config:{singleVisual:r},layouts:n.layouts,filters:o.filters};if(r.visualType!==j.visuals.plugins.tableEx.name){var l=this.convert(t,s,j.visuals.plugins.tableEx.name);if(!l)return}((r=s.config.singleVisual).vcObjects=r.vcObjects||{}).stylePreset=[{properties:{name:w.text("Default")}}];l=r.objects={};C.setValue(l,T.PropTotalTableExTotals,void 0,w.boolean(!1));for(var u=r.query,c=0,p=i;c<p.length;c++){var d=p[c],h=d.getTargetEntity();V.isAggregation(d)?(this.removeAggregatesAndMeasures(t,s,!1),this.removeTableReferences(s),this.addDetailTableProperties(t,h,s),u.defn=u.defn.addGroupBy(h)):(this.addDetailTableProperties(t,h,s,!0,a),this.removeAggregatesAndMeasures(t,s,!0),this.removeTableReferences(s));h=I.getVisualType(n);this.telemetry.logEvent(j.telemetry.EXDrillToDetails,{sourceVisualType:h,targetExprKind:G(d),visualName:n.name})}return{targetVisualContainer:s,targetQueryHasColumns:0<u.defn.select().length}}},R.prototype.isAnalysisVisual=function(e){return e&&e.config&&e.config.singleVisual&&this.pluginOps.isAnalysisVisual(e.config.singleVisual.visualType)},R.prototype.removeAggregatesAndMeasures=function(e,t,n){for(var a=t.config.singleVisual.query,i=0,r=a.defn.select();i<r.length;i++)!(function(t){var e,i,r=t.expr;(F.isMeasure(r)&&!1===n||V.isAggregation(r)&&!0===n)&&(e=a.getRoleNameForExpr(r),i=s.getRole(a.projections,e),i=_.findIndex(i.all(),(function(e){return e.queryRef===t.name})),a.removeAggregate(e,i)),V.isMeasure(r)&&!1===n&&a.removeExpr(r,!1)})(r[i])},R.prototype.removeTableReferences=function(e){for(var t=e.config.singleVisual.query,i=0,r=t.defn.select();i<r.length;i++){var n=r[i];V.isEntity(n.expr)&&t.removeExpr(n.expr,!1)}},R.prototype.addDetailTableProperties=function(e,t,i,r,n){for(var a=i.config.singleVisual.query,o=F.getConceptualEntity(t,e),s=0,l=a.defn.select();s<l.length;s++){var u=l[s].expr,c=u.getTargetEntity();_.isEqual(t,c)||(F.isRelatedOneToOne(e,t,c,0)||F.isRelatedToMany(e,c,t,0)||a.removeExpr(u,!1))}for(var p=0,d=o.properties;p<d.length;p++){var h,g=d[p];g.hidden||1===g.kind&&n||(1===g.kind||g.type.integer||g.type.numeric)&&!r||g.type.dateTime&&g.column&&!_.isEmpty(g.column.variations)||(h=void 0,h=1===g.kind?w.measureRef(t,g.name):w.columnRef(t,g.name),a.defn.selectNameOf(h)||this.addFieldToVisual(e,h,i))}},R.prototype.setAggregate=function(e,t,i,r,n,a){var o,s={projOptions:{fieldIndex:i},role:t};return this.core.removeAutoFilterFromContract(f.getSelectedVisual(this.selectionService),s),this.isVisualRecommendationAllowed(n)?o=null!=a.updateWithRecommendation(n,{toUpdate:{role:t,index:i,aggregateToUse:r}},e):(o=this.core.setAggregate({role:t,index:i,newAggregate:r,schema:e},n.config))&&(this.core.setDefaultSort(n,e,this.sortService,this.visualPluginService),I.setQueryKeepProjectionOrder(n)),o&&this.notifyVisualContainers([n]),o},R.prototype.removeAggregate=function(e,t,i,r,n){var a,o={projOptions:{fieldIndex:i},role:t};return this.core.removeAutoFilterFromContract(f.getSelectedVisual(this.selectionService),o),this.isVisualRecommendationAllowed(r)?a=null!=n.updateWithRecommendation(r,{toUpdate:{role:t,index:i,aggregateToUse:void 0}},e):(a=this.core.removeAggregate({role:t,index:i,schema:e},r.config))&&(this.core.setDefaultSort(r,e,this.sortService,this.visualPluginService),I.setQueryKeepProjectionOrder(r)),a&&this.notifyVisualContainers([r]),a},R.prototype.setPercentOfGrandTotal=function(e,t,i,r){return!!this.core.setPercentOfGrandTotal({role:t,index:i,schema:e},r.config)&&(this.core.setDefaultSort(r,e,this.sortService,this.visualPluginService),this.core.ensureValidDrillMode(r,this.drill),this.notifyVisualContainers([r]),!0)},R.prototype.removePercentOfGrandTotal=function(e,t,i,r){return!!this.core.removePercentOfGrandTotal({role:t,index:i,schema:e},r.config)&&(this.core.setDefaultSort(r,e,this.sortService,this.visualPluginService),this.notifyVisualContainers([r]),!0)},R.prototype.setPercentOfRoleTotal=function(e,t,i,r,n){return!!this.core.setPercentOfRoleTotal({roleRefs:t,role:i,index:r,schema:e},n.config)&&(this.core.setDefaultSort(n,e,this.sortService,this.visualPluginService),this.core.ensureValidDrillMode(n,this.drill),this.notifyVisualContainers([n]),!0)},R.prototype.removePercentOfRoleTotal=function(e,t,i,r){return!!this.core.removePercentOfRoleTotal({role:t,index:i,schema:e},r.config)&&(this.core.setDefaultSort(r,e,this.sortService,this.visualPluginService),this.notifyVisualContainers([r]),!0)},R.prototype.setVariation=function(e,t,i,r,n,a){if(a=a||1,n<0)return!1;for(var o=[],s=0;s<a;s++)if(o[s]=t.config.singleVisual.query.tryGetExpr(r,n+s),!o[s])return!1;var l=[i];if(V.isHierarchy(i)&&!(l=P.convert(i,e)))return!1;var u=this.getVisualDataRole(t,r),c=m.getHierarchyReplacementExpressions(t.config,r,n,a,u,l);if(_.isEmpty(c))return!1;i=c,u={sourceRole:r,targetRole:r,sourceIndex:n,targetIndex:n,sourceCount:o.length,replacementExpressions:i,schema:e,allowPartialReplace:!0},l={count:o.length,projOptions:{fieldIndex:n},role:r},c=v.getDrillFilterRemovalInfoList(t.config.singleVisual.query,l,0),l={count:a,projOptions:{fieldIndex:n},role:r};this.core.removeAutoFilterFromContract(f.getSelectedVisual(this.selectionService),l);u=this.core.move(u,t.config);if(u&&(this.core.ensureValidDrillState(t,c,this.drill),this.core.setDefaultSort(t,e,this.sortService,this.visualPluginService),I.setQueryKeepProjectionOrder(t),this.notifyVisualContainers([t]),i&&0<i.length))for(var p=0,d=i;p<d.length;p++){var h=d[p];this.core.setMatchingFilterToAuto(h,t)}return u},R.prototype.toggleShowAll=function(e,t){t&&(this.core.toggleShowAll(e,t.config),I.setQueryKeepProjectionOrder(t),this.notifyVisualContainers([t]))},R.prototype.createVisualContainerConfig=function(e,t){return this.createVisualContainerConfigCore(t,e)},Object.defineProperty(R.prototype,"featureSwitches",{get:function(){return this.featureSwitchService.featureSwitches},enumerable:!1,configurable:!0}),R.prototype.addDrillToDetailsFilters=function(e,t,i){if(!_.isEmpty(i)&&i[0]&&!_.isEmpty(i[0].dataMap)){var r=I.getVisualQuery(t);if(r){var n=[];if(r.projections)for(var a in r.projections)_.isEmpty(r.projections[a].activeProjectionRefs)||n.push(r.projections[a].activeProjectionRefs);var o,s=i[0].dataMap;for(o in t.filters=t.filters||[],s){var l=_.find(n,(function(e){return _.includes(e,o)}));this.core.addDrillToDetailsFilter(e,t.filters,r,l||[o],R.chooseRepetitionSelectorForDrill(s[o]))}}}},R.prototype.findCompatibleRole=function(e,t,i,r){var n=t.config.singleVisual,t=n.query||new O(j.data.SemanticQuery.create(),{},[]),n=this.visualPluginService.capabilities(n.visualType),t=t&&t.projections;if(n&&t){n=j.visualCapabilitiesHelperModuleFactory().create(n,this.geotaggingAnalyzerService);return n&&n.findCompatibleRole({queryProjections:t,schema:e,expr:i,roleToExprMap:new z.utils.SQExprToRoleDictionary(d.HierarchyUtils.hierarchyLevelComparer),preferDrillableRoles:!1,isFieldParameter:r})}},R.prototype.getMaxNumberOfExpressionsAllowedInRole=function(e,t,i){var r=t.config.singleVisual,n=r.query||new O(j.data.SemanticQuery.create(),{},[]),t=this.visualPluginService.capabilities(r.visualType),r=n&&n.projections;if(t&&r){r=j.visualCapabilitiesHelperModuleFactory().create(t,this.geotaggingAnalyzerService),t=v.getDrillableRoles(t);if(_.includes(t,i))return Number.MAX_VALUE;i=r.getNumberRangesForRoles(n)[i];if(i&&i.max)return i.max}return 0},R.prototype.getTargetRoleAndExpressionsForAdd=function(e,t,i,r,n){var a,o=i;return A.isHierarchyOrVariation(e,i)&&!this.shouldUseOriginalColumn(t,e,i,!1,r)&&(o=A.expandExpr(e,i,n),_.isArray(o)&&(a=o,r||(n=this.findCompatibleRole(e,t,a[0],!1))&&(r=n.name),!r||(t=this.getMaxNumberOfExpressionsAllowedInRole(e,t,r))!==Number.MAX_VALUE&&(o=1===t&&V.isColumn(i)?i:V.isHierarchy(i)||V.isColumn(i)?a.slice(0,t):a.slice(a.length-t,a.length)))),{targetRole:r,expressions:o}},R.prototype.shouldUseOriginalColumn=function(e,t,i,r,n){if(n||(r=this.findCompatibleRole(t,e,i,r))&&(n=r.name),!n)return!1;n=this.getVisualDataRole(e,n);if(n){t=i.getConceptualProperty(t);if(t&&t.column&&(t.type===j.ValueType.fromExtendedType(518)||t.type===j.ValueType.fromExtendedType(519))&&n.preferDateColumn)return!0}return!1},R.prototype.addExpressionToVisualWithoutAggregation=function(e,t,i,r){var n=i&&j.ScriptResultUtil.findScriptResultMapping(i.dataViewMappings),a=this.getTargetRoleAndExpressionsForAdd(e,t,r);a.targetRole&&i.dataRoles[a.targetRole]!==j.VisualDataRoleKind.Measure||(a.expressions instanceof Array&&(a.expressions=r),n||this.shouldPreferGroupToAggregate(e,r,!1,t)||(a.expressions=this.createExprWithAggregate(a.expressions,e,!1)));a={expr:a.expressions,schema:e,targetRole:a.targetRole};return this.core.add(a,t.config,!1)},R.prototype.addExpressionToVisualForcingAggregation=function(e,t,i){i=this.createExprWithAggregate(i,e,!0);return this.core.add({expr:i,schema:e},t.config,!1)},R.prototype.addExpressionToVisual=function(e,t,i,r){return this.core.add({expr:i,schema:e},t.config,r)},R.prototype.createVisualContainerConfigCore=function(e,t){var i=e.expr,r=function(e){return e instanceof Array},n=r(i=e.allowAggregate&&!r(i)&&!this.shouldPreferGroupToAggregate(t,i,!1)?this.createExprWithAggregate(i,t,!1):i)?i[0]:i,r=this.featureSwitchService.featureSwitches.onObject&&this.settingsService.getSuggestVisualByDefault()?null==e.visualType:void 0,n=e.visualType||B(n,t,this.geotaggingAnalyzerService,this.featureSwitches),e=e.inFilterVisualContainer;return this.core.create({expr:i,visualType:n,schema:t,autoSelectVisualType:r,inFilterVisualContainer:e})},R.prototype.addVisualContainerImageFromData=function(e,t,i){t=this.resourceRegistration.add(i,1,r.Image,{content:"data:image/png;base64,"+t});this.addVisualContainerImage(e,t)},R.prototype.addVisualContainerImage=function(e,t){var i={singleVisual:{visualType:"image",objects:{general:[{properties:{imageUrl:t}}]}}},r=j.Prototype.inherit(e),t=this.formFactorProvider.getCurrentLayout();r.position=R.getPositionForAddedVisual(e.exploreCanvas,t,e.position),this.createVisualFromConfig(r,i,void 0,"InsertVisualButton")},R.prototype.addVisualContainerBasicShapeVisual=function(e,t){var i=j.Prototype.inherit(e),r=this.formFactorProvider.getCurrentLayout();i.position=R.getPositionForAddedVisual(e.exploreCanvas,r,e.position);t={singleVisual:{visualType:u.basicShape.name,objects:{general:[{properties:{shapeType:w.text(t)}}]}}};this.createVisualFromConfig(i,t,void 0,"InsertVisualButton")},R.prototype.addVisualContainerShapeVisual=function(e,t){t.shapeType;var i=j.Prototype.inherit(e),r=this.formFactorProvider.getCurrentLayout();i.position=R.getPositionForAddedVisual(e.exploreCanvas,r,e.position);t={singleVisual:{visualType:u.shape.name,objects:{shape:[{properties:{tileShape:w.text(t.shapeType)}}],rotation:[{properties:{shapeAngle:w.integer(null!==(t=t.shapeRotation)&&void 0!==t?t:0)}}]}}};this.createVisualFromConfig(i,t,void 0,"InsertVisualButton")},R.prototype.addVisualContainerActionButtonVisual=function(e,t){var i=j.Prototype.inherit(e),r=this.formFactorProvider.getCurrentLayout();i.position=R.getPositionForAddedVisual(e.exploreCanvas,r,e.position);var e={icon:[{properties:{shapeType:w.text(t)},selector:{id:"default"}}]},n={properties:{show:w.boolean(!0)}};switch(t){case a.back:n.properties.type=w.text(M.Back);break;case a.qna:n.properties.type=w.text(M.Qna);break;case a.bookmarks:n.properties.type=w.text(M.Bookmark);break;default:n=void 0}e={singleVisual:{visualType:u.actionButton.name,objects:e}};n&&(e.singleVisual.vcObjects={},e.singleVisual.vcObjects.visualLink=[n]),this.createVisualFromConfig(i,e,void 0,"InsertVisualButton")},R.prototype.addVisualContainerNavigatorVisual=function(e,t){var i=this.formFactorProvider.getCurrentLayout();e.position=R.getPositionForAddedVisual(e.exploreCanvas,i,e.position);var r={singleVisual:{visualType:void 0}};switch(t){case"page":r.singleVisual.visualType=u.pageNavigator.name;break;case"bookmark":r.singleVisual.visualType=u.bookmarkNavigator.name}this.createVisualFromConfig(e,r,void 0,"InsertVisualButton")},R.prototype.applyConfigOptions=function(e,t){return e.visualLink&&(t.singleVisual.vcObjects=t.singleVisual.vcObjects||{},t.singleVisual.vcObjects.visualLink=[e.visualLink]),t},R.prototype.addVisualContainer=function(e,t,i,r,n){var a=this.formFactorProvider.getCurrentLayout();n=R.getPositionForAddedVisual(r,a,n),t.expr,Array,t.expr=A.expandExpr(e,t.expr);e=this.createVisualContainerConfig(e,t);if(e)return this.createVisualFromConfig({sections:i,exploreCanvas:r,position:n,postProcessing:t.postProcessing,selectedVisualContainers:t.selectedVisualContainers},e)},R.prototype.addEmptyVisualContainer=function(e,t,i,r,n,a){var o=this.formFactorProvider.getCurrentLayout();r=R.getPositionForAddedVisual(t,o,r);o=this.featureSwitchService.featureSwitches.onObject&&this.settingsService.getSuggestVisualByDefault()?null==i:void 0,i={singleVisual:{visualType:null!=i?i:j.visuals.plugins.columnChart.name}};return o&&(i.singleVisual.autoSelectVisualType=!0),this.createVisualFromConfig({sections:e,exploreCanvas:t,position:r,postProcessing:a,selectedVisualContainers:n},i)},R.prototype.addVisualContainerFromConfig=function(e,t,i,r,n,a){return n=n||R.getPositionForAddedVisual(r,null),this.createVisualFromConfig({sections:i,exploreCanvas:r,position:n,select:a},e,t)},R.prototype.groupVisualContainers=function(e,t){for(var i=this,r=e.contract.visualContainerGroups,n=1,a=I.getVisualContainerGroups(r),o=this.formFactorProvider.getCurrentLayout(),s=e.contract,s=_.isEmpty(s.visualContainerGroups)?s.visualContainers:s.visualContainerGroups,s=R.getDefaultVisualContainerPosition(s,o),o=this.formFactorProvider.getCurrentLayout();_.some(a,(function(e){return z.contracts.isVisualContainerGroup(e)&&e.displayName===i.localizationService.get("Group_Role")+" "+n}));)n++;t={name:I.uniqueName(r),displayName:this.localizationService.get("Group_Role")+" "+n,groupMode:0,layouts:jsCommon.ArrayExtensions.extendWithId([{id:o,position:s}]),children:t};e.contract.visualContainerGroups=j.ItemGroupingManager.group(t,r);r=d.CanvasVisualsUtility.findCanvasItemViewModels(e.visualContainerGroups,t.children),o=z.viewModels.ViewModelFactory.convertVisualContainerGroup(t,r,o);return o&&(e.visualContainerGroups=j.ItemGroupingManager.group(o,e.visualContainerGroups),d.CanvasVisualsUtility.syncCanvasItemViewModelsWithContracts(e.visualContainerGroups,e.contract.visualContainerGroups)),f.selectCanvasItem(t,this.selectionService),o},R.prototype.ungroupVisualContainers=function(e,t){e.contract.visualContainerGroups=j.ItemGroupingManager.ungroup(t,e.contract.visualContainerGroups);var i=j.ItemGroupingManager.find(t.name,e.visualContainerGroups);if(z.viewModels.isVisualContainerGroup(i))return e.visualContainerGroups=j.ItemGroupingManager.ungroup(i,e.visualContainerGroups),d.CanvasVisualsUtility.syncCanvasItemViewModelsWithContracts(e.visualContainerGroups,e.contract.visualContainerGroups),f.unselectCanvasItem(t,this.selectionService),i},R.prototype.moveCanvasItemsInTree=function(e,t,i,r,n){void 0===n&&(n=!1),e.contract.visualContainerGroups=j.ItemGroupingManager.move(t,i,e.contract.visualContainerGroups,r);var a=d.CanvasVisualsUtility.findCanvasItemViewModels(e.visualContainerGroups,t),o=j.ItemGroupingManager.find(i.name,e.visualContainerGroups);return e.visualContainerGroups=j.ItemGroupingManager.move(a,o,e.visualContainerGroups,r),d.CanvasVisualsUtility.syncCanvasItemViewModelsWithContracts(e.visualContainerGroups,e.contract.visualContainerGroups),n?(i.parentGroup,i.parentGroup&&((e=j.ItemGroupingManager.find(i.parentGroup.name,e.contract.visualContainerGroups))?f.selectCanvasItem(e,this.selectionService):this.selectionService.clearSelection())):f.selectCanvasItem(t[0],this.selectionService),a},R.prototype.updateContainerListOrders=function(e,t,i){for(var r=this.formFactorProvider.getCurrentLayout(),n=[],a=[],o=0,s=e;o<s.length;o++){var l=s[o],u=t[l.name];null!=u&&(u=Math.floor(u))!==l.layouts.withId(r).position[i]&&("z"===i?this.setZIndex(l,u):this.setTabOrder(l,u),(z.contracts.isVisualContainer(l)?n:a).push(l))}_.isEmpty(n)||this.notifyVisualContainers(n),_.isEmpty(a)||this.notifyVisualContainerGroups(a)},R.prototype.createVisualFilters=function(e,t,i,r){for(var t=z.viewModels.ViewModelFactory.createVisualFilters(e,t,r,this.displayNameService,this.visualPluginService,this.pluginOps,this.filterGenerator,this.aggrOps,this.localizationService),n=0,a=t;n<a.length;n++){var o=a[n];o.updateFilterProperties(r,this.visualPluginService,this.aggrOps),o.canVisualize()&&(o.isInvalid()||this.createFilterVisualContainerConfig(o.contract,i,r,!1))}return t},R.prototype.moveFilter=function(e,t,i,r){var n=z.FilterUtils.getFiltersContainer(t,this.selectionService,this.explorationNavigationService);return this.setFilterSortType(e,t,3),this.moveFilterContainer(n.filters,r,i),!0},R.prototype.setFilterSortType=function(e,t,i){var r=z.FilterUtils.getFiltersContainer(t,this.selectionService,this.explorationNavigationService);return r.filterSortOrder!==i&&(this.telemetry.logEvent(j.telemetry.EXToggleFilterCardSort,{sortType:d.getTelemetryFilterCardSortType(i)}),3===i?(this.sortFiltersByCurrentSortType(e,r,t),this.updateFilterOrdinal(r.filters)):r.filters&&r.filters.forEach((function(e){null!=e&&(e.ordinal=void 0)})),r.filterSortOrder=i),!0},R.prototype.sortFiltersByCurrentSortType=function(i,e,r){var n=this;void 0===e.filterSortOrder&&(e.filterSortOrder=1);var a,o,t=e.filters.filter((function(e){return z.FilterUtils.getFilterCapabilities(e).canSort})),s=e.filters.filter((function(e){return!z.FilterUtils.getFilterCapabilities(e).canSort}));1===e.filterSortOrder||2===e.filterSortOrder?(a=f.getSelectedVisual(this.selectionService),o=I.getVisualCapabilities(a,this.visualPluginService),t.sort((function(e,t){e=e.displayName||n.getDisplayName(e,i,o,r,a&&a.config.singleVisual)||"",t=t.displayName||n.getDisplayName(t,i,o,r,a&&a.config.singleVisual)||"";return e.localeCompare(t)})),2===e.filterSortOrder&&t.reverse()):3===e.filterSortOrder&&t.sort((function(e,t){return e.ordinal-t.ordinal})),e.filters=t.concat(s)},R.prototype.moveFilterContainer=function(e,t,i){t<i&&(i-=1);var r=e[t];e.splice(t,1),e.splice(i,0,r),this.updateFilterOrdinal(e)},R.prototype.updateFilterOrdinal=function(i){i.forEach((function(e,t){null!=e&&(e.ordinal=t,null==e.name&&(e.name=z.FilterUtils.getNextFilterName(i)))}))},R.prototype.getDisplayName=function(e,t,i,r,n){var a,o,s;return e.type===c.Include||e.type===c.Exclude?(s=new z.services.IncludeExcludeSQExprVisitor(t,this.displayNameService),z.FilterUtils.getDisplayNameForIncludeExcludeFilters(this.localizationService,e.type,s.dataPoints.length)):e.type===c.Passthrough?e.restatement:(a=e.expression&&x.asFieldPattern(e.expression),s=o=void 0,e.expression&&n&&(o=n.query&&n.query.defn.selectNameOf(e.expression),s=n.columnProperties),this.displayNameService.getDisplayName(e.expression,t,i,o,0===r?s:void 0,{includeVariationSource:!0})||(a?l.getFieldExprName(a):void 0))},R.prototype.addFilter=function(e,t,i,r,n,a){n&&i.scopeType;var o=f.getSelectedVisual(this.selectionService);if(!z.FilterUtils.canAdd(o,t,e,i,n,this.pluginOps))return!1;this.core.ensureFiltersArrayIsValid(i.container.filters);var s,l=n?5:1,u=z.FilterUtils.getDefaultFilterType(t,e,l),c={name:z.FilterUtils.getNextFilterName(i.container.filters),expression:t,type:u,howCreated:l},p=_.isEmpty(z.FilterUtils.validate(c,e,this.aggrOps));return c.expanded=z.FilterUtils.canExpandManually(l,!1,t,p),j.data.SQExprUtils.isMeasure(t)||this.createFilterVisualContainerConfig(c,r,e),void 0===a||i.container.filterSortOrder,z.FilterUtils.add(i.container,c),3===i.container.filterSortOrder&&this.moveFilterContainer(i.container.filters,i.container.filters.length-1,a),this.featureSwitchService.featureSwitches.certifiedTelemetryUserEvents&&(s=z.FilterUtils.createChangeFilterActivity(this.contextActivityService,"Add Filter")),z.FilterUtils.notifyFilterContainerChangedByUser(this.eventBridge,{filter:c,changeType:1,scope:i,changeFilterActivity:s}),s&&s.resolve(),n?(z.PodUtils.isPodEnabled(c,i),k(this.telemetry,"Add",i.container,void 0),s=this.explorationNavigationService.getCurrentExploration(),n=i.container,null!=s&&null!=n&&(e=z.FilterUtils.determineIsLinkedAsAggregation(c,e,this.aggrOps),e={filterName:c.name,type:0,isCausedByCode:!1,fieldExpr:c.expression,asAggregation:e,isLegacySingleSelection:!1},z.PodUtils.addParameter(s,n.name,c.name,c.expression,e.asAggregation,!1,z.PodUtils.determineType(n)),this.eventBridge.publishToChannel(g.podParameterChanged,e))):F.isMeasure(t)&&this.telemetry.logEvent(j.telemetry.EXAddFilter,{filterType:H(u),filterScopeType:U(i.scopeType),fieldKind:G(t),drillToDetailsMode:I.hasGroupByItemsInQuery(o),viewMode:d.getTelemetryViewMode(this.viewModeState.getMode())}),!0},R.prototype.addFilterContainers=function(e,t){this.core.ensureFiltersArrayIsValid(e);for(var i=0,r=e;i<r.length;i++){var n=r[i];z.FilterUtils.add(t.container,n);var a=void 0;this.featureSwitchService.featureSwitches.certifiedTelemetryUserEvents&&(a=z.FilterUtils.createChangeFilterActivity(this.contextActivityService,"Add Filter")),z.FilterUtils.notifyFilterContainerChangedByUser(this.eventBridge,{filter:n,changeType:1,scope:t,changeFilterActivity:a}),a&&a.resolve()}},R.prototype.removeFilter=function(e,t,i,r){return this.removeFilterImpl(e,t,i,r)},R.prototype.toggleSlicerVisualSearch=function(e,t,i){e.config,e.config.singleVisual;var r=d.VisualContainerUtils.getVisualCapabilities(e,i),n=this.filterGenerator.tryGetSelfFilterEnabledProperty(r);if(!n)return!1;i=e.config.singleVisual;i.objects||(i.objects={});e=j.data.DataViewObjectDefinitions.getValue(i.objects,n,null);return e&&e.value?(j.data.DataViewObjectDefinitions.deleteProperty(i.objects,n.objectName,null,n.propertyName),(r=t.tryGetSelfFilterProperty(r))&&j.data.DataViewObjectDefinitions.deleteProperty(i.objects,r.objectName,null,r.propertyName)):j.data.DataViewObjectDefinitions.setValue(i.objects,n,null,j.data.SQExprBuilder.boolean(!0)),!0},R.prototype.assignSyncGroup=function(e,t){e.config.singleVisual.syncGroup=__assign({},t),e.config.singleVisual.conversionSourceContext=void 0},R.prototype.clearSyncGroup=function(e){e.config.singleVisual.syncGroup=void 0,e.config.singleVisual.conversionSourceContext=void 0},R.prototype.enableSearchInFilterCard=function(e,t){var i=u.slicer.capabilities,r=this.filterGenerator.tryGetSelfFilterEnabledProperty(i),n=j.visuals.visualStyles.create().colorPalette,a=j.visuals.slicerProps.searchBox,o=this.featureSwitchService.featureSwitches.paneColorRefresh||this.explorationCapabilities.getCapabilities().showFluentDesign,i=o?b.FilterCardSearchBoxBorderColor:n.foregroundNeutralDark.value,n=o?b.FilterCardSearchBoxBackgroundColor:n.foregroundNeutralSecondary.value;this.ensureObjectDefinitionProperty(e,t,r,null,j.data.SQExprBuilder.boolean(!0)),this.ensureObjectDefinitionProperty(e,t,a.borderColor,null,{solid:{color:j.data.SQExprBuilder.text(i)}}),this.featureSwitches.outlineDropdownToCheckboxes?this.ensureObjectDefinitionProperty(e,t,a.outlineStyle,null,j.data.SQExprBuilder.integer(0)):this.ensureObjectDefinitionProperty(e,t,a.outline,null,j.data.SQExprBuilder.text(j.visuals.outline.none)),this.ensureObjectDefinitionProperty(e,t,a.background,null,{solid:{color:j.data.SQExprBuilder.text(n)}})},R.prototype.createFilterVisualContainerConfig=function(e,t,i,r){void 0===r&&(r=!0),e.expression;var n,a,o,s,l,u,c,p,d,h,g,v,m,f=e.expression;V.isTransformOutputRoleRef(f)||(g=F.discourageAggregation(f,i),h=(n=x.asFieldPattern(f)).column||n.groupingColumn||n.hierarchyLevel,u={expr:f,dataSources:t,allowAggregate:!1,visualType:j.visuals.plugins.filterSlicer.name,inFilterVisualContainer:!0},F.isMeasure(f)||(a=!r||null===(m=e.config)||void 0===m?void 0:m.singleVisual.objects,(o=this.createVisualContainerConfigCore(u,i))&&((s=o.singleVisual.objects)||(o.singleVisual.objects=s={}),c=!(p=5===e.howCreated&&!e.isTransient),l=j.visuals.slicerProps.selection.selectAllCheckboxEnabled,d=j.visuals.slicerProps.selection.singleSelect,t=j.visuals.slicerProps.header.show,r=j.visuals.slicerProps.data.mode,m=j.visuals.slicerProps.general.filter,u=j.visuals.slicerProps.data.isInvertedSelectionMode,this.ensureObjectDefinitionProperty(s,a,r,null,w.text(j.visuals.slicerMode.basic)),this.ensureObjectDefinitionProperty(s,a,l,null,w.boolean(c)),this.ensureObjectDefinitionProperty(s,a,d,null,w.boolean(p)),this.ensureObjectDefinitionProperty(s,a,t,null,w.boolean(!1)),this.enableSearchInFilterCard(s,a),c=this.featureSwitchService.featureSwitches.paneColorRefresh||this.explorationCapabilities.getCapabilities().showFluentDesign,d=j.visuals.visualStyles.create().colorPalette,p=j.visuals.slicerProps.items.textSize,t=j.visuals.slicerProps.items.fontColor,d=c?b.FilterCardFontColor:d.foregroundLight.value,this.ensureObjectDefinitionProperty(s,a,p,null,w.integer(y.smallFontSizeInPoint)),this.ensureObjectDefinitionProperty(s,a,t,null,{solid:{color:j.data.SQExprBuilder.text(d)}}),!g&&h&&(g=w.entity(h.schema,h.entity,h.entityVar),v=w.aggregate(g,2),h=j.visuals.slicerProps.general.count,g=o.singleVisual.query.getRoleNameForExpr(f),g={data:[S.fromRoles([g])]},this.ensureObjectDefinitionProperty(s,a,h,g,v)),v=0===e.howCreated&&!E.isDefaultFilter(e.filter),this.core.ensureDefaultFilterApplied(i,o.singleVisual,v)&&null==e.filter&&(f=n.column||n.groupingColumn?f.getKeyColumns(i):[f],e.filter=E.getDefaultValueFilter(f)),e.filter&&this.ensureObjectDefinitionProperty(s,a,m,null,e.filter),null!=(m=C.getValue(e.objects,{objectName:"general",propertyName:"isInvertedSelectionMode"},void 0))&&this.ensureObjectDefinitionProperty(s,a,u,null,m),e.config=o)))},R.prototype.ensureObjectDefinitionProperty=function(e,t,i,r,n){t=t?C.getValue(t,i,r):void 0;C.setValue(e,i,r,t||n)},R.prototype.notifyVisualContainers=function(e,t,i,r,n){var a=this;void 0===t&&(t="UserAction_EditVisual");var o=this.explorationNavigationService.getCurrentSection(),s=_.map(e,(function(e){return i?I.filterAffects(e,o,a.visualRelationshipService,r):I.contractEqualityComparator(e)}));this.eventBridge.publishToChannel(g.visualContainerChanged,{affectContainer:function(t){return _.some(s,(function(e){return e(t)}))},sourceLabelKey:t,visualContainerChangeType:n})},R.prototype.notifyVisualContainerGroups=function(t){this.eventBridge.publishToChannel(g.visualContainerGroupChanged,{affectContainer:function(e){return _.includes(t,e)}})},R.prototype.convert=function(e,t,i,r,n,a){var o=I.getVisualType(t),s=I.isVisualTypeAutoSelect(t),l=null==i,u=this.telemetry.startEvent(j.telemetry.EXInteractionVisualConversion,{sourceVisualType:o,targetVisualType:i,visualName:t.name});if(s&&l||!s&&!l&&o===i)return u.resolve(),!1;if(s&&!l&&o===i)return t.config.singleVisual.autoSelectVisualType=void 0,u.resolve(),this.eventBridge.publishToChannel(g.visualTypeChanged),!0;a&&(t.postProcessing=a({outputVisualContainer:t,selectedVisualContainers:n})),this.visualAuthoringCustomizeOperations.requiresCustomizeConvert(t)&&this.visualAuthoringCustomizeOperations.customizeConvert(t),null!=i&&this.customizeConvertTo(t,i);a=t.config.singleVisual.query;if(l||(n=this.visualPluginService.capabilities(i),a&&_.isEmpty(n.dataRoles)&&(a=t.config.singleVisual.query=void 0)),a){if(!l){this.resetSearchProperties(t);a=z.contracts.SingleVisualConfig.clone(t.config.singleVisual),l=this.core.convert({schema:e,source:a,target:i});if(!l)return u.reject();t.config.singleVisual=a,this.core.ensureFiltersArrayIsValid(t.filters),u.resolve();a=this.visualPluginService.capabilities(o),o=this.filterGenerator.tryGetFilterPropertyIdentifier(a);o||(a=this.visualPluginService.capabilities(i),o=this.filterGenerator.tryGetFilterPropertyIdentifier(a)),this.core.ensureValidDrillMode(t,this.drill),this.ensurePercentRoleTotal(t,i),this.updateFilterState(e,t,!1,!0,!0,o);o=t.filters;return _.isEmpty(o)||z.FilterUtils.supportsVisualFilters(t,this.pluginOps)||(t.filters=[]),this.removeUnsupportedDataBoundProperties(t,i),this.core.setDefaultSort(t,e,this.sortService,this.visualPluginService),_.remove(o,(function(e){return null==e||0===e.howCreated&&void 0===e.filter})),t.config.singleVisual.autoSelectVisualType=void 0,this.eventBridge.publishToChannel(g.visualTypeChanged),l}null!=(i=null==r?void 0:r.updateWithRecommendation(t,void 0,e))&&(t.config.singleVisual.autoSelectVisualType=!0)}return t.config.singleVisual.visualType=i,u.resolve(),this.notifyVisualContainers([t]),this.eventBridge.publishToChannel(g.visualTypeChanged),!0},R.prototype.setOrderBy=function(e,t){var i=e.config.singleVisual;i.query.orderBy(t),i.hasDefaultSort=_.isEmpty(t),this.notifyVisualContainers([e],"UserAction_Sorting")},R.prototype.removeOrderBy=function(e,t,i){for(var r=0,n=t;r<n.length;r++){var a=n[r];e.config.singleVisual.query.removeOrderBy(a)}this.core.setDefaultSort(e,i,this.sortService,this.visualPluginService),this.notifyVisualContainers([e])},R.prototype.deleteVisualRelationships=function(e,t){_.remove(e.relationships,(function(e){return e.source===t||e.target===t}))},R.prototype.addProperty=function(e,t,i,r){var n=e.config.singleVisual,e=n.objects;e||(n.objects=e={}),C.setValue(e,t,i,r)},R.prototype.removeProperty=function(e,t,i){e=e.config.singleVisual.objects;1<C.deleteProperty(e,t.objectName,i,t.propertyName)&&this.telemetry.logEvent(j.telemetry.EXDefnsDuplicateSelector)},R.prototype.setVisibility=function(e,t,i){var r=e.config.singleVisual;D.setHidden(r,t),t&&(t=this.explorationNavigationService.getCurrentSection(),this.filterGenerator.clearCrossHighlightForVisualContainers(t,[e]),i||f.unselectCanvasItem(e,this.selectionService))},R.prototype.clearCrossHighlightsForGroup=function(e,t,i){var r,n=[];return z.contracts.traverseVisualContainerGroups([e],(function(t){z.contracts.isVisualContainer(t)&&_.some(i,(function(e){return e.sourceVisualContainer===t}))&&n.push(t)})),_.isEmpty(n)||(this.filterGenerator.clearCrossHighlightForVisualContainers(t,n),r=this.clearCrossHighlightsForVisuals(n,t)),r||[]},R.prototype.clearCrossHighlightsForVisuals=function(e,t){var i=__spreadArray([],e||[]);return i.push.apply(i,this.filterGenerator.clearCrossHighlightForVisualContainersOperation(t,e)||[]),_.uniq(i)},R.prototype.setVisualContainerGroupVisibility=function(e,t,i){var r;n.setHidden(e,t),t&&(t=(r=this.explorationNavigationService.getCurrentSection())&&r.crossFilterSource&&r.crossFilterSource.highlight,this.clearCrossHighlightsForGroup(e,r,t)),i||f.unselectCanvasItem(e,this.selectionService)},R.prototype.setVisualContainerGroupDisplayName=function(e,t){n.setDisplayName(e,t)},R.prototype.setZIndex=function(e,t){var i=this.formFactorProvider.getCurrentLayout();e.layouts.withId(i).position.z=t},R.prototype.setTabOrder=function(e,t){var i=this.formFactorProvider.getCurrentLayout();e.layouts.withId(i).position.tabOrder=t},R.prototype.setVisualRelationship=function(e,t,i,r){var n;t!==i&&(e.relationships=e.relationships||[],(n=this.visualRelationshipService.relationship(e,t,i))?n.type=r:(_.includes(e.visualContainers,t),_.includes(e.visualContainers,i),e.relationships.push({source:t,target:i,type:r})))},R.prototype.persistProperties=function(e,t,i){var r=t.objects||{},n=this.visualPluginService.capabilities(t.visualType),n=n?n.objects:void 0;return!!z.services.applyPropertyChanges(e,n,r,i)&&(t.objects=r,!(t.autoSelectVisualType=void 0))},R.prototype.persistVCProperties=function(e,t){var i=t.vcObjects||{};return!!z.services.applyPropertyChanges(e,D.CommonObjectDescriptors,i)&&(t.vcObjects=i,!0)},R.prototype.removeUnsupportedDataBoundProperties=function(e,t){var r,n,a;!(this.visualPluginService.isScriptVisual(t)||this.pluginOps.isAnalysisVisual(t))||(r=e.config.singleVisual.vcObjects)&&(n=e.config.singleVisual.query.defn.select(),a=[],_.forEach(r,(function(e,i){e=e[0].properties;_.forEach(e,(function(e,t){0<h.getDataBoundExprs(e,null,n).length&&a.push((function(){C.deleteProperty(r,i,null,t)}))}))})),_.forEach(a,(function(e){e()})))},R.prototype.ensurePercentRoleTotal=function(e,t){this.visualPluginService.capabilities(t).dataRoleTotals||(t=new i,t=new z.schemaRewriterUtils.VisualQueryExprRewriter(t),t=new d.VisualContainerRewriter([t]),d.traverseVisualContainer(e,t,this.visualPluginService))},R.prototype.getVisualDataRole=function(e,t){e=I.getDataRolesForVisual(e,this.visualPluginService);if(!_.isEmpty(e))return o.findItemWithName(e,t)},R.prototype.removeFieldImpl=function(e,t,i,r,n){return this.invokeRemoveOnSelectedVisuals({expr:e,ignoreAggregates:!0,fieldParameter:n,shouldRemoveParameter:!0},t,i,r)},R.prototype.removeFilterImpl=function(e,t,i,r){if(!t||!t.container||!t.container.filters)return!1;for(var n,a,o={filter:e,changeType:0,scope:t,parentActivity:i,changeFilterActivity:r},s=0;s<t.container.filters.length;s++)if(t.container.filters[s]===e)return t.container.filters.splice(s,1),3===t.container.filterSortOrder&&this.updateFilterOrdinal(t.container.filters),z.FilterUtils.notifyFilterContainerChangedByUser(this.eventBridge,o),(5===e.howCreated&&!e.isTransient&&1===t.scopeType||z.PodUtils.isPodEnabled(e,t))&&(n=this.explorationNavigationService.getCurrentExploration(),a=t.container,null!=n&&null!=a&&(z.PodUtils.deleteParameter(n,a.name,e.name,this.linguisticSchemaProxy),a={filterName:e.name,type:1},this.eventBridge.publishToChannel(g.podParameterChanged,a))),!0;return!1},R.prototype.removeFiltersWithExpr=function(e,t){var i,r=t.filters;if(!r)return!1;for(var n=r.length-1;0<=n;n--){var a=r[n];V.equals(a.expression,e)&&(i=this.removeFilterImpl(a,{scopeType:0,container:t},void 0,void 0))}return i},R.prototype.invokeRemoveOnSelectedVisuals=function(e,t,i,r){for(var n=!1,a=[],o=t.length-1;-1<o;o--){var s,l,u=t[o],c=u.config.singleVisual.query;c&&(this.checkSparklineRemovedAndLog(c,e,i),l=v.getDrillFilterRemovalInfoList(c,e,0),s=this.core.getRemoveOptionsQueryRefs(e,c),l=0<this.core.removeWithValidation(c,s,[e],u,i,l,this.drill,this.sortService,this.updateFilterState).removeSuccessCount,n=n||l,l&&(a.push(u),this.isVisualRecommendationAllowed(u)&&null!=r&&r.updateWithRecommendation(u,void 0,i)))}return _.isEmpty(a)||this.notifyVisualContainers(a),n},R.prototype.buildVisualContainerFromConfig=function(e,t,i){return this.core.ensureFiltersArrayIsValid(i),{name:e,config:t,filters:i||[]}},R.prototype.createVisualFromConfig=function(e,t,i,r){t=this.applyConfigOptions(e,t);var n=this.formFactorProvider.getCurrentLayout(),a=_.flatMap(e.sections,(function(e){return e.visualContainerGroups})),o=I.uniqueName(a),s=this.buildVisualContainerFromConfig(o,t,i);s.layouts=jsCommon.ArrayExtensions.extendWithId([{id:n,position:e.position}]);var l=this.explorationNavigationService.getCurrentExploration();l.defaultDrillFilterOtherVisuals&&(s.drillFilterOtherVisuals=!0);a=e.exploreCanvas,o=a.contract,t=f.getSelectedCanvasItems(this.selectionService),i=t&&t[0],t=t&&1===t.length&&z.contracts.isVisualContainerGroup(i);e.postProcessing&&(s.postProcessing=e.postProcessing({outputVisualContainer:s,selectedVisualContainers:e.selectedVisualContainers||o.visualContainers})),o.visualContainers.push(s),t&&z.contracts.isVisualContainerGroup(i)?o.visualContainerGroups=j.ItemGroupingManager.addToGroup(s,i,o.visualContainerGroups):o.visualContainerGroups=j.ItemGroupingManager.add(o.visualContainerGroups,s);n=z.viewModels.ViewModelFactory.convertVisualContainer(l,o,s,n);if(n)return a.visualContainers.push(n),t?(t=j.ItemGroupingManager.find(i.name,a.visualContainerGroups),z.viewModels.isVisualContainerGroup(t)&&(a.visualContainerGroups=j.ItemGroupingManager.addToGroup(n,t,a.visualContainerGroups)),d.CanvasVisualsUtility.syncCanvasItemViewModelsWithContracts(a.visualContainerGroups,o.visualContainerGroups),i=j.ItemGroupingManager.find(i.name,a.visualContainerGroups),z.viewModels.isVisualContainerGroup(i)&&this.layoutAuthoring.addCanvasItemToGroup(i,n,!0)):a.visualContainerGroups=j.ItemGroupingManager.add(a.visualContainerGroups,n),!1!==e.select&&f.selectCanvasItem(s,this.selectionService,0,!0),this.telemetry.logEvent(j.telemetry.EXCreateVisual,{source:r,visualType:I.getVisualType(s),visualName:s.name}),s},R.prototype.createExprWithAggregate=function(e,t,i,r){if(F.discourageAggregation(e,t))return e;var n=this.getPreferredAggregate(t,e,r);return this.aggrOps.createExprWithAggregate(e,t,i,r?r.requiredTypes:null,n)},R.getPositionForAddedVisual=function(e,t,i){e=e.contract.visualContainerGroups;if(!i)return R.getDefaultVisualContainerPosition(e,t);if(null!=i.z)return i;i=_.cloneDeep(i);return i.z=d.CanvasVisualsUtility.getZIndexForNewCanvasItem(e,t),i},R.getDefaultVisualContainerPosition=function(e,t){return{height:0,width:0,x:0,y:0,z:d.CanvasVisualsUtility.getZIndexForNewCanvasItem(e,t)}},R.prototype.shouldPreferGroupToAggregate=function(e,t,i,r,n){if(r){var a=n||this.findCompatibleRole(e,r,t,!1);if(a&&a.kind===j.VisualDataRoleKind.GroupingOrMeasure&&1===a.kindPreference)return!0}if(n&&n.kind===j.VisualDataRoleKind.GroupingOrMeasure){var o=this.isRoleOrExprLatLong(e,t,n);if(o){if(!r)return!0;var s=I.getVisualQuery(r);if(s&&s.projections)for(var a=this.visualPluginService.capabilities(r.config.singleVisual.visualType),r=j.visualCapabilitiesHelperModuleFactory().create(a,this.geotaggingAnalyzerService),a=void 0,l=0,u=a=o?r.getNonLatLongRoles():a;l<u.length;l++){var c=u[l];if(s.projections[c])return!1}}else{if(!F.isExprValidForAggregation(t)||i)return!0;var p=t.getMetadata(e);if(X(t,p,e))return 1===(null==p?void 0:p.defaultAggregate)}}if(!n&&1===(null==(p=t.getMetadata(e))?void 0:p.defaultAggregate))return!0;return n&&n.kind!==j.VisualDataRoleKind.Measure},R.prototype.getPreferredAggregate=function(e,t,i){if(this.isRoleOrExprLatLong(e,t,i))return 1},R.prototype.isRoleOrExprLatLong=function(e,t,i){var r=j.visualCapabilitiesHelperModuleFactory().isValueTypeDescriptorLatLong;if(i){i=i.preferredTypes;if(r(_.isEmpty(i)?void 0:i[0]))return!0}e=t.getMetadata(e);return!!r(e?e.type:void 0)},R.prototype.canHierarchyLevelJoinExistingGroup=function(e,t,i,r,n){var a=t&&t.projections[i];if(V.isHierarchyLevel(r)&&a&&0<a.all().length){var o=r,r=a.all(),a=A.expandExpr(e,o.arg),e=_.isNumber(n)?n-1:r.length-1;if(0<=e&&A.areHierarchyLevelsOrdered(a,t.tryGetExpr(i,e),o))return!0;if(_.isNumber(n)&&n<r.length&&A.areHierarchyLevelsOrdered(a,o,t.tryGetExpr(i,n)))return!0}return!1},R.prototype.addHierarchyLevelToExistingHierarchiesInVisual=function(e,t,i,r){var n=!1,r=m.getOptionsToAddHierarchyLevelToExistingHierarchies(e,t,i.singleVisual.query,r);if(r)for(var a=0,o=r;a<o.length;a++)var s=o[a],n=this.core.add(s,i,!1)||n;return n},R.prototype.resetSearchProperties=function(e){var t,i=I.getObjectDefinitions(e);i&&(t=I.getVisualCapabilities(e,this.visualPluginService),(e=this.filterGenerator.tryGetSelfFilterEnabledProperty(t))&&C.deleteProperty(i,e.objectName,null,e.propertyName),(t=this.filterGenerator.tryGetSelfFilterProperty(t))&&C.deleteProperty(i,t.objectName,null,t.propertyName))},R.prototype.logReportMeasureMoveTelemetry=function(e,t,i,r,n){var a;i!==r&&(!(a=n&&n.getTargetEntity())||a.schema!==y.ExplorationSchemaName||(e=n.getConceptualProperty(e))&&(i=this.getVisualDataRole(t,i),r=this.getVisualDataRole(t,r),(i=JSON.stringify(i.requiredTypes))!==(r=JSON.stringify(r.requiredTypes))&&this.telemetry.logEvent(j.telemetry.EXReportMeasureMoveRoleKind,{dataType:j.PrimitiveTypeNames[e.type.primitiveType],sourceTypes:i,targetTypes:r})))},R.prototype.setVisualDrillFilterOtherVisualsSetting=function(e,t){e.drillFilterOtherVisuals!==t&&(e.drillFilterOtherVisuals=t,this.eventBridge.publishToChannel(g.visualDrillFilterOtherVisualsSettingChanged,{visualContainer:e,on:t}))},R.prototype.customizeConvertTo=function(e,t){var e=e.config.singleVisual,i=this.visualPluginService.getCustomizeConvertTo(e.visualType,t);if(i&&i.objects){var r,n=e.objects,a=e.mobileObjects,o=this.visualPluginService.capabilities(e.visualType),s=this.visualPluginService.capabilities(t);for(r in i.objects){var l,u=i.objects[r],c=s.objects[r];for(l in u){var p=u[l],d=c.properties[l],d=d.type;this.customizeConvertProperty(n,o,p,d,{objectName:r,propertyName:l}),a&&this.customizeConvertProperty(a,o,p,d,{objectName:r,propertyName:l})}}}},R.prototype.customizeConvertProperty=function(e,t,i,r,n){var a,o=[];if(i.transformArgs)for(var s=0,l=i.transformArgs;s<l.length;s++){var u=l[s],c=u.identifier,p=c.objectName,c=c.propertyName,u=this.getVisualObjectPropertyDefinition(e,u.identifier,u.selector),p=t.objects[p].properties[c].type,c=void 0;p.fill&&p.fill.solid?c=u&&u.solid&&u.solid.color:u instanceof V&&(c=u),o.push(c)}var d,h=n.objectName,g=n.propertyName,v=(i.transform||_.identity).apply(void 0,o),m=r;v?r.fill&&r.fill.solid?(V.isConstantText(v)||V.isThemeDataColor(v),a={solid:{color:v}}):(m.bool||m.numeric||m.integer||m.text||m.enumeration)&&(m.bool&&V.isConstantBoolean(v),(m.numeric||m.integer)&&V.isConstantNumeric(v),(m.text||m.enumeration)&&V.isConstantText(v),a=v):a=void 0,void 0!==a?(d=this.getOrCreateDataViewObjectDefinition(e,n,i.targetSelector)).properties[g]=a:(d=this.getDataViewObjectDefinition(e[h],i.targetSelector))&&d.properties[g]&&delete d.properties[g]},R.prototype.getVisualObjectPropertyDefinition=function(e,t,i){var r=t.objectName,t=t.propertyName,r=e[r]||[],i=this.getDataViewObjectDefinition(r,i);return i&&i.properties[t]},R.prototype.getOrCreateDataViewObjectDefinition=function(e,t,i){var r=t.objectName,t=e[r]=e[r]||[],t=this.getDataViewObjectDefinition(t,i);return t||e[r].push(t=void 0!==i?{properties:{},selector:i}:{properties:{}}),t},R.prototype.getDataViewObjectDefinition=function(e,t){return _.find(e,(function(e){return null==e.selector&&null==t||e.selector&&t&&e.selector.id===t.id}))},R.prototype.checkSparklineRemovedAndLog=function(e,t,i){var r;if(t.expr?r=jsCommon.ArrayExtensions.ensureArray(t.expr):(t=t).role&&null!=t.projOptions.fieldIndex&&(e=e.tryGetExprs(t.role),_.isEmpty(e)||(r=e.slice(t.projOptions.fieldIndex,t.projOptions.fieldIndex+(null!==(t=t.count)&&void 0!==t?t:1)))),!_.isEmpty(r))for(var n=0,a=r;n<a.length;n++){var o=a[n];V.isSparklineData(o)&&this.logSparklineEvent(o,i)}},R.prototype.logSparklineEvent=function(e,t){e=d.SparklinesUtil.getFieldCharacteristics(e,t),t=e.groupingType,e=e.measureType;this.telemetry.logEvent(j.telemetry.SparklinesDelete,{groupingType:t,measureType:e})},R.prototype.isVisualRecommendationAllowed=function(e){return this.featureSwitchService.featureSwitches.onObject&&I.isVisualTypeAutoSelect(e)},R);function R(e,t,i,r,n,a,o,s,l,u,c,p,d,h,g,v,m,f,y,C,S,b,E,V,w,x,P){var F=this;this.visualPluginService=e,this.pluginOps=t,this.displayNameService=i,this.contextActivityService=r,this.telemetry=n,this.explorationNavigationService=a,this.selectionService=o,this.geotaggingAnalyzerService=s,this.explorationSerializer=l,this.eventBridge=u,this.featureSwitchService=c,this.sortService=p,this.visualRelationshipService=d,this.drill=h,this.expandCollapse=g,this.filterGenerator=v,this.aggrOps=m,this.resourceRegistration=f,this.formFactorProvider=y,this.localizationService=C,this.viewModeState=S,this.linguisticSchemaProxy=b,this.explorationCapabilities=E,this.layoutAuthoring=V,this.runningVisualService=w,this.visualAuthoringCustomizeOperations=x,this.settingsService=P,this.updateFilterState=function(e,t,i,r,n,a){a=F.core.updateFilterState(e,t,i,r,n,a);a.clearOrDefault?F.notifyVisualContainers([t],"UserAction_ChangeFilter",!0,e):F.notifyVisualContainers([t],"UserAction_ChangeFilter",a.updateAll,e)},this.core=z.services.createVisualAuthoringCore(e,s,m,c,x)}var e,i=(e=j.data.SQExprRewriter,__extends(L,e),L.prototype.visitScopedEval=function(e){return new t(e.expression,[])},L);function L(){return null!==e&&e.apply(this,arguments)||this}function B(e,t,i,r){var n=e.getMetadata(t);if(n&&n.type.geography)return u.map.name;var a=x.asFieldPattern(e);if(i&&a){var o=a.column||a.groupingColumn,s=o&&o.name,l=a.hierarchyLevel&&a.hierarchyLevel||a.columnHierarchyLevelVariation&&a.columnHierarchyLevelVariation.level;if(l){o=l.level;if(i.isGeographic(o))return u.map.name;o=A.getConceptualHierarchyLevel(t,l.schema,l.entity,l.name,o),s=o&&o.column&&o.column.name}if(s&&i.isGeographic(s))return u.map.name}a=a.column,a=a&&t.schema(a.schema).findProperty(a.entity,a.name).column;return(F.getWhatIfParameterMetadata(a)&&1===a.defaultAggregate?u.slicer:X(e,n,t)&&1!==n.defaultAggregate?u.clusteredColumnChart:r&&r.pivotTableVisualEnabled?u.tableEx:u.table).name}function k(e,t,i,r){i=_.filter(i.filters,(function(e){return 5===e.howCreated}));e.logChildEvent(r&&r.event,j.telemetry.EXDrillthroughFilterUpdate,{type:t,countOfCurrentPageDrillthroughFilters:i.length})}function X(e,t,i){return!!t&&(1===t.kind||t.type.numeric&&!F.discourageAggregation(e,i))}function G(e){var t;switch(t=e?e.kind:t){case 0:return"Entity";case 2:return"ColumnRef";case 3:return"MeasureRef";case 4:return"Aggregation";case 5:return"PropertyVariationSource";case 6:return"Hierarchy";case 7:return"HierarchyLevel";default:return"Other"}}function H(e){switch(e){case c.Advanced:return"Advanced";case c.Categorical:return"Categorical";case c.Passthrough:return"Passthrough";case c.Range:return"Range";case c.Visual:return"Visual"}}function U(e){switch(e){case 2:return"Exploration";case 1:return"Section";case 0:return"Visual"}}d.getVisualDefaultType=B,d.logDrillthroughFilterUpdateTelemetry=k,d.isNumericMeasure=X,d.getTelemetryFieldKind=G,d.getTelemetryFilterType=H,d.getTelemetryFilterScopeType=U,d.getTelemetryViewMode=function(e){switch(e){case 0:return"View";case 1:return"Edit"}},d.getTelemetryFilterCardSortType=function(e){switch(e){case 1:return"Ascending";case 2:return"Descending";case 3:return"Custom"}}})((z=j.explore||(j.explore={})).util||(z.util={}))})(powerbi=powerbi||{}),(function(c){var e,p,d;function h(e,t,i,r,n,a){var o;e&&t&&((o=e.getAdapter())&&r&&o.update({viewport:t,suppressAnimations:!0,dataViews:e.getDataViews(),type:i,resizeMode:a,viewMode:r.getViewMode(),editMode:n}))}function g(e){var t=e.warnings,i=e.dataBoundObjectWarnings,r=t?_.cloneDeep(t):{};if(!_.isEmpty(i))for(var n in r.visualObjectWarnings||(r.visualObjectWarnings={}),i){var a=r.visualObjectWarnings[n];a?a.push.apply(a,i[n]||[]):r.visualObjectWarnings[n]=i[n]}return r}function v(e,t,i,r){if(_.isArray(t)){var n=_.filter(t,(function(e){return!(e instanceof d)}));if(_.isEmpty(n)){e.dataBoundObjectWarnings||(e.dataBoundObjectWarnings={});for(var a=0,o=_.filter(t,(function(e){return e instanceof d}));a<o.length;a++){var s,l=o[a],u=l.propertyId.objectName;i&&p.objectIsHidden(u,i,r)||(s={selector:l.selector,warnings:[l]},(l=e.dataBoundObjectWarnings[u])?l.push(s):e.dataBoundObjectWarnings[u]=[s])}}else n.length,t.length,e.warnings={warnings:n}}else e.warnings=t}e=(e=(e=c.explore||(c.explore={})).util||(e.util={})).VisualContainerUtils||(e.VisualContainerUtils={}),p=c.explore.util.CanvasVisualsUtility,d=c.data.DataBoundExprWarning,e.updateVisual=h,e.wrapRunningVisual=function(r,i,n,a,t,o,s,e,l){var u={getType:function(){return r.type},setType:function(e){return r.type=e},getViewport:function(){return r.viewport},setViewport:function(e,t){r.viewport=e,t&&h(u,e,c.VisualUpdateType.Resize,i,n)},getData:function(){return r.data},getAdapter:function(){return r.visual},getDataViews:function(){return r.dataViews},setDataViews:function(e){return r.dataViews=e},getDataTransforms:function(){return r.dataTransforms},setThemeCollection:function(e){return r.themeCollection=e},getIsInFocus:function(){return r.isInFocus},setIsInFocus:function(e){return r.isInFocus=e},setData:function(e,t,i){r.data=e,r.dataAppliedEvent&&(r.dataAppliedEvent.reject(),r.dataAppliedEvent=void 0),r.performanceActivity&&(r.performanceActivity.cancel(!0),r.performanceActivity=void 0),r.dataAppliedEvent=t,r.performanceActivity=i},setDataTransforms:function(e){return r.dataTransforms=e},setPendingSelection:function(e){return r.pendingSelection=e},hasPendingSelection:function(){return!!r.pendingSelection},setAdditionalObjectUpdates:function(e){return r.additionalObjectUpdates=e},setIsDisabled:function(e){return r.isDisabled=e},getIsDisabled:function(){return r.isDisabled},setIsDisabledIfUncertified:function(e){return r.isDisabledIfUncertified=e},getIsDisabledIfUncertified:function(){return r.isDisabledIfUncertified},setReportId:function(e){return r.reportId=e},getErrorInfo:function(){return r.errorInfo},setErrorInfo:function(e){return r.errorInfo=e},getWarnings:function(){return g(r)},setWarnings:function(e,t,i){return v(r,e,t,i)},getDataBoundObjectWarnings:function(){return r.dataBoundObjectWarnings},resetWarnings:function(e){(e=void 0===e?!1:e)&&(r.dataBoundObjectWarnings={}),r.warnings=void 0},getSelectedDatapoints:function(){return r.selectedDatapoints},setSelectedDatapoints:function(e,t){return (function(e,t,i,r,n){var a=e.visual;t.pendingSelection||e.pendingSelection,r&&(a&&a.visualHasMethod&&a.visualHasMethod("onRestoreSelection")?a.onRestoreSelection({selection:i}):(v(e,[new c.visuals.OnRestoreSelectionNotSupportedWarning]),n&&n(g(e))));e.selectedDatapoints=i})(r,a,e,t,s)},clearSelectedDatapoints:function(){r.selectedDatapoints=void 0;var e=r.visual;e&&e.onClearSelection&&e.onClearSelection(),t.selectDataPoint(o,[],void 0,void 0,1)},getSubSelectionStyles:function(e){if(l){var t=l.getSubSelectionStyles(e);if(t)return t}return r.visual&&r.visual.getSubSelectionStyles&&r.visual.getSubSelectionStyles(e)},getSubSelectionShortcuts:function(e){if(l){var t=l.getSubSelectionShortcuts(e);if(t)return t}return r.visual&&r.visual.getSubSelectionStyles&&r.visual.getSubSelectionShortcuts(e)}};return e&&(u.sortServices=e),u}})(powerbi=powerbi||{}),(function(e){(e=(e=(e=e.explore||(e.explore={})).util||(e.util={})).VisualHostServicesUtil||(e.VisualHostServicesUtil={})).createQueryVisualHostServices=function(){return{getFilters:function(){return{dataFilter:null,dataFiltersUnmerged:null}},getDataSourceVariables:function(){},getVisualRelationshipFilterAction:function(){return 0},selectDataPoint:_.noop,setVisualRelationshipFilterAction:_.noop}},e.createVisualHostDecompositionService=function(r,n){return{clearAILevels:function(e){return n.clearAILevels(r,e)},isDecompositionAnalysisSupported:function(){return n.isDecompositionAnalysisSupported(r)},isSupported:function(){return n.isSupported()},isTopNPerLevelSupported:function(){return n.isTopNPerLevelSupported()},removeLevel:function(e){return n.removeLevel(r,e)},addLevelAndExpandNode:function(e,t){return n.addLevelAndExpandNode(r,e,t)},addAILevelAndExpandNode:function(e,t,i){return n.addAILevelAndExpandNode(r,e,t,i)},updateLevel:function(e,t){return n.updateLevel(r,e,t)},updateAILevel:function(e,t){return n.updateAILevel(r,e,t)},toggleLockedLevels:function(e){return n.toggleLockedLevels(r,e)},toggleNode:function(e){return n.toggleNode(r,e)}}}})(powerbi=powerbi||{}),(function(c){var e,t,u,p,d,h,g,v,m,f,y,C,S;function b(e){if(e&&e.solid)return e.solid.color}function E(e,t,i,r,n,a){var o=c.DataViewObject.getValue(e,"bold"),s=c.DataViewObject.getValue(e,"italic"),l=c.DataViewObject.getValue(e,"underline"),u={size:"fontSize",family:"fontFamily"};o&&(u.bold="bold"),s&&(u.italic="italic"),l&&(u.underline="underline");n=t?d.createFromObjectOrStyle(e,u,void 0,r,void 0,"label",n):d.createFromDataViewObject(e,u,void 0,void 0,n),a=d.inherit(n,{color:a});return i&&(a=d.inherit(a,{size:h.createFromPt(g)})),d.flatten(a)}e=c.explore||(c.explore={}),e=(t=e.util||(e.util={})).VisualTooltipStyleUtils||(t.VisualTooltipStyleUtils={}),u=c.visuals.ColorHelper,p=c.visuals.DefaultDataItemTooltipStyle,t=c.visuals.Font,d=c.visuals.FontProperties,h=c.visuals.Units.FontSize,g=11,v={size:p.titleFontProperties.size,family:p.titleFontProperties.family},m={size:p.valueFontProperties.size,family:p.valueFontProperties.family},f={size:p.titleFontProperties.size,family:t.Family.regular.css},y=p.titleFontProperties.color,C=p.valueFontProperties.color,S=p.background.solid.color,p.actionFontProperties.color,t="#252423",e.DefaultDataItemEnhancedTooltipStyle={titleFontProperties:{color:t,family:v.family,size:v.size,weight:p.titleFontProperties.weight},valueFontProperties:{color:t,family:m.family,size:m.size,weight:p.valueFontProperties.weight},actionFontProperties:{color:t,family:f.family,size:f.size},hoverColor:"#C8C6C4",dividerColor:"#C8C6C4",background:{solid:{color:"#FFFFFF"}},transparency:0},e.getVisualTooltipStyles=function(e,t,i,r){var n,a=(l=(function(e,t,i){var r,n,a,o,s=!(!e||!(e.titleFontColor||e.valueFontColor||e.background));t&&!s?(r=b(e&&e.themedTitleFontColor)||u.getThemeColor(i,c.visuals.ForegroundColorName),n=b(e&&e.themedValueFontColor)||u.getThemeColor(i,c.visuals.ForegroundColorName),a=b(e&&e.themedBackground)||u.getThemeColor(i,c.visuals.BackgroundColorName),o=b(e&&e.actionFontColor)||u.getThemeColor(i,c.visuals.ForegroundColorName)):t&&s?(r=b(e&&e.themedTitleFontColor)||b(e&&e.titleFontColor)||y,n=b(e&&e.themedValueFontColor)||b(e&&e.valueFontColor)||C,a=b(e&&e.themedBackground)||b(e&&e.background)||S,o=b(e&&e.actionFontColor)||r):(r=b(e&&e.titleFontColor)||y,n=b(e&&e.valueFontColor)||C,a=b(e&&e.background)||S);return{actionFontColor:o,backgroundColor:a,titleFontColor:r,valueFontColor:n}})(r,t,e)).actionFontColor,o=l.backgroundColor,s=l.titleFontColor,l=l.valueFontColor,s=E(r,t,i,e,v,s),l=E(r,t,i,e,m,l),a=a?E(r,t,i,e,f,a):void 0;return{titleFontProperties:s,valueFontProperties:l,actionFontProperties:a,discoverabilityFontProperties:n=t?_.clone(a):n,background:{solid:{color:o}},transparency:r&&null!=r.transparency?r.transparency:t?0:p.transparency,hoverColor:u.getThemeColor(e,c.visuals.BackgroundNeutralName),dividerColor:u.getThemeColor(e,c.visuals.BackgroundNeutralName)}}})(powerbi=powerbi||{}),(function(e){(e=(e=e.explore||(e.explore={})).constants||(e.constants={})).scrollCarouselToEndEventName="scrollCarouselToEnd",e.pinVisualContainerEventName="pinVisualContainer",e.trustedVisualConsentStateChangedEventName="trustedVisualConsentStateChanged",e.invalidVisualContainerId=-1,e.updateNavButtonEvent="updateNavButtonEvent",e.ConnectionSetupLimit=4,e.smallFontSizeInPoint=9,e.MaxGroupingDepth=20,(e=e.ExploreCanvasConstants||(e.ExploreCanvasConstants={})).AutoLayoutVisualPadding=10,e.AutoLayoutVisualVCHeader=20,e.AutoLayoutVisualSkittlesRightPadding=30,e.AutoLayoutMaxSpaceHeight=300,e.AutoLayoutMaxSpaceWidth=300,e.AutoLayoutMinSpaceHeight=150,e.AutoLayoutMinSpaceWidth=150,e.ResponsiveLayoutMaxWidthBreakpoint=500,e.ScrollbarOffset=15,e.DefaultCanvasUiScale={x:1,y:1},e.DisplayAreaHeightAdditionMinimumScale=.9,e.DisplayAreaHeightScaleAddtion=.02,e.DisplayAreaOverflowEpsilonPx=8,e.DisplayAreaOutlineSize=8,e.DisplayAreaTransparencyOutlineThreshold=50,e.FieldListShimmeringBarHeight=24,e.PhoneAuthoringViewportHeight=558,e.PhoneAuthoringViewportWidth=324,e.PhonePortraitColumnCount=18,e.PhonePortraitRowCount=180,e.PhonePortraitCanvasHeight=3600})(powerbi=powerbi||{}),(function(e){((e=e.explore||(e.explore={})).modules||(e.modules={})).ExploreUIShellModule={name:"powerbi.exploreUIShell",dependency:{javascript:"ExploreUIShell/module",css:["exploreUIShell"]}}})(powerbi=powerbi||{}),(function(p){var e,t,i,d,s;function r(e,t){var i,r,n,a={color:d.color(t.minColor,"minColor")},o=t.minValue;null!=o&&(i=d.double(o)),t.diverging&&(n={color:d.color(t.midColor,"midColor")},null!=(c=t.midValue)&&(r=d.double(c)));var s,l={color:d.color(t.maxColor,"maxColor")},u=t.maxValue;null!=u&&(s=d.double(u));var o=t.nullStrategy,c=t.nullColor,u={},l=t.diverging?u.linearGradient3={min:a,mid:n,max:l}:u.linearGradient2={min:a,max:l};return i&&(l.min.value=i),r&&(l.mid.value=r),s&&(l.max.value=s),o&&(l.nullColoringStrategy={strategy:d.text(o)},o===p.NullStrategy.specificColor&&(l.nullColoringStrategy.color=d.color(c,"nullColor"))),d.fillRule(e,u)}function n(e,t,i,r,n){var a,o;return 0<t&&(a=d.compare(2,e,s.overRangeOf(e,t/100))),i<100&&(o=d.compare(r?4:3,e,s.overRangeOf(e,i/100))),{condition:a&&o?d.and(a,o):a||o,value:n}}e=(e=p.explore||(p.explore={})).util||(e.util={}),i=p.visuals.GradientUtils,d=p.data.SQExprBuilder,s=p.data.SQRangePercentExpr,(t=e.ConditionalFormattingUtil||(e.ConditionalFormattingUtil={})).createDefaultGradientFillDefinition=function(e){return{solid:{color:r(e,i.getDefaultGradientSettings())}}},t.createFillExpression=r,t.createDefaultConditionalFillDefinition=function(e,t){return t={condition:d.compare(3,e,d.double(0)),value:d.text(t)},{solid:{color:d.conditional([t])}}},t.DefaultIconId="CircleHigh",t.DefaultIconLayout="Before",t.DefaultIconVerticalAlignment="Top",t.createDefaultIconDefinition=function(e){return{kind:"Icon",value:d.conditional([n(e,67,100,!0,d.text("CircleHigh")),n(e,33,67,!1,d.text("SignMedium")),n(e,0,33,!1,d.text("SignLow"))]),layout:d.text(t.DefaultIconLayout),verticalAlignment:d.text(t.DefaultIconVerticalAlignment)}},t.createIconPercentCase=n,t.createIconNumberCase=function(e,t,i,r,n){var a,o;return null!==t&&(a=d.compare(2,e,d.double(t))),null!==i&&(o=d.compare(r?4:3,e,d.double(i))),{condition:a&&o?d.and(a,o):a||o,value:n}}})(powerbi=powerbi||{}),(function(e){((e=e.explore||(e.explore={})).htmlTemplate||(e.htmlTemplate={})).put=function(e){e.put("components/dateTimePicker/dateTimePicker.html",'<div class="datetimePicker" pbi-lazy-load-contents="$ctrl.moduleConfig"> <input type="text" aria-labelledby="{{ $ctrl.labelId }}" class="inputFieldInSlice" ng-blur="$ctrl.dateTextUpdated()" ng-model="$ctrl.textVal" ng-class="{\'ng-invalid\': $ctrl.inputInvalid}" placeholder="{{::$ctrl.placeholder}}"/> <button class="calendar" type="button" ng-attr-title="{{$ctrl.calendarButtonText}}" dropdown-overlay-invoke="{{$ctrl.id}}"><svg-use-symbol sheet="filterPaneIcons" symbol-id="fieldListEntity"></svg-use-symbol></button><dropdown-overlay class="calendarDropDown" dropdown-overlay-name="{{$ctrl.id}}"><datepicker class="calendar" ng-model="$ctrl.dateVal" ng-change="$ctrl.dateSelected()" onclick="event.stopPropagation()" show-weeks="false" min-date="$ctrl.validators.min" max-date="$ctrl.validators.max"></datepicker></dropdown-overlay></div>'),e.put("views/canvasVisualHeaderIcon.html",'<button tooltip tooltip-config="$ctrl.tooltipConfigManager.getTooltipConfig()" ng-disabled="!$ctrl.isClickable()" ng-switch="$ctrl.iconType"><i class="infoIcon glyphicon {{$ctrl.useStylableHeader() ? \'pbi-glyph-info-nocircle\' : \'pbi-glyph-info\'}}" ng-switch-when="info"></i><i class="warningIcon pbi-glyph-warning glyphicon" ng-switch-when="warning"></i><i class="errorIcon pbi-glyph-error glyphicon" ng-switch-when="error"></i></button>')}})(powerbi=powerbi||{}),(function(n){!(function(e){var t=n.explore.htmlTemplate.put;function i(){r||(n.common.initializeAngularModule(),n.visualHost.initializeAngularModule(),angular.module("powerbi.explore.controllers",[]),angular.module("powerbi.explore.directives",[]),angular.module("powerbi.explore.components",[]),angular.module("powerbi.explore",["powerbi.common","powerbi.explore.controllers","powerbi.explore.directives","powerbi.explore.components","powerbi.visualHost"]).run(["lazyScopedFactories",function(e){}]).run(["$templateCache",t]),r=!0)}e.initializeAngularModule=i;var r=!1;i(),e.registerBuildingBlocksForHost=function(e){var t=[{name:"DateTimePicker",blockType:2,consumerHostFlags:8203,factory:n.explore.components.DateTimePicker}];n.common.registerBuildingBlocksForHost(e,t,{componentsTarget:"powerbi.explore.components",directivesTarget:"powerbi.explore.directives"})}})(n.explore||(n.explore={}))})(powerbi=powerbi||{}),(function(i){!(function(e){function t(e,t){void 0===t&&(t=!1),this.localizationService=e,this.showIcons=t,this.allCommands=[]}e=e.components||(e.components={}),t.prototype.getItems=function(){return this.menuItems},t.prototype.getCommandByIndex=function(e){return this.allCommands[e]},t.prototype.createItems=function(r){return __awaiter(this,void 0,i.Promise,(function(){var t,i;return __generator(this,(function(e){switch(e.label){case 0:return t=[],[4,this.createMenuItemsFromCommands(r,t)];case 1:return(i=e.sent(),_.isEmpty(i))?[2,this.createNoAvailableActionsMenu()]:(this.allCommands=t,[2,{items:i}])}}))}))},t.prototype.createNoAvailableActionsMenu=function(){var e=[],t=this.localizationService.get("VisualContainer_ContextMenu_NoAvailableActions"),t=this.createMenuItem(null,t,null);return t.disabled=!0,e.push(t),{items:e}},t.prototype.createMenuItemsFromCommands=function(p,d){return void 0===d&&(d=[]),__awaiter(this,void 0,i.Promise,(function(){var t,i,r,n,a,o,s,l,u,c;return __generator(this,(function(e){switch(e.label){case 0:if(_.isEmpty(p))return[2];t=[],i=0,r=p,e.label=1;case 1:return i<r.length?[4,(n=r[i]).isVisible()]:[3,11];case 2:return e.sent()?(1===n.separatorPosition&&(t.length,t[t.length-1].type,c=this.createItemSeparator(),t.push(c)),o=a=void 0,n.getToolTip?[4,n.getToolTip(this.localizationService)]:[3,4]):[3,10];case 3:o=e.sent(),e.label=4;case 4:return(l=n.isDisabled)?[4,n.isDisabled()]:[3,6];case 5:l=e.sent(),e.label=6;case 6:return(s=l)?[3,9]:[4,n.getChildren()];case 7:return u=e.sent(),[4,this.createMenuItemsFromCommands(u,d)];case 8:a=e.sent(),e.label=9;case 9:d.push(n),u=this.createMenuItem(d.length-1,n.title(this.localizationService),s,a,n.glyph,n.selected,n.customIcon,o),t.push(u),2===n.separatorPosition&&(c=this.createItemSeparator(),t.push(c)),e.label=10;case 10:return i++,[3,1];case 11:return[2,t]}}))}))},t.prototype.createMenuItem=function(e,t,i,r,n,a,o,s){return{key:e,text:t,type:0,children:r,icon:n,selected:a,customIcon:o,showIcon:this.showIcons,disabled:i,tooltip:s}},t.prototype.createItemSeparator=function(){return{type:1,checked:!1}},e.VisualContainerContextMenu=t})(i.explore||(i.explore={}))})(powerbi=powerbi||{}),(function(t){var S;(function(C){C.createVisualContainerMenuFactoryService=function(e,t,i,r,n,a,o,s,l,u,c,p,d,h,g,v,m,f,y,C,S,b,E,V,w,x,P){return new F(e,t,i,r,n,s,l,u,a,c,y,p,d,h,o,S,v,C,f,g,m,b,E,V,w,x,P)};var F=(e.prototype.createDrillthroughCommands=function(e,t,i){var r=this.explorationExtensibility.getCommandsDisplayOptions(e.name);return new C.DrillthroughCommandCollection(e,t,"ModeOn",this.drill,this.explorationNavigation,this.lazyScoped,this.pluginOps,i,this.telemetryService,void 0,r)},e.prototype.createOptionsCommands=function(e,t,i){this.explorationNavigation.getCurrentExploration();var r=this.explorationNavigation.getCurrentExploration().settings,n=this.explorationExtensibility.getCommandsDisplayOptions(e.contract.name),t=__spreadArray([new C.AddCommentVisualCommand(e,this.eventBridge,t,n),new C.ShareToTeamsVisualCommand(e,this.visibility,this.eventBridge,t,n),new C.ToggleSearchCommand(e,this.filterGenerator,this.overlayService,this.undoRedo,this.visualAuthoring,this.visualPlugin,t,n),new C.EnterAdvancedEditModeCommand(e,this.eventBridge,this.overlayService,t,n),new C.ExportVisualDataCommand(e,this.conceptualSchemaProxy,this.dataSources,this.eventBridge,this.featureSwitchService,this.filterGenerator,this.overlayService,t,r,n),new C.SeeDataCommand(e.contract,this.drill,this.visibility,this.pluginOps,!0,this.viewModeState,n),new C.DeleteVisualContainerCommand(e,this.eventBridge,this.undoRedo,t,n),new C.GetClustersCommand(e,this.eventBridge,t,n),new C.ToggleSpotlightCommand(e,this.visibility,t,n),new C.GetInsightsCommand(e,t,this.lazyScoped,this.telemetryService,n)],this.getSortCommands(e,t,n));return this.getCustomCommands(t,1,e.contract,i,void 0,n)},e.prototype.getSortCommands=function(e,t,i){if(_.isEmpty(t.sortSetting.sortGroups))return[];var r=t.sortSetting.sortGroups;if(1===r.length&&r[0].isDefaultGroup){var n=r[0];return[new C.SortDescendingCommand(e,this.eventBridge,this.overlayService,t,n,i),new C.SortAscendingCommand(e,this.eventBridge,this.overlayService,t,n,i),new C.SortByCommandCollection(e,this.eventBridge,this.overlayService,t,i)]}for(var a=[],o=0,s=r;o<s.length;o++){var l=s[o],l=new C.GroupedSortByCommandCollection(e,this.eventBridge,this.overlayService,t,l,i);a.push(l)}return a},e.prototype.createNonQueryCommands=function(e){var t=this.explorationExtensibility.getCommandsDisplayOptions(e.name),i=this.explorationNavigation.getCurrentExploration().settings,i=[new C.VisualContainerGroupingCommandsCollection(e,this.selection,this.layoutAuthoring,this.viewModeState,i,t)];return this.featureSwitchService.featureSwitches.daxTransformEnabled&&i.push(new C.SummarizeVisualContainerCommand(this.explorationNavigation,this.pluginOps,this.selection,this.visualAuthoring,this.viewModeState,t,this.runningVisualService)),i},e.prototype.createCommands=function(d,h,g,v,m,f,y){return __awaiter(this,void 0,t.Promise,(function(){var t,i,r,n,a,o,s,l,u,c,p;return __generator(this,(function(e){switch(e.label){case 0:return!m||S.contracts.isVisualContainerGroup(d)?[2,this.createNonQueryCommands(d)]:(t=d,i=this.runningVisualService.getVisual(t),r=h.data,n=h.dataRoles,a=h.nodeIndex,o=h.position,s=[],l=this.explorationExtensibility.getCommandsDisplayOptions(t.name),u=this.explorationNavigation.getCurrentExploration().settings,[4,this.conceptualSchemaProxy.get(this.dataSources.get())]);case 1:return p=e.sent().schema(void 0),this.expandCollapse.isSupported(p&&p.capabilities,t,n)&&this.expandCollapse.isEnabled(t,n)&&(c=this.expandCollapse.getAllowedActions(t,n,r))&&(s.push(new C.ExpandCollapseCommandsCollection(c,!1,r,n,a,v,l)),s.push(new C.ExpandCollapseCommandsCollection(c,!0,r,n,a,v,l))),s.push(new C.DrillDownCommand(t,r,n,this.dataSources,this.drill,this.visualAuthoring,i,void 0,l),new C.DrillToDetailsCommand(t,r,this.drill,this.dataSources,this.drillToDetails,i,l),new C.SeeDataCommand(t,this.drill,this.visibility,this.pluginOps,void 0,this.viewModeState,l),new C.DrillDownLevelWithoutCurrentGroupCommand(t,n,this.visualAuthoring,this.drill,i,l),new C.DrillDownLevelWithCurrentGroupCommand(t,n,this.visualAuthoring,this.drill,i,l),new C.DrillUpCommand(t,r,n,this.drill,this.visualAuthoring,i,void 0,l),new C.CreateGroupCommand(t,r,this.conceptualSchemaProxy,this.dataSources,this.featureSwitchService,this.groupAuthoring,this.promiseFactory,l),new C.IncludeCommand(t,r,this.conceptualSchemaProxy,this.dataSources,this.featureSwitchService,this.includeExcludeService,this.promiseFactory,y,l),new C.ExcludeCommand(t,r,this.conceptualSchemaProxy,this.dataSources,this.featureSwitchService,this.includeExcludeService,this.promiseFactory,y,l),new C.DrillthroughCommandCollection(t,r,"ContextMenu",this.drill,this.explorationNavigation,this.lazyScoped,this.pluginOps,g,this.telemetryService,void 0,l),new C.InsightsAnalysisCommandsCollection(t,r,o,this.conceptualSchemaProxy,this.dataSources,this.eventBridge,this.explorationCapabilities,this.explorationNavigation,this.lazyScoped,this.viewModeState,g,void 0,l),new C.VisualContainerGroupingCommandsCollection(t,this.selection,this.layoutAuthoring,this.viewModeState,u,l),new C.ClearSelectionCommand(i,l)),this.featureSwitchService.featureSwitches.daxTransformEnabled&&s.push(new C.SummarizeVisualContainerCommand(this.explorationNavigation,this.pluginOps,this.selection,this.visualAuthoring,this.viewModeState,l,this.runningVisualService)),0<(p=new C.CopyCommandsCollection(t,this.clipboard,this.telemetryService,this.visibility,this.viewModeState,h,l)).commandsCount&&s.push(p),[2,this.getCustomCommands(s,0,t,r,f,l)]}}))}))},e.prototype.getCustomCommands=function(r,n,a,o,s,l){var e,u=this,c={};return null!==(e=this.explorationExtensibility.getGroups())&&void 0!==e&&e.forEach((function(e){c[e.name]=new C.ExtensionCommandsGroup(e.title,l,e.menuLocation)})),this.getCommandExtensions(a,n).forEach((function(e){var t=u.getCommandMenuExtension(e,n),i=new C.ExtensionCommand(a,o,e.name,t.title||e.title,u.eventBridge,u.explorationExtensibility,u.featureSwitchService,t.icon||e.icon,s,l),e=t.groupName&&c[t.groupName];e?(e.isEmpty&&(1===e.menuLocation?r.unshift(e):r.push(e)),e.addChild(i)):1===t.menuLocation?r.unshift(i):r.push(i)})),r},e.prototype.getCommandMenuExtension=function(e,t){var i=e&&e.extend;switch(t){case 0:return i&&i.visualContextMenu;case 1:return i&&i.visualOptionsMenu}},e.prototype.getCommandExtensions=function(t,e){var i=this,r=this.explorationExtensibility.getCommandExtensions()||[];switch(t&&(r=r.filter((function(e){return i.visualMenuShouldHaveCommand(t,e)}))),e){case 0:return r.filter((function(e){return e.extend&&e.extend.visualContextMenu}));case 1:return r.filter((function(e){return e.extend&&e.extend.visualOptionsMenu}))}},e.prototype.visualMenuShouldHaveCommand=function(t,e){return!e.visuals||e.visuals.some((function(e){return e===t.name}))},e);function e(e,t,i,r,n,a,o,s,l,u,c,p,d,h,g,v,m,f,y,C,S,b,E,V,w,x,P){this.conceptualSchemaProxy=e,this.clipboard=t,this.dataSources=i,this.drill=r,this.expandCollapse=n,this.eventBridge=a,this.explorationCapabilities=o,this.explorationNavigation=s,this.explorationExtensibility=l,this.featureSwitchService=u,this.filterGenerator=c,this.groupAuthoring=p,this.includeExcludeService=d,this.lazyScoped=h,this.drillToDetails=g,this.pluginOps=v,this.promiseFactory=m,this.telemetryService=f,this.viewModeState=y,this.visibility=C,this.visualAuthoring=S,this.overlayService=b,this.undoRedo=E,this.visualPlugin=V,this.selection=w,this.layoutAuthoring=x,this.runningVisualService=P}})((S=t.explore||(t.explore={})).services||(S.services={}))})(powerbi=powerbi||{}),(function(i){!(function(e){function t(e,t,i,r,n,a,o){this.defaultTitleKey=e,this.selectors=t,this.glyph=i,this.commandDisplayOption=r,this.selected=n,this.customIcon=a,this.separatorPosition=o,_.isEmpty(t)||_.some(t,(function(e){return _.isEmpty(e)})),this.selectors=_.compact(t)}e=e.services||(e.services={}),t.prototype.title=function(e){return e&&this.defaultTitleKey?e.get(this.defaultTitleKey):this.defaultTitleKey},t.prototype.execute=function(){return __awaiter(this,void 0,i.Promise,(function(){return __generator(this,(function(e){return[2]}))}))},t.prototype.isVisible=function(){return __awaiter(this,void 0,i.Promise,(function(){return __generator(this,(function(e){return[2,2!==this.commandDisplayOption]}))}))},t.prototype.isDisabled=function(){return __awaiter(this,void 0,i.Promise,(function(){return __generator(this,(function(e){return[2,1===this.commandDisplayOption]}))}))},t.prototype.getChildren=function(){return __awaiter(this,void 0,i.Promise,(function(){return __generator(this,(function(e){return[2,null]}))}))},t.prototype.getTelemetryInfo=function(){return this.defaultTitleKey},t.prototype.announceSelectionState=function(e,t){e&&(t=e.getLocalizedString(this.getSelectionStateStringKey(t)),e.alertScreenReader(t))},t.prototype.getSelectionStateStringKey=function(e){return e?"FieldListProperty_Selected":"FieldListProperty_Unselected"},e.VisualContainerMenuCommand=t})(i.explore||(i.explore={}))})(powerbi=powerbi||{}),(function(Pe){var Fe;(function(n){var u,a=jsCommon.EnumExtensions,r=Pe.data.Selector,o=Pe.explore.util.VisualContainerUtils,e=(u=n.VisualContainerMenuCommand,__extends(t,u),t.prototype.execute=function(){return __awaiter(this,void 0,Pe.Promise,(function(){return __generator(this,(function(e){return _.isEmpty(this.selectors)||(this.dataSources,this.visualAuthoring,this.visualAuthoring.drillDown(this.selectors,this.visualContainer,this.dataSources.get(),_.head(this.roles))),[2]}))}))},t.prototype.isVisible=function(){return __awaiter(this,void 0,Pe.Promise,(function(){var t,i,r;return __generator(this,(function(e){switch(e.label){case 0:return(t=_.isEmpty(this.selectors))?[3,2]:[4,u.prototype.isVisible.call(this)];case 1:t=!e.sent(),e.label=2;case 2:return t?[2,!1]:(r=this.drill.getSupportedDrillDirections(this.visualContainer,_.head(this.roles)),i=a.hasFlag(r,4),r=a.hasFlag(r,2),[2,i||r])}}))}))},t.prototype.isDisabled=function(){var i;return __awaiter(this,void 0,Pe.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return t=!(null===(i=this.runningVisual)||void 0===i||!i.getErrorInfo()),(t=t)?[3,2]:[4,u.prototype.isDisabled.call(this)];case 1:t=e.sent(),e.label=2;case 2:return[2,t]}}))}))},t);function t(e,t,i,r,n,a,o,s,l){l=u.call(this,s||"DrillDown",t,"pbi-glyph-drilldowndisabled",l&&l.drill)||this;return l.visualContainer=e,l.roles=i,l.dataSources=r,l.drill=n,l.visualAuthoring=a,l.runningVisual=o,l}n.DrillDownCommand=e;var l,i=(l=n.VisualContainerMenuCommand,__extends(s,l),s.prototype.execute=function(){return __awaiter(this,void 0,Pe.Promise,(function(){return __generator(this,(function(e){return this.visualAuthoring,this.visualAuthoring.drillUp(_.head(this.roles),this.visualContainer),[2]}))}))},s.prototype.isVisible=function(){return __awaiter(this,void 0,Pe.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return[4,l.prototype.isVisible.call(this)];case 1:return e.sent()?(t=this.drill.getSupportedDrillDirections(this.visualContainer,_.head(this.roles)),[2,a.hasFlag(t,1)]):[2,!1]}}))}))},s.prototype.isDisabled=function(){var i;return __awaiter(this,void 0,Pe.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return t=!(null===(i=this.runningVisual)||void 0===i||!i.getErrorInfo()),(t=t)?[3,2]:[4,l.prototype.isDisabled.call(this)];case 1:t=e.sent(),e.label=2;case 2:return[2,t]}}))}))},s);function s(e,t,i,r,n,a,o,s){s=l.call(this,o||"DrillUp",void 0,"pbi-glyph-drillup",s&&s.drill)||this;return s.visualContainer=e,s.roles=i,s.drill=r,s.visualAuthoring=n,s.runningVisual=a,s}n.DrillUpCommand=i;var c,e=(c=n.VisualContainerMenuCommand,__extends(p,c),p.prototype.execute=function(){return __awaiter(this,void 0,Pe.Promise,(function(){return __generator(this,(function(e){return this.visualAuthoring,this.visualAuthoring.drillDownLevel(_.head(this.roles),this.visualContainer,this.drillDirection),[2]}))}))},p.prototype.isDisabled=function(){var i;return __awaiter(this,void 0,Pe.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return t=!(null===(i=this.runningVisual)||void 0===i||!i.getErrorInfo()),(t=t)?[3,2]:[4,c.prototype.isDisabled.call(this)];case 1:t=e.sent(),e.label=2;case 2:return[2,t]}}))}))},p);function p(e,t,i,r,n,a,o){o=c.call(this,e,void 0,void 0,o&&o.drill)||this;return o.visualContainer=t,o.roles=i,o.drillDirection=r,o.visualAuthoring=n,o.runningVisual=a,o}n.DrillDownLevelCommand=e;var d,i=(__extends(h,d=e),h.prototype.isVisible=function(){return __awaiter(this,void 0,Pe.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return[4,d.prototype.isVisible.call(this)];case 1:return e.sent()?(t=this.drill.getSupportedDrillDirections(this.visualContainer,_.head(this.roles)),[2,a.hasFlag(t,4)]):[2,!1]}}))}))},h.prototype.isDisabled=function(){var i;return __awaiter(this,void 0,Pe.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return t=!(null===(i=this.runningVisual)||void 0===i||!i.getErrorInfo()),(t=t)?[3,2]:[4,d.prototype.isDisabled.call(this)];case 1:t=e.sent(),e.label=2;case 2:return[2,t]}}))}))},h);function h(e,t,i,r,n,a){a=d.call(this,"DrillDownLevel",e,t,3,i,n,a)||this;return a.drill=r,a.runningVisual=n,a}n.DrillDownLevelWithoutCurrentGroupCommand=i;var g,i=(__extends(v,g=e),v.prototype.isVisible=function(){return __awaiter(this,void 0,Pe.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return[4,g.prototype.isVisible.call(this)];case 1:return e.sent()?(t=this.drill.getSupportedDrillDirections(this.visualContainer,_.head(this.roles)),[2,a.hasFlag(t,2)]):[2,!1]}}))}))},v.prototype.isDisabled=function(){var i;return __awaiter(this,void 0,Pe.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return t=!(null===(i=this.runningVisual)||void 0===i||!i.getErrorInfo()),(t=t)?[3,2]:[4,g.prototype.isDisabled.call(this)];case 1:t=e.sent(),e.label=2;case 2:return[2,t]}}))}))},v);function v(e,t,i,r,n,a){a=g.call(this,"DrillDownLevelGrouped",e,t,2,i,n,a)||this;return a.drill=r,a.runningVisual=n,a}n.DrillDownLevelWithCurrentGroupCommand=i;var m,e=(m=n.VisualContainerMenuCommand,__extends(f,m),f.prototype.execute=function(){return __awaiter(this,void 0,Pe.Promise,(function(){var t;return __generator(this,(function(e){return _.isEmpty(this.selectors)||(this.dataSources,this.drillToDetails,t=this.dataSources.get(),this.drillToDetails.drillToDetails(this.selectors,this.visualContainer,t)),[2]}))}))},f.prototype.isVisible=function(){return __awaiter(this,void 0,Pe.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return(t=_.isEmpty(this.selectors))?[3,2]:[4,m.prototype.isVisible.call(this)];case 1:t=!e.sent(),e.label=2;case 2:return t?[2,!1]:[2,this.drill.canDrillToDetails(this.visualContainer,this.selectors)]}}))}))},f.prototype.isDisabled=function(){var i;return __awaiter(this,void 0,Pe.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return t=!(null===(i=this.runningVisual)||void 0===i||!i.getErrorInfo()),(t=t)?[3,2]:[4,m.prototype.isDisabled.call(this)];case 1:t=e.sent(),e.label=2;case 2:return[2,t]}}))}))},f);function f(e,t,i,r,n,a,o){o=m.call(this,"DataPointTable_Show",t,void 0,o&&o.drill)||this;return o.visualContainer=e,o.drill=i,o.dataSources=r,o.drillToDetails=n,o.runningVisual=a,o}n.DrillToDetailsCommand=e;var y,i=(y=n.VisualContainerMenuCommand,__extends(C,y),C.prototype.isDisabled=function(){return __awaiter(this,void 0,Pe.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return this.isCollapse?[4,y.prototype.isDisabled.call(this)]:[3,2];case 1:return[2,e.sent()||!(this.allowedActions.collapseHierarchy||this.allowedActions.collapseLevel||this.allowedActions.collapseNode)];case 2:return[4,y.prototype.isDisabled.call(this)];case 3:return[2,e.sent()||!(this.allowedActions.expandHierarchy||this.allowedActions.expandLevel||this.allowedActions.expandNode)]}}))}))},C.prototype.getChildren=function(){return __awaiter(this,void 0,Pe.Promise,(function(){return __generator(this,(function(e){return[2,this.childCommands]}))}))},C);function C(e,t,i,r,n,a,o){i=y.call(this,t?"Collapse":"Expand",i,void 0,o&&o.expandCollapse)||this;return i.allowedActions=e,i.isCollapse=t,i.roles=r,i.nodeIndex=n,i.childCommands=[new b(i.isCollapse,i.allowedActions,i.selectors,i.roles,i.nodeIndex,a,o),new w(i.isCollapse,i.allowedActions,i.selectors,i.roles,i.nodeIndex,a,o),new F(i.isCollapse,i.allowedActions,i.selectors,i.roles,i.nodeIndex,a,o)],i}n.ExpandCollapseCommandsCollection=i;var S,b=(S=n.VisualContainerMenuCommand,__extends(E,S),E.prototype.execute=function(){return __awaiter(this,void 0,Pe.Promise,(function(){return __generator(this,(function(e){return this.roles,this.selectors,this.handlers&&this.handlers.onSetNodeExpansionState,this.handlers.onSetNodeExpansionState({data:this.selectors[0],dataRoles:this.roles,isCollapse:this.isCollapse,nodeIndex:this.nodeIndex}),[2]}))}))},E.prototype.isDisabled=function(){return __awaiter(this,void 0,Pe.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,S.prototype.isDisabled.call(this)];case 1:return[2,e.sent()||(this.isCollapse?!this.allowedActions.collapseNode:!this.allowedActions.expandNode)]}}))}))},E);function E(e,t,i,r,n,a,o){o=S.call(this,"ExpandCollapseNode",i,void 0,o&&o.expandCollapse)||this;return o.isCollapse=e,o.allowedActions=t,o.roles=r,o.nodeIndex=n,o.handlers=a,o}n.ExpandCollapseNodeCommand=b;var V,w=(V=n.VisualContainerMenuCommand,__extends(x,V),x.prototype.execute=function(){return __awaiter(this,void 0,Pe.Promise,(function(){return __generator(this,(function(e){return this.roles,this.selectors,this.handlers&&this.handlers.onSetLevelExpansionState,this.handlers.onSetLevelExpansionState({data:this.selectors[0],dataRoles:this.roles,isCollapse:this.isCollapse,nodeIndex:this.nodeIndex}),[2]}))}))},x.prototype.isDisabled=function(){return __awaiter(this,void 0,Pe.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,V.prototype.isDisabled.call(this)];case 1:return[2,e.sent()||this.isCollapse?!this.allowedActions.collapseLevel:!this.allowedActions.expandLevel]}}))}))},x);function x(e,t,i,r,n,a,o){o=V.call(this,"ExpandCollapseLevel",i,void 0,o&&o.expandCollapse)||this;return o.isCollapse=e,o.allowedActions=t,o.roles=r,o.nodeIndex=n,o.handlers=a,o}n.ExpandCollapseLevelCommand=w;var P,F=(P=n.VisualContainerMenuCommand,__extends(A,P),A.prototype.execute=function(){return __awaiter(this,void 0,Pe.Promise,(function(){return __generator(this,(function(e){return this.roles,this.selectors,this.handlers&&this.handlers.onSetHierarchyExpansionState,this.handlers.onSetHierarchyExpansionState({data:this.selectors[0],dataRoles:this.roles,isCollapse:this.isCollapse,nodeIndex:this.nodeIndex}),[2]}))}))},A.prototype.isDisabled=function(){return __awaiter(this,void 0,Pe.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,P.prototype.isDisabled.call(this)];case 1:return[2,e.sent()||this.isCollapse?!this.allowedActions.collapseHierarchy:!this.allowedActions.expandHierarchy]}}))}))},A);function A(e,t,i,r,n,a,o){o=P.call(this,"All",i,void 0,o&&o.expandCollapse)||this;return o.isCollapse=e,o.allowedActions=t,o.roles=r,o.nodeIndex=n,o.handlers=a,o}n.ExpandCollapseHierarchyCommand=F;var T,e=(T=n.VisualContainerMenuCommand,__extends(D,T),D.prototype.isVisible=function(){return __awaiter(this,void 0,Pe.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return(t=!(this.explorationSettings&&this.explorationSettings.useStylableVisualContainerHeader))?[3,2]:[4,T.prototype.isVisible.call(this)];case 1:t=!e.sent(),e.label=2;case 2:return t?[2,!1]:[2,1===this.viewModeState.getMode()]}}))}))},D.prototype.isDisabled=function(){return __awaiter(this,void 0,Pe.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return t=Fe.contracts.isVisualContainerGroup(this.container)||!!this.container.parentGroup,(t=!n.selectionUtils.hasMultipleVisualContainerSelection(this.selection)&&!t)?[3,2]:[4,T.prototype.isDisabled.call(this)];case 1:t=e.sent(),e.label=2;case 2:return[2,t]}}))}))},D.prototype.getChildren=function(){return __awaiter(this,void 0,Pe.Promise,(function(){return __generator(this,(function(e){return[2,this.childCommands]}))}))},D);function D(e,t,i,r,n,a){var o=T.call(this,"Group_Action",void 0,void 0,a&&a.groupVisualContainers)||this;return o.container=e,o.selection=t,o.viewModeState=r,o.explorationSettings=n,o.childCommands=[new M(o.selection,i,a),new k(o.container,i,a),new R(o.selection,i,a)],o}n.VisualContainerGroupingCommandsCollection=e;var I,M=(I=n.VisualContainerMenuCommand,__extends(O,I),O.prototype.execute=function(){return __awaiter(this,void 0,Pe.Promise,(function(){return __generator(this,(function(e){return this.layoutAuthoring.groupCanvasItems(n.selectionUtils.getSelectedCanvasItems(this.selection)),[2]}))}))},O.prototype.isDisabled=function(){return __awaiter(this,void 0,Pe.Promise,(function(){var t,i,r;return __generator(this,(function(e){switch(e.label){case 0:return r=!1,1<(i=n.selectionUtils.getSelectedCanvasItems(this.selection)).length&&(t=i[0].parentGroup,r=_.every(i,(function(e){return e.parentGroup===t})),i=Fe.util.CanvasVisualsUtility.getContainerGroupDepth(i),r=r&&i<Fe.constants.MaxGroupingDepth),(r=!r)?[3,2]:[4,I.prototype.isDisabled.call(this)];case 1:r=e.sent(),e.label=2;case 2:return[2,r]}}))}))},O);function O(e,t,i){i=I.call(this,"Group_Action",void 0,void 0,i&&i.groupVisualContainers)||this;return i.selection=e,i.layoutAuthoring=t,i}n.GroupVisualContainerCommand=M;var N,R=(N=n.VisualContainerMenuCommand,__extends(L,N),L.prototype.execute=function(){return __awaiter(this,void 0,Pe.Promise,(function(){return __generator(this,(function(e){return this.layoutAuthoring.mergeCanvasItemContainers(n.selectionUtils.getSelectedCanvasItems(this.selection)),[2]}))}))},L.prototype.isDisabled=function(){return __awaiter(this,void 0,Pe.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return t=this.layoutAuthoring.canMergeCanvasItems(),(t=!t)?[3,2]:[4,N.prototype.isDisabled.call(this)];case 1:t=e.sent(),e.label=2;case 2:return[2,t]}}))}))},L);function L(e,t,i){i=N.call(this,"Merge",void 0,void 0,i&&i.groupVisualContainers)||this;return i.selection=e,i.layoutAuthoring=t,i}n.MergeVisualContainerGroupCommand=R;var B,k=(B=n.VisualContainerMenuCommand,__extends(X,B),X.prototype.execute=function(){return __awaiter(this,void 0,Pe.Promise,(function(){var t;return __generator(this,(function(e){return(t=Fe.contracts.isVisualContainerGroup(this.container)?this.container:this.container.parentGroup)&&this.layoutAuthoring.ungroupCanvasItems(t),[2]}))}))},X.prototype.isDisabled=function(){return __awaiter(this,void 0,Pe.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return t=Fe.contracts.isVisualContainerGroup(this.container)||!!this.container.parentGroup,[4,B.prototype.isDisabled.call(this)];case 1:return[2,e.sent()||!t]}}))}))},X);function X(e,t,i){i=B.call(this,"Ungroup",void 0,void 0,i&&i.groupVisualContainers)||this;return i.container=e,i.layoutAuthoring=t,i}n.UngroupVisualContainerCommand=k;var G,i=(G=n.VisualContainerMenuCommand,__extends(H,G),H.prototype.execute=function(){return __awaiter(this,void 0,Pe.Promise,(function(){var t,i,r;return __generator(this,(function(e){return t=this.getSelectedSummarizableVisuals(),i=this.explorationNavigation.getCurrentExploreCanvas(),r=this.explorationNavigation.getAllSections(),this.visualAuthoring.addVisualContainerTextbox(r,i,void 0,!0,t),[2]}))}))},H.prototype.isDisabled=function(){return __awaiter(this,void 0,Pe.Promise,(function(){return __generator(this,(function(e){return[2,_.isEmpty(this.getSelectedSummarizableVisuals())]}))}))},H.prototype.isVisible=function(){return __awaiter(this,void 0,Pe.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,G.prototype.isVisible.call(this)];case 1:return[2,e.sent()&&1===this.viewModeState.getMode()]}}))}))},H.prototype.getSelectedSummarizableVisuals=function(){var i=this,e=n.selectionUtils.getSelectedVisualContainers(this.selection);return _.filter(e,(function(e){var t=i.runningVisualService.getVisual(e);return!!_.isEmpty(t&&t.getErrorInfo())&&i.pluginOps.canSummarizeVisual(Fe.util.VisualContainerUtils.getVisualType(e))&&!o.isSmallMultiplesVisual(e.config.singleVisual)}))},H);function H(e,t,i,r,n,a,o){a=G.call(this,"Summarize",void 0,void 0,a&&a.summarize)||this;return a.explorationNavigation=e,a.pluginOps=t,a.selection=i,a.visualAuthoring=r,a.viewModeState=n,a.runningVisualService=o,a}n.SummarizeVisualContainerCommand=i;var U,e=(U=n.VisualContainerMenuCommand,__extends(j,U),j.prototype.execute=function(){return __awaiter(this,void 0,Pe.Promise,(function(){var t;return __generator(this,(function(e){return this.visibility,t=2,this.viewModeState&&this.viewModeState.getConfig().displayOptions.showVisualAccessibleData&&(t=8),this.visibility.set(this.visualContainer,t),[2]}))}))},j.prototype.isVisible=function(){return __awaiter(this,void 0,Pe.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,U.prototype.isVisible.call(this)];case 1:return e.sent()?[2,this.visualContainer&&2!==this.visualContainer.visibility&&this.drill.canSeeData(this.visualContainer)&&!this.pluginOps.isAnalysisVisual(Fe.util.VisualContainerUtils.getVisualType(this.visualContainer))]:[2,!1]}}))}))},j);function j(e,t,i,r,n,a,o){o=U.call(this,"VisualTable_Show",void 0,(n=void 0===n?!1:n)?"itemIcon glyphicon pbi-glyph-seedata glyph-small":void 0,o&&o.seeData)||this;return o.visualContainer=e,o.drill=t,o.visibility=i,o.pluginOps=r,o.viewModeState=a,o}n.SeeDataCommand=e;var z,i=(z=n.VisualContainerMenuCommand,__extends(W,z),W.prototype.execute=function(){return __awaiter(this,void 0,Pe.Promise,(function(){var t,i;return __generator(this,(function(e){switch(e.label){case 0:if(this.pendingGroupOperation)return[2];this.pendingGroupOperation=!0,this.dataSources,this.conceptualSchemaProxy,t=this.dataSources.get(),e.label=1;case 1:return e.trys.push([1,,4,5]),[4,this.conceptualSchemaProxy.get(t)];case 2:return i=e.sent(),this.groupAuthoring,[4,this.groupAuthoring.visual.group(this.visualContainer,this.selectors,!0,t,i)];case 3:return e.sent(),[3,5];case 4:return this.pendingGroupOperation=!1,[7];case 5:return[2]}}))}))},W.prototype.isVisible=function(){return __awaiter(this,void 0,Pe.Promise,(function(){var t,i,r;return __generator(this,(function(e){switch(e.label){case 0:return(t=!this.featureSwitchService.featureSwitches.enableGroupAuthoring)?[3,2]:[4,z.prototype.isVisible.call(this)];case 1:t=!e.sent(),e.label=2;case 2:return t?[2,!1]:(i=this.dataSources.get())?[4,this.conceptualSchemaProxy.get(i)]:[2,!1];case 3:return r=e.sent(),i=r.schema(void 0),i=!1!==(i&&i.capabilities&&i.capabilities.supportsGrouping),r=i&&this.groupAuthoring.visual.canGroup(this.visualContainer,this.selectors,r),[2,this.promiseFactory.resolve(r)]}}))}))},W);function W(e,t,i,r,n,a,o,s){s=z.call(this,"Group_Data_Action",t,void 0,s&&s.createGroup)||this;return s.visualContainer=e,s.conceptualSchemaProxy=i,s.dataSources=r,s.featureSwitchService=n,s.groupAuthoring=a,s.promiseFactory=o,s}n.CreateGroupCommand=i;var Q,e=(Q=n.VisualContainerMenuCommand,__extends(K,Q),K.prototype.execute=function(){return __awaiter(this,void 0,Pe.Promise,(function(){return __generator(this,(function(e){return this.includeExcludeService,this.includeExcludeService.setFilter(this.filterCreationKind,this.selectors,this.visualContainer,this.dataView),[2]}))}))},K.prototype.isVisible=function(){return __awaiter(this,void 0,Pe.Promise,(function(){var t,i;return __generator(this,(function(e){switch(e.label){case 0:return[4,Q.prototype.isVisible.call(this)];case 1:return e.sent()?r.hasIdentities(this.selectors)&&(t=this.dataSources.get())?[4,this.conceptualSchemaProxy.get(t)]:[2,this.promiseFactory.resolve(!1)]:[2,this.promiseFactory.resolve(!1)];case 2:return i=e.sent(),null!=this.selectors[0].dataMap?(i=this.includeExcludeService.isIncludeExcludeSupported(this.visualContainer,i,this.selectors),[2,this.promiseFactory.resolve(i)]):[2,this.promiseFactory.resolve(!1)]}}))}))},K);function K(e,t,i,r,n,a,o,s,l,u){u=Q.call(this,e,i,void 0,u&&u.includeExclude)||this;return u.visualContainer=t,u.filterCreationKind=r,u.conceptualSchemaProxy=n,u.dataSources=a,u.includeExcludeService=o,u.promiseFactory=s,u.dataView=l,u}n.IncludeExcludeCommand=e;var q,i=(__extends($,q=e),$);function $(e,t,i,r,n,a,o,s,l){return q.call(this,"VisualContainer_ContextMenu_Include",e,t,3,i,r,a,o,s,l)||this}n.IncludeCommand=i;var Z,e=(__extends(J,Z=e),J.prototype.isDisabled=function(){var a,o;return __awaiter(this,void 0,Pe.Promise,(function(){var t,i,r,n;return __generator(this,(function(e){switch(e.label){case 0:if(t=null===(a=null===(a=this.dataView)||void 0===a?void 0:a.metadata)||void 0===a?void 0:a.columns)for(i=0,r=t;i<r.length;i++)if(n=r[i],1===(null===(o=null==n?void 0:n.parameter)||void 0===o?void 0:o.kind))return[2,this.promiseFactory.resolve(!0)];return[4,Z.prototype.isDisabled.call(this)];case 1:return[2,e.sent()]}}))}))},J.prototype.getToolTip=function(t){return __awaiter(this,void 0,Pe.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.isDisabled()];case 1:return e.sent()?[2,this.promiseFactory.resolve(t.get("DQP_Disabled_Operator"))]:[2,this.promiseFactory.resolve(t.get("VisualContainer_ContextMenu_Exclude"))]}}))}))},J);function J(e,t,i,r,n,a,o,s,l){return Z.call(this,"VisualContainer_ContextMenu_Exclude",e,t,4,i,r,a,o,s,l)||this}n.ExcludeCommand=e;var Y,e=(Y=n.VisualContainerMenuCommand,__extends(ee,Y),ee.prototype.isVisible=function(){var i;return __awaiter(this,void 0,Pe.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return[4,Y.prototype.isVisible.call(this)];case 1:return e.sent()?null!==(i=this.runningVisual)&&void 0!==i&&i.getSelectedDatapoints&&(t=null===(i=this.runningVisual)||void 0===i?void 0:i.getSelectedDatapoints())?[2,!_.isEmpty(t)]:[2,!1]:[2,!1]}}))}))},ee.prototype.execute=function(){return __awaiter(this,void 0,Pe.Promise,(function(){return __generator(this,(function(e){return this.runningVisual.clearSelectedDatapoints(),[2]}))}))},ee);function ee(e,t){t=Y.call(this,"Slicer_Clear",void 0,void 0,t&&t.clearSelection)||this;return t.runningVisual=e,t}n.ClearSelectionCommand=e;var te,e=(te=n.VisualContainerMenuCommand,__extends(ie,te),Object.defineProperty(ie.prototype,"commandsCount",{get:function(){return this.childCommands.length},enumerable:!1,configurable:!0}),ie.prototype.getChildren=function(){return __awaiter(this,void 0,Pe.Promise,(function(){return __generator(this,(function(e){return[2,this.childCommands]}))}))},ie);function ie(e,t,i,r,n,a,o){o=te.call(this,"Copy",void 0,void 0,o&&o.copy)||this;return o.clipboard=t,o.childCommands=[],o.copyPasteService=Pe.CopyPasteService.create(),a.copyArgs&&(a.copyArgs.singleValue||a.copyArgs.grid)&&(o.childCommands.push(new ne("Visual_CopyValue",e,o.copyPasteService,i,a.copyArgs.singleValue)),o.childCommands.push(new se("Visual_CopySelection",e,o.copyPasteService,i,a.copyArgs.grid))),r.get()||0!==n.getMode()&&o.childCommands.push(new ce("Visual_CopyVisual",o.clipboard)),o}n.CopyCommandsCollection=e;var re,ne=(re=n.VisualContainerMenuCommand,__extends(ae,re),ae.prototype.isDisabled=function(){return __awaiter(this,void 0,Pe.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,re.prototype.isDisabled.call(this)];case 1:return[2,e.sent()||null===this.valueCallback||!("string"==typeof this.valueCallback||"function"==typeof this.valueCallback)]}}))}))},ae.prototype.execute=function(){return __awaiter(this,void 0,Pe.Promise,(function(){var t;return __generator(this,(function(e){return t=Fe.util.VisualContainerUtils.getVisualType(this.visualContainer),this.copyPasteService.copyText(this.valueCallback,this.telemetryService,t),[2]}))}))},ae);function ae(e,t,i,r,n,a){a=re.call(this,e,void 0,void 0,a&&a.copy)||this;return a.visualContainer=t,a.copyPasteService=i,a.telemetryService=r,a.valueCallback=n,a}n.CopyValueCommand=ne;var oe,se=(oe=n.VisualContainerMenuCommand,__extends(le,oe),le.prototype.isDisabled=function(){return __awaiter(this,void 0,Pe.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,oe.prototype.isDisabled.call(this)];case 1:return[2,e.sent()||null===this.valueCallback||"function"!=typeof this.valueCallback]}}))}))},le.prototype.execute=function(){return __awaiter(this,void 0,Pe.Promise,(function(){var t;return __generator(this,(function(e){return t=Fe.util.VisualContainerUtils.getVisualType(this.visualContainer),this.copyPasteService.copyGrid(this.valueCallback,this.telemetryService,t),[2]}))}))},le);function le(e,t,i,r,n,a){a=oe.call(this,e,void 0,void 0,a&&a.copy)||this;return a.visualContainer=t,a.copyPasteService=i,a.telemetryService=r,a.valueCallback=n,a}n.CopySelectionCommand=se;var ue,ce=(ue=n.VisualContainerMenuCommand,__extends(pe,ue),pe.prototype.execute=function(){return __awaiter(this,void 0,Pe.Promise,(function(){return __generator(this,(function(e){return this.clipboard.copy(),[2]}))}))},pe);function pe(e,t,i){i=ue.call(this,e,void 0,void 0,i&&i.copy)||this;return i.clipboard=t,i}n.CopyVisualCommand=ce;var de,e=(de=n.VisualContainerMenuCommand,__extends(he,de),he.prototype.execute=function(){return __awaiter(this,void 0,Pe.Promise,(function(){return __generator(this,(function(e){return[2]}))}))},he.prototype.isVisible=function(){return __awaiter(this,void 0,Pe.Promise,(function(){var t,i,r;return __generator(this,(function(e){switch(e.label){case 0:return[4,de.prototype.isVisible.call(this)];case 1:return e.sent()?(t=this.dataSources.get())&&(i=this.explorationCapabilities.getCapabilities())&&i.insights?[4,this.lazyScoped("userEmulationService")]:[2,!1]:[2,!1];case 2:return e.sent().getState()?[2,!1]:[4,this.conceptualSchemaProxy.get(t)];case 3:return r=e.sent(),[4,this.getAnalysisOptions(r)];case 4:return r=e.sent(),[2,!_.isEmpty(r)]}}))}))},he.prototype.isDisabled=function(){return __awaiter(this,void 0,Pe.Promise,(function(){return __generator(this,(function(e){return o.isSmallMultiplesVisual(this.visualContainer.config.singleVisual)?[2,!0]:[2,de.prototype.isDisabled.call(this)]}))}))},he.prototype.getChildren=function(){return __awaiter(this,void 0,Pe.Promise,(function(){var t,i,r,n,a,o;return __generator(this,(function(e){switch(e.label){case 0:return(t=this.dataSources.get())?[4,this.conceptualSchemaProxy.get(t)]:[2,void 0];case 1:return i=e.sent(),[4,this.getAnalysisOptions(i)];case 2:if(i=e.sent(),_.isEmpty(i))return[2,null];for(r=[],n=0,a=i;n<a.length;n++)o=a[n],o=new ve(this.selectors,this.position,o,this.dataSources,this.eventBridge,this.explorationNavigation,this.viewModeState,this.lazyScoped,this.displayOverride),r.push(o);return[2,r]}}))}))},he.prototype.getAnalysisOptions=function(r){return __awaiter(this,void 0,Pe.Promise,(function(){var t,i;return __generator(this,(function(e){switch(e.label){case 0:return[4,this.lazyScoped("insightsAnalysisModern")];case 1:return t=e.sent(),[4,this.queryHandler.getCachedQueryOrGenerate({contract:this.visualContainer})];case 2:return null==(i=e.sent())?[2]:[2,t.getOptions(this.visualContainer,i.filterContext,this.selectors,r,this.analysisType)]}}))}))},he);function he(e,t,i,r,n,a,o,s,l,u,c,p,d){t=de.call(this,"VisualContainer_ContextMenu_Analyze",t,void 0,null==d?void 0:d.insightsAnalysis)||this;return t.visualContainer=e,t.position=i,t.conceptualSchemaProxy=r,t.dataSources=n,t.eventBridge=a,t.explorationCapabilities=o,t.explorationNavigation=s,t.lazyScoped=l,t.viewModeState=u,t.queryHandler=c,t.analysisType=p,t.displayOverride=d,t}n.InsightsAnalysisCommandsCollection=e;var ge,ve=(ge=n.VisualContainerMenuCommand,__extends(me,ge),me.prototype.execute=function(){return __awaiter(this,void 0,Pe.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return this.insightsAnalysisData,this.explorationNavigation,this.dataSources,this.viewModeState,this.eventBridge,[4,this.lazyScoped("insightsLauncher")];case 1:return t=e.sent(),this.insightsAnalysisData.useInsightsPane?t.showInsightsFor(this.insightsAnalysisData):t.launch(this.insightsAnalysisData,this.position),[2]}}))}))},me.prototype.title=function(e){return e&&this.defaultTitleKey?e.get(this.defaultTitleKey):this.insightsAnalysisData.question},me.prototype.getChildren=function(){return __awaiter(this,void 0,Pe.Promise,(function(){return __generator(this,(function(e){return[2,null]}))}))},me);function me(e,t,i,r,n,a,o,s,l){l=ge.call(this,null,e,void 0,l&&l.insightsAnalysis)||this;return l.position=t,l.insightsAnalysisData=i,l.dataSources=r,l.eventBridge=n,l.explorationNavigation=a,l.viewModeState=o,l.lazyScoped=s,l}n.InsightsAnalysisCommand=ve;var fe,e=(fe=n.VisualContainerMenuCommand,__extends(ye,fe),ye.prototype.execute=function(){return __awaiter(this,void 0,Pe.Promise,(function(){return __generator(this,(function(e){return[2]}))}))},ye.prototype.isVisible=function(){return __awaiter(this,void 0,Pe.Promise,(function(){var t,i;return __generator(this,(function(e){switch(e.label){case 0:return(t=_.isEmpty(this.selectors))?[3,2]:[4,fe.prototype.isVisible.call(this)];case 1:t=!e.sent(),e.label=2;case 2:return t?[2,!1]:this.drill.canDrillthrough(this.visualContainer)?(this.children,[4,(i=this).getChildren()]):[3,4];case 3:return i.children=e.sent(),[2,!_.isEmpty(this.children)];case 4:return[2,!1]}}))}))},ye.prototype.getChildren=function(){return __awaiter(this,void 0,Pe.Promise,(function(){var t,i,r,n,a=this;return __generator(this,(function(e){switch(e.label){case 0:return void 0!==this.children?[2,this.children]:(t=this.drillthroughEntryPoint,i=this.explorationNavigation.getCurrentSection(),n=Fe.util.VisualContainerUtils.getVisualType(this.visualContainer),_.isEmpty(this.selectors)||_.isEmpty(i.name)||!this.pluginOps.isQueryVisual(n)?[2,[]]:[4,this.queryHandler.getCachedQueryOrGenerate({contract:this.visualContainer})]);case 1:return null==(r=e.sent())?[2]:[4,this.lazyScoped("drillthrough")];case 2:return[4,e.sent().getDrillthroughActions(i.name,this.visualContainer,this.selectors,r.filterContext)];case 3:return n=e.sent(),[2,_.map(n,(function(e){return new Se(e,t,a.lazyScoped,a.telemetryService,a.displayOverride)}))]}}))}))},ye);function ye(e,t,i,r,n,a,o,s,l,u,c){t=fe.call(this,u||"Drillthrough",t,"pbi-glyph-drillthrough",c&&c.drillthrough)||this;return t.visualContainer=e,t.drillthroughEntryPoint=i,t.drill=r,t.explorationNavigation=n,t.lazyScoped=a,t.pluginOps=o,t.queryHandler=s,t.telemetryService=l,t.displayOverride=c,t}n.DrillthroughCommandCollection=e;var Ce,Se=(Ce=n.VisualContainerMenuCommand,__extends(be,Ce),be.prototype.execute=function(){return __awaiter(this,void 0,Pe.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return this.drillthroughActionData,this.drillthroughEntryPoint,this.lazyScoped,this.telemetryService,[4,this.lazyScoped("drillthrough")];case 1:return e.sent().applyDrillthroughState(this.drillthroughActionData,!0),this.telemetryService.logEvent(Pe.telemetry.EXDrillthroughGotoTarget,{entryPoint:this.drillthroughEntryPoint,toExternalReport:!!this.drillthroughActionData.targetReportGuid}),[2]}}))}))},be.prototype.title=function(e){return this.drillthroughActionData.reportDisplayName?this.drillthroughActionData.sectionDisplayName+" ["+this.drillthroughActionData.reportDisplayName+"]":this.drillthroughActionData.sectionDisplayName},be);function be(e,t,i,r,n){n=Ce.call(this,"Drillthrough",void 0,void 0,n&&n.drillthrough)||this;return n.drillthroughActionData=e,n.drillthroughEntryPoint=t,n.lazyScoped=i,n.telemetryService=r,n}n.DrillthroughCommand=Se;var Ee,e=(Ee=n.VisualContainerMenuCommand,__extends(Ve,Ee),Ve.prototype.title=function(e){return this.groupTitle},Ve.prototype.getChildren=function(){return __awaiter(this,void 0,Pe.Promise,(function(){return __generator(this,(function(e){return[2,this.children]}))}))},Ve.prototype.addChild=function(e){this.children.push(e)},Object.defineProperty(Ve.prototype,"isEmpty",{get:function(){return 0===this.children.length},enumerable:!1,configurable:!0}),Ve.prototype.isVisible=function(){return __awaiter(this,void 0,Pe.Promise,(function(){return __generator(this,(function(e){return[2,Ee.prototype.isVisible&&!this.isEmpty]}))}))},Ve);function Ve(e,t,i){t=Ee.call(this,null,void 0,void 0,t&&t.extensions)||this;return t.groupTitle=e,t.menuLocation=i,t.children=[],t}n.ExtensionCommandsGroup=e;var we,e=(we=n.VisualContainerMenuCommand,__extends(xe,we),xe.prototype.title=function(e){return this.commandTitle},xe.prototype.execute=function(){return __awaiter(this,void 0,Pe.Promise,(function(){var t;return __generator(this,(function(e){return t=this.getDataPointsDescriptions(),this.explorationExtensibilityService.executeCustomCommand(this.eventBridge,this.visualContainer,this.commandName,t),[2]}))}))},xe.prototype.getDataPointsDescriptions=function(){var e=[];if(this.visualContainerDataSelectionService&&!_.isEmpty(this.selectors))for(var t=0,i=this.selectors;t<i.length;t++){var r=i[t],n=this.visualContainerDataSelectionService.getSelectedValues(r,this.featureSwitchService.featureSwitches.dataPointLassoSelect);e.push({selector:r,values:n})}return e},xe);function xe(e,t,i,r,n,a,o,s,l,u){s=we.call(this,null,t,void 0,u&&u.extensions,void 0,s)||this;return s.visualContainer=e,s.commandName=i,s.commandTitle=r,s.eventBridge=n,s.explorationExtensibilityService=a,s.featureSwitchService=o,s.visualContainerDataSelectionService=l,s}n.ExtensionCommand=e})((Fe=Pe.explore||(Pe.explore={})).services||(Fe.services={}))})(powerbi=powerbi||{}),(function(r){!(function(e){var i;function t(e,t){this.moduleConfig={name:"ui.bootstrap",dependency:{javascript:"angular-ui-datetimepicker"}},this.services=t,this.id=i.generateId(),this.calendarButtonText=this.services.localizationService.get("GroupNavigationPaneContextMenuItem_Calendar")}e=e.controllers||(e.controllers={}),i=r.common.utils.IdUtility,t.createOptions=function(){return{additionalServices:["overlayService","localizationService"]}},t.prototype.$onInit=function(){var t=this;this.ngModel.$render=function(){var e;_.isNumber(t.ngModel.$viewValue)?"Invalid Date"!==(e=new Date(t.ngModel.$viewValue)).toString()?t.ngModel.$setViewValue(e):t.ngModel.$setViewValue(void 0):void 0!==t.ngModel.$viewValue&&t.ngModel.$viewValue instanceof Date?t.inputInvalid||(t.dateVal=t.ngModel.$viewValue,t.textVal=t.ngModel.$viewValue.toLocaleDateString()+" "+t.ngModel.$viewValue.toLocaleTimeString()):(t.textVal=void 0,t.dateVal=void 0,t.inputInvalid=!1)}},t.prototype.$onChanges=function(e){e&&e.validators&&void 0!==this.textVal&&this.validateTextInput()},t.prototype.dateSelected=function(){this.inputInvalid=!1,this.textVal=this.dateVal.toLocaleDateString()+" "+this.dateVal.toLocaleTimeString(),this.ngModel.$setViewValue(this.dateVal),this.services.overlayService.hideAllDropdowns()},t.prototype.dateTextUpdated=function(){this.validateTextInput(),this.inputInvalid||this.ngModel.$setViewValue(this.dateVal)},t.prototype.validateTextInput=function(){var e;this.textVal?(e=new Date(this.textVal),this.inputInvalid="Invalid Date"===e.toString(),this.validators&&(this.inputInvalid=this.inputInvalid||e<this.validators.min||e>this.validators.max),this.inputInvalid||(this.dateVal=e)):(this.textVal=void 0,this.dateVal=void 0,this.inputInvalid=!1)},e.DateTimePickerController=t})(r.explore||(r.explore={}))})(powerbi=powerbi||{}),(function(e){var t;((t=e.explore||(e.explore={})).components||(t.components={})).DateTimePicker={templateUrl:"components/dateTimePicker/dateTimePicker.html",bindings:{placeholder:"<",validators:"<",labelId:"<"},require:{ngModel:"ngModel"},controller:e.common.createController(t.controllers.DateTimePickerController)}})(powerbi=powerbi||{}),(function(e){(e=(e=(e=e.explore||(e.explore={})).viewModels||(e.viewModels={})).FilterEvents||(e.FilterEvents={})).filterChanged={name:"filterChanged"},e.topNFilterOrderByUpdate={type:2,name:"topNFilterOrderByUpdate"}})(powerbi=powerbi||{}),(function(u){!(function(a){var e,r,n,o,s;function l(e,t){var i=r.call(this,e,{expanded:!1,canToggleSingleSelect:!1,availableTypes:[],type:e.type})||this;return i.isInvalidForMappedColumn=!1,i.id=l.counter++,i.restatement="",i.displayName="",i.containerScope=t,i.howCreated=0,i.isLinkedAsAggregation=!1,i.filterCapabilities=a.FilterUtils.getFilterCapabilities(e),i}e=a.viewModels||(a.viewModels={}),n=a.contracts.FilterType,o=u.data.SQExprUtils,s=u.explore.util.VisualContainerUtils,r=e.ViewModel,__extends(l,r),l.prototype.setServices=function(e,t,i){this.visualHostServices=e,this.visualPlugin=t,this.viewModeState=i},l.prototype.isInvalid=function(){return this.invalid},l.prototype.clearDQPWarning=function(){this.isInvalidForMappedColumn&&(this.invalid=!1,this.readOnlyState.invalid=!1,this.isInvalidForMappedColumn=!1)},l.prototype.isInvalidCardType=function(){return this.cardType&&this.cardType.invalid},Object.defineProperty(l.prototype,"isVisualFilter",{get:function(){return this.containerScope&&0===this.containerScope.scopeType},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"hasDefaultValue",{get:function(){return this.defaultValue&&(1===this.howCreated||5===this.howCreated)},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"isLinkField",{get:function(){return 5===this.howCreated&&!this.contract.isTransient},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"canToggleLinkAsAggregation",{get:function(){return this.isLinkField&&!this.isMeasure},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"canDeleteManually",{get:function(){return this.filterCapabilities.canDelete||!!this.readOnlyState.invalid},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"canClearManually",{get:function(){return this.filterCapabilities.canClear},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"hasRestatement",{get:function(){return""!==this.restatement&&null!=this.restatement},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"canHideManually",{get:function(){return this.filterCapabilities.canHide},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"canLockManually",{get:function(){return this.filterCapabilities.canLock},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"canRenameManually",{get:function(){return this.filterCapabilities.canRename},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"canSortManually",{get:function(){return this.filterCapabilities.canSort},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"canExpandManually",{get:function(){return this.filterCapabilities.canEdit&&a.FilterUtils.canExpandManually(this.contract.howCreated,this.contract.isTransient,this.contract.expression,!this.invalid)},enumerable:!1,configurable:!0}),l.prototype.getFilterContainerScope=function(){return this.containerScope},l.prototype.setRestatement=function(e){this.contract.type===this.readOnlyState.type&&(this.restatement=e)},l.prototype.clearRestatement=function(){this.restatement=""},l.prototype.getRestatement=function(){return this.restatement},l.prototype.updateFilterCardStyle=function(e,t){t&&(e=e&&e.evaluatedObjects,this.style=a.FilterUtils.getFilterCardStyle(e,!!this.contract.filter,t,this.filterCardStyleArguments))},Object.defineProperty(l.prototype,"checkboxAndApplyColor",{get:function(){return this.style&&this.style.checkboxAndApplyColor},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"borderColor",{get:function(){return this.style&&this.style.borderColor},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"backgroundColor",{get:function(){return this.style&&this.style.backgroundColor},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"foregroundColor",{get:function(){return this.style&&this.style.foregroundColor},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"inputBoxBorderColor",{get:function(){return this.style&&this.style.inputBoxBorderColor},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"inputBoxBackgroundColor",{get:function(){return this.style&&this.style.inputBoxBackgroundColor},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"inputBoxForegroundColor",{get:function(){return this.style&&this.style.inputBoxForegroundColor},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"fontSize",{get:function(){return this.style&&this.style.fontSize},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"fontFamily",{get:function(){return this.style&&this.style.fontFamily},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"visualContainer",{get:function(){if(this.isVisualFilter)return this.containerScope.container},enumerable:!1,configurable:!0}),l.prototype.isFilterLocked=function(){return this.contract.isLockedInViewMode},l.prototype.isFilterHidden=function(){return this.contract.isHiddenInViewMode},l.prototype.isFilterExpanded=function(){return this.readOnlyState.expanded},l.prototype.updateFilterProperties=function(e,t,i){var r;this.contract.expression&&(r=this.contract.expression,this.isMeasure=o.isMeasure(r),this.discourageAggregation=o.discourageAggregation(r,e),this.valueType=a.FilterUtils.getValueType(r,e),this.formatter=a.FilterUtils.getFormatter(r,e),this.defaultValue=o.getDefaultValue(r,e),this.parameterMetadata=o.getConceptualParameterMetadata(r,e),5===this.howCreated&&!this.contract.isTransient||this.isMappedToMParameter()&&!this.supportsMultipleValues()?(this.isSingleSelectionRequired=!0,this.disableSelectionModeToggle=!0):this.contract.isTransient&&(this.isSingleSelectionRequired=!1,this.disableSelectionModeToggle=!0)),this.contract.objects&&(n=u.data.DataViewObjectDefinitions.getValue(this.contract.objects,{objectName:"general",propertyName:"isInvertedSelectionMode"},void 0),this.isInvertedSelectionMode=n&&n.value);var n=this.containerScope.container;this.hasGroupingScope=n&&s.hasGrouping(n,e),this.invalid=!_.isEmpty(a.FilterUtils.validate(this.contract,e,i)),this.invalid?this.isInvalidForMappedColumn=!1:(this.isInvalidForMappedColumn=this.hasInvalidFiltersForMParameters(this.contract,e),this.invalid=this.isInvalidForMappedColumn),this.disabled=a.FilterUtils.shouldDisableFilter(this.contract,e,n,i,t)},l.prototype.hasInvalidFiltersForMParameters=function(e,t){e=null===(e=null==e?void 0:e.filter)||void 0===e?void 0:e.conditions();if(!e)return!1;for(var i=0,r=e;i<r.length;i++){var n=r[i];if(!o.checkExprForValidMParameters(n,t))return!0}return!1},l.prototype.switchType=function(e){this.readOnlyState.type=e},l.prototype.canVisualize=function(){var e=this.contract;return e.expression&&e.type!==n.Passthrough&&!this.isMeasure},l.prototype.updateViewStateCore=function(e){var t=this.contract;e.type;var i=!this.invalid;e.disabled=this.disabled,e.expanded=!0===t.expanded&&i,e.invalid=!i,_.some(this.availableTypes,(function(e){return e.type===n.Categorical}))&&(e.visual||!t.config||(r=t.config.singleVisual)&&this.visualHostServices&&this.visualPlugin&&(e.visual={viewport:l.DefaultVisualViewPort,type:u.visuals.plugins.filterSlicer.name,dataTransforms:{objects:r.objects},hostServices:this.visualHostServices,interactivityOptions:{dragDataPoint:!1,selection:!0},allowInvalidDataView:!0,visualPlugin:this.visualPlugin,themeCollection:{}}));var r=5===this.howCreated&&!this.contract.isTransient;e.canToggleSingleSelect=!r&&!this.contract.isTransient&&!(e.disabled||!e.expanded||!e.visual||!e.visual.data)},l.prototype.updateAvailableTypes=function(e,t){void 0===t&&(t=u.common.getLocalize());var i,r=this.readOnlyState.type;r!==n.Passthrough?(i=[],!this.valueType||this.valueType.bool||this.isLinkField||i.push({type:n.Advanced,label:t.get("FilterPane_Advanced")}),this.isMeasure||(i.push({type:n.Categorical,label:t.get("FilterPane_Basic")}),this.valueType&&this.valueType.dateTime&&!this.isMappedToMParameter()&&(i.push({type:n.RelativeDate,label:t.get("FilterPane_RelativeDate")}),i.push({type:n.RelativeTime,label:t.get("FilterPane_RelativeTime")})),this.isVisualFilter&&!this.isMappedToMParameter()&&i.push({type:n.TopN,label:t.get("FilterPane_TopN")})),this.availableTypes=i,this.hiddenTypes=[],this.updateCardType(r,t)):this.availableTypes=[]},l.prototype.updateCardType=function(t,e){void 0===e&&(e=u.common.getLocalize());var i=this.availableTypes;this.readOnlyState.type=t,this.cardType=_.find(i,(function(e){return e.type===t})),!this.cardType&&this.hiddenTypes&&0<this.hiddenTypes.length?(this.cardType=_.find(this.hiddenTypes,(function(e){return e.type===t})),this.availableTypes.push(this.cardType)):!this.cardType&&this.isMappedToMParameter()&&(this.cardType={type:n.Categorical,label:e.get("FilterPane_Basic")})},l.prototype.isSingleSelectDisabled=function(){return this.disableSelectionModeToggle||!this.viewModeState||0===this.viewModeState.getMode()},l.prototype.getDisplayName=function(){return this.contract.displayName||this.displayName},l.prototype.updateIsLinkedAsAggregation=function(e){this.isLinkedAsAggregation=e},l.prototype.getInputPlaceholder=function(){return this.viewModeState&&this.viewModeState.getConfig().displayOptions.enableMobileFilters?u.common.getLocalize().get("TypeHere"):""},l.prototype.isMappedToMParameter=function(){return this.parameterMetadata&&1===this.parameterMetadata.kind},l.prototype.supportsMultipleValues=function(){var e;return!(null===(e=this.parameterMetadata)||void 0===e||!e.supportsMultipleValues)},l.prototype.supportsSelectAll=function(){var e;return!(null===(e=this.parameterMetadata)||void 0===e||!e.supportsSelectAll)},l.DefaultVisualViewPort={width:146,height:180,scale:1},l.counter=0,e.FilterViewModel=l})(u.explore||(u.explore={}))})(powerbi=powerbi||{}),(function(f){var p,y,e,l,C,u,S,b,c;function d(e){var t,i;return e.filter&&((i=e.filter.conditions()).length,(i=i[0])&&(t=y.FilterCardConverter.createAdvFilter(i,null,e.expression))),t=!t&&e.expression?new y.AdvFilterCard(e.expression):t}function h(e,t,i,r,n,a,o){var s=u.asFieldPattern(e);return i.getDisplayName(e,t,r,n,0===o?a:void 0,{includeVariationSource:!0})||(s?l.getFieldExprName(s):void 0)}function g(e,t,i,r,n,a,o){n=i.getQualifiedDisplayName(e,t,n);return 5===o||6===o||2===o?n=r.format("FilterCard_Transient_Drill",[n]):7===o?n=r.format("FilterCard_Transient_URL",[n]):a&&(n=r.format("FilterCard_Transient",[n])),n}function v(e,t,i,r,n){i=new p.services.IncludeExcludeSQExprVisitor(i,r);if(!e.filter)return e.type?new y.FilterViewModel(e,t):void 0;r=e.filter.conditions();if(!(_.isEmpty(r)||1<r.length)&&(r[0].accept(i),0<i.dataPoints.length)){e.type=i.isExclude?C.Exclude:C.Include;t=new y.FilterViewModel(e,t);return t.displayName=p.FilterUtils.getDisplayNameForIncludeExcludeFilters(n,e.type,i.dataPoints.length),t}}function m(e,i,t,r,n,a,o){null==e.type||(e.type,C.Passthrough),e.type,null==e.type&&(e.type=C.Passthrough);var s,l,u,c,p,d,h,g,v=new y.FilterViewModel(e,t),m=e.restatement;return m&&""!==m||!e.filter||(_.size(e.filter.where()),m=n.getFilterRestatement(e.filter,r,i,s={includeFieldNamesInFilter:!0}),v.tooltip=n.getQualifiedFilterRestatement(e.filter,r,i,s),_.isEmpty(m)&&(l=f.data.PassthroughFilterPattern.extractParametersFromFilter(e.filter),_.isEmpty(l)||(p=o.get("ListJoin_Separator"),d=g=h=void 0,a&&(u=a.columnProperties),c=l.fieldsBeingFiltered.map((function(e){var t=a&&a.query&&a.query.defn.selectNameOf(e);return n.getDisplayName(e,r,i,t,u)})).join(p),p=l.fieldsBeingFiltered.map((function(e){return n.getQualifiedDisplayName(e,r,i,s)})).join(p),l.isSubquery&&l.itemCount?(1===t.scopeType&&e.howCreated,t=b.format(l.itemCount),l.orderByField&&(e=a&&a.query&&a.query.defn.selectNameOf(l.orderByField),e=n.getDisplayName(l.orderByField,r,i,e,u),d=l.isTop?"FilterRestatement_TopNBy_Drillthrough":"FilterRestatement_BottomNBy_Drillthrough",h=[t,c,e],g=[t,p,e])):(h=[c],g=[p],d=l.isSubquery?"FilterRestatement_Subquery":"FilterRestatement_Columns"),m=S.format.apply(S,__spreadArray([o.get(d)],h||[])),v.tooltip=S.format.apply(S,__spreadArray([o.get(d)],g||[]))))),v.setRestatement(m),v}function E(e,t,i,r,n,a,o){var s=d(e);if(s){e.expression||(e.expression=s.field),null==e.type||e.type===C.Categorical||e.type===C.Visual||(e.type,C.Advanced),e.type,null==e.type&&(e.filter?e.type=p.FilterUtils.getFilterType(s.field,s.supportsCategorical):(e.isTransient,e.type=p.FilterUtils.getDefaultFilterType(e.expression,r,e.howCreated))),null==e.type&&(e.type=C.Categorical);var l,u,c=e.expression,s=new y.FilterViewModel(e,i);return o&&(l=o.query&&o.query.defn.selectNameOf(c),u=o.columnProperties),s.displayName=h(c,r,n,t,l,u,i.scopeType),s.tooltip=g(c,r,n,a,t,e.isTransient,e.howCreated),s}}function V(e,t,i,r,n,a,o){if(0===i.scopeType&&5!==e.howCreated){var s=f.data.TopNFilterPattern.extractParametersFromFilter(e.filter);return s&&x(e,C.TopN,s.fieldBeingFiltered),P(e,C.TopN,i,r,n,a,t,o)}}function w(e,t,i,r,n,a,o,s,l){var u=y.RelativeFilterViewModelUtil.relativeFilterTypeToFilterType(e),e=f.data.RelativeDateFilterPattern.extractParametersFromSemanticFilter(t.filter,e);if(e){if(e.options&&e.options.anchorDate&&l)return;x(t,u,e.field)}return P(t,u,r,n,a,o,i,s)}function x(e,t,i){null==e.type||e.type,e.type,e.type=t,e.expression=i}function P(e,t,i,r,n,a,o,s){if(e.type===t&&e.expression){var l=new y.FilterViewModel(e,i),t=s&&s.query?s.query.defn.selectNameOf(e.expression):void 0,s=s?s.columnProperties:void 0;return l.displayName=h(e.expression,r,n,o,t,s,i.scopeType),l.tooltip=g(e.expression,r,n,a,o,e.isTransient,e.howCreated),l}}p=f.explore||(f.explore={}),y=p.viewModels||(p.viewModels={}),l=f.data.FieldExprPattern,C=p.contracts.FilterType,u=f.data.SQExprConverter,S=jsCommon.StringExtensions,b=f.visuals.valueFormatter,c=f.data.RelativeFilterType,(e=y.FilterViewModelFactory||(y.FilterViewModelFactory={})).convertFilterContainer=function(e,t,i,r,n,a,o,s,l){var u;switch(e.expression||e.filter||e.type===C.Include||(e.type,C.Exclude),e.isTransient&&e.filter,e.type){case C.TopN:u=V(e,s,r,t,i,o,l);break;case C.Advanced:case C.Categorical:u=E(e,s,r,t,i,o,l);break;case C.RelativeTime:u=w(c.Time,e,s,r,t,i,o,l,!1);break;case C.RelativeDate:u=w(c.Date,e,s,r,t,i,o,l,!1);break;case C.Passthrough:u=m(e,s,r,t,i,l,o);break;case C.Include:case C.Exclude:u=v(e,r,t,i,o);break;default:u=V(e,s,r,t,i,o,l)||w(c.Time,e,s,r,t,i,o,l,!0)||w(c.Date,e,s,r,t,i,o,l,!0)||E(e,s,r,t,i,o,l)||v(e,r,t,i,o)||m(e,s,r,t,i,l,o)}return e.type,u.howCreated=e.howCreated,u.updateFilterProperties(t,n,a),u},e.extractAdvFilterCard=d})(powerbi=powerbi||{}),(function(e){var t;t=e.explore||(e.explore={}),(t=(e=t.viewModels||(t.viewModels={})).PropertyCardNames||(e.PropertyCardNames={})).Background="background",t.Border="border",t.CategoryAxis="categoryAxis",t.ConditionalFormatting="conditionalFormatting",t.DataBars="dataBars",t.DataPoint="dataPoint",t.DropShadow="dropShadow",t.General="general",t.Gradient="gradient",t.Labels="labels",t.Legend="legend",t.LockAspect="lockAspect",t.PersonalizeVisual="personalizeVisual",t.StylePreset="stylePreset",t.Title="title",t.Totals="totals",t.ValueAxis="valueAxis",t.VisualHeader="visualHeader",t.VisualLink="visualLink",t.VisualTooltip="visualTooltip",t.VisualHeaderTooltip="visualHeaderTooltip",t.Zoom="zoom",t.CategoryLabels="categoryLabels",(t=e.PropertySliceNames||(e.PropertySliceNames={})).ApplyToAllPages="applyToAllPages",t.Color="color",t.FlagsSelection="flagsSelection",t.InnerPadding="innerPadding",t.NumericSelection="numericSelection",t.Position="position",t.RevertToDefault="revertToDefault",t.SecPosition="secPosition",t.SecShow="secShow",t.SecShowAxisTitle="secShowAxisTitle",t.Selection="selection",t.Slider="slider",t.Show="show",t.ShowAxisTitle="showAxisTitle",t.ShowGradientLegend="showGradientLegend",t.TextArea="textarea",t.Transparency="transparency",t.SwitchAxisPosition="switchAxisPosition",(e=e.GeneralPropertyNames||(e.GeneralPropertyNames={})).X="x",e.Y="y",e.Width="width",e.Height="height",e.AltText="altText",e.AllowBinnedLineSample="allowBinnedLineSample",e.AllowOverlappingPointsSample="allowOverlappingPointsSample",e.KeepLayerOrder="keepLayerOrder"})(powerbi=powerbi||{}),(function(e){var s,t,i,l;function r(e,t){if(e&&e.sections){e=e.sections,e=_.findIndex(e,(function(e){return e.name===t}));return-1!==e?e:void 0}}function a(e,t){for(var i=1,r=t.format("Explore_Section_Page",[i.toFixed()]);0<=_.findLastIndex(e,(function(e){return e.displayName===r}));)r=t.format("Explore_Section_Page",[(++i).toFixed()]);return r}function n(e){return!!(1&e.visibility)}s=e.explore||(e.explore={}),t=s.SectionUtils||(s.SectionUtils={}),i=jsCommon.ArrayExtensions,l=e.explore.contracts.Section,t.synchronizeSectionsIds=function(e,t){var i=l.filterTransient(t),r=l.filterTransient(e);i.length,r.length;for(var n=i.length-1;0<=n;n--){var a=i[n],o=r[n];a.id=o.id,a.objectId=o.objectId,(function e(t,i){for(var r=t.length-1;0<=r;r--){var n=t[r],a=i[r];n.id=a.id,s.contracts.isVisualContainerGroup(n),s.contracts.isVisualContainerGroup(a),s.contracts.isVisualContainerGroup(n)&&s.contracts.isVisualContainerGroup(a)&&e(n.children,a.children)}})(a.visualContainerGroups,o.visualContainerGroups)}},t.findSectionIndexForSectionName=r,t.getActiveSectionIndex=function(e,t){var i;return i=null==(i=null==(i=t?r(e,t):i)&&_.isNumber(e.activeSectionIndex)?e.activeSectionIndex:i)||!_.inRange(i,0,e.sections.length)?0:i},t.findSectionIndexForSection=function(e,t){return e&&e.sections?(e=e.sections,_.findIndex(e,(function(e){return e===t}))):-1},t.findSectionById=function(e,t){return e&&e.sections?i.findWithId(e.sections,t):null},t.findSectionIndexForSectionId=function(e,t){return e&&e.sections?(e=e.sections,_.findIndex(e,(function(e){return e.id===t}))):-1},t.getNextSectionDisplayNameWithIndex=a,t.fillDefaultSectionDisplayNames=function(e,t){for(var i=0,r=e.sections;i<r.length;i++){var n=r[i];n.displayName||(n.displayName=a(e.sections,t))}},t.getVisibleSections=function(e){return _.filter(e,(function(e){return!n(e)}))},t.isSectionHidden=n,t.isSectionTooltip=function(e){return!!(1&e.type)}})(powerbi=powerbi||{}),(function(e){var t,n;t=(t=e.explore||(e.explore={})).util||(t.util={}),n=e.explore.SectionUtils,(t=t.ExplorationUtil||(t.ExplorationUtil={})).isIntermediateState=function(e){return!e||!e.exploration},t.isReportAnnotationsEnabled=function(e){return!e||!e.isReportAnnotationsDisabled},t.removeQuickExploreConfig=function(e){for(var t=0,i=e.sections;t<i.length;t++){var r=i[t];n.isQuickExploreSection(r)&&(r.dynamicConfig=void 0)}}})(powerbi=powerbi||{}),(function(e){((e=(e=e.explore||(e.explore={})).viewModels||(e.viewModels={})).DetailVisualEvents||(e.DetailVisualEvents={})).spinnerAction={name:"spinnerAction"}})(powerbi=powerbi||{}),(function(r){var e;(function(e){var t=r.explore.constants.ExploreCanvasConstants;e.FixedPhoneCanvasSettings={phoneWidth:t.PhoneAuthoringViewportWidth,phoneHeight:t.PhonePortraitCanvasHeight,phoneGridLayout:{columnCount:t.PhonePortraitColumnCount,rowCount:t.PhonePortraitRowCount,newVisualCellCount:{width:6,height:6}}};Object.defineProperty(i.prototype,"width",{get:function(){return 0===this.canvasLayout?this.contract.size&&this.contract.size.width:e.FixedPhoneCanvasSettings.phoneWidth},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"height",{get:function(){return 0===this.canvasLayout?this.contract.size&&this.contract.size.height:e.FixedPhoneCanvasSettings.phoneHeight},enumerable:!1,configurable:!0}),t=i;function i(e,t){void 0===t&&(t=0),this.selectedVisualOriginalPosition=-1,this.contract=e,this.canvasLayout=t}e.ExploreCanvas=t})((e=r.explore||(r.explore={})).viewModels||(e.viewModels={}))})(powerbi=powerbi||{}),(function(r){var e;function t(e,t,i){return{key:t,text:(i=void 0===i?r.common.getLocalize():i).get(e),type:0}}((e=(e=(e=r.explore||(r.explore={})).viewModels||(e.viewModels={})).ExplorationContainerViewModelFactory||(e.ExplorationContainerViewModelFactory={})).MenuItemFactory||(e.MenuItemFactory={})).createNavigationMenuItems=function(e){return{items:[t("Duplicate_page",0,e),t("Rename_page",1,e),t("Delete_page",2,e),t("Hide_page",3,e)]}}})(powerbi=powerbi||{}),(function(e){var t;e=(e=e.explore||(e.explore={})).viewModels||(e.viewModels={}),(t=e.ExplorationContainerViewModelFactory||(e.ExplorationContainerViewModelFactory={})).createNavigationMenuItems=function(e){return t.MenuItemFactory.createNavigationMenuItems(e)}})(powerbi=powerbi||{}),(function(x){var e;(function(e){var t=jsCommon.EnumExtensions,F=x.data.SQExpr,A=x.data.SQExprConverter,T=x.data.FieldExprPattern;e.getIconClassName=function(e,t,i){var r=t?"_paneColorRefresh":"",t=e.fieldType;if(1===t)return"fieldListFolder"+r;if(5===t)return"none";if(2===t)return"fieldListHierarchy"+r;if(6===t)return"fieldListMeasure"+r;if(1===e.contract.queryable)return"fieldListError"+r;if(1===e.kind)return e.contract.measure&&e.contract.measure.kpi&&4===e.fieldType?"fieldListKpi"+r:e.contract.measure&&e.contract.measure.changeDetectionMetadata?"fieldListChangeDetection"+r:"fieldListMeasure"+r;if(void 0!==e.contract.type&&void 0!==e.contract.type.geography)return"fieldListGeoData"+r;if(0===e.kind){t=e.contract.column;if(t){if(t.parameterMetadata)return"fieldListParameter"+r;if(t.groupingMetadata)return"fieldListGroup"+r;if(t.calculated)return e.type&&e.type.numeric?"fieldListNumericCalculatedColumn"+r:"fieldListCalculatedColumn"+r;if(!_.isEmpty(t.variations)&&e.type.dateTime)return"fieldListCalendar"+r}if(e.idOnEntityKey)return"fieldListIdentity"+r}return e.type&&e.type.numeric&&1!==e.defaultAggregate&&i?"fieldListNumeric"+r:"none"};var r=(Object.defineProperty(i.prototype,"name",{get:function(){return this.contract.name},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"canEdit",{get:function(){return this.contract.capabilities.canEdit&&!this.disableEditing},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"canCreateColumn",{get:function(){return this.canEdit&&!1!==this.contract.capabilities.supportsCalculatedColumns},enumerable:!1,configurable:!0}),i.prototype.findEntity=function(t){return _.find(this.entities,(function(e){return e.name===t}))},i.prototype.findFields=function(e,t,i){e=this.findEntity(e);if(e)return e.findFields(t,i)},i.prototype.findHierarchies=function(e,t,i){e=this.findEntity(e);if(e)return e.findHierarchies(t,i)},i.prototype.findKpis=function(e,t,i){e=this.findEntity(e);if(e)return e.findKpis(t,i)},i.prototype.findKpiMeasures=function(e,t,i){e=this.findEntity(e);if(e)return e.findKpiMeasures(t,i)},i.prototype.findItems=function(e){var t=[];if(F.isTransformOutputRoleRef(e)||F.isSparklineData(e))return t;var i=A.asFieldPattern(e),r=T.toFieldExprEntityItemPatterns(i);if(i){var n=i.hierarchyLevel||i.hierarchyLevelAggr;if(n){_.size(r);e=this.findHierarchies(r[0].entity,n.name,n.schema);if(e)for(var a=0,o=e;a<o.length;a++){var s=o[a];t.push(s);for(var l=0,u=s.hierarchyLevels;l<u.length;l++)(y=u[l]).name===n.level&&t.push(y)}}else if(i.columnHierarchyLevelVariation){var c=i.columnHierarchyLevelVariation.source.name;if(_.size(r),!(V=this.findFields(r[0].entity,c,r[0].schema)))return t;for(var p=0,d=V;p<d.length;p++){var h=d[p];t.push(h);var g=h.properties;if(g)for(var v=0,m=g;v<m.length;v++){var f=m[v];if(f instanceof D&&f.name===i.columnHierarchyLevelVariation.level.name){t.push(f);for(var y,C=0,S=f.hierarchyLevels;C<S.length;C++)(y=S[C]).name===i.columnHierarchyLevelVariation.level.level&&t.push(y)}}}}else{var b=T.getPropertyNames(i);b&&(_.size(r),_.size(b));for(var E=0;E<r.length;E++){var V,w=r[E],c=null==b?void 0:b[E];if(V=this.findFields(w.entity,c,w.schema)||this.findKpiMeasures(w.entity,c,w.schema))for(var x=0,P=V;x<P.length;x++){h=P[x];t.push(h)}}}}return t},i.getUniqueId=function(){return i._uid++},i._uid=0,i);function i(e){this.contract=e,this.showCheckboxes=!0,this.entities=[]}e.FieldListConceptualModel=r;var n=(Object.defineProperty(a.prototype,"name",{get:function(){return this.contract.name},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"displayName",{get:function(){return this.displayNameOverride||this.contract.displayName},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"description",{get:function(){return this.contract.description},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"errorMessage",{get:function(){return this.contract.errorMessage},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"calculated",{get:function(){return this.contract.calculated},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"iconClassName",{get:function(){return 1===this.contract.queryable?"fieldListError":this.calculated?"fieldListEntityCalculated":this.isMeasureGroup?"fieldListMeasureGroup":void 0},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"hidden",{get:function(){return t.hasFlag(this.contract.visibility,1)&&_.every(this.properties,(function(e){return!e.isExtension||e.hidden}))},set:function(e){this.contract.visibility=e?t.setFlag(this.contract.visibility,1):t.resetFlag(this.contract.visibility,1)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"canEdit",{get:function(){return this.contractSchema.capabilities.canEdit&&!this.schema.disableEditing&&!e.FieldListViewModelUtils.isAbandoned(this.contract)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"private",{get:function(){return t.hasFlag(this.contract.visibility,4)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"showAsVariationsOnly",{get:function(){return t.hasFlag(this.contract.visibility,2)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"showHidden",{get:function(){return this.schema.showHidden},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"canRefresh",{get:function(){return this.canEdit&&this.contract.capabilities.canRefresh},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"canEditEntity",{get:function(){return this.canEdit&&!this.calculated&&this.contract.capabilities.canEditSource},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"canDelete",{get:function(){return this.canEdit&&this.contract.capabilities.canDelete},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"canRename",{get:function(){return this.canEdit&&this.contract.capabilities.canRename},enumerable:!1,configurable:!0}),a.prototype.findFields=function(e,t){return this.findFieldsByType(e,t,0)},a.prototype.findKpis=function(e,t){return this.findFieldsByType(e,t,4)},a.prototype.findKpiMeasures=function(e,t){return this.findFieldsByType(e,t,5)},a.prototype.findHierarchies=function(e,t){return this.findFieldsByType(e,t,2)},a.prototype.findFieldsByType=function(t,i,r){var e=[];2===r?e.push.apply(e,_.filter(this.hierarchies,(function(e){return e.name===t&&e.schema.name===i}))):e.push.apply(e,_.filter(this.properties,(function(e){return e.name===t&&e.fieldType===r&&e.schemaName===i})));for(var n=0,a=this.displayFolders;n<a.length;n++)for(var o=a[n],s=0,l=_.filter(o.getAllChildren(),(function(e){return e.name===t&&e.fieldType===r}));s<l.length;s++){var u=l[s];e.indexOf(u)<0&&e.push(u)}if(!_.isEmpty(e))return e},Object.defineProperty(a.prototype,"userEntity",{get:function(){return!(this.private||this.showAsVariationsOnly)},enumerable:!1,configurable:!0}),a);function a(e,t,i){this.hasCheckedProperties=!1,this.contract=e,this.contractSchema=t,this.schema=i,this.properties=[],this.columnsAndMeasures=[],this.hierarchies=[],this.displayFolders=[]}e.FieldListConceptualEntity=n;var o=(Object.defineProperty(s.prototype,"children",{get:function(){return this._children},set:function(e){this._children=e},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"name",{get:function(){return this.contract.name},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"schemaName",{get:function(){return this.schema.name},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"displayName",{get:function(){return this.displayNameOverride||this.contract.displayName},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"description",{get:function(){return this.contract.description},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"errorMessage",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"visible",{get:function(){return!this.parent||this.parent.expanded&&this.parent.visible},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"hidden",{get:function(){return this.contract.hidden},set:function(e){this.contract.hidden=e},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"showHidden",{get:function(){return this.entity.showHidden},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"canEdit",{get:function(){return!this.variation&&this.schema.capabilities.canEdit&&!this.entity.schema.disableEditing},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"disableDragging",{get:function(){return this.entity.schema.disableDragging},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"disableSelectionOnFocus",{get:function(){return this.entity.schema.disableSelectionOnFocus},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"showCheckboxes",{get:function(){return this.entity.schema.showCheckboxes},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"isExtension",{get:function(){return!1},enumerable:!1,configurable:!0}),s);function s(e,t,i){this.hasCheckedChildren=!1,this.contract=e,this.schema=t,this.entity=i,this.id=r.getUniqueId()}e.FieldListConceptualItem=o;var l,u=(__extends(c,l=o),Object.defineProperty(c.prototype,"kind",{get:function(){return this.contract.kind},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"defaultAggregate",{get:function(){return this.contract.column?this.contract.column.defaultAggregate:null},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"type",{get:function(){return this.contract.type},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"idOnEntityKey",{get:function(){return!!this.contract.column&&this.contract.column.idOnEntityKey},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"errorMessage",{get:function(){return this.contract.errorMessage},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"canDelete",{get:function(){return this.canEdit&&!1!==this.contract.canDelete},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"canAddToFilter",{get:function(){return!this.contract.measure||!this.schema.capabilities.limitMultiColumnFiltersToQueryGroupColumns},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"properties",{get:function(){return this.children},enumerable:!1,configurable:!0}),c.prototype.clone=function(){return new c(this.contract,this.schema,this.entity)},c);function c(e,t,i,r,n){i=l.call(this,e,t,i)||this;return i.children=[],i.originalEntity=r,i.variation=n,i.expanded=!1,i.draggable=!i.disableDragging,i.fieldType=0,i}e.FieldListConceptualProperty=u;var p,n=(__extends(d,p=o),Object.defineProperty(d.prototype,"defaultAggregate",{get:function(){return 3},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"isExtension",{get:function(){return!1},enumerable:!1,configurable:!0}),d.prototype.clone=function(){return new d(this.contract,this.schema,this.entity)},d);function d(e,t,i){var r=this;return(r=p.call(this,e,t,i)||this).fieldType=6,r}e.FieldListConceptualRowCount=n;var h,n=(__extends(g,h=u),Object.defineProperty(g.prototype,"defaultAggregate",{get:function(){return 2},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"idOnEntityKey",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"isExtension",{get:function(){return!0},enumerable:!1,configurable:!0}),g.prototype.clone=function(){return new g(this.contract,this.schema,this.entity)},g);function g(e,t,i){return h.call(this,e,t,i)||this}e.FieldListConceptualExtensionMeasure=n;var v,n=(__extends(m,v=u),Object.defineProperty(m.prototype,"hidden",{get:function(){return this.parent.hidden},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"name",{get:function(){return this.hierarchyLevelContract.name},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"displayName",{get:function(){return this.displayNameOverride||this.hierarchyLevelContract.displayName},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"description",{get:function(){return this.hierarchyLevelContract.description},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"canDelete",{get:function(){return!this.variation&&this.canEdit&&!1!==this.hierarchyLevelContract.canDelete},enumerable:!1,configurable:!0}),m.prototype.clone=function(e){e=e||this.parent;return new m(this.hierarchyLevelContract,this.schema,e,this.entity)},m);function m(e,t,i,r,n,a){var o=this;return(o=v.call(this,e.column,t,r)||this).originalEntity=n,o.variation=a,o.hierarchyLevelContract=e,o.parent=i,o.fieldType=3,o}e.FieldListConceptualHierarchyLevel=n;var f,D=(__extends(y,f=o),Object.defineProperty(y.prototype,"properties",{get:function(){return this.hierarchyLevels},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"children",{get:function(){return this.hierarchyLevels},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"canDelete",{get:function(){return!this.variation&&this.canEdit&&!1!==this.contract.canDelete},enumerable:!1,configurable:!0}),y.prototype.findLevel=function(t,e){return _.find(this.hierarchyLevels,(function(e){return e.name===t}))},y.prototype.clone=function(){var t=new y(this.contract,this.schema,this.entity);return t.hierarchyLevels=_.map(this.hierarchyLevels,(function(e){return e.clone(t)})),t},y);function y(e,t,i,r,n){i=f.call(this,e,t,i)||this;return i.expanded=!1,i.hierarchyLevels=[],i.originalEntity=r,i.variation=n,i.draggable=!i.disableDragging,i.fieldType=2,i}e.FieldListConceptualHierarchy=D;var C,n=(__extends(S,C=o),Object.defineProperty(S.prototype,"kind",{get:function(){return this.contract.kind},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"properties",{get:function(){return this.kpiMeasures},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"children",{get:function(){return this.kpiMeasures},enumerable:!1,configurable:!0}),S.prototype.clone=function(){var t=new S(this.contract,this.schema,this.entity);return t.kpiMeasures=_.map(this.kpiMeasures,(function(e){return e.clone(t)})),t},S);function S(e,t,i){i=C.call(this,e,t,i)||this;return i.expanded=!1,i.kpiMeasures=[],i.fieldType=4,i}e.FieldListConceptualKpi=n;var b,u=(__extends(E,b=u),Object.defineProperty(E.prototype,"displayName",{get:function(){var e;switch(this.kpiType){case 2:e=this.locOptions.KpiValueDisplayName;break;case 1:e=this.locOptions.KpiGoalDisplayName;break;case 0:e=this.locOptions.KpiStatusDisplayName;break;case 3:e=this.locOptions.KpiTrendDisplayName}return this.displayNameOverride||e||this.contract.displayName},enumerable:!1,configurable:!0}),E.prototype.clone=function(e){e=e||this.parent;return new E(this.contract,this.schema,this.kpiType,e,this.entity,this.locOptions)},E);function E(e,t,i,r,n,a){var o=this;return(o=b.call(this,e,t,n)||this).kpiType=i,o.parent=r,o.locOptions=a,o.draggable=!o.disableDragging,o.fieldType=5,o}e.FieldListConceptualKpiMeasure=u;var V,o=(__extends(w,V=o),Object.defineProperty(w.prototype,"hidden",{get:function(){return!_.some(this.children,(function(e){return!e.hidden}))},set:function(e){},enumerable:!1,configurable:!0}),w.prototype.clone=function(){},w.prototype.getAllChildren=function(){for(var e=[],t=0,i=this.children;t<i.length;t++){var r=i[t];e.push(r),1===r.fieldType&&e.push.apply(e,r.getAllChildren()||[])}return e},w);function w(e,t,i,r,n){var a=V.call(this,e,r,n)||this;a.expanded=!1,a.parent=i,a.children=t,a.fieldType=1;for(var o=0,s=t;o<s.length;o++)s[o].parent=a;return a}e.FieldListConceptualDisplayFolder=o})((e=x.explore||(x.explore={})).viewModels||(e.viewModels={}))})(powerbi=powerbi||{}),(function(e){(function(S){S.createFieldListViewModelFactory=function(e,t,i){return new r(e,t,i=void 0===i?!1:i)};var r=(e.prototype.createModel=function(e,t,i,r){for(var e=e.schemas,n=S.FieldListViewModelUtils.getExtensions(e),a=0,o=e=S.FieldListViewModelUtils.sortExtensionSchemasAtEnd(e);a<o.length;a++)var s=o[a],l=this.convertConceptualSchema(s,l,n,t,i,r);return l},e.prototype.convertConceptualSchema=function(t,i,r,e,n,a){var o=this;(i=i||new S.FieldListConceptualModel(t)).disableDragging=n;var s=_.filter(t.entities,(function(e){return!S.FieldListViewModelUtils.isExtension(e)||S.FieldListViewModelUtils.isAbandoned(e)})),n=_.map(s,(function(e){return o.convertConceptualEntity(e,t,i,r)}));return(s=i.entities).push.apply(s,n||[]),i.disableEditing=e,i.disableSelectionOnFocus=a,i},e.prototype.convertConceptualEntity=function(e,t,i,r){var n=this,a=new S.FieldListConceptualEntity(e,t,i);if(a.properties=[],e.properties&&!S.FieldListViewModelUtils.isExtension(e))for(var o,s=0,l=e.properties;s<l.length;s++)(y=l[s]).measure&&y.measure.kpi?(o=this.convertConceptualKpi(y,t,a),a.columnsAndMeasures.push(o),a.properties.push(o)):y.kpiValue||(o=this.convertConceptualProperty(y,t,a),a.columnsAndMeasures.push(o),a.properties.push(o));if(a.isMeasureGroup=S.FieldListViewModelUtils.isMeasureGroup(e.properties),a.expanded=!1,e.hierarchies&&0<e.hierarchies.length){a.hierarchies=_.map(e.hierarchies,(function(e){return n.convertConceptualHierarchy(e,t,a)}));for(var u=0,c=a.hierarchies;u<c.length;u++){var p=c[u];a.properties.push(p)}}if(r){var d=S.FieldListViewModelUtils.getExtensionKey(t.name,e.name);if(d=r.entities[d])for(var h=0,g=d;h<g.length;h++)for(var v=g[h],m=0,f=v.entity.properties;m<f.length;m++){var y=f[m],C=this.convertConceptualExtensionMeasure(y,v.schema,a);a.properties.push(C)}}return S.FieldListViewModelDisplayFolderMerger.mergeDisplayFolders(a,e.displayFolders,d,this),S.FieldListViewModelUtils.sortProperties(a.properties),S.FieldListViewModelUtils.removeDuplicateProperties(a.properties,a.displayFolders),S.FieldListViewModelUtils.flattenFolders(a),S.FieldListViewModelUtils.updatePropertiesWithChildren(a),this.withRowCounts&&0===e.visibility&&!t.capabilities.discourageQueryAggregateUsage&&(e=this.createConceptualRowCount(t,a),a.properties.unshift(e)),a},e.prototype.convertConceptualDisplayFolder=function(e,t,i,r){for(var n={},a={},o=0,s=r.properties;o<s.length;o++){var l=s[o];3===l.fieldType||2===l.fieldType?a[l.name]=l:n[l.name]=l}return this.convertConceptualDisplayFolderCore(e,t,i,n,a,r)},e.prototype.convertConceptualDisplayFolderCore=function(e,t,i,r,n,a){for(var o=[],s=0,l=e.properties;s<l.length;s++){var u=l[s];u&&(d=r[u.name])&&o.push(d.clone())}for(var c=0,p=e.hierarchies;c<p.length;c++){var d,h=p[c];h&&(d=n[h.name])&&o.push(d.clone())}for(var g=new S.FieldListConceptualDisplayFolder(e,o,i,t,a),v=0,m=e.displayFolders;v<m.length;v++){var f=m[v];g.children.push(this.convertConceptualDisplayFolderCore(f,t,g,r,n,a))}return S.FieldListViewModelUtils.sortProperties(g.children),g},e.prototype.convertConceptualHierarchy=function(e,t,i,r,n){var a=new S.FieldListConceptualHierarchy(e,t,i,r,n);a.hierarchyLevels=[];for(var o=0,s=e.levels;o<s.length;o++){var l=s[o];a.hierarchyLevels.push(this.convertConceptualHierarchyLevel(l,t,a))}return a},e.prototype.convertConceptualHierarchyLevel=function(e,t,i){return new S.FieldListConceptualHierarchyLevel(e,t,i,i.entity,i.originalEntity,i.variation)},e.prototype.convertConceptualProperty=function(e,t,i){for(var r=new S.FieldListConceptualProperty(e,t,i),n=0,a=S.FieldListViewModelUtils.getPropertyVariations(e);n<a.length;n++){var o=a[n];r.children.push(this.convertConceptualVariationHierarchy(o,t,r))}return r},e.prototype.convertConceptualVariationHierarchy=function(e,t,i){e=this.convertConceptualHierarchy(e.defaultHierarchy,t,i.entity,e.navigationProperty.targetEntity,e.name);return e.parent=i,e},e.prototype.convertConceptualExtensionMeasure=function(e,t,i){return new S.FieldListConceptualExtensionMeasure(e,t,i)},e.prototype.convertConceptualKpi=function(e,t,i){var r=new S.FieldListConceptualKpi(e,t,i),n={};n.KpiValueDisplayName=this.localizationService.get("KpiValueFieldListDisplayName"),n.KpiStatusDisplayName=this.localizationService.get("KpiStatusFieldListDisplayName"),n.KpiGoalDisplayName=this.localizationService.get("KpiGoalFieldListDisplayName"),n.KpiTrendDisplayName=this.localizationService.get("KpiTrendFieldListDisplayName");var a=e.measure.kpi,o=a.goal,s=a.status,a=a.trend;return r.kpiMeasures=[],r.kpiMeasures.push(this.convertConceptualKpiMeasure(e,t,2,r,i,n)),o&&r.kpiMeasures.push(this.convertConceptualKpiMeasure(o,t,1,r,i,n)),s&&r.kpiMeasures.push(this.convertConceptualKpiMeasure(s,t,0,r,i,n)),a&&r.kpiMeasures.push(this.convertConceptualKpiMeasure(a,t,3,r,i,n)),r},e.prototype.convertConceptualKpiMeasure=function(e,t,i,r,n,a){return new S.FieldListConceptualKpiMeasure(e,t,i,r,n,a)},e.prototype.createConceptualRowCount=function(e,t){var i={name:t.name,displayName:this.localizationService.get("QuickExplore_RowCount"),canDelete:!1,hidden:!1};return new S.FieldListConceptualRowCount(i,e,t)},e);function e(e,t,i){void 0===i&&(i=!1),this.withRowCounts=!1,this.localizationService=e,this.withRowCounts=i}})((e=e.explore||(e.explore={})).viewModels||(e.viewModels={}))})(powerbi=powerbi||{}),(function(e){var t,o,l;function p(e,t){return JSON.stringify({e:t})}function d(e){return e.hasOwnProperty("extends")}function i(e,t){return e=(e||"").toLocaleUpperCase(),t=(t||"").toLocaleUpperCase(),e.localeCompare(t)}t=e.explore||(e.explore={}),o=t.viewModels||(t.viewModels={}),l=e.explore.util.ModelAuthoringUtility,(t=o.FieldListViewModelUtils||(o.FieldListViewModelUtils={})).isMeasureGroup=function(e){return _.find(e,(function(e){return!e.hidden}))&&!_.find(e,(function(e){return!e.hidden&&1!==e.kind&&2!==e.kind}))},t.getExtensions=function(e){for(var t={entities:{}},i=0,r=e;i<r.length;i++){var n=r[i];if(d(n))for(var a=n.extends,o=0,s=n.entities;o<s.length;o++){var l,u,c=s[o];d(c)&&(l={schema:n,entity:c},u=p(0,c.name),(c=t.entities[u])?c.push(l):t.entities[u]=c=[l])}}return t},t.sortExtensionSchemasAtEnd=function(e){var t=_.filter(e,(function(e){return!d(e)})),e=_.filter(e,d);return _.union(t,e)},t.getExtensionKey=p,t.isExtension=d,t.isAbandoned=function(e){return e.isAbandoned},t.updatePropertiesWithChildren=function(e){for(var t=[],i=0,r=e.properties;i<r.length;i++)!(function e(t,i){t.push(i);if(!(i instanceof o.FieldListConceptualKpi||i instanceof o.FieldListConceptualHierarchy||i instanceof o.FieldListConceptualProperty))return;if(_.isEmpty(i.properties))return;for(var r=0,n=i.properties;r<n.length;r++){var a=n[r];e(t,a)}})(t,r[i]);e.properties=t},t.sortProperties=function(e){e&&e.sort((function(e,t){return i(e.displayName,t.displayName)}))},t.compareAlphabeticallyIgnoreCase=i,t.removeDuplicateProperties=function(e,t){var i;_.isEmpty(e)||(function e(t,i){if(_.isEmpty(t))return;var r=[];for(var n=0,a=t;n<a.length;n++)for(var o=a[n],s=0,l=o.children;s<l.length;s++){var u=l[s];1===u.fieldType?r.push(u):i[u.name]=u}e(r,i)}(t,i={}),_.remove(e,(function(e){return 1!==e.fieldType&&i[e.name]})))},t.flattenFolders=function(e){var t=[];!(function e(t,i){for(var r=0,n=t;r<n.length;r++){var a=n[r];i.push(a),1===a.fieldType&&e(a.children,i)}})(e.properties,t),e.properties=t},t.findTargetEntityViewModel=function(e,t){return _.find(e.entities,(function(e){return e.contract===t}))},t.getHierarchyLevelDictionary=function(e){var t={};if(!_.isEmpty(e))for(var i=0,r=e;i<r.length;i++){var n=r[i],a={};t[n.name]=a;for(var o=0,s=n.levels;o<s.length;o++){var l=s[o];a[l.column.name]=l}}return t},t.getPropertyVariations=function(e){var t=[];if(e.column&&e.column.variations)for(var i=0,r=e.column.variations;i<r.length;i++){var n=r[i],a=n.navigationProperty.targetEntity,o=n.defaultHierarchy;a&&a.hierarchies&&o&&!o.hidden&&t.push(n)}return t},t.applyItemRename=function(i,r,n,a,o,s){return __awaiter(this,void 0,e.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:a.displayNameOverride=s,e.label=1;case 1:return e.trys.push([1,,5,6]),(t=l.rename(o,s,n))?[4,t]:[3,4];case 2:return e.sent(),[4,i.get(r.get())];case 3:e.sent(),e.label=4;case 4:return[3,6];case 5:return a.displayNameOverride=null,[7];case 6:return[2]}}))}))}})(powerbi=powerbi||{}),(function(C){var n,e,d,a,S,u,c,s,h;n=C.explore||(C.explore={}),e=n.viewModels||(n.viewModels={}),d=C.data.FieldExprPattern,a=C.explore.utils.GroupUtils,S=C.data.SQExprBuilder,u=C.data.SQExprConverter,c=C.data.SQExprUtils,s=C.data.SQHierarchyExprUtils,h=C.explore.util.VisualContainerUtils,(function(e){function i(e,t,i,r,n,a,o,s){s=new l(e,n,a,t,i,r,o,s);return d.visit(e,s)}e.createAggregateMenuItems=i;var l=(t.prototype.visitEntity=function(e){return this.createMenuItems(this.sqExpr)},t.prototype.visitColumn=function(e){return this.createMenuItems(this.sqExpr)},t.prototype.visitColumnAggr=function(e){return this.createMenuItems(this.sqExpr)},t.prototype.visitGroupingColumn=function(e){return this.createMenuItems(this.sqExpr)},t.prototype.visitGroupingColumnAggr=function(e){return this.createMenuItems(this.sqExpr)},t.prototype.visitColumnHierarchyVariation=function(e){return this.createMenuItems(this.sqExpr)},t.prototype.visitColumnHierarchyLevelVariation=function(e){return this.createMenuItems(this.sqExpr)},t.prototype.visitColumnSubquery=function(e){return[]},t.prototype.visitColumnAggrSubquery=function(e){return[]},t.prototype.visitColumnTransformRef=function(e){return[]},t.prototype.visitEntityAggr=function(e){return this.createMenuItems(this.sqExpr)},t.prototype.visitHierarchy=function(e){return this.createMenuItems(this.sqExpr)},t.prototype.visitHierarchyLevel=function(e){return this.createMenuItems(this.sqExpr)},t.prototype.visitHierarchyLevelAggr=function(e){return this.createMenuItems(this.sqExpr)},t.prototype.visitMeasure=function(e){return[]},t.prototype.visitPercentOfGrandTotal=function(e){e=S.fieldExpr(e.baseExpr);return this.createMenuItemsForPercentOfTotal(e)},t.prototype.visitPercentOfRoleTotal=function(e){e=S.fieldExpr(e.baseExpr);return this.createMenuItemsForPercentOfTotal(e)},t.prototype.visitPercentile=function(e){return[]},t.prototype.visitSelectRef=function(e){return[]},t.prototype.visitFilteredEval=function(e){e=S.fieldExpr(e.baseExpr);return this.createMenuItems(e)},t.prototype.visitArithmetic=function(e){return[]},t.prototype.visitConstant=function(e){return[]},t.prototype.visitSparklineData=function(e){return[]},t.prototype.createMenuItemsForPercentOfTotal=function(e){var t=S.removeAggregate(e,this.schema).getMetadata(this.schema);if(!t)return[];t=t.type,t=t.text||t.dateTime||t.duration?[3,4]:[];return this.createMenuItems(e,t)},t.prototype.createMenuItems=function(e,t){void 0===t&&(t=[]);var i=[];if(!this.hasHierarchyLevels&&_.isEmpty(e.validate(this.schema,this.aggrOps))&&!c.discourageAggregation(e,this.schema)){var r=this.dataRoleKind===C.VisualDataRoleKind.Grouping,n=this.dataRoleKind===C.VisualDataRoleKind.GroupingOrMeasure,r=r&&!this.forceAggregateItems?[]:this.aggrOps.getSupportedAggregates(e,this.schema,this.requiredTypes),r=_.difference(r,t);(n&&!(function(e,t){t=e.getConceptualProperty(t);return t&&1===t.kind})(e,this.schema)&&!(function(e,t){t=u.asFieldPattern(e,t);return!(!t||!t.entityAggr)})(e,this.schema)||this.forceAggregateItems&&!_.isEmpty(r))&&i.push(this.createRemoveAggregateMenuItem());for(var a=0,o=r;a<o.length;a++){var s=o[a];i.push(this.createAggregateMenuItem(s))}}return i},t.prototype.createAggregateMenuItem=function(e){var t=o(this.property);t.key={action:4,aggregate:e};var i=S.removeAggregate(this.sqExpr,this.schema).getMetadata(this.schema),i=n.services.getAggregateKey(e,i);return t.text=C.common.getLocalize().get("Aggregate_"+i),t},t.prototype.createRemoveAggregateMenuItem=function(){var e=o(this.property);return e.key={action:2},e.text=C.common.getLocalize().get("FieldWell_RemoveAggregate"),e},t.prototype.visitTransformOutputRoleRef=function(e){return[]},t);function t(e,t,i,r,n,a,o,s){this.sqExpr=e,this.dataRoleKind=t,this.requiredTypes=i,this.schema=r,this.aggrOps=n,this.hasHierarchyLevels=a,this.property=o,this.forceAggregateItems=s}var p=(r.prototype.createConditionalFormattingOptions=function(){var t=this;!_.isEmpty(this.property.conditionalFormattingRepetitions)&&this.visual&&(this.conditionalFormattingOptions=this.property.conditionalFormattingRepetitions.map((function(e){return{repetition:e,propertyDefinition:C.VisualObjectRepetition.getDefinition(t.visual.objects,e)}})))},r.prototype.visitEntity=function(e){return this.menuItems},r.prototype.visitColumn=function(e){var t=this.property.expr;return 4096==(4096&this.supportedOperations)&&this.addConditionalFormattingMenuItems(t),4==(4&this.supportedOperations)&&this.addAggregateMenuItems(),16==(16&this.supportedOperations)&&this.addShowValueAsMenuItem(e.schema),64==(64&this.supportedOperations)&&this.addQuickCalcMenuItem(e.schema),8==(8&this.supportedOperations)&&this.addShowAllMenuItem(t),2048==(2048&this.supportedOperations)&&this.addHierarchiesMenuItems(this.property.hierarchyLevels),128==(128&this.supportedOperations)&&this.addVariationsMenuItems(e),256==(256&this.supportedOperations)&&this.addGroupsMenuItems(e),this.isFieldParameterOperations()&&this.addFieldParameterMenuItems(),this.menuItems},r.prototype.visitColumnAggr=function(e){var t=this.property.expr;return 2097152==(2097152&this.supportedOperations)&&this.addSparklineMenuItem(e.schema),4096==(4096&this.supportedOperations)&&this.addConditionalFormattingMenuItems(t),4==(4&this.supportedOperations)&&this.addAggregateMenuItems(),16==(16&this.supportedOperations)&&this.addShowValueAsMenuItem(e.schema),64==(64&this.supportedOperations)&&this.addQuickCalcMenuItem(e.schema),8==(8&this.supportedOperations)&&this.addShowAllMenuItem(t),2048==(2048&this.supportedOperations)&&this.addHierarchiesMenuItems(this.property.hierarchyLevels),128==(128&this.supportedOperations)&&this.addVariationsMenuItems(e),this.isFieldParameterOperations()&&this.addFieldParameterMenuItems(),this.menuItems},r.prototype.visitGroupingColumn=function(e){var t=this.property.expr;return this.addConditionalFormattingMenuItems(t),this.addAggregateMenuItems(),this.addShowValueAsMenuItem(e.schema),this.addQuickCalcMenuItem(e.schema),this.addShowAllMenuItem(t),this.addHierarchiesMenuItems(this.property.hierarchyLevels),this.addVariationsMenuItems(e),this.addGroupsMenuItems(e),this.menuItems},r.prototype.visitGroupingColumnAggr=function(e){var t=this.property.expr;return this.addSparklineMenuItem(e.schema),this.addConditionalFormattingMenuItems(t),this.addAggregateMenuItems(),this.addShowValueAsMenuItem(e.schema),this.addQuickCalcMenuItem(e.schema),this.addShowAllMenuItem(t),this.addHierarchiesMenuItems(this.property.hierarchyLevels),this.addVariationsMenuItems(e),this.menuItems},r.prototype.visitColumnHierarchyVariation=function(e){return this.menuItems},r.prototype.visitColumnHierarchyLevelVariation=function(e){var t=this.property.expr;return this.addAggregateMenuItems(),this.addShowValueAsMenuItem(e.source.schema),this.addQuickCalcMenuItem(e.source.schema),this.addShowAllMenuItem(t),this.addHierarchiesMenuItems(this.property.hierarchyLevels),this.menuItems},r.prototype.visitColumnSubquery=function(e){return this.menuItems},r.prototype.visitColumnAggrSubquery=function(e){return this.menuItems},r.prototype.visitColumnTransformRef=function(e){return this.menuItems},r.prototype.visitEntityAggr=function(e){var t=this.property.expr;return this.addAggregateMenuItems(),this.addShowValueAsMenuItem(e.schema),this.addQuickCalcMenuItem(e.schema),this.addShowAllMenuItem(t),this.menuItems},r.prototype.visitHierarchy=function(e){return this.addAggregateMenuItems(),this.addShowValueAsMenuItem(e.schema),this.addShowAllMenuItem(_.head(this.property.hierarchyLevels).expr),this.addHierarchiesMenuItems(this.property.hierarchyLevels),this.menuItems},r.prototype.visitHierarchyLevel=function(e){var t=this.property.expr;return this.addAggregateMenuItems(),this.addShowValueAsMenuItem(e.schema),this.addQuickCalcMenuItem(e.schema),this.addShowAllMenuItem(t),this.addHierarchiesMenuItems(this.property.hierarchyLevels),this.menuItems},r.prototype.visitHierarchyLevelAggr=function(e){var t=this.property.expr;return this.addSparklineMenuItem(e.schema),this.addConditionalFormattingMenuItems(t),this.addAggregateMenuItems(),this.addShowValueAsMenuItem(e.schema),this.addQuickCalcMenuItem(e.schema),this.addShowAllMenuItem(t),this.menuItems},r.prototype.visitMeasure=function(e){var t=this.property.expr;return this.addSparklineMenuItem(e.schema),this.addConditionalFormattingMenuItems(t),this.addShowValueAsMenuItem(e.schema),this.addQuickCalcMenuItem(e.schema),this.addShowAllMenuItem(t),this.menuItems},r.prototype.visitPercentile=function(e){var t=this.property.expr;return this.addConditionalFormattingMenuItems(t),this.menuItems},r.prototype.visitSelectRef=function(e){return[]},r.prototype.visitTransformOutputRoleRef=function(e){return[]},r.prototype.visitPercentOfGrandTotal=function(e){return this.addPercentTotalMenuItems(e.baseExpr)},r.prototype.visitPercentOfRoleTotal=function(e){return this.addPercentTotalMenuItems(e.baseExpr)},r.prototype.visitFilteredEval=function(e){return this.addFilteredEvalMenuItems()},r.prototype.visitArithmetic=function(e){return this.menuItems},r.prototype.visitConstant=function(e){return this.menuItems},r.prototype.visitSparklineData=function(e){return this.addEditSparklineMenuItem(),this.menuItems},r.prototype.isFieldParameterOperations=function(){return 16777216==(16777216&this.supportedOperations)||8388608==(8388608&this.supportedOperations)},r.prototype.addFieldParameterMenuItems=function(){this.property.expr.getConceptualProperty(this.schema)&&(this.menuItems.push(this.createSeparatorMenuItem()),16777216==(16777216&this.supportedOperations)?this.menuItems.push(this.createColumnToParameter()):8388608==(8388608&this.supportedOperations)&&this.menuItems.push(this.createParameterToColumn()))},r.prototype.addFilteredEvalMenuItems=function(){return this.addAggregateMenuItems(),this.menuItems},r.prototype.addPercentTotalMenuItems=function(e){var t=S.fieldExpr(e);this.addConditionalFormattingMenuItems(t),this.addAggregateMenuItems(),this.addShowValueAsMenuItem(d.getSchema(e)),this.addShowAllMenuItem(t),this.addHierarchiesMenuItems(this.property.hierarchyLevels);e=d.getProperty(e);return e&&this.addVariationsMenuItems(e),this.menuItems},r.prototype.addAggregateMenuItems=function(){var e,t=i(this.property.expr,this.schema,this.aggrOps,!_.isEmpty(this.property.hierarchyLevels),this.dataRole.kind,this.dataRole.requiredTypes,this.property,this.forceAggregateItems);_.isEmpty(t)||(this.menuItems.push(this.createSeparatorMenuItem()),(e=this.menuItems).push.apply(e,t||[]))},r.prototype.addConditionalFormattingMenuItems=function(e){_.isEmpty(this.conditionalFormattingOptions)||e.getMetadata(this.schema)&&(h.hasGroupByItems(this.visual.query)||(this.menuItems.push(this.createSeparatorMenuItem()),this.addSetConditionalFormattingMenuItem(),this.addRemoveConditionalFormattingMenuItem()))},r.prototype.addSetConditionalFormattingMenuItem=function(){if(!_.isEmpty(this.conditionalFormattingOptions)){var e=o(this.property);e.text=C.common.getLocalize().get("FieldWell_ConditionalFormatting"),this.menuItems.push(e);for(var t=e.children=[],i=0,r=this.conditionalFormattingOptions;i<r.length;i++){var n=r[i];t.push(this.createConditionalFormattingMenuItem(n.repetition.propertyDescriptor.displayName,4096,n))}}},r.prototype.addRemoveConditionalFormattingMenuItem=function(){if(!_.isEmpty(this.conditionalFormattingOptions)){var e=o(this.property);if(e.text=C.common.getLocalize().get("FieldWell_RemoveConditionalFormatting"),this.menuItems.push(e),_.some(this.conditionalFormattingOptions,(function(e){return null!=e.propertyDefinition}))){var t=e.children=[];t.push(this.createConditionalFormattingMenuItem(C.data.createDisplayNameGetter("All"),8192));for(var i=0,r=this.conditionalFormattingOptions;i<r.length;i++){var n=r[i],a=this.createConditionalFormattingMenuItem(n.repetition.propertyDescriptor.displayName,16384,n);a.disabled=null==n.propertyDefinition,t.push(a)}}else e.disabled=!0}},r.prototype.createConditionalFormattingMenuItem=function(e,t,i){var r=o(this.property);return r.key={action:t,conditionalFormattingOptions:i},r.text=C.data.getDisplayName(e,C.common.getLocalize()),r},r.prototype.addShowAllMenuItem=function(e){e=c.isMeasure(e);h.hasGroupByItems(this.visual.query)||this.dataRole.kind!==C.VisualDataRoleKind.Grouping&&(this.dataRole.kind!==C.VisualDataRoleKind.GroupingOrMeasure||e)||(this.menuItems.push(this.createSeparatorMenuItem()),this.menuItems.push(this.createShowAllMenuItem()))},r.prototype.addHierarchiesMenuItems=function(e){var t;_.isEmpty(e)||(t=_.head(e),(t=s.expandExpr(this.schema,t.expr.arg))instanceof Array&&t.length===e.length||this.bucket.supportsMultipleItems&&(this.menuItems.push(this.createSeparatorMenuItem()),this.menuItems.push(this.createRestoreHierarchyMenuItem())))},r.prototype.addShowValueAsMenuItem=function(e){_.isEmpty(this.property.hierarchyLevels)&&this.property.expr.getConceptualProperty(this.schema)&&(e=(e=this.schema.schema(e))&&e.capabilities.supportsScopedEval,!h.hasGroupByItems(this.visual.query)&&e&&this.dataRole.kind!==C.VisualDataRoleKind.Grouping&&(e=this.property.expr,e=this.showValueAsService.createShowValueAsMenuItems(e,this.schema,this.visual.visualType),_.isEmpty(e)||(this.menuItems.push(this.createSeparatorMenuItem()),this.menuItems.push(this.createShowValueAsMenuItem(e)))))},r.prototype.addQuickCalcMenuItem=function(e){!this.property.expr.getConceptualProperty(this.schema)||((e=this.schema.schema(e))&&e.capabilities.canEdit&&!e.isExtensionSchema||this.canAuthorReportMeasuresOnSchema(e))&&(this.menuItems.push(this.createSeparatorMenuItem()),this.menuItems.push(this.createQuickCalcMenuItem()))},r.prototype.canAuthorReportMeasuresOnSchema=function(e){return e.capabilities.isExtendable||e.isExtensionSchema},r.prototype.addSparklineMenuItem=function(e){this.featureSwitchService.featureSwitches.sparklines&&(!this.dataRole.supportsSparklines||(e=this.schema.schema(e))&&e.capabilities.supportsSparklineData&&(this.menuItems.push(this.createSeparatorMenuItem()),(e=o(this.property)).key={action:2097152},e.text=C.common.getLocalize().get("Sparkline_AddOption"),this.menuItems.push(e)))},r.prototype.addEditSparklineMenuItem=function(){var e;this.featureSwitchService.featureSwitches.sparklines&&(this.menuItems.push(this.createSeparatorMenuItem()),(e=o(this.property)).key={action:4194304},e.text=C.common.getLocalize().get("Sparkline_EditOption"),this.menuItems.push(e))},r.prototype.addVariationsMenuItems=function(e){var t=S.fromColumn(e),i=t.getConceptualProperty(this.schema);if(i){var r=i.column;if(r&&!_.isEmpty(r.variations)){for(var n=S.entity(e.schema,e.entity),t=this.createVariationMenuItem(i.displayName,t),a=[],o=0,s=r.variations;o<s.length;o++){var l=s[o];if(l.navigationProperty&&l.navigationProperty.targetEntity){var u=l.navigationProperty.targetEntity;if(this.dataRole.kind!==C.VisualDataRoleKind.Measure)for(var c=0,p=_.filter(u.hierarchies,(function(e){return!e.hidden}));c<p.length;c++){var d=p[c],h=S.hierarchy(S.propertyVariationSource(n,l.name,i.name),d.name);a.push(this.createVariationMenuItem(d.name,h))}for(var g=S.entity(n.schema,u.name),v=0,m=_.filter(u.properties,(function(e){return!e.hidden}));v<m.length;v++){var f=m[v],y=S.columnRef(g,f.name);a.push(this.createVariationMenuItem(f.displayName,y))}}}_.isEmpty(a)||(this.menuItems.push(this.createSeparatorMenuItem()),this.menuItems.push(t),(t=this.menuItems).push.apply(t,a||[]))}}},r.prototype.addGroupsMenuItems=function(e){var t,i,r=this.schema.schema(e.schema);!1!==(r&&r.capabilities.canEdit&&r.capabilities.supportsGrouping)&&(t=this.featureSwitchService.featureSwitches.enableGroupAuthoring,i=[],r=this.property.expr.getConceptualProperty(this.schema),t&&(!a.canExprBeGrouped(this.schema,this.property.expr)||this.property.hierarchyLevels&&0<this.property.hierarchyLevels.length||i.push(this.createGroupsMenuItem()),a.isGroupOrBinColumn(e.entity,r,this.groupingDesignStateService)&&i.push(this.createEditGroupsMenuItem())),a.isClusteringColumn(e.entity,r,this.groupingDesignStateService)&&i.push(this.createEditClusteringMenuItem()),0<i.length&&(this.menuItems.push(this.createSeparatorMenuItem()),(r=this.menuItems).push.apply(r,i||[])))},r.prototype.createShowValueAsMenuItem=function(e){var t=o(this.property);t.key={action:16};return t.text=C.common.getLocalize().get("FieldWell_ShowValueAs"),t.children=e,t},r.prototype.createQuickCalcMenuItem=function(){var e=o(this.property);e.key={action:64};return e.text=C.common.getLocalize().get("QuickCalc_NewMeasure"),e},r.prototype.createGroupsMenuItem=function(){var e=o(this.property);return e.key={action:256},e.text=C.common.getLocalize().get("ContextMenuItem_CreateGroups"),e},r.prototype.createEditGroupsMenuItem=function(){var e=o(this.property);return e.text=C.common.getLocalize().get("ContextMenuItem_EditGroups"),e.key={action:512},e},r.prototype.createEditClusteringMenuItem=function(){var e=o(this.property);return e.text=C.common.getLocalize().get("Clustering_EditClusters"),e.key={action:1024},e},r.prototype.createRestoreHierarchyMenuItem=function(){var e=o(this.property);return e.text=C.common.getLocalize().get("FieldWell_RestoreHierarchy"),e.key={action:2048},e},r.prototype.createVariationMenuItem=function(e,t){var i=o(this.property);return i.text=e,i.key={action:128,variationExpr:t},i},r.prototype.createShowAllMenuItem=function(){var e=o(this.property);return e.key={action:8},e.text=C.common.getLocalize().get("FieldWell_ShowAll"),e},r.prototype.createDeleteMenuItem=function(){var e=o(this.property);return e.key={action:1},e.text=C.common.getLocalize().get("FieldWell_Remove"),e},r.prototype.createSeparatorMenuItem=function(){var e=o(this.property);return e.type=1,e},r.prototype.createRenameMenuItem=function(){var e=o(this.property);return e.key={action:32768},e.text=C.common.getLocalize().get("FieldWell_RenameForThisVisual"),e},r.prototype.createParameterToColumn=function(){var e=o(this.property);return e.key={action:8388608},e.text=C.common.getLocalize().get("FieldParameter_ConvertParameterToColumn"),e},r.prototype.createColumnToParameter=function(){var e=o(this.property);return e.key={action:16777216},e.text=C.common.getLocalize().get("FieldParameter_ConvertColumnToParameter"),e},r.prototype.createMoveToBucketsMenuItem=function(){for(var e=[],t=0,i=this.buckets;t<i.length;t++){var r,n=i[t];this.bucket.equals(n)||((r=o(this.property)).text=n.displayName,r.key={action:262144,moveFieldBucketOptions:{role:n.role,targetIndex:n.properties?n.properties.length:0,displayName:n.displayName}},e.push(r))}return e},r.prototype.createMoveToGroupMenuItem=function(){var e=o(this.property);return e.key={action:524288},e.text=C.common.getLocalize().get("ItemAction_MoveTo"),e.children=this.createMoveToBucketsMenuItem(),e},r.prototype.createMoveUpMenuItem=function(){var e=o(this.property);e.text=C.common.getLocalize().get("ItemAction_Move_Up");var t={action:65536},i=this.findFieldPropertyIndexInBucket();return i<=0?e.disabled=!0:(i=this.bucket.properties[i-1],t.moveFieldPropertyOptions={role:i.role,startIndex:i.startIndex,hierarchyLevelsLength:i.hierarchyLevels?i.hierarchyLevels.length:0}),e.key=t,e},r.prototype.createMoveDownMenuItem=function(){var e=o(this.property);e.text=C.common.getLocalize().get("ItemAction_Move_Down");var t={action:131072},i=this.findFieldPropertyIndexInBucket();return i>=this.bucket.properties.length-1?e.disabled=!0:(i=this.bucket.properties[i+1],t.moveFieldPropertyOptions={role:i.role,startIndex:i.startIndex,hierarchyLevelsLength:i.hierarchyLevels?i.hierarchyLevels.length:0}),e.key=t,e},r.prototype.createMoveToTopMenuItem=function(){var e=o(this.property);e.text=C.common.getLocalize().get("ItemAction_Move_Top");var t={action:65536},i=this.bucket.properties[0];return this.property.equals(i)?e.disabled=!0:t.moveFieldPropertyOptions={role:i.role,startIndex:i.startIndex,hierarchyLevelsLength:i.hierarchyLevels?i.hierarchyLevels.length:0},e.key=t,e},r.prototype.createMoveToBottomMenuItem=function(){var e=o(this.property);e.text=C.common.getLocalize().get("ItemAction_Move_Bottom");var t={action:131072},i=this.bucket.properties[this.bucket.properties.length-1];return this.property.equals(i)?e.disabled=!0:t.moveFieldPropertyOptions={role:i.role,startIndex:i.startIndex,hierarchyLevelsLength:i.hierarchyLevels?i.hierarchyLevels.length:0},e.key=t,e},r.prototype.findFieldPropertyIndexInBucket=function(){var t=this;return _.findIndex(this.bucket.properties,(function(e){return t.property.equals(e)}))},r.prototype.createMoveGroupMenuItem=function(){var e=o(this.property);return e.key={action:524288},e.text=C.common.getLocalize().get("ItemAction_Move"),e.children=[this.createMoveUpMenuItem(),this.createMoveDownMenuItem(),this.createMoveToTopMenuItem(),this.createMoveToBottomMenuItem()],e},r);function r(e,t,i,r,n,a,o,s,l,u,c){this.property=e,this.bucket=t,this.buckets=i,this.dataRole=r,this.forceAggregateItems=n,this.schema=a,this.aggrOps=o,this.visual=s,this.featureSwitchService=l,this.groupingDesignStateService=u,this.showValueAsService=c,this.supportedOperations=null!==(c=this.property.supportedOperations)&&void 0!==c?c:33554431,this.menuItems=[],1==(1&this.supportedOperations)&&this.menuItems.push(this.createDeleteMenuItem()),this.property.interactivityOptions.isEditableField&&32768==(32768&this.supportedOperations)&&this.menuItems.push(this.createRenameMenuItem()),524288==(524288&this.supportedOperations)&&(1<this.bucket.properties.length&&this.menuItems.push(this.createMoveGroupMenuItem()),1<this.buckets.length&&this.menuItems.push(this.createMoveToGroupMenuItem())),this.createConditionalFormattingOptions()}function o(){return{type:0}}e.createDropDownItems=function(e,t,i,r,n,a,o,s,l,u,c){return{items:d.visit(e.expr,new p(e,t,i,r,n,a,o,s,l,u,c))}}})(e.MenuItemFactory||(e.MenuItemFactory={}))})(powerbi=powerbi||{}),(function(e){(function(e){var t=function(e,t,i){for(var r=[],n=3;n<arguments.length;n++)r[n-3]=arguments[n];this.kind=e,this.name=i.format(t,r)};e.ShowValueAsCalculation=t;var i,r=(__extends(n,i=t),n);function n(e){return i.call(this,void 0,"ShowValueAs_Calculation_None",e)||this}e.ShowValueAsNoCalculation=r;var a,r=(__extends(o,a=t),o);function o(e){return a.call(this,0,"ShowValueAs_Calculation_PercentOfGrandTotal",e)||this}e.ShowValueAsPercentOfGrandTotalCalculation=r;var s,t=(__extends(l,s=t),l);function l(e,t,i){i=s.call(this,1,"ShowValueAs_Calculation_PercentOfRoleTotal",e,i)||this;return i.roles=t,i}e.ShowValueAsPercentOfRoleTotalCalculation=t})((e=e.explore||(e.explore={})).viewModels||(e.viewModels={}))})(powerbi=powerbi||{}),(function(F){var A;(function(S){var a=F.common.models.ApplyStyle,s=jsCommon.ArrayExtensions,o=F.visuals.plugins,b=F.data.SQExpr,t=jsCommon.StringExtensions,E=F.explore.util.VisualContainerUtils;function r(e,t,i){var r=!0,n=t&&t.featureSwitches.userFavoriteResourcePackagesEnabled&&e.custom&&i.isFavoritePublicCustomVisual(e.name),a=t&&t.featureSwitches.userFavoriteResourcePackagesEnabled&&e.custom&&e.favoriteId||n,o=t&&t.featureSwitches.userFavoriteResourcePackagesEnabled&&e.custom&&!e.favoriteId&&!n,n=t&&t.featureSwitches.tenantOutOfBoxVisualsEnabled&&e.custom&&e.isOutOfBox,i=t&&t.featureSwitches.personalVisualizationPaneEnabled&&i.isUnpinnedVisual(e.name);return r=e.custom&&!n&&o||i&&!a?!1:r}S.isPersonalVisualizationPaneVisual=r;var e,i=(Object.defineProperty(n.prototype,"activeSectionIndex",{get:function(){var t=this,e=_.findIndex(this.sections,(function(e){return e.sectionType===t.activeSection}));return-1!==e?e:0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"activePageSectionIndex",{get:function(){var t=this,e=_.findIndex(this.pagePaneSections,(function(e){return e.sectionType===t.activePageSection}));return-1!==e?e:0},enumerable:!1,configurable:!0}),n);function n(){this.sections=[],this.activeSection=S.VisualizationPaneSectionType.Fields,this.previousSection=S.VisualizationPaneSectionType.Fields,this.pagePaneSections=[],this.activePageSection=S.PagePaneSectionType.Fields,this.previousPageSection=S.PagePaneSectionType.Fields,this.isPaneExpanded=!1,this.isPaneVisible=!0,this.title="Format",this.icon="PBIFormat",this.visualPluginFilter=r,this.nonPersonalVisualizationPaneFilter=function(e,t,i){return!r(e,t,i)}}function c(e,t){return{contract:e,selected:!1,displayName:e.displayName,menuItems:S.ExplorationContainerViewModelFactory.createNavigationMenuItems(t)}}function l(e,t,i,r,n){return{isPaneVisible:n=void 0===n?!1:n,isPaneExpanded:r=void 0===r?!0:r,title:e,icon:t,closePaneLabel:i}}function u(){return{isPaneExpanded:!0,isPaneVisible:!0,title:"Data",icon:"PBIData"}}function p(){return new i}function d(e,t,i,r){var n=x(t,r=void 0===r?F.common.getLocalize():r);switch(e){case o.table.name:case o.tableEx.name:return{class:"table",title:n};case o.matrix.name:case o.pivotTable.name:return{class:"matrix",title:n};case o.scatterChart.name:return{class:"scatter",title:n};case o.barChart.name:return{class:"columnHoriz",title:n};case o.clusteredBarChart.name:return{class:"clusteredBarHoriz",title:n};case o.hundredPercentStackedBarChart.name:return{class:"column100Horiz",title:n};case o.ribbonChart.name:return{class:"ribbon",title:n};case o.columnChart.name:return{class:"columnVert",title:n};case o.clusteredColumnChart.name:return{class:"clusteredBarVert",title:n};case o.dataDotClusteredColumnComboChart.name:return{class:"dataDotClusteredColumnCombo",title:n};case o.dataDotStackedColumnComboChart.name:return{class:"dataDotStackedColumnCombo",title:n};case o.hundredPercentStackedColumnChart.name:return{class:"column100Vert",title:n};case o.realTimeLineChart.name:case o.lineChart.name:return{class:"line",title:n};case o.areaChart.name:return{class:"area",title:n};case o.stackedAreaChart.name:return{class:"stackedArea",title:n};case o.lineClusteredColumnComboChart.name:return{class:"lineClusteredColumnCombo",title:n};case o.lineStackedColumnComboChart.name:return{class:"lineStackedColumnCombo",title:n};case o.pieChart.name:return{class:"pie",title:n};case o.treemap.name:return{class:"tree",title:n};case o.sunburst.name:return{class:"sunburst",title:n};case o.map.name:return{class:"map",title:n};case o.filledMap.name:return{class:"filledMap",title:n};case o.azureMap.name:return{class:"azureMap",title:n};case o.shapeMap.name:return{class:"shapeMap",title:n};case o.funnel.name:return{class:"funnel",title:n};case o.gauge.name:return{class:"gauge",title:n};case o.multiRowCard.name:return{class:"card",title:n};case o.card.name:return{class:"calloutCard",title:n};case o.waterfallChart.name:return{class:"waterfall",title:n};case o.slicer.name:return{class:"slicerVert",title:n};case o.donutChart.name:return{class:"donut",title:n};case o.kpi.name:return{class:"kpi",title:n};case o.scriptVisual.name:return{class:"rScriptImageVisual",title:n};case o.pythonVisual.name:return{class:"pythonImageVisual",title:n};case o.debugVisual.name:return{class:"debugger",title:n};case o.textbox.name:return{class:"smartNarratives",title:n};case o.basicShape.name:case o.shape.name:case o.actionButton.name:case o.image.name:return{class:null,title:n};case o.keyDriversVisual.name:return{class:"keyDrivers",title:n};case o.qnaVisual.name:return{class:"qna",title:n};case o.decompositionTreeVisual.name:return{class:"decompositionTree",title:n};case o.scorecard.name:return{class:"scorecard",title:n};case o.rdlVisual.name:return{class:"rdlVisual",title:n};default:if(i&&i.isTrustedVisual(e)){var a=i.getVisualTypeOptions(e);if(a)return{class:a.class,title:a.titleKey?r.get(a.titleKey):e,watermarkKey:a.watermarkKey}}return}}function h(e,t,i){return d(e.name,e.titleKey,t,i)||{class:e.class,title:e.name}}function g(e,t,i,r,n,a){for(var o=[],s=0,l=e;s<l.length;s++){var u=l[s];r&&!r(u,t,i)||o.push(v(u,t,i,n,a))}return o}function v(e,t,i,r,n){var a=(n=void 0===n?F.common.getLocalize():n).get("AddToFavorites_ContextMenu"),o=n.get("RemoveFromFavorites_ContextMenu"),s=n.get("AboutVisualDialog_About"),l={plugin:e,enabled:!0,active:!1,menuItems:[]},u=h(e,r,n);l.class=u.class,l.title=u.title,u.watermarkKey&&(e.watermarkKey=u.watermarkKey);var c=t&&t.featureSwitches.userFavoriteResourcePackagesEnabled&&e.custom&&i.isFavoritePublicCustomVisual(e.name),r=t&&t.featureSwitches.userFavoriteResourcePackagesEnabled&&e.custom&&e.favoriteId||c,n=t&&t.featureSwitches.userFavoriteResourcePackagesEnabled&&e.custom&&!e.favoriteId&&!c,u=t&&t.featureSwitches.tenantOutOfBoxVisualsEnabled&&e.custom&&e.isOutOfBox,c=t&&t.featureSwitches.personalVisualizationPaneEnabled&&i.isUnpinnedVisual(e.name),t=t&&t.featureSwitches.personalVisualizationPaneEnabled&&!i.isUnpinnedVisual(e.name),i=null;e.custom&&r?i=m(o,4):e.custom&&!u&&n?i=m(a,3):c?i=m(a,7):e.custom&&!u||!t||(i=m(o,6)),i&&l.menuItems.push(i),e.custom&&(l.title=e.displayName||e.name.match(/([A-z\s]+)/g)[0]);s=m(s,5);return l.menuItems.push(s),l.tooltipConfig={tooltipTitle:l.title,tooltipShowOnFocus:!0},l}function m(e,t){return{text:e,hasGlyph:!1,labelClass:"visualContextMenu itemLabel",action:t,type:DropDownMenuItemType.Item,checked:!1,hrefTarget:jsCommon.DOMConstants.selfValue}}function f(o,s,l){l.hostServices={getFilters:function(e,t){return e.calculateVisualContainerFilter(o,s,l.contract,t)},getDataSourceVariables:function(){return o.dataSourceVariables},getVisualRelationshipFilterAction:function(e,t,i){return t.relationshipFilterAction(s,e,l.contract,i)},selectDataPoint:function(e,t,i,r,n,a){e.setFilterOnSelectData(o,t,s,l.contract,i,r,n,a)},setVisualRelationshipFilterAction:function(e,t,i,r){return r.setVisualRelationship(s,e,t,i)}}}function y(e,t,i,r){var n=new S.ExploreCanvas(t,i);if(t.visualContainers&&(n.visualContainers=s.extendWithId(_(t.visualContainers).map((function(e){return w(e,i,r)})).filter((function(e){return!!e})).value()),n.visualContainerGroups=1===i?__spreadArray([],n.visualContainers):C(t.visualContainerGroups,n.visualContainers,i,r),!_.isEmpty(n.visualContainers)))for(var a=0,o=n.visualContainers;a<o.length;a++)f(e,t,o[a]);return n}function C(e,i,r,n){for(var a=[],t=0,o=e;t<o.length;t++)!(function(t){var e;A.contracts.isVisualContainer(t)?(e=_.find(i,(function(e){return e.contract===t})))&&a.push(e):(e=V(t,C(t.children,i,r,n)))&&a.push(e)})(o[t]);return a}function V(e,t,i){if(e.layouts.withId(i=void 0===i?0:i)){for(var r=new S.VisualContainerGroup(e,i,t),n=0,a=t;n<a.length;n++)a[n].parentGroup=r;return r}}function w(e,t,i){void 0===t&&(t=0);var r=new a,n=e.layouts.withId(t);if(n){n=n.position;return r.position({y:n.y,x:n.x}),r.zIndex(n.z||0),r.viewport({height:n.height,width:n.width}),new S.VisualContainer(e,r,t,i)}}function x(e,t){return void 0===t&&(t=F.common.getLocalize()),F.data.getDisplayName(e,t)}function P(e,t){var i=e.getDisplayName()?-1:1,r=t.getDisplayName()?-1:1;if(i!=r)return i-r;e=e.getDisplayName()||e.getRestatement()||"",t=t.getDisplayName()||t.getRestatement()||"";return e.localeCompare(t)}S.VisualizationPaneViewModel=i,(e=S.ViewModelFactory||(S.ViewModelFactory={})).createExplorationContainer=function(){return{exploration:null,options:null,taskPane:u(),visualizationPane:p(),sectionStatus:{currentSectionNumber:-1,isEditing:!1},isNavPaneCollapsed:!0,performancePane:l("PerformanceAnalyzerPane_Title","PBIPerformanceAnalyzer","PerformanceAnalyzerPane_Close"),bookmarksPane:l("ExplorationBookmarksPane_Title","AudioBookmark","ExplorationBookmarksPane_Close"),canvasItemsPane:l("ExplorationCanvasItemsPane_Title","LaunchSelectionPane","ExplorationCanvasItemsPane_Close"),syncGroupPane:l("SyncGroupPane_Title","PBISyncSlicer"),insightsPane:l("Generic_Insights","PBIAnomalies","InsightsPane_Close"),quickExplorePane:l("Summarize"),quickMeasuresPane:l("QuickMeasure","PBINewQuickMeasure","QuickMeasuresPane_Close"),buildSkittlePane:l("Skittles_Build_Title","PBIBuild",void 0,!1),chartElementsSkittlePane:l("Skittles_ChartElements_Title","PBIAddToChart",void 0,!1)}},e.convertSectionToViewModel=c,e.createExplorePane=l,e.createTaskPane=u,e.createVisualizationPane=p,e.createVisualTypesContainer=function(e){return{visuals:e}},e.getCustomVisualTypes=function(e){return g(_.filter(e,(function(e){return e.custom})))},e.getVisualTypeInfoByName=d,e.getVisualTypeInfo=h,e.getAvailableVisualTypes=g,e.getVisualType=v,e.convertExploration=function(e,t,i,r,n){var a=_.map(e.sections,(function(e){return c(e,n)})),o=e.sections;if(o&&0<o.length){var s=void 0!==i?i:0;if(s<o.length)for(var l=y(e,o[s],t,r),u=o.length-1;0<=u;--u)a[u].selected=u===s}return{contract:e,sections:a,exploreCanvas:l}},e.convertSectionToExploreCanvas=y,e.convertVisualContainerGroups=C,e.convertVisualContainerGroup=V,e.convertVisualContainerStandalone=w,e.convertVisualContainer=function(e,t,i,r){if(r=w(i,r))return f(e,t,r),r},e.getDisplayName=x,e.createFilterPane=function(e,t){return{isVisualVisible:!1,reportFilters:(t=void 0===t?!0:t)?[]:null,pageFilters:[],drillthroughFilters:[],visualFilters:[],activeFilterPane:void 0,addFilterLabel:e.get("FieldDropZone_AddFields"),addDrillthroughFilterLabel:e.get("FieldDropZone_DrillthroughLink_Watermark")}},e.createVisualFilters=function(e,t,r,i,n,a,o,s,l){for(var u=(null===(u=t.filters)||void 0===u?void 0:u.filter((function(e){return null!=e})))||[],c=[],p={container:t,scopeType:0},d=E.getAutoVisualFilterContainers(t,a,r,s),o=E.getAutoCrossDrillVisualFilterContainers(e,t,o,r),h=function(e){return S.FilterViewModelFactory.convertFilterContainer(e,r,i,p,n,s,l,E.getVisualCapabilities(t,n),t.config.singleVisual)},g=0,v=u;g<v.length;g++)!(function(t){var e=h(t);if(c.push(e),d){if(t.expression&&!_.isEmpty(t.expression.validate(r,s)))return;var i=_.findIndex(d,(function(e){return b.equals(e.expression,t.expression)}));-1===i?0===t.howCreated&&(e.howCreated=t.howCreated=1):(1===t.howCreated&&(e.howCreated=t.howCreated=0),2!==t.howCreated&&d.splice(i,1))}})(v[g]);if(d=d||[],u=(u=o=o||[]).concat(d),_.isEmpty(p.container.filters)&&(p.container.filters=[]),(o=p.container.filters).push.apply(o,d||[]),u)for(var m=0,f=u;m<f.length;m++){var y=f[m],C=h(y);C.howCreated=y.howCreated,c.push(C)}return c.sort(P),c},e.createFilters=function(e,t,i,r,n,a,o,s){var l=[];if(!e||!e.container||!e.container.filters)return l;for(var u=0,c=e.container.filters;u<c.length;u++){var p=c[u];null!=s&&p.howCreated!==s||(p.name||(p.name=F.explore.FilterUtils.getNextFilterName(e.container.filters)),p=S.FilterViewModelFactory.convertFilterContainer(p,t,i,e,r,n,a,o,null),l.push(p))}return l.sort(P),l},e.createUniqueId=function(e){return _.map(e,(function(e){return t.replaceAll(e,"-","\\-")})).join("-")},e.sortFilterByDisplayName=P,e.sortFilterByOrdinal=function(e,t){var i=void 0===e.contract.ordinal?1:-1,r=void 0===t.contract.ordinal?1:-1;return-1==i&&-1==r?e.contract.ordinal-t.contract.ordinal:i-r}})((A=F.explore||(F.explore={})).viewModels||(A.viewModels={}))})(powerbi=powerbi||{}),(function(e){var t,i,r;function n(e){e&&(this.color=e.color.solid.color,this.visible=e.show,this.radius=e.radius)}t=e.explore||(e.explore={}),i=t.viewModels||(t.viewModels={}),Object.defineProperty(n.prototype,"thickness",{get:function(){return n.Width},enumerable:!1,configurable:!0}),n.prototype.getNumericPaddingFromBorder=function(){return n.calculatePadding(this.radius)},n.prototype.getBorderStyle=function(){if(this.visible)return n.Width+"px "+n.Style+" "+e.common.utils.ColorUtility.hexToRGBString(this.color)},n.prototype.getPaddingFromBorder=function(){var e=n.calculatePadding(this.radius);if(this.visible)return e+"px"},n.prototype.getBorderRadius=function(){if(this.visible)return(this.radius||e.visuals.VisualBorderUtil.DefaultRadius)+"px"},t=n,i.VisualBorder=t,(r=i.VisualBorder||(i.VisualBorder={})).Width=1,r.Style="solid",r.DefaultPadding=0,r.paddingMultiple=Math.sin(Math.PI/180*45),r.calculatePadding=function(e){return Math.ceil(e-e*r.paddingMultiple)}})(powerbi=powerbi||{}),(function(s){!(function(e){var t,i,r,n,a;function o(e,t,i){this.contract=e,this.currentCanvasLayout=t,this.children=i,this.uiScale=n.DefaultCanvasUiScale}function l(e){return!!e.children}t=e.viewModels||(e.viewModels={}),i=s.common.models.ApplyStyle,r=e.util.CanvasVisualsUtility,n=s.explore.constants.ExploreCanvasConstants,a=s.explore.util.VisualContainerUtils,o.prototype.setSelected=function(e){this.isSelected=e},Object.defineProperty(o.prototype,"id",{get:function(){return this.contract.id},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"name",{get:function(){return this.contract.name},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"isHidden",{get:function(){return this.contract.isHidden},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"position",{get:function(){var e=this.currentCanvasLayout;return this.contract.layouts.withId(e).position},set:function(e){var t=this.currentCanvasLayout;this.contract.layouts.withId(t).position=e},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"isPositioned",{get:function(){var e=this.position;return 0!==e.width&&0!==e.height},enumerable:!1,configurable:!0}),o.prototype.startResize=function(){this.originalPosition=this.position;for(var e=0,t=this.children;e<t.length;e++)t[e].startResize()},o.prototype.getScaledPosition=function(){return this.scaledPosition||this.convertToScaledPosition(this.position)},o.prototype.convertToScaledPosition=function(e){return r.convertToScaledPosition(e,this.uiScale,!0)},o.prototype.updateViewportForUserResize=function(e){e=this.convertToScaledPosition(__assign(__assign({},e),{x:0,y:0}));this.updateStyle(e)},o.prototype.updateViewState=function(){this.scaledPosition=this.convertToScaledPosition(this.position);var e=s.Prototype.inherit(this.scaledPosition);this.updateStyle(e),this.setTooltip()},o.prototype.updateStyle=function(e){this.applyStyle||(this.applyStyle=new i);e=a.getVisualStyleAttributes(e,void 0,this.background&&this.background.colorRGB,this.border&&this.border.getBorderStyle(),this.border&&this.border.getBorderRadius(),this.border&&this.border.getPaddingFromBorder());this.applyStyle.addAttributes(e),this.applyStyle.apply()},o.prototype.setTooltip=function(){var e;this.tooltip=null===(e=null===(e=null===(e=this.contract.evaluatedObjects)||void 0===e?void 0:e.general)||void 0===e?void 0:e.altText)||void 0===e?void 0:e.toString()},o.prototype.clone=function(){var e=new o(this.contract,this.currentCanvasLayout,this.children);return e=_.assign(e,this)},t.VisualContainerGroup=o,t.traverseVisualContainerGroups=function e(t,i,r){for(var n=r&&r.visibleOnly,a=0,o=t;a<o.length;a++){var s=o[a];n&&s.isHidden||(i(s),l(s)&&e(s.children,i,r))}},t.isVisualContainerGroup=l,t.isVisualContainer=function(e){return!e.children}})(s.explore||(s.explore={}))})(powerbi=powerbi||{}),(function(c){var f,p,o,i,a,s,l,d,h,n,r,u,g,v,m,y,C,S,e,b,E;function V(e,t,i,r){t=E.call(this,e,{footerStyle:null,headerBackgroundStyle:null,headerForegroundStyle:null,headerItemContainerStyle:null,popOutBarSubtitle:"",popOutBarTitle:"",position:null,style:t,titleStyle:null,visualViewportStyle:null})||this;return t.uiScale=n.DefaultCanvasUiScale,t.currentCanvasLayout=i,t.currentEditMode=0,t.visualTitleWrapped=[],t.currentZone=r,t}f=c.explore||(c.explore={}),p=f.viewModels||(f.viewModels={}),o=c.common.models.ApplyStyle,i=jsCommon.BrowserUtils,a=jsCommon.Color,s=c.visuals.ColorHelper,l=jsCommon.CssConstants,d=c.data.DataViewObjectDescriptors,h=f.util.DetailVisualUtils,n=c.explore.constants.ExploreCanvasConstants,r=c.a11y.util.FocusUtility,u=c.visuals.FontProperties,g=jsCommon.KeyUtils,v=c.TextMeasurementService,m=c.explore.util.VisualContainerUtils,y=f.contracts.VisualLink,C=f.contracts.VisualTitle,S=jsCommon.WordBreaker,e={key:void 0,defaultValue:!0,forceVisible:((e={})[1]=!0,e)},b={visualInformationButton:__assign(__assign({},e),{key:"showVisualInformationButton"}),visualWarningButton:__assign(__assign({},e),{key:"showVisualWarningButton"}),visualErrorButton:__assign(__assign({},e),{key:"showVisualErrorButton"}),drillRoleSelector:__assign(__assign({},e),{key:"showDrillRoleSelector"}),drillUpButton:__assign(__assign({},e),{key:"showDrillUpButton"}),drillToggleButton:__assign(__assign({},e),{key:"showDrillToggleButton"}),drillDownLevelButton:__assign(__assign({},e),{key:"showDrillDownLevelButton"}),drillDownExpandButton:__assign(__assign({},e),{key:"showDrillDownExpandButton"}),pinButton:__assign(__assign({},e),{key:"showPinButton"}),filterRestatementButton:__assign(__assign({},e),{key:"showFilterRestatementButton"}),focusModeButton:__assign(__assign({},e),{key:"showFocusModeButton"}),copyVisualImageButton:__assign(__assign({},e),{key:"showCopyVisualImageButton"}),seeDataLayoutToggleButton:__assign(__assign({},e),{key:"showSeeDataLayoutToggleButton"}),optionsMenu:__assign(__assign({},e),{key:"showOptionsMenu"}),commentButton:__assign(__assign({},e),{key:"showCommentButton"}),tooltipButton:{key:"showTooltipButton",defaultValue:!1},personalizeVisualButton:__assign(__assign({},e),{key:"showPersonalizeVisualButton"})},E=p.ViewModel,__extends(V,E),V.prototype.resolveDataAppliedEvent=function(){this.visual.dataAppliedEvent&&this.visual.dataAppliedEvent.resolve()},V.prototype.getRunningVisual=function(){return this.runningVisual},Object.defineProperty(V.prototype,"errorInfo",{get:function(){return this.runningVisual&&this.runningVisual.getErrorInfo()},set:function(e){var t=this.getRunningVisual();t&&t.setErrorInfo(e)},enumerable:!1,configurable:!0}),V.prototype.setThemeCollection=function(e){this.themeCollection=e,this.runningVisual&&this.runningVisual.setThemeCollection(e),this.runningDetailVisual&&this.runningDetailVisual.setThemeCollection(e)},V.prototype.startResize=function(){this.originalPosition=this.position},V.prototype.getVisualType=function(){return m.getVisualType(this.contract)},V.getVisualBodyOffset=function(e,t){return V.useStylableHeader(t)||e.canShowVisualContainerHeaderInset()?{top:0,height:0,width:0,left:0}:{top:this.VisualContainerHeaderHeight,height:-this.VisualContainerHeaderHeight,width:0,left:0}},Object.defineProperty(V.prototype,"id",{get:function(){return this.contract.id},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"name",{get:function(){return this.contract.name},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"position",{get:function(){var e=this.currentCanvasLayout;return this.contract.layouts.withId(e).position},set:function(e){var t=this.currentCanvasLayout;this.contract.layouts.withId(t).position=e},enumerable:!1,configurable:!0}),V.prototype.getScaledPosition=function(e){return this.convertToScaledPosition(this.position,e=void 0===e?!0:e)},Object.defineProperty(V.prototype,"editMode",{get:function(){return this.currentEditMode},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"headerMaxLines",{get:function(){return this.isTitleWrappingEnabled?3:1},enumerable:!1,configurable:!0}),V.prototype.setEditMode=function(e){this.currentEditMode=e,m.updateVisual(this.runningVisual,this.runningVisual.getViewport(),c.VisualUpdateType.ViewMode,this.visualHostServices,this.editMode)},Object.defineProperty(V.prototype,"isPositioned",{get:function(){var e=this.position;return 0!==e.width&&0!==e.height},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"isPoppedOut",{get:function(){var e=this.contract.visibility;return null!=e&&0!==e&&4!==e},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"bringToFront",{get:function(){var e=this.contract.config.singleVisual.evaluatedObjects;return!e||!e.general||!e.general.keepLayerOrder},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"isHidden",{get:function(){return f.contracts.VisualContainer.isHidden(this.contract.config.singleVisual)},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"isTitleWrappingEnabled",{get:function(){return this.visualTitle&&!!this.visualTitle.titleWrap},enumerable:!1,configurable:!0}),V.prototype.visualTitleVisible=function(){var e=this.contract.config.singleVisual,t=e.evaluatedObjects&&e.evaluatedObjects.title,i=t&&t.text,r=this.visualPlugin&&this.visualPlugin.capabilities(e.visualType),e=!1;return(t&&i||this.visualTitle&&this.visualTitle.text)&&(e=!0),!C.isHidden(t,r&&r.suppressDefaultTitle)&&r&&(!r.suppressDefaultTitle||r.suppressDefaultTitle&&i)&&""!==i&&e&&!this.isPoppedOut},V.prototype.supportsKeyboardNavigation=function(){var e=this.contract.config.singleVisual,e=this.visualPlugin&&this.visualPlugin.capabilities(e.visualType);return e&&e.supportsKeyboardFocus},V.prototype.setServices=function(e,t,i,r,n,a,o,s,l,u,c,p,d,h,g,v,m){this.visualHostServices=f.helpers.VisualHostInsideZoneAdapter.wrapHostServices(e,p),this.visualAdapterHostServices=m,this.visualPlugin=t,this.visualPluginOps=i,this.viewModeState=r,this.formFactor=n,this.visibility=a,this.runningVisuals=o,this.explorationCapabilities=v,this.visualAuthoring=l,this.filterGenerator=u,this.themeService=c,this.showClientWarnings=d,this.sortServices=h,this.selectionServices=g},V.prototype.setSelected=function(e){this.isSelected=e},V.prototype.handleKeyDown=function(e){switch(function(e){switch(e.keyCode){case 122:return e.altKey&&e.shiftKey?0:void 0;case 70:return i.isCtrlOrMeta(e)?1:void 0}}(e)){case 0:this.visibility.set(this.contract,8);break;case 1:this.toggleVisualSearch(e)}if(this.shouldHandleKeydown(e)){if(this.isTextboxVisual()){var t=this.getTextboxVisual();return t&&t.focus()}if(this.isContractQnaVisual()){t=this.getQnaVisual();if(t)return t.focus()}}},V.prototype.toggleVisualSearch=function(e){var t;this.contract&&this.contract.config&&this.contract.config.singleVisual&&(t=this.contract.config.singleVisual.visualType,(t=this.visualPlugin&&this.visualPlugin.capabilities(t))&&this.filterGenerator.tryGetSelfFilterEnabledProperty(t)&&(this.visualAuthoring.toggleSlicerVisualSearch(this.contract,this.filterGenerator,this.visualPlugin),e.preventDefault(),e.stopPropagation()))},V.prototype.shouldHandleKeydown=function(e){if(!this.runningVisual)return!1;if(0===this.viewModeState.getMode())return!1;var t=e.keyCode;if(g.isArrowKey(t)||g.isNudgeModifierKey(t))return!1;if(27===t||9===t||18===t||13===t||i.isCtrlOrMeta(e))return!1;e=this.contract.toolbar&&this.contract.toolbar.element;return!e||!r.isFocusInTree(e)},V.prototype.setVisualTitle=function(e){var t="",i="";(this.visualTitle=e)&&(e.titleComponents&&e.titleComponents.title?t=e.titleComponents.title:e.text&&(t=e.text),e.titleComponents&&e.titleComponents.subtitle&&(i=e.titleComponents.subtitle)),this.readOnlyState.popOutBarTitle=t,this.readOnlyState.popOutBarSubtitle=i},V.prototype.setTooltip=function(){var e=m.getVisualType(this.contract),t=this.getVisualLinkTypeLabel(e)||"",i=null===(r=null===(i=this.visualPlugin)||void 0===i?void 0:i.capabilities(e))||void 0===r?void 0:r.ariaRole,r=this.visualPlugin&&this.visualPlugin.getPlugin(e);r&&(n=(n=this.ariaMetadata&&this.ariaMetadata.subtitleDisplayNameGetter)?" "+p.ViewModelFactory.getDisplayName(n):"",e=p.ViewModelFactory.getVisualType(r).title+n);var r=this.visualTitle,n=void 0!==(null==r?void 0:r.text)&&r.text+" "||"",r=this.contract.config.singleVisual,r=r.evaluatedObjects&&r.evaluatedObjects.general&&r.evaluatedObjects.general.altText?" "+r.evaluatedObjects.general.altText:"";this.tooltip=""+n+t+e+r,this.ariaLabel=""+n+t+r,this.ariaRole="group",this.ariaRoleDescription=null!=i?i:e,"table"===this.ariaRoleDescription.trim().toLowerCase()&&(this.ariaRoleDescription="")},V.prototype.getVisualLinkTypeLabel=function(e){e=this.visualPlugin&&this.visualPlugin.capabilities(e);if(e&&e.supportsVisualLink){e=this.contract.config.singleVisual,e=e.evaluatedObjects&&e.evaluatedObjects.visualLink;if(e&&e.show){var t=y.getType(e),e=_.find(y.Type.members(),(function(e){return e.value===t})).displayName;return p.ViewModelFactory.getDisplayName(e)+" "}}},V.prototype.setHeaderTooltip=function(){var e=this.contract.config.singleVisual,t=e.evaluatedObjects&&e.evaluatedObjects.visualHeader,e=e.evaluatedObjects&&e.evaluatedObjects.visualHeaderTooltip;t&&t.showTooltipButton&&e?this.headerTooltip=e:this.headerTooltip=void 0},V.prototype.redrawVisual=function(){this.runningVisual&&m.updateVisual(this.runningVisual,this.runningVisual.getViewport(),c.VisualUpdateType.Resize,this.visualHostServices,this.editMode)},V.prototype.updateVisualViewportForUserResize=function(e){var t=this.themeService&&this.themeService.getVisualStyle(this.themeCollection),i=this.runningVisual;this.enableVisualScaling?(e.width/=this.uiScale.x,this.visualBorder&&(e.width-=2*this.visualBorder.thickness),this.useStylableHeader()||(e.height-=V.VisualContainerHeaderHeight),e.height/=this.uiScale.y,this.visualBorder&&(e.height-=2*this.visualBorder.thickness)):this.useStylableHeader()||(e.height-=V.VisualContainerHeaderHeight),this.isFooterVisible&&this.isFooterVisible()&&(e.height-=V.VisualContainerFooterHeight);var r=this.getVisualViewport(e.width,e.height,1,t);i&&(this.viewportResized=!0,m.updateVisual(i,r,c.VisualUpdateType.Resize,this.visualHostServices,this.editMode,1)),this.hasDetailVisual()&&m.updateVisual(this.runningDetailVisual,r,c.VisualUpdateType.Resize,this.visualHostServices,this.editMode,1),this.applyVisualBodyStyle(this.readOnlyState,e),this.applyFooterStyle(this.readOnlyState,e.width);e=this.position,e=this.overridePosition||this.convertToScaledPosition(e);this.applyTitleStyle(this.readOnlyState,e.width,t)},V.prototype.shouldUseCache=function(){return m.shouldUseQueryCache(this.contract,this.options.disableQueryCacheUpdates)},V.prototype.adjustForVisualContainerHeader=function(e,t,i){this.formFactor&&this.formFactor.getCurrentLayoutCapabilities().canShowVisualContainerHeaderInset()||(i&&(e.y+=t),e.height-=t)},V.prototype.convertToScaledPosition=function(e,t){void 0===t&&(t=!0);var i=this.viewModeState&&this.viewModeState.getConfig().displayOptions.disablePixelValueRounding,i=f.util.CanvasVisualsUtility.convertToScaledPosition(e,this.uiScale,!i);return this.adjustForVisualContainerHeader(i,this.useStylableHeader()?0:-V.VisualContainerHeaderHeight,t),i},V.prototype.reset=function(){var e=this.visual;e&&(e.data=void 0,e.dataTransforms=void 0,e.hostServices=c.visuals.defaultVisualHostServices,e.visualAdapterHostServices={getNextDataSegment:function(){return new c.Promise(function(e,t){return t(new Error("Visual reset"))})},startProgressBar:_.noop,stopProgressBar:_.noop}),this.runningVisuals&&this.runningVisuals.removeVisual(this.contract),this.runningVisual=void 0,this.showClientWarnings=void 0,this.visualHostServices=void 0,this.visualAdapterHostServices=void 0},V.prototype.updateViewStateCore=function(e){var t=this.viewModeState&&this.viewModeState.getConfig(),i=t&&t.displayOptions,r=this.themeService&&this.themeService.getVisualStyle(this.themeCollection),n=this.contract,a=this.position,o=this.overridePosition||this.convertToScaledPosition(a),s=c.Prototype.inherit(o),l=!this.useStylableHeader()||this.isPoppedOut;this.enableVisualScaling?this.overridePosition?(l&&(s.height-=V.VisualContainerHeaderHeight),s.height/=this.uiScale.y,s.width/=this.uiScale.x):(s=c.Prototype.inherit(a),this.formFactor&&this.formFactor.getCurrentLayoutCapabilities().canShowVisualContainerHeaderInset()&&l&&(s.height-=V.VisualContainerHeaderHeight/this.uiScale.y)):l&&(s.height-=V.VisualContainerHeaderHeight),this.isFooterVisible&&this.isFooterVisible()&&(s.height-=V.VisualContainerFooterHeight),!this.isPoppedOut||i&&i.hideInFocusBar||(u=p.VisualContainer.PopOutBarHeight,this.enableVisualScaling&&(u/=this.uiScale.y),s.height-=u);var u,t=this.getVisualViewport(s.width,s.height,this.uiScale.x,r),l=n.config.singleVisual;e.isFilterVisual=!1,l&&(this.showWatermark=!1,this.canPin=!0,i=l.visualType,(u=this.visualPlugin&&this.visualPlugin.capabilities(i))&&(e.isFilterVisual=null!=d.findFilterOutput(u.objects)),l.query?(l=l.query.defn)&&(l=l.orderBy(),e.actualSortDirection=l&&l.length?l[0].direction:void 0):this.visualPluginOps&&this.visualPluginOps.isQueryVisual(i)&&"debugVisual"!==i&&(this.canPin=!1,this.viewModeState&&u?this.showWatermark=!(u.supportsLandingPage&&(1===this.viewModeState.getMode()||u.supportsEmptyDataView)):this.showWatermark=!0),this.updateVisualDefinition(t),this.visual&&(this.runningVisuals.getVisual(this.contract)&&this.runningVisual||(this.runningVisual=m.wrapRunningVisual(this.visual,this.visualHostServices,this.editMode,this.contract.config.singleVisual,this.hostServices,this.filterGenerator,this.showClientWarnings,this.sortServices,this.selectionServices),this.runningVisuals.setVisual(this.contract,this.runningVisual))),this.hasDetailVisual()?e.detailVisual||(e.detailVisual={parentContract:this.contract,visual:{viewport:h.getDetailVisualViewport(t,this.contract.detailVisualLayout),themeCollection:this.themeCollection,allowInvalidDataView:!0,hostServices:null,visualName:this.contract.name+"-detail"},hasData:!1},this.runningDetailVisual||(this.runningDetailVisual=m.wrapRunningVisual(e.detailVisual.visual,this.visualHostServices,this.editMode,this.contract.config.singleVisual,this.hostServices,this.filterGenerator,this.showClientWarnings))):(e.detailVisual=null,this.runningDetailVisual=void 0),this.setViewport(e,t)),e.position=__assign(__assign({},o),{z:null!=this.zIndexOverride?this.zIndexOverride:a.z||0,angle:a.angle||0}),this.applyTitleStyle(e,o.width,r),this.applyVisualBodyStyle(e,s),this.applyFooterStyle(e,s.width),this.applyHeaderStyle(e),this.setHeaderItemVisibility(e),this.setTooltip(),this.setHeaderTooltip(),n&&n.postProcessing&&this.configureInitializationSpinner(n.postProcessing)},V.prototype.isHeaderItemVisible=function(e){return!this.readOnlyState.itemVisibility||this.readOnlyState.itemVisibility[e]},V.prototype.isDeprecationWarningVisible=function(){return 1===this.viewModeState.getMode()&&void 0!==this.customVisualDeprecatedWarningInfo},V.prototype.isWarningVisible=function(){return this.isHeaderItemVisible("visualWarningButton")&&void 0!==this.warningInfo},V.prototype.isErrorVisible=function(){return this.isHeaderItemVisible("visualErrorButton")&&void 0!==this.transformWarningInfo},V.prototype.isInfoVisible=function(){return this.isHeaderItemVisible("visualInformationButton")&&void 0!==this.visualInfo},V.prototype.isInfoVersionsVisible=function(){return this.isHeaderItemVisible("visualInformationButton")&&void 0!==this.versionsInfo},V.prototype.isHeaderTooltipVisible=function(){return this.isHeaderItemVisible("tooltipButton")},V.prototype.isAnyIconVisible=function(){return this.isDeprecationWarningVisible()||this.isWarningVisible()||this.isErrorVisible()||this.isInfoVersionsVisible()||this.isInfoVisible()||this.isHeaderTooltipVisible()},V.prototype.anyHeaderItemVisible=function(e){if(e)for(var t=0,i=e;t<i.length;t++){var r=i[t];if(this.isHeaderItemVisible(r))return!0}return!1},V.prototype.isTextboxVisual=function(){return this.contract.config.singleVisual.visualType===c.visuals.plugins.textbox.name},V.prototype.getTextboxVisual=function(){return this.isTextboxVisual(),this.tryGetUnwrappedVisual()},V.prototype.isContractAnalysisVisual=function(){var e=this.contract.config.singleVisual.visualType;return this.visualPluginOps.isAnalysisVisual(e)},V.prototype.isDefinitionAnalysisVisual=function(){var e=this.visual&&this.visual.type;return this.visualPluginOps.isAnalysisVisual(e)},V.prototype.isContractQnaVisual=function(){var e=this.contract.config.singleVisual.visualType;return this.visualPluginOps.isQnaVisual(e)},V.prototype.getQnaVisual=function(){return this.isContractQnaVisual(),this.tryGetUnwrappedVisual()},V.prototype.isDefinitionQnaVisual=function(){var e=this.visual&&this.visual.type;return this.visualPluginOps.isQnaVisual(e)},V.prototype.setInitialLoadTelemetryParent=function(e){this.visual,this.visual.initialLoadActivity=e},V.prototype.tryGetUnwrappedVisual=function(){var e=null===(e=this.runningVisual)||void 0===e?void 0:e.getAdapter();return e?e.unwrap?e.unwrap():e:void 0},V.prototype.setHeaderItemVisibility=function(e){var t,i=(i=e.itemVisibility)||(e.itemVisibility={}),r=this.viewModeState&&this.viewModeState.getMode(),e=this.contract.config.singleVisual,n=this.useStylableHeader()?e.evaluatedObjects&&e.evaluatedObjects.visualHeader:void 0;for(t in b){var a=b[t],o=a.key,s=a.defaultValue,l=a.forceVisible,a=void 0;a=l&&void 0!==l[r]?l[r]:void 0!==(o=n&&n[o])?o:s,i[t]=a}},V.prototype.applyHeaderStyle=function(e){var t=this.contract.config.singleVisual,t=this.useStylableHeader()?t.evaluatedObjects&&t.evaluatedObjects.visualHeader:void 0;this.applyItemContainerStyle(e,t),this.applyHeaderBackgroundStyle(e,t),this.applyHeaderForegroundStyle(e,t)},V.prototype.applyItemContainerStyle=function(e,t){var i,r,n={"background-color":"","border-color":""};this.useStylableHeader()&&t&&(!t.background&&null==t.transparency&&null==t.border||(i=t.background&&t.background.solid?a.parseColorString(t.background.solid.color):{R:255,G:255,B:255},r=t.border&&t.border.solid?a.parseColorString(t.border.solid.color):i,null!=t.transparency?r.A=i.A=1-t.transparency/100:(null==i.A&&(i.A=1),null==r.A&&(r.A=1)),n["background-color"]=a.rgbString(i),n["border-color"]=a.rgbString(r))),e.headerItemContainerStyle||(e.headerItemContainerStyle=new o),e.headerItemContainerStyle.addAttributes(n),e.headerItemContainerStyle.apply()},V.prototype.applyHeaderBackgroundStyle=function(e,t){var i,r={"background-color":""};this.useStylableHeader()&&t&&(!t.background&&null==t.transparency||(i=t.background&&t.background.solid?a.parseColorString(t.background.solid.color):V.VisualHeaderBackgroundColor,null!=t.transparency?i.A=1-t.transparency/100:null==i.A&&(i.A=1-V.VisualHeaderTransparency/100),r["background-color"]=a.rgbString(i))),e.headerBackgroundStyle||(e.headerBackgroundStyle=new o),e.headerBackgroundStyle.addAttributes(r),e.headerBackgroundStyle.apply()},V.prototype.applyHeaderForegroundStyle=function(e,t){var i={color:""};this.useStylableHeader()&&t&&t.foreground&&t.foreground.solid&&(i.color=t.foreground.solid.color),e.headerForegroundStyle||(e.headerForegroundStyle=new o),e.headerForegroundStyle.addAttributes(i),e.headerForegroundStyle.apply()},V.prototype.applyVisualBodyStyle=function(e,t){e.visualViewportStyle||(e.visualViewportStyle=new o);var i=null===(i=this.themeService)||void 0===i?void 0:i.getVisualStyle(this.themeCollection);null!=i&&i.isHighContrast&&this.visualDropShadow&&(this.visualDropShadow.color=s.getThemeColor(i,"foreground"));t=m.getVisualStyleAttributes(t,this.enableVisualScaling?this.uiScale.x:void 0,this.visualBackground&&this.visualBackground.colorRGB,this.visualBorder&&this.visualBorder.getBorderStyle(),this.visualBorder&&this.visualBorder.getBorderRadius(),this.visualBorder&&this.visualBorder.getPaddingFromBorder(),this.visualDropShadow&&this.visualDropShadow.getBoxShadow());e.visualViewportStyle.addAttributes(t),e.visualViewportStyle.apply()},V.prototype.applyFooterStyle=function(e,t){var i,r;this.isFooterVisible&&this.isFooterVisible()&&(i={},e.footerStyle||(e.footerStyle=new o),r=this.enableVisualScaling?this.uiScale.x:1,i.transform="scale("+r+")",i.width=t+"px",e.footerStyle.addAttributes(i),e.footerStyle.apply())},V.prototype.applyTitleStyle=function(e,t,i){var r,n,a={};this.visualTitleVisible()?(a[l.visibilityProperty]=l.visibleValue,r=(n=this.contract.config.singleVisual).evaluatedObjects&&n.evaluatedObjects.title||{},n=this.getTitleFontProperties(r,i),a[l.fontSizeProperty]=n.size.pt+"pt"||"",a[l.fontFamilyProperty]=""+n.family||"",a[l.colorProperty]=""+n.color||"",a[l.textAlignProperty]=r.alignment||"",a[l.backgroundColorProperty]=r.background&&r.background.solid&&r.background.solid.color||"",i=this.isTitleWrappingEnabled?this.visualTitleWrapped.length:1,a[l.heightProperty]=i*m.getTitleHeight(n),this.insetHeaderSize?this.isTitleWrappingEnabled||(t=(t-this.insetHeaderSize.width)/this.uiScale.x,a[l.widthProperty]=t+"px"):a[l.widthProperty]="",a[l.fontWeightProperty]=r.bold?l.boldValue:"",a[l.fontStyleProperty]=r.italic?l.italicValue:"",a[l.textDecoration]=r.underline?l.underlineValue:""):a[l.visibilityProperty]=l.hiddenValue,e.titleStyle||(e.titleStyle=new o),e.titleStyle.addAttributes(a),e.titleStyle.apply()},V.prototype.updateVisualDefinition=function(e){var t,i=this.contract.config.singleVisual,r=i.visualType;this.visual?((t=this.visual).type!==i.visualType?(t.data=null,this.visualHostServices.onClearLicenseNotification()):this.showWatermark&&this.visualHostServices.onClearLicenseNotification(),t.visualName,this.contract.name,t.type=r,t.stylePresetName=i.evaluatedObjects&&i.evaluatedObjects.stylePreset&&i.evaluatedObjects.stylePreset.name,t.hostServices=this.visualHostServices,t.visualAdapterHostServices=this.visualAdapterHostServices,t.orderIndependentSelectorMatching=i.queryOptions&&i.queryOptions.keepProjectionOrder,this.visualPluginOps&&(this.visual.visualRequiresData=this.visualPluginOps.isQueryVisual(r)),this.visual.visualHasData=!!i.query,this.visual.currentZone=this.currentZone):this.visualHostServices&&(this.visual={viewport:e,type:r,visualName:this.contract.name,dataTransforms:{objects:i.objects},hostServices:this.visualHostServices,visualAdapterHostServices:this.visualAdapterHostServices,interactivityOptions:{dragDataPoint:!1,selection:!0,isVisualInteractive:!0},allowInvalidDataView:!0,visualPlugin:this.visualPlugin,themeCollection:this.themeCollection,orderIndependentSelectorMatching:i.queryOptions&&i.queryOptions.keepProjectionOrder},this.visualPluginOps&&(this.visual.visualRequiresData=this.visualPluginOps.isQueryVisual(r)),this.visual.visualHasData=!!i.query)},V.prototype.setViewport=function(e,t){this.runningVisual&&this.setVisualViewport(this.runningVisual,t),this.runningDetailVisual&&this.setVisualViewport(this.runningDetailVisual,h.getDetailVisualViewport(t,this.contract.detailVisualLayout))},V.prototype.setVisualViewport=function(e,t){var i,r,n;e&&t&&(i=this.viewportResized,this.viewportResized=void 0,n=this.enableVisualScaling?this.uiScale.x:1,!i&&(r=e.getViewport())&&r.height===t.height&&r.width===t.width&&r.scale===n||e.setViewport(__assign(__assign({},t),{scale:n}),i))},V.prototype.getVisualViewport=function(e,t,i,r){var n=0;this.visualBorder&&this.visualBorder.visible&&(n=this.visualBorder.getNumericPaddingFromBorder());var a=this.isPaddingDisabled?2*n:p.VisualContainer.VisualContainerPaddingRight+p.VisualContainer.VisualContainerPaddingLeft+2*n,o=this.isPaddingDisabled?2*n:p.VisualContainer.VisualContainerPaddingTop+p.VisualContainer.VisualContainerPaddingBottom+2*n,n=0,e=e-a;this.visualTitleVisible()&&(r=this.getTitleFontProperties(this.visualTitle,r),this.updateVisualTitleWrapping(e,r),n=m.getTitleHeight(r),n*=this.visualTitleWrapped.length||1);t=t-o-n,n=this.viewModeState&&this.viewModeState.getConfig().displayOptions.showDetailVisualOnFullScreen;return this.hasDetailVisual()&&!n&&(1===(this.contract.detailVisualLayout||1)?(t-=o,t/=2):(e-=a,e/=2)),{width:Math.max(e,0),height:Math.max(t,0),scale:i}},V.prototype.getTitleFontProperties=function(e,t){var i=c.DataViewObject.getValue(e,"bold"),r=c.DataViewObject.getValue(e,"italic"),n=c.DataViewObject.getValue(e,"underline"),a={color:"fontColor",family:"fontFamily",size:"fontSize"};i&&(a.bold="bold"),r&&(a.italic="italic"),n&&(a.underline="underline");n=s.create(t);return c.visuals.FontProperties.createFromObjectOrStyle(e,a,n,t,void 0,f.util.VisualContainerUtils.DefaultTitleTextClass,f.util.VisualContainerUtils.DefaultTitleFontProperties)},V.prototype.updateVisualTitleWrapping=function(e,t){var i,r;this.visualTitle&&this.visualTitle.text&&(i=u.toTextProperties(t),(r=new o).addAttributes({width:e+"px"}),r.addAttributes({fontSize:t.size.px+"px"}),r.addAttributes({fontWeight:""+t.weight}),1!==this.headerMaxLines?(e=S.splitByWidth(this.visualTitle.text,i,v.measureSvgTextWidth,e,this.headerMaxLines,null,!0),this.visualTitleWrapped=e.map((function(e){return{text:e.trim(),style:r}}))):this.visualTitleWrapped=[{text:this.visualTitle.text.trim(),style:r}])},V.prototype.hasDetailVisual=function(){return 2===this.contract.visibility||8===this.contract.visibility},V.prototype.useStylableHeader=function(){return V.useStylableHeader(this.explorationCapabilities)},V.useStylableHeader=function(e){return e&&e.getCapabilities().visualContainerOptions.useStylableHeader},V.prototype.configureInitializationSpinner=function(e){var t=this;this.showInitializationSpinner=!0,e.catch((function(e){})).finally((function(){t.showInitializationSpinner=!1,t.contract.postProcessing=void 0}))},V.VisualContainerHeaderHeight=20,V.VisualContainerFooterHeight=34,V.VisualContainerPadding=5,V.VisualContainerPaddingTop=5,V.VisualContainerPaddingRight=5,V.VisualContainerPaddingBottom=5,V.VisualContainerPaddingLeft=5,V.PopOutBarHeight=40,V.HeaderInTitleScaleThreshold=.9,V.VisualHeaderBackgroundColor={R:255,G:255,B:255},V.VisualHeaderTransparency=0,e=V,p.VisualContainer=e})(powerbi=powerbi||{}),(function(e){var t;t=e.explore||(e.explore={}),(t=(e=t.viewModels||(t.viewModels={})).VisualizationPaneSectionType||(e.VisualizationPaneSectionType={}))[t.Fields=0]="Fields",t[t.Format=1]="Format",t[t.Analytics=2]="Analytics",(e=e.PagePaneSectionType||(e.PagePaneSectionType={}))[e.Fields=0]="Fields",e[e.Format=1]="Format"})(powerbi=powerbi||{}),(function(g){var v;(function(l){var s=g.visuals.ActionButtonType,u=g.data.DataViewObjectDefinitions,o=g.visuals.plugins,c=g.data.SemanticFilter,p=g.data.SQExpr,a=g.data.SQExprBuilder,d=g.explore.util.VisualContainerUtils,i=g.explore.contracts.VisualLink;function h(e,t){return e&&t&&t.container===e&&0===t.scopeType}l.createVisualAuthoring=function(e,t,i,r,n,a,o,s,l,u,c,p,d,h,g,v,m,f,y,C){return new S(t,i,r,n,e,a,s,u,c,p,h,g,v,m,f,y,C)},l.DefaultActionButtonPosition={x:0,y:0,width:100,height:40};var S=(e.prototype.addFieldToVisual=function(n,t,a,o){return __awaiter(this,void 0,g.Promise,(function(){var i,r=this;return __generator(this,(function(e){switch(e.label){case 0:return[4,this.getAuthoringVisualRecommendationInterop()];case 1:return i=e.sent(),[2,this.registerUndoableAction(t,(function(t){return r.runVisualContainerUpdateAction((function(e){return r.visualAuthoringOperations.addFieldToVisual(t,n,e,i,o)}),[a])}),"AddFieldToVisual")]}}))}))},e.prototype.addFieldInRole=function(n,a,t,o,s,l,u){return __awaiter(this,void 0,g.Promise,(function(){var i,r=this;return __generator(this,(function(e){switch(e.label){case 0:return[4,this.getAuthoringVisualRecommendationInterop()];case 1:return i=e.sent(),[2,this.registerUndoableAction(t,(function(t){return r.runVisualContainerUpdateAction((function(e){return r.visualAuthoringOperations.addFieldInRole(t,n,a,e,s,l,u,!1,i)}),[o])}),"AddFieldInRole")]}}))}))},e.prototype.resolveParameters=function(i,r,n){return __awaiter(this,void 0,g.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return[4,this.getSchema(i)];case 1:return t=e.sent(),[2,this.visualAuthoringOperations.resolveParameters(t,r,n)]}}))}))},e.prototype.expandHierarchy=function(e,i,r,n,a){var o=this;return this.registerUndoableAction(e,(function(t){return o.runVisualContainerUpdateAction((function(e){return o.visualAuthoringOperations.expandHierarchy(t,e,r,n,a)}),[i])}),"ExpandHierarchy")},e.prototype.removeFieldFromAllRoles=function(t,n){return __awaiter(this,void 0,g.Promise,(function(){var i,r=this;return __generator(this,(function(e){switch(e.label){case 0:return[4,this.getAuthoringVisualRecommendationInterop()];case 1:return i=e.sent(),[2,this.registerUndoableAction(t,(function(t){var e=l.selectionUtils.getSelectedVisualContainers(r.selectionService);return r.runVisualContainerUpdateAction((function(e){return r.visualAuthoringOperations.removeFieldFromAllRoles(n,t,i,[e])}),e)}),"RemoveFieldFromAllRoles")]}}))}))},e.prototype.removeFieldFromRole=function(r,n){return __awaiter(this,void 0,g.Promise,(function(){var t,i=this;return __generator(this,(function(e){switch(e.label){case 0:return[4,this.getAuthoringVisualRecommendationInterop()];case 1:return t=e.sent(),[2,this.undoRedoService.register("RemoveFieldFromRole",(function(){var e=l.selectionUtils.getSelectedVisual(i.selectionService);return i.runVisualContainerUpdateAction((function(e){return i.visualAuthoringOperations.removeFieldFromRole(r,n,e,t)}),[e])}))]}}))}))},e.prototype.removeInvalidExpressions=function(r,n){return __awaiter(this,void 0,g.Promise,(function(){var t,i=this;return __generator(this,(function(e){switch(e.label){case 0:return[4,this.getAuthoringVisualRecommendationInterop()];case 1:return t=e.sent(),[2,this.registerUndoableAction(n,(function(e){return i.visualAuthoringOperations.removeInvalidExpressions(e,r,t)}),"RemoveInvalidExpressions")]}}))}))},e.prototype.moveField=function(i,r,n,a,o,e){var s=this;return this.registerUndoableAction(e,(function(t){var e=l.selectionUtils.getSelectedVisual(s.selectionService);return s.runVisualContainerUpdateAction((function(e){return s.visualAuthoringOperations.moveField(t,i,r,n,a,o,e)}),[e])}),"MoveField")},e.prototype.drillDownLevel=function(e,t,i){var r=this;this.undoRedoService.register("DrillDownLevel",(function(){return r.visualAuthoringOperations.drillDownLevel(e,t,i)}))},e.prototype.replaceField=function(i,r,n,e,t){var a=this;return this.schemaProxy.get(t).then((function(t){return a.undoRedoService.register("ReplaceField",(function(){return a.runVisualContainerUpdateAction((function(e){return a.visualAuthoringOperations.replaceField(t,i,r,n,e)}),[e])}))}))},e.prototype.drillDown=function(t,i,e,r){var n=this;return this.registerUndoableAction(e,(function(e){return n.visualAuthoringOperations.drillDown(e,t,i,r)}),"DrillDown")},e.prototype.drillUp=function(e,t){var i=this;this.undoRedoService.register("DrillUp",(function(){return i.visualAuthoringOperations.drillUp(e,t)}))},e.prototype.toggleDrillFilterOtherVisualsSetting=function(){var e,t=this,i=l.selectionUtils.getSelectedVisual(this.selectionService);i&&(e=!i.drillFilterOtherVisuals,this.undoRedoService.register("SetDrillFilterOtherVisualsSetting",(function(){return t.visualAuthoringOperations.setDrillFilterOtherVisualsSetting(e)})))},e.prototype.setDrillFilterOtherVisualsSetting=function(e){var t=this;this.undoRedoService.register("SetDrillFilterOtherVisualsSetting",(function(){return t.visualAuthoringOperations.setDrillFilterOtherVisualsSetting(e)}))},e.prototype.setAggregate=function(r,n,a,o,s){return __awaiter(this,void 0,g.Promise,(function(){var t,i=this;return __generator(this,(function(e){switch(e.label){case 0:return[4,this.getAuthoringVisualRecommendationInterop()];case 1:return t=e.sent(),[2,this.registerUndoableAction(s,(function(e){return i.visualAuthoringOperations.setAggregate(e,r,n,a,o,t)}),"SetAggregate")]}}))}))},e.prototype.removeAggregate=function(r,n,a,o){return __awaiter(this,void 0,g.Promise,(function(){var t,i=this;return __generator(this,(function(e){switch(e.label){case 0:return[4,this.getAuthoringVisualRecommendationInterop()];case 1:return t=e.sent(),[2,this.registerUndoableAction(o,(function(e){return i.visualAuthoringOperations.removeAggregate(e,r,n,a,t)}),"RemoveAggregate")]}}))}))},e.prototype.setPercentOfGrandTotal=function(i,r,n,a){return __awaiter(this,void 0,g.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return[4,this.getSchema(a)];case 1:return t=e.sent(),[2,this.visualAuthoringOperations.setPercentOfGrandTotal(t,i,r,n)]}}))}))},e.prototype.removePercentOfGrandTotal=function(i,r,n,a){return __awaiter(this,void 0,g.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return[4,this.getSchema(a)];case 1:return t=e.sent(),[2,this.visualAuthoringOperations.removePercentOfGrandTotal(t,i,r,n)]}}))}))},e.prototype.setPercentOfRoleTotal=function(i,r,n,a,o){return __awaiter(this,void 0,g.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return[4,this.getSchema(o)];case 1:return t=e.sent(),[2,this.visualAuthoringOperations.setPercentOfRoleTotal(t,i,r,n,a)]}}))}))},e.prototype.removePercentOfRoleTotal=function(i,r,n,a){return __awaiter(this,void 0,g.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return[4,this.getSchema(a)];case 1:return t=e.sent(),[2,this.visualAuthoringOperations.removePercentOfRoleTotal(t,i,r,n)]}}))}))},e.prototype.toggleShowAll=function(e,t){var i=this;this.undoRedoService.register("ToggleShowAll",(function(){i.visualAuthoringOperations.toggleShowAll(e,t)}))},e.prototype.setVariation=function(e,i,r,n,a,o){var s=this;return this.registerUndoableAction(e,(function(t){return s.runVisualContainerUpdateAction((function(e){return s.visualAuthoringOperations.setVariation(t,e,r,n,a,o)}),[i])}),"SetVariation")},e.prototype.createVisualContainerConfig=function(t){var i=this;return this.schemaProxy.get(t.dataSources).then((function(e){return i.visualAuthoringOperations.createVisualContainerConfig(e,t)}))},e.prototype.addVisualContainerImage=function(e,t,i,r,n,a,o){var s=this;this.undoRedoService.register("AddVisualContainerImage",(function(){s.visualAuthoringOperations.addVisualContainerImageFromData({sections:e,exploreCanvas:t,position:o},i,a),s.publishVisualContainerAddedEvent()}))},e.prototype.addVisualContainerBasicShapeVisual=function(e,t,i){var r=this;this.undoRedoService.register("AddVisualContainerBasicShape",(function(){r.visualAuthoringOperations.addVisualContainerBasicShapeVisual({sections:e,exploreCanvas:t,position:void 0},i),r.publishVisualContainerAddedEvent()}))},e.prototype.addVisualContainerShapeVisual=function(e,t,i){var r=this;i.shapeType,this.undoRedoService.register("AddVisualContainerShape",(function(){r.visualAuthoringOperations.addVisualContainerShapeVisual({sections:e,exploreCanvas:t,position:void 0},i),r.publishVisualContainerAddedEvent()}))},e.prototype.addVisualContainerActionButtonVisual=function(t,i,r){var n=this;this.undoRedoService.register("AddVisualContainerActionButton",(function(){var e=l.DefaultActionButtonPosition;n.visualAuthoringOperations.addVisualContainerActionButtonVisual({sections:t,exploreCanvas:i,position:e},r),n.publishVisualContainerAddedEvent()}))},e.prototype.addVisualContainerNavigatorVisual=function(t,i,r){var n=this;this.undoRedoService.register("addVisualContainerNavigatorVisual_"+r,(function(){var e=n.getNavigatorWidth(r);n.visualAuthoringOperations.addVisualContainerNavigatorVisual({sections:t,exploreCanvas:i,position:{x:0,y:0,width:e,height:50}},r),n.publishVisualContainerAddedEvent()}))},e.prototype.addVisualContainerTextbox=function(e,t,i,r,n){var a=o&&o.textbox&&o.textbox.name;return this.addEmptyVisualContainer(e,t,a,i,r,n)},e.prototype.addVisualContainer=function(i,r,n,a){var o=this;return i.postProcessing=this.getPostProcessing(i.visualType,i.shouldSummarize),this.schemaProxy.get(i.dataSources).then((function(t){return o.undoRedoService.register("AddVisualContainer",(function(){var e=o.visualAuthoringOperations.addVisualContainer(t,i,r,n,a);return o.publishVisualContainerAddedEvent(e),e}))}))},e.prototype.addVisualContainerFromConfig=function(t,i,r,n){var a=this;return this.undoRedoService.register("AddVisualContainerFromConfig",(function(){var e=a.visualAuthoringOperations.addVisualContainerFromConfig(t,i,r,n);return a.publishVisualContainerAddedEvent(e),e}))},e.prototype.addEmptyVisualContainer=function(t,i,r,n,e,a){var o=this,s=this.getPostProcessing(r,e);return this.undoRedoService.register("AddEmptyVisualContainer",(function(){var e=o.visualAuthoringOperations.addEmptyVisualContainer(t,i,r,n,a,s);return o.publishVisualContainerAddedEvent(e),e}))},e.prototype.groupVisualContainers=function(e,t){var i=this;return this.undoRedoService.register("GroupVisualContainers",(function(){return i.visualAuthoringOperations.groupVisualContainers(e,t)}))},e.prototype.ungroupVisualContainers=function(e,t){var i=this;return this.undoRedoService.register("UngroupVisualContainers",(function(){return i.visualAuthoringOperations.ungroupVisualContainers(e,t)}))},e.prototype.moveCanvasItemsInTree=function(e,t,i,r,n){var a=this;return this.undoRedoService.register(n?"MergeCanvasItemContainers":"MoveCanvasItemContainersInTree",(function(){return a.visualAuthoringOperations.moveCanvasItemsInTree(e,t,i,r,n)}))},e.prototype.addConfigToCategoricalFilters=function(e,t,i,r){void 0===r&&(r=!0);e=_.filter(e,(function(e){return!e.isInvalid()&&e.canVisualize()}));if(e)for(var n=0,a=e;n<a.length;n++){var o=a[n];this.createFilterVisualContainerConfig(o.contract,i,t,r)}},e.prototype.createVisualFilters=function(e,t,i,r){return this.visualAuthoringOperations.createVisualFilters(e,t,i,r)},e.prototype.setFilterSortType=function(e,t,i){var r=this;return this.registerUndoableAction(e,(function(e){return r.visualAuthoringOperations.setFilterSortType(e,t,i)}),"setFilterSortType")},e.prototype.moveFilter=function(e,t,i,r){var n=this;return this.registerUndoableAction(e,(function(e){return n.visualAuthoringOperations.moveFilter(e,t,i,r)}),"moveFilter")},e.prototype.addFilter=function(t,i,r,n){var a=this;return this.registerUndoableAction(r,(function(e){return a.visualAuthoringOperations.addFilter(e,t,i,r,!1,n)}),"AddFilter")},e.prototype.addDrillthroughFilter=function(r,n,a){var o=this;return this.registerUndoableAction(a,(function(e){o.visualAuthoringOperations.addFilter(e,r,n,a,!0);var t=o.explorationNavigationService.getCurrentSection(),i=o.explorationNavigationService.getAllSections();if(!o.shouldAddBackButton(t))return!0;e=l.DefaultActionButtonPosition,t=o.explorationNavigationService.getCurrentExploreCanvas();return t&&o.visualAuthoringOperations.addVisualContainerActionButtonVisual({sections:i,exploreCanvas:t,position:e,select:!1},s.back),!0}),"AddDrillthroughFilter")},e.prototype.shouldAddBackButton=function(e){return e&&1!==e.type&&!this.hasBackButton(e)},e.prototype.runVisualContainerUpdateAction=function(e,t){if(_.isEmpty(t))return!1;for(var i=!1,r=[],n=0,a=t;n<a.length;n++){var o=a[n];if(o&&-1===_.indexOf(r,o)&&e(o)){r.push(o);for(var s=0,l=this.visualSync.getVisualsAffectByFieldChanges(o);s<l.length;s++){var u=l[s];e(u),r.push(u)}i=!0}}return i},e.prototype.publishVisualContainerAddedEvent=function(e){this.eventBridge.publishToChannel(l.events.VisualContainerAdded,e=void 0===e?null:e)},e.prototype.hasBackButton=function(e){return _.some(e.visualContainers,(function(e){var t,e=g.data.DataViewObjectDefinitions.getObjectDefinition(e.config.singleVisual.vcObjects,"visualLink",void 0),e=e&&e.properties;return(t=e?{show:e.show&&e.show.value,bookmark:e.bookmark&&e.bookmark.value,type:e.type&&e.type.value}:t)&&t.show&&i.getType(t)===i.Back}))},e.prototype.removeFilter=function(i,r,n,a){var o=this;return this.undoRedoService.register("RemoveFilter",(function(){var e=2===i.howCreated,t=o.visualAuthoringOperations.removeFilter(i,r,n,a);return t&&e&&h(r.container,r)&&o.updateCrossDrillFromVisualContainer(r.container),5!==i.howCreated||i.isTransient||(v.util.logDrillthroughFilterUpdateTelemetry(o.telemetry,"Delete",r.container,n),v.PodUtils.isPodEnabled(i,r)),o.telemetry.logChildEvent(n&&n.event,g.telemetry.EXRemoveFilter,{filterType:v.util.getTelemetryFilterType(i.type),filterScopeType:v.util.getTelemetryFilterScopeType(r.scopeType),fieldKind:i.expression&&v.util.getTelemetryFieldKind(i.expression),viewMode:v.util.getTelemetryViewMode(o.viewModeState.getMode())}),t}))},e.prototype.clearFilter=function(e,t,i){var r=this;return this.undoRedoService.register("ClearFilter",(function(){r.telemetry.logChildEvent(i.event,g.telemetry.EXClearFilter,{filterType:v.util.getTelemetryFilterType(t.type),filterScopeType:v.util.getTelemetryFilterScopeType(e.scopeType),fieldKind:v.util.getTelemetryFieldKind(t.expression),viewMode:v.util.getTelemetryViewMode(r.viewModeState.getMode())}),r.updateFilter(e,t,void 0)}))},e.prototype.toggleFilterVisibility=function(e,t){var i=this;return this.undoRedoService.register("HideFilter",(function(){i.telemetry.logEvent(g.telemetry.EXHideFilter,{filterType:v.util.getTelemetryFilterType(t.type),filterScopeType:v.util.getTelemetryFilterScopeType(e.scopeType),fieldKind:v.util.getTelemetryFieldKind(t.expression),isFilterHidden:t.isHiddenInViewMode}),t.isHiddenInViewMode=!t.isHiddenInViewMode,i.updateFilter(e,t,t.filter),v.FilterUtils.ensureFilterHasName(t,e)}))},e.prototype.toggleFilterLock=function(e,t){var i=this;return this.undoRedoService.register("lockFilter",(function(){i.telemetry.logEvent(g.telemetry.EXLockFilter,{filterType:v.util.getTelemetryFilterType(t.type),filterScopeType:v.util.getTelemetryFilterScopeType(e.scopeType),fieldKind:v.util.getTelemetryFieldKind(t.expression),isFilterLocked:t.isLockedInViewMode}),t.isLockedInViewMode=!t.isLockedInViewMode,i.updateFilter(e,t,t.filter),v.FilterUtils.ensureFilterHasName(t,e)}))},e.prototype.renameFilter=function(e,t,i){var r,n=this;this.undoRedoService.register("renameFilter",(function(){i?t.displayName=i:t&&delete t.displayName,n.updateFilter(e,t,t.filter),v.FilterUtils.ensureFilterHasName(t,e)})),this.featureSwitchService.featureSwitches.certifiedTelemetryUserEvents&&(r=v.FilterUtils.createChangeFilterActivity(this.contextActivityService,"Rename Filer")),v.FilterUtils.notifyFilterContainerChangedByUser(this.eventBridge,{filter:t,changeType:256,scope:e,changeFilterActivity:r}),r&&r.resolve()},e.prototype.updateFilter=function(e,t,i){var r=2===t.howCreated,n=t.filter;t.filter=i;var a,o=t.config&&t.config.singleVisual;o&&(a=this.visualPluginService.capabilities(o.visualType),(a=this.filterGenerator.tryGetFilterPropertyIdentifier(a))&&(o.objects||(o.objects={}),null==i?u.deleteProperty(o.objects,a.objectName,null,a.propertyName):u.setValue(o.objects,a,null,i))),r&&!c.isSameFilter(n,i)&&h(e.container,e)&&this.updateCrossDrillFromVisualContainer(e.container);e=e.container;null==e.filters&&(e.filters=[]),-1===_.indexOf(e.filters,t)&&e.filters.push(t)},e.prototype.updateTopNFilter=function(e,i,r,n,t,a){var o,s,l=this;!e||(e=d.getVisualQuery(e))&&(s=e.defn.select(),o=_.some(s,(function(e){return p.equals(e.expr,i.fieldBeingFiltered,!0,!0)})),s=_.some(s,(function(e){return p.equals(e.expr,i.orderByField,!0,!0)})));var u=this.telemetry.startEvent(g.telemetry.EXFilterPaneTopNFilterApplied,{isTop:i.isTop,itemCount:i.itemCount,atGrain:o,onVisualMeasure:s,viewMode:v.util.getTelemetryViewMode(this.viewModeState.getMode()),isInOutspacePane:t}),t=this.dataSource.get();return this.registerUndoableAction(t,(function(e){var t=g.data.TopNFilterPattern.buildFilterFromParameters({fieldBeingFiltered:i.fieldBeingFiltered,isTop:i.isTop,itemCount:i.itemCount,orderByField:i.orderByField});return l.updateFilter(r,n,t),u.resolve(),!0}),"Apply TopN Filter",a)},e.prototype.createFilterVisualContainerConfig=function(e,t,i,r){return this.visualAuthoringOperations.createFilterVisualContainerConfig(e,t,i,r=void 0===r?!0:r)},e.prototype.raiseVisualContainerChanged=function(e,t){this.raiseVisualContainersChanged([e],t=void 0===t?"UserAction_EditVisual":t)},e.prototype.raiseVisualContainersChanged=function(e,t){this.eventBridge.publishToChannel(l.events.visualContainerChanged,{affectContainer:function(t){return _.some(e,(function(e){return e===t}))},sourceLabelKey:t=void 0===t?"UserAction_EditVisual":t})},e.prototype.raiseVisualContainerGroupChanged=function(e){this.raiseVisualContainerGroupsChanged([e])},e.prototype.raiseVisualContainerGroupsChanged=function(t){this.eventBridge.publishToChannel(l.events.visualContainerGroupChanged,{affectContainer:function(e){return _.includes(t,e)}})},e.prototype.raiseCanvasItemChanged=function(e,t){this.raiseCanvasItemsChanged([e],t=void 0===t?"UserAction_EditVisual":t)},e.prototype.raiseCanvasItemsChanged=function(e,t){void 0===t&&(t="UserAction_EditVisual");var i=[],r=[];v.contracts.traverseVisualContainerGroups(e,(function(e){(v.contracts.isVisualContainer(e)?i:r).push(e)})),_.isEmpty(i)||this.raiseVisualContainersChanged(i,t),_.isEmpty(r)||this.raiseVisualContainerGroupsChanged(r)},e.prototype.convert=function(r,n,a,o){return __awaiter(this,void 0,g.Promise,(function(){var t,i=this;return __generator(this,(function(e){switch(e.label){case 0:return[4,this.getAuthoringVisualRecommendationInterop()];case 1:return t=e.sent(),[2,this.registerUndoableAction(n,(function(e){return i.convertAction(e,r,a,t,o)}),"VisualConversion")]}}))}))},e.prototype.convertMultiple=function(t,i,a,o){return __awaiter(this,void 0,g.Promise,(function(){var r,n=this;return __generator(this,(function(e){switch(e.label){case 0:return[4,this.getAuthoringVisualRecommendationInterop()];case 1:return r=e.sent(),[2,this.registerUndoableAction(i,(function(i){return t.reduce((function(e,t){return n.convertAction(i,t,a,r,o)&&e}),!0)}),"MultipleVisualConversion")]}}))}))},e.prototype.convertAction=function(e,t,i,r,n){var a,o;return n&&(this.filterGenerator.clearFiltersFromVisualContainers(n,[t],"UserAction_EditVisual"),null!=(n=this.visualPluginService.getPlugin(i))&&n.supportsSummarization&&(a=this.getSummarizationPostProcessing(),o=[_.cloneDeep(t)])),this.visualAuthoringOperations.convert(e,t,i,r,o,a)},e.prototype.setOrderBy=function(e,t){var i=e.config.singleVisual;i.query.orderBy(t),i.hasDefaultSort=!1,this.raiseVisualContainerChanged(e)},e.prototype.removeOrderBy=function(e,t){for(var i=0,r=t;i<r.length;i++){var n=r[i];e.config.singleVisual.query.removeOrderBy(n)}this.raiseVisualContainerChanged(e)},e.prototype.setPropertyDefinition=function(e,t,i,r,n,a){function o(){return void 0!==n&&(s.visualAuthoringOperations.removeProperty(e,t,i),i=n),s.visualAuthoringOperations.addProperty(e,t,i,r),s.raiseVisualContainerChanged(e),!0}var s=this;a?o():this.undoRedoService.register("Set Property",o)},e.prototype.removePropertyDefinition=function(e,t,i){var r=this;this.undoRedoService.register("Removing Property",(function(){return r.visualAuthoringOperations.removeProperty(e,t,i),r.raiseVisualContainerChanged(e),!0}))},e.prototype.addDataBars=function(e,t,i){var r=this;this.undoRedoService.register("Set Data Bars",(function(){return r.visualAuthoringOperations.addProperty(e,t.propertyId,t.selector,i),r.raiseVisualContainerChanged(e),!0}))},e.prototype.removeDataBars=function(e,t){var i=this;this.undoRedoService.register("Removing Data Bars",(function(){return i.visualAuthoringOperations.removeProperty(e,t.propertyId,t.selector),i.raiseVisualContainerChanged(e),!0}))},e.prototype.removeConditionalFormattingAll=function(r,n){var a=this;this.undoRedoService.register("Removing All Conditional Formatting",(function(){if(!_.isEmpty(n))for(var e=0,t=n;e<t.length;e++){var i=t[e];a.visualAuthoringOperations.removeProperty(r,i.propertyId,i.selector)}return a.raiseVisualContainerChanged(r),!0}))},e.prototype.persistProperties=function(e,t,i,r,n){var s=this,l=_.isArray(e)?e:[e],u=t.config.singleVisual,e=function(){function i(e,t,i,r,n){a&&e===a.objectName&&a.propertyName===i&&(o=!0)}var e=u.visualType,e=s.visualPluginService.capabilities(e),a=s.filterGenerator.tryGetFilterPropertyIdentifier(e),o=!1,e=_.reduce(l,(function(e,t){return s.visualAuthoringOperations.persistProperties(t,u,i)&&e}),!0);return o&&d.notifyVisualContainersExceptSource(s.eventBridge,t,"UserAction_ChangeSlicer",r,n),e&&(s.visualSync.syncFilterState(t),e)};return i?e():this.undoRedoService.register("VisualContainerPersistProperties",e)},e.prototype.persistVCProperties=function(t,i){var r=this,n=i.config.singleVisual;return this.undoRedoService.register("VisualContainerPersistVCProperties",(function(){var e=_.reduce(t,(function(e,t){return r.visualAuthoringOperations.persistVCProperties(t,n)&&e}),!0);return e&&r.raiseVisualContainerChanged(i),e}))},e.prototype.deleteSelectedVisuals=function(e){for(var t=_.map(this.selectionService.getSelectedElements(),(function(e){return e.canvasItem})),i=!1,r=0,n=t;r<n.length;r++){var a=n[r];a&&(i=this.deleteVisualContainerInternal(a,e)||i)}i&&(t=_.chain(t).filter((function(e){return v.contracts.isVisualContainer(e)})).map((function(e){return e})).value(),this.notifyVisualContainersAndClearSelection(t,e))},e.prototype.deleteVisualContainer=function(e,t){this.deleteVisualContainerInternal(e,t)&&this.notifyVisualContainersAndClearSelection([e],t)},e.prototype.deleteVisualContainers=function(t,i){var r=this,n=i.sections.filter((function(e){return e.selected}))[0],a=[];i.contract.sections.forEach((function(e){e.name===n.contract.name?t.forEach((function(t){_.some(e.visualContainers,(function(e){return e.config.singleVisual.visualType===t.config.singleVisual.visualType}))&&a.push(t)})):t.forEach((function(t){_.remove(e.visualContainers,(function(e){return t.config.singleVisual.visualType===e.config.singleVisual.visualType})),e.visualContainerGroups=g.ItemGroupingManager.removeBy(e.visualContainerGroups,(function(e){return v.contracts.isVisualContainer(e)&&t.config.singleVisual.visualType===e.config.singleVisual.visualType})),r.visualAuthoringOperations.deleteVisualRelationships(e,t)}))})),0<a.length&&(a.forEach((function(e){r.deleteVisualContainer(e,i.exploreCanvas)})),this.notifyVisualContainersAndClearSelection(a,i.exploreCanvas))},e.prototype.deleteVisualRelationships=function(e,t){this.visualAuthoringOperations.deleteVisualRelationships(e,t)},e.prototype.setVisualRelationship=function(e,t,i,r){var n=this;this.undoRedoService.register("SetVisualRelationship",(function(){return n.visualAuthoringOperations.setVisualRelationship(e,t,i,r)}))},e.prototype.setDisplayNameAlias=function(e,t,i){var r=this;this.undoRedoService.register("SetDisplayNameAlias",(function(){r.visualAuthoringOperations.setDisplayNameAlias(e,t,i),r.raiseVisualContainerChanged(t)}))},e.prototype.setLinkFieldAsAggregation=function(i,r,n){var a=this;this.undoRedoService.register("Set Link As Aggregation",(function(){var e,t;v.PodUtils.isPodEnabled(i,r)&&(e=a.explorationNavigationService.getCurrentExploration(),t=r.container,null!=e&&null!=t&&(v.PodUtils.updateParameter(e,t.name,i.name,n),t={filter:i,filterName:i.name,type:2,asAggregation:n},a.eventBridge.publishToChannel(l.events.podParameterChanged,t)))}))},e.prototype.setRequireSingleSelection=function(e,t,i){var r=e.objects,n="requireSingleSelect";r||(e.objects=r={}),i?u.setValue(r,{objectName:"general",propertyName:n},null,a.boolean(i)):u.deleteProperty(r,"general",null,n),v.PodUtils.isPodEnabled(e,t)&&(n=this.explorationNavigationService.getCurrentExploration(),t=t.container,null!=n&&null!=t&&this.updatePodParameter(e,n,t,i))},e.prototype.updatePodParameter=function(e,t,i,r){var n;r?5===e.howCreated||v.PodUtils.hasParameter(t,i.name,e.name)||(n={filterName:e.name,type:0,isCausedByCode:!1,fieldExpr:e.expression,asAggregation:!1,isLegacySingleSelection:!0},v.PodUtils.addParameter(t,i.name,e.name,e.expression,n.asAggregation,!0,v.PodUtils.determineType(i)),this.eventBridge.publishToChannel(l.events.podParameterChanged,n)):(v.PodUtils.deleteParameter(t,i.name,e.name,this.linguisticSchemaProxy),n={filterName:e.name,type:1},this.eventBridge.publishToChannel(l.events.podParameterChanged,n))},e.prototype.setVisibility=function(r,n,a){var o=this;this.undoRedoService.register("Set Visual Containers Visibility",(function(){for(var e=0,t=n;e<t.length;e++){var i=t[e];o.visualAuthoringOperations.setVisibility(i,r,a)}o.visualAuthoringOperations.notifyVisualContainers(n),o.eventBridge.publishToChannel(l.events.canvasItemHiddenChanged,{changedItems:n})}))},e.prototype.setVisualContainerGroupVisibility=function(r,n,a){var o=this;this.undoRedoService.register("Set Visual Container Group Visibility",(function(){for(var e=0,t=n;e<t.length;e++){var i=t[e];o.visualAuthoringOperations.setVisualContainerGroupVisibility(i,r,a)}})),this.raiseVisualContainerGroupsChanged(n),this.eventBridge.publishToChannel(l.events.canvasItemHiddenChanged,{changedItems:n})},e.prototype.setVisualContainerGroupDisplayName=function(r,n){var a=this;this.undoRedoService.register("Set Visual Container Group DisplayName",(function(){for(var e=0,t=n;e<t.length;e++){var i=t[e];a.visualAuthoringOperations.setVisualContainerGroupDisplayName(i,r)}})),this.raiseVisualContainerGroupsChanged(n)},e.prototype.setPresentationChangesApplied=function(t){var i=this;return this.undoRedoService.register("setApplyPresentationChanges",(function(){var e=l.selectionUtils.getSelectedVisual(i.selectionService);return i.runVisualContainerUpdateAction((function(e){return e.config.singleVisual.presentationChangesApplied=t}),[e])}))},e.prototype.updateContainerListOrders=function(e,t,i){var r=this;this.undoRedoService.register("Update Visual Containers for "+i,(function(){r.visualAuthoringOperations.updateContainerListOrders(e,t,i)}))},e.prototype.applyShowValueAs=function(t,i,r){var n=this;return this.registerUndoableAction(t.dataSources,(function(e){if(n.removeShowValueAs(e,t,i))switch(r.kind){case void 0:return!0;case 0:return n.visualAuthoringOperations.setPercentOfGrandTotal(e,t.visualDataRole.name,t.roleIndex,t.visual);case 1:return n.visualAuthoringOperations.setPercentOfRoleTotal(e,r.roles,t.visualDataRole.name,t.roleIndex,t.visual);default:return r.kind,!1}}),"applying quick calc ")},e.prototype.toggleSlicerVisualSearch=function(e,t,i){var r=this;this.undoRedoService.register("ToggleSearchVisualContainer",(function(){r.visualAuthoringOperations.toggleSlicerVisualSearch(e,t,i)&&r.raiseVisualContainerChanged(e)}))},e.prototype.switchQueryParameter=function(r,n,a){return __awaiter(this,void 0,g.Promise,(function(){var t,i=this;return __generator(this,(function(e){switch(e.label){case 0:return[4,this.getAuthoringVisualRecommendationInterop()];case 1:return t=e.sent(),[2,this.undoRedoService.register("switchQueryParameter",(function(){var e=l.selectionUtils.getSelectedVisual(i.selectionService);return i.runVisualContainerUpdateAction((function(e){return i.visualAuthoringOperations.switchQueryParameter(r,e,n,a,t)}),[e])}))]}}))}))},e.prototype.removeShowValueAs=function(e,t,i){switch(i.kind){case void 0:return!0;case 0:return this.visualAuthoringOperations.removePercentOfGrandTotal(e,t.visualDataRole.name,t.roleIndex,t.visual);case 1:return this.visualAuthoringOperations.removePercentOfRoleTotal(e,t.visualDataRole.name,t.roleIndex,t.visual);default:return i.kind,!1}},e.prototype.registerUndoableAction=function(i,r,n,a){return __awaiter(this,void 0,g.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return[4,this.getSchema(i)];case 1:return t=e.sent(),[2,this.undoRedoService.register(n,(function(){return r(t)}),a)]}}))}))},e.prototype.getSchema=function(t){return __awaiter(this,void 0,g.Promise,(function(){return __generator(this,(function(e){return[2,this.schemaProxy.get(t)]}))}))},e.prototype.getAuthoringVisualRecommendationInterop=function(){return __awaiter(this,void 0,g.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.lazyScopedProviderModern.get("authoringVisualRecommendationInterop")];case 1:return[2,e.sent()]}}))}))},e.prototype.notifyVisualContainersAndClearSelection=function(e,t){this.filterGenerator.clearFiltersFromVisualContainers(t.contract,e,"UserAction_EditVisual"),this.selectionService.clearSelection()},e.prototype.deleteVisualContainerInternal=function(e,t,i){if(void 0===i&&(i=!1),e){var r=g.ItemGroupingManager.find(e.name,t.visualContainerGroups);if(r){var n=t.contract;if(v.contracts.isVisualContainer(e)&&v.viewModels.isVisualContainer(r)){this.visualAuthoringOperations.deleteVisualRelationships(t.contract,e);var a=t.visualContainers.indexOf(r);t.visualContainers.splice(a,1);a=n.visualContainers.indexOf(e);n.visualContainers.splice(a,1)}else if(v.contracts.isVisualContainerGroup(e))for(var o=0,s=e.children;o<s.length;o++){var l=s[o];this.deleteVisualContainerInternal(l,t,!0)}return i||(n.visualContainerGroups=g.ItemGroupingManager.remove(e,n.visualContainerGroups),t.visualContainerGroups=g.ItemGroupingManager.remove(r,t.visualContainerGroups),v.util.CanvasVisualsUtility.syncCanvasItemViewModelsWithContracts(t.visualContainerGroups,n.visualContainerGroups),(n=r.parentGroup&&g.ItemGroupingManager.find(r.parentGroup.name,t.visualContainerGroups))&&v.viewModels.isVisualContainerGroup(n)&&this.layoutAuthoring.removeCanvasItemFromGroup(n,r)),!0}}},e.prototype.updateCrossDrillFromVisualContainer=function(t){var e=this.explorationNavigationService.getCurrentExploration(),e=_.find(e.sections,(function(e){return _.includes(e.visualContainers,t)}));e&&this.filterGenerator.updateCrossFilterOnDrill(e,t)},e.prototype.getPostProcessing=function(e,t){var i;return!t||(e=this.visualPluginService.getPlugin(e))&&e.supportsSummarization&&(i=this.getSummarizationPostProcessing()),i},e.prototype.getSummarizationPostProcessing=function(){var e=this;return function(t){return __awaiter(e,void 0,g.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.lazyScopedProviderModern.get("smartNarrativesSummarization")];case 1:return[4,e.sent().generateSummaries(t.outputVisualContainer,t.selectedVisualContainers)];case 2:return e.sent(),[2]}}))}))}},e.prototype.getNavigatorWidth=function(e){return"page"===e?Math.min(Math.max(200,200*this.explorationNavigationService.getAllSections().length),1e3):"bookmark"===e?600:void 0},e);function e(e,t,i,r,n,a,o,s,l,u,c,p,d,h,g,v,m){this.schemaProxy=e,this.contextActivityService=t,this.telemetry=i,this.explorationNavigationService=r,this.visualPluginService=n,this.selectionService=a,this.eventBridge=o,this.undoRedoService=s,this.featureSwitchService=l,this.filterGenerator=u,this.layoutAuthoring=c,this.viewModeState=p,this.dataSource=d,this.linguisticSchemaProxy=h,this.visualAuthoringOperations=g,this.visualSync=v,this.lazyScopedProviderModern=m}})((v=g.explore||(g.explore={})).services||(v.services={}))})(powerbi=powerbi||{}),(function(o){var s;(function(e){var r=o.explore.util.CanvasVisualsUtility,t=jsCommon.DOMConstants,i=jsCommon.FocusNavigationUtility,n=o.a11y.util.FocusUtility,a=s.services.selectionUtils;e.createCanvasKeyHandlerService=function(e,t,i,r,n,a,o,s,l,u,c){return new p(e,t,r,n,a,o,s,l,u,c)};var p=(c.prototype.getVisualInteractivityDisabled=function(){return this.visualInteractivityDisabled},c.prototype.setVisualInteractivityDisabled=function(e){this.visualInteractivityDisabled=!!e},c.prototype.onKeyDown=function(e,t){if(this.debouncedLogScanKeyEvent(e),this.isSaveEvent(e))return this.onSave(),this.preventStopAndReturnFalse(e);if(this.isClearEvent(e))return this.onClear(),this.preventStopAndReturnFalse(e);var i=this.formFactor.getCurrentLayoutCapabilities();if(0===this.viewModeState.getMode())return i.canPassUnhandledKeysToSelectedVisual()?this.allowSelectedVisualContainerToHandle(e,t):void 0;if(this.isDeleteEvent(e)&&!this.isFocusedOnTextElement()&&!this.visibilityService.get())return i.canRemoveVisualFromLayout()?this.onRemoveFromLayout(e,t):i.canDelete()&&this.onDelete(e,t),this.preventStopAndReturnFalse(e);var r=e.which;if(this.isCtrlOrMeta(e)&&!this.isFocusedOnTextElement()){var n=!_.isEmpty(this.selectionService.getSelectedElements());switch(r){case 65:return this.onSelectAll(e,t),this.preventStopAndReturnFalse(e);case 67:return!i.canCutCopyPaste()||!n||(this.onCopy(e),this.preventStopAndReturnFalse(e));case 88:return!i.canCutCopyPaste()||!n||(this.onCut(e),this.preventStopAndReturnFalse(e));case 86:return i.canCutCopyPaste()&&this.onPaste(e),this.preventStopAndReturnFalse(e);case 89:return this.onRedo(),this.preventStopAndReturnFalse(e);case 90:return this.onUndo(),this.preventStopAndReturnFalse(e);case 191:return this.onShowQna(),this.preventStopAndReturnFalse(e);case 71:return e.shiftKey?this.onUnGroup():this.onGroup(),this.preventStopAndReturnFalse(e);case 77:return this.onMergeGroup(),this.preventStopAndReturnFalse(e)}}return i.canPassUnhandledKeysToSelectedVisual()?this.allowSelectedVisualContainerToHandle(e,t):void 0},c.prototype.logScanKeyEvent=function(e){0!==this.viewModeState.getMode()||this.isFocusedOnTextElement()||e.ctrlKey||e.metaKey||e.altKey||!_.includes(t.scanModeKeys,e.keyCode)||this.telemetryService.logEvent(o.telemetry.EXScanModeKeyPressed)},c.prototype.isFocusedOnTextElement=function(){var e=document.activeElement;return i.isElementContentEditable(e)||i.isTextElement(e)},c.prototype.allowSelectedVisualContainerToHandle=function(e,t){if(!this.visualInteractivityDisabled&&n.isFocusInTree(".visualContainer")){var i=a.getSelectedVisual(this.selectionService);if(i){i=r.findVisualContainerViewModel(t.visualContainers,i);if(i)return i.handleKeyDown(e)}}},c.prototype.preventStopAndReturnFalse=function(e){return e&&(e.preventDefault(),e.stopPropagation()),!1},c.prototype.onUndo=function(){this.undoRedoService.undo()},c.prototype.onRedo=function(){this.undoRedoService.redo()},c.prototype.onCopy=function(e){this.canCopyOrCut()&&this.clipboardService.copy()},c.prototype.onCut=function(e){this.canCopyOrCut()&&this.clipboardService.cut()},c.prototype.onPaste=function(e){this.clipboardService.paste()},c.prototype.onRemoveFromLayout=function(e,t){this.layoutAuthoring.removeLayoutFromSelectedVisuals(t)},c.prototype.onDelete=function(e,t){var i=this;this.undoRedoService.register("CanvasKeyDelete",(function(){i.visualAuthoring.deleteSelectedVisuals(t)}))},c.prototype.onSelectAll=function(e,t){t=t.visualContainerGroups?_.map(t.visualContainerGroups,(function(e){return e.contract})):_.map(t.visualContainers,(function(e){return e.contract}));a.selectCanvasItems(t,this.selectionService)},c.prototype.onSave=function(){this.eventBridge.publishToChannel(e.events.saveKeyPressedEvent)},c.prototype.onClear=function(){this.eventBridge.publishToChannel(e.events.resetUserStateKeyPressedEvent)},c.prototype.onShowQna=function(){this.eventBridge.publishToChannel(e.events.addQnaContainer,{creationSource:7})},c.prototype.onGroup=function(){this.layoutAuthoring.groupCanvasItems(a.getSelectedCanvasItems(this.selectionService))},c.prototype.onUnGroup=function(){var t=this,e=a.getSelectedCanvasItems(this.selectionService);_.forEach(e,(function(e){e=s.contracts.isVisualContainerGroup(e)?e:e.parentGroup;e&&t.layoutAuthoring.ungroupCanvasItems(e)}))},c.prototype.onMergeGroup=function(){this.layoutAuthoring.canMergeCanvasItems()&&this.layoutAuthoring.mergeCanvasItemContainers(a.getSelectedCanvasItems(this.selectionService))},c.prototype.isSaveEvent=function(e){return this.isOnlyCtrlOrMeta(e)&&83===e.which},c.prototype.isDeleteEvent=function(e){return!e.ctrlKey&&46===e.which},c.prototype.canCopyOrCut=function(){return!this.visibilityService.get()},c.prototype.isClearEvent=function(e){return e.altKey&&e.shiftKey&&82===e.which},c.prototype.isCtrlOrMeta=function(e){var t=e.ctrlKey,i=e.metaKey;return e&&(t&&!i||!t&&i)},c.prototype.isOnlyCtrlOrMeta=function(e){return this.isCtrlOrMeta(e)&&!e.altKey&&!e.shiftKey},c.DebounceWait=100,c);function c(e,t,i,r,n,a,o,s,l,u){this.clipboardService=e,this.selectionService=t,this.viewModeState=i,this.undoRedoService=r,this.visualAuthoring=n,this.eventBridge=a,this.visibilityService=o,this.formFactor=s,this.layoutAuthoring=l,this.telemetryService=u,this.debouncedLogScanKeyEvent=_.debounce(this.logScanKeyEvent,c.DebounceWait)}})((s=o.explore||(o.explore={})).services||(s.services={}))})(powerbi=powerbi||{}),(function(e){(function(t){t.createCanvasScaleService=function(e,t,i,r,n,a,o){return new s(e,t,r,n,a,o)};var s=(e.prototype.setDisplayAreaScaleFactor=function(e){this.displayAreaScale=e,this.eventBridge.publishToChannel(t.events.canvasZoomScaleUpdated,e)},e.prototype.setWallpaperScaleFactor=function(e){this.wallpaperScale=e},e.prototype.getDisplayAreaScaleFactor=function(){return this.displayAreaScale},e.prototype.getWallpaperScaleFactor=function(){return this.wallpaperScale},e.prototype.getDisplayOption=function(){if(1===this.formFactorProvider.getCurrentLayout()&&1===this.viewModeState.getMode())return 3;if(null!=this.canvasZoom)return 3;if(!!this.visibility.get())return 0;if(null!=this.overrideDisplayOption)return this.overrideDisplayOption;var e=this.explorationNavigation.getCurrentSection();return e?e.size.displayOption:void 0},e.prototype.setDisplayOption=function(e){var t=this.explorationNavigation.getCurrentSection();t&&(this.canvasZoom=void 0,this.overlayService.hideAllDropdowns(),t.size.displayOption=e)},e.prototype.setCanvasZoom=function(e){this.overlayService.hideAllDropdowns(),this.canvasZoom=e},e.prototype.getCanvasZoom=function(){return this.canvasZoom},e);function e(e,t,i,r,n,a){this.eventBridge=e,this.explorationNavigation=t,this.formFactorProvider=i,this.visibility=r,this.viewModeState=n,this.overlayService=a,this.displayAreaScale=1,this.wallpaperScale=1}})((e=e.explore||(e.explore={})).services||(e.services={}))})(powerbi=powerbi||{}),(function(e){(e=(e=(e=e.explore||(e.explore={})).services||(e.services={})).events||(e.events={})).visualCustomCommand={type:2,name:"visualCustomCommand"},e.preparePersonalVisuals={type:2,name:"preparePersonalVisuals"},e.copyVisualAsImage={type:2,name:"copyVisualAsImage"},e.VisualContainerAdded={type:2,name:"VisualContainerAdded"}})(powerbi=powerbi||{}),(function(e){var t;t=e.explore||(e.explore={}),(function(){(t.services||(t.services={})).createExplorationCapabilitiesService=function(e,t){return new i(e,t)};var i=(e.prototype.setCapabilities=function(e){_.merge(this.options,e)},e.prototype.getCapabilities=function(){return this.options},e);function e(e,t){var i=!t||t.featureSwitches.contentAuthoringUIEnabled,r=!!e&&!!e.isGuestUser,t=!!t&&t.featureSwitches.elevatedGuestsTenantEnabled,t=r&&!t,e=!(!e||void 0===e.userLicense)&&"Free"===e.userLicense();this.options={shouldSetFocus:!0,showAppBar:!0,showStatusBar:!1,showTaskPane:!0,showVisualizationPane:!0,showNavContentPane:!0,visualContainerOptions:{showMenu:!0,showPin:!0,showContextMenu:!0,disablePin:t||!i,disableQueryCacheUpdates:!1},showBackButtonOnAppBar:!1,disablePin:t||!i,disableSharePointEmbed:r,disableSecurePublishToWeb:r||!i,disableQRGeneration:r,disableSaveAs:t||e,disableSwitchMode:t||!i,disableAnalyzeInExcel:r,expandTaskPane:!0,expandVisualizationPane:!0,allowVisualContainerPreload:!1,allowNewLoadingExperience:!1,persistentUserStateEnabled:!1,persistentUserStateThrottlingEnabled:!1,defaultPersonalBookmarkEnabled:!1,disableEditVariables:!0,disableChangeDetectionDialog:!0,showCopyVisualImageButton:!1}}})()})(powerbi=powerbi||{}),(function(e){var i;i=e.explore||(e.explore={}),(function(){(i.services||(i.services={})).createLayoutInsertionHelper=function(){return new e(150,150)};var e=(t.prototype.getEmptySpaces=function(e,t){for(var i=this.getNonOverlapingRects(e,t),r=[],n=0,a=this.filterWithMinimumWidth(i);n<a.length;n++){var o=a[n],o=this.extendRect(o,i);o.height>=this.emptySpaceMinHeight&&r.push(o)}return r},t.prototype.extendRect=function(e,t){for(var i,r=!1,n=0,a=t;n<a.length;n++){var o,s,l,u,c=a[n];c!==e&&(s=o=!1,this.doIntersect(c,e)&&(o=c.y+c.height===e.y,s=c.y===e.y+e.height),c.width<e.width||(s?(l={x:e.x,y:e.y,width:e.width,height:e.height+c.height},(u=this.getIntersectingRectangle(l,c))&&u.width===l.width&&(r=!0,i=l)):o&&(l={x:e.x,y:c.y,width:e.width,height:e.height+c.height},(u=this.getIntersectingRectangle(l,c))&&u.width===l.width&&(r=!0,i=l))))}return r?this.extendRect(i,t):e},t.prototype.getIntersectingRectangle=function(e,t){var i=Math.max(e.x,t.x),r=Math.min(e.x+e.width,t.x+t.width),n=Math.max(e.y,t.y),t=Math.min(e.y+e.height,t.y+t.height);return i<=r&&n<=t?{x:i,y:n,width:r-i,height:t-n}:null},t.prototype.doIntersect=function(e,t){return!(t.x>e.x+e.width||t.x+t.width<e.x||t.y>e.y+e.height||t.y+t.height<e.y)},t.prototype.filterWithArea=function(e){for(var t=[],i=0,r=e;i<r.length;i++){var n=r[i];0<n.width&&0<n.height&&t.push(n)}return t},t.prototype.filterWithMinimumWidth=function(e){for(var t=[],i=0,r=e;i<r.length;i++){var n=r[i];n.width>=this.emptySpaceMinWidth&&t.push(n)}return t},t.prototype.splitRectangleOnIntersection=function(e,t){t=this.getIntersectingRectangle(e,t);return t?this.filterWithArea([{x:e.x,y:e.y,width:e.width,height:t.y-e.y},{x:e.x,y:t.y+t.height,width:e.width,height:e.y+e.height-(t.y+t.height)},{x:e.x,y:t.y,width:t.x-e.x,height:t.height},{x:t.x+t.width,y:t.y,width:e.x+e.width-(t.x+t.width),height:t.height}]):[e]},t.prototype.getNonOverlapingRects=function(e,t){if(!t.length)return[];for(var i=[e],r=0,n=t;r<n.length;r++){for(var a=n[r],o=[],s=0,l=i;s<l.length;s++)var u=l[s],o=o.concat(this.splitRectangleOnIntersection(u,a));i=o}return i},t);function t(e,t){this.emptySpaceMinWidth=e,this.emptySpaceMinHeight=t}})()})(powerbi=powerbi||{}),(function(m){var f;(function(e){var a=jsCommon.ArrayExtensions,o=m.data.QueryProjectionsByRole,n=m.visualHost.utils.ResourcePackageUtils,h=m.visualHost.ThemeUtils,s=jsCommon.Trace,g=m.data.dsr.transformDataQueryToSemanticQueryDataShapeCommand,v=f.util.VisualContainerUtils;e.canPinVisualType=function(e,t,i,r){return null!=r&&null!=e.getPlugin(r)&&!i.hasFilterCapabilities(r)&&r!==m.visuals.plugins.basicShape.name&&r!==m.visuals.plugins.pageNavigator.name&&r!==m.visuals.plugins.bookmarkNavigator.name&&!t.isAnalysisVisual(r)&&!t.isQnaVisual(r)},e.createPinVisualService=function(e,t,i,r,n,a,o,s,l){return new u(e,t,i,n,a,o,s,l,r)};var u=(l.prototype.getPinData=function(e,t,i,r,n,a,o,s,l,u){var c,p,d=e.config.singleVisual;o?(c=o.options.query.command,n=(s=v.describeForPinning(this.displayNameService,s,d.query,d.columnProperties,this.visualPlugin.capabilities(d.visualType),this.featureSwitchService.featureSwitches,n?n.filterMetadata:null)).queryMetadata,p=_.clone(e),!u||0<(u=(!!o.filterContext&&!!o.filterContext.dataFilters&&o.filterContext.dataFilters.map((function(e){return e.filter}))||[]).concat(!!o.filterContext&&o.filterContext.highlightFilters||[])).length&&(p.filters=u.map((function(e){return f.FilterUtils.deriveFromSQFilters(e.from(),e.where(),null)})).reduce((function(e,t){return e.concat(t)}))),p={dataTransforms:o.transforms,dataViewSource:a?a.dataViewSource:null,elements:s.visualElements,query:c,queryMetadata:n,themeCollection:h.cloneThemeCollection(r),tileLayoutType:t,visualContainer:p},m.data.DataViewObjectDefinitions.getValue(e.config.singleVisual.vcObjects,{objectName:"title",propertyName:"text"},void 0)||this.setPinDataHeadings(a,n,p)):p={dataViewSource:{data:void 0},themeCollection:h.cloneThemeCollection(r),tileLayoutType:t,visualContainer:e};e=m.explore.dataReaderPlugins.getExplorationDataReaderDataSource(i),i=e&&e.getModelExtensions(),e=e&&e.getDataSourceVariables();return i&&(p.modelExtensions=i),e&&(p.dataSourceVariables=e),this.addResourcePackageIdsToPinData(d.visualType,p,l)},l.prototype.setPinDataHeadings=function(e,t,i){e=e&&e.dataViewSource&&e.dataViewSource.data.descriptor;if(e)var r=new m.data.dsr.QueryDescription(t,e),n=r.getMeasureRestatements(),a=r.getFilterRestatements(),r=r.getGroupRestatements();else{for(var o=[],s=[],l=0,u=t.Select;l<u.length;l++){var c=u[l];3===c.Type||1===c.Type?o.push(c.Restatement):4!==c.Type&&2048!==c.Type||s.push(c.Restatement)}0<s.length&&(r=s),0<o.length&&(n=o)}n?i.tileHeading=this.joinList(n):r&&(i.tileHeading=this.joinList(r)),a&&(i.tileFilterDetails=this.joinList(a)),n&&r&&(i.tileSubDisplay=m.common.getLocalize().format("TileHeadings_By",[this.joinList(r)]))},l.prototype.joinList=function(e){return e.join(m.common.getLocalize().get("ListJoin_Separator"))},l.prototype.pinVisualContainer=function(e,t,i,r,n,a){var o=this;this.getPinDataAsync(e,t,i,r,n,a).then((function(e){o.handler&&o.handler.pinVisual(e)}),(function(){}))},l.prototype.getPinDataAsync=function(s,l,u,c,p,d){return __awaiter(this,void 0,m.Promise,(function(){var t,i,r,n,a,o;return __generator(this,(function(e){switch(e.label){case 0:return t=l.config.singleVisual,i=t.visualType,r=i===m.visuals.plugins.image.name?1:0,[4,this.conceptualSchemaProxy.get(s)];case 1:return(n=e.sent(),this.visualQueryGenerator.shouldExecute(t,s)&&(a=m.common.GridLayoutConstants.getDefaultGridItemViewport(m.common.GridLayoutConstants.getMediumLandscapeGridItem()),a=this.visualQueryGenerator.execute({config:t,dataSources:s,schema:n,additionalFilters:u,dataWindow:a,ignoreViewportForCache:!0,allowClientSideFilters:!1})),a)?(o=a.options.query.command,o=g(o),this.modifyPinnedVisualDataShapeBinding(o.Binding,t.query,n,i),[4,this.dataProxy.execute(a.options)]):[3,3];case 2:return(o=e.sent())&&o.dataReaderResult&&o.dataReaderResult.disallowPersisting,[2,this.getPinData(l,r,s,c,u,o,a,n,p,d)];case 3:return[2,this.getPinData(l,r,s,c,null,null,null,null,p)]}}))}))},l.prototype.canPinVisualType=function(e){return m.explore.services.canPinVisualType(this.visualPlugin,this.visualPluginOps,this.visualCapabilitiesService,e)},l.prototype.setHandler=function(e){this.handler=e},l.prototype.modifyPinnedVisualDataShapeBinding=function(e,t,i,r){var n;e&&(n=this.visualPlugin.capabilities(r),l.isTableOrMatrix(r)?(e.DataReduction||(e.DataReduction={}),e.DataReduction.Primary={Window:{Count:100}}):l.supportsScalarCategoryAxis(n)&&(n=t.projections,t=t.defn.select(),e.DataReduction&&(e.DataReduction.Primary&&e.DataReduction.Primary.BinnedLineSample||e.DataReduction.Intersection&&e.DataReduction.Intersection.BinnedLineSample)||(!n||_.isEmpty(t)||(n=o.getRole(n,"Category"))&&!_.isEmpty(n.all())&&(n=n.getLastActiveQueryReference()||n.all()[0].queryRef,!(n=a.findItemWithName(t,n))||(i=n.expr.getMetadata(i))&&0===i.kind&&i.type.dateTime&&(e.DataReduction||(e.DataReduction={}),e.DataReduction.Primary={Bottom:{}})))))},l.prototype.addResourcePackageIdsToPinData=function(e,t,i){var r,n=[];return!this.visualPlugin.isCustomVisual(e)||(e=this.resourcePackagesService.getPackage(e))&&0<e.id&&n.push(e.id),!i||(r=t.themeCollection).customTheme&&this.addResourcePackageIdIfNeeded(i,r.customTheme.type,(function(e){return e.name===r.customTheme.name}),n),_.isEmpty(n)||(t.resourcePackageIds=_.uniq(n)),t},l.prototype.addResourcePackageIdIfNeeded=function(e,t,i,r){t=n.findResourcePackage(e,t);t&&null==t.id&&s.error("Resource package should have an ID"),t&&null!=t.id&&_.find(t.items,i)&&r.push(t.id)},l.supportsScalarCategoryAxis=function(e){return e.objects&&e.objects.categoryAxis&&e.objects.categoryAxis.properties&&void 0!==e.objects.categoryAxis.properties.axisType},l.isTableOrMatrix=function(e){var t=m.visuals.plugins;return e===t.table.name||e===t.matrix.name||e===t.tableEx.name||e===t.pivotTable.name},l);function l(e,t,i,r,n,a,o,s,l){this.conceptualSchemaProxy=e,this.displayNameService=t,this.dataProxy=i,this.resourcePackagesService=r,this.visualQueryGenerator=n,this.visualPlugin=a,this.visualPluginOps=o,this.visualCapabilitiesService=s,this.featureSwitchService=l}})((f=m.explore||(m.explore={})).services||(f.services={}))})(powerbi=powerbi||{}),(function(h){var r;(function(e){var l=h.data.FieldExprPattern,u=r.viewModels.ShowValueAsNoCalculation,c=r.viewModels.ShowValueAsPercentOfGrandTotalCalculation,p=r.viewModels.ShowValueAsPercentOfRoleTotalCalculation,d=h.data.SQExprConverter,i=h.data.SQExprUtils;e.createShowValueAsService=function(e,t,i,r,n){return new a(e,i,r,n)};var a=(t.prototype.createShowValueAsMenuItems=function(e,t,i){var r=l.getSchema(d.asFieldPattern(e));if(!t.schema(r).capabilities.supportsScopedEval)return[];var n=[];if(this.aggregateSupportsShowValueAs(e,t)){t=new u(h.common.getLocalize());n.push(this.showValueAsMenuItemBuilder(t));t=new c(h.common.getLocalize());n.push(this.showValueAsMenuItemBuilder(t));i=this.visualPlugin.capabilities(i),i=i&&i.dataRoleTotals;if(!_.isEmpty(i))for(var a=0,o=i;a<o.length;a++){var s=o[a],s=new p(this.localizationService,s.roles,h.data.getDisplayName(s.displayName,this.localizationService));n.push(this.showValueAsMenuItemBuilder(s))}}return n},t.prototype.applyShowValueAs=function(t,i,r){return __awaiter(this,void 0,h.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.visualAuthoring.applyShowValueAs(t,i,r)];case 1:return e.sent()&&this.telemetryService.logEvent(h.telemetry.EXChangeQuickCalc,{original:this.showValueAsKindToTelemetryId(i.kind),target:this.showValueAsKindToTelemetryId(r.kind)}),[2]}}))}))},t.prototype.showValueAsMenuItemBuilder=function(e){var t={type:0};return t.key={action:32,showValueAs:e},t.text=e.name,t},t.prototype.aggregateSupportsShowValueAs=function(e,t){t=e.getMetadata(t);return t&&t.type&&t.type.numeric&&i.isMeasure(e)},t.prototype.showValueAsKindToTelemetryId=function(e){switch(e){case void 0:return"None";case 0:return"PercentOfGrandTotal";case 1:return"PercentOfRoleTotal"}},t);function t(e,t,i,r){this.localizationService=e,this.telemetryService=t,this.visualAuthoring=i,this.visualPlugin=r}})((r=h.explore||(h.explore={})).services||(r.services={}))})(powerbi=powerbi||{}),(function(a){var e;(function(e){var r=a.data.DataViewQueryEngine,n=a.explore.util.VisualContainerUtils;e.createVisualContainerDataSelectionService=function(e,t){return new i(e,t)};var i=(t.prototype.getSelectedValues=function(e,t){if(t&&e.valueDetails){var i=this.filterThroughValueDetails(e.valueDetails,e.metadata);return this.amendIdentityToValueDetails(e,i)}t=n.getVisualType(this.visualContainer.contract),i=n.getVisualQuery(this.visualContainer.contract),i=this.visualPluginOps.dataViewKinds(t,i);return r.query(this.getDataViews(),e,i)},t.prototype.filterThroughValueDetails=function(e,t){return t?_.filter(e,(function(e){return _.includes(t,e.queryName)})):e},t.prototype.amendIdentityToValueDetails=function(e,t){for(var i=[],r=0,n=t;r<n.length;r++){var a=n[r];i.push({queryName:a.queryName,identity:a.identity||e.dataMap&&_.values(e.dataMap)[0][0],expr:a.expr,value:a.value,formattedValue:a.formattedValue})}return i},t.prototype.getDataViews=function(){var e=this.visualContainer&&this.visualContainer.getRunningVisual();return e&&e.getDataViews()},t);function t(e,t){this.visualContainer=e,this.visualPluginOps=t}e.VisualContainerDataSelectionService=i})((e=a.explore||(a.explore={})).services||(e.services={}))})(powerbi=powerbi||{}),(function(B){var k;(function(a){var l,e=(l=a.VisualContainerMenuCommand,__extends(t,l),t.prototype.execute=function(){return __awaiter(this,void 0,B.Promise,(function(){return __generator(this,(function(e){return this.overlayService,this.undoRedo,this.visualAuthoring,this.visualAuthoring.toggleSlicerVisualSearch(this.visualContainer.contract,this.filterGenerator,this.visualPlugin),this.overlayService.hideAllDropdowns(),this.announceSelectionState(this.visualContainer.visualHostServices,this.isSearchOn),[2]}))}))},t.prototype.isVisible=function(){return __awaiter(this,void 0,B.Promise,(function(){return __generator(this,(function(e){return[2,this.menuOptions.canSearch&&l.prototype.isVisible.call(this)]}))}))},Object.defineProperty(t.prototype,"isSearchOn",{get:function(){var e=this.visualContainer.contract.config.singleVisual;if(!e||!e.objects)return!1;var t=k.util.VisualContainerUtils.getVisualCapabilities(this.visualContainer.contract,this.visualPlugin);if(!t)return!1;t=this.filterGenerator.tryGetSelfFilterEnabledProperty(t);if(!t)return!1;t=B.data.DataViewObjectDefinitions.getValue(e.objects,t,null);return t&&t.value||!1},enumerable:!1,configurable:!0}),t);function t(e,t,i,r,n,a,o,s){s=l.call(this,"Slicer_SearchBox_Text",void 0,"itemIcon glyphicon pbi-glyph-search glyph-small",s&&s.search)||this;return s.visualContainer=e,s.filterGenerator=t,s.overlayService=i,s.undoRedo=r,s.visualAuthoring=n,s.visualPlugin=a,s.menuOptions=o,s.selected=s.isSearchOn,s}a.ToggleSearchCommand=e;var c,e=(c=a.VisualContainerMenuCommand,__extends(i,c),i.prototype.execute=function(){return __awaiter(this,void 0,B.Promise,(function(){var t,i,r,n;return __generator(this,(function(e){switch(e.label){case 0:this.conceptualSchemaProxy,this.dataSources,this.eventBridge,this.overlayService,t=this.visualContainer.getRunningVisual(),n=this.visualContainer.visualTitle,i=null!=n?n.text:"",r=this.dataSources.get(),e.label=1;case 1:return e.trys.push([1,3,4,5]),[4,this.conceptualSchemaProxy.get(r)];case 2:return n=e.sent(),this.eventBridge.publishToChannel(a.events.exportVisualData,{visualData:{data:t.getData(),dataTransforms:t.getDataTransforms()},visualContainer:this.visualContainer.contract,visualTitle:i,additionalFilters:this.visualContainer.hostServices.getFilters(this.filterGenerator,n)}),[3,5];case 3:return e.sent(),[3,5];case 4:return this.overlayService.hideAllDropdowns(),[7];case 5:return[2]}}))}))},i.prototype.isVisible=function(){return __awaiter(this,void 0,B.Promise,(function(){return __generator(this,(function(e){return[2,this.menuOptions.canExport&&c.prototype.isVisible.call(this)]}))}))},i.prototype.isDisabled=function(){return __awaiter(this,void 0,B.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,c.prototype.isDisabled.call(this)];case 1:return[2,e.sent()||this.explorationSettings&&this.explorationSettings.exportDataMode&&2===this.explorationSettings.exportDataMode||this.menuOptions.exportDataDenied||this.featureSwitchService.featureSwitches.disableExportDataOnVisualError&&this.visualHasError()]}}))}))},i.prototype.visualHasError=function(){return!!this.visualContainer.errorInfo},i.prototype.getToolTip=function(t){return __awaiter(this,void 0,B.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.isDisabled()];case 1:return e.sent()?this.menuOptions.exportDataDenied?[2,t.get("ExportData_DeniedTooltip")]:this.visualHasError()?[2,t.get("VisualContainer_ExportDataDisabled_VisualError_Tooltip")]:[2,t.get("VisualContainer_ExportDataDisabled_Tooltip")]:[2,null]}}))}))},i);function i(e,t,i,r,n,a,o,s,l,u){u=c.call(this,"ExportData_MenuItem",void 0,"itemIcon glyphicon pbi-glyph-export glyph-small",u&&u.exportData)||this;return u.visualContainer=e,u.conceptualSchemaProxy=t,u.dataSources=i,u.eventBridge=r,u.featureSwitchService=n,u.filterGenerator=a,u.overlayService=o,u.menuOptions=s,u.explorationSettings=l,u}a.ExportVisualDataCommand=e;var n,e=(n=a.VisualContainerMenuCommand,__extends(r,n),r.prototype.execute=function(){return __awaiter(this,void 0,B.Promise,(function(){return __generator(this,(function(e){return this.eventBridge,this.eventBridge.publishToChannel(a.events.addCommentVisual,{visualContainerId:this.visualContainer.id}),[2]}))}))},r.prototype.isVisible=function(){return this.menuOptions.canAddComment&&n.prototype.isVisible.call(this)},r);function r(e,t,i,r){r=n.call(this,"AddComment",void 0,"itemIcon glyphicon glyph-small pbi-glyph-comment",r&&r.addComment)||this;return r.visualContainer=e,r.eventBridge=t,r.menuOptions=i,r}a.AddCommentVisualCommand=e;var o,e=(o=a.VisualContainerMenuCommand,__extends(s,o),s.prototype.execute=function(){return __awaiter(this,void 0,B.Promise,(function(){return __generator(this,(function(e){return this.eventBridge,this.eventBridge.publishToChannel(a.events.editModeChanged,{editMode:1,visualContainer:this.visualContainer.contract}),this.overlayService.hideAllDropdowns(),[2]}))}))},s.prototype.isVisible=function(){return __awaiter(this,void 0,B.Promise,(function(){return __generator(this,(function(e){return[2,this.menuOptions.canEdit&&o.prototype.isVisible.call(this)]}))}))},s);function s(e,t,i,r,n){n=o.call(this,"Edit_ToolTip",void 0,"itemIcon glyphicon pbi-glyph-edit glyph-mini",n&&n.enterAdvancedEditMode)||this;return n.visualContainer=e,n.eventBridge=t,n.overlayService=i,n.menuOptions=r,n}a.EnterAdvancedEditModeCommand=e;var u,e=(u=a.VisualContainerMenuCommand,__extends(p,u),p.prototype.execute=function(){return __awaiter(this,void 0,B.Promise,(function(){var t=this;return __generator(this,(function(e){return this.eventBridge,this.undoRedo,this.undoRedo.register("DeleteVisualContainer",(function(){t.eventBridge.publishToChannel(a.events.deleteVisualContainer,t.visualContainer.contract)})),[2]}))}))},p.prototype.isVisible=function(){return __awaiter(this,void 0,B.Promise,(function(){return __generator(this,(function(e){return[2,this.menuOptions.canDelete&&u.prototype.isVisible.call(this)]}))}))},p);function p(e,t,i,r,n){n=u.call(this,"Remove_visual",void 0,"itemIcon glyphicon pbi-glyph-close glyph-mini",n&&n.removeVisual)||this;return n.visualContainer=e,n.eventBridge=t,n.undoRedo=i,n.menuOptions=r,n}a.DeleteVisualContainerCommand=e;var d,e=(d=a.VisualContainerMenuCommand,__extends(h,d),h.prototype.execute=function(){return __awaiter(this,void 0,B.Promise,(function(){return __generator(this,(function(e){return this.eventBridge,this.eventBridge.publishToChannel(a.events.getClusters,{visualContainer:this.visualContainer.contract}),[2]}))}))},h.prototype.isVisible=function(){return __awaiter(this,void 0,B.Promise,(function(){return __generator(this,(function(e){return[2,this.menuOptions.canCluster&&d.prototype.isVisible.call(this)]}))}))},h);function h(e,t,i,r,n,a){a=d.call(this,e,void 0,t,a&&a.clusters)||this;return a.visualContainer=i,a.eventBridge=r,a.menuOptions=n,a}a.ClustersSpatialClustersCommand=e;var g,e=(__extends(v,g=e),v);function v(e,t,i,r){return g.call(this,"Visual_Cluster_FindGroups","itemIcon glyphicon pbi-glyph-scatter glyph-small",e,t,i,r)||this}a.GetClustersCommand=e;var m,e=(m=a.VisualContainerMenuCommand,__extends(f,m),f.prototype.execute=function(){return __awaiter(this,void 0,B.Promise,(function(){return __generator(this,(function(e){return this.visibility,4===this.visualContainer.contract.visibility?this.visibility.clear():this.visibility.set(this.visualContainer.contract,4),this.announceSelectionState(this.visualContainer.visualHostServices,this.isSpotlightOn),[2]}))}))},f.prototype.isVisible=function(){return __awaiter(this,void 0,B.Promise,(function(){return __generator(this,(function(e){return[2,this.menuOptions.canSpotlight&&m.prototype.isVisible.call(this)]}))}))},Object.defineProperty(f.prototype,"isSpotlightOn",{get:function(){return 4===this.visualContainer.contract.visibility},enumerable:!1,configurable:!0}),f);function f(e,t,i,r){r=m.call(this,"Spotlight",void 0,"itemIcon glyphicon pbi-glyph-flashlight glyph-small",r&&r.spotlight)||this;return r.visualContainer=e,r.visibility=t,r.menuOptions=i,r.selected=r.isSpotlightOn,r}a.ToggleSpotlightCommand=e;var y,e=(y=a.VisualContainerMenuCommand,__extends(C,y),C.prototype.execute=function(){return __awaiter(this,void 0,B.Promise,(function(){return __generator(this,(function(e){return this.eventBridge,this.visibility,this.visibility.set(this.visualContainer.contract,4),this.eventBridge.publishToChannel(a.events.shareToTeamsVisual),[2]}))}))},C.prototype.isVisible=function(){return this.menuOptions.canShareToTeams&&y.prototype.isVisible.call(this)},C);function C(e,t,i,r,n){n=y.call(this,"ChatInTeams",void 0,"itemIcon glyphicon glyph-small pbi-glyph-teamslogo",n&&n.shareToTeams)||this;return n.visualContainer=e,n.visibility=t,n.eventBridge=i,n.menuOptions=r,n}a.ShareToTeamsVisualCommand=e;var S,e=(S=a.VisualContainerMenuCommand,__extends(b,S),b.prototype.execute=function(){return __awaiter(this,void 0,B.Promise,(function(){var t;return __generator(this,(function(e){return this.eventBridge,this.overlayService.hideAllDropdowns(),t=this.getSortByField(),t={visualContainer:this.visualContainer.contract,sortableField:t,sortDirection:this.sortDirection,sortGroup:this.sortGroup},this.eventBridge.publishToChannel(a.events.toggleSortDirectionVisualContainer,t),[2]}))}))},b.prototype.isVisible=function(){return __awaiter(this,void 0,B.Promise,(function(){return __generator(this,(function(e){return[2,this.menuOptions.canSort&&S.prototype.isVisible.call(this)]}))}))},b.prototype.isDisabled=function(){return __awaiter(this,void 0,B.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,S.prototype.isDisabled.call(this)];case 1:return[2,e.sent()||void 0===this.getSortByField()]}}))}))},Object.defineProperty(b.prototype,"activeSortableField",{get:function(){return _.find(this.sortGroup.fields,(function(e){return e.active}))},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"isHighlighted",{get:function(){return void 0!==this.activeSortableField&&this.activeSortableField.sortDirection===this.sortDirection},enumerable:!1,configurable:!0}),b.prototype.getSortByField=function(){if(this.sortGroup.fields)return 1===_.size(this.sortGroup.fields)?this.sortGroup.fields[0]:this.activeSortableField},b);function b(e,t,i,r,n,a,o,s,l,u){u=S.call(this,e,void 0,t,l&&l.sort,void 0,void 0,u)||this;return u.sortDirection=i,u.visualContainer=r,u.eventBridge=n,u.overlayService=a,u.menuOptions=o,u.sortGroup=s,u.selected=u.isHighlighted,u}a.SortAscendingDescendingCommand=e;var E,V=(__extends(w,E=e),w);function w(e,t,i,r,n,a,o){return E.call(this,"Sort_Desc","itemIcon glyphicon pbi-glyph-ztoa glyph-small",2,e,t,i,r,n,a,o)||this}a.SortDescendingCommand=V;var x,P=(__extends(F,x=e),F);function F(e,t,i,r,n,a){return x.call(this,"Sort_Asc","itemIcon glyphicon pbi-glyph-atoz glyph-small",1,e,t,i,r,n,a)||this}a.SortAscendingCommand=P;var A,e=(A=a.VisualContainerMenuCommand,__extends(T,A),T.prototype.execute=function(){return __awaiter(this,void 0,B.Promise,(function(){return __generator(this,(function(e){return[2]}))}))},T.prototype.isVisible=function(){return __awaiter(this,void 0,B.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return(t=this.menuOptions.canSort)?[4,A.prototype.isVisible.call(this)]:[3,2];case 1:t=e.sent(),e.label=2;case 2:return t?[2,1<_.size(this.menuOptions.sortSetting.sortableFields)]:[2,!1]}}))}))},T.prototype.getChildren=function(){return __awaiter(this,void 0,B.Promise,(function(){var t,i,r,n=this;return __generator(this,(function(e){return t=this.menuOptions.sortSetting.sortableFields,i=1===this.visualContainer.readOnlyState.actualSortDirection?"Sort_Asc":"Sort_Desc",r=_.some(this.menuOptions.sortSetting.sortableFields,(function(e){return e.active})),[2,_.map(t,(function(e){return new O(n.visualContainer,e,r?i:void 0,n.eventBridge,n.overlayService,n.displayOverride)}))]}))}))},T);function T(e,t,i,r,n){var a=A.call(this,"MobileFooter_SortBy",void 0,void 0,n&&n.sort)||this;return a.visualContainer=e,a.eventBridge=t,a.overlayService=i,a.menuOptions=r,a.displayOverride=n,a}a.SortByCommandCollection=e;var D,e=(D=a.VisualContainerMenuCommand,__extends(I,D),I.prototype.execute=function(){return __awaiter(this,void 0,B.Promise,(function(){return __generator(this,(function(e){return[2]}))}))},I.prototype.title=function(e){return e.format("Sort_Group",e.get(this.sortGroup.displayName))},I.prototype.isVisible=function(){return __awaiter(this,void 0,B.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return(t=this.menuOptions.canSort)?[4,D.prototype.isVisible.call(this)]:[3,2];case 1:t=e.sent(),e.label=2;case 2:return t?[2,!0]:[2,!1]}}))}))},I.prototype.getChildren=function(){return __awaiter(this,void 0,B.Promise,(function(){var t,i,r,n,a;return __generator(this,(function(e){for(t=[],i=0,r=this.sortGroup.fields;i<r.length;i++)n=r[i],a=1===n.sortDirection?"Sort_Asc":"Sort_Desc",t.push(new O(this.visualContainer,n,a,this.eventBridge,this.overlayService,this.displayOverride));return t.push(new V(this.visualContainer,this.eventBridge,this.overlayService,this.menuOptions,this.sortGroup,this.displayOverride,1),new P(this.visualContainer,this.eventBridge,this.overlayService,this.menuOptions,this.sortGroup,this.displayOverride)),[2,t]}))}))},I);function I(e,t,i,r,n,a){var o=D.call(this,"Sort_Group"+n.displayName,void 0,void 0,a&&a.sort)||this;return o.visualContainer=e,o.eventBridge=t,o.overlayService=i,o.menuOptions=r,o.sortGroup=n,o.displayOverride=a,o}a.GroupedSortByCommandCollection=e;var M,O=(M=a.VisualContainerMenuCommand,__extends(N,M),N.prototype.execute=function(){return __awaiter(this,void 0,B.Promise,(function(){var t;return __generator(this,(function(e){return this.sortField,this.eventBridge,this.overlayService.hideAllDropdowns(),t={sortableField:this.sortField,sortDirection:this.visualContainer.readOnlyState.actualSortDirection,visualContainer:this.visualContainer.contract},this.eventBridge.publishToChannel(a.events.toggleSortVisualContainer,t),[2]}))}))},N.prototype.title=function(e){return this.sortField.displayName},N.prototype.getToolTip=function(t){return __awaiter(this,void 0,B.Promise,(function(){return __generator(this,(function(e){return this.sortDirectionKey?[2,this.sortField.displayName+", "+t.get(this.sortDirectionKey)]:[2,this.title(t)]}))}))},N);function N(e,t,i,r,n,a){a=M.call(this,t.displayName,void 0,void 0,a&&a.sort)||this;return a.visualContainer=e,a.sortField=t,a.sortDirectionKey=i,a.eventBridge=r,a.overlayService=n,a.selected=a.sortField.active,a}a.SortByCommand=O;var R,e=(R=a.VisualContainerMenuCommand,__extends(L,R),L.prototype.execute=function(){return __awaiter(this,void 0,B.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return this.telemetryService.logEvent(B.telemetry.EXGetInsightsMenuCommand,{visualType:k.util.VisualContainerUtils.getVisualType(this.visualContainer.contract),visualName:this.visualContainer.contract.name}),[4,this.lazyScoped("automatedInsightsQuery")];case 1:return e.sent().showAutomatedInsights({entryPoint:"VisualOptionsMenu",queryOptions:{summarySelectionOptions:{visualsToSummarize:[this.visualContainer.contract]},updateProcessingState:!0},enforcePremiumLicensing:!0,viewOnlyNoteworthy:!1}),[2]}}))}))},L.prototype.isVisible=function(){return __awaiter(this,void 0,B.Promise,(function(){return __generator(this,(function(e){return[2,this.menuOptions.canGetInsights&&R.prototype.isVisible.call(this)]}))}))},L);function L(e,t,i,r,n){n=R.call(this,"AutomatedInsights_AppBar_GetInsights",void 0,"itemIcon glyphicon pbi-glyph-insight glyph-small",n&&n.insightsAnalysis)||this;return n.visualContainer=e,n.menuOptions=t,n.lazyScoped=i,n.telemetryService=r,n}a.GetInsightsCommand=e})((k=B.explore||(B.explore={})).services||(k.services={}))})(powerbi=powerbi||{}),(function(r){var e,n,t;function i(e){this.services=e,this.instanceId=void 0}e=(e=r.explore||(r.explore={})).services||(e.services={}),n={"0.00 %;-0.00 %;0.00 %":"Percentage","0.0 %;-0.0 %;0.0 %":"Percentage1"},i.initialize=function(e){i.initialized||(i.initialized=!0,r.visuals.valueFormatter.setLocaleOptions(i.createLocaleOptions(e)),r.visuals.ToolTipComponent.localizationOptions=i.createTooltipLocaleOptions(e),r.data.DataViewTransform.setLocalizationOptions(i.createDataViewTransformLocalizationOptions(e)))},i.createLocaleOptions=function(t){return{null:t.get("NullValue"),true:t.get("BooleanTrue"),false:t.get("BooleanFalse"),NaN:t.get("NaNValue"),infinity:t.get("InfinityValue"),negativeInfinity:t.get("NegativeInfinityValue"),beautify:function(e){return i.beautify(t,e)},describe:function(e){return i.describeUnit(t,e)},restatementComma:t.get("PowerBI_TwoStrings_SeperateWithCommaAndVisualSpace"),restatementCompoundAnd:t.get("FilterRestatement_CompoundAnd"),restatementCompoundOr:t.get("Generic_Or")}},i.createTooltipLocaleOptions=function(e){return{highlightedValueDisplayName:e.get(r.visuals.ToolTipComponent.highlightedValueDisplayNameResorceKey)}},i.createDataViewTransformLocalizationOptions=function(e){return{quarterPrefix:e.get(r.visuals.ForecastHelper.quarterHierarchyLevelPrefixResorceKey)}},i.prototype.getLocalizedString=function(e){for(var t,i=[],r=1;r<arguments.length;r++)i[r-1]=arguments[r];return(t=this.services.localizationService).format.apply(t,__spreadArray([e],i||[]))},i.prototype.requestFocus=function(e){jsCommon.FocusManager.focus(e)},i.prototype.alertScreenReader=function(e){},i.prototype.alertWithDebounce=function(e,t){},i.prototype.onDragStart=function(){},i.prototype.getVisualLinkProperties=function(){},i.prototype.canSelect=function(){return!1},i.prototype.onSelecting=function(){},i.prototype.onSelect=function(){},i.prototype.onSwitchFocusModeState=function(){},i.prototype.canExpandCollapse=function(e){return!!this.services.canExpandCollapse&&this.services.canExpandCollapse(e)},i.prototype.setNodeExpansionState=function(e){},i.prototype.setLevelExpansionState=function(e){},i.prototype.onContextMenu=function(){},i.prototype.loadMoreData=function(){},i.prototype.loadWindow=function(e){},i.prototype.setShouldDeferData=function(){},i.prototype.persistProperties=function(e){},i.prototype.onCustomSort=function(e){},i.prototype.getViewMode=function(){return 0},i.prototype.getEditMode=function(){return 0},i.prototype.setWarnings=function(e){},i.prototype.setToolbar=function(e){},i.prototype.shouldRetainSelection=function(){return!1},i.prototype.geocoder=function(){return this.services.geocoder},i.prototype.geolocation=function(){return this.services.geolocation},i.prototype.locale=function(){return r.common.getUnmappedCultureInfo()},i.prototype.promiseFactory=function(){return this.services.promiseFactory},i.prototype.ignoreDefaultFilter=function(){return!1},i.prototype.getIdentityDisplayNames=function(e){},i.prototype.setIdentityDisplayNames=function(e){},i.prototype.setFilterExpressionMetadata=function(){},i.prototype.getFilterExpressionMetadata=function(){},i.prototype.decompositionService=function(){},i.prototype.dropdown=function(){},i.prototype.tooltips=function(){return this.services.visualHostTooltipService},i.prototype.telemetry=function(){},i.prototype.authenticationService=function(){return this.services.authenticationService},i.prototype.localStorageService=function(){},i.prototype.eventService=function(){},i.prototype.licenseManagerService=function(){},i.prototype.drill=function(e){},i.prototype.loader=function(){return this.services.moduleLoader},i.prototype.getUIComponentFactory=function(){},i.prototype.applyJsonFilter=function(e,t,i,r){},i.prototype.applyIdentityFilter=function(e,t,i,r){},i.prototype.launchUrl=function(e){},i.prototype.refreshHostData=function(){},i.prototype.getJSONFilter=function(e,t){return this.promiseFactory().reject()},i.prototype.onHyperlinkClick=function(e,t){},i.prototype.visualTimeSynchronization=function(){},i.prototype.isVisualEnabled=function(){return this.promiseFactory().resolve(!0)},i.prototype.dataMultiSelectMode=function(){return 0},i.prototype.networkAvailability=function(){},i.prototype.downloadService=function(){},i.prototype.setAriaMetadata=function(e){},i.prototype.artifactService=function(){},i.prototype.getSectionsMetadata$=function(){},i.prototype.getBookmarksMetadata$=function(){},i.prototype.onNotifyLicense=function(e){this.services.onNotifyLicense&&this.services.onNotifyLicense(e)},i.prototype.onClearLicenseNotification=function(){this.services.onClearLicenseNotification&&this.services.onClearLicenseNotification()},i.prototype.onNotifyFeatureBlocked=function(e){this.services.onNotifyFeatureBlocked&&this.services.onNotifyFeatureBlocked(e)},i.prototype.getSubSelectionService=function(){},i.prototype.webAccessService=function(){},i.beautify=function(e,t){var i=n[t];return i?(r.visuals.valueFormatter.beautifyTrace(i),e.getOptional(i)||t):t},i.describeUnit=function(e,t){var i=-1===t?"Auto":t.toString(),r=e.getOptional("DisplayUnitSystem_E"+i+"_Title"),i=t<=0?"{0}":e.getOptional("DisplayUnitSystem_E"+i+"_LabelFormat");if(r||i)return{title:r,format:i}},t=i,e.VisualHostServices=t,e.createVisualHostServices=function(e){return new t(e)}})(powerbi=powerbi||{}),(function(y){var t;(function(e){var p=y.visualHost.CustomVisualsUtils,v=y.data.DataViewObjectDefinitions,m=t.util.VisualContainerUtils;e.createVisualValidatorService=function(e,t,i,r,n,a,o,s,l,u,c,p,d){return new h(e,t,i,r,n,a,o,s,l,u,c,p,d)};var h=(f.prototype.shouldBlockVisualQuery=function(e){var t=this.explorationNavigation.getCurrentExploration(),i=t&&t.reportId,r=m.getVisualType(e),t=y.explore.util.ScriptVisualsUtil.getScriptVisualType(r),r=this.reportSettingsService.areScriptVisualsApproved();return!(!m.isScriptVisual(e,this.visualPlugin)||r&&!this.scriptVisuals.shouldBlockScriptVisual(t,i))},f.prototype.validate=function(d,h,g){return __awaiter(this,void 0,y.Promise,(function(){var t,i,r,n,a,o,s,l,u,c,p;return __generator(this,(function(e){switch(e.label){case 0:if(m.isScriptVisual(d,this.visualPlugin)){switch(t=m.getVisualType(d),t=y.explore.util.ScriptVisualsUtil.getScriptVisualType(t),o=r=void 0,t){case 0:r=this.scriptVisuals.getScriptVisualErrorDetails(0,g),o="ScriptVisualsNotEnabled";break;case 1:r=this.scriptVisuals.getScriptVisualErrorDetails(1,g),o="PythonVisualsNotEnabled"}if(r)return n=this.reportSettingsService.areScriptVisualsApproved(),[2,{details:r,code:n?"ScriptVisualError":o}]}return(t=m.getVisualType(d))?(i=this.visualPlugin.getPlugin(t))&&i.apiVersion&&!y.extensibility.getVisualApiVersions().some((function(e){return e.version===i.apiVersion}))?[2,{details:r={message:this.localizationService.get("CustomVisualApiVersionNotSupported"),displayableErrorInfo:[]},code:"CvApiVersionNotSupported"}]:this.trustedVisual.isTrustedVisual(t)?(p=this.trustedVisual.validate(t))?[2,{details:p,code:"TrustedVisualError"}]:this.visualPlugin.isCustomVisual(t)?[2,this.validateCustomVisual(t)]:[3,12]:[3,1]:[2];case 1:return this.visualPlugin.isCustomVisual(t)?[2,this.validateCustomVisual(t)]:[3,2];case 2:return this.visualPlugin.getPlugin(t)?[3,3]:[2,{details:r=f.buildErrorDetails(this.localizationService.get("VisualContainer_UnableToFindVisualMessage"),this.localizationService.get("VisualContainer_UnableToFindVisualKey"),this.localizationService.get("VisualContainer_UnableToFindVisualValue")),code:"UnsupportedVisual"}];case 3:return t!==y.visuals.plugins.keyDriversVisual.name?[3,4]:(o=p=void 0,n=_.some(h.schemas,(function(e){return e.capabilities.insights&&e.capabilities.insights.supportsKeyDrivers})),a=this.explorationCapabilities.getCapabilities().analysisVisuals,n&&a||(p=f.buildErrorDetails(this.localizationService.get("VisualContainer_AnalysisVisual_NotSupportedMessage"),this.localizationService.get("VisualContainer_FailedToLoadVisual"),this.localizationService.get("VisualContainer_AnalysisVisual_NotSupportedValue")),o="AnalysisVisualNotSupported"),p?(p.source="User",[2,{details:p,code:o}]):[3,12]);case 4:return t!==y.visuals.plugins.qnaVisual.name?[3,5]:(l=this.featureSwitchService.featureSwitches.qnaVisual,a=_.some(h.schemas,(function(e){return e.capabilities&&e.capabilities.supportsQna})),s=this.explorationCapabilities.getCapabilities().qna,l&&a&&s?[3,12]:((p=f.buildErrorDetails(this.localizationService.get("Qna_NotAllowedForReport_QnaNotSupported"),this.localizationService.get("VisualContainer_QnaVisual_NotSupportedTitle"),this.localizationService.get("VisualContainer_QnaVisual_NotSupportedMessage"))).source="User",[2,{details:p,code:"QnaVisualNotSupported"}]));case 5:return t!==y.visuals.plugins.decompositionTreeVisual.name?[3,6]:(o=p=void 0,s=_.every(h.schemas,(function(e){return e.capabilities&&e.capabilities.supportsInstanceFilters})),u=_.some(h.schemas,(function(e){return e.isMultiDimensionalModel})),s&&!u||(p=f.buildErrorDetails(this.localizationService.get("VisualContainer_DecompositionTreeVisual_NotSupportedMessage"),this.localizationService.get("VisualContainer_FailedToLoadVisual"),this.localizationService.get("VisualContainer_DecompositionTreeVisual_NotSupportedValue")),o="DecompositionTreeVisualNotSupported"),p?(p.source="User",[2,{details:p,code:o}]):[3,12]);case 6:return t!==y.visuals.plugins.azureMap.name?[3,7]:(l=this.featureSwitchService.featureSwitches.azureMapVisual,u=this.featureSwitchService.featureSwitches.azureMapEnabled,c=this.featureSwitchService.featureSwitches.azureMapPreviewEnabled,this.explorationCapabilities.getCapabilities().azureMaps?l&&(u||c)?[3,12]:((p=f.buildErrorDetails(this.localizationService.get("VisualContainer_AzureMapVisual_NotEnabledMessage"),this.localizationService.get("VisualContainer_FailedToLoadVisual"),this.localizationService.get("VisualContainer_AzureMapVisual_NotEnabledValue"))).source="User",[2,{details:p,code:"AzureMapVisualNotEnabled"}]):((p=f.buildErrorDetails(this.localizationService.get("VisualContainer_AzureMapVisual_NotSupportedMessage"),this.localizationService.get("VisualContainer_FailedToLoadVisual"),this.localizationService.get("VisualContainer_AnalysisVisual_NotSupportedValue"))).source="User",[2,{details:p,code:"AzureMapVisualNotSupported"}]));case 7:return t!==y.visuals.plugins.map.name?[3,9]:[4,this.validateMapAndFilledMap("MapVisualNotEnabled")];case 8:return[2,e.sent()];case 9:return t!==y.visuals.plugins.filledMap.name?[3,11]:[4,this.validateMapAndFilledMap("FilledMapVisualNotEnabled")];case 10:return[2,e.sent()];case 11:if(this.featureSwitchService.featureSwitches.deprecateOldVisuals&&(t===y.visuals.plugins.comboChart.name||t===y.visuals.plugins.dataDotChart.name||t===y.visuals.plugins.dataDotClusteredColumnComboChart.name||t===y.visuals.plugins.dataDotStackedColumnComboChart.name||t===y.visuals.plugins.sunburst.name))return(p=f.buildErrorDetails(this.localizationService.get("VisualContainer_DeprecatedVisual_Message"),this.localizationService.get("VisualContainer_FailedToLoadVisual"),this.localizationService.get("VisualContainer_DeprecatedVisual_Value"))).source="PowerBI",[2,{details:p,code:"deprecateVisualScreamFS"}];if(t===y.visuals.plugins.textbox.name&&!this.featureSwitchService.featureSwitches.daxTransformEnabled&&(c=m.getSingleVisualConfig(d),c=v.getValue(c.objects,{objectName:"general",propertyName:"paragraphs"},void 0),_.some(c,(function(e){return _.some(e.textRuns,(function(e){return y.visuals.TextEvaluation.isTextRunConditional(e)||y.visuals.TextEvaluation.isTextRun(e)&&y.isValueRef(e.value)}))}))))return(p=f.buildErrorDetails(this.localizationService.get("VisualContainer_Summarization_NotSupportedMessage"),this.localizationService.get("Summarization_Warning_UnsupportedModel"),this.localizationService.get("Summarization_Error_AnalysisUnsupported"))).source="User",[2,{details:p,code:"TextboxVisualNotSupported"}];e.label=12;case 12:return[2]}}))}))},f.prototype.validateMapAndFilledMap=function(a){var o;return __awaiter(this,void 0,y.Promise,(function(){var t,i,r,n;return __generator(this,(function(e){switch(e.label){case 0:return t="VisualContainer_MapAndFilledMap_NotEnabledTenantMessage",i="VisualContainer_MapAndFilledMap_NotEnabledValue",this.featureSwitchValuesLoader?[4,this.featureSwitchValuesLoader.ensureDynamicFeatureSwitchesLoaded()]:[3,2];case 1:e.sent()||(t=i="VisualContainer_MapAndFilledMap_NotEnabledNotSignedInMessage"),e.label=2;case 2:return r=this.featureSwitchService.featureSwitches.bingMapTenantSetting,n=null===(o=this.embedModeService)||void 0===o?void 0:o.isAppTokenEmbed(),n=this.featureSwitchService.featureSwitches.bingMapEnabled||n,r&&!n?((n=f.buildErrorDetails(this.localizationService.get(t),this.localizationService.get("VisualContainer_MapAndFilledMap_NotEnabledMessage"),this.localizationService.get(i))).source="User",[2,{details:n,code:a}]):[2]}}))}))},f.buildErrorDetails=function(e,t,i){return{message:e,displayableErrorInfo:[{errorInfoKey:t,errorInfoValue:i}]}},f.prototype.validateCustomVisual=function(c){return __awaiter(this,void 0,y.Promise,(function(){var t,i,r,n,a,o,s,l,u;return __generator(this,(function(e){switch(e.label){case 0:return(n=this.reportSettingsService&&this.reportSettingsService.areCustomVisualsDisabledByGroupPolicy(),a=this.reportSettingsService&&this.reportSettingsService.areUncertifiedVisualsDisabledByGroupPolicy(),o=this.featureSwitchService.featureSwitches.customVisualsTenantSwitch&&!this.featureSwitchService.featureSwitches.customVisualsTenantEnabled,this.featureSwitchService.featureSwitches.customVisuals)?[3,1]:(r=f.buildErrorDetails(this.localizationService.get("VisualContainer_CustomVisualDisabledMessage"),this.localizationService.get("VisualContainer_CustomVisualDisabledKey"),this.localizationService.get("VisualContainer_CustomVisualDisabledValue")),i="UnsupportedVisual",[3,3]);case 1:return l=(s=p).isCustomVisualTypeDisabled,u=[this.featureSwitchService,c,this.approvedResourceService,!0],[4,this.managedCustomVisualsService.isPublicManagedVisualByVisualType(c)];case 2:l.apply(s,u.concat([e.sent(),n,a]))?i=(n||o?((r=f.buildErrorDetails(this.localizationService.get("VisualContainer_CustomVisualDisabledByAdmin"),null,null)).errorType=1,r.helpLink="https://go.microsoft.com/fwlink/?linkid=2100000"):((r=f.buildErrorDetails(this.localizationService.get("VisualContainer_UncertifiedDisabledValue"),null,null)).errorType=1,r.helpLink="https://go.microsoft.com/fwlink/?linkid=2002010&clcid=0x409"),"CustomVisualsPermissionLocked"):p.isOrganizationalCustomVisual(c)&&!this.resourcePackageService.getPackage(c)?((r=f.buildErrorDetails(this.localizationService.get("CustomVisualsAreNotAvailable"),null,null)).errorType=1,r.helpLink="https://go.microsoft.com/fwlink/?LinkID=690865",i="CustomVisualAreNotAvailable"):this.resourcePackageService.getPackage(c)||(r=f.buildErrorDetails(this.localizationService.format("VisualContainer_ToSeeCustomVisual",[c]),null,null),i="CustomVisualNotFound"),e.label=3;case 3:return[2,t=i?{code:i,details:r}:t]}}))}))},f);function f(e,t,i,r,n,a,o,s,l,u,c,p,d){this.featureSwitchService=e,this.visualPlugin=t,this.scriptVisuals=i,this.reportSettingsService=r,this.localizationService=n,this.trustedVisual=a,this.approvedResourceService=o,this.resourcePackageService=s,this.explorationCapabilities=l,this.managedCustomVisualsService=u,this.explorationNavigation=c,this.featureSwitchValuesLoader=p,this.embedModeService=d}})((t=y.explore||(y.explore={})).services||(t.services={}))})(powerbi=powerbi||{}),(function(T){!(function(V){var w,x,P,F;function e(){}function A(e){e.exploration.sections.length;var t=e.sectionStatus.currentSectionNumber;return t<0&&0<e.exploration.sections.length&&(t=0),e.exploration.sections[t]}w=V.util||(V.util={}),x=T.ItemGroupingManager,P=T.explore.services.selectionUtils,F=T.visualHost.utils.ResourcePackageUtils,e.createUndoRedoHandler=function(p,d,h,g,v,m,o,f,y,C,s,S,t,b,E){var i=this;return{takeSnapshot:function(e){var t=A(p).contract.name,i=T.explore.services.selectionUtils.getSelectedCanvasItems(d),r=[];i&&(r=_.map(i,(function(e){return e.name})));var n={withVisibility:!0,withTransientPages:!0,withTransientFilters:!0,cache:s},i=v.getContext(),e=e&&null!=e.canvasLayout?e.canvasLayout:m&&m.getCurrentLayout(),a=o.serializeExploration(p.exploration.contract,n);return{contract:a,linguisticSchema:y.getSchema(p.exploration.contract.reportId),selectedSlide:t,selectedVisualsIndex:[],selectedCanvasItemsName:r,drillToDetailsState:i?i.toSnapshot(f):void 0,canvasLayout:e,getReferences:function(){var e=o.deserializeExploration(a,[],!0);return o.getReferencedStaticResources(e)}}},rollback:function(u){v.clearContext();var c=o.deserializeExploration(u.contract,[],!0),e=o.getReferencedStaticResources(c);t.restoreReferences(e).then((function(){return __awaiter(i,void 0,T.Promise,(function(){var t,i,r,n,a,o,s,l;return __generator(this,(function(e){switch(e.label){case 0:return g.featureSwitches.mobileAuthoringFormattingUI&&1===u.canvasLayout?[4,(function(i,r){return __awaiter(this,void 0,T.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return[4,i.get("mobileVcObjectsProxy")];case 1:return(t=e.sent()).isSupported()?[2,t.wrap(r)]:[2]}}))}))})(b,c)]:[3,2];case 1:c=e.sent(),e.label=2;case 2:for(r in l=f.getCurrentExploration(),t=F.getStaticResources(l.resourcePackages),i=F.getStaticResources(c.resourcePackages),t)n=t[r],i[r]||w.ResourcePackageUtils.ensureResourcePackages(c).push(_.clone(n)),F.findResourcePackage(c.resourcePackages,n.type,n.name).items=_.map(n.items,(function(e){return _.clone(e)}));return S.removeAllCustomVisuals(),a=_.filter(c.resourcePackages,(function(e){return F.isCustomVisualResourcePackage(e)})),s=a,g.featureSwitches.consumePublicCvsWithoutRps&&c.publicCustomVisuals&&(o=(o=E.createPublicResourcePackagesByName(c.publicCustomVisuals)).filter((function(t){return!a.some((function(e){return e.name===t.name}))})),s=s.concat(o)),S.ensurePlugins(s).finally((function(){C.publishToChannel(V.services.events.preparePersonalVisuals)})),s=V.SectionUtils.findSectionIndexForSectionName(c,u.selectedSlide),p.sectionStatus.currentSectionNumber=s,p.exploration=V.viewModels.ViewModelFactory.convertExploration(c,u.canvasLayout,s),p.exploration.contract.themeCollection.highContrastTheme=l.themeCollection.highContrastTheme,p.exploration.contract.themeCollection.highContrastTheme||delete p.exploration.contract.themeCollection.highContrastTheme,y.setSchema(c.reportId,u.linguisticSchema),s=f.getCurrentSection(),l=A(p),f.loadExploration(p.exploration.contract),f.goto(l.contract,{updateUrl:s.name!==l.contract.name}),h.updateCrossDrillOfSectionOperation(l.contract),setTimeout((function(){var e=p.exploration.exploreCanvas.visualContainerGroups,t=[],i=u.selectedCanvasItemsName;if(0<i.length){for(var r=0,n=i;r<n.length;r++){var a=n[r],a=x.find(a,e);a&&t.push(a.contract)}P.selectCanvasItems(t,d),u.drillToDetailsState&&v.setContext(T.drillDetailsModuleFactory().snapshotToContext(u.drillToDetailsState,f))}else d.clearSelection();m.changeFormFactor(u.canvasLayout,p)}),0),[2]}}))}))}))}}},w.ExploreUndoRedoHandlerUtility=e})(T.explore||(T.explore={}))})(powerbi=powerbi||{}),(function(e){var t,i,r,n;t=e.explore||(e.explore={}),i=t.viewModels||(t.viewModels={}),r=t.contracts.FilterType,n=e.data.RelativeFilterType,(i.RelativeFilterViewModelUtil||(i.RelativeFilterViewModelUtil={})).relativeFilterTypeToFilterType=function(e){switch(e){case n.Time:return r.RelativeTime;case n.Date:return r.RelativeDate;default:n.Unsupported;return null}}})(powerbi=powerbi||{}),(function(i){var e,n;function a(e,t){(t=void 0===t?!0:t)&&(e.stopPropagation(),e.preventDefault());e=e.dataTransfer.getData("pbi-tree-node");if(e){e=JSON.parse(e).fieldExpr;if(e)return i.data.services.SemanticQuerySerializer.deserializeExpr(e)}}function o(e,t){var i=e.getBoundingClientRect(),e=0;return i.top+i.height/2>t.pageY?e|=1:e|=4,i.left+i.width/2>t.pageX?e|=8:e|=2,e}function s(e,t){e&&!e.classList.contains(t)&&(e.classList.remove(n.Append.class),e.classList.remove(n.None.class),e.classList.remove(n.Prepend.class),e.classList.remove(n.Replace.class),e.classList.add(t))}function l(e){s(e.previousElementSibling,n.None.class),s(e,n.None.class),s(e.nextElementSibling,n.None.class)}e=(e=i.explore||(i.explore={})).helpers||(e.helpers={}),n=jsCommon.HighlightClasses,e.enableDropFromModernFieldList=function(i,r,t){i.addEventListener("drop",(function(e){var t=a(e);t&&r(e,t,o(i,e))})),i.addEventListener("dragover",(function(e){t&&(function(e,t){switch(t){case 0:s(e.previousElementSibling,n.None.class),s(e,n.None.class),s(e.nextElementSibling,n.None.class);break;case 2:s(e.previousElementSibling,n.Append.class),s(e,n.Prepend.class),s(e.nextElementSibling,n.None.class);break;case 3:s(e.previousElementSibling,n.None.class),s(e,n.Append.class),s(e.nextElementSibling,n.Prepend.class);break;case 1:s(e.previousElementSibling,n.None.class),s(e,n.Replace.class),s(e.nextElementSibling,n.None.class);break;default:l(e)}})(i,t(o(i,e))),e.preventDefault()})),t&&(i.addEventListener("dragleave",(function(){return l(i)})),i.addEventListener("dragexit",(function(){return l(i)})),i.addEventListener("dragend",(function(){return l(i)})))},e.getModernFieldListExpr=a})(powerbi=powerbi||{}),(function(e){((e=(e=e.explore||(e.explore={})).helpers||(e.helpers={})).VisualHostInsideZoneAdapter||(e.VisualHostInsideZoneAdapter={})).wrapHostServices=function(n,r){function a(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return r.run(e,n,t)}return{getLocalizedString:function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return n.getLocalizedString.apply(n,__spreadArray([e],t||[]))},tooltips:function(){return n.tooltips()},getSectionsMetadata$:function(){return n.getSectionsMetadata$()},getBookmarksMetadata$:function(){return n.getBookmarksMetadata$()},getSubSelectionService:function(){return n.getSubSelectionService()},alertScreenReader:function(e){return a(n.alertScreenReader,e)},alertWithDebounce:function(e,t){return a(n.alertWithDebounce,e,t)},requestFocus:function(e){return a(n.requestFocus,e)},onDragStart:function(e){return a(n.onDragStart,e)},getVisualLinkProperties:function(){return a(n.getVisualLinkProperties)},canSelect:function(e){return a(n.canSelect,e)},onSelecting:function(e){return a(n.onSelecting,e)},onSelect:function(e){return a(n.onSelect,e)},onSwitchFocusModeState:function(e){return a(n.onSwitchFocusModeState,e)},canExpandCollapse:function(e){return a(n.canExpandCollapse,e)},setNodeExpansionState:function(e){return a(n.setNodeExpansionState,e)},setLevelExpansionState:function(e){return a(n.setLevelExpansionState,e)},onContextMenu:function(e){return a(n.onContextMenu,e)},loadMoreData:function(){return a(n.loadMoreData)},loadWindow:function(e){return a(n.loadWindow,e)},setShouldDeferData:function(e){return a(n.setShouldDeferData,e)},persistProperties:function(e,t){return a(n.persistProperties,e,t)},onCustomSort:function(e){return a(n.onCustomSort,e)},getViewMode:function(){return a(n.getViewMode)},getEditMode:function(){return a(n.getEditMode)},setWarnings:function(e){return a(n.setWarnings,e)},setToolbar:function(e,t){return a(n.setToolbar,e,t)},shouldRetainSelection:function(){return a(n.shouldRetainSelection)},geocoder:function(){return a(n.geocoder)},geolocation:function(){return a(n.geolocation)},locale:function(){return a(n.locale)},promiseFactory:function(){return a(n.promiseFactory)},ignoreDefaultFilter:function(){return a(n.ignoreDefaultFilter)},getIdentityDisplayNames:function(e){return a(n.getIdentityDisplayNames,e)},setIdentityDisplayNames:function(e){return a(n.setIdentityDisplayNames,e)},dropdown:function(){return a(n.dropdown)},telemetry:function(){return a(n.telemetry)},authenticationService:function(){return a(n.authenticationService)},localStorageService:function(){return a(n.localStorageService)},eventService:function(){return a(n.eventService)},licenseManagerService:function(){return a(n.licenseManagerService)},loader:function(){return a(n.loader)},getUIComponentFactory:function(){return a(n.getUIComponentFactory)},applyJsonFilter:function(e,t,i,r){return a(n.applyJsonFilter,e,t,i,r)},applyIdentityFilter:function(e,t,i,r){return a(n.applyIdentityFilter,e,t,i,r)},launchUrl:function(e){return a(n.launchUrl,e)},instanceId:n.instanceId,refreshHostData:function(){return a(n.refreshHostData)},decompositionService:function(){return a(n.decompositionService)},getJSONFilter:function(e,t){return a(n.getJSONFilter,e,t)},visualCapabilitiesChanged:function(){return a(n.visualCapabilitiesChanged)},onHyperlinkClick:function(e,t){return a(n.onHyperlinkClick,e,t)},visualTimeSynchronization:function(){return a(n.visualTimeSynchronization)},setFilterExpressionMetadata:function(e){return a(n.setFilterExpressionMetadata,e)},getFilterExpressionMetadata:function(){return a(n.getFilterExpressionMetadata)},isVisualEnabled:function(){return a(n.isVisualEnabled)},dataMultiSelectMode:function(){return a(n.dataMultiSelectMode)},networkAvailability:function(){return a(n.networkAvailability)},downloadService:function(){return a(n.downloadService)},setAriaMetadata:function(e){return a(n.setAriaMetadata,e)},artifactService:function(){return a(n.artifactService)},onNotifyLicense:function(e){return a(n.onNotifyLicense,e)},onClearLicenseNotification:function(){return a(n.onClearLicenseNotification)},onNotifyFeatureBlocked:function(e){return a(n.onNotifyFeatureBlocked,e)},webAccessService:function(){return a(n.webAccessService)},drill:function(e){return a(n.drill,e)}}}})(powerbi=powerbi||{}),(function(t){!(function(p){var e,n,o;function d(e,t,i){var r=n.call(this)||this;return r.schema=e,r.displayName=t,r.metadata=i,r.dataPoints=[],r.isExclude=!1,r}e=p.services||(p.services={}),o=t.visuals.valueFormatter,n=t.data.DefaultSQExprVisitor,__extends(d,n),d.prototype.visitNot=function(e){this.isExclude=!0,e.arg.accept(this)},d.prototype.visitOr=function(e){e.left.accept(this),e.right.accept(this)},d.prototype.visitIn=function(e){var t=this;if(!_.isEmpty(e.values)){for(var i=[],r=e.args,n=_.map(r,(function(e){return t.displayName.getDisplayName(e,t.schema,null,null,null,{includeVariationSource:!0})})),a=0,o=e.values;a<o.length;a++){var s=o[a];r.length,s.length;var l=n,u=_.map(s,(function(e){return e.value})),c=p.FilterUtils.findValuesInFilterCache(r,s,this.metadata);c&&(l=_.map(c.columns,(function(e){return t.displayName.getDisplayName(e,t.schema,null,null,null,{includeVariationSource:!0})})),u=c.values),i.push({columns:r,values:s,text:d.getDataPointText(l,u)})}(e=this.dataPoints).push.apply(e,i||[])}},d.getDataPointText=function(e,t){var i="";e.length,e.length,t.length;for(var r=0;r<e.length;r++){var n=t[r],a=e[r];i+=o.format(n)+" ("+a+") + "}return i=i.slice(0,i.length-3)},e.IncludeExcludeSQExprVisitor=d})(t.explore||(t.explore={}))})(powerbi=powerbi||{}),(function(m){m.drillDetailsModuleFactory=function(){var c=m,e=(c.common.contracts,c.data),t=c.explore,p=(t.contracts,t.services.events),i=t.util,r=jsCommon.ArrayExtensions,n=m.explore.FilterUtils,a=m.explore.services.selectionUtils,o=t.SectionUtils,d=e.SQExpr,h=jsCommon.Utility,g=i.VisualContainerUtils,s=(l.prototype.toSnapshot=function(e){var t=this;if(e.getCurrentSection()===this.targetSection){var i=e.getCurrentExploration(),e=o.findSectionIndexForSection(i,this.sourceSection),i=o.findSectionIndexForSection(i,this.targetSection);return{sourceSectionIndex:e,sourceVisualIndex:_.findIndex(this.sourceSection.visualContainers,(function(e){return e===t.sourceVisualContainer})),targetSectionIndex:i,targetVisualIndex:_.findIndex(this.targetSection.visualContainers,(function(e){return e===t.targetVisualContainer}))}}},l.fromSnapshot=function(e,t){if(e){var i=t.getCurrentExploration(),r=i.sections[e.sourceSectionIndex],n=r.visualContainers[e.sourceVisualIndex],i=i.sections[e.targetSectionIndex],e=i.visualContainers[e.targetVisualIndex];return t.getCurrentSection(),new l(r,n,i,e,0)}},l);function l(e,t,i,r,n){this.sourceSection=e,this.sourceVisualContainer=t,this.targetSection=i,this.targetVisualContainer=r,this.navigationState=n}var v=(u.prototype.drillToDetails=function(i,r,e){var n=this;if(!_.isEmpty(i)){var t=_.head(i);if(t&&!_.isEmpty(t.metadata)){var a=g.getVisualQuery(r);if(a&&a.defn){if(_.isEmpty(t.dataMap)){if(!a.projections)return;var o,s=g.getDataRolesForVisual(r,this.visualPluginService),l=_(s).filter((function(e){return e.kind!==c.VisualDataRoleKind.Measure})).map((function(e){return e.name})).value();for(o in a.projections)if(!_.isEmpty(a.projections[o])&&_.includes(l,o))return}var u=a.defn.select().withName(_.head(t.metadata));u&&d.isAggregation(u.expr)&&this.conceptualSchemaProxy.get(e).then((function(e){var t=n.visualAuthoringOperations.drillToDetails(h.generateGuid(),e,[u.expr],i,r);t&&(n.addCrossFilters(r,n.explorationNavigationService.getCurrentSection(),t,!1,e),n.drillToDetailsCore(i,r,t))}),(function(){return _.noop}))}}}},u.prototype.generateDetailsTable=function(e,t,i,r){e=this.mockVisualContainer(e),r=this.visualAuthoringOperations.drillToDetails(h.generateGuid(),t,i,null,e,r);if(r)return r.config.singleVisual},u.prototype.clear=function(){var e;this.drillToDetailsContext&&(this.drillToDetailsContext.navigationState,this.drillToDetailsContext.navigationState=1,e=o.findSectionIndexForSection(this.explorationNavigationService.getCurrentExploration(),this.drillToDetailsContext.sourceSection),this.eventBridge.publishToChannel(p.switchSection,{index:e}))},u.prototype.getContext=function(){return this.drillToDetailsContext},u.prototype.setContext=function(e){this.drillToDetailsContext,e.navigationState,this.drillToDetailsContext=e},u.prototype.clearContext=function(){this.drillToDetailsContext=null},u.prototype.hasContext=function(){return!!this.drillToDetailsContext},u.prototype.getDetailsTableTargetMeasures=function(e){var e=this.mockVisualContainer(e),t=g.getVisualQuery(e);if(t&&t.defn){e=g.getDataRolesForVisual(e,this.visualPluginService);if(!_.isEmpty(e)){for(var i=[],r=0,n=_(e).filter((function(e){return(e.kind===c.VisualDataRoleKind.Measure||e.kind===c.VisualDataRoleKind.GroupingOrMeasure)&&0!==e.joinPredicate})).map((function(e){return e.name})).value();r<n.length;r++){var a=n[r],a=t.projections[a];if(!_.isEmpty(a))for(var o=0,s=a.all();o<s.length;o++){var l=s[o],l=t.defn.select().withName(l.queryRef);if(l&&d.isAggregation(l.expr))return[l.expr];l&&d.isMeasure(l.expr)&&i.push(l.expr)}}return i}}},u.prototype.mockVisualContainer=function(e){e={name:h.generateGuid(),config:{singleVisual:e},layouts:r.createWithId(),filters:[]};return e.layouts.push({id:0,position:{x:0,y:0,width:0,height:0}}),e},u.prototype.onSectionChanged=function(){var e=this;if(this.drillToDetailsContext){this.explorationNavigationService.getCurrentSection();switch(this.drillToDetailsContext.navigationState){case 0:this.drillToDetailsContext.targetSection,window.setTimeout((function(){a.selectCanvasItem(e.drillToDetailsContext.targetVisualContainer,e.selectionService),e.visibility.set(e.drillToDetailsContext.targetVisualContainer,1)}),0);break;case 1:this.drillToDetailsContext.sourceSection;var t=this.explorationNavigationService.getCurrentExploration(),i=o.findSectionIndexForSection(t,this.drillToDetailsContext.targetSection),r=o.findSectionIndexForSection(t,this.drillToDetailsContext.sourceSection),n=this.drillToDetailsContext.sourceVisualContainer;this.drillToDetailsContext=null,this.eventBridge.publishToChannel(p.deleteSection,{targetSectionIndex:i}),window.setTimeout((function(){o.findSectionIndexForSection(e.explorationNavigationService.getCurrentExploration(),e.explorationNavigationService.getCurrentSection())===r&&a.selectCanvasItem(n,e.selectionService),e.undoRedo.clear()}),0)}}},u.prototype.onPopOutModeChanged=function(){!this.drillToDetailsContext||this.explorationNavigationService.getCurrentSection()!==this.drillToDetailsContext.sourceSection&&(this.drillToDetailsContext.targetSection,this.visibility.get()!==this.drillToDetailsContext.targetVisualContainer&&this.clear())},u.prototype.drillToDetailsCore=function(e,t,i){var r,n,a=this.explorationNavigationService.getCurrentSection();a&&(r=this.explorationNavigationService.getAllSections(),n=this.explorationSerializer.serializePage(a,1),n={name:"Drill to Details",displayName:"Drill to Details",filters:(n=this.explorationSerializer.deserializePage(n)).filters,size:n.size,visualContainers:[i],visualContainerGroups:[i],transient:!0},o.setUniqueNewSectionCanvasItemNames(n,r),this.drillToDetailsContext=new s(a,t,n,i,0),this.eventBridge.publishToChannel(p.insertSection,n))},u.prototype.addCrossFilters=function(e,t,i,r,n){e=this.filterGenerator.getVisualContainerCrossFilters(t,e,n);if(e.dataFilters)for(var a=0,o=e.dataFilters;a<o.length;a++){var s=o[a];this.addVisualFilters(i,s,n,!1)}if(r){e.highlightFilters;for(var l=0,u=e.highlightFilters;l<u.length;l++){s=u[l];this.addVisualFilters(i,s,n,!1)}}},u.prototype.addVisualFilters=function(e,t,i,r){t&&t.filter&&(t=n.convertFilterData(t,e.filters,0),n.add(e,t))},u);function u(e,t,i,r,n,a,o,s,l,u){var c=this;this.conceptualSchemaProxy=e,this.visualAuthoringOperations=t,this.undoRedo=i,this.selectionService=r,this.explorationNavigationService=n,this.explorationSerializer=a,this.visibility=o,this.eventBridge=s,this.filterGenerator=l,this.visualPluginService=u,this.eventBridge.createChannelSubscriptionManager().subscribe(p.canvasChanged,(function(){return c.onSectionChanged()})).subscribe(p.visibilityChanged,(function(){return c.onPopOutModeChanged()})).subscribe(p.explorationUnloaded,(function(e,t){return c.clearContext()}))}return{create:function(e,t,i,r,n,a,o,s,l,u){return new v(e,u,r,n,a,t,o,s,l,i)},createContext:function(e,t,i,r,n){return new s(e,t,i,r,n)},snapshotToContext:s.fromSnapshot}}})(powerbi=powerbi||{}),(function(d){var h;(function(i){var t=d.common.utils.IdUtility,n=contextActivity.isOpenReportActivity,r={updateUrl:!0,action:i.SectionNavigationAction.Unknown};i.createExplorationNavigationService=function(e,t,i,r,n,a,o,s){return new l(e,t,i,r,n,a,o,s)};var l=(e.prototype.registerExplorationViewModel=function(e){this.getViewModel=e},e.prototype.updateActiveSection=function(o){var s,l,e,t,i,r,u=this,c=this.getViewModel(),p=c.exploration.contract;0<=o.targetSectionIndex&&(o.targetSectionIndex,p.sections.length),!o.forceUpdate&&p.activeSectionIndex===o.targetSectionIndex||(s=null==o.clearSelection||o.clearSelection,l=-1<o.targetSectionIndex&&o.targetSectionIndex<p.sections.length,e=(r=this.exploration.sections[o.targetSectionIndex]).objectId,t=r.displayName,this.contextActivityService.upsertExplorationProperties({reportPageId:e,reportPageName:t}),o.parentContextActivity&&o.parentContextActivity.isRunning()&&(o.parentContextActivity.setProperty("reportPageId",e),o.parentContextActivity.setProperty("reportPageName",t)),this.changeReportPageActivity&&this.changeReportPageActivity.isRunning()&&this.changeReportPageActivity.cancel(),this.changeReportPageActivity&&this.changeReportPageActivity.isRunning()||(t={name:"Change Report Page"},o.parentContextActivity?n(o.parentContextActivity)&&o.parentContextActivity.isRunning()?this.changeReportPageActivity=o.parentContextActivity.createChildActivity(t):this.changeReportPageActivity=o.parentContextActivity:this.changeReportPageActivity=this.contextActivityService.createActivity(t)),i=h.util.VisualContainerUtils.getVisualTypesAndCountsFromSection(r),r=Object.keys(i).reduce((function(e,t){return"__hidden"!==t?e+i[t]:e}),0),this.changeReportPageActivity.isRunning()&&(this.changeReportPageActivity.setProperty("visualTypesAndCount",JSON.stringify(i)),this.changeReportPageActivity.setProperty("totalVisibleVisualCount",r)),o.parentContextActivity&&o.parentContextActivity.isRunning()&&(o.parentContextActivity.setProperty("visualTypesAndCount",JSON.stringify(i)),o.parentContextActivity.setProperty("totalVisibleVisualCount",r)),this.explorationActivity.changeSection((function(e){var t=u.getCurrentSection();if(o.suppressHistory||t&&!t.transient&&u.history.push({name:t.name}),l){u.selection&&!1!==s&&!_.isEmpty(u.selection.getSelectedElements())&&u.selection.clearSelection();var i=c.exploration.sections;if(!_.isEmpty(i))for(var r=i.length-1;0<=r;--r)i[r].selected=r===o.targetSectionIndex;c.sectionStatus.currentSectionNumber=o.targetSectionIndex;var n=p.sections[o.targetSectionIndex],a=null!==o.canvasLayout&&void 0!==o.canvasLayout?o.canvasLayout:u.formFactor.getCurrentLayout();c.exploration.exploreCanvas=h.viewModels.ViewModelFactory.convertSectionToExploreCanvas(p,n,a,o.currentZone),(null==o.clearCrossFilter||o.clearCrossFilter)&&t&&t.crossFilterSource&&(t.crossFilterSource.highlight=void 0),n&&((t=e.event.info).width=n.size.width,t.height=n.size.height,t.displayOption=n.size.displayOption),u.goto(n,{action:o.navigationAction,newReport:o.newReport,parentActivity:e,parentContextActivity:u.changeReportPageActivity,isInitialUpdateSection:o.isInitialUpdateSection})}}),(function(){return u.telemetryService.startChildActivity(o.parentActivity&&o.parentActivity.event,d.telemetry.EXUpdateActiveSection,{targetSectionIndex:o.targetSectionIndex,forceUpdate:o.forceUpdate,suppressHistory:o.suppressHistory,canvasLayout:o.canvasLayout,clearSelection:s,isCancelled:!1,sectionGuid:l&&p.sections[o.targetSectionIndex].objectId})}),this.changeReportPageActivity))},e.prototype.updateExplorationActiveSectionIndex=function(e){e.exploration,e.section;var t,i,r,n=e.exploration,a=d.explore.SectionUtils.findSectionIndexForSectionName(n,e.section);null!=a&&n&&n.sections&&n.sections[a].transient||(n.activeSectionIndex=a,e.suppressTelemetry||(t=(r=n.sections[a])?r.objectId:void 0,i=n.report?n.report.originalReportObjectId:void 0,r=n.report&&n.report.ownerInfo?n.report.ownerInfo.groupObjectId:void 0,this.telemetryService.logChildEvent(e.parentActivity&&e.parentActivity.event,d.telemetry.ExploreHostChangeReportPage,{reportId:n.reportId,reportGuid:e.reportGUID,sectionIndex:a,sectionGuid:t,groupObjectId:e.groupObjectId,isReadonlyGroup:e.isReadonlyGroup,permissions:e.reportPermissions,scrubUserInfo:e.scrubUserInfo,newReport:e.newReport,originalReportGuid:i,originalGroupObjectId:r})))},e.prototype.goto=function(e,t){this.updateSectionViewSession(),t&&t.parentContextActivity&&this.telemetryData&&(t.parentContextActivity.setProperty("reportPageViewSessionId",this.telemetryData.exsid),t.parentContextActivity.setProperty("isInitialUpdateSection",!!t.isInitialUpdateSection)),t=t?_.merge({},r,t):r,this.currentSection=e,this.currentSectionSubject.next(e),this.raiseEvent(),t.updateUrl&&(t={name:e.name,displayName:e.displayName,action:t.action,newReport:t.newReport,parentActivity:t.parentActivity,parentContextActivity:t.parentContextActivity,isInitialUpdateSection:t.isInitialUpdateSection},this.eventBridge.publishToChannel(i.events.sectionChanged,t))},e.prototype.back=function(e){var t,i;_.isEmpty(this.history)||(t=this.history.pop(),(i=_.findIndex(this.exploration.sections,(function(e){return e.name===t.name})))<0||this.updateActiveSection({targetSectionIndex:i,forceUpdate:!1,suppressHistory:!0,parentActivity:e}))},e.prototype.loadExploration=function(e,t){this.telemetryData=void 0,this.exploration=e,this.currentZone=e&&t,e&&e.sections&&0<=e.activeSectionIndex&&(t=e.sections[e.activeSectionIndex],this.currentSection=t,this.currentSectionSubject.next(t)),this.emitUpdatedSections(),this.raiseExplorationLoadedEvent(e)},e.prototype.startExplorationSession=function(e){e&&void 0===e.exid&&(e.exid=t.generateShortId(5)),this.telemetryData=e},e.prototype.updateExplorationTelemetryData=function(e){this.telemetryData||(this.telemetryData={}),_.assign(this.telemetryData,e)},e.prototype.getExplorationTelemetryData=function(){return this.telemetryData},e.prototype.getCurrentSection=function(){if(this.currentSection)return this.currentSection;var e=this.exploration;return e&&_.inRange(e.activeSectionIndex,0,e.sections.length)?e.sections[e.activeSectionIndex]:void 0},e.prototype.getSectionByName=function(t){return _.find(this.exploration.sections,(function(e){return e.name===t}))},e.prototype.getAllSections=function(){return this.exploration&&this.exploration.sections},e.prototype.getAllVisualContainers=function(i){return this.exploration&&this.exploration.sections?i?this.exploration.sections.reduce((function(e,t){return e.concat(t.visualContainers.filter((function(e){return e.config.singleVisual.visualType===i})))}),[]):this.exploration.sections.reduce((function(e,t){return e.concat(t.visualContainers)}),[]):[]},e.prototype.getCurrentExploration=function(){return this.exploration},e.prototype.getCurrentExploreCanvas=function(){return this.getViewModel,this.getViewModel().exploration.exploreCanvas},e.prototype.showExplorationMask=function(){this.getViewModel,this.getViewModel().showMask=!0},e.prototype.hideExplorationMask=function(){this.getViewModel,this.getViewModel().showMask=!1},e.prototype.getCurrentZone=function(){return this.currentZone},e.prototype.emitUpdatedSections=function(){this.sectionsSubject.next(this.getAllSections())},e.prototype.raiseEvent=function(){this.eventBridge.publishToChannel(i.events.canvasChanged)},e.prototype.raiseExplorationLoadedEvent=function(e){this.eventBridge.publishToChannel(i.events.explorationLoaded,e)},e.prototype.updateSectionViewSession=function(){var e;this.telemetryData&&(e=t.generateShortId(5),this.telemetryData.exsid=e,this.contextActivityService.upsertExplorationProperties({reportPageViewSessionId:e}))},e);function e(e,t,i,r,n,a,o,s){this.contextActivityService=e,this.eventBridge=t,this.selection=i,this.formFactor=r,this.telemetryService=n,this.explorationActivity=a,this.sectionsSubject=o,this.currentSectionSubject=s,this.history=[],this.sections$=o.asObservable(),this.currentSection$=s.asObservable(),a.registerExplorationNavigationService(this)}})((h=d.explore||(d.explore={})).services||(h.services={}))})(powerbi=powerbi||{}),(function(W){var e;(function(e){var n=W.visuals.PivotTableOptions,s=W.visualHost.utils.ResourcePackageUtils,o=W.visuals.TableExOptions,a=W.visualHost.visualPluginServiceHelpers.VisualPluginStorage,l=W.visuals.createActionButton,u=W.visuals.createPivotTable,c=W.visuals.createTableEx,p=W.visuals.createMatrix,d=W.visuals.createTable,h=W.visuals.createAccessibleTable,g=W.visuals.createCard,v=W.visuals.createGauge,m=W.visuals.createDonutChart,f=W.visuals.createMultiRowCard,y=W.visuals.createFunnelChart,C=W.visuals.createMap,S=W.visuals.createAzureMap,b=W.visuals.createShapeMap,E=W.visuals.createTreemap,V=W.visuals.createSlicer,w=W.visuals.createTextbox,x=W.visuals.createScriptVisual,P=W.visuals.createKpi,F=W.visuals.createDecompositionTree,A=W.visuals.createShapeVisual,T=W.visuals.createSunburst,D=W.visuals.createCartesianChart,I=W.visuals.createWebColumnChartAnimator,M=W.visuals.createCartesianChartBehaviorFactory,O=W.visuals.createColumnChartWebBehaviorFactory,N=W.visuals.createDataDotChartWebBehaviorFactory,R=W.visuals.createLineChartWebBehaviorFactory,L=W.visuals.createScatterChartWebBehaviorFactory,B=W.visuals.createWaterfallChartWebBehaviorFactory,k=W.visuals.createAzureMapBehavior,X=W.visuals.createShapeMapBehavior,G=W.visuals.createTreeMapWebAnimator,H=W.visuals.createTreeMapWebBehavior,U=W.visuals.createSunburstBehavior;e.createExplorationVisualPluginService=function(e,t,i,r,n){return new j(e,i,t,new z(e,r,n))};var j=(t.prototype.getConvertibleCoreVisualTypeNames=function(e){var t=[W.visuals.plugins.barChart.name,W.visuals.plugins.columnChart.name,W.visuals.plugins.clusteredBarChart.name,W.visuals.plugins.clusteredColumnChart.name,W.visuals.plugins.hundredPercentStackedBarChart.name,W.visuals.plugins.hundredPercentStackedColumnChart.name,W.visuals.plugins.lineChart.name,W.visuals.plugins.areaChart.name,W.visuals.plugins.stackedAreaChart.name,W.visuals.plugins.lineStackedColumnComboChart.name,W.visuals.plugins.lineClusteredColumnComboChart.name,W.visuals.plugins.ribbonChart.name];e&&e.dataDotChartEnabled&&t.push.apply(t,[W.visuals.plugins.dataDotClusteredColumnComboChart.name,W.visuals.plugins.dataDotStackedColumnComboChart.name]),e&&e.histogram&&t.push(W.visuals.plugins.histogram.name),t.push.apply(t,[W.visuals.plugins.waterfallChart.name,W.visuals.plugins.funnel.name,W.visuals.plugins.scatterChart.name,W.visuals.plugins.pieChart.name,W.visuals.plugins.donutChart.name]),e&&e.sunburstVisualEnabled&&t.push(W.visuals.plugins.sunburst.name),t.push(W.visuals.plugins.treemap.name),t.push.apply(t,[W.visuals.plugins.map.name,W.visuals.plugins.filledMap.name]),e&&e.shapeMapVisualEnabled&&t.push(W.visuals.plugins.shapeMap.name),e&&e.azureMapVisual&&(e.azureMapEnabled||e.azureMapPreviewEnabled)&&t.push(W.visuals.plugins.azureMap.name),t.push.apply(t,[W.visuals.plugins.gauge.name,W.visuals.plugins.card.name,W.visuals.plugins.multiRowCard.name,W.visuals.plugins.kpi.name,W.visuals.plugins.slicer.name]),e&&e.pivotTableVisualEnabled?(t.push(W.visuals.plugins.tableEx.name),t.push(W.visuals.plugins.pivotTable.name)):(t.push(W.visuals.plugins.table.name),t.push(W.visuals.plugins.matrix.name)),e&&e.scriptVisualEnabled&&e.scriptVisualAuthoringEnabled&&(t.push(W.visuals.plugins.scriptVisual.name),t.push(W.visuals.plugins.pythonVisual.name)),e&&e.keyDrivers&&t.push(W.visuals.plugins.keyDriversVisual.name),t.push(W.visuals.plugins.decompositionTreeVisual.name),e&&e.qnaVisual&&t.push(W.visuals.plugins.qnaVisual.name),e&&e.daxTransformEnabled&&t.push(W.visuals.plugins.textbox.name),e&&e.scorecardVisual&&t.push(W.visuals.plugins.scorecard.name),e&&e.rdlNativeVisual&&t.push(W.visuals.plugins.rdlVisual.name),W.localStorageService.getData("VISUAL_DEVELOPER_MODE_ENABLED")&&t.push(W.visuals.plugins.debugVisual.name);e=this.promiseFactory.defer();return e.resolve(t),e.promise},t.prototype.getVisuals=function(){return this.storage.getLoadedPlugins()},t.prototype.getConvertibleVisuals=function(){for(var t=this,e=[],i=0,r=this.globalConvertibleVisualTypes;i<r.length;i++){var n=r[i];this.storage.hasPlugin(n)&&!_.includes(e,n)&&e.push(n)}for(var a=0,o=this.trustedConvertibleVisualTypes;a<o.length;a++){var s=o[a];this.storage.hasPlugin(s)&&!_.includes(e,s)&&e.push(s)}for(var l=0,u=this.customConvertibleVisualTypes;l<u.length;l++){var c=u[l];this.storage.hasPlugin(c)&&!_.includes(e,c)&&e.push(c)}return e.map((function(e){return t.storage.getLoadedPlugin(e)}))},t.prototype.getConvertibleVisualsAsync=function(){return __awaiter(this,void 0,W.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.ensureBuiltInPlugins()];case 1:return e.sent(),[2,this.getConvertibleVisuals()]}}))}))},t.prototype.ensureBuiltInPlugins=function(){return this.initBuiltInPlugins},t.prototype.ensureTrustedVisualPlugins=function(e){a.ensureTrustedVisualPlugins(this.storage,e);for(var t=0,i=e;t<i.length;t++){var r=i[t];this.addTrustedConvertibleVisualType(r.name)}},t.prototype.ensurePlugins=function(e,i){var r=this;this.promiseFactory;var n=[];if(e&&e.length)for(var a=this,t=0,o=e;t<o.length;t++)!(function(e){var t;s.isCustomVisualResourcePackage(e)&&(t=a.ensurePlugin(e,i).then((function(){return r.addCustomConvertibleVisualType(e.name)})),n.push(t))})(o[t]);return this.promiseFactory.allSettled(n)},t.prototype.ensurePlugin=function(e,t){return a.ensurePlugin(this.storage,this.promiseFactory,this.resourceLoader,e,t)},t.prototype.addTrustedConvertibleVisualType=function(e){this.trustedConvertibleVisualTypes.indexOf(e)<0&&this.trustedConvertibleVisualTypes.push(e)},t.prototype.addCustomConvertibleVisualType=function(e){this.customConvertibleVisualTypes.indexOf(e)<0&&this.customConvertibleVisualTypes.push(e)},t.prototype.capabilities=function(e){e=this.getPlugin(e);return e?e.capabilities:void 0},t.prototype.removeAllCustomVisuals=function(){for(var e=0,t=this.customConvertibleVisualTypes;e<t.length;e++){var i=t[e];this.storage.unloadPlugin(i)}this.customConvertibleVisualTypes=[]},t.prototype.removePlugin=function(t){this.getPlugin(t)&&(this.storage.unloadPlugin(t),_.remove(this.customConvertibleVisualTypes,(function(e){return e===t})))},t.prototype.getTelemetryHostInformation=function(){return{name:"Exploration"}},t.prototype.isCustomVisual=function(e){return W.visualHost.utils.isCustomVisual(this.getPlugin(e),e)},t.prototype.isScriptVisual=function(e){return W.visualHost.utils.isScriptVisual(this.getPlugin(e))},t.prototype.isScriptVisualQueryable=function(e){return W.visualHost.utils.isScriptVisualQueryable(e,this.asyncFeatureSwitchService.featureSwitches)},t.prototype.isLightWeightRenderingVisual=function(e){return W.visualHost.utils.isLightWeightRenderingVisual(this.getPlugin(e))},t.prototype.getInteractivityOptions=function(){return{overflow:"hidden",isVisualInteractive:!0}},t.prototype.getCustomizeConvertTo=function(e,t){t=this.getPlugin(t);return t.getCustomizeConvertTo?t.getCustomizeConvertTo(e):void 0},t.prototype.loadPluginByNameIfAny=function(e){this.getPlugin(e)||(this.storage.hasPlugin(e)?this.storage.loadPlugin(e):W.visuals.plugins[e]&&this.storage.loadPlugin(e,W.visuals.plugins[e]))},t.prototype.getPlugin=function(e){return this.storage.getLoadedPlugin(e)},t.prototype.getStorage=function(){return this.storage},t);function t(t,e,i,r){var n=this;this.asyncFeatureSwitchService=t,this.resourceLoader=e,this.promiseFactory=i,this.resourceLoader=e,this.promiseFactory=i,this.trustedConvertibleVisualTypes=[],this.customConvertibleVisualTypes=[],this.globalConvertibleVisualTypes=[],this.storage=new a,this.initBuiltInPlugins=this.asyncFeatureSwitchService.getFeatureSwitches().then((function(e){return r=r||new z(t),n.getConvertibleCoreVisualTypeNames(e)})).then((function(e){for(var t in n.globalConvertibleVisualTypes=e,W.visuals.plugins)n.storage.loadPlugin(t,r.getPlugin(t))}))}e.ExplorationVisualPluginService=j;var z=(i.prototype.getPlugin=function(e){var t=this,a=this.featureSwitchService.featureSwitches?_.clone(this.featureSwitchService.featureSwitches):{};switch(e){case W.visuals.plugins.barChart.name:return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.barChart,(function(e){e=e.module;return e.createCartesianChart({chartType:6,isScrollable:!0,dataPointLassoSelect:!0,animator:e.createWebColumnChartAnimator(),tooltipsEnabled:!0,behaviorFactory:e.createCartesianChartBehaviorFactory([e.createColumnChartWebBehaviorFactory()],a),featureSwitches:a})}),a,D?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,r;return __generator(this,(function(e){switch(e.label){case 0:return t=D,r={chartType:6,isScrollable:!0,dataPointLassoSelect:!0},[4,W.visuals.createWebColumnChartAnimator()];case 1:return r.animator=e.sent(),r.tooltipsEnabled=!0,i=M,[4,W.visuals.createColumnChartWebBehaviorFactory()];case 2:return[4,i.apply(void 0,[[e.sent()],a])];case 3:return[2,t.apply(void 0,[(r.behaviorFactory=e.sent(),r.featureSwitches=a,r)])]}}))}))}:void 0);case W.visuals.plugins.card.name:return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.card,(function(e){return e.module.createCard({isScrollable:!0,animator:new W.visuals.BaseAnimator,tooltipsEnabled:!0,interactivityEnabled:!0,featureSwitches:a})}),a,g?function(){return g({isScrollable:!0,animator:new W.visuals.BaseAnimator,tooltipsEnabled:!0,interactivityEnabled:!0,featureSwitches:a})}:void 0);case W.visuals.plugins.clusteredBarChart.name:return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.clusteredBarChart,(function(e){e=e.module;return e.createCartesianChart({chartType:5,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:e.createWebColumnChartAnimator(),behaviorFactory:e.createCartesianChartBehaviorFactory([e.createColumnChartWebBehaviorFactory()],a),featureSwitches:a})}),a,D?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,r;return __generator(this,(function(e){switch(e.label){case 0:return t=D,r={chartType:5,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0},[4,I()];case 1:return r.animator=e.sent(),i=M,[4,O()];case 2:return[4,i.apply(void 0,[[e.sent()],a])];case 3:return[2,t.apply(void 0,[(r.behaviorFactory=e.sent(),r.featureSwitches=a,r)])]}}))}))}:void 0);case W.visuals.plugins.clusteredColumnChart.name:return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.clusteredColumnChart,(function(e){e=e.module;return e.createCartesianChart({chartType:3,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:e.createWebColumnChartAnimator(),behaviorFactory:e.createCartesianChartBehaviorFactory([e.createColumnChartWebBehaviorFactory()],a),featureSwitches:a})}),a,D?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,r;return __generator(this,(function(e){switch(e.label){case 0:return t=D,r={chartType:3,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0},[4,W.visuals.createWebColumnChartAnimator()];case 1:return r.animator=e.sent(),i=M,[4,O()];case 2:return[4,i.apply(void 0,[[e.sent()],a])];case 3:return[2,t.apply(void 0,[(r.behaviorFactory=e.sent(),r.featureSwitches=a,r)])]}}))}))}:void 0);case W.visuals.plugins.columnChart.name:return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.columnChart,(function(e){e=e.module;return e.createCartesianChart({chartType:4,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:e.createWebColumnChartAnimator(),behaviorFactory:e.createCartesianChartBehaviorFactory([e.createColumnChartWebBehaviorFactory()],a),featureSwitches:a})}),a,D?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,r;return __generator(this,(function(e){switch(e.label){case 0:return t=D,r={chartType:4,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0},[4,I()];case 1:return r.animator=e.sent(),i=M,[4,O()];case 2:return[4,i.apply(void 0,[[e.sent()],a])];case 3:return[2,t.apply(void 0,[(r.behaviorFactory=e.sent(),r.featureSwitches=a,r)])]}}))}))}:void 0);case W.visuals.plugins.dataDotClusteredColumnComboChart.name:return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.dataDotClusteredColumnComboChart,(function(e){e=e.module;return e.createCartesianChart({chartType:16,isScrollable:!0,tooltipsEnabled:!0,animator:e.createWebColumnChartAnimator(),behaviorFactory:e.createCartesianChartBehaviorFactory([e.createColumnChartWebBehaviorFactory(),e.createDataDotChartWebBehaviorFactory()],a),featureSwitches:a})}),a,D?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,r,n;return __generator(this,(function(e){switch(e.label){case 0:return t=D,n={chartType:16,isScrollable:!0,tooltipsEnabled:!0},[4,I()];case 1:return n.animator=e.sent(),i=M,[4,O()];case 2:return r=[e.sent()],[4,N()];case 3:return[4,i.apply(void 0,[r.concat([e.sent()]),a])];case 4:return[2,t.apply(void 0,[(n.behaviorFactory=e.sent(),n.featureSwitches=a,n)])]}}))}))}:void 0);case W.visuals.plugins.dataDotStackedColumnComboChart.name:return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.dataDotStackedColumnComboChart,(function(e){e=e.module;return e.createCartesianChart({chartType:17,isScrollable:!0,tooltipsEnabled:!0,animator:e.createWebColumnChartAnimator(),behaviorFactory:e.createCartesianChartBehaviorFactory([e.createColumnChartWebBehaviorFactory(),e.createDataDotChartWebBehaviorFactory()],a),featureSwitches:a})}),a,D?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,r,n;return __generator(this,(function(e){switch(e.label){case 0:return t=D,n={chartType:17,isScrollable:!0,tooltipsEnabled:!0},[4,I()];case 1:return n.animator=e.sent(),i=M,[4,O()];case 2:return r=[e.sent()],[4,N()];case 3:return[4,i.apply(void 0,[r.concat([e.sent()]),a])];case 4:return[2,t.apply(void 0,[(n.behaviorFactory=e.sent(),n.featureSwitches=a,n)])]}}))}))}:void 0);case W.visuals.plugins.donutChart.name:return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.donutChart,(function(){return new W.visuals.DonutChart({animator:new W.visuals.WebDonutChartAnimator,isScrollable:!0,tooltipsEnabled:!0,behavior:new W.visuals.DonutChartWebBehavior})}),a,m?function(){return m({animator:new W.visuals.WebDonutChartAnimator,isScrollable:!0,tooltipsEnabled:!0,behavior:new W.visuals.DonutChartWebBehavior})}:void 0);case W.visuals.plugins.funnel.name:return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.funnel,(function(){return new W.visuals.FunnelChart({animator:new W.visuals.WebFunnelAnimator,behavior:new W.visuals.FunnelWebBehavior,tooltipsEnabled:!0})}),a,y?function(){return y({animator:new W.visuals.WebFunnelAnimator,behavior:new W.visuals.FunnelWebBehavior,tooltipsEnabled:!0})}:void 0);case W.visuals.plugins.gauge.name:return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.gauge,(function(e){return e.module.createGauge({animator:new W.visuals.BaseAnimator,tooltipsEnabled:!0,behavior:new W.visuals.GaugeBehavior},a)}),a,v?function(){return v({animator:new W.visuals.BaseAnimator,tooltipsEnabled:!0,behavior:new W.visuals.GaugeBehavior})}:void 0);case W.visuals.plugins.kpi.name:return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.kpi,(function(){return new W.visuals.KPIStatusWithHistory({interactivityEnabled:!0},a)}),a,P?function(){return P({interactivityEnabled:!0})}:void 0);case W.visuals.plugins.hundredPercentStackedBarChart.name:return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.hundredPercentStackedBarChart,(function(e){e=e.module;return e.createCartesianChart({chartType:7,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:e.createWebColumnChartAnimator(),behaviorFactory:e.createCartesianChartBehaviorFactory([e.createColumnChartWebBehaviorFactory()],a),featureSwitches:a})}),a,D?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,r;return __generator(this,(function(e){switch(e.label){case 0:return t=D,r={chartType:7,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0},[4,W.visuals.createWebColumnChartAnimator()];case 1:return r.animator=e.sent(),i=M,[4,W.visuals.createColumnChartWebBehaviorFactory()];case 2:return[4,i.apply(void 0,[[e.sent()],a])];case 3:return[2,t.apply(void 0,[(r.behaviorFactory=e.sent(),r.featureSwitches=a,r)])]}}))}))}:void 0);case W.visuals.plugins.hundredPercentStackedColumnChart.name:return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.hundredPercentStackedColumnChart,(function(e){e=e.module;return e.createCartesianChart({chartType:8,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:e.createWebColumnChartAnimator(),behaviorFactory:e.createCartesianChartBehaviorFactory([e.createColumnChartWebBehaviorFactory()],a),featureSwitches:a})}),a,D?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,r;return __generator(this,(function(e){switch(e.label){case 0:return t=D,r={chartType:8,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0},[4,W.visuals.createWebColumnChartAnimator()];case 1:return r.animator=e.sent(),i=M,[4,W.visuals.createColumnChartWebBehaviorFactory()];case 2:return[4,i.apply(void 0,[[e.sent()],a])];case 3:return[2,t.apply(void 0,[(r.behaviorFactory=e.sent(),r.featureSwitches=a,r)])]}}))}))}:void 0);case W.visuals.plugins.lineChart.name:return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.lineChart,(function(e){e=e.module;return e.createCartesianChart({chartType:0,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:new W.visuals.BaseAnimator,behaviorFactory:e.createCartesianChartBehaviorFactory([e.createLineChartWebBehaviorFactory()],a),featureSwitches:a})}),a,D?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,r;return __generator(this,(function(e){switch(e.label){case 0:return t=D,r={chartType:0,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:new W.visuals.BaseAnimator},i=M,[4,W.visuals.createLineChartWebBehaviorFactory()];case 1:return[4,i.apply(void 0,[[e.sent()],a])];case 2:return[2,t.apply(void 0,[(r.behaviorFactory=e.sent(),r.featureSwitches=a,r)])]}}))}))}:void 0);case W.visuals.plugins.areaChart.name:return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.areaChart,(function(e){e=e.module;return e.createCartesianChart({chartType:1,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:new W.visuals.BaseAnimator,behaviorFactory:e.createCartesianChartBehaviorFactory([e.createLineChartWebBehaviorFactory()],a),featureSwitches:a})}),a,D?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,r;return __generator(this,(function(e){switch(e.label){case 0:return t=D,r={chartType:1,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:new W.visuals.BaseAnimator},i=M,[4,R()];case 1:return[4,i.apply(void 0,[[e.sent()],a])];case 2:return[2,t.apply(void 0,[(r.behaviorFactory=e.sent(),r.featureSwitches=a,r)])]}}))}))}:void 0);case W.visuals.plugins.stackedAreaChart.name:return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.stackedAreaChart,(function(e){e=e.module;return e.createCartesianChart({chartType:2,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:new W.visuals.BaseAnimator,behaviorFactory:e.createCartesianChartBehaviorFactory([e.createLineChartWebBehaviorFactory()],a),featureSwitches:a})}),a,D?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,r;return __generator(this,(function(e){switch(e.label){case 0:return t=D,r={chartType:2,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:new W.visuals.BaseAnimator},i=M,[4,R()];case 1:return[4,i.apply(void 0,[[e.sent()],a])];case 2:return[2,t.apply(void 0,[(r.behaviorFactory=e.sent(),r.featureSwitches=a,r)])]}}))}))}:void 0);case W.visuals.plugins.lineClusteredColumnComboChart.name:return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.lineClusteredColumnComboChart,(function(e){e=e.module;return e.createCartesianChart({chartType:14,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:e.createWebColumnChartAnimator(),behaviorFactory:e.createCartesianChartBehaviorFactory([e.createColumnChartWebBehaviorFactory(),e.createLineChartWebBehaviorFactory()],a),featureSwitches:a})}),a,D?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,r,n;return __generator(this,(function(e){switch(e.label){case 0:return t=D,n={chartType:14,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0},[4,W.visuals.createWebColumnChartAnimator()];case 1:return n.animator=e.sent(),i=M,[4,W.visuals.createColumnChartWebBehaviorFactory()];case 2:return r=[e.sent()],[4,W.visuals.createLineChartWebBehaviorFactory()];case 3:return[4,i.apply(void 0,[r.concat([e.sent()]),a])];case 4:return[2,t.apply(void 0,[(n.behaviorFactory=e.sent(),n.featureSwitches=a,n)])]}}))}))}:void 0);case W.visuals.plugins.lineStackedColumnComboChart.name:return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.lineStackedColumnComboChart,(function(e){e=e.module;return e.createCartesianChart({chartType:15,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:e.createWebColumnChartAnimator(),behaviorFactory:e.createCartesianChartBehaviorFactory([e.createColumnChartWebBehaviorFactory(),e.createLineChartWebBehaviorFactory()],a),featureSwitches:a})}),a,D?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,r,n;return __generator(this,(function(e){switch(e.label){case 0:return t=D,n={chartType:15,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0},[4,W.visuals.createWebColumnChartAnimator()];case 1:return n.animator=e.sent(),i=M,[4,W.visuals.createColumnChartWebBehaviorFactory()];case 2:return r=[e.sent()],[4,W.visuals.createLineChartWebBehaviorFactory()];case 3:return[4,i.apply(void 0,[r.concat([e.sent()]),a])];case 4:return[2,t.apply(void 0,[(n.behaviorFactory=e.sent(),n.featureSwitches=a,n)])]}}))}))}:void 0);case W.visuals.plugins.multiRowCard.name:return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.multiRowCard,(function(){return new W.visuals.MultiRowCard({interactivityEnabled:!0,behavior:new W.visuals.MultiRowCardBehavior})}),a,f?function(){return f({interactivityEnabled:!0,behavior:new W.visuals.MultiRowCardBehavior})}:void 0);case W.visuals.plugins.pieChart.name:return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.pieChart,(function(){return new W.visuals.DonutChart({sliceWidthRatio:0,animator:new W.visuals.WebDonutChartAnimator,isScrollable:!0,tooltipsEnabled:!0,behavior:new W.visuals.DonutChartWebBehavior})}),a,m?function(){return m({sliceWidthRatio:0,animator:new W.visuals.WebDonutChartAnimator,isScrollable:!0,tooltipsEnabled:!0,behavior:new W.visuals.DonutChartWebBehavior})}:void 0);case W.visuals.plugins.ribbonChart.name:return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.ribbonChart,(function(e){e=e.module;return e.createCartesianChart({chartType:9,isScrollable:!0,tooltipsEnabled:!0,animator:e.createWebColumnChartAnimator(),behaviorFactory:e.createCartesianChartBehaviorFactory([e.createColumnChartWebBehaviorFactory()],a),featureSwitches:a})}),a,D?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,r;return __generator(this,(function(e){switch(e.label){case 0:return t=D,r={chartType:9,isScrollable:!0,tooltipsEnabled:!0},[4,W.visuals.createWebColumnChartAnimator()];case 1:return r.animator=e.sent(),i=M,[4,W.visuals.createColumnChartWebBehaviorFactory()];case 2:return[4,i.apply(void 0,[[e.sent()],a])];case 3:return[2,t.apply(void 0,[(r.behaviorFactory=e.sent(),r.featureSwitches=a,r)])]}}))}))}:void 0);case W.visuals.plugins.scatterChart.name:return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.scatterChart,(function(e){e=e.module;return e.createCartesianChart({chartType:10,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:new W.visuals.BaseAnimator,behaviorFactory:e.createCartesianChartBehaviorFactory([e.createScatterChartWebBehaviorFactory()],a),featureSwitches:a})}),a,D?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,r;return __generator(this,(function(e){switch(e.label){case 0:return t=D,r={chartType:10,isScrollable:!0,dataPointLassoSelect:!0,tooltipsEnabled:!0,animator:new W.visuals.BaseAnimator},i=M,[4,L()];case 1:return[4,i.apply(void 0,[[e.sent()],a])];case 2:return[2,t.apply(void 0,[(r.behaviorFactory=e.sent(),r.featureSwitches=a,r)])]}}))}))}:void 0);case W.visuals.plugins.treemap.name:return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.treemap,(function(e){e=e.module;return new e.Treemap({animator:e.webAnimator(),isScrollable:!0,behavior:e.webBehavior(),tooltipsEnabled:!0,cartesianConditionalFormatting:a.cartesianConditionalFormatting,dataPointLassoSelect:!0})}),a,E?function(){return __awaiter(t,void 0,void 0,(function(){var t,i;return __generator(this,(function(e){switch(e.label){case 0:return t=E,i={},[4,G()];case 1:return i.animator=e.sent(),i.isScrollable=!0,[4,H()];case 2:return[2,t.apply(void 0,[(i.behavior=e.sent(),i.tooltipsEnabled=!0,i.cartesianConditionalFormatting=a.cartesianConditionalFormatting,i.dataPointLassoSelect=!0,i)])]}}))}))}:void 0);case W.visuals.plugins.filterSlicer.name:return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.filterSlicer,(function(){return new W.visuals.Slicer({lockKeyboardNavigation:!1,featureSwitches:a})}),a,V?function(){return V({lockKeyboardNavigation:!1,featureSwitches:a})}:void 0);case W.visuals.plugins.accessibleTable.name:return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.accessibleTable,(function(e){return new e.module.AccessibleTable}),a,h?function(){return h()}:void 0);case W.visuals.plugins.sunburst.name:return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.sunburst,(function(e){e=e.module;return new e.Sunburst({isScrollable:!0,behavior:e.behavior()})}),a,T?function(){return __awaiter(t,void 0,void 0,(function(){var t,i;return __generator(this,(function(e){switch(e.label){case 0:return t=T,i={isScrollable:!0},[4,U()];case 1:return[2,t.apply(void 0,[(i.behavior=e.sent(),i)])]}}))}))}:void 0);case W.visuals.plugins.waterfallChart.name:return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.waterfallChart,(function(e){e=e.module;return e.createCartesianChart({chartType:13,isScrollable:!0,tooltipsEnabled:!0,behaviorFactory:e.createCartesianChartBehaviorFactory([e.createWaterfallChartWebBehaviorFactory()],a),featureSwitches:a})}),a,D?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,r;return __generator(this,(function(e){switch(e.label){case 0:return t=D,r={chartType:13,isScrollable:!0,tooltipsEnabled:!0},i=M,[4,B()];case 1:return[4,i.apply(void 0,[[e.sent()],a])];case 2:return[2,t.apply(void 0,[(r.behaviorFactory=e.sent(),r.featureSwitches=a,r)])]}}))}))}:void 0);case W.visuals.plugins.map.name:return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.map,(function(){return new W.visuals.Map({behavior:new W.visuals.MapBehavior,dataPointLassoSelect:!0,tooltipsEnabled:!0,isLegendScrollable:!0,mapControlFactory:t.mapControlFactory})}),a,C?function(){return C({behavior:new W.visuals.MapBehavior,dataPointLassoSelect:!0,tooltipsEnabled:!0,isLegendScrollable:!0,mapControlFactory:t.mapControlFactory})}:void 0);case W.visuals.plugins.filledMap.name:return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.filledMap,(function(){return new W.visuals.Map({filledMap:!0,behavior:new W.visuals.MapBehavior,dataPointLassoSelect:!0,tooltipsEnabled:!0,filledMapDataLabelsEnabled:a&&a.filledMapDataLabelsEnabled,isLegendScrollable:!0,mapControlFactory:t.mapControlFactory})}),a,C?function(){return C({filledMap:!0,behavior:new W.visuals.MapBehavior,dataPointLassoSelect:!0,tooltipsEnabled:!0,filledMapDataLabelsEnabled:a&&a.filledMapDataLabelsEnabled,isLegendScrollable:!0,mapControlFactory:t.mapControlFactory})}:void 0);case W.visuals.plugins.azureMap.name:return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.azureMap,(function(e){e=e.module;return e.createAzureMap({behavior:e.createAzureMapBehavior(),tooltipsEnabled:!0,isLegendScrollable:!0,mapControlFactory:t.mapControlFactory})}),a,S?function(){return __awaiter(t,void 0,void 0,(function(){var t,i;return __generator(this,(function(e){switch(e.label){case 0:return t=S,i={},[4,k()];case 1:return[2,t.apply(void 0,[(i.behavior=e.sent(),i.tooltipsEnabled=!0,i.isLegendScrollable=!0,i.mapControlFactory=this.mapControlFactory,i)])]}}))}))}:void 0);case W.visuals.plugins.shape.name:return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.shape,(function(e){return e.module.createShape()}),a,A?function(){return A()}:void 0);case W.visuals.plugins.actionButton.name:return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.actionButton,(function(e){return new e.module.ActionButton}),a,l?function(){return l()}:void 0);case W.visuals.plugins.shapeMap.name:return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.shapeMap,(function(e){e=e.module;return new e.ShapeMap({behavior:new e.ShapeMapBehavior,tooltipsEnabled:!0})}),a,b?function(){return b({behavior:X(),tooltipsEnabled:!0})}:void 0);case W.visuals.plugins.slicer.name:return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.slicer,(function(){return new W.visuals.Slicer({featureSwitches:a,preventVirtualKeyboardOnTheFirstTap:!0,isSlicer:!0})}),a,V?function(){return V({featureSwitches:a,preventVirtualKeyboardOnTheFirstTap:!0,isSlicer:!0})}:void 0);case W.visuals.plugins.matrix.name:return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.matrix,(function(){return new W.visuals.Matrix({})}),a,p?function(){return p()}:void 0);case W.visuals.plugins.table.name:return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.table,(function(){return new W.visuals.Table({})}),a,d?function(){return d()}:void 0);case W.visuals.plugins.pivotTable.name:var i=n.createDefaultConstructorOptions();return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.pivotTable,(function(){return new W.visuals.PivotTable(i,a)}),a,u?function(){return u(i,a)}:void 0);case W.visuals.plugins.tableEx.name:var r=o.createDefaultConstructorOptions();return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.tableEx,(function(){return new W.visuals.TableEx(r,a)}),a,c?function(){return c(r,a)}:void 0);case W.visuals.plugins.scriptVisual.name:return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.scriptVisual,(function(e){return new e.module.ScriptVisual}),a,x?function(){return x()}:void 0);case W.visuals.plugins.pythonVisual.name:return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.pythonVisual,(function(e){return new e.module.ScriptVisual}),a,x?function(){return x()}:void 0);case W.visuals.plugins.debugVisual.name:return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.debugVisual,(function(){return new W.visuals.system.DebugVisual(t.visualSandbox)}),a,void 0);case W.visuals.plugins.textbox.name:return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.textbox,(function(e){return e.module.createTextbox({supportsNarrativeExpressions:a.daxTransformEnabled,supportsFormattingChangeIndication:a.mobileAuthoringFormattingUI})}),a,w?function(){return w({supportsNarrativeExpressions:a.daxTransformEnabled,supportsFormattingChangeIndication:a.mobileAuthoringFormattingUI})}:void 0);case W.visuals.plugins.keyDriversVisual.name:return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.keyDriversVisual,(function(e){return e.module.createAnalysisVisual()}),a,void 0);case W.visuals.plugins.decompositionTreeVisual.name:return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.decompositionTreeVisual,(function(e){return new e.module.DecompositionTree}),a,F?function(){return F()}:void 0);case W.visuals.plugins.qnaVisual.name:return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.qnaVisual,(function(e){return e.module.createQnaVisual()}),a,void 0);case W.visuals.plugins.histogram.name:return W.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(W.visuals.plugins.histogram,(function(e){e=e.module;return e.createCartesianChart({chartType:19,isScrollable:!0,tooltipsEnabled:!0,animator:e.createWebColumnChartAnimator(),behaviorFactory:e.createCartesianChartBehaviorFactory([e.createColumnChartWebBehaviorFactory()],a),featureSwitches:a})}),a,D?function(){return __awaiter(t,void 0,void 0,(function(){var t,i,r;return __generator(this,(function(e){switch(e.label){case 0:return t=D,r={chartType:19,isScrollable:!0,tooltipsEnabled:!0},[4,W.visuals.createWebColumnChartAnimator()];case 1:return r.animator=e.sent(),i=M,[4,W.visuals.createColumnChartWebBehaviorFactory()];case 2:return[4,i.apply(void 0,[[e.sent()],a])];case 3:return[2,t.apply(void 0,[(r.behaviorFactory=e.sent(),r.featureSwitches=a,r)])]}}))}))}:void 0);default:return W.Prototype.inherit(W.visuals.plugins[e])}},i);function i(e,t,i){this.featureSwitchService=e,this.mapControlFactory=t,this.visualSandbox=i}e.ExplorationVisualPluginProvider=z})((e=W.explore||(W.explore={})).services||(e.services={}))})(powerbi=powerbi||{}),(function(h){h.visualSyncServiceModuleFactory=function(){var e=h.data,t=(i=h.explore).contracts,b=e.DataViewObjectDefinitions,E=e.DataViewObjectDescriptors.findFilterOutput,V=i.services.ExplorationState,o=e.SemanticFilter,s=e.SQExpr,i=e.SQExprRewriter,w=(t.VisualContainer,h.explore.util.VisualContainerUtils),u=(r.prototype.generateUniqueGroupName=function(e,t,i){var r=this.getVisualSyncField(t),n=r?this.displayNameService.getDisplayName(r,e,this.visualPlugin.capabilities(t.visualType)):"Group";_.isEmpty(n);for(var a=n,o=1;a in i;)a=n+o++;return a},r.prototype.syncFilterState=function(C,S){return __awaiter(this,void 0,h.Promise,(function(){var t,i,r,n,a,o,s,l,u,c,p,d,h,g,v,m,f,y;return __generator(this,(function(e){switch(e.label){case 0:return(t=C.config.singleVisual,this.canSyncVisual(t))?t.syncGroup?(i=this.getOtherSectionsInSyncGroup(t),_.isEmpty(i)?[2]:[4,this.conceptualSchemaProxy.get(this.dataSources.get())]):[2]:[2];case 1:for(r=e.sent(),n=this.explorationStateManager.captureFilterState(t),S=S&&t.syncGroup.filterChanges,a=this.visualPlugin.capabilities(t.visualType),o={clearUnmatchedData:!1,suppressActiveSection:!0,suppressDisplay:!0,targetVisualNames:[]},s=E(a.objects),l=s&&b.getValue(n.objects.merge,s,null),u=[],c=0,p=i;c<p.length;c++)for(d=p[c],w.clearSectionQueryCaches(d.section),h=0,g=d.visualContainers;h<g.length;h++){if(v=g[h],m=S&&this.syncFilters(v,C.filters),f=n,l){if(y=b.getValue(v.config.singleVisual.objects,s,null),y=this.replaceSemanticFilterField(C.config.singleVisual.query.defn,l,v.config.singleVisual.query.defn,y,r),l&&!y){m&&this.visualAuthoringOperations.notifyVisualContainers([v]);continue}y!==l&&((f=V.cloneSingleVisual(f,this.visualPlugin,this.featureSwitchService)).cachedFilterDisplayItems=void 0,f.filterExpressionMetadata=void 0,b.setValue(f.objects.merge,s,null,y))}o.targetVisualNames.push(v.name),u.push({visual:v,state:f,impacted:m})}return _.isEmpty(u)||this.explorationStateManager.applyFilterState(u,r,o),[2]}}))}))},r.prototype.syncVisualFiltersState=function(e,t){void 0===t&&(t=!0),e.config;var i=e.config.singleVisual,r=[];if(this.canSyncVisual(i)&&i.syncGroup.filterChanges){for(var n=0,a=this.getOtherSectionsInSyncGroup(i);n<a.length;n++){var o=a[n];if(!_.isEmpty(o.visualContainers))for(var s=0,l=o.visualContainers;s<l.length;s++){var u=l[s];this.syncFilters(u,e.filters)&&r.push(u)}}t&&this.visualAuthoringOperations.notifyVisualContainers(r)}},r.prototype.syncFilters=function(e,t){var i=_.isEmpty(t);if(e.config.singleVisual.syncGroup.filterChanges){if(i&&!_.isEmpty(e.filters))return e.filters=[],!0;if(!i){t=this.explorationSerializer.deserializeFilterCollection(this.explorationSerializer.serializeFilterCollection(t),[],!0);return e.filters=t,!0}}return!1},r.prototype.getVisualsAffectByFieldChanges=function(e){e=e.config.singleVisual;return this.canSyncVisual(e)&&e.syncGroup.fieldChanges?_.filter(this.getOtherVisualsInSyncGroup(e),(function(e){return e.config.singleVisual.syncGroup.fieldChanges})):[]},r.prototype.canSyncVisual=function(e){if(!e.syncGroup)return!1;e=this.visualPlugin.capabilities(e.visualType),e=e&&e.supportsSynchronizingFilterState;return e},r.prototype.getOtherVisualsInSyncGroup=function(e){return this.getVisualsInSectionsSyncGroup(this.getOtherSectionsInSyncGroup(e))},r.prototype.getVisualsInSectionsSyncGroup=function(e){for(var t=[],i=0,r=e;i<r.length;i++){var n=r[i];t.push.apply(t,n.visualContainers||[])}return t},r.prototype.getOtherSectionsInSyncGroup=function(t){if(!t.syncGroup)return[];if(!t.syncGroup.groupName)return[];for(var e=[],i=0,r=this.explorationNavigation.getCurrentExploration().sections;i<r.length;i++){var n=r[i],a=_.filter(n.visualContainers,(function(e){e=e.config.singleVisual;return e!==t&&e.syncGroup&&e.syncGroup.groupName===t.syncGroup.groupName&&e.visualType===t.visualType}));_.isEmpty(a)||e.push({section:n,visualContainers:a})}return e},r.prototype.getVisualSyncField=function(e){e=e.query.defn.select();return 0===e.length?null:e[0].expr},r.prototype.replaceSemanticFilterField=function(e,t,i,r,n){if(!t)return t;var a=e.select(),e=i.select();if(a.length===e.length){if(1<a.length)return!_.differenceWith(a,e,(function(e,t){return s.equals(e.expr,t.expr)})).length?t:void 0;if(1===a.length){if(s.equals(a[0].expr,e[0].expr))return t;i=l.extract(t);if(i){if(!r){a=t.conditions();if(1!==a.length)return;n=e[0].expr.getKeyColumns(n);if(1!==n.length)return;n=p.replaceCondition(a[0],i,n[0]);return o.fromSQExpr(n)}r=l.extract(r);if(r)return p.replace(t,i,r)}}}},r);function r(e,t,i,r,n,a,o,s,l){this.explorationStateManager=e,this.explorationNavigation=t,this.explorationSerializer=i,this.featureSwitchService=r,this.visualPlugin=n,this.conceptualSchemaProxy=a,this.dataSources=o,this.displayNameService=s,this.visualAuthoringOperations=l}var n,l=(__extends(a,n=i),a.extract=function(e){var t=new a;return e.rewrite(t),t.foundSingleField&&t.fieldExpr},a.prototype.visitHierarchyLevel=function(e){return this.setFieldExpr(e),e},a.prototype.visitColumnRef=function(e){return this.setFieldExpr(e),e},a.prototype.setFieldExpr=function(e){if(!this.fieldExpr)return this.fieldExpr=e,void(this.foundSingleField=!0);s.equals(this.fieldExpr,e)||(this.foundSingleField=!1)},a);function a(){return n.call(this)||this}var c,p=(c=e.SQExprRewriter,__extends(d,c),d.replace=function(e,t,i){if(s.equals(t,i))return e;i=new d(t,i);return e.rewrite(i)},d.replaceCondition=function(e,t,i){if(s.equals(t,i))return e;i=new d(t,i);return e.accept(i)},d.prototype.visitColumnRef=function(e){if(s.equals(e,this.before))return this.after},d);function d(e,t){var i=c.call(this)||this;return i.before=e,i.after=t,i}return{create:function(e,t,i,r,n,a,o,s,l){return new u(e,t,i,r,n,a,o,s,l)}}}})(powerbi=powerbi||{}),(function(l){var u,c,e,p,d,h,n;function o(i,r){return __awaiter(this,void 0,l.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return(t=i.get())?[4,r.get(t)]:[2];case 1:return[2,e.sent()]}}))}))}function g(e,t,i,r,n){void 0===n&&(n=!0),_.isEmpty(e)||(i=i.get(),r.addConfigToCategoricalFilters(e,t,i,n))}function v(t,e){var i=e.getCurrentExploration(),e=e.getCurrentSection();e&&(!(e=u.PodUtils.findPodForSectionName(i,e.name))||_.isEmpty(e.parameters)||(e=_.find(e.parameters,(function(e){return e.boundFilter===t.contract.name})))&&t.updateIsLinkedAsAggregation(!!e.asAggregation))}function m(e,t){return 0===e?0:1!==e||t?1===e?2:2===e?3:-1:1}u=l.explore||(l.explore={}),c=u.util||(u.util={}),p=l.explore.services.events,d=l.explore.util.ScriptVisualsUtil,h=u.services.selectionUtils,n=jsCommon.StringExtensions,(e=c.FilterPaneUtil||(c.FilterPaneUtil={})).onFilterContainerChanged=function(t,e,i,r,n,a){var o,s;2===t.scope.scopeType&&c.VisualContainerUtils.clearExplorationQueryCaches(i),1===t.changeType||2===t.changeType&&!(function(e,t){for(var i=0,r=t;i<r.length;i++)if(r[i].contract===e)return!0;return!1})(t.filter,e)?(o=c.VisualContainerUtils.getVisualCapabilities(a,r.visualPlugin),v(s=u.viewModels.FilterViewModelFactory.convertFilterContainer(t.filter,n,r.displayNameService,t.scope,r.visualPlugin,r.aggrOps,r.localizationService,o,a&&a.config.singleVisual),r.explorationNavigation),0===t.scope.scopeType&&t.scope.container!==a||(e.push(s),g(e,n,r.dataSources,r.visualAuthoring))):0===t.changeType&&_.remove(e,(function(e){return e.contract===t.filter})),o=t,s=(a=r).explorationNavigation,n=s.getCurrentExploration(),e=s.getCurrentSection(),r=o.scope.scopeType,s=h.getSelectedVisual(a.selection),e=d.getScriptVisualIds(r,n,e,s,a.scriptVisuals),_.isEmpty(e)||(s=o.changeType.toString(),o=o.parentActivity&&o.parentActivity.event,a.telemetryService.logChildEvent(o,l.telemetry.EXFilterScriptVisual,{action:s,visualIds:JSON.stringify(e)}))},e.getPageScopeFilters=function(n,a){return __awaiter(this,void 0,l.Promise,(function(){var t,i,r;return __generator(this,(function(e){switch(e.label){case 0:return t=n.explorationNavigation.getCurrentSection(),r=n.explorationCapabilities.getCapabilities(),i=[],!t||r.shouldShowPageFilters&&!r.shouldShowPageFilters(t)?[2,i]:[4,o(n.dataSources,n.conceptualSchemaProxy)];case 1:return r=e.sent(),g(i=u.viewModels.ViewModelFactory.createFilters({scopeType:1,container:t},r,n.displayNameService,n.visualPlugin,n.aggrOps,n.localizationService,null,a),r,n.dataSources,n.visualAuthoring,!1),(function(e,t){if(!_.isEmpty(e))for(var i=0,r=e;i<r.length;i++)v(r[i],t)})(i,n.explorationNavigation),[2,i]}}))}))},e.getConceptualSchema=o,e.addConfigToFilters=g,e.setDrillthroughMetadata=v,e.addFilterToScopeFromDrop=function(e,t,i,r,n,a,o){n&&(t={scopeType:e,container:t},r=r.get(),i?a.addDrillthroughFilter(n,t,r):a.addFilter(n,t,r,o))},e.updateCategoricalFiltersIfNeeded=function(e,t,i,r){if(!_.isEmpty(i)&&(10===r.changeType||1===r.changeType||2===r.changeType||0===r.changeType))for(var n=m(r.scope.scopeType,5===r.filter.howCreated),a=0,o=i;a<o.length;a++){var s=o[a];n<m(t,5===s.howCreated)||u.FilterUtils.isCategoricalFilter(s.contract.type)&&s.contract!==r.filter&&(s={filter:s.contract,changeType:4,scope:s.getFilterContainerScope(),parentActivity:r.parentActivity},e.eventBridge.publishToChannel(p.filterContainerChanged,s))}},e.shouldHideFilterBySearchInput=function(e,t,i){if(!t||/^\s*$/.test(t))return!1;var r=e.contract.displayName||e.displayName;return _.isEmpty(r)&&(r=e.getRestatement()),!n.containsIgnoreCase(r,t)}})(powerbi=powerbi||{}),(function(E){var e,V;e=E.explore||(E.explore={}),((V=e.viewModels||(e.viewModels={})).FieldListViewModelDisplayFolderMerger||(V.FieldListViewModelDisplayFolderMerger={})).mergeDisplayFolders=function(e,i,t,r){var n=new V.FieldListViewModelMerger.VmListMerger(e.displayFolders),a=_.keyBy(e.displayFolders,(function(e){return e.name}));if(!_.isEmpty(t))for(var o=0,s=t;o<s.length;o++)for(var l=function(t){var e=i.indexOf(i.filter((function(e){return e.name===t.name}))[0]);0<=e?i[e]=(function i(r,e){if(e){for(var t=0,n=e.properties;t<n.length;t++){var a=n[t];r.properties.push(a)}for(var o=0,s=e.hierarchies;o<s.length;o++){var l=s[o];r.hierarchies.push(l)}for(var u=function(t){var e=r.displayFolders.indexOf(r.displayFolders.filter((function(e){return e.name===t.name}))[0]);0<=e?r.displayFolders[e]=i(r.displayFolders[e],t):r.displayFolders.push(t)},c=0,p=e.displayFolders;c<p.length;c++){var d=p[c];u(d)}}return r})(i[e],t):i=i.concat(t)},u=0,c=s[o].entity.displayFolders;u<c.length;u++)l(c[u]);if(!_.isEmpty(i))for(var p=0,d=i;p<d.length;p++){var h=d[p];n.add(function e(t,i,r,n,a){var o=n[r.name];if(o){o.contract=r;var s=new V.FieldListViewModelMerger.VmListMerger(o.children);if(r.properties)for(var l=_.filter(o.children,(function(e){return 1!==e.fieldType&&2!==e.fieldType})),u=_.keyBy(l,(function(e){return e.name})),c=0,p=r.properties;c<p.length;c++){var d=p[c],h=u[d.name];h||(d=_.head(t.findFields(d.name,o.schemaName))||_.head(t.findFields(d.name,E.explore.constants.ExplorationSchemaName))||_.head(t.findKpis(d.name,o.schemaName)),(h=d.clone()).parent=o),s.add(h)}if(r.hierarchies)for(var l=_.filter(o.children,(function(e){return 2===e.fieldType})),u=_.keyBy(l,(function(e){return e.name})),g=0,v=r.hierarchies;g<v.length;g++){var m=v[g],f=u[m.name];f||(m=_.head(t.findHierarchies(m.name,o.schemaName)),(f=m.clone()).parent=o),s.add(f)}if(r.displayFolders)for(var y=_.filter(o.children,(function(e){return 1===e.fieldType})),u=_.keyBy(y,(function(e){return e.name})),C=0,S=r.displayFolders;C<S.length;C++){var b=S[C];s.add(e(t,o,b,u,a))}o.children=s.merge();y=new V.FieldListViewModelMerger.VmAlphabeticalSorter;y.sortProperties(o.children)}else o=a.convertConceptualDisplayFolder(r,t.contractSchema,i,t);return o}(e,void 0,h,a,r))}e.displayFolders=n.merge(),(t=e.properties).push.apply(t,e.displayFolders||[])}})(powerbi=powerbi||{}),(function(e){var x;e=e.explore||(e.explore={}),(function(e){e.mergeModel=function(e,t,i,r,n,a,o){return new s(i,new l,n,a,o,r).mergeFieldList(e,t)};var s=(t.prototype.mergeFieldList=function(e,t){return e&&t||(e={schema:void 0,isLoaded:!1}),t&&_.some(t.schemas)&&(e.schema=this.mergeSchemas(e,t),e.isLoaded=!0),e},t.prototype.mergeSchemas=function(e,t){var i=e.schema;if(i){var r=x.FieldListViewModelUtils.getExtensions(t.schemas),e=x.FieldListViewModelUtils.sortExtensionSchemasAtEnd(t.schemas);i.contract=_.find(e,(function(e){return!x.FieldListViewModelUtils.isExtension(e)}));for(var n=new w(i.entities),a=0,o=e;a<o.length;a++)for(var s=o[a],l=0,u=s.entities;l<u.length;l++){var c=u[l];x.FieldListViewModelUtils.isExtension(c)&&!x.FieldListViewModelUtils.isAbandoned(c)||(c=this.mergeEntity(i,s,c,r),s===i.contract&&n.add.apply(n,c||[]))}i.entities=n.merge(),this.sorter.sortEntities(i.entities)}else i=this.factory.createModel(t,this.disableEditing,this.disableDragging,this.disableSelectionOnFocus);return i},t.prototype.mergeEntity=function(e,t,i,r){var n=this.findEntityVm(e,i);if(n){n.contract=i,n.contractSchema=t;var a=new w(n.properties),o=new w(n.columnsAndMeasures),s=new w(n.hierarchies),l=new V(n,this.schemaChanges);if(!x.FieldListViewModelUtils.isExtension(i))for(var u=0,c=i.properties;u<c.length;u++){var p=c[u],d=this.mergePropertyMeasureOrKpi(n,t,p,l);a.add.apply(a,d||[]),o.add.apply(o,d||[])}for(var h=0,g=i.hierarchies;h<g.length;h++){var v=g[h],v=this.mergeHierarchy(n,t,v,l);a.add.apply(a,v||[]),s.add.apply(s,v||[])}var m=r.entities[x.FieldListViewModelUtils.getExtensionKey(t.name,i.name)];if(m)for(var f=0,y=m;f<y.length;f++)for(var C=y[f],S=0,b=C.entity.properties;S<b.length;S++){var p=b[S],E=this.mergeExtensionMeasure(n,C.schema,p,l);a.add.apply(a,E||[]),o.add.apply(o,E||[])}n.columnsAndMeasures=o.merge((function(e){return!e.parent})),n.hierarchies=s.merge((function(e){return!e.parent})),n.properties=a.merge((function(e){return!e.parent})),x.FieldListViewModelDisplayFolderMerger.mergeDisplayFolders(n,i.displayFolders,m,this.factory),this.sorter.sortProperties(n.properties),x.FieldListViewModelUtils.removeDuplicateProperties(n.properties,n.displayFolders),x.FieldListViewModelUtils.flattenFolders(n),x.FieldListViewModelUtils.updatePropertiesWithChildren(n)}else n=this.factory.convertConceptualEntity(i,t,e,r);return[n]},t.prototype.findEntityVm=function(e,t){var i=t.name,r=_.find(this.schemaChanges,(function(e){return e.entityRename&&e.entityRename.after===t.name}));r&&(i=r.entityRename.before);i=e.findEntity(i);return i&&x.FieldListViewModelUtils.isAbandoned(i.contract)!==x.FieldListViewModelUtils.isAbandoned(t)?null:i},t.prototype.mergePropertyMeasureOrKpi=function(e,t,i,r){if(!x.FieldListViewModelUtils.isExtension(i))return(n=i).measure&&n.measure.kpi?this.mergeKpi(e,t,i,r):i.kpiValue?void 0:this.mergeProperty(e,t,i,r);var n},t.prototype.mergeProperty=function(e,t,i,r){r=r.findVms(t.name,i.name,0),r=_.filter(r,(function(e){return!e.isExtension}));if(_.isEmpty(r))r=[this.factory.convertConceptualProperty(i,t,e)];else for(var n=0,a=r;n<a.length;n++){var o=a[n];o.contract=i,o.schema=t;for(var s=new w(o.children),l=0,u=x.FieldListViewModelUtils.getPropertyVariations(i);l<u.length;l++){var c=u[l];s.add(this.mergeVariationHierarchy(o,t,c))}o.children=s.merge()}return r},t.prototype.mergeVariationHierarchy=function(e,t,i){var r=_.find(e.children,(function(e){return e instanceof x.FieldListConceptualHierarchy&&e.variation===i.name}));return r?this.updateHierarchyVm(e.entity,r,i.defaultHierarchy,t):r=this.factory.convertConceptualVariationHierarchy(i,t,e),r},t.prototype.mergeExtensionMeasure=function(e,t,i,r){r=r.findVms(t.name,i.name,0),r=_.filter(r,(function(e){return e.isExtension}));return _.isEmpty(r)?r=[this.factory.convertConceptualExtensionMeasure(i,t,e)]:_.forEach(r,(function(e){e.contract=i,e.schema=t})),r},t.prototype.mergeKpi=function(e,t,i,r){r=r.findVms(t.name,i.name,4);if(_.isEmpty(r))r=[this.factory.convertConceptualKpi(i,t,e)];else for(var n=0,a=r;n<a.length;n++){var o=a[n];o.contract=i,o.schema=t;var s=new w(o.kpiMeasures);s.add(this.mergeKpiMeasure(t,o,i,2)),i.measure.kpi.goal&&s.add(this.mergeKpiMeasure(t,o,i.measure.kpi.goal,1)),i.measure.kpi.status&&s.add(this.mergeKpiMeasure(t,o,i.measure.kpi.status,0)),i.measure.kpi.trend&&s.add(this.mergeKpiMeasure(t,o,i.measure.kpi.trend,3)),_.some(s,(function(e){return null===e}))?o.kpiMeasures=this.factory.convertConceptualKpi(i,t,e).kpiMeasures:o.kpiMeasures=s.merge()}return r},t.prototype.mergeKpiMeasure=function(e,t,i,r){t=_.find(t.kpiMeasures,(function(e){return e.kpiType===r}));return t?(t.contract=i,t.schema=e,t):null},t.prototype.mergeHierarchy=function(t,e,i,r){r=r.findVms(e.name,i.name,2);if(_.isEmpty(r)){var n=this.factory.convertConceptualHierarchy(i,e,t);_.some(this.schemaChanges,(function(e){return e.hierarchyCreate&&e.hierarchyCreate.entity===t.name&&e.hierarchyCreate.name===n.name}))&&(n.expanded=!0),r=[n]}else for(var a=0,o=r;a<o.length;a++){var s=o[a];this.updateHierarchyVm(t,s,i,e)}return r},t.prototype.updateHierarchyVm=function(e,t,i,r){t.contract=i,t.schema=r;for(var n=_.keyBy(t.hierarchyLevels,(function(e){return e.name})),a=new w(t.hierarchyLevels),o=0,s=i.levels;o<s.length;o++){var l=s[o],l=this.mergeHierarchyLevel(e,t,r,l,n);a.add(l)}t.hierarchyLevels=a.merge()},t.prototype.mergeHierarchyLevel=function(e,t,i,r,n){n=this.findHierarchyLevel(e,t,i,r,n);return n?(n.contract=r.column,n.hierarchyLevelContract=r,n.schema=i):n=this.factory.convertConceptualHierarchyLevel(r,i,t),n},t.prototype.findHierarchyLevel=function(t,i,e,r,n){var a=r.name,r=_.find(this.schemaChanges,(function(e){return e.hierarchyLevelRename&&e.hierarchyLevelRename.entity===t.contract.name&&e.hierarchyLevelRename.hierarchy===i.contract.name&&e.hierarchyLevelRename.after===a}));return n[a=r?r.hierarchyLevelRename.before:a]},t);function t(e,t,i,r,n,a){this.factory=e,this.sorter=t,this.disableEditing=i,this.disableDragging=r,this.disableSelectionOnFocus=n,this.schemaChanges=a?a.changes:[]}var l=(i.prototype.sortEntities=function(e){},i.prototype.sortProperties=function(e){e&&e.sort((function(e,t){return x.FieldListViewModelUtils.compareAlphabeticallyIgnoreCase(e.displayName,t.displayName)}))},i);function i(){}e.VmAlphabeticalSorter=l;var V=(r.prototype.findVms=function(e,t,i){i=this.getKey(e,t,i),i=this.renames[i]||i;return this.vmLookup[i]},r.prototype.getPropertiesDictionary=function(e){for(var t=this,i=_.clone(e.properties),r=0,n=e.columnsAndMeasures;r<n.length;r++){var a=n[r];i.push(a)}for(var o=0,s=e.hierarchies;o<s.length;o++){var l=s[o];i.push(l)}for(var u=0,c=e.displayFolders;u<c.length;u++){var p=c[u];i.push(p),i.push.apply(i,p.getAllChildren()||[])}i=_.uniq(i);return _.groupBy(i,(function(e){return t.getVmKey(e)}))},r.prototype.getRenamesDictionary=function(t,e){for(var i={},r=0,n=_.filter(e,(function(e){return e.propertyRename&&e.propertyRename.entity===t.name}));r<n.length;r++){var a=n[r],o=this.getFieldType(a.propertyRename.objectType),s=this.getKey(a.propertyRename.schema,a.propertyRename.before,o);i[this.getKey(a.propertyRename.schema,a.propertyRename.after,o)]=s}return i},r.prototype.getVmKey=function(e){return this.getKey(e.schemaName,e.name,e.fieldType)},r.prototype.getKey=function(e,t,i){return t+":"+i+(e?"|"+e:"")},r.prototype.getFieldType=function(e){switch(e){default:return 0;case"KPI":return 4;case"Hierarchy":return 2;case"Level":return 3}},r);function r(e,t){this.vmLookup=this.getPropertiesDictionary(e),this.renames=this.getRenamesDictionary(e,t)}var w=(n.prototype.add=function(){for(var e,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return!!t&&(t=_.filter(t,(function(e){return!!e})),(e=this.newItems).push.apply(e,t||[]),!0)},n.prototype.merge=function(e){e&&(this.newItems=_.filter(this.newItems,e));e=this.oldItems;return e?e.splice.apply(e,__spreadArray([0,e.length],this.newItems||[])):_.isEmpty(this.newItems)||(e=this.newItems),e},n);function n(e){this.oldItems=e,this.newItems=[]}e.VmListMerger=w})((x=e.viewModels||(e.viewModels={})).FieldListViewModelMerger||(x.FieldListViewModelMerger={}))})(powerbi=powerbi||{}),(function(i){!(function(a){var e,o,s;function t(e){e&&(this.visible=e.show,this.position=e.position,this.color=e.color.solid.color,this.preset=e.preset,this.transparency=e.transparency,this.shadowSpread=e.shadowSpread,this.shadowBlur=e.shadowBlur,this.angle=e.angle,this.shadowDistance=e.shadowDistance)}e=a.viewModels||(a.viewModels={}),o=i.common.utils.ColorUtility,s=i.explore.util.VisualDropShadowUtil,t.prototype.getBoxShadow=function(){if(this.visible){if(this.preset!==a.contracts.VisualDropShadow.CustomPreset){var e=s.getPresetSettings(this.preset,this.position);if(e)for(var t in e)this[t]=e[t]}var i=this.position===a.contracts.VisualDropShadow.InnerPosition?"inset ":"",r=o.convertTransparencyToOpacity(this.transparency),n=Math.PI/180*this.angle;return i+Math.cos(n)*this.shadowDistance+"px "+Math.sin(n)*this.shadowDistance+"px "+this.shadowBlur+"px "+this.shadowSpread+"px "+o.hexToRGBString(this.color,r)}return""},e.VisualDropShadow=t})(i.explore||(i.explore={}))})(powerbi=powerbi||{});
this.parseTimeMarkers = this.parseTimeMarkers || {};
var marker = this.parseTimeMarkers['powerbiportal.explore.bundle.min.js'] || (this.parseTimeMarkers['powerbiportal.explore.bundle.min.js'] = {});
marker.endEval = window.jsCommon && window.jsCommon.performance && window.jsCommon.performance.now ? window.jsCommon.performance.now() : Date.now(); marker.isExternal = false;
