'use strict'; 
"use strict";
this.parseTimeMarkers = this.parseTimeMarkers || {};
var marker = this.parseTimeMarkers['powerbiportal.web.bundle.min.js'] || (this.parseTimeMarkers['powerbiportal.web.bundle.min.js'] = {});
marker.startEval = window.jsCommon && window.jsCommon.performance && window.jsCommon.performance.now ? window.jsCommon.performance.now() : Date.now(); marker.isExternal = false;
if (window.perfTracking && window.perfTracking.startBundleEval) window.perfTracking.startBundleEval('powerbiportal.web.bundle.min.js');var powerbi,__awaiter=this&&this.__awaiter||function(e,n,s,c){return new(s=s||Promise)(function(o,t){function r(e){try{i(c.next(e))}catch(e){t(e)}}function a(e){try{i(c.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?o(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(r,a)}i((c=c.apply(e,n||[])).next())})},__generator=this&&this.__generator||function(o,r){var a,i,n,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return (function(t){if(a)throw new TypeError("Generator is already executing.");for(;s;)try{if(a=1,i&&(n=2&t[0]?i.return:t[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,t[1])).done)return n;switch(i=0,(t=n?[2&t[0],n.value]:t)[0]){case 0:case 1:n=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,i=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(n=0<(n=s.trys).length&&n[n.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!n||t[1]>n[0]&&t[1]<n[3])){s.label=t[1];break}if(6===t[0]&&s.label<n[1]){s.label=n[1],n=t;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(t);break}n[2]&&s.ops.pop(),s.trys.pop();continue}t=r.call(o,s)}catch(e){t=[6,e],i=0}finally{a=n=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}})([t,e])}}};!(function(i){!(function(t){var e=jsCommon.Utility,o=i.telemetryEventFactory,r=i.telemetryBaseEventFactory,a=i.telemetry.EventFactories;e?e.generateGuid:Function.prototype;t.DashboardRenameReportEventName="PBI.Dashboard.RenameReport",t.DashboardRenameReport=a[t.DashboardRenameReportEventName]=function(e){return o({name:t.DashboardRenameReportEventName,baseEvent:t.CustomerAction(e),info:e,category:i.TelemetryCategory.CustomerAction,loggers:t.DashboardRenameReportLoggers})},t.DashboardDeleteReportEventName="PBI.Dashboard.DeleteReport",t.DashboardDeleteReport=a[t.DashboardDeleteReportEventName]=function(e){return o({name:t.DashboardDeleteReportEventName,baseEvent:t.CustomerAction(e),info:e,category:i.TelemetryCategory.CustomerAction,loggers:t.DashboardDeleteReportLoggers})},t.DashboardInitializeNavigationPaneReportsEventName="PBI.Dashboard.InitializeNavigationPaneReports",t.DashboardInitializeNavigationPaneReports=a[t.DashboardInitializeNavigationPaneReportsEventName]=function(e){return o({name:t.DashboardInitializeNavigationPaneReportsEventName,baseEvent:t.Verbose(e),info:e,category:i.TelemetryCategory.Verbose,loggers:t.DashboardInitializeNavigationPaneReportsLoggers})},t.DashboardInitializeNavigationPaneModelsEventName="PBI.Dashboard.InitializeNavigationPaneModels",t.DashboardInitializeNavigationPaneModels=a[t.DashboardInitializeNavigationPaneModelsEventName]=function(e){return o({name:t.DashboardInitializeNavigationPaneModelsEventName,baseEvent:t.Verbose(e),info:e,category:i.TelemetryCategory.Verbose,loggers:t.DashboardInitializeNavigationPaneModelsLoggers})},t.DashboardRenameDatasetEventName="PBI.Dashboard.RenameDataset",t.DashboardRenameDataset=a[t.DashboardRenameDatasetEventName]=function(e){return o({name:t.DashboardRenameDatasetEventName,baseEvent:t.CustomerAction(e),info:e,category:i.TelemetryCategory.CustomerAction,loggers:t.DashboardRenameDatasetLoggers})},t.DashboardUpdateModelQnaFeaturesEventName="PBI.Dashboard.UpdateModelQnaFeatures",t.DashboardUpdateModelQnaFeatures=a[t.DashboardUpdateModelQnaFeaturesEventName]=function(e){return o({name:t.DashboardUpdateModelQnaFeaturesEventName,baseEvent:t.CustomerAction(e),info:e,category:i.TelemetryCategory.CustomerAction,loggers:t.DashboardUpdateModelQnaFeaturesLoggers})},t.DashboardUpdateFeaturedQuestionsEventName="PBI.Dashboard.UpdateFeaturedQuestions",t.DashboardUpdateFeaturedQuestions=a[t.DashboardUpdateFeaturedQuestionsEventName]=function(e){return o({name:t.DashboardUpdateFeaturedQuestionsEventName,baseEvent:t.CustomerAction(e),info:e,category:i.TelemetryCategory.CustomerAction,loggers:t.DashboardUpdateFeaturedQuestionsLoggers})},t.DashboardDeleteDatasetEventName="PBI.Dashboard.DeleteDataset",t.DashboardDeleteDataset=a[t.DashboardDeleteDatasetEventName]=function(e){return o({name:t.DashboardDeleteDatasetEventName,baseEvent:t.CustomerAction(e),info:e,category:i.TelemetryCategory.CustomerAction,loggers:t.DashboardDeleteDatasetLoggers})},t.DashboardAddUpdateDashboardEventName="PBI.Dashboard.AddUpdateDashboard",t.DashboardAddUpdateDashboard=a[t.DashboardAddUpdateDashboardEventName]=function(e){return o({name:t.DashboardAddUpdateDashboardEventName,baseEvent:t.CustomerAction(e),info:e,category:i.TelemetryCategory.CustomerAction,loggers:t.DashboardAddUpdateDashboardLoggers})},t.DashboardInitializeNavigationPaneWorkbooksEventName="PBI.Dashboard.InitializeNavigationPaneWorkbooks",t.DashboardInitializeNavigationPaneWorkbooks=a[t.DashboardInitializeNavigationPaneWorkbooksEventName]=function(e){return o({name:t.DashboardInitializeNavigationPaneWorkbooksEventName,baseEvent:t.Verbose(e),info:e,category:i.TelemetryCategory.Verbose,loggers:t.DashboardInitializeNavigationPaneWorkbooksLoggers})},t.DashboardUpdateLocalWorkbookNeverShowExplanationEventName="PBI.Dashboard.UpdateLocalWorkbookNeverShowExplanation",t.DashboardUpdateLocalWorkbookNeverShowExplanation=a[t.DashboardUpdateLocalWorkbookNeverShowExplanationEventName]=function(e){return o({name:t.DashboardUpdateLocalWorkbookNeverShowExplanationEventName,baseEvent:t.CustomerAction(e),info:e,category:i.TelemetryCategory.CustomerAction,loggers:t.DashboardUpdateLocalWorkbookNeverShowExplanationLoggers})},t.DashboardRenameWorkbookEventName="PBI.Dashboard.RenameWorkbook",t.DashboardRenameWorkbook=a[t.DashboardRenameWorkbookEventName]=function(e){return o({name:t.DashboardRenameWorkbookEventName,baseEvent:t.CustomerAction(e),info:e,category:i.TelemetryCategory.CustomerAction,loggers:t.DashboardRenameWorkbookLoggers})},t.DashboardRemoveWorkbookEventName="PBI.Dashboard.RemoveWorkbook",t.DashboardRemoveWorkbook=a[t.DashboardRemoveWorkbookEventName]=function(e){return o({name:t.DashboardRemoveWorkbookEventName,baseEvent:t.CustomerAction(e),info:e,category:i.TelemetryCategory.CustomerAction,loggers:t.DashboardRemoveWorkbookLoggers})},t.DashboardGetWorkbookWopiAccessInformationEventName="PBI.Dashboard.GetWorkbookWopiAccessInformation",t.DashboardGetWorkbookWopiAccessInformation=a[t.DashboardGetWorkbookWopiAccessInformationEventName]=function(e){return o({name:t.DashboardGetWorkbookWopiAccessInformationEventName,baseEvent:t.CustomerAction(e),info:e,category:i.TelemetryCategory.CustomerAction,loggers:t.DashboardGetWorkbookWopiAccessInformationLoggers})},t.DashboardWorkbookEmbeddingExternalSuccessEventName="PBI.Dashboard.WorkbookEmbeddingExternalSuccess",t.DashboardWorkbookEmbeddingExternalSuccess=a[t.DashboardWorkbookEmbeddingExternalSuccessEventName]=function(e){return o({name:t.DashboardWorkbookEmbeddingExternalSuccessEventName,baseEvent:t.Verbose(e),info:e,category:i.TelemetryCategory.Verbose,loggers:t.DashboardWorkbookEmbeddingExternalSuccessLoggers})},t.DashboardWorkbookEmbeddingExternalFailureEventName="PBI.Dashboard.WorkbookEmbeddingExternalFailure",t.DashboardWorkbookEmbeddingExternalFailure=a[t.DashboardWorkbookEmbeddingExternalFailureEventName]=function(e){return o({name:t.DashboardWorkbookEmbeddingExternalFailureEventName,info:e,category:i.TelemetryCategory.CriticalError,loggers:t.DashboardWorkbookEmbeddingExternalFailureLoggers})},t.DashboardImportResourcePackagesOnLoadEventName="PBI.Dashboard.ImportResourcePackagesOnLoad",t.DashboardImportResourcePackagesOnLoad=a[t.DashboardImportResourcePackagesOnLoadEventName]=function(e){return o({name:t.DashboardImportResourcePackagesOnLoadEventName,baseEvent:t.Verbose(e),info:e,category:i.TelemetryCategory.Verbose,loggers:t.DashboardImportResourcePackagesOnLoadLoggers})},t.DashboardGetNavigationPanePackageEventName="PBI.Dashboard.GetNavigationPanePackage",t.DashboardGetNavigationPanePackage=a[t.DashboardGetNavigationPanePackageEventName]=function(e){return o({name:t.DashboardGetNavigationPanePackageEventName,baseEvent:t.Verbose(e),info:e,category:i.TelemetryCategory.Verbose,loggers:t.DashboardGetNavigationPanePackageLoggers})},t.PermissionsObjectNotFoundEventName="PBI.Permissions.ObjectNotFound",t.PermissionsObjectNotFound=a[t.PermissionsObjectNotFoundEventName]=function(e){return o({name:t.PermissionsObjectNotFoundEventName,info:e,category:i.TelemetryCategory.CriticalError,loggers:t.PermissionsObjectNotFoundLoggers})},t.AppsGetAppEventName="PBI.Apps.GetApp",t.AppsGetApp=a[t.AppsGetAppEventName]=function(e){return o({name:t.AppsGetAppEventName,baseEvent:t.Verbose(e),info:e,category:i.TelemetryCategory.Verbose,loggers:t.AppsGetAppLoggers})},t.AppsUninstallAppEventName="PBI.Apps.UninstallApp",t.AppsUninstallApp=a[t.AppsUninstallAppEventName]=function(e){return o({name:t.AppsUninstallAppEventName,baseEvent:t.CustomerAction(e),info:e,category:i.TelemetryCategory.CustomerAction,loggers:t.AppsUninstallAppLoggers})},t.TileConfigUpgradeTileConfigEventName="PBI.TileConfig.UpgradeTileConfig",t.TileConfigUpgradeTileConfig=a[t.TileConfigUpgradeTileConfigEventName]=function(e){return o({name:t.TileConfigUpgradeTileConfigEventName,baseEvent:t.Verbose(e),info:e,category:i.TelemetryCategory.Verbose,loggers:t.TileConfigUpgradeTileConfigLoggers})},t.MobileAuthoringDashboardOpenedFromFlyoutEventName="PBI.MobileAuthoring.DashboardOpenedFromFlyout",t.MobileAuthoringDashboardOpenedFromFlyout=a[t.MobileAuthoringDashboardOpenedFromFlyoutEventName]=function(e){return o({name:t.MobileAuthoringDashboardOpenedFromFlyoutEventName,baseEvent:t.CustomerAction(e),info:e,category:i.TelemetryCategory.CustomerAction,loggers:t.MobileAuthoringDashboardOpenedFromFlyoutLoggers})},t.PermissionsUpdateArtifactVisibilityEventName="PBI.Permissions.UpdateArtifactVisibility",t.PermissionsUpdateArtifactVisibility=a[t.PermissionsUpdateArtifactVisibilityEventName]=function(e){return o({name:t.PermissionsUpdateArtifactVisibilityEventName,baseEvent:t.CustomerAction(e),info:e,category:i.TelemetryCategory.CustomerAction,loggers:t.PermissionsUpdateArtifactVisibilityLoggers})},t.BaseDatapoolEventEventName="BaseDatapoolEvent",t.BaseDatapoolEvent=a[t.BaseDatapoolEventEventName]=function(e){return r({info:e,baseEvent:t.CustomerAction(e)})},t.DatapoolDeleteDatapoolEventName="PBI.Datapool.DeleteDatapool",t.DatapoolDeleteDatapool=a[t.DatapoolDeleteDatapoolEventName]=function(e){return o({name:t.DatapoolDeleteDatapoolEventName,baseEvent:t.BaseDatapoolEvent(e),info:e,category:i.TelemetryCategory.CustomerAction,loggers:t.DatapoolDeleteDatapoolLoggers})},t.DatapoolUpdatePropertiesEventName="PBI.Datapool.UpdateProperties",t.DatapoolUpdateProperties=a[t.DatapoolUpdatePropertiesEventName]=function(e){return o({name:t.DatapoolUpdatePropertiesEventName,baseEvent:t.BaseDatapoolEvent(e),info:e,category:i.TelemetryCategory.CustomerAction,loggers:t.DatapoolUpdatePropertiesLoggers})},t.HttpRequestThrottledEventName="PBI.Http.RequestThrottled",t.HttpRequestThrottled=a[t.HttpRequestThrottledEventName]=function(e){return o({name:t.HttpRequestThrottledEventName,baseEvent:t.Verbose(e),info:e,category:i.TelemetryCategory.Verbose,loggers:t.HttpRequestThrottledLoggers})},t.DatasetGetSharedDatasetsEventName="PBI.Dataset.GetSharedDatasets",t.DatasetGetSharedDatasets=a[t.DatasetGetSharedDatasetsEventName]=function(e){return o({name:t.DatasetGetSharedDatasetsEventName,baseEvent:t.Verbose(e),info:e,category:i.TelemetryCategory.Verbose,loggers:t.DatasetGetSharedDatasetsLoggers})},t.DatasetGetReadonlySharedDatasetsEventName="PBI.Dataset.GetReadonlySharedDatasets",t.DatasetGetReadonlySharedDatasets=a[t.DatasetGetReadonlySharedDatasetsEventName]=function(e){return o({name:t.DatasetGetReadonlySharedDatasetsEventName,baseEvent:t.Verbose(e),info:e,category:i.TelemetryCategory.Verbose,loggers:t.DatasetGetReadonlySharedDatasetsLoggers})},t.UserInfoPreviousTenantIdEventName="PBI.UserInfo.PreviousTenantId",t.UserInfoPreviousTenantId=a[t.UserInfoPreviousTenantIdEventName]=function(e){return o({name:t.UserInfoPreviousTenantIdEventName,baseEvent:t.Verbose(e),info:e,category:i.TelemetryCategory.Verbose,loggers:t.UserInfoPreviousTenantIdLoggers})}})(i.telemetry||(i.telemetry={}))})(powerbi=powerbi||{}),(function(e){var i,n;e=(e=e.dataServices||(e.dataServices={})).compatibility||(e.compatibility={}),i=jsCommon.ArrayExtensions,n=jsCommon.JsonExtensions,e.conformOutgoingTile=function(e){e.layoutConfig;var t=n.tryParseJSON(e.layoutConfig),t=i.extendWithId(t.layouts).withId(0);e.col=t.position.x,e.row=t.position.y,e.colSpan=t.position.width,e.rowSpan=t.position.height},e.conformOutgoingTileLayoutDescriptors=function(e){for(var t=0,o=e;t<o.length;t++){var r=o[t];r.layoutConfig;var a=n.tryParseJSON(r.layoutConfig),a=i.extendWithId(a.layouts).withId(0);r.col=a.position.x,r.row=a.position.y,r.colSpan=a.position.width,r.rowSpan=a.position.height}}})(powerbi=powerbi||{}),(function(s){!(function(e){var i=s.common.NotifyCollection,a=s.common.contracts.PackageType;e.createAppService=function(e,t,o,r){return new n(e,t,o,r)};var n=(t.prototype.ensureAppsInitialization=function(){return this.appStore.ensureAppsInitialization()},t.prototype.getAppByGUID=function(t){var e=_.find(this.appInstances,(function(e){return e.objectId===t}));return e&&e.providerContract},Object.defineProperty(t.prototype,"appInstances",{get:function(){return this.instances.items},enumerable:!1,configurable:!0}),t.prototype.onInstanceAdded=function(e){var t=this,o=this.promiseFactory;if(e.packageType!==a.AppInstance)return o.reject();var r=this.getAppInstance(e.id);return null!=r?o.resolve(r):(e.contentProviderRefId,this.appStore.loadMetadata(e.contentProviderRefId,e.id).then((function(e){return o.resolve(t.onAppAdded(e.App,_.find(e.packages,(function(e){return e.packageType===a.AppInstance}))))})))},t.prototype.getAppInstance=function(e){return this.getAppInstanceInternal(e)},t.prototype.getAppInstanceInternal=function(t){return _.find(this.instances.items,(function(e){return e.packageId===t}))},t.prototype.onAppsUpdated=function(e,t){for(var o=[],r=this.packageIdToAppMap,a=this.dataServiceModelMerger,i=this.dataServiceModelConverter,n=0;n<e.length;n++){var s=e[n],c=t[n],d=r[c.id];d?d.providerContract!==s&&a.mergeInstalledAppModel(d,s,c):d=i.convertInstalledAppModel(s,c),o.push(d)}this.instances.setItems(o),this.packageIdToAppMap=_.keyBy(o,(function(e){return e.packageId}))},t.prototype.onAppAdded=function(e,t){var o=this.packageIdToAppMap[t.id];if(o)return o;e=this.dataServiceModelConverter.convertInstalledAppModel(e,t);return this.instances.addItem(e),this.packageIdToAppMap[t.id]=e},t.prototype.isAppCategory=function(e){return this.appStore.isAppCategory(e)},t);function t(e,t,o,r){var a=this;this.promiseFactory=e,this.dataServiceModelConverter=t,this.appStore=o,this.dataServiceModelMerger=r,this.instances=new i,this.packageIdToAppMap={},this.appStore.installedApps.subscribe((function(e){a.onAppsUpdated(e.apps,e.packages)}))}e.createMockAppService=function(e){return new o(e)};var o=(r.prototype.ensureAppsInitialization=function(){return this.promiseFactory.reject()},r.prototype.appsAfterFolderSwitchPromise=function(){return this.promiseFactory.resolve()},r.prototype.getAppByGUID=function(e){return null},r.prototype.isAppCategory=function(e){return!1},r.prototype.onInstanceAdded=function(e){return this.promiseFactory.reject(null)},r.prototype.getAppInstance=function(e){return null},r);function r(e){this.promiseFactory=e}})(s.dataServices||(s.dataServices={}))})(powerbi=powerbi||{}),(function(t){!(function(){(t.dataServices||(t.dataServices={})).createPermissionRefreshService=function(e,t,o,r){return new a(e,t,o,r)};var a=(e.prototype.refreshDashboardTilePermissionsUponLoad=function(b){return __awaiter(this,void 0,t.Promise,(function(){var t,o,r,a,i,n,s,c,d,l,p,u,h=this;return __generator(this,(function(e){switch(e.label){case 0:return(b.isLoaded,b.contract,t=this.promiseFactory.resolve(null),o=b.contract&&b.contract.tiles,_.isEmpty(o))?[2,t]:(r=this.userInfo,a=this.dashboardDataService,i=b.id,(n=this.inFlightSyncRequests[b.id])?[2,n.promise]:(s=20,r.isUserMetadataRefreshed||!_.some(o,(function(e){return e.errorCode===s}))||a.dropDashboardfromMemoryIfNotActive(i)?[2,t]:(n=this.inFlightSyncRequests[b.id]=this.promiseFactory.defer(),c=function(){return delete h.inFlightSyncRequests[b.id],n.resolve(null),n.promise},[4,this.userInfo.userMetadataPromise])));case 1:for(e.sent(),d=[],l=0,p=o;l<p.length;l++)(u=p[l]).errorCode===s&&d.push(u.id);return _.isEmpty(d)||a.dropDashboardfromMemoryIfNotActive(i)?[2,c()]:[4,this.dashboardSyncService.onTilesAddedOrUpdated(i,d)];case 2:return e.sent(),[2,c()]}}))}))},e.prototype.refreshDashboardTiles=function(e){for(var t=[],o=this.dashboardDataService,r=this.dashboardSyncService,a=0,i=e;a<i.length;a++){var n=i[a];o.dropDashboardfromMemoryIfNotActive(n)||t.push(r.addOrDeepEditDashboard(n))}return this.promiseFactory.allSettled(t)},e);function e(e,t,o,r){this.userInfo=e,this.dashboardSyncService=t,this.dashboardDataService=o,this.promiseFactory=r,this.inFlightSyncRequests={}}})()})(powerbi=powerbi||{}),(function(a){!(function(e){var t=a.common.NotifyCollection;e.createDashboardCollectionService=function(){return new o};var o=(Object.defineProperty(r.prototype,"dashboards",{get:function(){return this.collection.items},set:function(e){this.collection.setItems(e),this.map=_.keyBy(e,(function(e){return e.objectId}))},enumerable:!1,configurable:!0}),r.prototype.findDashboardByObjectId=function(e){return this.map[e]},r.prototype.onAdded=function(e){for(var t=0,o=this.listeners;t<o.length;t++){var r=o[t];r.onDashboardAdded&&r.onDashboardAdded(e)}},r.prototype.onDeleted=function(e){for(var t=0,o=this.listeners;t<o.length;t++){var r=o[t];r.onDashboardDeleted&&r.onDashboardDeleted(e)}},r.prototype.onReset=function(){for(var e=0,t=this.listeners;e<t.length;e++){var o=t[e];o.onDashboardsReset&&o.onDashboardsReset()}},r.prototype.addDashboard=function(e){this.collection.addItem(e),this.map[e.objectId]=e},r.prototype.removeDashboard=function(t){var e=this.collection.deleteItems((function(e){return e.id===t}));e.length,0!==e.length&&delete this.map[_.first(e).objectId]},r.prototype.subscribe=function(e){this.listeners.length<1&&this.collection.subscribe(this),this.listeners.push(e)},r.prototype.unsubscribe=function(e){_.pull(this.listeners,e),this.listeners.length<1&&this.collection.unsubscribe(this)},r);function r(){this.listeners=[],this.collection=new t,this.map={}}})(a.dataServices||(a.dataServices={}))})(powerbi=powerbi||{}),(function(t){!(function(r){r.createDashboardDataService=function(e,t,o,r,a,i,n,s,c,d,l,p,u,h,b,f){return new v(e,t,o,r,a,i,n,s,c,d,l,p,u,b,f)};var v=(e.prototype.registerRefreshStateListener=function(e){_.includes(this.refreshStateListeners,e)||this.refreshStateListeners.push(e)},e.prototype.unregisterRefreshStateListener=function(e){_.remove(this.refreshStateListeners,e)},e.prototype.onDashboardTileRefreshStarted=function(e){this.activeDashboardId===e&&0===this.refreshState&&this.notify(1,e)},e.prototype.onDashboardTileRefreshFinished=function(e){var t=this;this.activeDashboardId===e&&1===this.refreshState&&(this.notify(2,e),this.$timeout((function(){return t.notify(0,e)}),3e3))},e.prototype.notify=function(e,t){this.refreshState=e;for(var o=0,r=this.refreshStateListeners;o<r.length;o++)r[o].onStateChange(this.refreshState,t)},Object.defineProperty(e.prototype,"dashboards",{get:function(){return this.dashboardCollectionService.dashboards},set:function(e){this.dashboardCollectionService.dashboards=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"activeDashboard",{get:function(){return this.activeDashboardObjectId?this.findDashboardByGUID(this.activeDashboardObjectId):null},set:function(e){e?(this.activeDashboardId=e.id,this.activeDashboardObjectId=e.objectId):(this.activeDashboardId=-1,this.activeDashboardObjectId=null),this.dashboardStore.select(e?e.contract:null),this.refreshState=0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"activeDashboardContainsQnaSupportedModel",{get:function(){return!_.isEmpty(this.activeDashboardQnaModels)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"displayName",{get:function(){return this.activeDashboard?this.activeDashboard.displayName:""},enumerable:!1,configurable:!0}),e.prototype.addDashboard=function(e){e&&(this.findDashboardByGUID(e.objectId)||this.dashboardCollectionService.addDashboard(e))},e.prototype.deleteTile=function(e,t){var r=this,a=this.promiseFactory.defer(),i=this.findDashboard(e);return i?this.tryUpdateTile(i,t,(function(e,t){var o;0<=e&&0<=t?(o=i.contract.tiles[e],i.contract.tiles.splice(e,1),i.tiles.splice(t,1),r.updateQnAEnabledWhenNoTilesOnDashboard(i),i.hasModel(o.modelId)||r.dashboardHttpService.addDashboardRequestToBatch(r.promiseFactory,i.id,!1,0).done((function(e){r.modelMerger.mergeDashboardShallow(i,e.dashboards[0]),r.updateActiveDashboardModels(),a.resolve(null)})).fail((function(){a.reject()}))):a.resolve(null)})):a.resolve(null),a.promise},e.prototype.dropDashboardfromMemoryIfNotActive=function(e){var t=this.activeDashboard;return(!t||t.id!==e)&&(this.findDashboard(e)&&this.dashboardStore.unloadDashboardTiles(e),!0)},e.prototype.findDashboard=function(t){return _.find(this.dashboards,(function(e){return e.id===t}))},e.prototype.findDashboardByGUID=function(e){return this.dashboardCollectionService.findDashboardByObjectId(e)},e.prototype.findDashboardsByPackageId=function(t){var e=this.dashboards;if(e)return _.filter(e,(function(e){return!(!e.contract||!e.contract.originalPackageId)&&e.contract.originalPackageId===t}))},e.prototype.retrieveDashboardForApp=function(t,o){return _.find(this.dashboards,(function(e){return e.getUniquePackageId()===t&&e.contract.originalDashboardObjectId===o}))},e.prototype.tryUpdateTile=function(e,t,o){var r;e&&(r=e.getTileContractIndex(t),t=e.getTileIndex(t),e.contract.tiles.length,e.tiles.length,o(r,t),e.scheduleDelayedLayout(this.activeDashboard!==e))},e.prototype.updateActiveDashboardModels=function(){var e=this.activeDashboard&&this.activeDashboard.contract;this.updateActiveDashboardModelsInternal(e)},e.prototype.updateActiveDashboardModelsInternal=function(o){return __awaiter(this,void 0,t.Promise,(function(){var t=this;return __generator(this,(function(e){switch(e.label){case 0:return o=o||this.activeDashboard&&this.activeDashboard.contract,[4,this.modelService.modelsPromise];case 1:return e.sent(),this.activeDashboardModels=r.DashboardUtils.getDashboardModels(o,this.modelService.getModelContracts()),this.activeDashboardQnaModels=_.filter(this.activeDashboardModels,(function(e){return r.DashboardUtils.isQnaSupportedModel(e)&&t.permissionService.isExplorableModelContract(e)})),this.updateIsQnaEnabled(),[2]}}))}))},e.prototype.isActiveDashboardModelRefreshDisabled=function(){var e=this.activeDashboardModels;if(_.isEmpty(e))return!1;for(var t=this.modelService,o=0,r=e;o<r.length;o++){var a=r[o],a=t.findModel(a.id,a.packageId);if(a&&a.isRefreshDisabledDueToInactivity())return!0}return!1},e.prototype.updateIsQnaEnabled=function(){this.activeDashboard?void 0!==this.activeDashboard.qnaEnabled?this.isQnaEnabled=this.activeDashboard.qnaEnabled:this.isQnaEnabled=this.activeDashboardContainsQnaSupportedModel:this.isQnaEnabled=!1},e.prototype.onModelUpdated=function(e,t){this.modelService.findModel(e,t)&&this.updateActiveDashboardModels()},e.prototype.getDashboards=function(){var e=this;return this.dashboardsDeferred.promise.then((function(){return e.dashboards}))},e.prototype.setQnaEnabled=function(e,t){e=this.findDashboard(e);e&&(e.qnaEnabled=t,this.updateIsQnaEnabled())},e.prototype.subscribe=function(e){this.dashboardCollectionService.subscribe(e)},e.prototype.unsubscribe=function(e){this.dashboardCollectionService.unsubscribe(e)},e.prototype.onDeleted=function(e){this.dashboardCollectionService.onDeleted(e)},e.prototype.dashboardsAfterFolderSwitchPromise=function(){return this.dashboardsAfterFolderSwitchDeferred.promise},e.prototype.updateQnAEnabledWhenNoTilesOnDashboard=function(e){_.isEmpty(e.tiles)&&(e.qnaEnabled=!1)},e);function e(e,t,o,r,a,n,i,s,c,d,l,p,u,h,b){var f=this;this.dashboardHttpService=e,this.groupStore=t,this.promiseFactory=o,this.modelConverter=r,this.modelMerger=a,this.modelService=n,this.dashboardCollectionService=i,this.$timeout=s,this.dashboardStore=c,this.appMetadataService=d,this.permissionService=l,this.datasetRefreshListener=u,this.reportStore=b,this.refreshStateListeners=[],this.dashboardCollectionService=i,this.dashboardsDeferred=o.defer(),this.isQnaEnabled=!1,this.datasetRefreshListener.addModelUpdateListener(this),this.refreshState=0,this.appMetadataService.getAppMetadata().then((function(){f.dashboardStore.selectedDashboard.subscribe((function(e){f.activeDashboardId=e?e.id:f.activeDashboardId,f.activeDashboardObjectId=e?e.objectId:f.activeDashboardObjectId,f.updateActiveDashboardModelsInternal(e)}))})),this.dashboardsAfterFolderSwitchDeferred=this.promiseFactory.defer(),this.appMetadataService.getAppMetadata().then((function(){f.groupStore.selectedFolderId$.subscribe((function(){f.dashboardsAfterFolderSwitchDeferred.resolve(),f.dashboardsAfterFolderSwitchDeferred=f.promiseFactory.defer()})),p.ensureReportsInitialization().then((function(){f.dashboardStore.dashboards.subscribe((function(e){var o,r,a,i=_.keyBy(f.dashboards,(function(e){return e&&e.objectId}));f.dashboards=_.filter(e,(function(e){return!!e})).map((function(e){var t=i[e.objectId];return t?(f.modelMerger.mergeDashboardShallow(t,e),t):(_.isEmpty(o)&&(o=_.map(n.models,(function(e){return e.contract})),f.reportStore.reports.subscribe((function(e){r=e})),a=_.map(h.workbooks,(function(e){return e.contract}))),f.modelConverter.convertDashboard(e,o,r,a))})),f.dashboardsAfterFolderSwitchDeferred.resolve(),f.dashboardsDeferred.resolve(f)}))}))}),(function(){f.dashboardsDeferred.reject(),f.dashboardsAfterFolderSwitchDeferred.reject()}))}r.DashboardDataService=v})(t.dataServices||(t.dataServices={}))})(powerbi=powerbi||{}),(function(m){!(function(i){var n=m.dataServices.contracts.TileType;i.createDashboarSyncService=function(e,t,o,r,a,i,n,s,c,d,l,p,u,h,b,f){return new v(e,t,o,r,a,i,n,s,c,d,l,p,u,h,b,f)};var v=(e.prototype.onTilesAddedOrUpdated=function(e,t){var o=this.promiseFactory;return this.customTilesUpdate?(this.customTilesUpdate(e,t),o.resolve(null)):this.dashboardDataService.dropDashboardfromMemoryIfNotActive(e)?o.resolve(null):void this.addOrUpdateActiveDashboardTiles(e,t)},e.prototype.addOrDeepEditDashboard=function(t){var o=this,r=this.telemetryService.startEvent(m.telemetry.DashboardAddUpdateDashboard),a=this.promiseFactory.defer();return this.dashboardHttpService.addDashboardRequestToBatch(this.promiseFactory,t,!1,0).done((function(e){o.addOrUpdateDashboard(e),o.rootScope.$emit(i.constants.updateDashboardContainerEventName,[e]),o.dashboardDataService.onDashboardTileRefreshFinished(t),r.resolve(),a.resolve(null)})).fail((function(){r.reject(),a.reject(null)})),a.promise},e.prototype.onDashboardShallowEdit=function(e){var t=e.dashboards[0],e=this.dashboardDataService.findDashboard(t.id);e&&(this.modelMerger.mergeDashboardShallow(e,t),this.rootScope.$emit(i.constants.onDashboardShallowEditEventName,e,t))},e.prototype.onDashboardDeepEdit=function(e){this.rootScope.$emit(i.constants.addOrUpdateDashboardEventName,e),this.rootScope.$emit(i.constants.updateDashboardContainerEventName,[e]),this.dashboardDataService.onDashboardTileRefreshFinished(e.dashboards[0].id)},e.prototype.addOrUpdateCustomVisualTile=function(e,t,o){var r=this;this.isResourcePackageInCache(e)?this.addOrUpdateTile(t,o,this.modelService.getModelContracts()):this.resourcePackageListenerService.getAndLoadVisualPlugin(e).then((function(){r.addOrUpdateTile(t,o,r.modelService.getModelContracts())}))},e.prototype.addOrUpdateDashboard=function(e){var t=e.dashboards[0];this.dashboardStore.addOrUpdate(t),this.rootScope.$emit(i.constants.addOrUpdateDashboardEventName,e);e=this.modelConverter.convertDashboard(t,e.models,e.reports);this.dashboardDataService.onDashboardTileRefreshFinished(e.id)},e.prototype.addOrUpdateTile=function(a,i,n,s){var c=this;a&&(n=n||[],this.updateModelsIfRequired(a,i),this.dashboardDataService.tryUpdateTile(a,i.id,(function(e,t){var o=c.reportService.findReport(i.reportId),r=null;0<=e?(a.contract.tiles[e]=i,0<=t&&(r=a.tiles[t],c.modelMerger.mergeTile(r,i,n,null,c.workbookService.getWorkbookContracts(),c.reportService.reports))):(r=s||c.modelConverter.convertTile(i,n,null,c.workbookService.getWorkbookContracts()),a.contract.tiles.push(i),a.tiles.push(r)),r&&(r.invalidateLayout(),o&&(r.report=o))})))},e.prototype.registerAndUpdateTile=function(e,t){var o=this.dashboardDataService.findDashboard(e);if(t.resourcePackageIds&&0<t.resourcePackageIds.length)for(var r=t.resourcePackageIds.length,a=0;a<r;++a)this.addOrUpdateCustomVisualTile(t.resourcePackageIds[a],o,t);else this.featureSwitchService.featureSwitches.consumePublicCvsWithoutRps?this.ensurePublicCVsAndAddOrUpdateTile(o,t):this.addOrUpdateTile(o,t,this.modelService.getModelContracts())},e.prototype.ensurePublicCVsAndAddOrUpdateTile=function(e,t){var o,r=this,a=this.modelConverter.convertTile(t,this.modelService.getModelContracts(),null,this.workbookService.getWorkbookContracts()),i=a.type===n.composite&&(null===(o=null===(o=null===(o=null===(o=null===(o=a.config)||void 0===o?void 0:o.visualContainer)||void 0===o?void 0:o.$visualContainer)||void 0===o?void 0:o.config)||void 0===o?void 0:o.singleVisual)||void 0===o?void 0:o.visualType);i?this.publicCustomVisualService.getPublicVisualTypes([i]).then((function(e){if(e[0]){e=r.publicCustomVisualService.createPublicResourcePackageByName(i);return r.resourcePackageListenerService.loadVisualPlugin([e])}})).finally((function(){r.addOrUpdateTile(e,t,r.modelService.getModelContracts(),a)})):this.addOrUpdateTile(e,t,this.modelService.getModelContracts(),a)},e.prototype.addOrUpdateActiveDashboardTiles=function(a,e,i){var n=this;if(this.dashboardDataService.selectedDashboardTile){var t=(e=0===e.length?this.dashboardDataService.activeDashboard.tiles.map((function(e){return e.id})):e).indexOf(this.dashboardDataService.selectedDashboardTile.id);if(0<=t&&(e.splice(t,1),0===e.length))return this.promiseFactory.resolve(null)}return this.dashboardHttpService.batchGetTiles(a,e,void 0,!0).then((function(e){var t=e.data;if(!_.isEmpty(t))for(var o=0,r=t.length;o<r;++o)n.registerAndUpdateTile(a,t[o]);i&&n.dashboardDataService.onDashboardTileRefreshFinished(a)}))},e.prototype.updateModelsIfRequired=function(t,e){var o=this,r=t.getTileContractIndex(e.id),a=-1!==r&&2===e.publishState&&1===t.contract.tiles[r].publishState;!a&&t.hasModel(e.modelId)||this.dashboardHttpService.addDashboardRequestToBatch(this.promiseFactory,t.id,!1,0).done((function(e){a&&(o.modelMerger.mergeDashboardTiles(t,e),o.rootScope.$emit(i.constants.mergeDashboardContainerModelsReportsAndPackagesEventName,e),o.modelMerger.mergeModelContentProviderId(e.models,e.packages)),o.modelMerger.mergeDashboardShallow(t,e.dashboards[0]),o.dashboardDataService.updateActiveDashboardModels()}))},e.prototype.isResourcePackageInCache=function(t){var e=this.resourcePackagesService.getAllPackages();return _.some(e,(function(e){return e.id===t}))},e);function e(e,t,o,r,a,i,n,s,c,d,l,p,u,h,b,f){var v=this;this.rootScope=e,this.dashboardDataService=t,this.dashboardHttpService=o,this.modelConverter=r,this.modelMerger=a,this.modelService=i,this.promiseFactory=n,this.reportService=s,this.resourcePackageListenerService=c,this.resourcePackagesService=d,this.telemetryService=l,this.workbookService=p,this.dashboardStore=u,this.globalEventBridge=h,this.featureSwitchService=b,this.publicCustomVisualService=f,this.globalEventBridge.createChannelSubscriptionManager().subscribe(m.dataServices.events.syncServiceDashboardEditedEvent,(function(e,t){return v.onDashboardShallowEdit(t)})).subscribe(m.dataServices.events.syncServiceDashboardDeepEditedEvent,(function(e,t){return v.onDashboardDeepEdit(t)})).subscribe(m.dataServices.events.syncServiceTilesAddedOrUpdated,(function(e,t){return v.addOrUpdateActiveDashboardTiles(t.dashboardId,t.tileIds,t.isDataChange)})).subscribe(m.dataServices.events.syncServiceTileDeleted,(function(e,t){return v.dashboardDataService.deleteTile(t.dashboardId,t.tileId)}))}i.DashboardSyncService=v})(m.dataServices||(m.dataServices={}))})(powerbi=powerbi||{}),(function(n){!(function(e){var a=window;e.createHostAppMetadataService=function(e,t,o,r,a,i,n){return new s(e,t,o,r,a,i,n)};var s=(i.prototype.getAppMetadata=function(){return this.getAppMetadataDeferred.promise},i.prototype.requestAppMetadata=function(e,t){var o=this,r=this.telemetryService.startEvent(this.eventFactory),t=this.httpService.powerbiRequestOptions(r.event,"DashboardHostGetAppMetadata",{isAdminRequest:t});t.params={preferReadOnlySession:"true"},this.httpService.get("powerbi/metadata/app",t).then((function(e){e=e.data;a.initialDashboardContainer=e,o.editableFeatureSwitchService.registerFeatureSwitches(e.featureSwitches),o.getAppMetadataDeferred.resolve(e),r.resolve()}),(function(e){o.getAppMetadataDeferred.reject(null),r.reject(n.errorDetailsHelper.getTelemetryErrorDetails(e.error,e.status)),o.errorCallback&&o.errorCallback(i.pageRefreshErrorMessage)}))},i.pageRefreshErrorMessage="GetAppMetadataRequestFailed",i);function i(e,t,o,r,a,i,n){this.promiseFactory=e,this.telemetryService=t,this.eventFactory=o,this.editableFeatureSwitchService=r,this.httpService=a,this.errorCallback=i,this.getAppMetadataDeferred=this.promiseFactory.defer(),this.requestAppMetadata(r,n)}})(n.dataServices||(n.dataServices={}))})(powerbi=powerbi||{}),(function(a){!(function(e){var t=a.common.NotifyCollection;e.createPackageCollectionService=function(){return new o};var o=(Object.defineProperty(r.prototype,"packages",{get:function(){return this.collection.items},set:function(e){this.collection.setItems(e),this.idToPackageMap=_.keyBy(e,(function(e){return e.id}))},enumerable:!1,configurable:!0}),r.prototype.findPackage=function(e){return this.idToPackageMap[e]},r.prototype.subscribe=function(e){_.isEmpty(this.listeners)&&this.subscribeToCollectionEvents(),this.listeners.push(e)},r.prototype.unsubscribe=function(e){_.remove(this.listeners,e),_.isEmpty(this.listeners)&&this.unsubscribeToCollectionEvents()},r.prototype.subscribeToCollectionEvents=function(){var e=this;this.collectionListener={onAdded:function(t){return e.notifyListeners((function(e){return e.onPackageAdded(t)}))},onDeleted:function(t){return e.notifyListeners((function(e){return e.onPackageDeleted(t)}))},onReset:function(){return e.notifyListeners((function(e){return e.onPackagesReset()}))}},this.collection.subscribe(this.collectionListener)},r.prototype.unsubscribeToCollectionEvents=function(){this.collection.unsubscribe(this.collectionListener),this.collectionListener=null},r.prototype.notifyListeners=function(e){var t=this.listeners;if(!_.isEmpty(t)&&e)for(var o=t.length-1;0<=o;o--)e(t[o])},r);function r(){this.collection=new t,this.listeners=[],this.packages=[]}})(a.dataServices||(a.dataServices={}))})(powerbi=powerbi||{}),(function(a){!(function(e){var t=jsCommon.EnumExtensions,o=a.common.contracts.PackageType;e.createPackageService=function(e,t,o,r,a){return new i(e,t,o,r,a)};var i=(r.prototype.ensurePackagesInitialization=function(){return this.packagesInitializationDeferred.promise},Object.defineProperty(r.prototype,"packages",{get:function(){return this.packageCollectionService.packages},enumerable:!1,configurable:!0}),r.prototype.findPackage=function(e){return this.packageCollectionService.findPackage(e)},r.prototype.getWorkbookStorageProvider=function(e){e=this.findPackage(e);return e&&e.contract?e.contract.storageProviderType:null},r.prototype.getWorkbookContentProvider=function(e){e=this.findPackage(e);return e?e.contentProviderId:null},r.prototype.getInstalledOrgPackage=function(t){return _.find(this.packages,(function(e){return e.contract&&e.contract.contentProviderRefId&&e.contract.contentProviderRefId===t&&e.packageType===o.AppInstance}))},r.prototype.isLocalWorkbook=function(e){e=this.findPackage(e);return e&&e.contract&&0===e.contract.storageProviderType},r.prototype.isRefreshNowEnabledForWorkbook=function(e){if(this.asyncFeatureSwitchService.featureSwitches.disallowWorkbookRefresh)return!1;if(!e)return!1;if(!t.hasFlag(e.getPermissions(),2))return!1;e=this.findPackage(e.packageId);return!(!e||!e.contract)},r.prototype.initPackages=function(){var o=this;this.packagesInitializationDeferred=this.promiseFactory.defer(),this.packageStore.packages.subscribe((function(e){e=e.map((function(t){var e=_.find(o.packages,(function(e){return e.id===t.id}));return e?(e.contract!==t&&o.mergePackage(e,t),e):o.packageModelConverter.convertPackage(t)}));o.packageCollectionService.packages=e})),this.packagesInitializationDeferred.resolve(this)},r.prototype.mergePackage=function(e,t){e&&t&&(e.contract=t,e.contentProviderId=t.contentProviderId,e.id=t.id,e.lastRefreshTime=t.lastRefreshTime,e.latestVersion=t.latestVersion,e.name=t.name,e.publishOrRefreshStatus=t.publishOrRefreshStatus,e.version=t.version,e.originalPackageId=t.originalPackageId||e.originalPackageId,e.packageType=t.packageType||e.packageType,e.getPermissionsCallback=function(){return t&&t.permissions})},r);function r(e,t,o,r,a){this.packageModelConverter=e,this.packageCollectionService=t,this.promiseFactory=o,this.asyncFeatureSwitchService=r,this.packageStore=a,this.initPackages()}e.PackageService=i})(a.dataServices||(a.dataServices={}))})(powerbi=powerbi||{}),(function(o){!(function(e){var c=o.visualHost.utils.ResourcePackageUtils;e.createResourcePackageListenerService=function(e,t,o,r){return new a(e,t,o,r)};var a=(t.prototype.getResourcePackageByResourceId=function(o){var r=this,a=this.promiseFactory.defer(),e=this.resourcePackageService.getPackageById(o);if(e)return a.resolve([e]),a.promise;e=this.httpService.powerbiRequestOptions(null,"GetResourcePackageByResourceId");return this.httpService.post("/powerbi/metadata/resourcePackage",[o],e).then((function(e){var t=r.resourcePackageService.getPackageById(o);t?a.resolve([t]):(r.resourcePackageService.registerPackages(e.data),a.resolve(e.data))}),(function(e){e.error&&e.error.message,a.reject()})),a.promise},t.prototype.loadVisualPlugin=function(e){var t=this.promiseFactory.defer();return this.resourcePackageService.registerPackages(e),this.visualPluginService.ensurePlugins(e).then((function(){return t.resolve(e)}),(function(){return t.reject()})),t.promise},t.prototype.getAndLoadVisualPlugin=function(e){var t=this,o=this.promiseFactory.defer();return this.getResourcePackageByResourceId(e).then((function(e){t.visualPluginService.ensurePlugins(e).then((function(){return o.resolve(e)}),(function(){return o.reject()}))}),(function(){return o.reject()})),o.promise},t.prototype.getAndLoadVisualPluginsForDashboard=function(e){var t=this,e=this.getAllRequiredResourcePackageIds(e);return this.loadRequiredResourcePackagesAndVisualPlugins(e).then((function(e){e=_.chain(e).filter((function(e){return 0===e.type})).map((function(e){return t.getCustomVisualTypesFromResourcePackages(e.value)})).flatten(!1).uniq().value();return t.promiseFactory.resolve(e)}))},t.prototype.getCustomVisualTypesFromResourcePackages=function(e){return c.getCustomVisualTypes(e)},t.prototype.getLoadedCustomVisualTypesForDashboard=function(e){var t=[];if(e&&e.tiles)for(var o=0,r=e.tiles;o<r.length;o++){var a=r[o].contract.resourcePackageIds;if(a)for(var i=0,n=a;i<n.length;i++){var s=n[i],s=this.resourcePackageService.getPackageById(s);c.isCustomVisualResourcePackage(s)&&t.push(s.name)}}return _.uniq(t)},t.prototype.getAllRequiredResourcePackageIds=function(e){var t=[];if(e&&e.tiles)for(var o=0,r=e.tiles;o<r.length;o++){var a=r[o].contract.resourcePackageIds;if(a)for(var i=0,n=a;i<n.length;i++){var s=n[i];t.push(s)}}return _(t).uniq().value()},t.prototype.loadRequiredResourcePackagesAndVisualPlugins=function(e){for(var t=[],o=0,r=e;o<r.length;o++){var a=r[o];t.push(this.getAndLoadVisualPlugin(a))}return this.promiseFactory.allSettled(t)},t);function t(e,t,o,r){this.httpService=e,this.resourcePackageService=t,this.promiseFactory=o,this.visualPluginService=r}e.ResourcePackageListenerService=a})(o.dataServices||(o.dataServices={}))})(powerbi=powerbi||{}),(function(a){!(function(o){var r=a.common.helpers.UserInfoHelper;o.createReportService=function(e,t,o,r,a,i,n){return new s(e,t,o,r,a,i,n)};var s=(e.prototype.subscribeReports=function(){var o=this;this.appMetadataService.getAppMetadata().then((function(){o.groupStore.selectedFolderId$.subscribe((function(){o.reportsAfterFolderSwitchDeferred.resolve(),o.reportsAfterFolderSwitchDeferred=o.promiseFactory.defer()})),o.reportStore.reports.subscribe((function(e){o.reportCollectionService.reports=e.map((function(t){var e=_.find(o.reportCollectionService.reports,(function(e){return e.objectId===t.objectId}));return e?(o.mergeReport(e,t),e):o.modelConverter.convertReport(t)})),o.reportsDeferred.resolve(o),o.reportsAfterFolderSwitchDeferred.resolve()})),o.reportStore.selectedReport.subscribe((function(e){o.currentActiveReport=e?{id:e.id,displayName:e.displayName,guid:e.objectId,modelId:e.modelId}:null}))}))},e.prototype.ensureReportsInitialization=function(){return this.reportsDeferred.promise},Object.defineProperty(e.prototype,"reports",{get:function(){return this.reportCollectionService.reports},set:function(e){this.reportCollectionService.reports=e},enumerable:!1,configurable:!0}),e.prototype.getReports=function(){return this.reportsDeferred.promise.then((function(e){return e.reports}))},e.prototype.onReportDeleted=function(e){e=this.findReport(e);e&&(this.reportStore.delete(e.contract,!0),this.reportCollectionService.onDeleted(e))},e.prototype.getReportContracts=function(){return this.reports.map((function(e){return e.contract}))},e.prototype.addReport=function(e){this.reportCollectionService.addReport(e),this.reportStore.ensure(e.contract)},e.prototype.deleteReport=function(e){var t=this.findReportByGUID(e),e=this.telemetryService.startEvent(a.telemetry.DashboardDeleteReport,{reportType:t?o.ContractUtils.reportTypeToString(t.reportType):"",reportId:t?t.id:-1,reportObjectId:t?t.objectId:void 0});this.reportStore.delete(t,!1,e),this.reportCollectionService.onDeleted(t)},e.prototype.getReportModels=function(e){var t,o=this;return e?(this.reportStore.getReportsByGroupId(e).subscribe((function(e){t=e.map((function(e){return o.modelConverter.convertReport(e)}))})),t):this.reports},e.prototype.findReport=function(t,e){return null!=t?_.find(this.getReportModels(e),(function(e){return e.id===t})):null},e.prototype.findReportByGUID=function(t,e){return null!=t?_.find(this.getReportModels(e),(function(e){return e.objectId===t})):null},e.prototype.findReportsByPackageId=function(t){return _.filter(this.reports,(function(e){return e.packageId===t}))},e.prototype.subscribe=function(e){this.reportCollectionService.subscribe(e)},e.prototype.unsubscribe=function(e){this.reportCollectionService.unsubscribe(e)},e.prototype.mergeArtifactOwnerInfo=function(e,t){e.ownerFullname=r.getFullName(t.givenName,t.familyName),e.ownerMail=t.emailAddress,t.userObjectId&&(e.ownerUserObjectId=t.userObjectId),t.groupObjectId&&(e.ownerGroupObjectId=t.groupObjectId),e.contract.ownerInfo||(e.contract.ownerInfo=t)},e.prototype.mergeReport=function(e,t){e&&t&&(e.contract=t,e.id=t.id||e.id,e.objectId=t.objectId||e.objectId,e.modelId=t.modelId||e.modelId,e.reportUrl=t.reportUrl||e.reportUrl,e.getPermissionsCallback=function(){return t.permissions},e.packagePublishStatus=t.packagePublishStatus||e.packagePublishStatus,e.name=t.name||e.name,e.displayName=t.displayName||e.displayName,e.description=t.description||e.description,e.fileName=t.fileName||e.fileName,e.packageId=t.packageId||e.packageId,e.packageVersion=t.packageVersion||e.packageVersion,e.contentProviderId=t.contentProviderId||e.contentProviderId,e.isHidden=t.isHidden,t.ownerInfo&&this.mergeArtifactOwnerInfo(e,t.ownerInfo))},e);function e(e,t,o,r,a,i,n){this.telemetryService=e,this.modelConverter=t,this.appMetadataService=o,this.promiseFactory=r,this.reportCollectionService=a,this.reportStore=i,this.groupStore=n,this.reportsDeferred=this.promiseFactory.defer(),this.reportsAfterFolderSwitchDeferred=this.promiseFactory.defer(),this.subscribeReports()}o.ReportService=s})(a.dataServices||(a.dataServices={}))})(powerbi=powerbi||{}),(function(a){!(function(e){var t=a.common.NotifyCollection;e.createReportCollectionService=function(){return new o};var o=(Object.defineProperty(r.prototype,"reports",{get:function(){return this.collection.items},set:function(e){this.collection.setItems(e)},enumerable:!1,configurable:!0}),r.prototype.findReportContract=function(t){return _.find(this.reports,(function(e){return e.id===t})).contract},r.prototype.onAdded=function(e){for(var t=0,o=this.listeners;t<o.length;t++){var r=o[t];r.onReportAdded&&r.onReportAdded(e)}},r.prototype.onDeleted=function(e){for(var t=0,o=this.listeners;t<o.length;t++){var r=o[t];r.onReportDeleted&&r.onReportDeleted(e)}},r.prototype.onReset=function(){for(var e=0,t=this.listeners;e<t.length;e++){var o=t[e];o.onReportsReset&&o.onReportsReset()}},r.prototype.addReport=function(e){this.collection.addItem(e)},r.prototype.removeReport=function(t){this.collection.deleteItems((function(e){return e.id===t}))},r.prototype.subscribe=function(e){this.listeners.length<1&&this.collection.subscribe(this),this.listeners.push(e)},r.prototype.unsubscribe=function(e){_.pull(this.listeners,e),this.listeners.length<1&&this.collection.unsubscribe(this)},r);function r(){this.listeners=[],this.collection=new t}})(a.dataServices||(a.dataServices={}))})(powerbi=powerbi||{}),(function(i){!(function(e){var o=i.common.models.Model,t=i.common.NotifyCollection;e.createModelCollectionService=function(){return new r};var r=(Object.defineProperty(a.prototype,"models",{get:function(){return this.collection.items},set:function(e){this.collection.setItems(e),this.modelsMap={};for(var t=0,o=e;t<o.length;t++){var r=o[t];this.modelsMap[r.uniqueId]=r}},enumerable:!1,configurable:!0}),a.prototype.getModelContracts=function(){return _.map(this.models,(function(e){return e.contract}))},a.prototype.onAdded=function(e){for(var t=0,o=this.listeners;t<o.length;t++){var r=o[t];r.onModelAdded&&r.onModelAdded(e)}},a.prototype.onDeleted=function(e){for(var t=0,o=this.listeners;t<o.length;t++){var r=o[t];r.onModelDeleted&&r.onModelDeleted(e)}},a.prototype.onReset=function(){for(var e=0,t=this.listeners;e<t.length;e++){var o=t[e];o.onModelsReset&&o.onModelsReset()}},a.prototype.findModel=function(e,t){return this.modelsMap[o.getUniqueId(e,t)]},a.prototype.addModel=function(e){this.collection.addItem(e),this.modelsMap[e.uniqueId]=e},a.prototype.subscribe=function(e){this.listeners.length<1&&this.collection.subscribe(this),this.listeners.push(e)},a.prototype.unsubscribe=function(e){_.pull(this.listeners,e),this.listeners.length<1&&this.collection.unsubscribe(this)},a);function a(){this.listeners=[],this.collection=new t,this.modelsMap={}}})(i.dataServices||(i.dataServices={}))})(powerbi=powerbi||{}),(function(n){!(function(o){var a=jsCommon.EnumExtensions,r=n.common.helpers.ModelConverterHelper;o.createModelService=function(e,t,o,r,a,i,n,s,c,d){return new l(e,t,o,r,a,i,n,s,c,d)};var l=(Object.defineProperty(e.prototype,"models",{get:function(){return this.modelCollectionService.models},set:function(e){this.modelCollectionService.models=e},enumerable:!1,configurable:!0}),e.prototype.pushModel=function(e){this.modelCollectionService.addModel(e)},Object.defineProperty(e.prototype,"modelsPromise",{get:function(){return this._modelsDeferred.promise},enumerable:!1,configurable:!0}),e.prototype.updateDatasetCollection=function(e){var t=[];if(!_.isEmpty(e))for(var o=0,r=e.length;o<r;++o)t.push(this.dataSetConverter.convertModel(e[o]));this.modelCollectionService.models=t},e.prototype.mergeDatasetCollection=function(e){if(!_.isEmpty(e))for(var t=_.keyBy(this.models,"id"),o=0,r=e;o<r.length;o++){var a=r[o];t[a.id]?this.updateContractModel(a):this.pushModel(this.dataSetConverter.convertModel(a))}},e.prototype.getModelContracts=function(){return this.modelCollectionService.getModelContracts()},e.prototype.updateContractModel=function(e){var t;e&&(e.permissions,(t=this.findModel(e.id,e.packageId))&&(this.mergeModel(t,e),this.datasetRefreshListener.applyModelUpdated(t.id,t.packageId)))},e.prototype.addContractModel=function(e){!e&&this.modelExists(e.id,e.packageId)||(e.isNew=!0,e=this.dataSetConverter.convertModel(e),this.addModel(e))},e.prototype.addModel=function(e){e&&!this.modelExists(e.id,e.packageId)&&this.modelCollectionService.addModel(e)},e.prototype.deleteModel=function(e,t){t=this.findModels(e,t);if(!_.isEmpty(t))for(var o=0,r=t;o<r.length;o++){var a=r[o],i=this.telemetryService.startEvent(n.telemetry.DashboardDeleteDataset);this.modelExists(e,a.packageId)?this.datasetStore.delete(a.contract,!1,i):i.resolve()}},e.prototype.modelExists=function(t,o){return-1<_.findIndex(this.models,(function(e){return e.id===t&&e.packageId===o}))},e.prototype.getModelRefreshSchedule=function(e,t){return this.findModel(e,t).contract.refreshSchedule},e.prototype.findModel=function(e,t,o){var r,e=this.findModels(e);if(!_.isEmpty(e))return 1===e.length?e[0]:null==t||!(r=this.getModelByPackageId(e,t))&&o?(r=_.find(e,(function(e){return a.hasFlag(e.getPermissions(),7)})))||e[0]:r},e.prototype.findModels=function(t,o){var e=this.userExplorableModels;return o?_.filter(e,(function(e){return e.id===t&&e.packageId===o})):_.filter(e,(function(e){return e.id===t}))},e.prototype.findModelByDBName=function(t,o){var e=this.userExplorableModels,r=o?_.find(e,(function(e){return e.dbName===t&&e.packageId===o})):this.findFirstOwnedModelByDBName(t);return r=!r&&!o?_.find(e,(function(e){return e.dbName===t})):r},e.prototype.findFirstOwnedModelByDBName=function(t){return _.find(this.userExplorableModels,(function(e){return e.dbName===t&&7==(7&e.getPermissions())}))},e.prototype.findFirstExplorableModelByDBName=function(t){var o=this;return _.find(this.userExplorableModels,(function(e){return e.dbName===t&&o.permissionService.isExplorableModel(e)}))},e.prototype.findModelsByPackageId=function(e){return this.getModelsByPackageId(this.userExplorableModels,e)},Object.defineProperty(e.prototype,"editableModels",{get:function(){var t=this;return _.filter(this.models,(function(e){return t.editableModel(e)}))},enumerable:!1,configurable:!0}),e.prototype.editableModel=function(e){return null!=e&&!e.contract.isHidden&&(o.PermissionsUtils.canReshare(e.getPermissions())&&null==e.contract.originalModelId)},e.prototype.isExplorableNonLegacySampleModel=function(e){var t=e.getPermissions();return e.contentProviderId!==o.constants.samplesContentProviderId&&(this.permissionService.isExplorableModel(e)||a.hasFlag(t,17))},e.prototype.isActionAllowed=function(e,t){return!(this.isInsightAppEnabled&&a.hasFlag(e.deniedActions,t))},Object.defineProperty(e.prototype,"copyAndEditModels",{get:function(){var t=this;return _.filter(this.models,(function(e){return t.isExplorableNonLegacySampleModel(e)}))},enumerable:!1,configurable:!0}),e.prototype.renameModel=function(e,t,o){_.isEmpty(e.trim())||(t=this.findModel(t,o))&&t.contract.displayName!==e&&(o=this.telemetryService.startEvent(n.telemetry.DashboardRenameDataset),this.datasetStore.rename(t.contract,e,o))},e.prototype.updateModelQnaFeatures=function(e,t){var o=this.promiseFactory.defer(),r=this.telemetryService.startEvent(n.telemetry.DashboardUpdateModelQnaFeatures,{cortanaValue:t.cortanaEnabled,qnaValue:t.powerBIQnaEnabled,lsdlSharingPermission:t.lsdlSharingPermission});return this.modelHttpService.updateModelQnaFeatures(e,t,r.event).then((function(){r.resolve(),o.resolve({})}),(function(){r.reject(),o.reject()})),o.promise},e.prototype.updateFeaturedQuestions=function(e,t){var o=this.promiseFactory.defer(),r=this.telemetryService.startEvent(n.telemetry.DashboardUpdateFeaturedQuestions,{count:t.length});return this.modelHttpService.updateFeaturedQuestions(e,t,r.event).then((function(){r.resolve(),o.resolve({})}),(function(){r.reject(),o.reject()})),o.promise},Object.defineProperty(e.prototype,"userExplorableModels",{get:function(){return this.sharedDatasetDiscoveryEnabled?this.completeUsableModelList:this.models},enumerable:!1,configurable:!0}),e.prototype.getModelByPackageId=function(e,t){return _.find(e,(function(e){return e.packageId===t}))},e.prototype.getModelsByPackageId=function(e,t){return _.filter(e,(function(e){return e.packageId===t}))},e.prototype.subscribe=function(e){this.modelCollectionService.subscribe(e)},e.prototype.unsubscribe=function(e){this.modelCollectionService.unsubscribe(e)},e.prototype.subscribeDataset=function(){var a=this;this.appMetadataService.getAppMetadata().then((function(){a.datasetStore.datasets.subscribe((function(e){var r=a.modelCollectionService;r.models=e.map((function(e){var t=e.dataset,o=r.findModel(t.id,t.packageId);return o?o.contract!==t&&a.mergeModel(o,t):o=a.dataSetConverter.convertModel(t),o.categories=e.categories,o})),a.completeUsableModelList=_.concat(a.models,a.explorableDatasets),a._modelsDeferred.resolve(a.modelCollectionService.models)}))}))},e.prototype.subscribeExplorableDatasets=function(){var r=this;this.datasetStore.explorableDatasets.subscribe((function(e){var o=_.keyBy(r.explorableDatasets,(function(e){return e.id}));r.explorableDatasets=_.map(e,(function(e){var t=o[e.id];return t?t.contract!==e&&r.mergeModel(t,e):t=r.dataSetConverter.convertModel(e),t})),r.completeUsableModelList=_.concat(r.models,r.explorableDatasets)}))},e.prototype.populateSharedModelInfo=function(){if(!this.sharedDatasetDiscoveryEnabled)return this.promiseFactory.reject();var e=this.promiseFactory.defer();return this.datasetStore.loadShared(e),e.promise},e.prototype.isLinked=function(e,t){if(!e)return!1;var o=e.folderId;if(null!=o&&o===t)return!1;if(null==o&&null!=t)return!0;if(o&&t)return o!==t;e=e.permissions;return(null!=o||!a.hasFlag(e,2))&&a.hasFlag(e,8)},e.prototype.mergeModel=function(e,t){var o=this;e&&t&&(e.contract=t,e.id=t.id||e.id,e.isNew=t.isNew||e.isNew,e.getPermissionsCallback=function(){return o.permissionService.getModelEffectivePermissions(t)},e.name=t.name||e.name,e.displayName=t.displayName||e.displayName,e.description=t.description||e.description,e.fileName=t.fileName||e.fileName,e.packageId=t.packageId||e.packageId,e.packageVersion=t.packageVersion||e.packageVersion,e.contentProviderId=t.contentProviderId||e.contentProviderId,e.packagePublishStatus=(null!=t.packagePublishStatus?t:e).packagePublishStatus,e.isRefreshInProgress=t.currentRefreshStartingTime&&r.convertRefreshTimeToJsDateTime(t.currentRefreshStartingTime).getTime()+18e5>Date.now(),e.cloudRlsEnabled=t.cloudRlsEnabled,e.realTimeMode=t.realTimeMode,e.isHidden=e.isHidden&&t.isHidden)},e);function e(e,t,o,r,a,i,n,s,c,d){var l=this;this.telemetryService=e,this.dataSetConverter=t,this.modelHttpService=o,this.appMetadataService=r,this.promiseFactory=a,this.modelCollectionService=i,this.permissionService=n,this.asyncFeatureSwitchService=s,this.datasetStore=c,this.datasetRefreshListener=d,this.explorableDatasets=[],this.completeUsableModelList=[],this._modelsDeferred=this.promiseFactory.defer(),this.asyncFeatureSwitchService.getFeatureSwitches().then((function(e){l.isInsightAppEnabled=e.insightApps,l.sharedDatasetDiscoveryEnabled=e.sharedDatasetDiscovery,l.subscribeDataset(),l.sharedDatasetDiscoveryEnabled&&l.subscribeExplorableDatasets()}))}o.ModelService=l})(n.dataServices||(n.dataServices={}))})(powerbi=powerbi||{}),(function(b){!(function(e){var i,t,n=b.common.constants;(t=i=e.EwaNamedItemType||(e.EwaNamedItemType={}))[t.NamedRange=0]="NamedRange",t[t.Parameter=1]="Parameter",t[t.Table=2]="Table",t[t.PivotTable=3]="PivotTable",t[t.Chart=4]="Chart",t[t.WebExtension=5]="WebExtension",e.createWorkbookService=function(e,t,o,r,a,i,n,s,c,d,l,p,u,h,b,f){return new v(e,t,o,r,a,i,n,s,c,d,l,p,u,h,b,f)};var a=".xlsx,.xlsm",v=(Object.defineProperty(o.prototype,"workbooks",{get:function(){return this.workbookCollectionService.workbooks},set:function(e){this.workbookCollectionService.workbooks=e},enumerable:!1,configurable:!0}),o.prototype.postUploadWorkbookErrorMessage=function(e){this.postErrorForWorkbook(e,"UploadExcel_FailedToUploadWorkbook_Title","UploadExcel_FailedToUploadWorkbook_Message")},o.prototype.postReplaceWorkbookErrorMessage=function(e){this.postErrorForWorkbook(e,"UploadExcel_FailedToReplaceWorkbook_Title","UploadExcel_FailedToReplaceWorkbook_Message")},o.prototype.postErrorForWorkbook=function(e,t,o){var r=e.headers(b.common.PowerBIErrorHeader),a=o;!r||(r=(o=b.common.KnownContentProviderErrors[n.excelContentProviderId])&&o[r])&&r.messageId&&(a=r.messageId),this.errorService.error(this.localizationService.get(a),a,{requestId:e.requestId,statusCode:e.status.toString(),title:this.localizationService.get(t)})},o.prototype.replaceLocalWorkbook=function(e){var t=this,e=this.findWorkbookByUniqueId(e);this.replaceWorkbookScope.workbookToUpdate=e;var o=this.promiseFactory.defer(),r=function(){t.localFileService.chooseLocalFile(o,a)};o.promise.then((function(e){t.getUserConsentToReplace(r,e)})),r=function(){t.replaceWorkbook()},this.localFileService.chooseLocalFile(o,a)},o.prototype.showReplaceWorkbookTutorialIfNeeded=function(e){var t=this;this.neverShowUpdateExplanation=this.tutorialDataStore.hasKey(o.UpdateLocalWorkbookExplanation),this.neverShowUpdateExplanation?e():this.showInputDialog("ReplaceLocalWorkbook_Title","ReplaceLocalWorkbook_Message","ReplaceLocalWorkbook_ReplaceFile","UploadReplace_CancelButton",e,"ToastNotification_DontShowThisAgain",(function(){t.neverShowUpdateExplanation=!t.neverShowUpdateExplanation}))},o.prototype.getUserConsentToReplace=function(e,t){t&&(t=(this.replaceWorkbookScope.localWorkbookToUpload=t).name,this.replaceWorkbookScope.workbookToUpdate&&this.replaceWorkbookScope.workbookToUpdate.displayNameWithExtension.toLowerCase()!==t.toLowerCase()?this.showInputDialog("ReplaceLocalWorkbook_DifferentName_Title","ReplaceLocalWorkbook_DifferentName_Message","ReplaceLocalWorkbook_ReplaceFile","UploadReplace_CancelButton",e):this.showReplaceWorkbookTutorialIfNeeded(e))},o.prototype.showInputDialog=function(e,t,o,r,a,i,n){var s,c=this,d=this.errorService.control(),r=[new InJs.ModalDialogAction(this.localizationService.get(o),function(){d.hideDialog(),c.dismissExplanationPermanentlyIfNeeded(),a()}),new InJs.ModalDialogAction(this.localizationService.get(r),function(){d.hideDialog()})];i&&(s=new InJs.ModalDialogAction(this.localizationService.get(i),function(){n()}));e=this.localizationService.get(e),t=this.localizationService.get(t);d.showCustomDialog(e,angular.element("<div></div>").text(t),r,(function(e){e.parent().find('input[value="'+c.localizationService.get(o)+'"]').focus()}),!1,null,null,null,null,null,null,null,null,null,s)},o.prototype.dismissExplanationPermanentlyIfNeeded=function(){var e;this.neverShowUpdateExplanation&&(e=this.telemetryService.startEvent(b.telemetry.DashboardUpdateLocalWorkbookNeverShowExplanation),this.tutorialDataStore.setKey(o.UpdateLocalWorkbookExplanation,!0,e))},o.prototype.replaceWorkbook=function(){this.replaceWorkbookScope.shouldReplaceLocalWorkbook=!0,this.updateLocalWorkbookElement||(this.updateLocalWorkbookTemplate=angular.element(o.HtmlTemplateUpdate),this.updateLocalWorkbookElement=this.compile(this.updateLocalWorkbookTemplate)(this.replaceWorkbookScope),$("body").append(this.updateLocalWorkbookElement)),this.replaceWorkbookScope.$applyAsync()},o.prototype.finishReplacingLocalWorkbook=function(){this.replaceWorkbookScope.shouldReplaceLocalWorkbook=!1},o.prototype.onWorkbookDeleted=function(o,r){return __awaiter(this,void 0,b.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return[4,this.workbookStore.findById(o,r)];case 1:return t=e.sent(),this.workbookStore.delete(t,!0),[2]}}))}))},o.prototype.getWorkbookContracts=function(){return this.workbookCollectionService.getWorkbookContracts()},Object.defineProperty(o.prototype,"copyAndEditWorkbooks",{get:function(){var t=this.permissionService;return _.filter(this.workbooks,(function(e){e=t.getWorkbookEffectivePermissions(e.contract);return 2==(2&e)||17==(17&e)}))},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"editAndReShareWorkbooks",{get:function(){var t=this.permissionService;return _.filter(this.workbooks,(function(e){e=t.getWorkbookEffectivePermissions(e.contract);return 2==(2&e)&&4==(4&e)}))},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"lastUpdatedTimestamp",{get:function(){return this._lastUpdatedTimestamp},enumerable:!1,configurable:!0}),o.prototype.ensureWorkbookInitialization=function(){return this.workbooksDeferred.promise},o.prototype.updateTimestamp=function(){this._lastUpdatedTimestamp=(new Date).getTime()},o.prototype.findWorkbook=function(t,o){return o?_.find(this.workbooks,(function(e){return e.id===t&&e.packageId===o})):_.find(this.workbooks,(function(e){return e.id===t&&e.isOwner()}))},o.prototype.findWorkbookByEtagHash=function(t){return _.find(this.workbooks,(function(e){return e.contract.etagHash===t}))},o.prototype.findWorkbookByUniqueId=function(t){return _.find(this.workbooks,(function(e){return e.uniqueId===t}))},o.prototype.getWorkbookUniqueId=function(e){return e.uniqueId},o.prototype.subscribeWorkbooks=function(){var o=this;this.appMetadataService.getAppMetadata().then((function(){o.workbookStore.workbooks.subscribe((function(e){o.workbookCollectionService.workbooks=e.map((function(t){var e=_.find(o.workbookCollectionService.workbooks,(function(e){return e.id===t.id&&e.packageId===t.packageId}));return e?(o.modelMerger.mergeWorkbook(e,t),e):o.modelConverter.convertWorkbook(t)})),o.updateTimestamp(),o.workbooksDeferred.resolve(o)}))}))},Object.defineProperty(o.prototype,"originalWorkbooks",{get:function(){var t=this.permissionService;return _.filter(this.workbooks,(function(e){return e.isOwner()&&t.isOriginalWorkbook(e)}))},enumerable:!1,configurable:!0}),o.prototype.renameWorkbook=function(e,t,o){_.isEmpty(e.trim())||(t=this.findWorkbook(t,o))&&(o=this.telemetryService.startEvent(b.telemetry.DashboardRenameWorkbook),this.workbookStore.rename(t.contract,e,o))},o.prototype.removeWorkbook=function(r,a,i,n){return __awaiter(this,void 0,b.Promise,(function(){var t,o;return __generator(this,(function(e){switch(e.label){case 0:return t=this.telemetryService.startEvent(b.telemetry.DashboardRemoveWorkbook,{storageProvider:i,contentProvider:n}),[4,this.workbookStore.findById(r,a)];case 1:return o=e.sent(),this.workbookStore.delete(o,!1,t),[2]}}))}))},o.prototype.haveWorkbookEmbedAccessData=function(e){var t=this.deferredWopiData[e],e=this.wopiDataTTL[e];return!(!t||e&&!(e>(new Date).getTime()))},o.prototype.getWorkbookEmbedAccessData=function(t,e,o){var r,a=this;if(r=o?this.telemetryService.startChildEvent(o,b.telemetry.DashboardGetWorkbookWopiAccessInformation):this.telemetryService.startEvent(b.telemetry.DashboardGetWorkbookWopiAccessInformation),this.haveWorkbookEmbedAccessData(t))return r.resolve(),this.deferredWopiData[t].promise;o=this.promiseFactory.defer();this.deferredWopiData[t]=o,this.wopiDataTTL[t]=null;var i=!1;return this.workbookHttpService.getWorkbookWopiData(t,r.event).then((function(e){e.data&&e.data.accessToken&&e.data.url?(e=e.data,a.wopiDataTTL[t]=e.accessTokenTtl,a.deferredWopiData[t].resolve(e),r.resolve()):i=!0}),(function(){i=!0})).finally((function(){i&&(a.deferredWopiData[t].reject(),a.deferredWopiData[t]=null,r.reject())})),o.promise},o.prototype.createExcelWebAppEmbedUrlParams=function(e,t){e=[{key:"dsdiv",value:e},{key:"dswp",value:"1"},{key:"dsts",value:"None"},{key:"dsat",value:"1"},{key:"dspti",value:"1"},{key:"dsfl",value:"1"},{key:"dsacs",value:this.asyncFeatureSwitchService.featureSwitches.ffxlChartSelectionEnabled?"1":"0"},{key:"dsrc",value:"pplr"}];return t&&e.push({key:"dssc",value:t}),e.map((function(e){return"&"+e.key+"="+e.value})).join("")},o.prototype.embedWorkbook=function(o,r,a,i,n,s,c,d,e,l){var p=this;if(null!==r&&null!==a){var u=this.promiseFactory.defer(),t=this.promiseFactory.defer(),h=e?"&wdPublishedInPbiHint=true":"";return t.promise.then((function(){var e=p.createExcelWebAppEmbedUrlParams(r.targetDiv,l),t=a+"&access_token="+i+"&access_token_ttl="+n+e+h,e=p.promiseFactory.defer();e.promise.then((function(e){e.getSucceeded()?(p.telemetryService.logEvent(b.telemetry.DashboardWorkbookEmbeddingExternalSuccess,{etagHash:o,correlationId:e.getCorrelationId(),storageProvider:s,permissions:d,contentProvider:c}),u.resolve({ewaControl:e.getReturnValue(),window:r})):(p.telemetryService.logEvent(b.telemetry.DashboardWorkbookEmbeddingExternalFailure,{etagHash:o,errorCode:e.getCode(),errorDescription:e.getDescription(),correlationId:e.getCorrelationId(),storageProvider:s,permissions:d,contentProvider:c}),u.reject())}),(function(){p.telemetryService.logEvent(b.telemetry.DashboardWorkbookEmbeddingExternalFailure,{etagHash:o,errorCode:-1,storageProvider:s,permissions:d,contentProvider:c}),u.reject()})),r.loadEwaScripts(t,e)})),r.loadEvent=t,r.loaded&&t.resolve(null),u.promise}},o.prototype.getDefaultTileTitle=function(e,t){var o=t,t=e.sheetName;return t?o+=", "+t.replace(/\''/g,"'"):1<(e=e.item.split("!")).length&&(o+=", "+e[0].substr(1,e[0].length-2)),o},o.prototype.getDefaultTileSubtitle=function(e){var t=e.split("!");return 1<t.length?t[1]:e},o.prototype.getTileSelectionQuery=function(e,t,o,r){var a="";return o===i.Chart&&r&&(a="Sheets('"+r+"')/"),a+=this.getNamedItemTypeAsString(o)+"('",e?a+=e:t&&(a+=t),encodeURIComponent(a+"')")},o.prototype.encodeImageTileQueryString=function(e){e=encodeURI(e);return e=(e=(e=e.replace(/\'/g,"%27")).replace(/\(/g,"%28")).replace(/\)/g,"%29")},o.prototype.getNamedItemTypeAsString=function(e){switch(e){case i.NamedRange:return"Ranges";case i.Parameter:return"Parameters";case i.Table:return"Tables";case i.PivotTable:return"PivotTables";case i.Chart:return"Charts"}return"Ranges"},o.prototype.getWorkbookTilePreviewImageUrl=function(o){var r=this,a=this.promiseFactory.defer();return this.getWorkbookEmbedAccessData(o.workbookId,o.packageId).then((function(e){var t;o.$config.workbookTile?(t=e.url.replace(/ExcelJs.ashx/i,"/XlRestInternal.aspx"),t+="&framemode=proxy&wdRestQuery=$format=image&wdRestPart=Model/"+r.encodeImageTileQueryString(r.getTileSelectionQuery(o.$config.workbookTile.item,o.$config.workbookTile.activeSelection,o.$config.workbookTile.itemType,o.$config.workbookTile.sheetName))+"&access_token="+e.accessToken+"&access_token_ttl="+e.accessTokenTtl,a.resolve(t)):a.reject()}),(function(){a.reject()})),a.promise},o.prototype.getWorkbookTileBestImageUrl=function(e){if(e.hasImages()){var t=e.images,o=-1,r=-1,a=e.tileModel.layoutPosition,i=b.common.GridLayoutConstants.getDefaultGridItemViewport({colSpan:a.width,rowSpan:a.height}),n=Number.MAX_VALUE,s=Number.MIN_VALUE,a=window.devicePixelRatio;if(i.width=i.width*a,i.height=i.height*a,e.keepOriginalContentSize)return t[0].imageUrl,jsCommon.Utility.getAbsoluteUri(t[0].imageUrl);for(var c=0;c<t.length;c++){t[c].width>s&&(s=t[c].width,r=c);var d=t[c].width-i.width,l=t[c].height-i.height,l=Math.max(d,l);0<=l&&l<n&&(n=l,o=c)}return t[o=-1===o?r:o].imageUrl,jsCommon.Utility.getAbsoluteUri(t[o].imageUrl)}return e.image?"data:image/png;base64,"+e.image:""},o.prototype.setModelDynamicImageUrl=function(e){e.dynamicImageUrl=this.getWorkbookTileBestImageUrl(e),e.dynamicImageUrl||(e.dynamicImageUrl=e.previewImageUrl)},o.prototype.getWorkbooks=function(){return this.workbooksDeferred.promise.then((function(e){return e.workbooks}))},o.prototype.subscribe=function(e){this.workbookCollectionService.subscribe(e)},o.prototype.unsubscribe=function(e){this.workbookCollectionService.unsubscribe(e)},o.HtmlTemplateUpdate="<content-provider-local-file selected-file='localWorkbookToUpload' is-update-from-element-flow='true' ng-if='shouldReplaceLocalWorkbook' element-to-update='workbookToUpdate'></content-provider-local-file>",o.UpdateLocalWorkbookExplanation="updateLocalWorkbookExplanation",o);function o(e,t,o,r,a,i,n,s,c,d,l,p,u,h,b,f){this.asyncFeatureSwitchService=s,this.workbookStore=f,this.workbookCollectionService=h,this.telemetryService=t,this.rootScope=e,this.errorService=o,this.modelMerger=r,this.modelConverter=a,this.workbookHttpService=i,this.localizationService=n,this.appMetadataService=c,this.promiseFactory=d,this.tutorialDataStore=l,this.compile=p,this.localFileService=u,this.permissionService=b,this.wopiDataTTL=new Array,this.deferredWopiData=Array(),this.workbooksDeferred=d.defer(),this.replaceWorkbookScope=this.rootScope.$new(),this.replaceWorkbookScope.shouldReplaceLocalWorkbook=!1,this.subscribeWorkbooks()}e.WorkbookService=v})(b.dataServices||(b.dataServices={}))})(powerbi=powerbi||{}),(function(a){!(function(e){var t=a.common.NotifyCollection;e.createWorkbookCollectionService=function(){return new o};var o=(Object.defineProperty(r.prototype,"workbooks",{get:function(){return this.collection.items},set:function(e){this.collection.setItems(e)},enumerable:!1,configurable:!0}),r.prototype.getWorkbookContracts=function(){return _.map(this.workbooks,(function(e){return e.contract}))},r.prototype.addWorkbook=function(e){this.collection.addItem(e)},r.prototype.removeWorkbook=function(t,o){var e=this.collection.deleteItems((function(e){return e.id===t&&e.packageId===o}));return e.length,_.head(e)},r.prototype.onAdded=function(e){for(var t=0,o=this.listeners;t<o.length;t++){var r=o[t];r.onWorkbookAdded&&r.onWorkbookAdded(e)}},r.prototype.onDeleted=function(e){for(var t=0,o=this.listeners;t<o.length;t++){var r=o[t];r.onWorkbookDeleted&&r.onWorkbookDeleted(e)}},r.prototype.onReset=function(){for(var e=0,t=this.listeners;e<t.length;e++){var o=t[e];o.onWorkbooksReset&&o.onWorkbooksReset()}},r.prototype.subscribe=function(e){this.listeners.length<1&&this.collection.subscribe(this),this.listeners.push(e)},r.prototype.unsubscribe=function(e){_.pull(this.listeners,e),this.listeners.length<1&&this.collection.unsubscribe(this)},r);function r(){this.listeners=[],this.collection=new t}})(a.dataServices||(a.dataServices={}))})(powerbi=powerbi||{}),(function(y){!(function(a){function e(){t||(angular.module("powerbi.dataServices",[]),y.common.initializeAngularModule(),angular.module("powerbi.dataServices",["powerbi.common","powerbi.visualHost"]).factory("dashboardCollection",[function(){return y.dataServices.createDashboardCollectionService()}]).factory("modelCollection",[function(){return y.dataServices.createModelCollectionService()}]).factory("packageCollection",[function(){return y.dataServices.createPackageCollectionService()}]).factory("reportCollection",[function(){return y.dataServices.createReportCollectionService()}]).factory("workbookCollection",[function(){return y.dataServices.createWorkbookCollectionService()}]).factory("reportService",["telemetryService","reportModelConverter","appMetadataService","promiseFactory","reportCollection","reportStore","groupStore",function(e,t,o,r,a,i,n){return y.dataServices.createReportService(e,t,o,r,a,i,n)}]).factory("workbookService",["$rootScope","telemetryService","errorService","dataServiceModelMerger","dataServiceModelConverter","workbookHttpService","localizationService","asyncFeatureSwitchService","appMetadataService","promiseFactory","tutorialDataStore","$compile","localFileService","workbookCollection","permissionService","workbookStore",function(e,t,o,r,a,i,n,s,c,d,l,p,u,h,b,f){return y.dataServices.createWorkbookService(e,t,o,r,a,i,n,s,c,d,l,p,u,h,b,f)}]).factory("modelService",["telemetryService","datasetModelConverter","modelHttpService","appMetadataService","promiseFactory","modelCollection","permissionService","asyncFeatureSwitchService","datasetStore","datasetRefreshListener",function(e,t,o,r,a,i,n,s,c,d){return y.dataServices.createModelService(e,t,o,r,a,i,n,s,c,d)}]).factory("dashboardDataService",["dashboardHttpService","groupStore","promiseFactory","dataServiceModelConverter","dataServiceModelMerger","modelService","dashboardCollection","$timeout","dashboardStore","appMetadataService","permissionService","reportService","datasetRefreshListener","notificationToast","workbookService","reportStore",function(e,t,o,r,a,i,n,s,c,d,l,p,u,h,b,f){return y.dataServices.createDashboardDataService(e,t,o,r,a,i,n,s,c,d,l,p,u,h,b,f)}]).factory("dashboardSyncService",["$rootScope","dashboardDataService","dashboardHttpService","dataServiceModelConverter","dataServiceModelMerger","modelService","promiseFactory","reportService","resourcePackageListenerService","resourcePackagesService","telemetryService","workbookService","dashboardStore","globalEventBridge","featureSwitchService","publicCustomVisualService",function(e,t,o,r,a,i,n,s,c,d,l,p,u,h,b,f){return y.dataServices.createDashboarSyncService(e,t,o,r,a,i,n,s,c,d,l,p,u,h,b,f)}]).factory("dataServiceModelConverter",["visualHostAuthenticationService","explorationSerializer","featureSwitchService","geocoder","geolocationService","localizationService","moduleLoader","permissionService","promiseFactory","reportModelConverter","telemetryService","themeService","tileConfigUpgraderService","visualHostTooltipServiceFactory","visualPlugin","appModelConverter","$injector","datasetModelConverter","packageModelConverter",function(e,t,o,r,a,i,n,s,c,d,l,p,u,h,b,f,v,m,g){return y.dataServices.models.createDataServiceModelConverter(e,t,o,r,a,i,n,s,c,d,l,p,u,h.create(),y.explore.services.createVisualPluginOps(b,o),b,f,v,m,g)}]).factory("dataServiceModelMerger",["dataServiceModelConverter","permissionService",function(e,t){t=y.dataServices.models.createDataServiceModelMerger(e,t);return e.setModelMerger(t),t}]).factory("packageService",["packageModelConverter","packageCollection","promiseFactory","asyncFeatureSwitchService","packageStore",function(e,t,o,r,a){return y.dataServices.createPackageService(e,t,o,r,a)}]).factory("appService",["promiseFactory","dataServiceModelConverter","appStore","dataServiceModelMerger",function(e,t,o,r){return a.createAppService(e,t,o,r)}]).factory("permissionRefresh",["userInfo","dashboardSyncService","dashboardDataService","promiseFactory",function(e,t,o,r){return a.createPermissionRefreshService(e,t,o,r)}]).factory("legacySyncListenerService",["featureSwitchService","cdsaModelRefreshListener","datamartRefreshListener","contentProviderListener","dashboardRefreshListener","delayedQueryResultResolver","packageRefreshListener","schemaRefresh","reportRefreshListener","workbookRefreshListener","datasetRefreshListener",function(e,t,o,r,a,i,n,s,c,d,l){return y.dataServices.createLegacySyncListenerService(e,t,o,r,a,i,n,s,c,d,l)}]),t=!0)}a.initializeAngularModule=e;var t=!1;e()})(y.dataServices||(y.dataServices={}))})(powerbi=powerbi||{}),(function(e){!(function(e){e.createLegacySyncListenerService=function(e,t,o,r,a,i,n,s,c,d,l){return new p(e,t,o,r,a,i,n,s,c,d,l)};var p=function(e,t,o,r,a,i,n,s,c,d,l){t.init(),o.init(),r.init(),a.init(),i.init(),n.init(),s.init(),c.init(),d.init(),l.init()};e.LegacySyncListenerService=p})(e.dataServices||(e.dataServices={}))})(powerbi=powerbi||{}),(function(e){((e=e.dataServices||(e.dataServices={})).utils||(e.utils={})).generateFiltersDescription=function(e,t,o,r,a,i){var n={filtersNamesAndRestatements:[]};if(!t||_.isEmpty(t.dataFiltersUnmerged))return n;for(var s=r.capabilities(o.visualType),c=0,d=t.dataFiltersUnmerged;c<d.length;c++){var l=d[c];if(!l.isHidden){l=a.getFilterRestatementForOverlay(l,e,s,null,o);if(!_.isEmpty(l))for(var p=0,u=l;p<u.length;p++){var h=u[p];n.filtersNamesAndRestatements.push({displayName:h.fieldName,qualifiedDisplayName:h.fieldNameToolTip,restatement:h.restatements.join(i.get("ListJoin_Separator"))})}}}return n}})(powerbi=powerbi||{});;
"use strict";var powerbi;!(function(t){!(function(){(t.dashboard||(t.dashboard={})).createDashboardProgressTrackingService=function(e,t,i){return new o(e,t,i)};var o=(e.prototype.registerLoadingProgressCallback=function(e,t){this.registeredCallbacks.push(e),t&&(this.tileLoadTimeoutInMilliseconds=t)},e.prototype.unregisterLoadingProgressCallback=function(e){_.pull(this.registeredCallbacks,e)},e.prototype.shouldBeIncluded=function(e){return e.shouldBeIncludedInTelemetryMeasurement},e.prototype.startTracking=function(e){var i=this;e&&(this.unsubcribeTileRepeatFinishedEvent=this.rootScope.$on(t.common.constants.dashboardTileRepeatFinishedEvent,(function(){return i.onDashboardTileRepeatFinishedEvent()})),this.unsubscribeTileVisualLoadedEvent=this.globalEventBridge.createChannelSubscriptionManager().subscribe(t.common.events.tileVisualLoadedChanged,(function(e,t){e.stopPropagation(),i.removeTileIdFromWaitlist(t),i.cancelVisualLoadTimeout(t)})),this.dashboardModel=e,this.dashboardLoadingDeferred=new t.PbiDeferred)},e.prototype.cancelTracking=function(){this.dashboardModel&&this.completeTracking(this.dashboardModel,!0),this.dashboardModel=null},e.prototype.dashboardLoadingCompleted=function(){return this.dashboardLoadingDeferred&&this.dashboardLoadingDeferred.promise},e.prototype.onDashboardTileRepeatFinishedEvent=function(){var i=this;if(this.dashboardModel){for(var e=this.dashboardModel,o=this,t=0,a=e.tiles;t<a.length;t++)!(function(e){var t;o.shouldBeIncluded(e)&&(t=e.id,_.includes(o.tileIdsAlreadyLoaded,t)||(o.tileIdsToWait.push(t),o.cancelVisualLoadTimeout(t),o.timeOutMap[t]=o.timeoutService((function(){i.timedOutTiles.push(e),i.removeTileIdFromWaitlist(t)}),o.tileLoadTimeoutInMilliseconds)))})(a[t]);this.tileRepeatFinishedEventRaised=!0,_.isEmpty(this.tileIdsToWait)&&this.completeTracking(this.dashboardModel,!1)}},e.prototype.removeTileIdFromWaitlist=function(e){this.tileRepeatFinishedEventRaised?_.pull(this.tileIdsToWait,e):this.tileIdsAlreadyLoaded.push(e),this.tileRepeatFinishedEventRaised&&_.isEmpty(this.tileIdsToWait)&&this.completeTracking(this.dashboardModel,!1)},e.prototype.cancelVisualLoadTimeout=function(e){var t=this.timeOutMap[e];t&&(this.timeoutService.cancel(t),delete this.timeOutMap[e])},e.prototype.completeTracking=function(e,t){this.unsubcribeTileRepeatFinishedEvent&&this.unsubcribeTileRepeatFinishedEvent(),this.unsubcribeTileRepeatFinishedEvent&&this.unsubcribeTileRepeatFinishedEvent(),this.unsubscribeTileVisualLoadedEvent&&(this.unsubscribeTileVisualLoadedEvent.unsubscribeAll(),this.unsubscribeTileVisualLoadedEvent=null);for(var i={model:e,isCancelled:t,timedOutTiles:this.timedOutTiles},o=0,a=this.registeredCallbacks;o<a.length;o++)(0,a[o])(i);this.dashboardLoadingDeferred&&(t?this.dashboardLoadingDeferred.reject("cancelled"):this.dashboardLoadingDeferred.resolve(e.id)),this.initState()},e.prototype.initState=function(){this.tileIdsToWait=[],this.tileIdsAlreadyLoaded=[],this.timeOutMap={},this.timedOutTiles=[],this.tileRepeatFinishedEventRaised=!1,this.dashboardLoadingDeferred=null},e);function e(e,t,i){this.rootScope=e,this.timeoutService=t,this.globalEventBridge=i,this.registeredCallbacks=[],this.timedOutTiles=[],this.tileLoadTimeoutInMilliseconds=2e4,this.initState()}})()})(powerbi=powerbi||{}),(function(a){!(function(o){var e=["powerbi.common","powerbi.dataServices"];function t(){i||(a.common.initializeAngularModule(),a.dataServices.initializeAngularModule(),angular.module("powerbi.dashboard",e).factory("dashboardLoadingProgressTracking",["$rootScope","$timeout","globalEventBridge",function(e,t,i){return o.createDashboardProgressTrackingService(e,t,i)}]).factory("tileSelectionServiceLegacy",["globalEventBridge","dashboardDataService","promiseFactory",function(e,t,i){return o.services.createTileSelectionService(e,t,i)}]).factory("tileSpotlightServiceLegacy",["dashboardDataService","promiseFactory",function(e,t){return o.services.createTileSpotlightService(e,t)}]),i=!0)}o.initializeAngularModule=t;var i=!(window.dashboardDefined=!0);t()})(a.dashboard||(a.dashboard={}))})(powerbi=powerbi||{}),(function(e){(e.constants||(e.constants={})).scrollToSelectedTileEventName="scrollToSelectedTile"})(powerbi=powerbi||{}),(function(t){var i;i=t.dashboard||(t.dashboard={}),(function(){(i.services||(i.services={})).createTileSelectionService=function(e,t,i){return new o(e,t,i)};var o=(e.prototype.selectById=function(t){var e,i=this.dashboardDataService.selectedDashboardTile;i&&i.isSelected&&i.id===t||(e=this.dashboardDataService.activeDashboard)&&e.tiles&&(i=_.find(e.tiles,(function(e){return e.id===t})),e=_.find(e.tiles,(function(e){return e.objectId===t})),(i||e)&&this.select(i||e))},e.prototype.select=function(e){var t=this.dashboardDataService.selectedDashboardTile;t&&(t.isSelected=!1),e.isSelected=!0,this.dashboardDataService.selectedDashboardTile=e},e.prototype.getSelected=function(){var e=this.dashboardDataService.selectedDashboardTile;return this.promiseFactory.resolve(e&&e.isSelected?e:void 0)},e.prototype.clearSelected=function(){var e=this.dashboardDataService.selectedDashboardTile;null!=e&&(e.isSelected=!1,this.dashboardDataService.selectedDashboardTile=null)},e.prototype.scrollToSelectedTile=function(){this.globalEventBridge.publishToChannel(t.common.events.scrollToSelectedTile)},e);function e(e,t,i){this.globalEventBridge=e,this.dashboardDataService=t,this.promiseFactory=i}})()})(powerbi=powerbi||{}),(function(e){var t;t=e.dashboard||(e.dashboard={}),(function(){(t.services||(t.services={})).createTileSpotlightService=function(e,t){return new i(e,t)};var i=(e.prototype.isTileSpotlighted=function(t){var e=this.dashboardDataService.activeDashboard;return e&&e.tiles?this.promiseFactory.resolve(_.some(e.tiles,(function(e){return e.hasSpotlight&&e.id===t}))):this.promiseFactory.resolve(!1)},e.prototype.isLegacySpotlightSet=function(){var e=this.dashboardDataService.activeDashboard;return!(!e||!e.tiles)&&_.some(e.tiles,(function(e){return e.hasSpotlight}))},e.prototype.setSpotlight=function(e){var t=this.dashboardDataService.activeDashboard;if(t&&t.tiles)for(var i=0,o=t.tiles;i<o.length;i++){var a=o[i];if(a.id===e){a.hasSpotlight=!0;break}}},e.prototype.clearSpotlights=function(){var e=this.dashboardDataService.activeDashboard;if(e&&e.tiles)for(var t=0,i=e.tiles;t<i.length;t++)i[t].hasSpotlight=!1},e);function e(e,t){this.dashboardDataService=e,this.promiseFactory=t}})()})(powerbi=powerbi||{}),(function(a){!(function(t){var e=jsCommon.Utility,i=a.telemetryEventFactory,o=a.telemetry.EventFactories;e?e.generateGuid:Function.prototype;t.AnnotationsOpenAnnotationsPaneEventName="PBI.Annotations.OpenAnnotationsPane",t.AnnotationsOpenAnnotationsPane=o[t.AnnotationsOpenAnnotationsPaneEventName]=function(e){return i({name:t.AnnotationsOpenAnnotationsPaneEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.AnnotationsOpenAnnotationsPaneLoggers})}})(a.telemetry||(a.telemetry={}))})(powerbi=powerbi||{});;
"use strict";var powerbi,__awaiter=this&&this.__awaiter||function(e,s,a,l){return new(a=a||Promise)(function(i,t){function o(e){try{r(l.next(e))}catch(e){t(e)}}function n(e){try{r(l.throw(e))}catch(e){t(e)}}function r(e){var t;e.done?i(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(o,n)}r((l=l.apply(e,s||[])).next())})},__generator=this&&this.__generator||function(i,o){var n,r,s,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return (function(t){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(s=2&t[0]?r.return:t[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,t[1])).done)return s;switch(r=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,r=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){a.label=t[1];break}if(6===t[0]&&a.label<s[1]){a.label=s[1],s=t;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(t);break}s[2]&&a.ops.pop(),a.trys.pop();continue}t=o.call(i,a)}catch(e){t=[6,e],r=0}finally{n=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}})([t,e])}}};!(function(e){(e=(e=e.explore||(e.explore={})).events||(e.events={})).saveExploration={name:"saveExploration",type:3},e.saveAsExploration={name:"saveAsExploration",type:3}})(powerbi=powerbi||{}),(function(n){!(function(t){var e=jsCommon.Utility,i=n.telemetryEventFactory,o=n.telemetry.EventFactories;e?e.generateGuid:Function.prototype;t.ExplorationAppBarActionEventName="PBI.ExplorationAppBar.Action",t.ExplorationAppBarAction=o[t.ExplorationAppBarActionEventName]=function(e){return i({name:t.ExplorationAppBarActionEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.ExplorationAppBarActionLoggers,logExpAssignment:!0})},t.ExplorationAppBarViewDatasetEventName="PBI.ExplorationAppBar.ViewDataset",t.ExplorationAppBarViewDataset=o[t.ExplorationAppBarViewDatasetEventName]=function(e){return i({name:t.ExplorationAppBarViewDatasetEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.ExplorationAppBarViewDatasetLoggers,logExpAssignment:!0})},t.FailureDuringModelLoadEventName="PBI.FailureDuringModelLoad",t.FailureDuringModelLoad=o[t.FailureDuringModelLoadEventName]=function(e){return i({name:t.FailureDuringModelLoadEventName,info:e,category:n.TelemetryCategory.CriticalError,loggers:t.FailureDuringModelLoadLoggers})},t.FilterMigrationPhaseTwoServiceActionEventName="PBI.FilterMigrationPhaseTwoServiceAction",t.FilterMigrationPhaseTwoServiceAction=o[t.FilterMigrationPhaseTwoServiceActionEventName]=function(e){return i({name:t.FilterMigrationPhaseTwoServiceActionEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.FilterMigrationPhaseTwoServiceActionLoggers})},t.InitializeExplorationErrorEventName="PBI.InitializeExplorationError",t.InitializeExplorationError=o[t.InitializeExplorationErrorEventName]=function(e){return i({name:t.InitializeExplorationErrorEventName,baseEvent:t.ErrorWithStackTrace(e),info:e,category:n.TelemetryCategory.CriticalError,loggers:t.InitializeExplorationErrorLoggers})},t.QuickExploreEventName="PBI.QuickExplore",t.QuickExplore=o[t.QuickExploreEventName]=function(e){return i({name:t.QuickExploreEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.QuickExploreLoggers})},t.QuickCreateShareReportEventName="PBI.QuickCreate.ShareReport",t.QuickCreateShareReport=o[t.QuickCreateShareReportEventName]=function(e){return i({name:t.QuickCreateShareReportEventName,baseEvent:t.CustomerAction(e),info:e,category:n.TelemetryCategory.CustomerAction,loggers:t.QuickCreateShareReportLoggers,logExpAssignment:!0})}})(n.telemetry||(n.telemetry={}))})(powerbi=powerbi||{}),(function(e){((e=(e=e.explore||(e.explore={})).exploration||(e.exploration={})).htmlTemplate||(e.htmlTemplate={})).put=function(e){e.put("components/appBarFlyoutMenu/appBarFlyoutMenu.html",'<button class="dropdown-item {{$ctrl.menuItemClass}}" ng-click="$ctrl.openFlyout($event); $event.stopPropagation(); $event.preventDefault()" ng-disabled="$ctrl.flyoutItem.disabled" ng-class="{\'selected\': $ctrl.flyoutItem.checked}" ng-attr-data-unique-id="{{ $ctrl.flyoutItem.action ? \'appBar-\' + $ctrl.menuOverlayName + \'-\' + $ctrl.flyoutItem.action : undefined }}"><div class="dropdown-content {{::$ctrl.flyoutItem.itemClass}}"><i class="glyphicon glyph {{::$ctrl.flyoutItem.itemClass}}" ng-class="::{\'glyph-small\': $ctrl.glyphSmall}" title="{{::$ctrl.flyoutItem.tooltip || $ctrl.flyoutItem.text}}"></i><span class="dropdown-label" ng-bind="::$ctrl.flyoutItem.text" title="{{::$ctrl.flyoutItem.tooltip || $ctrl.flyoutItem.text}}"></span><span ng-if="::$ctrl.flyoutItem.description" class="dropdown-description" ng-bind="::$ctrl.flyoutItem.description"></span><i class="glyphicon pbi-glyph-chevronrightmedium glyph-small" title="{{::$ctrl.flyoutItem.tooltip || $ctrl.flyoutItem.text}}"></i></div></button>'),e.put("components/explorationAppBar/explorationAppBar.html",'<div class="appBarContent trimmedTextWithEllipsis unselectable appThemeable"><div class="appBarSection left" focus-nav-mode="Browser" keyboard-shortcuts="ctrl-F6"><ul><li ng-if="$ctrl.isAppNavToggleEnabled"><pbi-lazy-load-modern [module-path]="$ctrl.appConsumptionLazyLoadPath" [component-id]="$ctrl.appConsumptionNavPaneToggleLazyComponentId"></pbi-lazy-load-modern></li><li ng-if="$ctrl.viewModel.options.showBackButtonOnAppBar"> <button ng-click="$ctrl.navigateBack()" localize-tooltip="Go_Back"><i class="glyphicon pbi-glyph-pageleft glyph-small backBtn"></i></button></li><li> <button class="file-menu" localize-tooltip="File" ng-click="$ctrl.showFileMenu($event);selected=!selected" aria-haspopup="true" aria-expanded="{{$ctrl.isFileMenuOpen}}"><span localize="File"></span><i class="glyphicon pbi-glyph-chevrondownmedium glyph-mini"></i></button></li><li ng-if="$ctrl.showViewMenu()"> <button class="pageview-menu" localize-tooltip="ItemAction_View" ng-click="$ctrl.showViewDropdown($event)" aria-haspopup="true" aria-expanded="{{$ctrl.isViewMenuOpen}}"><span localize="ItemAction_View"></span><i class="glyphicon pbi-glyph-chevrondownmedium glyph-mini"></i></button></li><li ng-if="$ctrl.showReadingViewButton()"> <button localize-tooltip="ReportAppBar_SwitchModeButton" accessible-click="$ctrl.stopEditing()" class="switch"><span localize="ReportAppBar_SwitchModeButton"></span></button></li><li ng-if="$ctrl.showPhoneLayoutButton()"> <button localize-tooltip="MobileAuthoring_MobileLayout" class="phone-layout-button" accessible-click="$ctrl.setPhonePortraitFormFactor()"><span localize="MobileAuthoring_MobileLayout"></span></button></li><li ng-if="$ctrl.showWebLayoutButton()"> <button localize-tooltip="ReportAppBar_WebLayout" class="web-layout-button" accessible-click="$ctrl.setMasterFormFactor()"><span localize="ReportAppBar_WebLayout"></span></button></li></ul></div><div class="appBarSection right" ng-show="$ctrl.showAppBarRight()"><ul><li class="rightFloatedItem"></li><li ng-if="!$ctrl.isPopOutMode && $ctrl.isQnaEnabled"> <button class="qna" localize-tooltip="AskAQuestion" ng-click="$ctrl.addQnaContainer()"><i class="glyphicon pbi-glyph-qna glyph-small"></i><span localize="AskAQuestion"></span></button></li><li ng-if="$ctrl.viewModeState.getMode() === 1"> <button class="explore" localize-tooltip="ReportAppBar_ExploreTooltip" ng-disabled="$ctrl.isMenuDisabled($ctrl.getExploreMenuProperties())" ng-click="$ctrl.showExploreMenu($event)" aria-haspopup="true" aria-expanded="{{$ctrl.isExploreMenuOpen}}"><i class="glyphicon pbi-glyph-seedata glyph-small"></i><span localize="ReportAppBar_ExploreButton"></span><i class="glyphicon pbi-glyph-chevrondownmedium glyph-mini"></i></button></li><li ng-if="$ctrl.viewModeState.getMode() === 1 && !$ctrl.isPopOutMode"> <button class="insert-textbox" localize-tooltip="Textbox" ng-click="$ctrl.insertTextbox()"><i class="glyphicon pbi-glyph-inserttextbox glyph-small"></i><span localize="Textbox"></span></button></li><li dropdown-menu dropdown-items="$ctrl.basicShapeMenuActions" dropdown-class="explorationAppBarMenu" dropdown-on-item-selected="$ctrl.basicShapeMenuActionSelected(selected)" localize-tooltip="ReportAppBar_ShapeButton" ng-if="$ctrl.shouldShowBasicShapeMenu()"> <button aria-haspopup="true" class="insert-shape"><i class="glyphicon pbi-glyph-shapes glyph-small"></i><span localize="ReportAppBar_ShapeButton"></span><i class="glyphicon pbi-glyph-chevrondownmedium glyph-mini"></i></button></li><li ng-if="$ctrl.shouldShowNewShapeMenu()"> <button aria-haspopup="true" class="insert-shape" localize-tooltip="ReportAppBar_ShapeButton" ng-click="$ctrl.showShapeMenu($event)" aria-expanded="{{$ctrl.isButtonsMenuOpen}}"><i class="glyphicon pbi-glyph-shapes glyph-small"></i><span localize="ReportAppBar_ShapeButton"></span><i class="glyphicon pbi-glyph-chevrondownmedium glyph-mini"></i></button></li><li ng-if="$ctrl.viewModeState.getMode() === 1 && $ctrl.actionButtonMenuActions && !$ctrl.isPopOutMode"> <button aria-haspopup="true" class="insert-button" localize-tooltip="ReportAppBar_Buttons" ng-click="$ctrl.showActionMenu($event)" aria-expanded="{{$ctrl.isButtonsMenuOpen}}"><i class="glyphicon pbi-glyph-buttons glyph-small"></i><span localize="ReportAppBar_Buttons"></span><i class="glyphicon pbi-glyph-chevrondownmedium glyph-mini"></i></button></li><li ng-if="$ctrl.viewModeState.getMode() === 1 && $ctrl.toggleEditVisualInteractionsMode && !$ctrl.isPopOutMode"> <button class="visualInteractions-menu" localize-tooltip="ReportAppBar_VisualInteractionsTooltip" aria-haspopup="true" ng-click="$ctrl.showVisualInteractionMenu($event)" aria-expanded="{{$ctrl.isVisualInteractionMenuOpen}}"><i class="glyphicon pbi-glyph-visualsinteraction glyph-small"></i><span localize="ReportAppBar_VisualInteractionsButton"></span><i class="glyphicon pbi-glyph-chevrondownmedium glyph-mini"></i></button></li><li ng-if="$ctrl.viewModeState.getMode() === 1"> <button ng-click="$ctrl.refresh()" class="refresh" localize-tooltip="Refresh"><i class="glyphicon pbi-glyph-refresh glyph-mini" aria-hidden="true"></i><span localize="Refresh"></span></button></li><li ng-if="$ctrl.canDuplicatePage()"> <button ng-click="$ctrl.duplicateReportPage()" localize-tooltip="ReportAppBar_duplicateButton_Text" class="duplicate"><i class="glyphicon pbi-glyph-chromerestore glyph-small" aria-hidden="true"></i><span localize="ReportAppBar_duplicateButton_Text"></span></button></li><li ng-if="$ctrl.canSaveReport()"> <button ng-click="$ctrl.saveFromButton()" localize-tooltip="{{$ctrl.getSaveOrPublishTooltip()}}" class="save"><i class="glyphicon pbi-glyph-save glyph-small" aria-hidden="true"></i><ng-container ng-switch="$ctrl.canPublishToSharepointList()"> <span ng-switch-when="true">{{$ctrl.getSharePointPublishLabelText()}}</span><span ng-switch-default localize="ReportAppBar_SaveReportButton"></span></ng-container></button></li><li ng-if="$ctrl.viewModeState.getMode() === 1 && $ctrl.showPinPage() && $ctrl.canPinPage()"> <button localize-tooltip="ReportAppBar_PinPage" class="pin-report" ng-click="$ctrl.showPinReportPageDialog()"><i class="glyphicon pbi-glyph-pinned glyph-small"></i><span localize="ReportAppBar_PinPage"></span></button></li><li ng-if="$ctrl.showPinPage() && $ctrl.pinPageDisabled()"> <button localize-tooltip="PinTile_NotSupportedTitle" class="pin-disabled" disabled><i class="glyphicon pbi-glyph-pinned glyph-small"></i><span localize="ReportAppBar_PinPage"></span></button></li><li ng-if="$ctrl.canPause && !$ctrl.viewModeState.getConfig().pauseQueryExecution"> <button class="pause" localize-tooltip="ReportAppBar_PauseQueries" ng-click="$ctrl.togglePlayPause()"><span localize="ReportAppBar_PauseQueries"></span></button></li><li ng-if="$ctrl.canPause && $ctrl.viewModeState.getConfig().pauseQueryExecution"> <button class="play" localize-tooltip="ReportAppBar_ResumeQueries" ng-click="$ctrl.togglePlayPause()"><span localize="ReportAppBar_ResumeQueries"></span></button></li><li ng-if="$ctrl.isTeamsEnabled()"> <button localize-tooltip="ChatInTeams" ng-click="$ctrl.showShareToTeamsDialog()"><i class="glyphicon pbi-glyph-teamslogo glyph-mini"></i><span localize="ChatInTeams"></span></button></li><li ng-if="$ctrl.showNewUsageMetricsToggle()"><pbi-toggle on-state-text="UsageMetrics_NewUI_On" off-state-text="UsageMetrics_NewUI_Off" class="newUsageMetricsUI newUsageMetricsToggleButtonTutorialHook" ng-change="$ctrl.onNewUsageMetricsToggleChange()" ng-model="$ctrl.newUsageMetricsEnabled"></pbi-toggle></li><li class="moreOptionsItem" ng-if="$ctrl.showReportMoreOptionsMenu()"> <button class="moreOptionsDashboardButton glyphicon glyph-small pbi-glyph-more" ng-click="$ctrl.showMoreOptionsMenu($event)" localize-tooltip="Options_Menu" aria-haspopup="true" aria-expanded="{{$ctrl.isMoreOptionsMenuOpen}}"></button></li></ul></div></div>'),e.put("views/dropdowns/appBarMenu.html",'<dropdown-overlay dropdown-overlay-name="{{menuOverlayName}}" on-close="onClose()"><ul class="angular-dropdown explorationAppBarMenu active appThemeable" ng-class="{dark: getMode() === 0, themeableElement: themeable, fluentTheme: fluentThemeEnabled}" focus-trap role="menu"><li ng-repeat="item in getMenuActions()" ng-switch="::item.type" class="themeYellowDark" role="menuitem"> <button ng-switch-when="0" class="dropdown-item {{menuItemClass}}" ng-click="menuActionSelected(item); $event.stopPropagation(); $event.preventDefault()" ng-disabled="item.disabled" ng-class="{\'selected\': item.checked}" ng-attr-aria-pressed="{{ item.checkbox || item.checked ? !!item.checked : undefined }}" ng-attr-data-unique-id="{{item.action ? \'appBarMenu-\' + item.action : undefined}}" role="button"><div class="dropdown-content {{::item.itemClass}}"><i class="glyphicon glyph {{::item.itemClass}}" ng-attr-data-unique-id="{{item.action ? \'appBarMenuIcon-\' + item.action : undefined}}" ng-class="::{\'glyph-small\': glyphSmall}"></i><span class="dropdown-label" ng-bind="::item.text" title="{{::item.tooltip || item.text}}"></span><span ng-if="::item.description" class="dropdown-description" ng-bind="::item.description"></span><pbi-toggle ng-if="item.checkbox" ng-model="item.checked" ng-disabled="item.disabled" no-label ariahidden="true" on-state-text="ToggleSwitchOn" off-state-text="ToggleSwitchOff"></pbi-toggle></div></button><div ng-switch-when="1" ng-bind="::item.text" ng-attr-data-unique-id="{{ item.action ? \'appBarMenu-\' + item.action : undefined }}"></div><div ng-switch-when="2" class="dropdown-separator" role="separator"></div><app-bar-flyout-menu ng-switch-when="3" flyout-item="item" ng-attr-data-unique-id="{{ item.action ? \'appBarMenu-\' + item.action : undefined }}" menu-overlay-name="menuOverlayName" menu-item-class="menuItemClass" glyph-small="glyphSmall" get-mode="getMode()" menu-action-selected="menuActionSelected($item)"></app-bar-flyout-menu><pbi-lazy-load-modern ng-switch-when="4" [module-path]="item.lazyModulePath" [component-id]=\'item.lazyComponentId\'></pbi-lazy-load-modern></li></ul></dropdown-overlay>')}})(powerbi=powerbi||{}),(function(r){var e;(function(e){var i=r.common,t=r.explore.exploration.htmlTemplate.put;function o(){n||(r.explore.initializeAngularModule(),angular.module("powerbi.explore").run(["scopedProvider",function(e){e.register("explorationAppBarMixins",{services:[],scopedServices:[],fn:function(){return new r.common.MixinProvider([])}})}]).run(["$templateCache",t]),n=!0)}e.initializeAngularModule=o;var n=!(e.registerBuildingBlocksForHost=function(e){var t=[{name:"AppBarFlyoutMenu",blockType:2,consumerHostFlags:24874,factory:r.explore.components.AppBarFlyoutMenu},{name:"ExplorationAppBar",blockType:2,consumerHostFlags:24874,factory:r.explore.components.ExplorationAppBar}];i.registerBuildingBlocksForHost(e,t,{componentsTarget:"powerbi.explore.components",directivesTarget:"powerbi.explore.directives"})});o()})((e=r.explore||(r.explore={})).exploration||(e.exploration={}))})(powerbi=powerbi||{}),(function(e){(e=(e=e.explore||(e.explore={})).constants||(e.constants={})).serverErrorPrefix="ServerError_",e.configureScheduledRefreshLink="https://go.microsoft.com/fwlink/?linkid=844603"})(powerbi=powerbi||{}),(function(e){!(function(e){function t(e,t){this.services=t}e=e.controllers||(e.controllers={}),t.createOptions=function(){return{additionalServices:["dropdown","overlayService"]}},t.prototype.$onDestroy=function(){this.services.dropdown.hideAll()},t.prototype.openFlyout=function(e){var t=this,i=this.menuOverlayName+"Flyout",o=this.services.overlayService.getOverlayElement(i);_.isEmpty(o.length)&&(i={menuOverlayName:i,menuItemClass:this.menuItemClass,glyphSmall:this.glyphSmall,themeable:!0,menuActionSelected:function(e){return t.menuActionSelected({$item:e})},getMenuActions:function(){return t.flyoutItem.flyoutActions},getMode:function(){return t.getMode()}},e={anchorElement:$(e.currentTarget),blurNeeded:!1,disableAnimation:!0,preferLeft:!1,horizontal:!0},this.services.dropdown.showMenu(i,"appBarMenu.html",e))},e.AppBarFlyoutMenuController=t})(e.explore||(e.explore={}))})(powerbi=powerbi||{}),(function(e){var t;((t=e.explore||(e.explore={})).components||(t.components={})).AppBarFlyoutMenu={templateUrl:"components/appBarFlyoutMenu/appBarFlyoutMenu.html",controller:e.common.createController(t.controllers.AppBarFlyoutMenuController),bindings:{flyoutItem:"<",menuOverlayName:"<",menuItemClass:"<",glyphSmall:"<",getMode:"&",menuActionSelected:"&"}}})(powerbi=powerbi||{}),(function(e){var t,i,r,s,a;function c(e){if(e){var t=e.exploration,t=t&&t.contract&&t.contract.report,e=e.options&&e.options.isUsageMetricsReport;return t&&!e}}function o(e,t,i,o,n){return{text:e,description:t,action:n,itemClass:"displayOption "+i,type:DropDownMenuItemType.Item,param:s.toString(r,o).toLowerCase()}}t=e.explore||(e.explore={}),i=t.models||(t.models={}),s=jsCommon.EnumExtensions,a=e.visuals.shapeType.shape,(t=r=i.BasicShape||(i.BasicShape={}))[t.Rectangle=0]="Rectangle",t[t.Oval=1]="Oval",t[t.Line=2]="Line",t[t.Triangle=3]="Triangle",t[t.Arrow=4]="Arrow",(i=i.ExplorationAppBarViewModelFactory||(i.ExplorationAppBarViewModelFactory={})).createViewMenuActions=function(e,t,i,o,n,r,s,a,l){void 0===l&&(l=!0);var p=[];return(r=1===r)||p.push({text:e.get("ReportAppBar_ViewFitToPage"),action:"FitToPage",itemClass:"pbi-glyph-fittopage2",type:DropDownMenuItemType.Item,disabled:!1,checked:1===o,tooltip:e.get("ReportAppBar_ViewFitToPageDescription")},{text:e.get("FitToWidth"),action:"FitToWidth",itemClass:"pbi-glyph-fittowidth",type:DropDownMenuItemType.Item,disabled:!1,checked:2===o,tooltip:e.get("ReportAppBar_ViewFitToWidthDescription")},{text:e.get("ReportAppBar_ViewActualSize"),action:"ActualSize",itemClass:"pbi-glyph-actualsize",type:DropDownMenuItemType.Item,disabled:!1,checked:3===o,tooltip:e.get("ReportAppBar_ViewActualSizeDescription")},{action:null,type:DropDownMenuItemType.Separator}),p.push(function(e,t){t=[{text:e.get("None"),action:"HighContrastNone",itemClass:"pbi-glyph-blank",type:DropDownMenuItemType.Item,checked:null==t},{text:e.get("HighContrastMode_1"),action:"HighContrast1",itemClass:"pbi-glyph-blank",type:DropDownMenuItemType.Item,checked:"HighContrast1"===t},{text:e.get("HighContrastMode_2"),action:"HighContrast2",itemClass:"pbi-glyph-blank",type:DropDownMenuItemType.Item,checked:"HighContrast2"===t},{text:e.get("HighContrastMode_Black"),action:"HighContrastBlack",itemClass:"pbi-glyph-blank",type:DropDownMenuItemType.Item,checked:"HighContrastBlack"===t},{text:e.get("HighContrastMode_White"),action:"HighContrastWhite",itemClass:"pbi-glyph-blank",type:DropDownMenuItemType.Item,checked:"HighContrastWhite"===t}];return{text:e.get("HighContrastMode"),itemClass:"pbi-glyph-blankflyout",type:DropDownMenuItemType.Flyout,flyoutActions:t}}(e,n)),i&&(p.push({type:DropDownMenuItemType.Separator}),p.push({text:e.get("ReportAppBar_ShowSmartGuides"),action:"ShowSmartGuides",itemClass:"pbi-glyph-smartguides",type:DropDownMenuItemType.Item,disabled:!1,checkbox:!0,checked:t.getShowSmartGuides(),tooltip:e.get("ReportAppBar_ShowSmartGuidesDescription")}),p.push({text:e.get("ReportAppBar_ShowGrid"),action:"ShowGrid",itemClass:"pbi-glyph-showgrid",type:DropDownMenuItemType.Item,disabled:!1,checkbox:!0,checked:r?t.getShowGridlinesMobile():t.getShowGridlines(),tooltip:e.get("ReportAppBar_ShowGridDescription")}),p.push({text:e.get("ReportAppBar_SnapToGrid"),action:"SnapToGrid",itemClass:"pbi-glyph-snaptogrid",type:DropDownMenuItemType.Item,disabled:!1,checkbox:!0,checked:r?t.getSnapToGridMobile():t.getSnapToGrid(),tooltip:e.get("ReportAppBar_SnapToGridDescription")}),p.push({text:e.get("ReportAppBar_LockObjects"),action:"LockObjects",itemClass:"pbi-glyph-lock",type:DropDownMenuItemType.Item,disabled:!1,checkbox:!0,checked:!1})),p.push({type:DropDownMenuItemType.Separator}),p.push({text:e.get("ReportAppBar_Selection"),action:"ShowCanvasItems",itemClass:"pbi-glyph-show",type:DropDownMenuItemType.Item,disabled:!1,checkbox:!0,checked:!1,tooltip:e.get("ReportAppBar_Selection")}),l&&p.push({text:e.get("ReportAppBar_Bookmarks"),action:"ShowBookmarks",itemClass:"pbi-glyph-bookmark",type:DropDownMenuItemType.Item,disabled:!1,checkbox:!0,checked:!1,tooltip:e.get("ReportAppBar_Bookmarks")}),i&&!r&&p.push({text:e.get("ReportAppBar_SyncGroupPane"),action:"ShowSyncGroupPane",itemClass:"pbi-glyph-filtersync",type:DropDownMenuItemType.Item,disabled:!1,checkbox:!0,checked:!1,tooltip:e.get("ReportAppBar_SyncGroupPane")}),i&&s&&c(a)&&p.push({text:e.get("InsightsPane_ButtonText"),action:"GetAutomatedInsightsEdit",itemClass:"pbi-glyph-insight",type:DropDownMenuItemType.Item,disabled:!1,checkbox:!0,checked:!1}),p},i.createBookmarksMenuActions=function(){return[{type:DropDownMenuItemType.CustomComponent,lazyModulePath:"@powerbi/WebBookmarksUI/web-bookmarks-ui.module#WebBookmarksUIModule",lazyComponentId:"WebBookmarksComponentId"}]},i.createFileMenuActions=function(e){var t,i=e.localizationService,o=[];return e.showSave&&o.push({text:i.get("ReportAppBar_SaveToDashboard"),description:i.get("ReportAppBar_SaveToDashboardDescription"),action:"SaveToDashboard",itemClass:"pbi-glyph-save",type:DropDownMenuItemType.Item,tooltip:i.get("ReportAppBar_SaveToDashboardDescription")}),e.showSaveAs&&o.push({text:i.get("SaveAs"),description:i.get("ReportAppBar_SaveAsDescription"),action:"SaveAs",itemClass:"pbi-glyph-saveas",type:DropDownMenuItemType.Item,tooltip:i.get("ReportAppBar_SaveAsDescription")}),e.showPrint&&o.push({text:i.get("ReportAppBar_Print"),description:i.get("ReportAppBar_PrintDescription"),action:"Print",itemClass:"pbi-glyph-print",type:DropDownMenuItemType.Item,tooltip:i.get("ReportAppBar_PrintDescription")}),e.showSecurePublishToWeb&&o.push({text:i.get("Embed"),description:i.get("PublishToWebSecure_Description"),action:"SecurePublishToWeb",itemClass:"pbi-glyph-publishtoweb",type:DropDownMenuItemType.Item,tooltip:i.get("PublishToWebSecure_Description")}),e.showSharepointEmbed&&o.push({text:i.get("ReportAppBar_SharePointEmbed"),description:i.get("ReportAppBar_SharePointEmbedDescription"),action:"EmbedSharepoint",itemClass:"pbi-glyph-sharepoint",type:DropDownMenuItemType.Item,tooltip:i.get("ReportAppBar_SharePointEmbedDescription")}),e.showEmbed&&o.push({text:i.get("ReportAppBar_SnapshotEmbed"),description:i.get("ReportAppBar_SnapshotEmbedDescription"),action:"EmbedSnapshot",itemClass:"pbi-glyph-publishtoweb",type:DropDownMenuItemType.Item,tooltip:i.get("ReportAppBar_SnapshotEmbedDescription")}),e.showDiagnostics&&o.push({text:i.get("ReportAppBar_Diagnostics"),description:i.get("ReportAppBar_DiagnosticsDescription"),action:"ShowDiagnosticInfo",itemClass:"pbi-glyph-code",type:DropDownMenuItemType.Item,tooltip:i.get("ReportAppBar_DiagnosticsDescription")}),e.showPowerPoint&&o.push({text:i.get("ReportAppBar_PowerPoint"),description:i.get("ReportAppBar_PowerPointDescription"),action:"ExportPowerPoint",itemClass:"pbi-glyph-powerpoint",type:DropDownMenuItemType.Item,tooltip:i.get("ReportAppBar_PowerPointDescription"),disabled:e.isExportToPowerpointDisabled}),e.showPdf&&o.push({text:i.get("ReportAppBar_Pdf"),description:i.get("ReportAppBar_PdfDescription"),action:"ExportPdf",itemClass:"pbi-glyph-pdf",type:DropDownMenuItemType.Item,tooltip:i.get("ReportAppBar_PdfDescription"),disabled:e.isExportToPDFDisabled}),e.showDownloadReport&&(t=!e.canDownloadReport||e.downloadReportDenied,o.push({text:i.get("Download_File"),description:i.get("Download_File"),action:"DownloadReport",itemClass:"pbi-glyph-download2",type:DropDownMenuItemType.Item,disabled:t,tooltip:i.get(e.downloadReportTooltip)})),o},i.createExploreMenuActions=function(e,t){return[{text:e.get("VisualTable_Show"),action:"SeeData",itemClass:"pbi-glyph-seedata",type:DropDownMenuItemType.Item,disabled:!0,checkbox:!0,tooltip:t.isSeeDataMode?e.get("Ribbon_Tooltip_VisualTable_Disable"):e.get("Ribbon_Tooltip_VisualTable")},{type:DropDownMenuItemType.Separator},{text:e.get("DrillDownLevel"),action:"ExpandVisual",itemClass:"pbi-glyph-expand",type:DropDownMenuItemType.Item,disabled:!0,checked:!1,tooltip:e.get("DrillDownLevel_ToolTip")},{text:e.get("DrillDownLevelGrouped"),action:"ExpandVisualGrouped",itemClass:"pbi-glyph-inline-drill",type:DropDownMenuItemType.Item,disabled:!0,checked:!1,tooltip:e.get("DrillDownLevelGrouped_ToolTip")},{text:e.get("DrillUp"),action:"DrillUp",itemClass:"pbi-glyph-drillup",type:DropDownMenuItemType.Item,disabled:!0,checked:!1,tooltip:e.get("DrillUp_ToolTip")},{type:DropDownMenuItemType.Separator},{text:e.get("DrillDown"),action:"DrillDown",itemClass:"pbi-glyph-drilldowndisabled",type:DropDownMenuItemType.Item,checkbox:!0,disabled:!0,tooltip:t.isDrillDownMode?e.get("DrillMode_ToolTip"):e.get("DrillDown_ToolTip")},{text:e.get("Drillthrough"),action:"Drillthrough",itemClass:"pbi-glyph-drillthrough",type:DropDownMenuItemType.Item,checkbox:!0,disabled:!0,tooltip:t.isDrillthroughMode?e.get("DrillthroughMode_ToolTip"):e.get("Drillthrough_ToolTip")},{text:e.get("DataPointTable_Show"),action:"SeeRecords",itemClass:"pbi-glyph-drilltodetail",type:DropDownMenuItemType.Item,checkbox:!0,disabled:!0,tooltip:t.isDrillToDetailsMode?e.get("Ribbon_Tooltip_DataPointTable_On"):e.get("Ribbon_Tooltip_DataPointTable")}]},i.createBasicShapeMenuActions=function(e){return[o(e.get("ReportAppBar_ShapeRectangle"),e.get("ReportAppBar_ShapeRectangleDescription"),"shapeRectangle",r.Rectangle,"InsertShape"),o(e.get("ReportAppBar_ShapeOval"),e.get("ReportAppBar_ShapeOvalDescription"),"shapeOval",r.Oval,"InsertShape"),o(e.get("ReportAppBar_ShapeLine"),e.get("ReportAppBar_ShapeLineDescription"),"shapeLine",r.Line,"InsertShape"),o(e.get("ReportAppBar_ShapeTriangle"),e.get("ReportAppBar_ShapeTriangleDescription"),"shapeTriangle",r.Triangle,"InsertShape"),o(e.get("ReportAppBar_ShapeArrow"),e.get("ReportAppBar_ShapeArrowDescription"),"shapeArrow",r.Arrow,"InsertShape")]},i.createShapeMenuActions=function(e){for(var t=new Array,i=0,o=[{name:"ReportAppBar_ShapeRectangle",itemClass:"rectangle",arg:{shapeType:a.Rectangle}},{name:"ReportAppBar_ShapeOval",itemClass:"oval",arg:{shapeType:a.Oval}},{name:"Visual_Shape_TriangleIsoc",itemClass:"triangleIsoc",arg:{shapeType:a.TriangleIsoc}},{name:"ReportAppBar_ShapeLine",itemClass:"line",arg:{shapeType:a.Line}},{name:"ReportAppBar_ShapeArrow",itemClass:"arrowRight",arg:{shapeType:a.Arrow}}];i<o.length;i++){var n=o[i];t.push({text:e.get(n.name),action:"InsertShape",itemClass:"displayOption shape-"+n.itemClass,type:DropDownMenuItemType.Item,param:n.arg})}return t},i.createActionButtonMenuActions=function(e,t){for(var i=new Array,o=0,n=[{name:"Generic_LeftArrow",itemClass:"back",arg:"leftArrow"},{name:"Generic_RightArrow",itemClass:"rightarrow",arg:"rightArrow"},{name:"Reset",itemClass:"reload",arg:"reset"},{name:"Generic_Back",itemClass:"backarrow",arg:"back"},{name:"ReportAppBar_InfoIcon",itemClass:"info",arg:"information"},{name:"Generic_Help",itemClass:"help",arg:"help"},{name:"Generic_Qna",itemClass:"qna",arg:"qna"},{name:"Generic_Bookmark",itemClass:"bookmark",arg:"bookmarks"},{name:"ReportAppBar_Blank",itemClass:"blank",arg:"blank"}];o<n.length;o++){var r=n[o];i.push({text:e.get(r.name),action:"InsertActionButton",itemClass:"pbi-glyph-"+r.itemClass,type:DropDownMenuItemType.Item,param:r.arg})}return null!=t&&t.featureSwitches.navigatorVisuals&&i.push(function(e){for(var t=new Array,i=0,o=[{name:"Visual_PageNavigator",itemClass:"page",arg:"page"},{name:"Visual_BookmarkNavigator",itemClass:"bookmark",arg:"bookmark"}];i<o.length;i++){var n=o[i];t.push({text:e.get(n.name),action:"InsertNavigator",itemClass:"pbi-navigator-"+n.itemClass,type:DropDownMenuItemType.Item,param:n.arg})}return{text:e.get("ReportAppBar_Navigator"),itemClass:"pbi-glyph-blankflyout",type:DropDownMenuItemType.Flyout,flyoutActions:t}}(e)),i},i.createVisualInteractionsActions=function(e,t){var i=[{text:e.get("ReportAppBar_EditVisualInteractions"),action:"EditVisualInteractionsMode",itemClass:"pbi-glyph-visualinteraction",type:DropDownMenuItemType.Item,disabled:!1,checkbox:!0,checked:!1,tooltip:e.get("ReportAppBar_EditVisualInteractionsDescription")}];return i.push({text:e.get("ReportAppBar_DrillFilterOtherVisuals"),action:"DrillFilterOtherVisuals",itemClass:"pbi-glyph-drillFilterOtherVisuals",type:DropDownMenuItemType.Item,disabled:!1,checkbox:!0,checked:!1,tooltip:e.get("ReportAppBar_DrillFilterOtherVisualsDescription")}),i},i.createAlignmentMenuActions=function(e){return[{text:e.get("ReportAppBar_Left"),description:e.get("Align_Left"),action:"AlignLeft",itemClass:"alignAction",type:DropDownMenuItemType.Item},{text:e.get("ReportAppBar_Center"),description:e.get("Align_Center"),action:"AlignCenter",itemClass:"alignAction",type:DropDownMenuItemType.Item},{text:e.get("ReportAppBar_Right"),description:e.get("Align_Right"),action:"AlignRight",itemClass:"alignAction",type:DropDownMenuItemType.Item},{text:e.get("Top"),description:e.get("Align_Top"),action:"AlignTop",itemClass:"alignAction",type:DropDownMenuItemType.Item},{text:e.get("Middle"),description:e.get("Align_Middle"),action:"AlignMiddle",itemClass:"alignAction",type:DropDownMenuItemType.Item},{text:e.get("Bottom"),description:e.get("Align_Bottom"),action:"AlignBottom",itemClass:"alignAction",type:DropDownMenuItemType.Item}]},i.createDistributeMenuActions=function(e){return[{text:e.get("ReportAppBar_Horizontal"),description:e.get("ReportAppBar_HorizontalDescription"),action:"DistributeHorizontal",itemClass:"distributeAction",type:DropDownMenuItemType.Item},{text:e.get("ReportAppBar_Vertical"),description:e.get("ReportAppBar_VerticalDescription"),action:"DistributeVertical",itemClass:"distributeAction",type:DropDownMenuItemType.Item}]},i.createReportMoreOptionsMenuItems=function(e,t,i,o,n,r,s){var a=[];return i&&a.push({text:e.get("Report_GenerateQRCode"),action:"GenerateQR",tooltip:e.get("Report_GenerateQRCode"),type:DropDownMenuItemType.Item}),t&&(t=e.get("ReportAppBar_AnalyzeInExcelMenuItem_Text"),o?n||(t=e.format("Permission_ExploreRequiredForFeature",[e.get("ReportAppBar_AnalyzeInExcelMenuItem_Text")])):t=e.get("AnalyzeInExcelDenied_Tooltip"),a.push({text:e.get("ReportAppBar_AnalyzeInExcelMenuItem_Text"),action:"AnalyzeInExcel",tooltip:t,disabled:!o||!n,type:DropDownMenuItemType.Item})),r&&c(s)&&a.push({text:e.get("AutomatedInsights_AppBar_GetInsights"),action:"GetAutomatedInsightsEdit",tooltip:e.get("AutomatedInsights_AppBar_GetInsights"),disabled:!1,type:DropDownMenuItemType.Item}),a}})(powerbi=powerbi||{}),(function(s){var t,e,i,o,a,l,h,n,r,p;function c(e,t){this.scope=e,this.services=t,this.extensions={},this.viewModeState=this.services.viewModeState}t=s.explore||(s.explore={}),e=t.controllers||(t.controllers={}),i=t.services,o=s.common.angularInjectorController,a=i.events,l=s.telemetry.ExplorationAppBarAction,h=t.models.ExplorationAppBarViewModelFactory,n=s.explore.SectionUtils,r=i.selectionUtils,p=jsCommon.StringExtensions,c.createOptions=function(){return{additionalServices:["applicationOptions","activeFolderId","reportStore","highContrastCssGenerationService","dropdown","lazyProviderModern","localizationService","modalDialogService","explorationSerializer","featureSwitchService","errorService","checkUnsavedService","telemetryService","$window","overlayService","downloadReport","userInfo","settingsService","conceptualSchemaProxy","appService","modelService","$element","permissionService","appSettings"],scopedDependencies:["eventBridge","viewModeState","explorationNavigation","explorationCapabilities","explorationAppBarMixins","visibility","drill","selection","visualAuthoring","lazyScoped","dataSources","formFactor"]}},c.prototype.$onInit=function(){var o=this;this.basicShapeMenuActions=h.createBasicShapeMenuActions(this.services.localizationService),this.shapeMenuActions=h.createShapeMenuActions(this.services.localizationService),this.alignActions=h.createAlignmentMenuActions(this.services.localizationService),this.distributeActions=h.createDistributeMenuActions(this.services.localizationService),this.actionButtonMenuActions=h.createActionButtonMenuActions(this.services.localizationService,this.services.featureSwitchService);var e=this.services.featureSwitchService.featureSwitches;this.isFileMenuOpen=!1,this.isViewMenuOpen=!1,this.isExploreMenuOpen=!1,this.isButtonsMenuOpen=!1,this.isVisualInteractionMenuOpen=!1,this.isMoreOptionsMenuOpen=!1,e.pauseQueriesEnabled&&(this.canPause=!0),e.shapeVisual&&(this.shapeVisual=!0),this.updateMixins(),this.reportStoreSubscription=this.services.reportStore.selectedReport.subscribe((function(e){e&&o.extensions.email.getToolTipBasedOnEnableSubscription().then((function(e){o.toolTipBasedOnEnableSubscription=e}))})),this.scope.$watch((function(){return o.services.viewModeState.getMode()}),(function(e){o.onViewModeChanged(e)})),this.subscriptionManager=this.services.eventBridge.createChannelSubscriptionManager().subscribe(a.visibilityChanged,(function(){o.isPopOutMode=!!o.services.visibility.get()})).subscribe(a.canvasChanged,(function(){var e=o.services.explorationNavigation.getCurrentSection();o.isTransientPage=e.transient})).subscribe(a.onReportChanged,(function(e,t){var i=o.extensions.pinReportPage;i&&i.getPinnedToReportPage()&&(i.pinReportPage(),i.setPinnedToReportPage(!1))}));var n=this.extensions&&this.extensions.appConsumptionAppBarOperations;n&&(this.appConsumptionLazyLoadPath=n.getAppConsumptionModulePath(),this.appConsumptionNavPaneToggleLazyComponentId=n.getAppNavigationPaneToggleComponentId(),this.isAppNavToggleEnabledSubscription=n.getSelectedApp().subscribe((function(i){return __awaiter(o,void 0,s.Promise,(function(){var t=this;return __generator(this,(function(e){switch(e.label){case 0:return i?[3,1]:(this.isAppNavToggleEnabled=!1,this.shouldDisplayAppNavToggleSubscription&&(this.shouldDisplayAppNavToggleSubscription.unsubscribe(),this.shouldDisplayAppNavToggleSubscription=null),[3,3]);case 1:return this.shouldDisplayAppNavToggleSubscription?[3,3]:[4,n.init()];case 2:e.sent(),this.shouldDisplayAppNavToggleSubscription=n.shouldDisplayAppNavToggleInAppBar().subscribe((function(e){t.isAppNavToggleEnabled=e})),e.label=3;case 3:return[2]}}))}))})));e=this.extensions&&this.extensions.usageMetricsAppBarOperations;e&&e.getNewUsageMetricsSetting().then((function(e){o.newUsageMetricsEnabled=e})),this.initializeHighContrastRules()},c.prototype.$onDestroy=function(){this.subscriptionManager&&this.subscriptionManager.unsubscribeAll(),this.mixins.destroy(),this.isAppNavToggleEnabledSubscription&&this.isAppNavToggleEnabledSubscription.unsubscribe(),this.shouldDisplayAppNavToggleSubscription&&this.shouldDisplayAppNavToggleSubscription.unsubscribe(),this.reportStoreSubscription&&this.reportStoreSubscription.unsubscribe()},c.prototype.initializeHighContrastRules=function(){this.services.highContrastCssGenerationService.addRule(".themeableElement .inner-toggle-wrapper input[type=checkbox]~.toggleBox .toggleHandle","{ background-color: @buttonForegroundColor !important }"),this.services.highContrastCssGenerationService.addRule(".themeableElement .inner-toggle-wrapper > input","{ opacity: 0 !important }")},c.prototype.isTeamsEnabled=function(){return!this.isUsageMetricsReport()&&this.isReportLoaded()&&!(!this.extensions.teams||!this.extensions.teams.isDiscussInTeamsEnabled())},c.prototype.showShareToTeamsDialog=function(){this.extensions.teams;this.extensions.teams.showShareToTeamsDialog(1)},c.prototype.updateMixins=function(){this.mixins||(this.mixins=this.services.explorationAppBarMixins);var e=this;function t(){}this.mixins.update((Object.defineProperty(t.prototype,"viewModel",{get:function(){return e.viewModel},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"extensions",{get:function(){return e.extensions},enumerable:!1,configurable:!0}),new t))},c.prototype.onViewModeChanged=function(r){return __awaiter(this,void 0,s.Promise,(function(){var t,i,o,n;return __generator(this,(function(e){switch(e.label){case 0:return(t=1===r)?(this.scope.$emit("EditMode"),[4,this.services.lazyScoped("qnaLaunchService")]):[3,7];case 1:return(n=e.sent(),n.reportConfigAllowsQna({allowInViewMode:!1}))?[3,2]:(this.isQnaEnabled=!1,[3,6]);case 2:return[4,this.services.lazyScoped("qnaSupportabilityService")];case 3:return i=e.sent(),[4,this.services.lazyProviderModern.get("@powerbi/Qna/qnaweb.module#QnaWebModule","qnaSupportabilitytUtilsModern")];case 4:return o=e.sent(),[4,this.services.conceptualSchemaProxy.get(this.services.dataSources.get())];case 5:n=e.sent(),n=o.getIsQnaAllowedInfo(this.services.explorationCapabilities.getCapabilities(),n,i),this.isQnaEnabled=n.isAllowed,e.label=6;case 6:return[3,8];case 7:t||(this.scope.$emit("ViewMode"),this.isQnaEnabled=!1,this.viewModeState.updateConfig((function(e){e.showRelationships&&(e.showRelationships=!1)}))),e.label=8;case 8:return[2]}}))}))},c.prototype.getMoreOptionsMenuActions=function(){var e=this.extensions.analyzeInExcel,t=e&&e.canAnalyzeInExcel(),i=e&&e.canExploreModel(),o=e&&e.isAnalyzeInExcelSupported(),e=this.services.featureSwitchService.featureSwitches.automatedInsights&&this.services.featureSwitchService.featureSwitches.automatedInsightsEntryPointsEnabled&&!this.viewModeState.getConfig().disableGetInsights;return h.createReportMoreOptionsMenuItems(this.services.localizationService,o,this.canGenerateQR(),t,i,e,this.viewModel)},c.prototype.canEmbed=function(){var e=this.canReShareReport(),t=!this.isUsageMetricsReport()&&e&&this.extensions.embed&&this.extensions.embed.canEmbed();if(this.services.featureSwitchService.featureSwitches.sharedDatasetDiscovery){e=this.extensions.sharedDataset&&this.viewModel.datasetModel&&this.extensions.sharedDataset.isLinked(this.viewModel.datasetModel);return t&&!e}return t},c.prototype.canSecurePublishToWeb=function(){return!this.isUsageMetricsReport()&&this.extensions.embed&&this.extensions.embed.canSecurePublishToWeb()},c.prototype.canSharePointEmbed=function(){return!this.isUsageMetricsReport()&&this.extensions.embed&&this.extensions.embed.canSharePointEmbed()},c.prototype.canExportToPowerPoint=function(){return!this.isUsageMetricsReport()&&this.isNonExternalUser()&&this.extensions.exportToFile&&this.extensions.exportToFile.canExportToFile(1)},c.prototype.canExportToPdf=function(){return!this.isUsageMetricsReport()&&this.isNonExternalUser()&&this.extensions.exportToFile&&this.extensions.exportToFile.canExportToFile(0)},c.prototype.isExportToPdfDisabled=function(){var e=this.extensions.exportToFile;return e&&e.isExportDisabled(0)},c.prototype.isExportToPowerPointDisabled=function(){var e=this.extensions.exportToFile;return e&&e.isExportDisabled(1)},c.prototype.canDuplicatePage=function(){return this.canSaveReport()&&!this.isPopOutMode&&!this.isTransientPage},c.prototype.canSaveReport=function(){var e;return null===(e=this.extensions.fileOperations)||void 0===e?void 0:e.canSave(this.services.explorationNavigation.getCurrentSection())},c.prototype.getSharePointPublishLabelText=function(){return"documentLibrary"===(this.extensions.sharepointListOperations&&this.extensions.sharepointListOperations.getSharePointArtifactType())?this.services.localizationService.get("SharePointList_Publish_DocLib"):this.services.localizationService.get("SharePointList_Publish")},c.prototype.getSaveOrPublishTooltip=function(){var e=this.extensions.sharepointListOperations&&this.extensions.sharepointListOperations.getSharePointArtifactType();return this.canPublishToSharepointList()?"documentLibrary"===e?"SharePointList_Publish_DocLib":"SharePointList_Publish":"ReportAppBar_SaveToDashboardDescription"},c.prototype.canPublishToSharepointList=function(){return this.extensions.sharepointListOperations&&this.extensions.sharepointListOperations.isSharepointListReport(this.viewModel.exploration)},c.prototype.canPinPage=function(){var e=this.viewModel,t=this.viewModel.canEdit,t=this.services.featureSwitchService.featureSwitches.pinReadable?this.canPin():t;return e&&t&&e.exploration&&e.exploration.contract.reportId&&!this.isTransientPage&&!this.canPublishToSharepointList()},c.prototype.pinPageDisabled=function(){var e=this.viewModel;return this.services.featureSwitchService.featureSwitches.pinReadable?e&&!this.canPin():e&&!e.canCopy&&!e.canEdit},c.prototype.showPinPage=function(){return!this.services.explorationCapabilities.getCapabilities().disablePin},c.prototype.canGenerateQR=function(){return!this.isUsageMetricsReport()&&this.extensions.qrCode&&this.extensions.qrCode.canGenerateQRCode()},c.prototype.getFileMenuActions=function(){var e,t=this.createFileMenuActions(),i=_.find(t,(function(e){return"SaveAs"===e.action})),o=this.viewModel.datasetModel,n=o&&o.contentProviderId;return n&&i&&this.isUsageMetricsReport()&&(e=this.services.localizationService,o="ReportAppBar_SaveAsDescriptionForUsageMetrics",i.description=103===n?e.format(o,[e.get("ReportAppBar_DashboardsKeyword")]):e.format(o,[e.get("ReportAppBar_ReportsKeyword")])),t},c.prototype.onEmbed=function(){return __awaiter(this,void 0,s.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return t=this.extensions.embed,this.services.telemetryService.logEvent(l,{action:"EmbedSnapshot"}),[4,t.embed()];case 1:return e.sent(),[2]}}))}))},c.prototype.onSecurePublishToWeb=function(){return __awaiter(this,void 0,s.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return t=this.extensions.embed,this.services.telemetryService.logEvent(l,{action:"SecurePublishToWeb"}),[4,t.securePublishToWeb()];case 1:return e.sent(),[2]}}))}))},c.prototype.onSharepointEmbed=function(){return __awaiter(this,void 0,s.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return t=this.extensions.embed,this.services.telemetryService.logEvent(l,{action:"EmbedSharepoint"}),[4,t.sharePointEmbed()];case 1:return e.sent(),[2]}}))}))},c.prototype.addQnaContainer=function(){this.services.eventBridge.publishToChannel(a.addQnaContainer,{creationSource:8})},c.prototype.insertTextbox=function(){this.services.eventBridge.publishToChannel(a.createTextbox)},c.prototype.showSwitchMode=function(){return!this.services.explorationCapabilities.getCapabilities().disableSwitchMode},c.prototype.showReportMoreOptionsMenu=function(){return!this.services.explorationCapabilities.getCapabilities().disableMoreOptions&&!!this.viewModel.reportPermission&&0<this.getMoreOptionsMenuActions().length},c.prototype.fileMenuActionSelected=function(e){if(!e.disabled)switch(e.action){case"SaveToDashboard":this.save(0);break;case"SaveAs":this.saveAs();break;case"EmbedSnapshot":this.onEmbed();break;case"EmbedSharepoint":this.onSharepointEmbed();break;case"Print":this.print();break;case"ShowDiagnosticInfo":this.showDiagnosticInfo();break;case"ExportPowerPoint":this.exportToPowerPoint();break;case"ExportPdf":this.exportToPdf();break;case"ExportStorytelling":this.exportToStorytelling();break;case"DownloadReport":this.downloadReport();break;case"SecurePublishToWeb":this.onSecurePublishToWeb()}},c.prototype.createFileMenuActions=function(){var e=this.viewModeState.getMode(),t=this.services.explorationCapabilities.getCapabilities(),e={localizationService:this.services.localizationService,showSave:!t.disableSave&&1===e,showSaveAs:this.canSaveAs(),showPrint:this.canPrint(),showEmbed:this.canEmbed(),showSecurePublishToWeb:this.canSecurePublishToWeb(),showSharepointEmbed:this.canSharePointEmbed(),showPowerPoint:this.canExportToPowerPoint(),showPdf:this.canExportToPdf(),showDiagnostics:this.services.applicationOptions.diagnostics,showDownloadReport:this.showDownloadReport(),canDownloadReport:this.canDownloadReport(),downloadReportDenied:this.downloadReportDenied(),downloadReportTooltip:this.getDownloadReportTooltip(),isExportToPDFDisabled:this.isExportToPdfDisabled(),isExportToPowerpointDisabled:this.isExportToPowerPointDisabled()};return h.createFileMenuActions(e)},c.prototype.showDiagnosticInfo=function(){var e,t;this.viewModel.exploration&&this.viewModel.exploration.contract&&(e=this.services.rootScope.$new(),t=this.services.explorationSerializer.serializeExploration(this.viewModel.exploration.contract),t=p.stringifyAsPrettyJSON(t),this.services.modalDialogService.showLegacyWebModalDialog({dialogName:"",isDismissable:!0,scope:e,template:"<custom-modal-dialog></custom-modal-dialog>",dialogCssClass:"monotype",notificationText:t}))},c.prototype.alignActionSelected=function(e){switch(e.action){case"AlignLeft":this.align(0);break;case"AlignCenter":this.align(1);break;case"AlignRight":this.align(2);break;case"AlignTop":this.align(3);break;case"AlignMiddle":this.align(4);break;case"AlignBottom":this.align(5)}},c.prototype.distributeActionSelected=function(e){switch(e.action){case"DistributeHorizontal":this.align(6);break;case"DistributeVertical":this.align(7)}},c.prototype.align=function(e){this.services.eventBridge.publishToChannel(a.align,{alignmentType:e})},c.prototype.canPrint=function(){return this.extensions.fileOperations&&this.extensions.fileOperations.canPrintPage()},c.prototype.print=function(){var e=this.extensions.fileOperations;e.printPage()},c.prototype.saveFromButton=function(){this.save(1)},c.prototype.save=function(e){var t;null!==(t=this.extensions.fileOperations)&&void 0!==t&&t.save(e)},c.prototype.canSaveAs=function(){return this.extensions.fileOperations&&this.extensions.fileOperations.canSaveAs()},c.prototype.saveAs=function(){var e=this.extensions.fileOperations;e.saveAs()},c.prototype.refresh=function(){var e=this.extensions.fileOperations;e.refresh()},c.prototype.stopEditing=function(){this.setFormFactor(0),this.services.eventBridge.publishToChannel(a.requestViewModeChange,0)},c.prototype.navigateBack=function(){this.services.$window.history.back()},c.prototype.exportToPowerPoint=function(){var e=this.extensions.exportToFile;e.exportToFile(1)},c.prototype.exportToPdf=function(){var e=this.extensions.exportToFile;e.exportToFile(0)},c.prototype.exportToStorytelling=function(){var e=this.extensions.exportToStorytelling;null!=e&&e.exportToStorytelling()},c.prototype.viewMenuActionSelected=function(e){if(null!=e.action){var t=1===this.getCanvasLayout();if("ShowGrid"===e.action){var i=e.checked=t?!this.services.settingsService.getShowGridlinesMobile():!this.services.settingsService.getShowGridlines(),o=this.services.telemetryService.startEvent(l,{action:e.action,booleanValue:i});t?this.services.settingsService.setShowGridlinesMobile(i,o):this.services.settingsService.setShowGridlines(i,o)}else if("ShowSmartGuides"===e.action){var i=e.checked=!this.services.settingsService.getShowSmartGuides(),n=this.services.telemetryService.startEvent(l,{action:e.action,booleanValue:i});this.services.settingsService.setShowSmartGuides(i,n)}else if("SnapToGrid"===e.action){i=e.checked=t?!this.services.settingsService.getSnapToGridMobile():!this.services.settingsService.getSnapToGrid(),n=this.services.telemetryService.startEvent(l,{action:e.action,booleanValue:i});t?this.services.settingsService.setSnapToGridMobile(i,n):this.services.settingsService.setSnapToGrid(i,n)}else if("ShowBookmarks"===e.action)this.viewModel.bookmarksPane.isPaneVisible=e.checked=!this.viewModel.bookmarksPane.isPaneVisible,this.services.telemetryService.logEvent(l,{action:e.action,booleanValue:e.checked});else if("ShowCanvasItems"===e.action)this.viewModel.canvasItemsPane.isPaneVisible=e.checked=!this.viewModel.canvasItemsPane.isPaneVisible,this.services.telemetryService.logEvent(l,{action:e.action,booleanValue:e.checked});else if("LockObjects"===e.action){i=e.checked=t?!this.services.settingsService.getLockObjectsMobile():!this.services.settingsService.getLockObjects();this.services.telemetryService.logEvent(l,{action:e.action,booleanValue:i}),t?this.services.settingsService.setLockObjectsMobile(i):this.services.settingsService.setLockObjects(i)}else if("ShowSyncGroupPane"===e.action)this.viewModel.syncGroupPane.isPaneVisible=e.checked=!this.viewModel.syncGroupPane.isPaneVisible,this.services.telemetryService.logEvent(l,{action:e.action,booleanValue:e.checked});else if("HighContrast1"===e.action||"HighContrast2"===e.action||"HighContrastBlack"===e.action||"HighContrastWhite"===e.action||"HighContrastNone"===e.action){var r=void 0;switch(e.action){case"HighContrast1":r="HighContrast1";break;case"HighContrast2":r="HighContrast2";break;case"HighContrastBlack":r="HighContrastBlack";break;case"HighContrastWhite":r="HighContrastWhite";break;default:r="None"}this.services.eventBridge.publishToChannel(a.highContrastModeChanged,r),this.services.telemetryService.logEvent(l,{action:e.action})}else if("GetAutomatedInsightsEdit"===e.action)this.viewModel.insightsPane.isPaneVisible=e.checked=!this.viewModel.insightsPane.isPaneVisible,this.viewModel.insightsPane.isPaneVisible?this.openAutomatedInsightsPane():this.closeAutomatedInsightsPane();else{var s=void 0;switch(e.action){case"Dynamic":s=0;break;case"ActualSize":s=3;break;case"FitToWidth":s=2;break;case"FitToPage":s=1}this.services.eventBridge.publishToChannel(a.canvasDisplayChanged,s),this.services.telemetryService.logEvent(l,{action:e.action})}}},c.prototype.visualInteractionsMenuActionSelected=function(e){null!=e.action&&("EditVisualInteractionsMode"===e.action?(this.toggleEditVisualInteractionsMode(),e.checked=this.viewModeState.getConfig().showRelationships,this.services.telemetryService.logEvent(l,{action:e.action,booleanValue:e.checked})):"DrillFilterOtherVisuals"===e.action&&(this.toggleSelectedVisualDrillFilterOtherVisuals(),e.checked=this.getDrillFilterOtherVisualsSetting(),this.services.telemetryService.logEvent(l,{action:e.action,booleanValue:e.checked})))},c.prototype.getDrillFilterOtherVisualsSetting=function(){var e=r.getSelectedVisual(this.services.selection);return e&&e.drillFilterOtherVisuals},c.prototype.shouldShowBasicShapeMenu=function(){return this.shouldShowShapeItem()&&!this.shapeVisual&&!!this.basicShapeMenuActions},c.prototype.shouldShowNewShapeMenu=function(){return this.shouldShowShapeItem()&&this.shapeVisual&&!!this.shapeMenuActions},c.prototype.shouldShowShapeItem=function(){return 1===this.viewModeState.getMode()&&!this.isPopOutMode},c.prototype.basicShapeMenuActionSelected=function(e){this.services.eventBridge.publishToChannel(a.createBasicShape,{shapeType:e.param})},c.prototype.shapeMenuActionSelected=function(e){this.services.eventBridge.publishToChannel(a.createShape,e.param)},c.prototype.actionButtonMenuActionSelected=function(e){switch(e.action){case"InsertActionButton":this.services.eventBridge.publishToChannel(a.createActionButton,{iconType:e.param});break;case"InsertNavigator":this.services.eventBridge.publishToChannel(a.createNavigator,{navigatorType:e.param})}},c.prototype.togglePlayPause=function(){this.services.eventBridge.publishToChannel(a.pauseQueriesChanged)},c.prototype.getToolTipBasedOnEnableSubscription=function(){return this.toolTipBasedOnEnableSubscription},c.prototype.showShareSlider=function(){return __awaiter(this,void 0,s.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.extensions.share.share()];case 1:return e.sent(),[2]}}))}))},c.prototype.showViewMenu=function(){return!this.isPopOutMode},c.prototype.showReadingViewButton=function(){var e;return this.showSwitchMode()&&1===this.viewModeState.getMode()&&this.viewModel.canEdit&&!n.areAnySectionQuickExplore(null===(e=null===(e=this.viewModel.exploration)||void 0===e?void 0:e.contract)||void 0===e?void 0:e.sections)},c.prototype.showWebLayoutButton=function(){return 0!==this.getCanvasLayout()&&this.showReadingViewButton()},c.prototype.showPhoneLayoutButton=function(){return 0===this.getCanvasLayout()&&this.showReadingViewButton()},c.prototype.showAppBarRight=function(){return 0===this.services.formFactor.getCurrentLayout()},c.prototype.showPinReportPageDialog=function(){var e=this.extensions.pinReportPage;e.showPinReportPageDialog()},c.prototype.setFormFactor=function(e){this.services.formFactor.changeFormFactor(e,this.viewModel)},c.prototype.getCanvasLayout=function(){return this.services.formFactor.getCurrentLayout()},c.prototype.setPhonePortraitFormFactor=function(){this.setFormFactor(1)},c.prototype.setMasterFormFactor=function(){this.setFormFactor(0)},c.prototype.duplicateReportPage=function(){var e=this.services.explorationNavigation.getCurrentSection(),e=t.SectionUtils.findSectionIndexForSection(this.viewModel.exploration.contract,e);this.services.eventBridge.publishToChannel(a.duplicateSection,e)},c.prototype.showDatasetErrorDetails=function(){var e;this.viewModel.datasetModel&&(e=this.services.localizationService,this.services.errorService.error(e.get("InternalSystemErrorMessage"),"ExplorationAppBar_DatasetError",{title:e.get("InternalSystemErrorTitle")}))},c.prototype.toggleEditVisualInteractionsMode=function(){this.services.eventBridge.publishToChannel(a.visualRelationshipsModeChanged)},c.prototype.toggleSelectedVisualDrillFilterOtherVisuals=function(){this.services.visualAuthoring.toggleDrillFilterOtherVisualsSetting()},c.prototype.reportMoreOptionsMenuSelected=function(e){switch(e.action){case"AnalyzeInExcel":this.analyzeInExcel();break;case"GenerateQR":this.generateQRCode();break;case"GetAutomatedInsightsEdit":this.viewModel.insightsPane.isPaneVisible=!this.viewModel.insightsPane.isPaneVisible,this.viewModel.insightsPane.isPaneVisible?this.openAutomatedInsightsPane():this.closeAutomatedInsightsPane();break;default:e.action}},c.prototype.openAutomatedInsightsPane=function(){var t;return __awaiter(this,void 0,s.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return this.services.telemetryService.logEvent(l,{action:"GetAutomatedInsightsEdit"}),[4,this.services.lazyScoped("automatedInsightsQuery")];case 1:return e.sent().showAutomatedInsights({queryOptions:{summarySelectionOptions:{visualsToSummarize:null!==(t=null===(t=this.services.explorationNavigation.getCurrentSection())||void 0===t?void 0:t.visualContainers)&&void 0!==t?t:[]},updateProcessingState:!0},enforcePremiumLicensing:!0,entryPoint:"AppBarEdit",viewOnlyNoteworthy:!1}),[2]}}))}))},c.prototype.closeAutomatedInsightsPane=function(){return __awaiter(this,void 0,s.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.services.lazyScoped("insightsPaneStateManager")];case 1:return e.sent().resetPaneState(),[2]}}))}))},c.prototype.exploreMenuActionSelected=function(e,t){if(!e.disabled)switch(e.action){case"SeeData":this.toggleSeeDataMode();break;case"ExpandVisual":this.drillDownLevel(3);break;case"ExpandVisualGrouped":this.drillDownLevel(2);break;case"DrillUp":this.drillUp();break;case"DrillDown":this.setDrillMode(1,t);break;case"Drillthrough":this.setDrillMode(3,t);break;case"SeeRecords":this.setDrillMode(2,t)}},c.prototype.isUsageMetricsReport=function(){return this.viewModel.options&&this.viewModel.options.isUsageMetricsReport},c.prototype.getExploreMenuActions=function(){for(var e=this.getSelectedVisual(),t=this.services.explorationCapabilities.getCapabilities().disableExploreActions,i=this.services.visibility.get(),o=i&&this.services.visibility.isSeeDataMode(i.visibility),n=this.services.drill.isDrillModeEnabled(e,1),r=this.services.drill.isDrillModeEnabled(e,3),s=this.services.drill.isDrillModeEnabled(e,2),i=h.createExploreMenuActions(this.services.localizationService,{isSeeDataMode:o,isDrillDownMode:n,isDrillthroughMode:r,isDrillToDetailsMode:s}),a=0,l=i;a<l.length;a++){var p=l[a];switch(p.action){case"SeeData":p.checked=o,p.disabled=t||!this.services.drill.canSeeData(e);break;case"ExpandVisual":p.disabled=t||!this.services.drill.canDrillByDirection(e,4);break;case"ExpandVisualGrouped":p.disabled=t||!this.services.drill.canDrillByDirection(e,2);break;case"DrillDown":p.checked=n;var c=this.services.drill.canDrillByDirection(e,4),u=this.services.drill.canDrillByDirection(e,1);p.disabled=t||!c&&!u;break;case"Drillthrough":p.checked=r,p.disabled=t||!this.services.drill.canDrillthrough(e);break;case"DrillUp":p.disabled=t||!this.services.drill.canDrillByDirection(e,1);break;case"SeeRecords":p.checked=s,p.disabled=t||!this.services.drill.canDrillToDetails(e)}}return i},c.prototype.toggleSeeDataMode=function(){var e,t=this.services.visibility.get()||this.getSelectedVisual();t&&(2===(e=t.visibility)||8===e?this.services.visibility.clear():this.services.visibility.set(t,2))},c.prototype.drillUp=function(){this.services.visualAuthoring.drillUp(null,this.getSelectedVisual())},c.prototype.drillDownLevel=function(e){this.services.visualAuthoring.drillDownLevel(null,this.getSelectedVisual(),e)},c.prototype.setDrillMode=function(e,t){var i=this.getSelectedVisual();if(i){var o=i.drillMode;this.services.drill.setDrillMode(i,o===e?0:e);for(var n=0,r=t;n<r.length;n++){var s=r[n];"DrillDown"===s.action?s.checked=this.services.drill.isDrillModeEnabled(i,1):"Drillthrough"===s.action?s.checked=this.services.drill.isDrillModeEnabled(i,3):"SeeRecords"===s.action&&(s.checked=this.services.drill.isDrillModeEnabled(i,2))}}},c.prototype.getFileMenuProperties=function(e){var t=this;return{menuName:"fileMenu",displayOptions:{anchorElement:e,blurNeeded:!1,disableAnimation:!0,preferLeft:!1},menuActions:this.getFileMenuActions(),menuActionSelected:function(e){return t.fileMenuActionSelected(e)}}},c.prototype.getViewMenuProperties=function(e){var t=this;return{menuName:"viewMenu",menuItemClass:"view-menu",glyphSmall:!0,displayOptions:{anchorElement:e,blurNeeded:!1,disableAnimation:!0,preferLeft:!1},menuActions:this.getViewMenuActions(),menuActionSelected:function(e){return t.viewMenuActionSelected(e)}}},c.prototype.getBookmarksMenuProperties=function(e){return this.extensions.bookmark.getBookmarksMenuProperties(e,this.viewMenuActionSelected,!1)},c.prototype.getShapeMenuProperties=function(e){var t=this;return{menuName:"shapeMenu",menuItemClass:"shape-menu",glyphSmall:!0,displayOptions:{anchorElement:e,blurNeeded:!1,disableAnimation:!0,preferLeft:!1},menuActions:this.shapeMenuActions,menuActionSelected:function(e){return t.shapeMenuActionSelected(e)}}},c.prototype.getActionButtonMenuProperties=function(e){var t=this;return{menuName:"actionButtonMenu",menuItemClass:"actionButton-menu",glyphSmall:!0,displayOptions:{anchorElement:e,blurNeeded:!1,disableAnimation:!0,preferLeft:!1},menuActions:this.actionButtonMenuActions,menuActionSelected:function(e){return t.actionButtonMenuActionSelected(e)}}},c.prototype.getExploreMenuProperties=function(e){var t=this,i=this.getExploreMenuActions();return{menuName:"exploreMenu",menuItemClass:"explore",glyphSmall:!0,displayOptions:{anchorElement:e,blurNeeded:!1,disableAnimation:!0,preferLeft:!1},menuActions:i,menuActionSelected:function(e){return t.exploreMenuActionSelected(e,i)}}},c.prototype.getVisualInteractionsMenuProperties=function(e){var t=this;return{menuName:"visualInteractionsMenu",menuItemClass:"visualInteractions-menu",glyphSmall:!0,displayOptions:{anchorElement:e,blurNeeded:!1,disableAnimation:!0,preferLeft:!1},menuActions:this.getVisualInteractionsMenuActions(),menuActionSelected:function(e){return t.visualInteractionsMenuActionSelected(e)}}},c.prototype.getMoreOptionsMenuProperties=function(e){var t=this;return{menuName:"reportMoreOptionsMenu",menuItemClass:"moreOptions",displayOptions:{anchorElement:e,blurNeeded:!1,preferLeft:!0},menuActions:this.getMoreOptionsMenuActions(),menuActionSelected:function(e){return t.reportMoreOptionsMenuSelected(e)}}},c.prototype.isMenuDisabled=function(e){return _.every(e.menuActions,(function(e){return e.disabled||!e.action}))},c.prototype.showFileMenu=function(e){var t=this;this.isFileMenuOpen||(this.isFileMenuOpen=!0,this.extensions.dropdownMenu.showMenu(e,(function(e){return t.getFileMenuProperties(e)}),this.viewModeState.getMode(),!1,this.services.$element.inheritedData(o),(function(){return setTimeout((function(){return t.isFileMenuOpen=!1}),100)})))},c.prototype.showViewDropdown=function(e){var t=this;this.isViewMenuOpen||(this.isViewMenuOpen=!0,this.extensions.dropdownMenu.showMenu(e,(function(e){return t.getViewMenuProperties(e)}),this.viewModeState.getMode(),!1,this.services.$element.inheritedData(o),(function(){return setTimeout((function(){return t.isViewMenuOpen=!1}),100)})))},c.prototype.showExploreMenu=function(e){var t=this;this.isExploreMenuOpen||(this.isExploreMenuOpen=!0,this.extensions.dropdownMenu.showMenu(e,(function(e){return t.getExploreMenuProperties(e)}),this.viewModeState.getMode(),!1,this.services.$element.inheritedData(o),(function(){return setTimeout((function(){return t.isExploreMenuOpen=!1}),100)})))},c.prototype.showShapeMenu=function(e){var t=this;this.isShapeMenuOpen||(this.isShapeMenuOpen=!0,this.extensions.dropdownMenu.showMenu(e,(function(e){return t.getShapeMenuProperties(e)}),this.viewModeState.getMode(),!1,this.services.$element.inheritedData(o),(function(){return setTimeout((function(){return t.isShapeMenuOpen=!1}),100)})))},c.prototype.showActionMenu=function(e){var t=this;this.isButtonsMenuOpen||(this.isButtonsMenuOpen=!0,this.extensions.dropdownMenu.showMenu(e,(function(e){return t.getActionButtonMenuProperties(e)}),this.viewModeState.getMode(),!1,this.services.$element.inheritedData(o),(function(){return setTimeout((function(){return t.isButtonsMenuOpen=!1}),100)})))},c.prototype.showVisualInteractionMenu=function(e){var t=this;this.isVisualInteractionMenuOpen||(this.isVisualInteractionMenuOpen=!0,this.extensions.dropdownMenu.showMenu(e,(function(e){return t.getVisualInteractionsMenuProperties(e)}),this.viewModeState.getMode(),!1,this.services.$element.inheritedData(o),(function(){return setTimeout((function(){return t.isVisualInteractionMenuOpen=!1}),100)})))},c.prototype.showMoreOptionsMenu=function(e){var t=this;this.isMoreOptionsMenuOpen||(this.isMoreOptionsMenuOpen=!0,this.extensions.dropdownMenu.showMenu(e,(function(e){return t.getMoreOptionsMenuProperties(e)}),this.viewModeState.getMode(),!1,this.services.$element.inheritedData(o),(function(){return setTimeout((function(){return t.isMoreOptionsMenuOpen=!1}),100)})))},c.prototype.getSelectedVisual=function(){return r.getSelectedVisual(this.services.selection)},c.prototype.getDisplayOption=function(){return this.viewModel&&this.viewModel.exploration&&this.viewModel.exploration.exploreCanvas&&this.viewModel.exploration.exploreCanvas.contract&&this.viewModel.exploration.exploreCanvas.contract.size&&this.viewModel.exploration.exploreCanvas.contract.size.displayOption},c.prototype.getViewMenuActions=function(){for(var e=this.getDisplayOption(),t=this.services.explorationCapabilities.getCapabilities(),i=this.services.explorationNavigation.getCurrentExploration(),o=i&&i.themeCollection.highContrastTheme,n=this.getCanvasLayout(),r=1===n,i=this.services.featureSwitchService.featureSwitches.automatedInsights&&this.services.featureSwitchService.featureSwitches.automatedInsightsEntryPointsEnabled&&!this.viewModeState.getConfig().disableGetInsights,t=h.createViewMenuActions(this.services.localizationService,this.services.settingsService,1===this.viewModeState.getMode(),this.getDisplayOption(),o&&o.name,n,i,this.viewModel,!t.disableBookmarksPane),s=0,a=t;s<a.length;s++){var l=a[s];"Dynamic"===l.action?l.checked=0===e:"FitToPage"===l.action?l.checked=1===e:"FitToWidth"===l.action?l.checked=2===e:"ActualSize"===l.action?l.checked=3===e:"ShowGrid"===l.action?l.checked=r?this.services.settingsService.getShowGridlinesMobile():this.services.settingsService.getShowGridlines():"ShowSmartGuides"===l.action?l.checked=this.services.settingsService.getShowSmartGuides():"SnapToGrid"===l.action?l.checked=r?this.services.settingsService.getSnapToGridMobile():this.services.settingsService.getSnapToGrid():"ShowBookmarks"===l.action?l.checked=this.viewModel.bookmarksPane.isPaneVisible:"ShowCanvasItems"===l.action?l.checked=this.viewModel.canvasItemsPane.isPaneVisible:"LockObjects"===l.action?l.checked=r?this.services.settingsService.getLockObjectsMobile():this.services.settingsService.getLockObjects():"ShowSyncGroupPane"===l.action?l.checked=this.viewModel.syncGroupPane.isPaneVisible:"GetAutomatedInsightsEdit"===l.action&&(l.checked=this.viewModel.insightsPane.isPaneVisible)}return t},c.prototype.getVisualInteractionsMenuActions=function(){for(var e=h.createVisualInteractionsActions(this.services.localizationService,this.services.featureSwitchService),t=0,i=e;t<i.length;t++){var o=i[t];"EditVisualInteractionsMode"===o.action&&(o.checked=this.viewModeState.getConfig().showRelationships),"DrillFilterOtherVisuals"===o.action&&(o.checked=this.getDrillFilterOtherVisualsSetting(),o.disabled=!this.getSelectedVisual())}return e},c.prototype.isNonExternalUser=function(){return _.isEmpty(this.services.appSettings.externalTenantId)},c.prototype.isReportLoaded=function(){if(!this.viewModel)return!1;var e=this.viewModel.exploration;return null!=(e&&e.contract&&e.contract.report)},c.prototype.canPin=function(){return this.isReportLoaded()&&this.extensions.pinReportPage&&this.extensions.pinReportPage.canPinReportPage()},c.prototype.canCopyAppReport=function(){var e=this.viewModel.exploration,t=e&&e.contract&&e.contract.report&&e.contract.report.packageId,e=this.services.appService.getAppInstance(t),t=e&&e.allowCopyContent,e=this.viewModel.datasetModel&&this.services.permissionService.isExplorableModelContract(this.viewModel.datasetModel);return this.services.featureSwitchService.featureSwitches.allowExploreDatasetOfApp&&t&&e},c.prototype.showNewUsageMetricsToggle=function(){var e=this.viewModel.exploration,e=e&&e.contract&&e.contract.report;return this.isUsageMetricsReport()&&this.extensions&&this.extensions.usageMetricsAppBarOperations&&this.extensions.usageMetricsAppBarOperations.isNewUsageMetricsEnabled(e)},c.prototype.onNewUsageMetricsToggleChange=function(){return this.extensions&&this.extensions.usageMetricsAppBarOperations&&this.extensions.usageMetricsAppBarOperations.updateNewUsageMetricsSettingAndRedirect(this.newUsageMetricsEnabled)},c.prototype.canReShareReport=function(){return 4==(4&this.viewModel.reportPermission)},c.prototype.analyzeInExcel=function(){var e=this.extensions.analyzeInExcel;e.analyzeInExcel()},c.prototype.showDownloadReport=function(){return this.extensions.downloadReport&&this.extensions.downloadReport.showDownloadReport()},c.prototype.canDownloadReport=function(){return this.extensions.downloadReport&&this.extensions.downloadReport.canDownloadReport()},c.prototype.downloadReportDenied=function(){return this.extensions.downloadReport&&this.extensions.downloadReport.downloadReportDenied()},c.prototype.downloadReport=function(){var e=this.extensions.downloadReport;e.downloadReport()},c.prototype.getDownloadReportTooltip=function(){return this.extensions.downloadReport?this.extensions.downloadReport.getDownloadReportTooltip():""},c.prototype.generateQRCode=function(){var e=this.extensions.qrCode;e.generateQRCode()},i=c,e.ExplorationAppBarController=i})(powerbi=powerbi||{}),(function(e){var t;((t=e.explore||(e.explore={})).components||(t.components={})).ExplorationAppBar={bindings:{viewModel:"<",mixins:"<"},templateUrl:"components/explorationAppBar/explorationAppBar.html",controller:e.common.createController(t.controllers.ExplorationAppBarController)}})(powerbi=powerbi||{}),(function(i){var o;function t(e){var t=e&&e.clientError,e=n(e);return _.includes(o.UserErrors,e)?"User":_.includes(o.ExternalErrors,e)?"External":t&&null!=t.source?t.source:"PowerBI"}function n(e){var t=e&&e.serviceError&&e.serviceError.errorCode,e=e&&e.clientError&&e.clientError.code;return t||e||i.ModelFailednoErrorInfo}(o=i.explore||(i.explore={})).UserErrors=[i.DM_GWPipeline_Gateway_CancellationError,i.DM_GWPipeline_Gateway_CancellationOrTimeoutError,i.DM_GWPipeline_Gateway_ImpersonationError,i.DM_GWPipeline_Gateway_InvalidConnectionCredentials,i.DM_GWPipeline_Gateway_TimeoutError,i.DMTS_DatasourceHasNoCredentialError,i.DMTS_NoGatewayWithAllDatasourcesToBindError,i.DMTS_MultipleGatewaysWithAllDatasourcesToBindError,i.DMTS_OAuthTokenRefreshFailedError,i.DMTS_UserNotFoundInADGraphError,i.DMTS_UserLostPermissionToDatasourceError,i.PowerBINotAuthorizedException,i.ModelSizeExceedsSharedCapacityLimit,i.TokenExpired,i.UserNotLicensed,i.RS_AccessDenied,i.RS_AccessDeniedDueToRLSGroup,i.RS_ErrorOpeningConnection,"HttpStatusCode = -1","HttpStatusCode = 401","GroupNotAccessible",i.IgnorableClientError.Code],o.ExternalErrors=[i.DM_GWPipeline_Gateway_ConnectionBrokenException,i.DM_GWPipeline_Client_GatewayUnreachable,i.DM_GWPipeline_Gateway_DataSourceAccessError,i.DM_GWPipeline_Gateway_AdomdConnectError,i.DM_GWPipeline_Gateway_UnprocessedStructureError,i.DM_GWPipeline_Gateway_MashupDataAccessError],o.getTelemetryErrorDetails=function(e){return{errorCode:n(e),errorSource:t(e)}},o.getErrorSource=t,o.getErrorCode=n})(powerbi=powerbi||{}),(function(e){!(function(e){function t(e,t){this.newQueryResultUpdates=[],this.explorationId=e,this.explorationProxy=t}e=e.helpers||(e.helpers={}),t.prototype.onNewQueryCacheResultAvailable=function(t){var i=this,e=_.find(this.newQueryResultUpdates,(function(e){return e.visualContainerId===t.visualContainerId}));if(e)return e.query=t.query,void(e.dataTransforms=t.dataTransforms);this.newQueryResultUpdates.push(t),1===this.newQueryResultUpdates.length&&setTimeout((function(){var e={visualQueryResults:_.map(i.newQueryResultUpdates,(function(e){return{visualContainerId:e.visualContainerId,query:e.query,dataTransforms:e.dataTransforms}}))};i.explorationProxy.saveVisualContainerQueries(i.explorationId,e),i.newQueryResultUpdates=[]}),2e3)},e.VisualContainerQueryUpdater=t})(e.explore||(e.explore={}))})(powerbi=powerbi||{});;
"use strict";var powerbi,__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},__awaiter=this&&this.__awaiter||function(e,n,s,l){return new(s=s||Promise)(function(o,t){function i(e){try{a(l.next(e))}catch(e){t(e)}}function r(e){try{a(l.throw(e))}catch(e){t(e)}}function a(e){var t;e.done?o(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(i,r)}a((l=l.apply(e,n||[])).next())})},__generator=this&&this.__generator||function(o,i){var r,a,n,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return (function(t){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,a&&(n=2&t[0]?a.return:t[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,t[1])).done)return n;switch(a=0,(t=n?[2&t[0],n.value]:t)[0]){case 0:case 1:n=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,a=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(n=0<(n=s.trys).length&&n[n.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!n||t[1]>n[0]&&t[1]<n[3])){s.label=t[1];break}if(6===t[0]&&s.label<n[1]){s.label=n[1],n=t;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(t);break}n[2]&&s.ops.pop(),s.trys.pop();continue}t=i.call(o,s)}catch(e){t=[6,e],a=0}finally{r=n=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}})([t,e])}}},__spreadArray=this&&this.__spreadArray||function(e,t){for(var o=0,i=t.length,r=e.length;o<i;o++,r++)e[r]=t[o];return e},__extends=this&&this.__extends||(function(){var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}})();!(function(a){!(function(t){var e=jsCommon.Utility,o=a.telemetryEventFactory,i=a.telemetryBaseEventFactory,r=a.telemetry.EventFactories;e?e.generateGuid:Function.prototype;(e=t.OpenDashboardSource||(t.OpenDashboardSource={})).Normal="Normal",e.EmailSubscription="EmailSubscription",e.SubscribeOthers="SubscribeOthers",e.Commenting="Commenting",e.DDAlert="DDAlert",e.SmartAlerts="SmartAlerts",e.CopyVisualImage="CopyVisualImage",e.Invalid="Invalid",t.NavigationClickBreadcrumbEventName="PBI.Navigation.ClickBreadcrumb",t.NavigationClickBreadcrumb=r[t.NavigationClickBreadcrumbEventName]=function(e){return o({name:t.NavigationClickBreadcrumbEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.NavigationClickBreadcrumbLoggers})},t.NavigationToggleEventName="PBI.Navigation.Toggle",t.NavigationToggle=r[t.NavigationToggleEventName]=function(e){return o({name:t.NavigationToggleEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,optionalParameters:["collapseNavigation"],loggers:t.NavigationToggleLoggers})},t.DashboardQnaNewExperienceToggleEventName="PBI.DashboardQnaNewExperience.Toggle",t.DashboardQnaNewExperienceToggle=r[t.DashboardQnaNewExperienceToggleEventName]=function(e){return o({name:t.DashboardQnaNewExperienceToggleEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardQnaNewExperienceToggleLoggers})},t.ContentListArtifactsCountEventName="PBI.ContentList.ArtifactsCount",t.ContentListArtifactsCount=r[t.ContentListArtifactsCountEventName]=function(e){return o({name:t.ContentListArtifactsCountEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.ContentListArtifactsCountLoggers})},t.DashboardDuplicateDashboardEventName="PBI.Dashboard.DuplicateDashboard",t.DashboardDuplicateDashboard=r[t.DashboardDuplicateDashboardEventName]=function(e){return o({name:t.DashboardDuplicateDashboardEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardDuplicateDashboardLoggers})},t.DashboardDeleteDashboardUserEventName="PBI.Dashboard.DeleteDashboardUser",t.DashboardDeleteDashboardUser=r[t.DashboardDeleteDashboardUserEventName]=function(e){return o({name:t.DashboardDeleteDashboardUserEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardDeleteDashboardUserLoggers})},t.BaseDashboardEventEventName="BaseDashboardEvent",t.BaseDashboardEvent=r[t.BaseDashboardEventEventName]=function(e){return i({info:e,baseEvent:t.CustomerAction(e)})},t.BaseDashboardVerboseEventEventName="BaseDashboardVerboseEvent",t.BaseDashboardVerboseEvent=r[t.BaseDashboardVerboseEventEventName]=function(e){return i({info:e,baseEvent:t.Verbose(e)})},t.DashboardEventEventName="DashboardEvent",t.DashboardEvent=r[t.DashboardEventEventName]=function(e){return i({info:e,baseEvent:t.CustomerAction(e)})},t.DashboardTileMenuActionEventName="DashboardTileMenuAction",t.DashboardTileMenuAction=r[t.DashboardTileMenuActionEventName]=function(e){return o({name:t.DashboardTileMenuActionEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardTileMenuActionLoggers})},t.DashboardAddFavoriteEventName="PBI.Dashboard.AddFavorite",t.DashboardAddFavorite=r[t.DashboardAddFavoriteEventName]=function(e){return o({name:t.DashboardAddFavoriteEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardAddFavoriteLoggers})},t.DashboardRedirectToFeaturedEventName="PBI.Dashboard.RedirectToFeatured",t.DashboardRedirectToFeatured=r[t.DashboardRedirectToFeaturedEventName]=function(e){return o({name:t.DashboardRedirectToFeaturedEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardRedirectToFeaturedLoggers})},t.DashboardDeleteFavoriteEventName="PBI.Dashboard.DeleteFavorite",t.DashboardDeleteFavorite=r[t.DashboardDeleteFavoriteEventName]=function(e){return o({name:t.DashboardDeleteFavoriteEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardDeleteFavoriteLoggers})},t.DashboardGetFavoritesEventName="PBI.Dashboard.GetFavorites",t.DashboardGetFavorites=r[t.DashboardGetFavoritesEventName]=function(e){return o({name:t.DashboardGetFavoritesEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardGetFavoritesLoggers})},t.DashboardClaimInvitationEventName="PBI.Dashboard.ClaimInvitation",t.DashboardClaimInvitation=r[t.DashboardClaimInvitationEventName]=function(e){return o({name:t.DashboardClaimInvitationEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardClaimInvitationLoggers})},t.DashboardClaimInvitationRedirectToMobileLandingPageEventName="PBI.Dashboard.ClaimInvitationRedirectToMobileLandingPage",t.DashboardClaimInvitationRedirectToMobileLandingPage=r[t.DashboardClaimInvitationRedirectToMobileLandingPageEventName]=function(e){return o({name:t.DashboardClaimInvitationRedirectToMobileLandingPageEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardClaimInvitationRedirectToMobileLandingPageLoggers})},t.CustomConfigHandlerSharePointDiscoverEventName="PBI.CustomConfigHandler.SharePointDiscover",t.CustomConfigHandlerSharePointDiscover=r[t.CustomConfigHandlerSharePointDiscoverEventName]=function(e){return o({name:t.CustomConfigHandlerSharePointDiscoverEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.CustomConfigHandlerSharePointDiscoverLoggers})},t.DashboardDeleteDashboardEventName="PBI.Dashboard.DeleteDashboard",t.DashboardDeleteDashboard=r[t.DashboardDeleteDashboardEventName]=function(e){return o({name:t.DashboardDeleteDashboardEventName,baseEvent:t.DashboardEvent(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardDeleteDashboardLoggers})},t.DashboardDeleteTileEventName="PBI.Dashboard.DeleteTile",t.DashboardDeleteTile=r[t.DashboardDeleteTileEventName]=function(e){return o({name:t.DashboardDeleteTileEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardDeleteTileLoggers})},t.DashboardDownloadCompanionAppEventName="PBI.Dashboard.DownloadCompanionApp",t.DashboardDownloadCompanionApp=r[t.DashboardDownloadCompanionAppEventName]=function(e){return o({name:t.DashboardDownloadCompanionAppEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardDownloadCompanionAppLoggers})},t.DashboardDownloadExcelPublisherEventName="PBI.Dashboard.DownloadExcelPublisher",t.DashboardDownloadExcelPublisher=r[t.DashboardDownloadExcelPublisherEventName]=function(e){return o({name:t.DashboardDownloadExcelPublisherEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardDownloadExcelPublisherLoggers})},t.DashboardDownloadGatewaysEventName="PBI.Dashboard.DownloadGateways",t.DashboardDownloadGateways=r[t.DashboardDownloadGatewaysEventName]=function(e){return o({name:t.DashboardDownloadGatewaysEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardDownloadGatewaysLoggers})},t.DashboardTileLayoutChangedEventName="PBI.Dashboard.TileLayoutChanged",t.DashboardTileLayoutChanged=r[t.DashboardTileLayoutChangedEventName]=function(e){return o({name:t.DashboardTileLayoutChangedEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardTileLayoutChangedLoggers})},t.DashboardInFocusWorkbookEventName="PBI.Dashboard.InFocusWorkbook",t.DashboardInFocusWorkbook=r[t.DashboardInFocusWorkbookEventName]=function(e){return o({name:t.DashboardInFocusWorkbookEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardInFocusWorkbookLoggers})},t.DashboardReloadWorkbookEventName="PBI.Dashboard.ReloadWorkbook",t.DashboardReloadWorkbook=r[t.DashboardReloadWorkbookEventName]=function(e){return o({name:t.DashboardReloadWorkbookEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardReloadWorkbookLoggers})},t.DashboardCalculateWorkbookEventName="PBI.Dashboard.CalculateWorkbook",t.DashboardCalculateWorkbook=r[t.DashboardCalculateWorkbookEventName]=function(e){return o({name:t.DashboardCalculateWorkbookEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardCalculateWorkbookLoggers})},t.InFocusModeSaveTilePropertiesEventName="PBI.InFocusMode.SaveTileProperties",t.InFocusModeSaveTileProperties=r[t.InFocusModeSaveTilePropertiesEventName]=function(e){return o({name:t.InFocusModeSaveTilePropertiesEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.InFocusModeSaveTilePropertiesLoggers})},t.DashboardExportDashboardEventName="PBI.Dashboard.ExportDashboard",t.DashboardExportDashboard=r[t.DashboardExportDashboardEventName]=function(e){return o({name:t.DashboardExportDashboardEventName,baseEvent:t.BaseDashboardEvent(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardExportDashboardLoggers})},t.BaseAppDashboardEventEventName="BaseAppDashboardEvent",t.BaseAppDashboardEvent=r[t.BaseAppDashboardEventEventName]=function(e){return i({info:e,baseEvent:t.BaseDashboardEvent(e)})},t.DashboardOpenDashboardEventName="PBI.Dashboard.OpenDashboard",t.DashboardOpenDashboard=r[t.DashboardOpenDashboardEventName]=function(e){return o({name:t.DashboardOpenDashboardEventName,baseEvent:t.BaseAppDashboardEvent(e),info:e,category:a.TelemetryCategory.CustomerAction,optionalParameters:["groupObjectId","isReadonlyGroup","scrubUserInfo","isB2B","endorsementStage"],loggers:t.DashboardOpenDashboardLoggers,shouldLogStartEnd:!0,logExpAssignment:!0})},t.DashboardLockedTilesDisplayedEventName="PBI.Dashboard.LockedTilesDisplayed",t.DashboardLockedTilesDisplayed=r[t.DashboardLockedTilesDisplayedEventName]=function(e){return o({name:t.DashboardLockedTilesDisplayedEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.DashboardLockedTilesDisplayedLoggers})},t.DashboardLoadDashboardTileVisualEventName="PBI.Dashboard.LoadDashboardTileVisual",t.DashboardLoadDashboardTileVisual=r[t.DashboardLoadDashboardTileVisualEventName]=function(e){return o({name:t.DashboardLoadDashboardTileVisualEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.DashboardLoadDashboardTileVisualLoggers})},t.DashboardPinTileEventName="PBI.Dashboard.PinTile",t.DashboardPinTile=r[t.DashboardPinTileEventName]=function(e){return o({name:t.DashboardPinTileEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardPinTileLoggers})},t.DashboardInitializeContainerEventName="PBI.Dashboard.InitializeContainer",t.DashboardInitializeContainer=r[t.DashboardInitializeContainerEventName]=function(e){return o({name:t.DashboardInitializeContainerEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.DashboardInitializeContainerLoggers})},t.DashboardInitializeContentProviderConfigEventName="PBI.Dashboard.InitializeContentProviderConfig",t.DashboardInitializeContentProviderConfig=r[t.DashboardInitializeContentProviderConfigEventName]=function(e){return o({name:t.DashboardInitializeContentProviderConfigEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.DashboardInitializeContentProviderConfigLoggers})},t.DashboardRequestDashboardAccessEventName="PBI.Dashboard.RequestDashboardAccess",t.DashboardRequestDashboardAccess=r[t.DashboardRequestDashboardAccessEventName]=function(e){return o({name:t.DashboardRequestDashboardAccessEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardRequestDashboardAccessLoggers,logExpAssignment:!0})},t.RequestArtifactAccessEventName="PBI.RequestArtifactAccess",t.RequestArtifactAccess=r[t.RequestArtifactAccessEventName]=function(e){return o({name:t.RequestArtifactAccessEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.RequestArtifactAccessLoggers,logExpAssignment:!0})},t.DashboardOpenTileEventName="PBI.Dashboard.OpenTile",t.DashboardOpenTile=r[t.DashboardOpenTileEventName]=function(e){return o({name:t.DashboardOpenTileEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardOpenTileLoggers})},t.DashboardSettingGroupChangedEventName="PBI.Dashboard.SettingGroupChanged",t.DashboardSettingGroupChanged=r[t.DashboardSettingGroupChangedEventName]=function(e){return o({name:t.DashboardSettingGroupChangedEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.DashboardSettingGroupChangedLoggers})},t.DashboardRenameDashboardEventName="PBI.Dashboard.RenameDashboard",t.DashboardRenameDashboard=r[t.DashboardRenameDashboardEventName]=function(e){return o({name:t.DashboardRenameDashboardEventName,baseEvent:t.BaseDashboardEvent(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardRenameDashboardLoggers})},t.DashboardViewWorkbookEventName="PBI.Dashboard.ViewWorkbook",t.DashboardViewWorkbook=r[t.DashboardViewWorkbookEventName]=function(e){return o({name:t.DashboardViewWorkbookEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardViewWorkbookLoggers,logExpAssignment:!0})},t.DashboardWorkbookEditedInPowerBICausedPinBlockEventName="PBI.Dashboard.WorkbookEditedInPowerBICausedPinBlock",t.DashboardWorkbookEditedInPowerBICausedPinBlock=r[t.DashboardWorkbookEditedInPowerBICausedPinBlockEventName]=function(e){return o({name:t.DashboardWorkbookEditedInPowerBICausedPinBlockEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardWorkbookEditedInPowerBICausedPinBlockLoggers})},t.DashboardEditWorkbookEventName="PBI.Dashboard.EditWorkbook",t.DashboardEditWorkbook=r[t.DashboardEditWorkbookEventName]=function(e){return o({name:t.DashboardEditWorkbookEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardEditWorkbookLoggers})},t.DashboardWorkbookViewedExternallyDueToAnErrorEventName="PBI.Dashboard.WorkbookViewedExternallyDueToAnError",t.DashboardWorkbookViewedExternallyDueToAnError=r[t.DashboardWorkbookViewedExternallyDueToAnErrorEventName]=function(e){return o({name:t.DashboardWorkbookViewedExternallyDueToAnErrorEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardWorkbookViewedExternallyDueToAnErrorLoggers})},t.DashboardSwitchViewEventName="PBI.Dashboard.SwitchView",t.DashboardSwitchView=r[t.DashboardSwitchViewEventName]=function(e){return o({name:t.DashboardSwitchViewEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardSwitchViewLoggers})},t.DashboardUpdateActiveDashboardEventName="PBI.Dashboard.UpdateActiveDashboard",t.DashboardUpdateActiveDashboard=r[t.DashboardUpdateActiveDashboardEventName]=function(e){return o({name:t.DashboardUpdateActiveDashboardEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.DashboardUpdateActiveDashboardLoggers})},t.DashboardRefreshTileDataEventName="PBI.Dashboard.RefreshTileData",t.DashboardRefreshTileData=r[t.DashboardRefreshTileDataEventName]=function(e){return o({name:t.DashboardRefreshTileDataEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.DashboardRefreshTileDataLoggers})},t.DashboardSetHomeDashboardEventName="PBI.Dashboard.SetHomeDashboard",t.DashboardSetHomeDashboard=r[t.DashboardSetHomeDashboardEventName]=function(e){return o({name:t.DashboardSetHomeDashboardEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardSetHomeDashboardLoggers})},t.DashboardDisableHomeDashboardEventName="PBI.Dashboard.DisableHomeDashboard",t.DashboardDisableHomeDashboard=r[t.DashboardDisableHomeDashboardEventName]=function(e){return o({name:t.DashboardDisableHomeDashboardEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardDisableHomeDashboardLoggers})},t.DashboardRefreshDashboardTilesEventName="PBI.Dashboard.RefreshDashboardTiles",t.DashboardRefreshDashboardTiles=r[t.DashboardRefreshDashboardTilesEventName]=function(e){return o({name:t.DashboardRefreshDashboardTilesEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardRefreshDashboardTilesLoggers})},t.GroupsSwitchGroupEventName="PBI.Groups.SwitchGroup",t.GroupsSwitchGroup=r[t.GroupsSwitchGroupEventName]=function(e){return o({name:t.GroupsSwitchGroupEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.GroupsSwitchGroupLoggers})},t.FoldersGetWorkspaceFoldersEventName="PBI.Folders.GetWorkspaceFolders",t.FoldersGetWorkspaceFolders=r[t.FoldersGetWorkspaceFoldersEventName]=function(e){return o({name:t.FoldersGetWorkspaceFoldersEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.FoldersGetWorkspaceFoldersLoggers})},t.FoldersGetFolderDashboardEventName="PBI.Folders.GetFolderDashboard",t.FoldersGetFolderDashboard=r[t.FoldersGetFolderDashboardEventName]=function(e){return o({name:t.FoldersGetFolderDashboardEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.FoldersGetFolderDashboardLoggers})},t.DashboardShowGettingStartedPopupEventName="PBI.Dashboard.ShowGettingStartedPopup",t.DashboardShowGettingStartedPopup=r[t.DashboardShowGettingStartedPopupEventName]=function(e){return o({name:t.DashboardShowGettingStartedPopupEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardShowGettingStartedPopupLoggers})},t.BaseDataSetTopLevelCustomerActionEventName="BaseDataSetTopLevelCustomerAction",t.BaseDataSetTopLevelCustomerAction=r[t.BaseDataSetTopLevelCustomerActionEventName]=function(e){return i({info:e,baseEvent:t.CustomerAction(e)})},t.DashboardManageDatasetsLandingEventName="PBI.Dashboard.ManageDatasetsLanding",t.DashboardManageDatasetsLanding=r[t.DashboardManageDatasetsLandingEventName]=function(e){return o({name:t.DashboardManageDatasetsLandingEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardManageDatasetsLandingLoggers})},t.DashboardDatasetClickScheduleRefreshEventName="PBI.Dashboard.DatasetClickScheduleRefresh",t.DashboardDatasetClickScheduleRefresh=r[t.DashboardDatasetClickScheduleRefreshEventName]=function(e){return o({name:t.DashboardDatasetClickScheduleRefreshEventName,baseEvent:t.BaseDataSetTopLevelCustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardDatasetClickScheduleRefreshLoggers})},t.DashboardWorkbookClickScheduleRefreshEventName="PBI.Dashboard.WorkbookClickScheduleRefresh",t.DashboardWorkbookClickScheduleRefresh=r[t.DashboardWorkbookClickScheduleRefreshEventName]=function(e){return o({name:t.DashboardWorkbookClickScheduleRefreshEventName,baseEvent:t.BaseDataSetTopLevelCustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardWorkbookClickScheduleRefreshLoggers})},t.DashboardDatasetClickRefreshNowEventName="PBI.Dashboard.DatasetClickRefreshNow",t.DashboardDatasetClickRefreshNow=r[t.DashboardDatasetClickRefreshNowEventName]=function(e){return o({name:t.DashboardDatasetClickRefreshNowEventName,baseEvent:t.BaseDataSetTopLevelCustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardDatasetClickRefreshNowLoggers})},t.DashboardWorkbookClickRefreshNowEventName="PBI.Dashboard.WorkbookClickRefreshNow",t.DashboardWorkbookClickRefreshNow=r[t.DashboardWorkbookClickRefreshNowEventName]=function(e){return o({name:t.DashboardWorkbookClickRefreshNowEventName,baseEvent:t.BaseDataSetTopLevelCustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardWorkbookClickRefreshNowLoggers})},t.DashboardDatasetClickDeleteEventName="PBI.Dashboard.DatasetClickDelete",t.DashboardDatasetClickDelete=r[t.DashboardDatasetClickDeleteEventName]=function(e){return o({name:t.DashboardDatasetClickDeleteEventName,baseEvent:t.BaseDataSetTopLevelCustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardDatasetClickDeleteLoggers})},t.DashboardDatasetClickInsightsEventName="PBI.Dashboard.DatasetClickInsights",t.DashboardDatasetClickInsights=r[t.DashboardDatasetClickInsightsEventName]=function(e){return o({name:t.DashboardDatasetClickInsightsEventName,baseEvent:t.BaseDataSetTopLevelCustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardDatasetClickInsightsLoggers})},t.DashboardDatasetClickRenameEventName="PBI.Dashboard.DatasetClickRename",t.DashboardDatasetClickRename=r[t.DashboardDatasetClickRenameEventName]=function(e){return o({name:t.DashboardDatasetClickRenameEventName,baseEvent:t.BaseDataSetTopLevelCustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardDatasetClickRenameLoggers})},t.DashboardClickPersonalizeEventName="PBI.Dashboard.ClickPersonalize",t.DashboardClickPersonalize=r[t.DashboardClickPersonalizeEventName]=function(e){return o({name:t.DashboardClickPersonalizeEventName,baseEvent:t.BaseDataSetTopLevelCustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardClickPersonalizeLoggers,logExpAssignment:!0})},t.DashboardExpandCollapseNavigatorPaneEventName="PBI.Dashboard.ExpandCollapseNavigatorPane",t.DashboardExpandCollapseNavigatorPane=r[t.DashboardExpandCollapseNavigatorPaneEventName]=function(e){return o({name:t.DashboardExpandCollapseNavigatorPaneEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardExpandCollapseNavigatorPaneLoggers})},t.DashboardOpenGetDataPageEventName="PBI.Dashboard.OpenGetDataPage",t.DashboardOpenGetDataPage=r[t.DashboardOpenGetDataPageEventName]=function(e){return o({name:t.DashboardOpenGetDataPageEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardOpenGetDataPageLoggers})},t.DashboardExpandCollapseNavigatorPaneSectionEventName="PBI.Dashboard.ExpandCollapseNavigatorPaneSection",t.DashboardExpandCollapseNavigatorPaneSection=r[t.DashboardExpandCollapseNavigatorPaneSectionEventName]=function(e){return o({name:t.DashboardExpandCollapseNavigatorPaneSectionEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardExpandCollapseNavigatorPaneSectionLoggers})},t.DashboardFilterNavigatorPaneItemsEventName="PBI.Dashboard.FilterNavigatorPaneItems",t.DashboardFilterNavigatorPaneItems=r[t.DashboardFilterNavigatorPaneItemsEventName]=function(e){return o({name:t.DashboardFilterNavigatorPaneItemsEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardFilterNavigatorPaneItemsLoggers})},t.DashboardGetGroupsEventName="PBI.Dashboard.GetGroups",t.DashboardGetGroups=r[t.DashboardGetGroupsEventName]=function(e){return o({name:t.DashboardGetGroupsEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.DashboardGetGroupsLoggers})},t.DashboardContentPackPublishEventName="PBI.Dashboard.ContentPackPublish",t.DashboardContentPackPublish=r[t.DashboardContentPackPublishEventName]=function(e){return o({name:t.DashboardContentPackPublishEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardContentPackPublishLoggers})},t.ContentPackUninstallEventName="PBI.ContentPackUninstall",t.ContentPackUninstall=r[t.ContentPackUninstallEventName]=function(e){return o({name:t.ContentPackUninstallEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.ContentPackUninstallLoggers})},t.DashboardContentPackDirtyEventName="PBI.Dashboard.ContentPackDirty",t.DashboardContentPackDirty=r[t.DashboardContentPackDirtyEventName]=function(e){return o({name:t.DashboardContentPackDirtyEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardContentPackDirtyLoggers})},t.DashboardDeleteContentPackEventName="PBI.Dashboard.DeleteContentPack",t.DashboardDeleteContentPack=r[t.DashboardDeleteContentPackEventName]=function(e){return o({name:t.DashboardDeleteContentPackEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardDeleteContentPackLoggers})},t.DashboardDeleteTemplateOrganizationAppEventName="PBI.Dashboard.DeleteTemplateOrganizationApp",t.DashboardDeleteTemplateOrganizationApp=r[t.DashboardDeleteTemplateOrganizationAppEventName]=function(e){return o({name:t.DashboardDeleteTemplateOrganizationAppEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardDeleteTemplateOrganizationAppLoggers})},t.DashboardViewContentPacksEventName="PBI.Dashboard.ViewContentPacks",t.DashboardViewContentPacks=r[t.DashboardViewContentPacksEventName]=function(e){return o({name:t.DashboardViewContentPacksEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.DashboardViewContentPacksLoggers})},t.DashboardContentPackPersonalizeEventName="PBI.Dashboard.ContentPackPersonalize",t.DashboardContentPackPersonalize=r[t.DashboardContentPackPersonalizeEventName]=function(e){return o({name:t.DashboardContentPackPersonalizeEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardContentPackPersonalizeLoggers})},t.DashboardFirstUseEventName="PBI.Dashboard.FirstUse",t.DashboardFirstUse=r[t.DashboardFirstUseEventName]=function(e){return o({name:t.DashboardFirstUseEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardFirstUseLoggers})},t.DashboardWorkbookPinabilityShownEventName="PBI.Dashboard.WorkbookPinabilityShown",t.DashboardWorkbookPinabilityShown=r[t.DashboardWorkbookPinabilityShownEventName]=function(e){return o({name:t.DashboardWorkbookPinabilityShownEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardWorkbookPinabilityShownLoggers})},t.DashboardGetDataSplashEventName="PBI.Dashboard.GetDataSplash",t.DashboardGetDataSplash=r[t.DashboardGetDataSplashEventName]=function(e){return o({name:t.DashboardGetDataSplashEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardGetDataSplashLoggers})},t.GetDataDataflowsLearnMoreEventName="PBI.GetData.DataflowsLearnMore",t.GetDataDataflowsLearnMore=r[t.GetDataDataflowsLearnMoreEventName]=function(e){return o({name:t.GetDataDataflowsLearnMoreEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.GetDataDataflowsLearnMoreLoggers})},t.GetDataDownloadDesktopEventName="PBI.GetData.DownloadDesktop",t.GetDataDownloadDesktop=r[t.GetDataDownloadDesktopEventName]=function(e){return o({name:t.GetDataDownloadDesktopEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.GetDataDownloadDesktopLoggers})},t.DashboardGetDataCategorySelectEventName="PBI.Dashboard.GetDataCategorySelect",t.DashboardGetDataCategorySelect=r[t.DashboardGetDataCategorySelectEventName]=function(e){return o({name:t.DashboardGetDataCategorySelectEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardGetDataCategorySelectLoggers})},t.DashboardInFocusModeSelectedEventName="PBI.Dashboard.InFocusModeSelected",t.DashboardInFocusModeSelected=r[t.DashboardInFocusModeSelectedEventName]=function(e){return o({name:t.DashboardInFocusModeSelectedEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardInFocusModeSelectedLoggers})},t.DashboardSaveDashboardSettingsEventName="PBI.Dashboard.SaveDashboardSettings",t.DashboardSaveDashboardSettings=r[t.DashboardSaveDashboardSettingsEventName]=function(e){return o({name:t.DashboardSaveDashboardSettingsEventName,baseEvent:t.BaseDashboardEvent(e),info:e,category:a.TelemetryCategory.CustomerAction,optionalParameters:["annotationsUpdatedToDisabled"],loggers:t.DashboardSaveDashboardSettingsLoggers})},t.DashboardGetDashboardSettingsEventName="PBI.Dashboard.GetDashboardSettings",t.DashboardGetDashboardSettings=r[t.DashboardGetDashboardSettingsEventName]=function(e){return o({name:t.DashboardGetDashboardSettingsEventName,baseEvent:t.BaseDashboardVerboseEvent(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.DashboardGetDashboardSettingsLoggers})},t.DashboardInitializeSettingsDashboardsModelEventName="PBI.Dashboard.InitializeSettingsDashboardsModel",t.DashboardInitializeSettingsDashboardsModel=r[t.DashboardInitializeSettingsDashboardsModelEventName]=function(e){return o({name:t.DashboardInitializeSettingsDashboardsModelEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.DashboardInitializeSettingsDashboardsModelLoggers})},t.DashboardTestDataSourceConnectionEventName="PBI.Dashboard.TestDataSourceConnection",t.DashboardTestDataSourceConnection=r[t.DashboardTestDataSourceConnectionEventName]=function(e){return o({name:t.DashboardTestDataSourceConnectionEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.DashboardTestDataSourceConnectionLoggers})},t.DashboardGetRefreshHistoriesOnRefreshFailuresEventName="PBI.Dashboard.GetRefreshHistoriesOnRefreshFailures",t.DashboardGetRefreshHistoriesOnRefreshFailures=r[t.DashboardGetRefreshHistoriesOnRefreshFailuresEventName]=function(e){return o({name:t.DashboardGetRefreshHistoriesOnRefreshFailuresEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.DashboardGetRefreshHistoriesOnRefreshFailuresLoggers})},t.DashboardLoadTileDataEventName="PBI.Dashboard.LoadTileData",t.DashboardLoadTileData=r[t.DashboardLoadTileDataEventName]=function(e){return o({name:t.DashboardLoadTileDataEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardLoadTileDataLoggers})},t.DashboardOwnershipFilterSelectedEventName="PBI.Dashboard.OwnershipFilterSelected",t.DashboardOwnershipFilterSelected=r[t.DashboardOwnershipFilterSelectedEventName]=function(e){return o({name:t.DashboardOwnershipFilterSelectedEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardOwnershipFilterSelectedLoggers})},t.AppInitialAppLoadEventName="PBI.App.InitialAppLoad",t.AppInitialAppLoad=r[t.AppInitialAppLoadEventName]=function(e){return o({name:t.AppInitialAppLoadEventName,baseEvent:t.CustomerAction(e),info:__assign({isB2B:!1},e),category:a.TelemetryCategory.CustomerAction,optionalParameters:["isB2B","enabledFeatureSwitches"],loggers:t.AppInitialAppLoadLoggers,shouldLogStartEnd:!0,logExpAssignment:!0})},t.GroupEditorGetGroupMembersEventName="PBI.GroupEditor.GetGroupMembers",t.GroupEditorGetGroupMembers=r[t.GroupEditorGetGroupMembersEventName]=function(e){return o({name:t.GroupEditorGetGroupMembersEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.GroupEditorGetGroupMembersLoggers})},t.GroupEditorUserLeaveGroupEventName="PBI.GroupEditor.UserLeaveGroup",t.GroupEditorUserLeaveGroup=r[t.GroupEditorUserLeaveGroupEventName]=function(e){return o({name:t.GroupEditorUserLeaveGroupEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.GroupEditorUserLeaveGroupLoggers})},t.QuotaOpenManageStoragePageEventName="PBI.Quota.OpenManageStoragePage",t.QuotaOpenManageStoragePage=r[t.QuotaOpenManageStoragePageEventName]=function(e){return o({name:t.QuotaOpenManageStoragePageEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.QuotaOpenManageStoragePageLoggers})},t.QuotaStorageUsageEventName="PBI.Quota.StorageUsage",t.QuotaStorageUsage=r[t.QuotaStorageUsageEventName]=function(e){return o({name:t.QuotaStorageUsageEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.QuotaStorageUsageLoggers})},t.QuotaManageStorageDeleteEventName="PBI.Quota.ManageStorageDelete",t.QuotaManageStorageDelete=r[t.QuotaManageStorageDeleteEventName]=function(e){return o({name:t.QuotaManageStorageDeleteEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.QuotaManageStorageDeleteLoggers})},t.QuotaExceededEventName="PBI.Quota.Exceeded",t.QuotaExceeded=r[t.QuotaExceededEventName]=function(e){return o({name:t.QuotaExceededEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.QuotaExceededLoggers})},t.QuotaAccessCustomizedPropertiesEventName="PBI.Quota.AccessCustomizedProperties",t.QuotaAccessCustomizedProperties=r[t.QuotaAccessCustomizedPropertiesEventName]=function(e){return o({name:t.QuotaAccessCustomizedPropertiesEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.QuotaAccessCustomizedPropertiesLoggers})},t.QuotaUpgradeInteractionEventName="PBI.Quota.UpgradeInteraction",t.QuotaUpgradeInteraction=r[t.QuotaUpgradeInteractionEventName]=function(e){return o({name:t.QuotaUpgradeInteractionEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.QuotaUpgradeInteractionLoggers})},t.OpenUpgradeAccountPageEventName="PBI.OpenUpgradeAccountPage",t.OpenUpgradeAccountPage=r[t.OpenUpgradeAccountPageEventName]=function(e){return o({name:t.OpenUpgradeAccountPageEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.OpenUpgradeAccountPageLoggers})},t.PrivacyInitializeSettingsModelEventName="PBI.Privacy.InitializeSettingsModel",t.PrivacyInitializeSettingsModel=r[t.PrivacyInitializeSettingsModelEventName]=function(e){return o({name:t.PrivacyInitializeSettingsModelEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.PrivacyInitializeSettingsModelLoggers})},t.PrivacySaveSettingsModelEventName="PBI.Privacy.SaveSettingsModel",t.PrivacySaveSettingsModel=r[t.PrivacySaveSettingsModelEventName]=function(e){return o({name:t.PrivacySaveSettingsModelEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.PrivacySaveSettingsModelLoggers})},t.SettingsDeleteAllDatasourcesEventName="PBI.Settings.DeleteAllDatasources",t.SettingsDeleteAllDatasources=r[t.SettingsDeleteAllDatasourcesEventName]=function(e){return o({name:t.SettingsDeleteAllDatasourcesEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.SettingsDeleteAllDatasourcesLoggers})},t.SettingsTakeoverDatasourcesEventName="PBI.Settings.TakeoverDatasources",t.SettingsTakeoverDatasources=r[t.SettingsTakeoverDatasourcesEventName]=function(e){return o({name:t.SettingsTakeoverDatasourcesEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.SettingsTakeoverDatasourcesLoggers})},t.SettingsLoadSettingsDataEventName="PBI.Settings.LoadSettingsData",t.SettingsLoadSettingsData=r[t.SettingsLoadSettingsDataEventName]=function(e){return o({name:t.SettingsLoadSettingsDataEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.SettingsLoadSettingsDataLoggers})},t.QRCodeQRCodeDialogShownEventName="PBI.QRCode.QRCodeDialogShown",t.QRCodeQRCodeDialogShown=r[t.QRCodeQRCodeDialogShownEventName]=function(e){return o({name:t.QRCodeQRCodeDialogShownEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.QRCodeQRCodeDialogShownLoggers})},t.QRCodeShortUrlCreatedEventName="PBI.QRCode.ShortUrlCreated",t.QRCodeShortUrlCreated=r[t.QRCodeShortUrlCreatedEventName]=function(e){return o({name:t.QRCodeShortUrlCreatedEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.QRCodeShortUrlCreatedLoggers})},t.QRCodeShortUrlFailedEventName="PBI.QRCode.ShortUrlFailed",t.QRCodeShortUrlFailed=r[t.QRCodeShortUrlFailedEventName]=function(e){return o({name:t.QRCodeShortUrlFailedEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.QRCodeShortUrlFailedLoggers})},t.QRCodeQRCodeReportDialogShownEventName="PBI.QRCode.QRCodeReportDialogShown",t.QRCodeQRCodeReportDialogShown=r[t.QRCodeQRCodeReportDialogShownEventName]=function(e){return o({name:t.QRCodeQRCodeReportDialogShownEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.QRCodeQRCodeReportDialogShownLoggers})},t.QRCodeReportShortUrlCreatedEventName="PBI.QRCode.ReportShortUrlCreated",t.QRCodeReportShortUrlCreated=r[t.QRCodeReportShortUrlCreatedEventName]=function(e){return o({name:t.QRCodeReportShortUrlCreatedEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.QRCodeReportShortUrlCreatedLoggers})},t.DashboardAddWidgetEventName="PBI.Dashboard.AddWidget",t.DashboardAddWidget=r[t.DashboardAddWidgetEventName]=function(e){return o({name:t.DashboardAddWidgetEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardAddWidgetLoggers})},t.DashboardLoadTenantContentPacksEventName="PBI.Dashboard.LoadTenantContentPacks",t.DashboardLoadTenantContentPacks=r[t.DashboardLoadTenantContentPacksEventName]=function(e){return o({name:t.DashboardLoadTenantContentPacksEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.DashboardLoadTenantContentPacksLoggers})},t.ContentListLoadedEventName="PBI.ContentList.Loaded",t.ContentListLoaded=r[t.ContentListLoadedEventName]=function(e){return o({name:t.ContentListLoadedEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.ContentListLoadedLoggers})},t.ContentListSelectSortEventName="PBI.ContentList.SelectSort",t.ContentListSelectSort=r[t.ContentListSelectSortEventName]=function(e){return o({name:t.ContentListSelectSortEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.ContentListSelectSortLoggers})},t.ContentListDeletePersistFilterEventName="PBI.ContentList.DeletePersistFilter",t.ContentListDeletePersistFilter=r[t.ContentListDeletePersistFilterEventName]=function(e){return o({name:t.ContentListDeletePersistFilterEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.ContentListDeletePersistFilterLoggers})},t.MostRecentlyUsedServiceUpdateMRUDataEventName="PBI.MostRecentlyUsedService.UpdateMRUData",t.MostRecentlyUsedServiceUpdateMRUData=r[t.MostRecentlyUsedServiceUpdateMRUDataEventName]=function(e){return o({name:t.MostRecentlyUsedServiceUpdateMRUDataEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.MostRecentlyUsedServiceUpdateMRUDataLoggers})},t.ContentListSearchEventName="PBI.ContentList.Search",t.ContentListSearch=r[t.ContentListSearchEventName]=function(e){return o({name:t.ContentListSearchEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.ContentListSearchLoggers})},t.ContentListOpenArtifactEventName="PBI.ContentList.OpenArtifact",t.ContentListOpenArtifact=r[t.ContentListOpenArtifactEventName]=function(e){return o({name:t.ContentListOpenArtifactEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.ContentListOpenArtifactLoggers})},t.MarketplaceEmbeddedOpenedEventName="PBI.Marketplace.EmbeddedOpened",t.MarketplaceEmbeddedOpened=r[t.MarketplaceEmbeddedOpenedEventName]=function(e){return o({name:t.MarketplaceEmbeddedOpenedEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.MarketplaceEmbeddedOpenedLoggers})},t.MarketplaceEmbeddedClosedWithAppAcquiredEventName="PBI.Marketplace.EmbeddedClosedWithAppAcquired",t.MarketplaceEmbeddedClosedWithAppAcquired=r[t.MarketplaceEmbeddedClosedWithAppAcquiredEventName]=function(e){return o({name:t.MarketplaceEmbeddedClosedWithAppAcquiredEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.MarketplaceEmbeddedClosedWithAppAcquiredLoggers})},t.MarketplaceEmbeddedClosedWithoutAppAcquiredEventName="PBI.Marketplace.EmbeddedClosedWithoutAppAcquired",t.MarketplaceEmbeddedClosedWithoutAppAcquired=r[t.MarketplaceEmbeddedClosedWithoutAppAcquiredEventName]=function(e){return o({name:t.MarketplaceEmbeddedClosedWithoutAppAcquiredEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.MarketplaceEmbeddedClosedWithoutAppAcquiredLoggers})},t.RealTimeStreamingDatasetPushInfoPaneOpenedEventName="PBI.RealTime.StreamingDatasetPushInfoPaneOpened",t.RealTimeStreamingDatasetPushInfoPaneOpened=r[t.RealTimeStreamingDatasetPushInfoPaneOpenedEventName]=function(e){return o({name:t.RealTimeStreamingDatasetPushInfoPaneOpenedEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.RealTimeStreamingDatasetPushInfoPaneOpenedLoggers})},t.RowLevelSecurityDisableRLSEventName="PBI.RowLevelSecurity.DisableRLS",t.RowLevelSecurityDisableRLS=r[t.RowLevelSecurityDisableRLSEventName]=function(e){return o({name:t.RowLevelSecurityDisableRLSEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.RowLevelSecurityDisableRLSLoggers})},t.DataAlertsTileBadgeClickedEventName="PBI.DataAlerts.TileBadgeClicked",t.DataAlertsTileBadgeClicked=r[t.DataAlertsTileBadgeClickedEventName]=function(e){return o({name:t.DataAlertsTileBadgeClickedEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DataAlertsTileBadgeClickedLoggers})},t.DataAlertsNotificationActionEventName="PBI.DataAlerts.NotificationAction",t.DataAlertsNotificationAction=r[t.DataAlertsNotificationActionEventName]=function(e){return o({name:t.DataAlertsNotificationActionEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DataAlertsNotificationActionLoggers})},t.DataAlertsRequestEventName="PBI.DataAlerts.Request",t.DataAlertsRequest=r[t.DataAlertsRequestEventName]=function(e){return o({name:t.DataAlertsRequestEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DataAlertsRequestLoggers})},t.DataAlertsOpenAlertsSettingsEventName="PBI.DataAlerts.OpenAlertsSettings",t.DataAlertsOpenAlertsSettings=r[t.DataAlertsOpenAlertsSettingsEventName]=function(e){return o({name:t.DataAlertsOpenAlertsSettingsEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DataAlertsOpenAlertsSettingsLoggers})},t.DataAlertsAlertsSettingsEditEventName="PBI.DataAlerts.AlertsSettingsEdit",t.DataAlertsAlertsSettingsEdit=r[t.DataAlertsAlertsSettingsEditEventName]=function(e){return o({name:t.DataAlertsAlertsSettingsEditEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DataAlertsAlertsSettingsEditLoggers})},t.DataAlertsDeleteAlertAcceptEventName="PBI.DataAlerts.DeleteAlertAccept",t.DataAlertsDeleteAlertAccept=r[t.DataAlertsDeleteAlertAcceptEventName]=function(e){return o({name:t.DataAlertsDeleteAlertAcceptEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DataAlertsDeleteAlertAcceptLoggers})},t.DataAlertsDeleteAlertCancelEventName="PBI.DataAlerts.DeleteAlertCancel",t.DataAlertsDeleteAlertCancel=r[t.DataAlertsDeleteAlertCancelEventName]=function(e){return o({name:t.DataAlertsDeleteAlertCancelEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DataAlertsDeleteAlertCancelLoggers})},t.DataAlertsAlertsSettingsDeleteEventName="PBI.DataAlerts.AlertsSettingsDelete",t.DataAlertsAlertsSettingsDelete=r[t.DataAlertsAlertsSettingsDeleteEventName]=function(e){return o({name:t.DataAlertsAlertsSettingsDeleteEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DataAlertsAlertsSettingsDeleteLoggers})},t.EmailSubscriptionsEditEmailSettingsEventName="PBI.EmailSubscriptions.EditEmailSettings",t.EmailSubscriptionsEditEmailSettings=r[t.EmailSubscriptionsEditEmailSettingsEventName]=function(e){return o({name:t.EmailSubscriptionsEditEmailSettingsEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.EmailSubscriptionsEditEmailSettingsLoggers})},t.UsageMetricsHttpGetPackageEventName="PBI.UsageMetrics.Http.GetPackage",t.UsageMetricsHttpGetPackage=r[t.UsageMetricsHttpGetPackageEventName]=function(e){return o({name:t.UsageMetricsHttpGetPackageEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.UsageMetricsHttpGetPackageLoggers})},t.UsageMetricsHttpUsageReportUpgradeEventName="PBI.UsageMetrics.Http.UsageReportUpgrade",t.UsageMetricsHttpUsageReportUpgrade=r[t.UsageMetricsHttpUsageReportUpgradeEventName]=function(e){return o({name:t.UsageMetricsHttpUsageReportUpgradeEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.UsageMetricsHttpUsageReportUpgradeLoggers})},t.DashboardLoadDashboardWithScriptVisualsEventName="PBI.Dashboard.LoadDashboardWithScriptVisuals",t.DashboardLoadDashboardWithScriptVisuals=r[t.DashboardLoadDashboardWithScriptVisualsEventName]=function(e){return o({name:t.DashboardLoadDashboardWithScriptVisualsEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardLoadDashboardWithScriptVisualsLoggers})},t.UserNotificationsLinkClickedEventName="PBI.UserNotifications.LinkClicked",t.UserNotificationsLinkClicked=r[t.UserNotificationsLinkClickedEventName]=function(e){return o({name:t.UserNotificationsLinkClickedEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.UserNotificationsLinkClickedLoggers,logExpAssignment:!0})},t.DashboardRetryDashboardEventName="PBI.Dashboard.RetryDashboard",t.DashboardRetryDashboard=r[t.DashboardRetryDashboardEventName]=function(e){return o({name:t.DashboardRetryDashboardEventName,baseEvent:t.BaseDashboardVerboseEvent(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.DashboardRetryDashboardLoggers})},t.DashboardPreloadLinkedDashboardEventName="PBI.Dashboard.PreloadLinkedDashboard",t.DashboardPreloadLinkedDashboard=r[t.DashboardPreloadLinkedDashboardEventName]=function(e){return o({name:t.DashboardPreloadLinkedDashboardEventName,baseEvent:t.BaseDashboardVerboseEvent(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.DashboardPreloadLinkedDashboardLoggers})},t.DashboardRegisterAndLoadResourcePackagesEventName="PBI.Dashboard.RegisterAndLoadResourcePackages",t.DashboardRegisterAndLoadResourcePackages=r[t.DashboardRegisterAndLoadResourcePackagesEventName]=function(e){return o({name:t.DashboardRegisterAndLoadResourcePackagesEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardRegisterAndLoadResourcePackagesLoggers})},t.DashboardLoadDashboardEventName="PBI.Dashboard.LoadDashboard",t.DashboardLoadDashboard=r[t.DashboardLoadDashboardEventName]=function(e){return o({name:t.DashboardLoadDashboardEventName,baseEvent:t.BaseDashboardEvent(e),info:e,category:a.TelemetryCategory.CustomerAction,optionalParameters:["pendingRequestCount"],loggers:t.DashboardLoadDashboardLoggers})},t.DashboardRecordDashboardTilesEventName="PBI.Dashboard.RecordDashboardTiles",t.DashboardRecordDashboardTiles=r[t.DashboardRecordDashboardTilesEventName]=function(e){return o({name:t.DashboardRecordDashboardTilesEventName,baseEvent:t.BaseDashboardVerboseEvent(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.DashboardRecordDashboardTilesLoggers})},t.DashboardRegisterAndLoadResourcePackagesForReportTilesEventName="PBI.Dashboard.RegisterAndLoadResourcePackagesForReportTiles",t.DashboardRegisterAndLoadResourcePackagesForReportTiles=r[t.DashboardRegisterAndLoadResourcePackagesForReportTilesEventName]=function(e){return o({name:t.DashboardRegisterAndLoadResourcePackagesForReportTilesEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardRegisterAndLoadResourcePackagesForReportTilesLoggers})},t.AppParseAppMetadataEventName="PBI.App.ParseAppMetadata",t.AppParseAppMetadata=r[t.AppParseAppMetadataEventName]=function(e){return o({name:t.AppParseAppMetadataEventName,baseEvent:t.TimedEvent(e),info:e,loggers:t.AppParseAppMetadataLoggers})},t.ArtifactNotFoundEventName="PBI.ArtifactNotFound",t.ArtifactNotFound=r[t.ArtifactNotFoundEventName]=function(e){return o({name:t.ArtifactNotFoundEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.ArtifactNotFoundLoggers})},t.AppModelInitializeContentProvidersEventName="PBI.AppModel.InitializeContentProviders",t.AppModelInitializeContentProviders=r[t.AppModelInitializeContentProvidersEventName]=function(e){return o({name:t.AppModelInitializeContentProvidersEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,optionalParameters:["isB2B","lastRetry"],loggers:t.AppModelInitializeContentProvidersLoggers})},t.AppsInstallAppEventName="PBI.Apps.InstallApp",t.AppsInstallApp=r[t.AppsInstallAppEventName]=function(e){return o({name:t.AppsInstallAppEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.AppsInstallAppLoggers})},t.NPSShowDialogEventName="PBI.NPS.ShowDialog",t.NPSShowDialog=r[t.NPSShowDialogEventName]=function(e){return o({name:t.NPSShowDialogEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.NPSShowDialogLoggers})},t.DashboardLoadTileVisualTimedOutEventName="PBI.Dashboard.LoadTileVisualTimedOut",t.DashboardLoadTileVisualTimedOut=r[t.DashboardLoadTileVisualTimedOutEventName]=function(e){return o({name:t.DashboardLoadTileVisualTimedOutEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.DashboardLoadTileVisualTimedOutLoggers})},t.DashboardAddDashboardEventName="PBI.Dashboard.AddDashboard",t.DashboardAddDashboard=r[t.DashboardAddDashboardEventName]=function(e){return o({name:t.DashboardAddDashboardEventName,baseEvent:t.BaseDashboardEvent(e),info:e,category:a.TelemetryCategory.CustomerAction,optionalParameters:["pendingRequestCount"],loggers:t.DashboardAddDashboardLoggers,logExpAssignment:!0})},t.UsageMetricsViewUsageMetricsReportEventName="PBI.UsageMetrics.ViewUsageMetricsReport",t.UsageMetricsViewUsageMetricsReport=r[t.UsageMetricsViewUsageMetricsReportEventName]=function(e){return o({name:t.UsageMetricsViewUsageMetricsReportEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.UsageMetricsViewUsageMetricsReportLoggers})},t.GroupsChangeMyWorkspaceCapacityEventName="PBI.Groups.ChangeMyWorkspaceCapacity",t.GroupsChangeMyWorkspaceCapacity=r[t.GroupsChangeMyWorkspaceCapacityEventName]=function(e){return o({name:t.GroupsChangeMyWorkspaceCapacityEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.GroupsChangeMyWorkspaceCapacityLoggers})},t.MobileAuthoringSwitchedStateEventName="PBI.MobileAuthoring.SwitchedState",t.MobileAuthoringSwitchedState=r[t.MobileAuthoringSwitchedStateEventName]=function(e){return o({name:t.MobileAuthoringSwitchedStateEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.MobileAuthoringSwitchedStateLoggers})},t.MobileAuthoringFlyoutShownEventName="PBI.MobileAuthoring.FlyoutShown",t.MobileAuthoringFlyoutShown=r[t.MobileAuthoringFlyoutShownEventName]=function(e){return o({name:t.MobileAuthoringFlyoutShownEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.MobileAuthoringFlyoutShownLoggers})},t.PersistentStateResetEventName="PBI.PersistentState.Reset",t.PersistentStateReset=r[t.PersistentStateResetEventName]=function(e){return o({name:t.PersistentStateResetEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.PersistentStateResetLoggers})},t.ThemingSaveThemeEventName="PBI.Theming.SaveTheme",t.ThemingSaveTheme=r[t.ThemingSaveThemeEventName]=function(e){return o({name:t.ThemingSaveThemeEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.ThemingSaveThemeLoggers})},t.DashboardGetResourcePackageItemEventName="PBI.Dashboard.GetResourcePackageItem",t.DashboardGetResourcePackageItem=r[t.DashboardGetResourcePackageItemEventName]=function(e){return o({name:t.DashboardGetResourcePackageItemEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.DashboardGetResourcePackageItemLoggers})},t.ProvidersSharePointWorkbookUploadRequestEventName="PBI.Providers.SharePointWorkbookUploadRequest",t.ProvidersSharePointWorkbookUploadRequest=r[t.ProvidersSharePointWorkbookUploadRequestEventName]=function(e){return o({name:t.ProvidersSharePointWorkbookUploadRequestEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.ProvidersSharePointWorkbookUploadRequestLoggers})},t.SpoImportWorkbookUploadRequestEventName="PBI.SpoImport.WorkbookUploadRequest",t.SpoImportWorkbookUploadRequest=r[t.SpoImportWorkbookUploadRequestEventName]=function(e){return o({name:t.SpoImportWorkbookUploadRequestEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.SpoImportWorkbookUploadRequestLoggers})},t.AppsGuestUserWithNoAccessErrorEventName="PBI.Apps.GuestUserWithNoAccessError",t.AppsGuestUserWithNoAccessError=r[t.AppsGuestUserWithNoAccessErrorEventName]=function(e){return o({name:t.AppsGuestUserWithNoAccessErrorEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.AppsGuestUserWithNoAccessErrorLoggers})},t.WebBookmarkLoadEventName="PBI.WebBookmark.Load",t.WebBookmarkLoad=r[t.WebBookmarkLoadEventName]=function(e){return o({name:t.WebBookmarkLoadEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.WebBookmarkLoadLoggers})},t.ExportPptBookmarkEventName="PBI.ExportPptBookmark",t.ExportPptBookmark=r[t.ExportPptBookmarkEventName]=function(e){return o({name:t.ExportPptBookmarkEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.ExportPptBookmarkLoggers})},t.TutorialCloseEventName="PBI.Tutorial.Close",t.TutorialClose=r[t.TutorialCloseEventName]=function(e){return o({name:t.TutorialCloseEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.TutorialCloseLoggers})},t.TutorialCancelEventName="PBI.Tutorial.Cancel",t.TutorialCancel=r[t.TutorialCancelEventName]=function(e){return o({name:t.TutorialCancelEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.TutorialCancelLoggers})},t.AppRouterErrorEventName="PBI.App.RouterError",t.AppRouterError=r[t.AppRouterErrorEventName]=function(e){return o({name:t.AppRouterErrorEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,optionalParameters:["message"],loggers:t.AppRouterErrorLoggers})},t.AppUIRouterStateEventName="PBI.App.UIRouterState",t.AppUIRouterState=r[t.AppUIRouterStateEventName]=function(e){return o({name:t.AppUIRouterStateEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,optionalParameters:["error"],loggers:t.AppUIRouterStateLoggers})},t.DashboardInitialReportLoadEventName="PBI.Dashboard.InitialReportLoad",t.DashboardInitialReportLoad=r[t.DashboardInitialReportLoadEventName]=function(e){return o({name:t.DashboardInitialReportLoadEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.DashboardInitialReportLoadLoggers})},t.LandingBindToPowerViewReportEventName="PBI.Landing.BindToPowerViewReport",t.LandingBindToPowerViewReport=r[t.LandingBindToPowerViewReportEventName]=function(e){return o({name:t.LandingBindToPowerViewReportEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.LandingBindToPowerViewReportLoggers})},t.UsageMetricsUpdateNewReportSettingEventName="PBI.UsageMetrics.UpdateNewReportSetting",t.UsageMetricsUpdateNewReportSetting=r[t.UsageMetricsUpdateNewReportSettingEventName]=function(e){return o({name:t.UsageMetricsUpdateNewReportSettingEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.UsageMetricsUpdateNewReportSettingLoggers})},t.SettingsPublishToWebPromptEventName="PBI.Settings.PublishToWebPrompt",t.SettingsPublishToWebPrompt=r[t.SettingsPublishToWebPromptEventName]=function(e){return o({name:t.SettingsPublishToWebPromptEventName,baseEvent:t.CustomerAction(e),info:e,category:a.TelemetryCategory.CustomerAction,loggers:t.SettingsPublishToWebPromptLoggers})},t.ChangeDetectionMeasureLongPollErrorEventName="PBI.ChangeDetectionMeasure.LongPollError",t.ChangeDetectionMeasureLongPollError=r[t.ChangeDetectionMeasureLongPollErrorEventName]=function(e){return o({name:t.ChangeDetectionMeasureLongPollErrorEventName,info:e,category:a.TelemetryCategory.CriticalError,loggers:t.ChangeDetectionMeasureLongPollErrorLoggers})},t.ChangeDetectionMeasureGetCDMConfigErrorEventName="PBI.ChangeDetectionMeasure.GetCDMConfigError",t.ChangeDetectionMeasureGetCDMConfigError=r[t.ChangeDetectionMeasureGetCDMConfigErrorEventName]=function(e){return o({name:t.ChangeDetectionMeasureGetCDMConfigErrorEventName,info:e,category:a.TelemetryCategory.CriticalError,loggers:t.ChangeDetectionMeasureGetCDMConfigErrorLoggers})},t.ChangeDetectionMeasureGetConceptualSchemaErrorEventName="PBI.ChangeDetectionMeasure.GetConceptualSchemaError",t.ChangeDetectionMeasureGetConceptualSchemaError=r[t.ChangeDetectionMeasureGetConceptualSchemaErrorEventName]=function(e){return o({name:t.ChangeDetectionMeasureGetConceptualSchemaErrorEventName,info:e,category:a.TelemetryCategory.CriticalError,loggers:t.ChangeDetectionMeasureGetConceptualSchemaErrorLoggers})},t.DashboardRealtimeModelLoadEventName="PBI.Dashboard.RealtimeModelLoad",t.DashboardRealtimeModelLoad=r[t.DashboardRealtimeModelLoadEventName]=function(e){return o({name:t.DashboardRealtimeModelLoadEventName,baseEvent:t.Verbose(e),info:e,category:a.TelemetryCategory.Verbose,loggers:t.DashboardRealtimeModelLoadLoggers})}})(a.telemetry||(a.telemetry={}))})(powerbi=powerbi||{}),(function(e){var t,o;(t=e.constants||(e.constants={})).actualOpenTileEventName="actualOpenTile",t.cancelEditWidgetEventName="cancelEditWidget",t.configPageErrorLoadingEventName="configPageErrorLoading",t.configPageLoadedEventName="configPageLoaded",t.contentListDashboardsLoadedEvent="contentListDashboardsLoaded",t.contentListDatasetsLoadedEvent="contentListDatasetssLoaded",t.contentListCdsaModelsLoadedEvent="contentListCdsaModelsLoaded",t.contentListFavoritesLoadedEvent="contentListFavoritesLoaded",t.contentListRecentlyUsedLoadedEvent="contentListRecentlyUsedLoaded",t.contentListReportsLoadedEvent="contentListReportsLoaded",t.contentListWorkbooksLoadedEvent="contentListWorkbooksLoaded",t.dashboardContainerLoaded="dashboardContainerLoaded",t.dataSourceAccessInfoGeneratedEventName="dataSourceAccessInfoGenerated",t.datasetShowHistoryDialog="datasetShowHistoryDialog",t.deleteModelEventName="deleteModel",t.enablePowerBICompanionApp="companionEnabled",t.myWorkSpaceFolderId="me",t.navPaneScrollEventName="navPaneScroll",t.navigateToActiveDashboard="navigateToActiveDashboard",t.notifyUpdateAllowQnaDataCollectionEventName="notifyUpdateAllowQnaDataCollection",t.openCreateContentPackEventName="openCreateContentPack",t.openModelEventName="openModel",t.openReportEventName="openReport",t.openTileEventName="openTile",t.removeTileEventName="removeTileFromGroup",t.renameDashboardEventName="renameDashboard",t.renameModelEventName="renameModel",t.reportDeletedEventName="reportDeleted",t.scrollToNavPaneListItemEventName="scrollToNavPaneListItem",t.shouldShowProviderTilesEventName="shouldShowProviderTiles",t.temporaryTilePinned="temporaryTilePinned",t.updateTileHrefEventName="updateTileHref",t.uploadFormatChosenEventName="uploadFormatChosen",t.replaceLocalWorkbookEventName="replaceLocalFile",t.removeDashboardTileErrorEventName="removeDashboardTileError",t.rowLevelSecurityAccessDeniedEventName="rowLevelSecurityAccessDenied",t.inFocusEnterEvent="inFocusEnter",t.inFocusExitEvent="inFocusExit",t.dashboardTileLayoutChangeEvent="dashboardTileLayoutChangeEvent",t.mobileApplication="winApp",t.pvScriptsLoaded="exploreHostLoaded",t.openReportStarting="openReportStarting",t.openReportSucceeded="openReportSucceded",t.openReportFailed="openReportFailed",t.modelFailedGenericServiceError="modelFailedGenericServiceError",t.modelFailedGenericClientError="modelFailedGenericClientError",t.modelFailednoErrorInfo="modelFailednoErrorInfo",t.openInFocusTileActionName="/openInFocus",t.openInFocusWorkbookTileActionName="/openInFocusWorkbook",t.openInFocusRealTimeTileActionName="/openInFocusRealTime",t.alertTitleMaxLength=250,t.hideTaskPaneSliderOnClickEventName="hideTaskPaneSliderOnClick",t.refreshTileData="refreshTileData",t.maxDashboardNameLength=30,t.biTokenRefreshInterval=23760027e5,t.appLoadErrorGroupNotAccessible="#groupNotAccessible#",t.populateDashboardWithReportTiles="populateDashboardWithReportTiles",t.saveDashboardSettings="saveDashboardSettings",t.insightsDescriptor="insights",t.groupSwitchedEventName="GroupSwitched",t.groupAddedUpdateContextMenuEventName="GroupAddedUpdateContextMenu",t.groupDeletedEventName="GroupDeleted",t.contentPackDirtyShowNotification="contentPackDirty",t.loadDashboardFailed="loadDashboardFailed",t.usageMetrics_Report="Report",t.usageMetrics_Dashboard="Dashboard",t.usageMetrics_NavModel="NavModel",t.genTwoCapacityPackageId="3621b8c8-250a-4f7f-82f0-0aa5064e7c02",o=t.navigation||(t.navigation={}),(e=o.states||(o.states={})).landing="landing",e.adminPortalNew="landing.admin-portal-new",e.adminPortalNewUsageMetrics="landing.admin-portal-new.usageMetrics",e.adminPortalNewUsageMetricsReport="landing.admin-portal-new.usageMetrics.report",e.adminPortalNewUsers="landing.admin-portal-new.users",e.adminPortalNewAuditLogs="landing.admin-portal-new.auditLogs",e.adminPortalNewTenantSettings="landing.admin-portal-new.tenantSettings",e.adminPortalNewOrganizationVisuals="landing.admin-portal-new.organizationVisuals",e.adminPortalNewEmbedCodes="landing.admin-portal-new.embedCodes",e.adminPortalNewCapacities="landing.admin-portal-new.capacities",e.adminPortalNewCapacity="landing.admin-portal-new.capacities.capacity",e.adminPortalNewCapacityMetrics="landing.admin-portal-new.capacities.metricDetail",e.adminPortalNewCapacitiesPivot="landing.admin-portal-new.capacities.pivot",e.adminPortalNewCreateCapacity="landing.admin-portal-new.capacities.createCapacity",e.adminPortalNewBYOResources="landing.admin-portal-new.byoresources",e.adminPortalNewDataflows="landing.admin-portal-new.dataflows",e.adminPortalNewWorkspace="landing.admin-portal-new.workspace",e.adminPortalNewBranding="landing.admin-portal-new.branding",e.adminPortalNewProtectionMetrics="landing.admin-portal-new.protectionMetrics",e.adminPortalNewPromotedContent="landing.admin-portal-new.promotedContent",e.adminPortalNewRefreshCenter="landing.admin-portal-new.refreshCenter",e.adminPortalNewRefreshCenterHistory="landing.admin-portal-new.refreshCenter.history",e.adminPortalNewRefreshCenterTimetable="landing.admin-portal-new.refreshCenter.timetable",e.adminPortalNewPPUTenantSettings="landing.admin-portal-new.ppuTenantSettings",e.featureddashboard="landing.featureddashboard",e.home="landing.home",e.learn="landing.learn",e.sample="landing.sample",e.about="landing.about",e.datahub="landing.datahub",e.discover="landing.discover",e.discoverGallery="landing.discover.gallery",e.discoverDatasets="landing.discover.datasets",e.goals="landing.goals",e.goalsHub="landing.goals.hub",e.invitation="landing.invitation",e.search="landing.search",e.pipelines="landing.pipelines",e.pipeline="landing.pipelines.pipeline",e.list="landing.groups.group.list",e.lineage="landing.groups.group.lineage",e.listPivot="landing.groups.group.list.pivot",e.groups="landing.groups",e.group="landing.groups.group",e.apps="landing.groups.group.apps",e.app="landing.groups.group.apps.app",e.appDashboards="landing.groups.group.apps.app.dashboards",e.appDashboard="landing.groups.group.apps.app.dashboards.dashboard",e.appDisplay="landing.groups.group.apps.app.display",e.appDisplayDashboards="landing.groups.group.apps.app.display.dashboards",e.appAlertsEditor="landing.groups.group.apps.app.dashboards.dashboard.alerts",e.appInFocusMode="landing.groups.group.apps.app.dashboards.dashboard.infocus",e.appInFocusInsights="landing.groups.group.apps.app.dashboards.dashboard.insights",e.appDashboardQna="landing.groups.group.apps.app.dashboards.dashboard.qna",e.appInsights="landing.groups.group.apps.app.insights",e.appInstances="landing.groups.group.apps.app.instances",e.appInstance="landing.groups.group.apps.app.instances.instance",e.appInstanceDashboards="landing.groups.group.apps.app.instances.instance.dashboards",e.appInstanceDashboard="landing.groups.group.apps.app.instances.instance.dashboards.dashboard",e.appInstanceAlertsEditor="landing.groups.group.apps.app.instances.instance.dashboards.dashboard.alerts",e.appInstanceInFocusMode="landing.groups.group.apps.app.instances.instance.dashboards.dashboard.infocus",e.appInstanceInFocusInsights="landing.groups.group.apps.app.instances.instance.dashboards.dashboard.insights",e.appInstanceDashboardQna="landing.groups.group.apps.app.instances.instance.dashboards.dashboard.qna",e.appInstanceDisplay="landing.groups.group.apps.app.instances.instance.display",e.appWebContents="landing.groups.group.apps.app.webContents",e.appWebContent="landing.groups.group.apps.app.webContents.webContent",e.appPackage="landing.groups.group.apps.app.package",e.appPackageInstall="landing.groups.group.apps.app.package.install",e.appPublish="landing.groups.group.apps.publish",e.appPublishPivot="landing.groups.group.apps.publish.pivot",e.appSettings="landing.groups.group.apps.settings",e.appSettingsPivot="landing.groups.group.apps.settings.pivot",e.contentList="landing.groups.group.contentList",e.contentListPivot="landing.groups.group.contentList.pivot",e.quickCreate="landing.groups.group.quickCreate",e.dashboards="landing.groups.group.dashboards",e.dashboard="landing.groups.group.dashboards.dashboard",e.dashboardMobileAuthoring="landing.groups.group.dashboards.dashboard.mobileAuthoring",e.dashboardReports="landing.groups.group.dashboards.dashboard.reports",e.dashboardReport="landing.groups.group.dashboards.dashboard.reports.report",e.dashboardReportPage="landing.groups.group.dashboards.dashboard.reports.report.page",e.dashboardWorkbooks="landing.groups.group.dashboards.dashboard.workbooks",e.dashboardWorkbook="landing.groups.group.dashboards.dashboard.workbooks.workbook",e.datapools="landing.groups.group.datapools",e.datapool="landing.groups.group.datapools.datapool",e.datapoolQuery="landing.groups.group.datapools.datapool.query",e.datapoolAuthoring="landing.groups.group.datapoolAuthoring",e.alertsEditor="landing.groups.group.dashboards.dashboard.alerts",e.inFocusMode="landing.groups.group.dashboards.dashboard.infocus",e.inFocusInsights="landing.groups.group.dashboards.dashboard.insights",e.dashboardQna="landing.groups.group.dashboards.dashboard.qna",e.dashboardRequestAccess="landing.groups.group.dashboards.dashboard.requestaccess",e.dashboardShare="landing.groups.group.dashboards.dashboard.share",e.modelQna="landing.groups.group.datasets.dataset.qna",e.modeling="landing.groups.group.modeling",e.model="landing.groups.group.modeling.model",e.accept2017ProTrial="landing.groups.group.accept2017ProTrial",e.favorites="landing.groups.group.favorites",e.insights="landing.groups.group.insights",e.gateways="landing.groups.group.gateways",e.gateway="landing.groups.group.gateways.gateway",e.dataSource="landing.groups.group.gateways.gateway.dataSource",e.getData="landing.groups.group.getData",e.getDataCategory="landing.groups.group.getData.category",e.getDataCategoryProviderName="landing.groups.group.getData.category.providerName",e.groupWelcome="landing.groups.group.groupWelcome",e.manageEmbed="landing.groups.group.manageEmbed",e.manageStorage="landing.groups.group.manageStorage",e.publishContent="landing.groups.group.publishContent",e.publishContentPackId="landing.groups.group.publishContent.publishContentPackId",e.rdlReports="landing.groups.group.rdlReports",e.rdlReport="landing.groups.group.rdlReports.rdlReport",e.rdlReportSubscription="landing.groups.group.rdlReports.rdlReport.subscription",e.appRdlReports="landing.groups.group.apps.app.rdlReports",e.appRdlReport="landing.groups.group.apps.app.rdlReports.rdlReport",e.appRdlReportSubscription="landing.groups.group.apps.app.rdlReports.rdlReport.subscription",e.recentlyViewed="landing.groups.group.recentlyViewed",e.rowLevelSecurity="landing.groups.group.rowlevelsecurity",e.settings="landing.groups.group.settings",e.settingsGroup="landing.groups.group.settings.settingsGroup",e.settingsId="landing.groups.group.settings.settingsGroup.settingsId",e.sharedWithMe="landing.groups.group.sharedWithMe",e.sharedDashboards="landing.groups.group.sharedWithMe.dashboards",e.sharedDashboard="landing.groups.group.sharedWithMe.dashboards.dashboard",e.sharedAlertsEditor="landing.groups.group.sharedWithMe.dashboards.dashboard.alerts",e.sharedInFocusMode="landing.groups.group.sharedWithMe.dashboards.dashboard.infocus",e.sharedInFocusInsights="landing.groups.group.sharedWithMe.dashboards.dashboard.insights",e.sharedDashboardQna="landing.groups.group.sharedWithMe.dashboards.dashboard.qna",e.sharedReports="landing.groups.group.sharedWithMe.reports",e.sharedReport="landing.groups.group.sharedWithMe.reports.report",e.sharedReportPage="landing.groups.group.sharedWithMe.reports.report.page",e.sharedDashboardReports="landing.groups.group.sharedWithMe.dashboards.dashboard.reports",e.sharedDashboardReport="landing.groups.group.sharedWithMe.dashboards.dashboard.reports.report",e.sharedDashboardReportPage="landing.groups.group.sharedWithMe.dashboards.dashboard.reports.report.page",e.sharedDashboardRequestAccess="landing.groups.group.sharedWithMe.dashboards.dashboard.requestaccess",e.sharedDashboardShare="landing.groups.group.sharedWithMe.dashboards.dashboard.share",e.sharedDashboardWorkbooks="landing.groups.group.sharedWithMe.dashboards.dashboard.workbooks",e.sharedDashboardWorkbook="landing.groups.group.sharedWithMe.dashboards.dashboard.workbooks.workbook",e.sharedWorkbooks="landing.groups.group.sharedWithMe.workbooks",e.sharedWorkbook="landing.groups.group.sharedWithMe.workbooks.workbook",e.sharedViews="landing.groups.group.sharedViews",e.sharedViewsReport="landing.groups.group.sharedViews.report",e.spo="landing.groups.group.spo",e.spoImport="landing.groups.group.spo.import",e.streamingDataflow="landing.groups.group.streamingDataflow",e.viewContent="landing.groups.group.viewContent",o.getDataWelcome="welcome",t.emailsListSeparator="; ",t.streamingDatasetModelPubNub="PubNub",t.defaultBrowserLanguageCode="browserLanguage",(o=t.quotaErrorCodes||(t.quotaErrorCodes={})).PowerBIUserQuotaExceeded="PowerBIUserQuotaExceeded",o.PowerBIGroupQuotaExceeded="PowerBIGroupQuotaExceeded",(o=t.ArtifactSearch||(t.ArtifactSearch={})).NumRecentlySearched=5,o.MaxQueryLength=260,(o=t.FileUploadWarnings||(t.FileUploadWarnings={})).OverwriteNonLocalPackageWithLocalFileError="OverwriteNonLocalPackageWithLocalFileError",o.InformationProtectionInsufficientUsageRightsError="InformationProtectionInsufficientUsageRights",(o=t.pbixUploadWarnings||(t.pbixUploadWarnings={})).ReportWithDisplayNameForTheModelExists="ReportWithDisplayNameForTheModelExists",o.MoreThanOneDuplicateReportFoundError="MoreThanOneDuplicateReportFoundError",o.ReplaceOriginalReportForPowerBICompanionNotSupported="ReplaceOriginalReportForPowerBICompanionNotSupported",o.ModelNotFound="PowerBIModelNotFoundException",o.UnauthorizedToThisProtectedPbixError="MipClientUnauthorizedUser",o.MandatoryLabelError="MissingMandatorySensitivityLabelException",(o=t.saasMarketplace||(t.saasMarketplace={})).acquireAppEventName="acquireSaasMarketplaceApp",o.initSaasMarketplaceEventName="initSaasMarketplace",o.updateHostUrl="updateUrlForSaasMarketplaceApp",o.updateUrlAndAcquireApp="updateUrlAndAcquireApp",o.updateUrlAndAcquireAppEvent={type:4,name:o.updateUrlAndAcquireApp},o.updateHostUrlEvent={type:4,name:o.updateHostUrl},(o=t.nps||(t.nps={})).closeNpsDialog="closeNpsDialog",o.resizeNpsDialog="thankyouNpsDialog",o.renderPath="/render/powerbi/",o.renderPathPBIE="/render/powerbiembedded/",o.displayPath="/display/powerbi/",o.displayPathPBIE="/display/powerbiembedded/",o.recordPath="/record/powerbi/",o.recordPathPBIE="/record/powerbiembedded/",o.puidParam="puid",o.languageParam="culture",t.DashboardSharingSecurityGroupRequirePro="DashboardInvitationSGRequirePro",t.DashboardInvitationUnsupportedGroup="DashboardInvitationUnsupportedGroup",(o=t.dynamicMessaging||(t.dynamicMessaging={})).userDismissedAction="dismissed",o.userClickedAction="clicked",t.targetValueBlank="_blank",t.downloadPBIDesktopLink="https://go.microsoft.com/fwlink/?LinkID=521920",t.pbiAppsLink="https://go.microsoft.com/fwlink/?linkid=838948",t.pbiAlertsLink="https://go.microsoft.com/fwlink/?linkid=851587",t.pbiTryNowLink="https://aka.ms/Iskx6l",t.refreshHistoryDialogTimeoutValue=9e6,t.refreshHistoryDialogTimeoutPremiumValue=216e5,t.configureScheduledRefreshLink="https://go.microsoft.com/fwlink/?linkid=844603",t.migrateOldStyleExternalUsersDetailsLink="https://go.microsoft.com/fwlink/?linkid=872794",(o=t.iconClasses||(t.iconClasses={})).Apps="pbi-glyph-my-apps",o.Dashboard="pbi-glyph-gauge",o.Report="pbi-glyph-barchart",o.RdlReport="pbi-glyph-rdl-report",o.Workbook="pbi-glyph-excel",o.Database="pbi-glyph-database",o.CdsaModel="pbi-glyph-dataflow",o.Workspace="pbi-glyph-collections",o.DatasetTable="pbi-glyph-table",o.AlmPipeline="pbi-glyph-rocket",t.fileExtensions={xlsxFileExtension:".xlsx",xlsxmFileExtension:".xlsm",csvFileExtension:".csv",pbiFileExtension:".pbix"},t.contentProviderIds={Excel:6,PBIX:7,Csv:60},t.providerBaseEndpointPaths={Excel:"/powerbi/providers/excel/",PBIX:"/powerbi/providers/pbi/",Csv:"/powerbi/providers/csv/"},t.insightsModuleConfig={name:"powerbi.insights",namespace:"powerbi.insights",dependency:{javascript:"insights",css:["insights"]}},(t.contentProviderArtifactsQuota||(t.contentProviderArtifactsQuota={})).maxDashboardCount=200,t.InformationProtectionErrorDictionary={InformationProtectionPublishingProtectedPbixFromCloudNotSupported:{errorMessage:"EimInformationProtection_PublishingProtectedPbixIsNotSupportedFromCloud_Message",buttonText:"PBI_Button_Label_Close"},InformationProtectionInsufficientUsageRights:{errorMessage:"UploadLocalFile_InformationProtectionInsufficientUsageRightsError",buttonText:void 0},MipClientUnauthorizedUser:{errorMessage:"EimInformationProtection_UnauthorizedToThisProtectedPbix_DialogMessage",buttonText:void 0}}})(powerbi=powerbi||{}),(function(e){(e=e.errors||(e.errors={})).excelViewWorkbookErrorMessageIds={ExcelViewWorkbookAlreadyOpened:"UploadExcel_Error_WorkbookAlreadyExists",ExcelProviderInsufficientLicense:"UploadExcel_Error_InsufficientLicense"},e.excelViewWorkbookErrorTitleIds={ExcelViewWorkbookAlreadyOpened:"UploadExcel_Error_WorkbookAlreadyExists_Title",ExcelProviderInsufficientLicense:"UploadExcel_Error_InsufficientLicense_Title"}})(powerbi=powerbi||{}),(function(c){var e,s,t,a,l,d,p,u,h,o,n;function i(e,t){var o=this;this.scope=e,this.services=t,this.scope.rootScope=t.rootScope,this.notificationIds=[],this.services.dashboardService.dashboardContainerLoadedPromise().then((function(){return o.initialize()})),this.scope.folderService=this.services.folderService,this.setupThemeHandler(),this.scope.appBarModernComponentOutputArgs={showTileErrors:function(){return o.toggleTileError()},bannerHidden:function(){return o.hideDashboardErrorBanner()},showTileErrorDetails:function(){return o.showTileErrorDetails()}},this.scope.appBarLazyLoadPath="@powerbi/AppBar/web-app-bar.module#WebAppBarModule"}e=c.controllers||(c.controllers={}),s=c.dataServices.AppUtils,t=c.common.models,a=c.dataServices.EwaNamedItemType,l=jsCommon.EnumExtensions,d=c.dataServices.models.IntraDomainNavigationType,p=c.dataServices.models.IsDashboardIntraDomainPrefix,u=c.dataServices.models.IsReportIntraDomainPrefix,h=c.dataServices.models.IsRdlReportIntraDomainPrefix,o=jsCommon.QueryStringUtil,n=c.common.constants.tileActions,i.createOptions=function(){return{additionalServices:["$window","contentProviderHttpService","dashboardHttpService","dashboardLayoutStrategy","dashboardService","dashboardStore","dashboardThemeService","featuredDashboard","featureSwitchService","flyoutService","modelConverter","navigation","promiseFactory","reportService","modelService","moduleLoader","workbookService","syncService","telemetryService","localizationService","overlayService","folderService","notificationBarService","viralTenantMergeHelperService","modelService","licenseEnforcementService","dashboardDataService","fullScreen","inFocusService","permissionService","pinTileService","modalDialogService","recentStore","quota","appService","taskPaneSliderService","ownership","usageMetricsReport","pbiLazyLoad","dropdown","lazy","shellCapabilities","dashboardThemeService","annotationsInterop","tileSpotlightService","globalEventBridge","appSettings","lazyProviderModern","tileSelectionService","userInfoStore","activeFolderId","appStore","dashboardAppBarService","reportStore"]}},i.prototype.$onInit=function(){this.scope.annotationsModulePath="@powerbi/Annotations/annotations.module#AnnotationsModule"},i.prototype.getDashboardTileErrorCount=function(){return this.dashboardTileErrorCount},i.prototype.setupThemeHandler=function(){var o=this;this.dashboardThemeChangeHandler={onDashboardThemeLoaded:function(e,t){o.services.dashboardDataService.activeDashboard.objectId===t&&o.applyTheme(e)},onDashboardThemeChanged:function(e){return o.applyTheme(e)}},this.services.dashboardThemeService.subscribe(this.dashboardThemeChangeHandler)},i.prototype.initialize=function(){var t,r,e,o,i,a=this;this.initialized||(this.viewMode=0,t=this.services,e=(r=this.scope).dashboardDataService=t.dashboardDataService,t.navigation.inDashboardView()&&t.dashboardService.prepareCustomVisualsForLoading(e.activeDashboard),r.fullScreen=t.fullScreen,r.dashboardInfo=this.getDashboardInfo(),r.isTileSpotlighted=function(){return a.isTileSpotlighted()},r.isSelectedTileHighlighted=function(){return a.isSelectedTileHighlighted()},this.resetDashboardTileErrors(),r.isDashboardErrorBannerOn=function(){return a.isDashboardErrorBannerOn()},r.$watch("dashboardDataService.activeDashboard",(function(e){var t,o,i;e&&(a.hideAllNotifications(),a.services.dashboardDataService.updateIsQnaEnabled(),a.updateShouldDisplayQuestionBox(),a.resetDashboardToWebView(e),a.toggleFullScreenByViewState(),a.resetDashboardTileErrors(),0<=e.id&&(i=e.contract.originalPackageId,t=(o=a.services.folderService.activeFolder)&&o.uniqueId,o=e.contract.originalDashboardObjectId,i={co:1,la:(new Date).toISOString(),ty:0,oid:e.objectId,dn:e.displayName,pm:e.getPermissions(),gid:t,originalid:o,packageid:i},a.services.recentStore.add(i),r.activeDashboardId=e.id,e=a.services.dashboardThemeService.getDashboardThemeName(e.objectId),a.applyTheme(e)),a.notifyIfModelRefreshDisabledBySelectiveRefresh())})),r.modernDashboardModulePath="@powerbi/Dashboard/dashboard.module#DashboardModule",r.modernDashboardAppBarInputArgs={isEmailSubscriptionEnabledCheck:function(){return a.isEmailSubscriptionEnabled()}},r.$watchGroup(["dashboardDataService.isQnaEnabled","isActive"],(function(e){t.dashboardDataService.activeDashboard&&a.updateShouldDisplayQuestionBox()})),t.licenseEnforcementService.createNotificationForTrial(),t.viralTenantMergeHelperService.viewingDataFromMergedViralTenant()&&t.notificationBarService.notify({message:t.localizationService.get("ArchivedContent_HeaderMessage"),notificationType:1,actions:[{displayText:t.localizationService.get("Back_To_PowerBI"),linkId:1,action:function(){return r.navigation.toggleArchivedContent()}}],secondaryLink:{displayText:t.localizationService.get("LearnMore"),urlString:"https://aka.ms/archivedWorkspaceDeprecation"}}),r.$on(c.constants.actualOpenTileEventName,(function(e,t,o){return a.onActualOpenTile(e,t,o)})),r.$on(c.constants.updateTileHrefEventName,(function(e,t,o){return a.onUpdateTileHref(e,t,o)})),r.$watch("dashboardDataService.activeDashboard.isLoaded",(function(e){return a.onDashboardLoad(e)})),r.$watchGroup(["dashboardDataService.activeDashboard","dashboardDataService.activeDashboard.isLoaded","dashboardDataService.activeDashboard.annotationsEnabled"],(function(e){var t=e[0],o=e[1],e=e[2];a.fetchAndApplyAnnotations(t,o,e)})),e=t.rootScope,o=this.services.globalEventBridge.createChannelSubscriptionManager().subscribe(c.services.events.dashboardTileErrorEventName,(function(e,t){a.onDashboardTileError(t.tile,t.errorDetails)})),i=e.$on(c.constants.removeDashboardTileErrorEventName,(function(e,t,o){return a.onRemoveDashboardTileError(e,t,o)})),e.$on(c.constants.removeTileEventName,(function(e,t){return a.onRemoveTile(e,t)})),r.$on("$destroy",(function(){a.toggleFullScreenByViewState(),o.unsubscribeAll(),i(),a.hideAllNotifications(),a.services.dashboardThemeService.unsubscribe(a.dashboardThemeChangeHandler),a.annotatedItemIdsSubscription&&(a.annotatedItemIdsSubscription.unsubscribe(),a.annotatedItemIdsSubscription=void 0),a.unreadAnnotationsSubscription&&(a.unreadAnnotationsSubscription.unsubscribe(),a.unreadAnnotationsSubscription=void 0)})),r.initialized=this.initialized=!0)},i.prototype.onStateChange=function(e,t){},i.prototype.toggleTileError=function(){var r=this;this.showDashboardTileErrors=!this.showDashboardTileErrors,this.showDashboardTileErrors?_.forOwn(this.tileErrorDetails,(function(e){for(var t=0,o=e.tileIds;t<o.length;t++){var i=o[t];r.services.tileSpotlightService.setSpotlight(i)}})):this.services.tileSpotlightService.clearSpotlights()},i.prototype.showTileErrorDetails=function(){var e,t=this.services.localizationService,o=this.scope.$new(),i=[],r=0;for(e in this.tileErrorDetails){var a={errorDetails:this.tileErrorDetails[e].errorDetails,count:this.tileErrorDetails[e].tileIds.length};r+=a.count,i.push(a)}o.tileErrors=i,o.title=t.format("DashboardAppBar_TileError_ErrorDialogSubTitle",[c.formattingService.formatValue(r)]),this.services.modalDialogService.showLegacyWebModalDialog({dialogName:t.get("DashboardAppBar_TileError_ErrorDialogTitle"),template:'\n    <div class="tileErrors">\n        <div class="errorText" ng-bind="::title"></div>\n        <div ng-repeat="tileError in ::tileErrors" class="tileError">\n            <div class="tileErrorCount">\n                <pbi-icon name="error" size="small"></pbi-icon>\n                <span localize="DashboardAppBar_TileError_ErrorDialogErrorTitle" localize-fragments>\n                    <span fragment-index="0" ng-bind="::tileError.count"></span>\n                </span>\n            </div>\n        </div>\n        <a class="modalErrorHelpLink" target="_blank" href="https://go.microsoft.com/fwlink/?LinkId=690865" localize="TopNav_HelpMenu_GetHelp"></a>\n    </div>\n    ',scope:o,isDismissable:!0,dialogActions:[new InJs.ModalDialogAction(t.get("PBI_Button_Label_Close"),function(e,t){o.closeDialog()},null,"")]})},i.prototype.onDashboardLoad=function(e){var t,o=this.services,i=o.dashboardDataService.activeDashboard;i&&(e&&o.navigation.inDashboardView()&&o.dashboardService.prepareCustomVisualsForLoading(i),t=i.objectId,i=o.featureSwitchService.featureSwitches,!e||(t=o.dashboardThemeService.getDashboardThemeName(t))&&this.applyTheme(t),i.copyVisualImage&&i.exportVisualImageTenantEnabled&&this.services.lazyProviderModern.getModule("@powerbi/CopyVisualImage/copy-visual-image.module#CopyVisualImageModule"),this.applyTileSpotlightForShareToTeamsLink())},i.prototype.fetchAndApplyAnnotations=function(n,s,l){return __awaiter(this,void 0,c.Promise,(function(){var t,o,i,r,a=this;return __generator(this,(function(e){switch(e.label){case 0:return n&&s?(r=this.services,t=r.annotationsInterop,o=r.flyoutService,i=r.shellCapabilities,[4,r.shellCapabilities.ensureCapabilitiesInitialized()]):[2];case 1:return(e.sent(),!i.getCapabilities().dashboardSettings.showComments||this.services.featureSwitchService.featureSwitches.tenantDisableCommentingEnabled)?[2]:(this.annotatedItemIdsSubscription&&(this.annotatedItemIdsSubscription.unsubscribe(),this.annotatedItemIdsSubscription=void 0),this.unreadAnnotationsSubscription&&(this.unreadAnnotationsSubscription.unsubscribe(),this.unreadAnnotationsSubscription=void 0),l?((r=this.getAnnotationsDeepLinkKeyFromQueryString())&&(this.services.telemetryService.logEvent(c.telemetry.AnnotationsOpenAnnotationsPane,{artifactType:"Dashboard"}),o.expandFlyout()),this.annotatedItemIdsSubscription=t.loadForDashboard(n.objectId,n.id,r).subscribe((function(e){a.updateTilesWithConversation(e.artifactIds)}))):(o.collapseFlyout(),this.updateTilesWithConversation()),[2])}}))}))},i.prototype.getAnnotationsDeepLinkKeyFromQueryString=function(){var e=o.parseQueryString(),t=_.parseInt(e&&e.conversationId),e=_.parseInt(e&&e.commentId);if(!_.isNaN(t)&&!_.isNaN(e))return{conversationId:t,commentId:e}},i.prototype.applyTileSpotlightForShareToTeamsLink=function(){var e=this.getShareToTeamsConfigFromQueryString();e&&"MSTeams"===e.source&&this.services.tileSpotlightService.setSpotlight(e.tileId)},i.prototype.getShareToTeamsConfigFromQueryString=function(){var e=o.parseQueryString(),t=e&&e.openDashboardSource,e=_.parseInt(e&&e.tileId);if(!_.isNaN(t)&&!_.isNaN(e))return{source:t,tileId:e}},i.prototype.applyTheme=function(e){this.scope.dashboardStyle=this.services.dashboardThemeService.getDashboardStyles(e),this.scope.qnaStyle=_.pick(this.scope.dashboardStyle,jsCommon.CssConstants.colorProperty),this.scope.qnaStyle[jsCommon.CssConstants.backgroundProperty]=jsCommon.CssConstants.transparentValue},i.prototype.updateTilesWithConversation=function(e){var t=this.services.dashboardDataService.activeDashboard;if(null!=t){var o={};if(!_.isEmpty(e))for(var i=0,r=e;i<r.length;i++)o[r[i]]=!0;for(var a=0,n=t.tiles;a<n.length;a++){var s=n[a];s.hasConversation=!!o[s.id]}}},Object.defineProperty(i.prototype,"contentProviders",{get:function(){return this.services.contentProviderHttpService.getBuiltInContentProviders(this.services.activeFolderId)},enumerable:!1,configurable:!0}),i.prototype.updateShouldDisplayQuestionBox=function(){var e=this.scope.dashboardDataService;this.scope.shouldDisplayQuestionBox=e.isQnaEnabled&&this.scope.isActive&&e.activeDashboardContainsQnaSupportedModel},i.prototype.resetDashboardToWebView=function(e){this.services.dashboardLayoutStrategy.switchLayoutStrategy(e,new t.DefaultGridLayoutStrategy,0),this.viewMode=0},i.prototype.onActualOpenTile=function(e,t,o){e&&e.stopPropagation&&e.stopPropagation();var i,r=this.services.telemetryService;t.contractsModel&&(i=t.contractsModel.contentProviderId);var e=c.dataServices.AppUtils.findContentProviderName(this.contentProviders,i),a=r.startEvent(c.telemetry.DashboardOpenTile,{tileId:(t.report||t).id,reason:"No error",contentProviderId:i,contentProviderDisplayText:e});switch(t.action.action){case n.openReportActionName:this.openReportTile(t,o,a);break;case n.custom.openUrlActionName:this.openUrlTile(t,a);break;case n.openInsightsActionName:case n.openInFocusActionName:this.services.inFocusService.view(t);break;case n.openWorkbookActionName:this.openWorkbookTile(t,o,a);break;case n.openQnAActionName:this.openQnaTile(t)}},i.prototype.onUpdateTileHref=function(e,t,o){var i=this.services,r=!l.hasFlag(i.dashboardDataService.activeDashboard.getPermissions(),2);if(p(o)){var a=this.getIntraDomainNavigationTargetName(o);return t.intraDomainNavigationParameters=this.getDashboardNavigationParameters(t,a),void(!r||t.intraDomainNavigationParameters||_.isEmpty(a)||(t.href=i.appSettings.baseUrl+"/groups/me/dashboards/"+a,t.action.openInSameTab=!1))}if(u(o)){var n=this.getIntraDomainNavigationTargetName(o);return t.intraDomainNavigationParameters=this.getReportNavigationParameters(t,n,d.Report),void(!r||t.intraDomainNavigationParameters||_.isEmpty(n)||(t.href=i.appSettings.baseUrl+"/groups/me/reports/"+n,t.action.openInSameTab=!1))}if(h(o)){n=this.getIntraDomainNavigationTargetName(o);return t.intraDomainNavigationParameters=this.getReportNavigationParameters(t,n,d.RdlReport),void(!r||t.intraDomainNavigationParameters||_.isEmpty(n)||(t.href=i.appSettings.baseUrl+"/groups/me/rdlreports/"+n,t.action.openInSameTab=!1))}t.intraDomainNavigationParameters=void 0,t.href=o},i.prototype.onDashboardTileError=function(i,r){return __awaiter(this,void 0,c.Promise,(function(){var t,o;return __generator(this,(function(e){switch(e.label){case 0:return[4,this.services.pinTileService.pinTileScope];case 1:return(t=e.sent())&&t.viewModel&&((o=t.viewModel).dashboardTile===i||o.reportTile===i||o.workbookTile===i)?[2]:(t=r.message,(o=this.tileErrorDetails[t]?this.tileErrorDetails[t].tileIds:null)?o.indexOf(i.id)<0&&(o.push(i.id),this.dashboardTileErrorCount++):(this.tileErrorDetails[t]={tileIds:[i.id],errorDetails:r},this.dashboardTileErrorCount++),[2])}}))}))},i.prototype.onRemoveDashboardTileError=function(e,t,o){e&&e.stopPropagation&&e.stopPropagation();e=o.message,o=this.tileErrorDetails[e]?this.tileErrorDetails[e].tileIds:null;_.isEmpty(o)||0<=(t=o.indexOf(t.id))&&(o.splice(t,1),this.dashboardTileErrorCount--,_.isEmpty(o)&&delete this.tileErrorDetails[e])},i.prototype.getDashboardNavigationParameters=function(e,t){if(e.href=void 0,t){var o=_.filter(this.services.dashboardDataService.dashboards,(function(e){return!e.isHidden})),i=this.services.dashboardDataService.activeDashboard,r=i&&i.getUniquePackageId(),e=i&&s.getDashboardAppGUID(i,this.services.appService);e&&(o=_.filter(o,(function(e){return e.getUniquePackageId()===r})));i=_.filter(o,(function(e){return e.displayName.toLowerCase()===t||e.objectId.toLowerCase()===t})),o=_.filter(o,(function(e){return e.contract.originalDashboardObjectId&&e.contract.originalDashboardObjectId.toLowerCase()===t}));if(!_.isEmpty(i)||!_.isEmpty(o)){var a=(a=r&&!(a=1<i.length?_.find(i,(function(e){return e.getUniquePackageId()===r}))||a:a)&&1<o.length?_.find(o,(function(e){return e.getUniquePackageId()===r}))||a:a)||(i[0]||o[0]),o=r;return e&&!s.isOrgAppInstance(o,this.services.appService)||(o=null),{navigationTargetGuid:a.objectId,navigationTargetOriginalGuid:a.contract.originalDashboardObjectId,navigationTargetAppGuid:e,navigationType:d.Dashboard,navigationSubPage:null,appInstance:o}}}},i.prototype.getReportNavigationParameters=function(e,t,o){if(e.href=void 0,t){var i=this.services.reportService.reports,r=this.services.dashboardDataService.activeDashboard,e=r&&s.getDashboardAppGUID(r,this.services.appService),a=r&&r.getUniquePackageId();e&&(i=_.filter(i,(function(e){return e.packageId===a})));r=_.filter(i,(function(e){return e.displayName.toLowerCase()===t||e.objectId.toLowerCase()===t})),i=_.filter(i,(function(e){return e.contract.originalReportObjectId&&e.contract.originalReportObjectId.toLowerCase()===t}));if(!_.isEmpty(r)||!_.isEmpty(i)){var n=(n=a&&!(n=1<r.length?_.find(r,(function(e){return e.packageId===a}))||n:n)&&1<i.length?_.find(i,(function(e){return e.packageId===a}))||n:n)||(r[0]||i[0]),i=a;return e&&!s.isOrgAppInstance(i,this.services.appService)||(i=null),{navigationTargetGuid:n.objectId,navigationTargetOriginalGuid:n.contract.originalReportObjectId,navigationTargetAppGuid:e,navigationType:o,navigationSubPage:null,appInstance:i,additionalODataFilter:null}}}},i.prototype.getIntraDomainNavigationTargetName=function(e){e=e.split("/");return e.length<3?null:("dashboards"===e[1].toLowerCase()||"reports"===e[1].toLowerCase()||e[1].toLowerCase(),decodeURIComponent(e[2]).toLowerCase())},i.prototype.openReportTile=function(n,s,l){return __awaiter(this,void 0,c.Promise,(function(){var t,o,i,r,a;return __generator(this,(function(e){switch(e.label){case 0:return this.canOpenReport(n)?(l.event.info.tileType="Report",t=this.services.dashboardDataService.findDashboard(s),!n.report&&n.contract.reportId&&this.services.reportStore?(o=this.services.promiseFactory.defer(),this.services.reportStore.load(n.contract.reportId,o),[4,o.promise]):[3,3]):[3,4];case 1:return e.sent(),[4,this.services.reportStore.findById(n.contract.reportId)];case 2:(a=e.sent())&&(n.report=this.services.modelConverter.convertReport(a)),e.label=3;case 3:if(n.report&&n.report.id)r=i=void 0,n.action&&(i=n.action.targetSlideId,this.services.featureSwitchService.featureSwitches.usageMetricsEnabled&&this.services.usageMetricsReport.isUsageMetricsArtifact(n.report)&&(r=n.action.filter)),n.report.model=n.contractsModel,n.report.packageId=n.contract.packageId,a=this.services,a.reportService.findReport(n.report.id)||(a.reportService.addReport(n.report),a.modelService.addModel(a.modelConverter.convertModel(n.report.model))),a.navigation.navigateToReportHelper(n.report.contract,a.folderService.activeFolderObjectId,i,null,r,null);else{if(i=t.getPermissions(),r=this.services.permissionService.getModelEffectivePermissions(n.contractsModel),t.isHidden||2!=(2&i)||2!=(2&r))return[2];this.services.quota.checkQuotaExceeded()||this.services.permissionService.isActiveWorkspaceIsReadOnlyLegacy||this.services.navigation.navigateToDataset({groupGuid:this.services.folderService.activeFolderObjectId,datasetDBName:n.contractsModel.dbName,instantiationMode:2})}e.label=4;case 4:return l.resolve(),[2]}}))}))},i.prototype.canOpenReport=function(e){if(!e.contractsModel){var t=e.contract.modelId,o=this.services.modelService.models;if(!o)return!1;for(var i=o.length,r=0;r<i;r++)o[r].id===t&&(e.contractsModel=o[r])}var a=null!=e.contractsModel&&null!=e.contractsModel.vsName&&null!=e.contractsModel.dbName,n=2===e.contract.publishState;return a&&n},i.prototype.openUrlTile=function(e,t){if(!e.href&&e.intraDomainNavigationParameters){var o=e.intraDomainNavigationParameters;switch(o.navigationType){case d.Dashboard:o.navigationTargetAppGuid?this.services.navigation.navigateToAppDashboardByGUID(o.navigationTargetGuid,o.navigationTargetOriginalGuid,o.navigationTargetAppGuid,o.appInstance):this.services.navigation.navigateToDashboardByGUID(o.navigationTargetGuid);break;case d.Report:this.services.navigation.navigateToReport({appGUID:o.navigationTargetAppGuid,appInstanceId:o.appInstance,reportGUID:o.navigationTargetGuid,reportOriginalGUID:o.navigationTargetOriginalGuid,groupGUID:this.services.folderService.activeFolderObjectId,reportPage:o.navigationSubPage,filter:o.additionalODataFilter});break;case d.RdlReport:this.services.navigation.navigateToRdlReport({appGUID:o.navigationTargetAppGuid,appInstanceId:o.appInstance,rdlReportGUID:o.navigationTargetGuid,rdlReportOriginalGUID:o.navigationTargetOriginalGuid,groupGUID:this.services.folderService.activeFolderObjectId,reportPage:o.navigationSubPage,filter:o.additionalODataFilter});break;default:o.navigationType}}t.event.info.tileType="Url",t.resolve()},i.prototype.openWorkbookTile=function(e,t,o){var i=this.services.workbookService.findWorkbook(e.contract.workbookId,e.contract.packageId),r=this.services.workbookService.getWorkbookUniqueId(i),e=e.contract.$config.workbookTile.itemType===a.NamedRange||e.contract.$config.workbookTile.itemType===a.Table?e.contract.$config.workbookTile.item:e.contract.$config.workbookTile.activeSelection,i=this.services.ownership.isResourceSharedWithMe(i);this.services.navigation.navigateToWorkbookByUrlId(r,e,i)},i.prototype.openQnaTile=function(t){return __awaiter(this,void 0,c.Promise,(function(){return __generator(this,(function(e){return this.services.navigation.showQnaView(t.utterance,!1),[2]}))}))},i.prototype.onRemoveTile=function(e,t){e&&e.stopPropagation&&e.stopPropagation(),this.services.dashboardService.prepareCustomVisualsForLoading(this.services.dashboardDataService.activeDashboard),this.removeTileAndUpdateTileErrorCount(t)},i.prototype.toggleFullScreenByViewState=function(){var e=$(".enterFullScreenBtn");0<e.length&&(0===this.viewMode?e.show():e.hide())},i.prototype.getDashboardInfo=function(){var e=this.services.dashboardDataService.activeDashboard;if(e){var t=e.contract,t={dashboardName:t.displayName,dashboardId:t.id,modelIds:t.modelIds,dashboardObjectId:t.objectId,originalDashboardObjectId:t.originalDashboardObjectId},e=s.getDashboardAppGUID(e,this.services.appService);return t.contentProviderKey=e,t}},i.prototype.isEmailSubscriptionEnabled=function(){return!!this.services.dashboardAppBarService&&this.services.dashboardAppBarService.isEmailSubscriptionEnabled(this.viewMode)},i.prototype.updateTileErrorCount=function(){var t=this;this.dashboardTileErrorCount=0,this.tileErrorDetails&&_.forOwn(this.tileErrorDetails,(function(e){e=e.tileIds;t.dashboardTileErrorCount+=e.length}))},i.prototype.removeTileAndUpdateTileErrorCount=function(i){var r=this;this.tileErrorDetails&&_.forOwn(this.tileErrorDetails,(function(e,t){var o=e.tileIds,e=o.indexOf(i.id);0<=e&&o.splice(e,1),0===o.length&&delete r.tileErrorDetails[t]})),this.updateTileErrorCount()},i.prototype.notifyIfModelRefreshDisabledBySelectiveRefresh=function(){var e=this.services;e.dashboardDataService.isActiveDashboardModelRefreshDisabled()&&this.notificationIds.push(e.notificationBarService.notify({message:e.localizationService.get("Notification_InactiveModelRefreshDisabled"),notificationType:3,secondaryLink:{displayText:e.localizationService.get("LearnMore"),urlString:c.constants.configureScheduledRefreshLink}}))},i.prototype.hideAllNotifications=function(){for(var e=this.services.notificationBarService;!_.isEmpty(this.notificationIds);)e.hide(this.notificationIds.pop());this.notificationIds=[]},i.prototype.resetDashboardTileErrors=function(){this.tileErrorDetails={},this.showDashboardTileErrors=!1,this.dashboardTileErrorCount=0,this.tileErrorBannerHidden=!1},i.prototype.isTileSpotlighted=function(){return this.services.tileSpotlightService.isLegacySpotlightSet()},i.prototype.isSelectedTileHighlighted=function(){return this.isTileSpotlighted()},i.prototype.hideDashboardErrorBanner=function(){this.tileErrorBannerHidden=!0},i.prototype.isDashboardErrorBannerOn=function(){return 0<this.dashboardTileErrorCount&&!this.tileErrorBannerHidden},e.DashboardContainerController=i})(powerbi=powerbi||{}),(function(e){var t,r;function o(e,t,o,i){this.type=e,this.objectId=t,this.workspaceId=o,this.packageid=i,this.count=0,this.contentTileType=r.MRU,this.uniqueId=e+"_"+t+"_"+o+"_"+i}t=e.models||(e.models={}),r=e.common.contracts.ContentTileType,o.prototype.getPermissions=function(){return this.permissions},t.MRUModel=o})(powerbi=powerbi||{}),(function(l){var e,c;e=(e=l.helpers||(l.helpers={})).ArtifactNotFoundHelper||(e.ArtifactNotFoundHelper={}),c=!1,e.showArtifactDoesNotExistDialog=function(e,t,o,i,r){if(!c){c=!0;var a=o.get(e),n=o.format("ArtifactDoesNotExistTitleFormat",[a]),a=o.get("ArtifactDoesNotExistMessage");i.logEvent(l.telemetry.ArtifactNotFound,{artifactKind:e});var s,o={label:o.get("PBI_Button_Label_OK"),resultValue:"ok",cssClass:"primary"};r&&(s=r.defer());r=function(){c=!1,s&&s.resolve(void 0)};return t.error(a,"artifactNotFound",{title:n,dialogOptions:[o],isDismissable:!0,showAdditionalErrorInfo:!1,dismissCallback:r,onDialogClosed:r}),s&&s.promise}}})(powerbi=powerbi||{}),(function(e){var o;function t(){}e=e.helpers||(e.helpers={}),o=jsCommon.QueryStringUtil,t.getAnnotationsDeepLinkKeyFromQueryString=function(){var e=o.parseQueryString(),t=_.parseInt(e&&e.conversationId),e=_.parseInt(e&&e.commentId);if(!_.isNaN(t)&&!_.isNaN(e))return{conversationId:t,commentId:e}},e.AnnotationsHelper=t})(powerbi=powerbi||{}),(function(e){(e=(e=e.helpers||(e.helpers={})).ContentPackAuthoringHelper||(e.ContentPackAuthoringHelper={})).isLocalWorkbook=function(e,t){return(e=t.findPackage(e.contract.packageId))&&0===e.contract.storageProviderType},e.updateContentPack=function(e,t){e.providerContract=t.providerContract,e.publishedTo=t.publishedTo,e.listOfGroupPrincipals=t.listOfGroupPrincipals,e.isSharedToEntireOrg=t.isSharedToEntireOrg,e.providerId=t.providerId,e.displayText=t.displayText,e.iconUrl=t.iconUrl,e.description=t.description,e.publishTime=t.publishTime,e.author=t.author,e.category=t.category,e.allowCopyContent=t.allowCopyContent,e.dashboardIds=__spreadArray([],t.dashboardIds||[]),e.reportIds=__spreadArray([],t.reportIds||[]),e.modelIds=__spreadArray([],t.modelIds||[]),e.workbookIds=__spreadArray([],t.workbookIds||[])},e.getUsedDatasets=function(e,t,o){var t=_.union.apply(_,_.map(t,(function(e){return e.contract.modelIds}))),o=_.map(o,(function(e){return e.contract.modelId})),i=_.union(t,o);return _.filter(e,(function(e){return _.includes(i,e.id)}))}})(powerbi=powerbi||{}),(function(e){var t;t=e.contentProviderConstants||(e.contentProviderConstants={}),e=e.common.contracts.ContentProviderClientCategory,t.CategoryNameToEnumMap={files:e.File,services:e.Service,samples:e.Sample,bigdata:e.BigDataAndMore,myorg:e.Organizational,learn:e.Learn,contentpacks:e.OrgContentPacks,apps:e.Apps},t.categoryEnumToNameMap={},t.categoryEnumToNameMap[e.File]="files",t.categoryEnumToNameMap[e.Sample]="samples",t.categoryEnumToNameMap[e.Service]="services",t.categoryEnumToNameMap[e.BigDataAndMore]="bigdata",t.categoryEnumToNameMap[e.Organizational]="myorg",t.categoryEnumToNameMap[e.Learn]="learn",t.categoryEnumToNameMap[e.Dataflows]="dataflows",t.categoryEnumToNameMap[e.OrgContentPacks]="contentpacks",t.categoryEnumToNameMap[e.Apps]="apps",t.categoryEnumToDisplayNameMap={},t.categoryEnumToDisplayNameMap[e.File]="GetData_Files",t.categoryEnumToDisplayNameMap[e.Sample]="GetData_Samples",t.categoryEnumToDisplayNameMap[e.Service]="GetData_Services",t.categoryEnumToDisplayNameMap[e.BigDataAndMore]="GetData_BigDataAndMore",t.categoryEnumToDisplayNameMap[e.Organizational]="GetData_MyOrganization",t.categoryEnumToDisplayNameMap[e.Learn]="GetData_AddYourContent",t.categoryInteractionTelemetryMap={breadcrumb:"Breadcrumb",navPane:"NavPane",splashPage:"SplashPage",getApps:"GetApps"},t.getAppsInteraction="getApps",t.saasMarketplacePublicCategory="public",t.saasMarketplacePrivateCategory="private",t.salesforceAppName="salesforce",t.OneDriveStorageProviderId="1"})(powerbi=powerbi||{}),(function(c){var e,d;e=c.helpers||(c.helpers={}),d=c.common.contracts.ContentProviderClientCategory,(e=e.ContentProviderStoreHelper||(e.ContentProviderStoreHelper={})).getErrorMessageId=function(e,t,o){if(e){t=c.common.KnownContentProviderErrors[t],e=t&&t[e];if(e)return (function(e,t){var o=e.messageId;e.messageIdOverride&&t.featureSwitches[e.messageIdOverride.featureSwitch]&&(o=e.messageIdOverride.messageId);return o})(e,o)}},e.getStoreOperationType=function(e,t,o,i){return!1!==e.isImportOperation?i&&t&&o.isAppCategory(t.category)?2:0:1},e.navigateToCategoryAndProviderHelper=function(e,t,o,i,r,a,n,s){var l=c.contentProviderConstants.categoryEnumToNameMap[e],t=c.contentProviderConstants.categoryInteractionTelemetryMap[t];o.logEvent(c.telemetry.DashboardGetDataCategorySelect,{categoryName:l,interaction:t}),e===d.Dataflows?i.navigateToDatapoolView(r):e===d.Service||e===d.Organizational?i.showGetDataSlider({categoryName:s?l:"contentpacks",getDataView:"getapps"}):i.showGetDataSlider({categoryName:l,getDataView:s?"getapps":"getdata"})}})(powerbi=powerbi||{}),(function(d){var e,p,u,t,r,o,a,i;function h(e){var t=e.contentTileType;if(t!==u.Dataset)return t===u.Workbook?e.uniqueId:(u.CdsaModel,e.objectId)}function n(e){var t=e.contentTileType;return t===u.MRU&&e instanceof d.models.MRUModel?t=s(e):t===u.Favorite&&(t=l(e)),t}function s(e){switch(e.type){case 0:return u.Dashboard;case 1:return u.Report;case 4:return u.RdlReport;case 2:return u.Workbook;case 3:return u.OrgApp;case 5:return u.Workspace}}function l(e){switch(e.favoriteType){case r.Dashboard:return u.Dashboard;case r.Report:return u.Report;case r.RdlReport:return u.RdlReport;case r.App:return u.OrgApp}}function c(e){e=e.contentTileType;return e===u.Dashboard||e===u.Report||e===u.Workbook||e===u.RdlReport}e=d.helpers||(d.helpers={}),u=d.common.contracts.ContentTileType,t=d.dataServices.models.Dashboard,r=d.common.contracts.FavoriteType,o=d.common.models.Model,a=d.models.MRUModel,i=d.common.models.Report,(p=e.ContentTileHelper||(e.ContentTileHelper={})).getGroupId=function(e,t){return e.workspaceId||(e.contentTileType===u.Favorite?d.constants.myWorkSpaceFolderId:t.activeFolderObjectId)},p.getObjectID=h,p.getOriginalObjectID=function(e){return e instanceof t?e.contract&&e.contract.originalDashboardObjectId:e instanceof i?e.contract&&e.contract.originalReportObjectId:e instanceof a?e.originalGUID:e.contentTileType===u.Favorite?e.originalObjectId:void 0},p.getPackageId=function(e){if(e.contentTileType===u.OrgApp)return e.packageId;if(e.contentTileType===u.Dashboard)return e.contract&&e.contract.originalPackageId;if(e.contentTileType===u.Report||e.contentTileType===u.RdlReport)return e.packageId;if(e.contentTileType===u.Workbook)return e.packageId;if(e instanceof a)return e.packageid;if(e.contentTileType===u.Dataset)return e.packageId;if(e.contentTileType===u.Favorite){e=e;if(l(e)===u.OrgApp)return e.favoriteId}},p.isNew=function(e,t){return e instanceof o?e.isNew&&2!==e.contract.packagePublishStatus&&4!==e.contract.packagePublishStatus&&!(function(e,t){{if(e instanceof o){e=t.findModel(e.contract.id,e.contract.packageId);return!!e&&e.isRefreshInProgress}return!1}})(e,t):e.isNew},p.isFavoritableContentType=function(e){return e===u.OrgApp||e===u.Dashboard||e===u.Report||e===u.RdlReport},p.getActualType=n,p.isReportModelIdNull=function(e){return n(e)===u.Report&&(e&&!e.modelId)},p.getMRUActualType=s,p.getFavoriteActualType=l,p.getMRUOriginalContentTile=function(e,t,o,i,r,a){var n,s,l=p.getActualType(e),c=h(e);switch(l){case u.Dashboard:s=t.findDashboardByGUID(c);break;case u.Report:case u.RdlReport:s=o.findReportByGUID(c);break;case u.Workbook:s=i.findWorkbookByUniqueId(c);break;case u.OrgApp:e instanceof d.models.MRUModel&&(n=e.packageid,s=r.getAppInstance(n));break;case u.Workspace:s=a.getFolder(c)}return s||e},p.getFavoriteId=function(e,t,o){if(e instanceof d.dataServices.models.Dashboard)return e.id;if(e instanceof d.common.models.Report)return e.id;if(e.contentTileType===u.OrgApp)return e.packageId;if(e.contentTileType===u.Favorite)return e.favoriteId;if(e instanceof a){var i=s(e);if(i===u.Dashboard){t=t.findDashboardByGUID(e.objectId);return t&&t.id}if(i===u.Report||i===u.RdlReport){o=o.findReportByGUID(e.objectId);return o&&o.id}if(i===u.OrgApp)return e.packageid}},p.getContentFavoriteType=function(e){return (function e(t,o){switch(o){case u.Favorite:return t.favoriteType;case u.Dashboard:return r.Dashboard;case u.Report:return r.Report;case u.RdlReport:return r.RdlReport;case u.OrgApp:return r.App;case u.MRU:var i=s(t);return i===u.Dashboard||i===u.Report||i===u.RdlReport||u.OrgApp,e(t,i)}})(e,e.contentTileType)},p.getId=function(e){if(c(e))return e.contract&&e.contract.id},p.isStaged=function(e){return!!c(e)&&(!!e.contract&&e.contract.isStaging)},p.getInstalledContentPackRefId=function(e,t){return(e=t.findPackage(e))&&e.contract&&e.contract.contentProviderRefId},p.deleteModelHelper=function(e,t,o,i,r){null==(o=p.getInstalledContentPackRefId(t,o))?i.deleteModel(e,t):r.uninstallContentPack(o,t)}})(powerbi=powerbi||{}),(function(e){var t,n;function a(e,t,o){return!!o.isTrustedVisual(e)&&(t.type===n.composite&&t.config&&t.config.visualContainer&&t.config.visualContainer.$visualContainer.config.singleVisual.visualType===e)}t=(t=e.helpers||(e.helpers={})).TrustedVisualUtil||(t.TrustedVisualUtil={}),n=e.dataServices.contracts.TileType,t.dashboardContainsTrustedVisual=function(e,t,o){if(!o.isTrustedVisual(e))return!1;for(var i=0,r=t.tiles;i<r.length;i++)if(a(e,r[i],o))return!0;return!1},t.tileContainsTrustedVisual=a,t.acquireTrustedVisuals=function(e,t){for(var o=[],i=0,r=e.tiles;i<r.length;i++){var a=r[i],a=a.type===n.composite&&a.config&&a.config.visualContainer&&a.config.visualContainer.$visualContainer.config.singleVisual.visualType;a&&t.isTrustedVisual(a)&&o.push(a)}return t.getConsentAndLoadVisuals(o)}})(powerbi=powerbi||{}),(function(e){var t,o,a;function i(e){return _.isEmpty(e.objectId)||!0===e.isFromContentPack}function r(e){return e&&!e.localAppLogoImageData&&i(e)}function n(e,t,o){if(0===t)return null;var i=o.get(e).toLocaleLowerCase(),e=1===t?o.get("Artifact_Dashboard"):o.get("ContentList_Dashboards");return o.format("SelectionWarningMessage_Included",[i,t,e.toLocaleLowerCase()])}function s(e){return e.publishAsTemplate?7:5}function l(e){return _.map(e.validEmailsList.concat(e.validObjectIds),(function(e){return e.toLowerCase()}))}t=e.helpers||(e.helpers={}),o=t.PublishAppHelper||(t.PublishAppHelper={}),a=e.common.contracts.ContentTileType,o.getTenantId=function(){return window.tenantId},o.getAppContractFromModel=function(e){var t=o.createPublishOrUpdateAppModelRequest(e),t=_.extend(e.organizationalProviderConfig||{},{description:t.description,appSettings:t.appSettings});return _.extend(e.providerContract||{},{id:e.providerId,providerId:e.providerId,providerKey:e.objectId,providerName:e.displayName,displayText:e.displayText,dashboardIds:e.dashboardIds,reportIds:e.reportIds,modelIds:e.modelIds,workbookIds:e.workbookIds,category:s(e),accessPermissions:{isSharedToEntireOrganization:e.isSharedToEntireOrg,listOfGroupsOrPrincipals:l(e.emailsList),adUserMetadataList:e.emailsList.inputUserList},providerConfig:JSON.stringify(t),isDirty:!1})},o.createPublishOrUpdateAppModelRequest=function(e){var t,o,i=(function(e){if(r(e))return e.iconImageData;return e.groupImageData})(e);return e.isSharedToEntireOrg||(t=l(e.emailsList),o=e.emailsList&&e.emailsList.inputUserList),{name:e.displayName,description:e.description,icon:i,parameterIcon:null,accessPermissions:{adUserMetadataList:o,listOfGroupsOrPrincipals:t,isSharedToEntireOrganization:e.isSharedToEntireOrg},dashboardIds:e.dashboardIds,reportIds:e.reportIds,modelIds:e.modelIds,workbookIds:e.workbookIds,contentProviderCategory:s(e),skipUpdateIcon:!i,appSettings:{defaultAppArtifact:0===e.defaultContentOption?null:e.defaultContent,iconName:e.icon,iconColor:e.iconColor,iconBackgroundColor:e.iconBackgroundColor,headerBackgroundColor:e.headerBackgroundColor,allowCopyContent:!!e.allowCopyContent,appPush:!e.isSharedToEntireOrg&&!!e.appPush,exploreDataset:e.canExploreDataset},folderId:e.folderId}},o.isNewApp=i,o.hasNewIconData=r,o.showArtifactSelection=function(e,t){return!e.isMyWorkspace()&&!t.isActiveWorkspaceIsReadOnlyLegacy},o.verifySelectivePublish=function(e,t,o,i){for(var r=[],a=0,n=e;a<n.length;a++){var s=n[a],l=[];l.push.apply(l,_.filter(i.retrieveRelatedReportsToDashboard(s),(function(e){return e.contract.isStaging&&i.canReshare(e)}))),l.push.apply(l,_.filter(i.retrieveRelatedWorkbooksToDashboard(s),(function(e){return e.contract.isStaging&&i.canReshare(e)}))),_.isEmpty(l)||r.push({tile:s,dependents:l})}for(var c=0,d=_.filter(t,(function(e){return e.contract.isStaging&&i.canReshare(e)}));c<d.length;c++){var p=d[c];(g=[]).push.apply(g,_.filter(i.retrieveRelatedDashboardsToReport(p),(function(e){return!e.contract.isStaging&&i.canReshare(e)}))),_.isEmpty(g)||r.push({tile:p,dependents:g})}for(var u=0,h=_.filter(o,(function(e){return e.contract.isStaging&&i.canReshare(e)}));u<h.length;u++){var g,v=h[u];(g=[]).push.apply(g,_.filter(i.retrieveRelatedDashboardsToWorkbook(v),(function(e){return!e.contract.isStaging&&i.canReshare(e)}))),_.isEmpty(g)||r.push({tile:v,dependents:g})}return r},o.createStagingWarningMessage=function(e,t,o){var i=e;if(i.contentTileType===a.Dashboard){var e=i,r=_.find(o.retrieveRelatedReportsToDashboard(e),(function(e){return e&&e.contract.isStaging}));if(null!=(r=null==r?_.find(o.retrieveRelatedWorkbooksToDashboard(e),(function(e){return e&&e.contract.isStaging})):r))return t.get("Dashboard_Links_Warning")}return r=[],i.contentTileType===a.Report?(r.push.apply(r,_.filter(o.retrieveRelatedDashboardsToReport(i),(function(e){return!e.contract.isStaging&&o.canReshare(e)}))),n("Artifact_Report",r.length,t)):i.contentTileType!==a.Workbook?null:(r.push.apply(r,_.filter(o.retrieveRelatedDashboardsToWorkbook(i),(function(e){return!e.contract.isStaging&&o.canReshare(e)}))),n("Artifact_Workbook",r.length,t))}})(powerbi=powerbi||{}),(function(a){var e;((e=a.helpers||(a.helpers={})).VisualQueryUtil||(e.VisualQueryUtil={})).canVisualizeQuery=function(e,t){for(var o=0,i=t;o<i.length;o++){var r=i[o];if(!r.expression&&null==r.type&&!r.restatement)return!1}return e.Version&&e.Version>=a.data.SemanticQueryVersions.Version2}})(powerbi=powerbi||{}),(function(n){var e,s,l;function t(e,t,o){this.promiseFactory=t,this.$state=o}e=n.services||(n.services={}),l=n.constants.navigation.states,t.prototype.navigateToDashboard=function(e,t){throw new Error("Method not implemented.")},t.prototype.navigateToReportHelper=function(e,t,o,i,r,a){throw new Error("Method not implemented.")},t.prototype.navigateToReport=function(e,t,o){this.currentReportGUID=e.reportGUID,this.currentReportPage=e.reportPage,this.currentReportOriginalGUID=e.reportOriginalGUID,this.currentAppGUID=e.appGUID,this.currentAppInstanceId=e.appInstanceId,this.currentGroupGUID=e.groupGUID},t.prototype.navigateToReportAccessRequest=function(e,t,o){return this.currentReportGUID=e,this.currentGroupGUID=t,this.promiseFactory.resolve(!0)},t.prototype.navigateToReportSharedViews=function(e,t,o){return this.promiseFactory.resolve()},t.prototype.navigateToRdlReport=function(e,t,o){this.currentReportGUID=e.rdlReportGUID,this.currentGroupGUID=e.groupGUID},t.prototype.navigateToFallbackState=function(){return __awaiter(this,void 0,n.Promise,(function(){return __generator(this,(function(e){return[2]}))}))},t.prototype.navigateToGroupByGUID=function(e){},t.prototype.navigateToAdminPortalNewWorkspace=function(){},t.prototype.navigateToAdminPortalNewProtectionMetrics=function(){},t.prototype.navigateToReports=function(){},t.prototype.navigateToStreamingDatasets=function(e){},t.prototype.navigateToDashboardByGUID=function(e,t){return this.currentDashboardGUID=e,new n.Promise(function(){return!0})},t.prototype.navigateToDashboardMobileAuthoringByGUID=function(e,t){return this.currentDashboardGUID=e,new n.Promise(function(){return!0})},t.prototype.navigateToAppDashboardByGUID=function(e,t,o,i,r){var a,o={dashboardGUID:e,dashboardOriginalGUID:t,appGUID:o};return(i=void 0===i?null:i)?(a=l.appInstanceDashboard,s.optionalAdd(o,"appInstanceId",i)):a=l.appDashboard,this.stateService.go(a,o),new n.Promise(function(){return!0})},t.prototype.navigateToDashboardAnnotations=function(e,t){return new n.Promise(function(){return!0})},t.prototype.navigateToAppWorkbookByUniqueId=function(e,t,o,i){return this.currentWorkbookURLIdentifier=e,this.currentAppGUID=t,_.isEmpty(o)||(this.currentGroupGUID=o),new n.Promise(function(){return!0})},t.prototype.insertGroupAndNavigateToDashboardByGUID=function(e,t,o){return this.currentDashboardGUID=e,new n.Promise(function(){return!0})},t.prototype.navigateToSharedDashboardByGUID=function(e,t){this.currentDashboardGUID=e},t.prototype.insertGroupAndNavigateToWorkbookByUniqueId=function(e,t,o){},t.prototype.navigateToApps=function(){},t.prototype.navigateToApp=function(e,t,o){return this.currentAppGUID=e,new n.Promise(function(){return!0})},t.prototype.navigateToFavorites=function(){},t.prototype.navigateToContentList=function(e){return new n.Promise(function(){return!0})},t.prototype.navigateToSharedWithMe=function(e){},t.prototype.navigateToReportSubscriptionsPane=function(e,t){},t.prototype.navigateToRdlReportSubscriptionsPane=function(e,t){},t.prototype.navigateToDashboardSubscriptionsPane=function(e,t,o,i,r){return this.promiseFactory.resolve(!0)},t.prototype.updateReportStateNoReload=function(e,t){return this.promiseFactory.resolve(null)},t.prototype.initialLoadReportByGUID=function(e,t,o){},t.prototype.navigateToDataset=function(e,t,o,i){return this.promiseFactory.resolve(!0)},t.prototype.navigateToDatasetDetails=function(e,t,o,i,r){return this.promiseFactory.resolve(!0)},t.prototype.navigateToWorkbookByUrlId=function(e,t,o,i){},t.prototype.toggleArchivedContent=function(e){},t.prototype.navigateToManageGateways=function(e){},t.prototype.navigateToAdminPortal=function(e){},t.prototype.navigateToLicenseCapacities=function(e){},t.prototype.navigateToCapacityTabs=function(e,t){},t.prototype.navigateToAdminPortalCapacity=function(e){},t.prototype.navigateToAdminPortalCreateCapacity=function(){},t.prototype.navigateToCapacityMetricDetail=function(){},t.prototype.navigateToDatapoolView=function(e,t,o){this.currentDatapoolGUID=t,this.selectedQueryId=o,this.currentGroupGUID=e},t.prototype.navigateToStreamingDataflow=function(e,t){},t.prototype.navigateToAppPublish=function(e){},t.prototype.navigateToRoot=function(){return this.promiseFactory.resolve(!0)},t.prototype.navigateToHome=function(){return this.promiseFactory.resolve(!0)},t.prototype.showQnaView=function(e,t){},t.prototype.showInsightsPanel=function(e,t){},t.prototype.showShareSlider=function(e){},t.prototype.showAlertsEditor=function(e,t,o,i,r){return this.promiseFactory.resolve(null)},t.prototype.showInFocusMode=function(e,t,o,i,r){return this.promiseFactory.resolve(null)},t.prototype.showInsightsInFocusMode=function(e,t,o,i){return this.promiseFactory.resolve(null)},t.prototype.showSettingsSlider=function(e,t){},t.prototype.showSettingsSliderByGroup=function(e,t,o,i){},t.prototype.showPublishContentPackSlider=function(e){},t.prototype.showViewContentPackSlider=function(){},t.prototype.showGetDataSlider=function(e){},t.prototype.showAuthorCustomTileSlider=function(){},t.prototype.showRowLevelSecuritySlider=function(e){},t.prototype.showManageStorageSlider=function(e){},t.prototype.reload=function(){},t.prototype.inContentSliderView=function(){return!1},t.prototype.navigateBack=function(e){},t.prototype.navigateForward=function(){},t.prototype.canNavigateBack=function(){return!0},t.prototype.inAppView=function(){return!1},t.prototype.inAppInstanceView=function(){return!1},t.prototype.inAppDetailView=function(){return!1},t.prototype.inAppsDetailView=function(){return!1},t.prototype.inAppsView=function(){return!1},t.prototype.inAppArtifactView=function(){return!1},t.prototype.inCreateCapacityView=function(){return!1},t.prototype.inCapacityMetricDetailView=function(){return!1},t.prototype.inSingleCapacitySettingsView=function(){return!1},t.prototype.inSingleCapacityHealthView=function(){return!1},t.prototype.inDatasetView=function(){return!1},t.prototype.inGroupView=function(){return!1},t.prototype.inDashboardView=function(){return!1},t.prototype.inDashboardSubscriptions=function(){return!1},t.prototype.inDashboardPath=function(){return!1},t.prototype.inGroupWelcomeView=function(){return!1},t.prototype.inRecentlyViewedView=function(){return!1},t.prototype.inSharedWithMePath=function(){return!1},t.prototype.inSharedWithMeView=function(){return!1},t.prototype.inRdlReportView=function(){return!1},t.prototype.inReportView=function(){return!1},t.prototype.inReportSubscriptionView=function(){return!1},t.prototype.inFavoritesView=function(){return!1},t.prototype.inNewContentListView=function(){return!1},t.prototype.inReportDetailView=function(){return!1},t.prototype.inWorkbookView=function(){return!1},t.prototype.inQnaView=function(){return!1},t.prototype.inQnaModelView=function(){return!1},t.prototype.inAccept2017ProTrial=function(){return!1},t.prototype.inInsightsView=function(){return!1},t.prototype.inGetDataView=function(){return!1},t.prototype.inGetDataCategoryView=function(){return!1},t.prototype.inGetDataCategoryProviderView=function(){return!1},t.prototype.inPublishContentPackView=function(){return!1},t.prototype.inSharingView=function(){return!1},t.prototype.inInFocusView=function(){return!1},t.prototype.inInFocusInsightsView=function(){return!1},t.prototype.inRowLevelSecurityView=function(){return!1},t.prototype.inAlertsEditorView=function(){return!1},t.prototype.inCapacitySettingsView=function(){return!1},t.prototype.inManagePermissionsView=function(){return!1},t.prototype.inDatapoolView=function(){return!1},t.prototype.inDataflowAuthoringView=function(){return!1},t.prototype.inWebContentView=function(){return!1},t.prototype.inLineageView=function(){return!1},t.prototype.inSettingsGroup=function(){return!1},Object.defineProperty(t.prototype,"stateService",{get:function(){return this.$state,this.$state},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentDashboardGUID",{get:function(){return this._currentDashboardGUID},set:function(e){this._currentDashboardGUID=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"qnaQuery",{get:function(){return this._qnaQuery},set:function(e){this._qnaQuery=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentReportGUID",{get:function(){return this._currentReportGUID},set:function(e){this._currentReportGUID=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentReportOriginalGUID",{get:function(){return this._currentReportOriginalGUID},set:function(e){this._currentReportOriginalGUID=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentReportPage",{get:function(){return this._currentReportPage},set:function(e){this._currentReportPage=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentWorkbookURLIdentifier",{get:function(){return this._currentWorkbookURLIdentifier},set:function(e){this._currentWorkbookURLIdentifier=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentWorkbookActiveSelection",{get:function(){return this._currentWorkbookActiveSelection},set:function(e){this._currentWorkbookActiveSelection=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"additionalODataFilter",{get:function(){return this._additionalODataFilter},set:function(e){this._additionalODataFilter=e},enumerable:!1,configurable:!0}),t.prototype.navigateToGatewayItem=function(e,t){},t.prototype.navigateToDatasetSettings=function(e,t){},e.MockNavigation=t,(s=e.NavigationHelper||(e.NavigationHelper={})).optionalAdd=function(e,t,o){angular.isDefined(o)&&(e[t]=o)}})(powerbi=powerbi||{}),(function(s){!(function(e){var c,t,r=s.dataServices.constants;(t=c=e.DeleteContentPackMessageType||(e.DeleteContentPackMessageType={}))[t.Dashboard=1]="Dashboard",t[t.Report=2]="Report",t[t.Dataset=3]="Dataset",e.createNavigationActions=function(e,t,o,i,r,a,n,s,l,c,d,p,u,h,g){return new v(e,t,o,i,r,a,n,s,l,c,d,p,u,h,g)};var v=(o.prototype.initialize=function(){var n=this;this.$rootScope.$on(s.constants.openReportEventName,(function(e,t,o){e.stopPropagation(),e.preventDefault();t=n.reportService.findReport(t);n.openReport(t,o)})),this.$rootScope.$on(s.constants.deleteModelEventName,(function(e,t,o,i){e.stopPropagation(),e.preventDefault(),n.deleteModel(t,o,i)})),this.$rootScope.$on(s.constants.renameModelEventName,(function(e,t,o,i){e.stopPropagation(),e.preventDefault(),n.modelService.renameModel(t,o,i)})),this.$rootScope.$on(s.constants.replaceLocalWorkbookEventName,(function(e,t){e.stopPropagation(),e.preventDefault(),n.quota.checkQuotaExceeded("GetData")||n.workbookService.replaceLocalWorkbook(t)})),this.$rootScope.$on(r.workbook.viewWorkbookEventName,(function(e,t,o,i){e.stopPropagation(),e.preventDefault();o=n.workbookService.findWorkbook(t,o);n.viewWorkbook(o,i)})),this.$rootScope.$on(s.dataServices.constants.workbook.removeWorkbookEventName,(function(i,r,a){return __awaiter(n,void 0,s.Promise,(function(){var t,o;return __generator(this,(function(e){switch(e.label){case 0:return i.stopPropagation(),i.preventDefault(),t=this.workbookService.findWorkbook(r.id,r.packageId),(o=t)?[4,this.contentPackStore.isWorkbookUsedByContentPack(r.id)]:[3,2];case 1:o=e.sent(),e.label=2;case 2:return o?this.contentPackService.showDialogOnWorkbookRemoveInContentPack(r.id):this.removeWorkbook(t,a),[2]}}))}))}))},o.prototype.deleteModel=function(t,o,i){return __awaiter(this,void 0,s.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.contentPackStore.isDatasetUsedByContentPack(t)];case 1:return e.sent()?this.contentPackService.showDialogOnModelDeleteInContentPack(t):this.removeModel(t,o,i),[2]}}))}))},o.prototype.openReport=function(e,t){e.isNew=!1,null==e.packagePublishStatus||0===e.packagePublishStatus||3===e.packagePublishStatus||4===e.packagePublishStatus?this.navigation.navigateToReportHelper(e.contract,void 0,void 0,void 0,void 0,t):2===e.packagePublishStatus&&this.deleteReportOnPublishFailure(e.objectId)},o.prototype.openModel=function(t){return __awaiter(this,void 0,s.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.lazyProviderModern.get("@powerbi/DatasetActions/dataset-actions.module#DatasetActionsModule","DatasetActionsService")];case 1:return[4,e.sent().getAction(1)];case 2:return[4,e.sent().execute({artifact:t.contract})];case 3:return e.sent(),[2]}}))}))},o.prototype.openModelContract=function(o,i){return __awaiter(this,void 0,s.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return[4,this.lazyProviderModern.get("@powerbi/DatasetActions/dataset-actions.module#DatasetActionsModule","DatasetActionsService")];case 1:return[4,e.sent().getAction(1)];case 2:return(t=e.sent())?(t.execute({artifact:o,actionSource:i}),[2]):[2]}}))}))},o.prototype.viewWorkbook=function(e,t){var o,i;e.isNew=!1,this.featureSwitchService.featureSwitches.embedFullFidelityWorkbooks?(o=this.workbookService.getWorkbookUniqueId(e),i=this.ownershipService.isResourceSharedWithMe(e),this.navigation.navigateToWorkbookByUrlId(o,null,i,t)):this.$rootScope.$emit(r.workbook.openWorkbookContextMenuEventName,e)},o.prototype.deleteItemOnPublishFailure=function(e,t,o){var i=this.localizationService.get("Delete");this.modernDialogService.promptSimpleConfirmationDialog(e,t,i,(function(){o()}))},o.prototype.removeModel=function(n,s,e){var t,o,l=this,i=this.modelService.findModel(n,s),r=this.localizationService.get("Delete");switch(e){case c.Dashboard:t=this.localizationService.get("Dashboard_DeleteConfirmationTitle"),o=this.localizationService.get("Dashboard_DeleteOrgAppContentPack");break;case c.Report:t=this.localizationService.get("Report_DeleteConfirmationTitle"),o=this.localizationService.get("Report_DeleteOrgAppContentPack");break;case c.Dataset:t=this.localizationService.get("Model_DeleteConfirmationTitle"),o=this.localizationService.get("Model_DeleteOrgAppContentPack");break;default:t=this.localizationService.get("Model_DeleteConfirmationTitle"),o=this.localizationService.format("Model_DeleteConfirmationMessage",[i.displayName])}this.modernDialogService.promptSimpleConfirmationDialog(t,o,r,(function(){var e=!!l.reportService.findReportByGUID(l.navigation.currentReportGUID),t=l.modelService.findModel(n,s),o=t?t.dbName:null,i=l.navigation;l.modelService.deleteModel(n,s);var r=l.downgradedRouterUtilities.getCurrentActivatedRouteSnapshotLeaf(),a=r.paramMap.get("dataGUID"),r=parseInt(r.paramMap.get("modelId"),10);(l.reportService.currentActiveReport&&l.reportService.currentActiveReport.id===n||e&&!l.reportService.findReport(l.reportService.currentActiveReport.id)||i.inInsightsView()&&a===o||i.inRowLevelSecurityView()&&r===t.id)&&i.navigateToContentList()}))},o.prototype.deleteReportOnPublishFailure=function(e){var t=this;this.deleteItemOnPublishFailure(this.localizationService.get("NavigationPane_ReportPublishErrorTitle"),this.localizationService.get("NavigationPane_ReportPublishErrorContent"),(function(){t.reportService.deleteReport(e)}))},o.prototype.removeWorkbook=function(t,e){var o=this,i=e===c.Dashboard?a="Dashboard_DeleteConfirmationTitle":(a="Workbook_RemoveConfirmationTitle",t.isOwner()?this.packageService.isLocalWorkbook(t.packageId)?"Workbook_RemoveOwnedLocalConfirmationMessage":"Workbook_RemoveOwnedRemoteConfirmationMessage":t.isPersonalized()?"Workbook_RemovePersonalizedConfirmationMessage":"Workbook_RemoveInOrgPackConfirmationMessage"),r=this.modernDialogService,e=this.localizationService.get(a),a=this.localizationService.get(i),i=this.localizationService.get("ModalDialogButtonText_Remove");r.promptSimpleConfirmationDialog(e,a,i,(function(){o.workbookService.removeWorkbook(t.id,t.packageId,o.packageService.getWorkbookStorageProvider(t.packageId),o.packageService.getWorkbookContentProvider(t.packageId));var e=o.workbookService.currentActiveWorkbook;e&&e.id===t.id&&e.packageId===t.packageId&&o.navigation.navigateToContentList()}))},o);function o(e,t,o,i,r,a,n,s,l,c,d,p,u,h,g){this.$rootScope=e,this.contentPackService=t,this.featureSwitchService=o,this.localizationService=i,this.modelService=r,this.navigation=a,this.packageService=n,this.quota=s,this.reportService=l,this.workbookService=c,this.ownershipService=d,this.modernDialogService=p,this.lazyProviderModern=u,this.contentPackStore=h,this.downgradedRouterUtilities=g}})(s.services||(s.services={}))})(powerbi=powerbi||{}),(function(z){var t=z.common.helpers,G=z.dataServices.constants,l=z.dataServices.DashboardUtils,d=z.errorDetailsHelper,p=z.dataServices.models.getDashboardGuidFromUrl,o=z.contracts.ResourcePackageItemType,h=z.common.models.Report,c=z.visualHost.utils.ResourcePackageUtils,u=z.common.constants.tileActions,n=z.dataServices.TileUtils,g=z.common.contracts.ArtifactType,i=window,r=window,e=(s.prototype.dashboardContainerLoadedPromise=function(){return this.dashboardContainerLoadedDeferred.promise},Object.defineProperty(s.prototype,"dashboardThemeService",{get:function(){return this._dashboardThemeService||(this._dashboardThemeService=this.$injector.get("dashboardThemeService")),this._dashboardThemeService},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"tileSelectionService",{get:function(){return this._tileSelectionService||(this._tileSelectionService=this.$injector.get("tileSelectionService")),this._tileSelectionService},enumerable:!1,configurable:!0}),s.prototype.renameDashboard=function(e,t){var o=this.dashboardDataService.findDashboard(t),t=this.telemetryService.startEvent(z.telemetry.DashboardRenameDashboard,{tileCount:angular.isUndefined(o.tiles)||!o.tiles?0:o.tiles.length,dashboardGuid:o.objectId});this.dashboardStore.rename(o.contract,e,t)},s.prototype.addDashboard=function(t){return __awaiter(this,void 0,z.Promise,(function(){return __generator(this,(function(e){return[2,this.addDashboardInternal(t)]}))}))},s.prototype.addDashboardInternal=function(r,a,n){var s;return __awaiter(this,void 0,z.Promise,(function(){var t,o,i;return __generator(this,(function(e){switch(e.label){case 0:return this.storageUsageService.checkQuotaExceeded("AddDashboard")?[2]:_.isEmpty(r.trim())?[3,4]:(t=null===(s=null==a?void 0:a.tile)||void 0===s?void 0:s.modelId,o=null===(s=null==a?void 0:a.tile)||void 0===s?void 0:s.reportId,[4,this.informationProtectionArtifactService.ensureMandatoryLabelOnNewDashboard(o,t)]);case 1:return(i=e.sent()).canContinue?[4,this.dashboardStore.create(r,!!a,t,o,i.selectedLabelId,this.telemetryService.startEvent(z.telemetry.DashboardAddDashboard))]:[2];case 2:return(i=e.sent())&&a&&!this.storageUsageService.checkQuotaExceeded("AddTile")?(i=this.dashboardDataService.findDashboard(i.id))?[4,this.addTileToDashboard(a.tile,a.showNotification,n,i)]:[2]:[3,4];case 3:e.sent(),e.label=4;case 4:return[2]}}))}))},s.prototype.addOrUpdateDashboard=function(e){this.modelConverter.fillDashboardContainerDashboard(e),this.registerAndLoadResourcePackages(e)},s.prototype.preloadLinkedDashboards=function(e){var t=this,o=this.promiseFactory.defer(),i=this.dashboardDataService;if(!this.featureSwitchService.featureSwitches.preloadLinkedDashboardEnabled)return o.reject(),o.promise;e=i.findDashboard(e);if(!e||!e.isLoaded||_.isEmpty(e.tiles))return o.reject(),o.promise;for(var r=_.keyBy(i.dashboards,(function(e){return e.objectId.toLowerCase()})),a=[],n=0,s=e.tiles;n<s.length;n++){var l=s[n],l=l&&l.action;if(l&&l.action===u.custom.openUrlActionName){l=p(l.targetUrl);if(l){l=r[l.toLowerCase()];if(l&&!l.isLoaded&&(a.push(l.id),10<=a.length))break}}}if(0===a.length)return o.resolve(null),o.promise;var a=_.uniq(a),c=this.telemetryService.startEvent(z.telemetry.DashboardPreloadLinkedDashboard,{dashboardCount:a.length,dashboardGuid:e.objectId});return this.dashboardHttpService.batchGetDashboards(this.promiseFactory,a,c.event).then((function(e){t.updateDashboardContainer(e.data),o.resolve(null),c.resolve()}),(function(e){o.reject(),c.reject(d.getTelemetryErrorDetails(e?e.error:null,e?e.status:null))})),o.promise},s.prototype.addOrUpdateTile=function(e,t,o){this.dashboardSyncService.addOrUpdateTile(e,t,o)},s.prototype.batchUpdateTileSizePosition=function(e,t){var o=this,i=this.telemetryService.startEvent(z.telemetry.DashboardTileLayoutChanged,{tilesChanged:t.length}),t=this.dashboardHttpService.batchUpdateTileSizePosition(this.promiseFactory,e.contract,t,i.event);return t&&t.then((function(){i.resolve(),e&&e.isUsedByContentPack&&o.rootScope.$emit(z.constants.contentPackDirtyShowNotification,e.id,z.dataServices.models.ContentPackItems.Dashboard)}),(function(){i.reject()})),t},s.prototype.promptForDeleteDashboard=function(e,t){var o=this,i=this.dashboardDataService.findDashboard(e),r=t?this.localizationService.get("Dashboard_DeleteConfirmationTitle"):this.localizationService.get("Dashboard_RemoveConfirmationTitle"),a=this.localizationService.format(t?"Dashboard_DeleteConfirmationMessage":"Artifact_RemoveConfirmationMessage",[i.displayName]),i=t?this.localizationService.get("Delete"):this.localizationService.get("ModalDialogButtonText_Remove");this.modernDialogService.promptSimpleConfirmationDialog(r,a,i,(function(){o.deleteDashboardInternal(e,t)}))},s.prototype.exportDashboard=function(e,t){var o,i,r=this,e=this.dashboardDataService.findDashboard(e);e?(e=e.contract,o=this.telemetryService.startEvent(z.telemetry.DashboardExportDashboard,{dashboardGuid:e.objectId}),l.isWriteable(e)?(t=this.dashboardHttpService.exportDashboard(e,t,o.event))&&(i=this.notificationToast.notify({title:this.localizationService.get("NotificationMessage_ExportingPackage"),notificationType:3}),t.then((function(e){o.resolve(),r.notificationToast.hide(i),r.fileSaver.saveAs(e.data,"dashboardpackage.zip")}),(function(e){401!==e.status&&r.errorService.error(r.localizationService.get("Dashboard_FailToExportDashboardMessage"),"Dashboard_FailToExportDashboard",{requestId:e.requestId,statusCode:e.status.toString()}),o.reject()}))):this.notificationToast.notify({title:this.localizationService.get("Warning_Title"),message:this.localizationService.get("DashboardReadOnlyExportWarning_Message"),notificationType:1})):this.errorService.error(this.localizationService.get("Dashboard_FailToExportDashboardMessage"),"Dashboard_FailToExportDashboard")},s.prototype.navigateAfterDashboardDelete=function(e){var t,o,i=this,r=this.dashboardDataService.activeDashboard;r&&e===r.id&&this.navigation.inDashboardView()&&(t=this.navigation,o=t.inAppsView(),this.rootScope.$applyAsync((function(){i.dashboardDataService.activeDashboard=null,o?t.navigateToApps():i.navigation.navigateToFallbackState()})))},s.prototype.deleteDashboardInternal=function(e,t){var o=this.dashboardDataService.findDashboard(e),i=this.telemetryService.startEvent(z.telemetry.DashboardDeleteDashboard,{dashboardGuid:o.objectId,tileCount:angular.isUndefined(o.tiles)||!o.tiles?0:o.tiles.length});this.beforeDashboardDeletingHandler(e),this.dashboardDataService.findDashboard(e)?(this.dashboardStore.delete(o.contract,!1,i),this.syncService.stopMonitoringDashboard(e),this.tryResetHome(e,t),this.navigateAfterDashboardDelete(e),this.dashboardDataService.onDeleted(o)):i.resolve()},s.prototype.tryResetHome=function(t,o){var i=this.featuredDashboard;i.getHomeDashboard(null).then((function(e){e.data&&!s.deletedHomeDashboard(e.data,t,o)?i.homeDashboard={dashboardId:e.data.dashboardId,groupId:e.data.groupId||z.constants.myWorkSpaceFolderId,dashboardObjectId:e.data.dashboardObjectId}:i.resetHomeAtClientSide()}),(function(e){}))},s.deletedHomeDashboard=function(e,t,o){if(e.dashboardId!==t)return!1;e=!o&&!e.groupId;return o||e},s.prototype.duplicateDashboard=function(i,e){var r=this,a=this.promiseFactory.defer(),n=this.telemetryService.startEvent(z.telemetry.DashboardDuplicateDashboard),s=i&&i.objectId;if(l.isWriteable(i))return this.dashboardHttpService.duplicateDashboard(i,e,n.event).then((function(t){var o=t.data;r.dashboardHttpService.addDashboardRequestToBatch(r.promiseFactory,t.data.id,!1,0).done((function(e){r.dashboardSyncService.addOrUpdateDashboard(e),r.prepareCustomVisualsForLoading(r.dashboardDataService.activeDashboard),!s||(e=r.dashboardThemeService.getDashboardTheme(s))&&r.dashboardThemeService.setDashboardTheme(o.objectId,e.name,e),r.navigation.navigateToDashboardByGUID(o.objectId),r.informationProtectionService.isInformationProtectionFeatureEnabled()&&r.getInformationProtectionLabelIfExist(i.id,o.objectId),n.resolve(),a.resolve(t.data)}),(function(){n.reject(),a.reject()}))}),(function(){n.reject(),a.reject()})),a.promise;l.notifyReadOnly(i,this.notificationToast,this.localizationService)},s.prototype.loadDashboard=function(e,t){var i=this;if(this.dashboardLoadingPromises[e])return this.dashboardLoadingPromises[e];var r=this.promiseFactory.defer();this.dashboardLoadingPromises[e]=r.promise;for(var a=[],o=0,n=0,o=0;o<3;o++)a.push(this.timeout((function(){i.loadDashboardInternal(e,t).then((function(e){r.resolve(e);for(var t=a.length,o=0;o<t;o++)o!==n&&i.timeout.cancel(a[o])}),(function(e){2<=n++&&(r.reject(e),i.rootScope.$emit(z.constants.loadDashboardFailed))}))}),o*s.loadDashboardTimeout));return r.promise.finally((function(){return i.dashboardLoadingPromises[e]=void 0})),r.promise},s.prototype.loadDashboardInternal=function(i,e){var r=this,a=this.promiseFactory.defer(),n=this.telemetryService.startEvent(z.telemetry.DashboardLoadDashboard,{});return this.userActivityContextService.pushParentContext(n.event),this.dashboardHttpService.getDashboards(this.promiseFactory,[i],e,null).then((function(e){var t,o;0<e.length&&e[0].data?(t=e[0],o=t.data,r.registerAndLoadResourcePackages(o).finally((function(){r.updateDashboardContainer([o]);var e=r.dashboardDataService.findDashboard(i);a.resolve(e),e&&(n.event.info.dashboardGuid=e.objectId),n.event.info.pendingRequestCount=t.pendingRequestCount,n.resolve(),r.userActivityContextService.popParentContext(n.event)}))):(_.isEmpty(e)?(a.reject(),n.reject()):(e=e[0],a.reject(e),n.event.info.pendingRequestCount=e.pendingRequestCount,n.reject(d.getTelemetryErrorDetails(e.error))),r.userActivityContextService.popParentContext(n.event))})).catch((function(e){angular.isArray(e)&&(e=e[0]),a.reject(e),n.reject({errorCode:e.errorCode||e.status}),r.userActivityContextService.popParentContext(n.event)})),a.promise},s.prototype.setActiveDashboardId=function(t,o,e){var i=this;void 0===o&&(o=!1),void 0===e&&(e=null);var r,a=this.dashboardDataService.findDashboard(t);a&&(r=this.telemetryService.startEvent(z.telemetry.DashboardUpdateActiveDashboard,{dashboardGuid:a.objectId}),this.dashboardHttpService.setActiveDashboardId(t,e,r.event).then((function(e){o?i.dashboardHttpService.refreshTileData(t,i.modelIdsForTileRefresh,r.event).then((function(e){i.checkRefreshTileResponse(e.data),r.resolve()}),(function(e){r.reject()})):r.resolve(),i.preloadLinkedDashboardPromise&&i.timeout.cancel(i.preloadLinkedDashboardPromise),i.preloadLinkedDashboardPromise=i.timeout((function(){i.preloadLinkedDashboards(t)}),2e3)}),(function(e){r.reject()})))},s.prototype.refreshTileData=function(o,e){var i=this;0<o&&(this.updateModelIdsForTileRefresh(e),_.isEmpty(this.modelIdsForTileRefresh)||(this.refreshTileDataPromise&&(this.timeout.cancel(this.refreshTileDataPromise),this.refreshTileDataPromise=null),this.refreshTileDataPromise=this.timeout((function(){var e=i.dashboardDataService.findDashboard(o),t=i.telemetryService.startEvent(z.telemetry.DashboardRefreshTileData,{dashboardGuid:e.objectId});i.dashboardHttpService.refreshTileData(o,i.modelIdsForTileRefresh,t.event).then((function(e){i.checkRefreshTileResponse(e.data),i.dashboardDataService.onDashboardTileRefreshStarted(o),t.resolve()}),(function(e){t.reject(d.getTelemetryErrorDetails(e.error))})),i.modelIdsForTileRefresh=[]}),s.refreshTileDataDelayMs)))},s.prototype.allowQueryRefreshForModel=function(e){e=_.head(this.modelService.findModels(e));return!(!e||e.isRefreshDisabledDueToInactivity())},s.prototype.setAndUpdateActiveDashboard=function(e,t){(this.dashboardDataService.activeDashboard=e)&&(e.isLoaded||this.loadDashboard(e.id,t),t=e.id,this.setActiveDashboardId(t)),e.isHidden=!1,e.contract.isHidden=!1},s.prototype.getVisualCountData=function(){var e={totalVisualsCount:0,scriptVisualsCount:0,reportTilesWithR:0,reportTilesWithPython:0},t=this.dashboardDataService.activeDashboard,o=this.visualPluginService,t=t&&t.tiles;if(t){for(var i=0,r=t;i<r.length;i++){var a=r[i];n.isScriptVisualTile(a,o)?e.scriptVisualsCount++:(a=n.countTileScriptVisuals(a,o)).hasScriptVisuals&&(e.reportTilesWithR+=a.rScriptCount,e.reportTilesWithPython+=a.pythonScriptCount)}e.totalVisualsCount=t.length}return e},s.prototype.checkRefreshTileResponse=function(e){if(e&&!_.isEmpty(e.tileErrors))for(var t=0,o=e.tileErrors;t<o.length;t++){var i=o[t];i.errorResponse.error.code===z.common.constants.cloudRLSAccessDeniedErrorCode&&this.rootScope.$emit(z.constants.rowLevelSecurityAccessDeniedEventName,i.modelIds)}},s.prototype.registerAndLoadResourcePackages=function(t){var e=this.promiseFactory.defer();if(!t)return e.resolve(null),e.promise;var o=t.resourcePackages;if(o&&0<o.length){for(var i=[],r=!1,a=0,n=o;a<n.length;a++){var s,l=n[a];this.isDashboardThemeResourcePackage(l)?t.activeDashboardId&&(s=t.dashboards,s=(s=_.find(s,(function(e){return e.id===t.activeDashboardId})))&&s.objectId,i.push(this.dashboardThemeService.loadTheme(s,l))):this.resourcePackagesService.getPackageById(l.id)||(s=c.isCustomVisualResourcePackage(l),this.resourcePackagesService.registerPackages([l]),s&&i.push(this.visualPluginService.ensurePlugin(l,!(r=!0))))}return this.telemetryService.logEvent(z.telemetry.DashboardRegisterAndLoadResourcePackages,{resourcePackageLength:o?o.length:0,compositeTileHasCustomVisual:r}),this.promiseFactory.allSettled(i)}return e.resolve(null),e.promise},s.prototype.loadDashboardContainer=function(t){var o=this,i=this.promiseFactory.defer(),e=[this.appMetadataService.getAppMetadata(),this.shellCapabilities.ensureCapabilitiesInitialized()];return this.promiseFactory.allSettled(e).then((function(e){e=e[0];0===e.type?(e=e.value,o.initializeDashboardContainer(e),o.registerAndLoadResourcePackages(e).finally((function(){return i.resolve()}))):o.dashboardHttpService.getDashboardContainer(t).then((function(t){t.data.models&&(o.modelService.mergeDatasetCollection(t.data.models),o.dashboardDataService.updateActiveDashboardModels()),t.data.featureSwitches&&o.editableFeatureSwitchService.registerFeatureSwitches(t.data.featureSwitches),o.userSettingsService.getUserSettings().then((function(e){t.data.userSettings=e.contract})),o.initializeDashboardContainer(t.data),o.registerAndLoadResourcePackages(t.data).finally((function(){return i.resolve()}))}),(function(e){i.reject()}))})),i.promise},s.prototype.isDashboardThemeResourcePackage=function(e){return e&&1===e.type&&e.items&&1===e.items.length&&(e.items[0].type===o.DashboardTheme||e.items[0].type===o.DashboardBaseTheme)},s.prototype.initializeContainer=function(){return __awaiter(this,void 0,z.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:t=this.telemetryService.startEvent(z.telemetry.DashboardInitializeContainer,{errorReason:"",userSwitchedGroups:!1,userIsBrowsingArchivedContent:this.viralTenantMergeHelperService.viewingDataFromMergedViralTenant()}),r.initializeContainerStartTime&&(t.event.time=r.initializeContainerStartTime.getTime()),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.loadDashboardContainer(t.event)];case 2:return e.sent(),this.rootScope.$emit(z.constants.dashboardContainerLoaded),this.dashboardContainerLoadedDeferred.resolve(void 0),t.resolve(),[3,4];case 3:return e.sent(),t.reject(),[3,4];case 4:return[2]}}))}))},s.prototype.markDashboardAsLoaded=function(e){if(e)return e.isLoaded=!0,this.permissionRefresh.refreshDashboardTilePermissionsUponLoad(e)},s.prototype.updateModelIdsForTileRefresh=function(t){t&&!_.some(this.modelIdsForTileRefresh,(function(e){return e===t}))&&this.allowQueryRefreshForModel(t)&&!_.some(this.modelIdsForTileRefresh,(function(e){return e===t}))&&this.modelIdsForTileRefresh.push(t)},s.prototype.initializeDashboardContainer=function(e){i.initialDashboardContainer||(i.initialDashboardContainer=e),e.downloadCenterLinkEnabled?(z.models.PowerBICompanionModel.enabled=!0,z.models.PowerBICompanionModel.downloadLink=t.powerBICompanionHelper.getDownloadCenterLink(e.downloadCenterX64Link,e.downloadCenterX86Link),this.rootScope.$emit(z.constants.enablePowerBICompanionApp)):e.companionAppEnabled&&(z.models.PowerBICompanionModel.enabled=!0,z.models.PowerBICompanionModel.downloadLink=t.powerBICompanionHelper.getDownloadLink(),this.rootScope.$emit(z.constants.enablePowerBICompanionApp)),jsCommon.Utility.is64BitOperatingSystem()&&(z.models.PowerBIConnectorModel.downloadLink=e.downloadCenterX64ConnectorLink),this.modelConverter.updateBasicDashboardContainer(e)},s.prototype.updateDashboard=function(){var e=this.dashboardDataService.findDashboardByGUID(this.navigation.currentDashboardGUID);e&&!e.isFilled()&&(this.modelConverter.fillDashboardChildren(e,this.reportService.getReportContracts(),this.workbookService.workbooks),e.calculateLayout(),e.applyLayout())},s.prototype.updateDashboardContainer=function(c){if(c){for(var d=this.modelConverter,p=this.modelMerger,e=this.dashboardDataService,u=this,t=0,o=c.length;t<o;t++)!(function(e){var t=c[e],o=t.dashboards[0],i=u.dashboardDataService.findDashboard(o.id);if(i?(u.dashboardStore.update(i.contract,o),i.contract=o,p.mergeDashboard(i,o,t.models,t.reports,t.workbooks)):(i=d.convertDashboard(o,t.models,t.reports,t.workbooks),u.dashboardStore.addOrUpdate(o)),i.contract.tiles){var r=c[e].packages||[];i.contract.tiles.map((function(e){d.resolveTilePackage(e,r)}));for(var a=0,n=i.tiles;a<n.length;a++){var s=n[a];s.invalidateLayout();var l=c[e].reports||[],l=d.getTileReport(s.contract.reportId,l);l&&(s.report=s.report||new h(l),d.fillReport(s.report,l))}}u.markDashboardAsLoaded(i)})(t);this.updateDashboard(),e.updateActiveDashboardModels()}},s.prototype.notifyForAddTile=function(r){return __awaiter(this,void 0,z.Promise,(function(){var t,o,i;return __generator(this,(function(e){switch(e.label){case 0:return(t=void 0===r?this.dashboardDataService.activeDashboard:this.dashboardDataService.findDashboard(r),o=t.contract,17===t.getPermissions())?(this.globalEventBridge.publishToChannel(z.services.events.personalizeArtifact,t.contract.originalPackageId),[2]):l.isWriteable(o)?[3,1]:(l.notifyReadOnly(o,this.notificationToast,this.localizationService,!0),[3,3]);case 1:return this.storageUsageService.checkQuotaExceeded("AddTile",!0)?[3,3]:(i=l.containsLayout(0,1,t),[4,this.lazyProviderModern.get("@powerbi/MobileDashboardAuthoring/module#MobileDashboardAuthoringModule","mobileAuthoringDialogService")]);case 2:return[2,e.sent().prepareAndShowMobileIndicationMessage(!0,i,t.objectId)];case 3:return[2]}}))}))},s.prototype.pinTileToExistingDashboard=function(o){return __awaiter(this,void 0,z.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return this.featureSwitchService.featureSwitches.useNewDashboard?[3,2]:[4,this.addTileToDashboardWithLabelPolicyCheck(o.tile,o.showNotification,o.parentEvent,o.dashboardId)];case 1:return e.sent(),[3,3];case 2:t=this.dashboardDataService.findDashboard(o.dashboardId),this.dashboardStore.pinTile(t.contract.objectId,o.tile,o.parentEvent),e.label=3;case 3:return[2]}}))}))},s.prototype.pinTileToNewDashboard=function(t){return __awaiter(this,void 0,z.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return this.featureSwitchService.featureSwitches.useNewDashboard?[3,2]:[4,this.addDashboardInternal(t.newDashboardName,t,t.parentEvent)];case 1:return e.sent(),[3,3];case 2:this.dashboardStore.pinTileToNew(t.newDashboardName,t.tile,t.parentEvent),e.label=3;case 3:return[2]}}))}))},s.prototype.addTileToDashboardWithLabelPolicyCheck=function(o,i,r,a,n){var s;return void 0===a&&(a=null),void 0===n&&(n=!1),__awaiter(this,void 0,z.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return this.storageUsageService.checkQuotaExceeded("AddTile")?[2]:(t=a?this.dashboardDataService.findDashboard(a):this.dashboardDataService.activeDashboard)?[4,this.informationProtectionArtifactService.ensureMandatoryLabelPolicyOnArtifact(t.id,t.displayName,null===(s=this.folderService.activeFolder)||void 0===s?void 0:s.displayName,g.Dashboard,"AddTile",t.objectId,"EimInformationProtection_SelectSensitivityLabelDialog_Message_Dashboard_PinTile")]:[2];case 1:return e.sent()?[4,this.addTileToDashboard(o,i,r,t,n)]:[2];case 2:return e.sent(),[2]}}))}))},s.prototype.addTileToDashboard=function(i,r,a,n,s){return void 0===s&&(s=!1),__awaiter(this,void 0,z.Promise,(function(){var t,o;return __generator(this,(function(e){switch(e.label){case 0:return t=this.modelService.findModels(i.modelId,i.packageId),t=this.modelConverter.convertTile(i,t,this.reportService.getReportContracts(),this.workbookService.getWorkbookContracts()),r?[4,this.notifyForAddTile(n.id)]:[3,2];case 1:o=e.sent(),e.label=2;case 2:return this.addTileModelToDashboardModel(t,n),s?(this.tileSelectionService.selectById(t.id),this.rootScope.$emit(z.constants.temporaryTilePinned)):this.saveTile(t,n,a,o),[2]}}))}))},s.prototype.addTemporaryTile=function(e){return this.addTileToDashboardWithLabelPolicyCheck(e,!1,null,null,!0)},s.prototype.bumpTempId=function(e){e.id=this.temporaryTileId--,e.objectId=e.id.toString()},s.prototype.addTileModelToDashboardModel=function(e,t){var o=t.contract;o.tiles||(o.tiles=[]);var i,r=t.tiles;this.bumpTempId(e.contract),o.tiles.push(e.contract),e.report&&e.report.id&&o.reportIds&&-1===o.reportIds.indexOf(e.report.id)&&o.reportIds.push(e.report.id),e.contract&&e.contract.workbookId&&o.workbookIds&&(i=e.contract.workbookId,-1===o.workbookIds.indexOf(i)&&o.workbookIds.push(i)),e.contract.dashboardId=t.id,r.push(e),t.calculateLayout(),t.applyLayout()},s.prototype.saveTemporaryTile=function(e,t){this.saveTile(e,this.dashboardDataService.activeDashboard,t)},s.prototype.saveTile=function(i,r,a,n){var s=this;this.dashboardHttpService.addTile(r.contract,i.contract,a.event).then((function(o){return __awaiter(s,void 0,z.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return(i.id=i.contract.id=o.data.id,i.contract.objectId=o.data.objectId,i&&i.contractsModel&&o&&o.data&&o.data.model&&(i.contractsModel.vsName=i.contractsModel.vsName||o.data.model.vsName,i.contractsModel.dbName=i.contractsModel.dbName||o.data.model.dbName),i.contract.workbookId&&this.dashboardSyncService.onTilesAddedOrUpdated(r.contract.id,[i.id]),i.invalidateLayout(),!!i.contract.modelId&&!_.some(r.tiles,(function(e){return e.contract.modelId===i.contract.modelId&&e!==i}))&&this.updateDashboardToken(r),r)?(r.isUsedByContentPack&&this.rootScope.$emit(z.constants.contentPackDirtyShowNotification,r.id,z.dataServices.models.ContentPackItems.Dashboard),n?[3,2]:(t=l.containsLayout(0,1,r),[4,this.lazyProviderModern.get("@powerbi/MobileDashboardAuthoring/module#MobileDashboardAuthoringModule","mobileAuthoringDialogService")])):[3,2];case 1:e.sent().prepareAndShowMobileIndicationMessage(!1,t,r.objectId),e.label=2;case 2:return a.resolve(),[2]}}))}))}),(function(e){var t,o=413===e.status?(t=s.localizationService.get("PinTile_Error_TooLarge"),s.localizationService.get("PinTile_Error_TooLargeDetails")):(t=s.localizationService.get("PinTile_Error"),s.localizationService.get("PinTile_Error_DefaultDetails"));n&&s.notificationToast.hide(n),s.notificationToast.notify({title:t,message:o,notificationType:2}),s.removeTileFromDashboard(i,r),a.reject(d.getTelemetryErrorDetails(e.error))}))},s.prototype.updateDashboardToken=function(t){var o=this,i=this.promiseFactory.defer();return this.dashboardHttpService.getDashboards(this.promiseFactory,[t.id],!1,void 0).then((function(e){e=e[0].data;e&&(o.modelMerger.mergeDashboardShallow(t,e.dashboards[0]),o.dashboardDataService.updateActiveDashboardModels(),i.resolve(null))}),(function(){return i.reject()})),i.promise},s.prototype.removeTemporaryTile=function(e){this.removeTileFromDashboard(e,this.dashboardDataService.activeDashboard)},s.prototype.prepareCustomVisualsForLoading=function(e){var t=this;this.resourcePackageListenerService.getAndLoadVisualPluginsForDashboard(e).then((function(e){_.isEmpty(e)||t.globalEventBridge.publishToChannel(z.events.reloadEmptyVisuals,{visualTypes:e})}))},s.prototype.removeTileFromDashboard=function(e,t){var o=t.contract.tiles,i=_.findIndex(o,{id:e.id});-1!==i&&o.splice(i,1);t=t.tiles,e=t.indexOf(e);-1!==e&&t.splice(e,1)},s.prototype.beforeDashboardDeletingHandler=function(e){this.navigateAfterDashboardDelete(e)},s.prototype.subscribe=function(e){this.dashboardDataService.subscribe(e)},s.prototype.getInformationProtectionLabelIfExist=function(o,i){return __awaiter(this,void 0,z.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return[4,this.informationProtectionService.isArtifactLabeled(g.Dashboard,o).toPromise()];case 1:return e.sent()&&(t={artifactId:i},this.informationProtectionService.fetchInformationProtectionLabelsForArtifacts([t],g.Dashboard)),[2]}}))}))},s.refreshTileDataDelayMs=500,s.loadDashboardTimeout=3e4,s);function s(e,t,o,i,r,a,n,s,l,c,d,p,u,h,g,v,m,b,f,y,S,w,D,T,C,k,P,E,I,M,A,R,N,_,F,x,L,B,O){var V=this;this.rootScope=e,this.navigation=t,this.timeout=o,this.telemetryService=i,this.errorService=r,this.modelMerger=a,this.modelConverter=n,this.syncService=s,this.dashboardDataService=l,this.dashboardHttpService=c,this.dashboardSyncService=d,this.lazyProviderModern=p,this.localizationService=u,this.promiseFactory=h,this.reportService=g,this.viralTenantMergeHelperService=v,this.folderService=m,this.featureSwitchService=b,this.modelService=f,this.storageUsageService=y,this.appMetadataService=S,this.workbookService=w,this.notificationToast=D,this.resourcePackagesService=T,this.userSettingsService=C,this.visualPluginService=k,this.featuredDashboard=P,this.userActivityContextService=E,this.editableFeatureSwitchService=I,this.fileSaver=M,this.shellCapabilities=A,this.dashboardStore=R,this.permissionRefresh=N,this.globalEventBridge=_,this.resourcePackageListenerService=F,this.modernDialogService=x,this.informationProtectionService=L,this.informationProtectionArtifactService=B,this.$injector=O,this.temporaryTileId=-100,this.modelIdsForTileRefresh=[],this.dashboardContainerLoadedDeferred=this.promiseFactory.defer(),this.initializeContainer(),this.dashboardSyncService.beforeDashboardDeleting=function(e){V.beforeDashboardDeletingHandler(e)},this.dashboardSyncService.afterDashboardDeleting=function(e){V.tryResetHome(e,!0)};var U=this.rootScope.$on(z.constants.renameDashboardEventName,(function(e,t,o){return V.renameDashboard(t,o)})),W=this.rootScope.$on(G.updateDashboardContainerEventName,(function(e,t){return V.updateDashboardContainer(t)}));this.dashboardLoadingPromises={},this.rootScope.$on("$destroy",(function(){U(),W()}))}z.DashboardService=e})(powerbi=powerbi||{}),(function(o){!(function(e){var i=o.common.contracts.ContentTileType,r=o.dataServices.PermissionsUtils;e.createRelatedService=function(e,t,o,i,r,a,n){return new s(e,t,o,i,r,a)};var s=(t.prototype.retrieveRelatedReportsToDashboard=function(e){var t=this,e=(void 0!==e.contract?e.contract:e).reportIds;return _.map(e,(function(e){return t.reportService.findReport(e)})).filter((function(e){return!!e&&!t.usageMetricsReport.fromUsageMetrics(e)}))},t.prototype.retrieveRelatedWorkbooksToDashboard=function(e){var t=this;return _.map(e.contract.workbookIds,(function(e){return t.workbookService.findWorkbook(e)})).filter((function(e){return!!e}))},t.prototype.retrieveRelatedDashboardsToReport=function(t){var e=this.dashboardDataService.dashboards;return _.filter(e,(function(e){return _.includes(e.contract.reportIds,t.id)}))},t.prototype.retrieveRelatedDashboardsToWorkbook=function(t){var e=this.dashboardDataService.dashboards;return _.filter(e,(function(e){return _.includes(e.contract.workbookIds,t.id)}))},t.prototype.retrieveRelatedModelsToDashboard=function(e){var t=this;return _.map(e.modelIds,(function(e){return t.modelService.findModel(e)})).filter((function(e){return!!e&&!t.usageMetricsReport.fromUsageMetrics(e)}))},t.prototype.canReshare=function(e){if(e.contentTileType===i.Dashboard){var t=e;return!t.contract.isHidden&&r.canReshare(t.getPermissions())}if(e.contentTileType===i.Report){var o=e;if(r.canReshare(o.getPermissions())&&!this.usageMetricsReport.fromUsageMetrics(o))return!0}else{if(e.contentTileType===i.RdlReport&&this.featureSwitchService.featureSwitches.rdlReportSharingUI){o=e;return r.canReshare(o.getPermissions())}if(e.contentTileType===i.Workbook)return r.canReshare(e.getPermissions())}return!1},t);function t(e,t,o,i,r,a){this.dashboardDataService=e,this.modelService=t,this.reportService=o,this.usageMetricsReport=i,this.workbookService=r,this.featureSwitchService=a}})(o.services||(o.services={}))})(powerbi=powerbi||{}),(function(e){(e.htmlTemplate||(e.htmlTemplate={})).put=function(e){e.put("components/appLogo/appLogo.html",'<div class="container {{::$ctrl.size}}" ng-switch="$ctrl.hasAppLogoImage()"><span ng-switch-when="true" class="imageLogo" ng-style="{\'background-image\': $ctrl.getAppLogoImageUrlStyle(), \'background-color\': $ctrl.viewModel.iconBackgroundColor}"></span><pbi-icon ng-switch-when="false" class="iconLogo" name="{{$ctrl.viewModel.icon}}" ng-style="{\'color\': $ctrl.viewModel.iconColor, \'background-color\': $ctrl.viewModel.iconBackgroundColor}" size="{{::$ctrl.size}}"></pbi-icon></div>'),e.put("components/appPlaceholder/appPlaceholder.html","<loading-watermark></loading-watermark>"),e.put("components/artifactSelection/artifactSelection.html",'<div class="capToggle" tooltip tooltip-config="$ctrl.getToggleTooltipConfig()"><pbi-toggle ng-if="::$ctrl.isLoaded" ng-model="$ctrl.isIncluded" ng-change="$ctrl.toggleSelection()" ng-disabled="::!$ctrl.canToggleSelection" no-label="" on-state-text="\'Yes\'" off-state-text="\'No\'" class="toggle"></pbi-toggle></div> <button ng-if="$ctrl.showWarningIcon()" class="pbi-glyph-warning glyphicon glyph-small" tooltip tooltip-config="::$ctrl.getWarningTooltip()" ng-click="$ctrl.showWarning()"></button>'),e.put("components/authoringDropDownMenu/authoringDropDownMenu.html",'<button class="authoringDropDown" ng-if="$ctrl.shouldShowAuthoringDropDown()" ng-click="$ctrl.showMenu($event, $ctrl.getAuthoringMenuProperties)" title="{{$ctrl.getSelectedItem().tooltip}}"><span ng-if="$ctrl.shouldShowNewTilesCounter()" class="numberOfNewTilesBadge" ng-bind="$ctrl.numberOfNewTiles()"></span><i class="{{$ctrl.getSelectedItem().iconClass}} glyph-small"></i><span class="appBarMenuItem" ng-bind="$ctrl.getSelectedItem().text"></span><i class="glyphicon pbi-glyph-chevrondownmedium glyph-mini anchorElementForAuthoring"></i></button>'),e.put("components/dataClassificationLabel/dataClassificationLabel.html",'<a class="dataClassification" ng-href="{{$ctrl.dataClassification.url}}" onclick="event.stopPropagation();" target="_blank" ng-if="$ctrl.dataClassification && $ctrl.dataClassification.showTag && $ctrl.dataClassification.url" title="{{$ctrl.dataClassification.name}}" ng-bind="$ctrl.dataClassification.shortHand"></a><span class="dataClassification" ng-if="$ctrl.dataClassification && $ctrl.dataClassification.showTag && !$ctrl.dataClassification.url" title="{{$ctrl.dataClassification.name}}" ng-bind="$ctrl.dataClassification.shortHand"></span>'),e.put("components/groupIcon/groupIcon.html",'<lazy-icon ng-if="$ctrl.group" src="$ctrl.group.icon || $ctrl.src" title="{{$ctrl.group.displayName}}" placeholder="$ctrl.placeholder" placeholder-size="$ctrl.placeholderSize"></lazy-icon>'),e.put("components/insufficientLicenseBar/insufficientLicenseBar.html",'<span><label ng-bind="::$ctrl.content"></label></span> <button localize="UpgradeAccount_StartTrialButton" ng-click="$ctrl.startTrial()" ng-if="::$ctrl.showTrialButton()"></button> <button localize="UpgradeDialogButtonText_UpgradeNow" ng-click="$ctrl.upgrade()"></button>'),e.put("components/landing/landing.html",'<div class="landingController"><div id="contentMain" class="contentMain"><div id="contentColumn" class="contentColumn"><landing-container></landing-container></div></div></div>'),e.put("components/makeACopyDialog/makeACopyDialog.html",'<dialog-frame><dialog-header><label localize="$ctrl.titleKey"></label></dialog-header><dialog-body><label class="message" localize="$ctrl.messageKey"></label><label localize="$ctrl.itemsIntroKey"></label><div class="itemList"><label ng-repeat="item in ::$ctrl.itemNames track by $index" ng-bind="::item"></label></div></dialog-body><dialog-footer> <button autofocus type="submit" ng-click="$ctrl.save()" class="primary" localize="ModalDialog_Save"></button> <button ng-click="$ctrl.cancel()" localize="ModalDialog_Cancel"></button></dialog-footer></dialog-frame>'),e.put("components/makeACopyDialog/makeACopyDialogDefinition.html",'<make-a-copy-dialog title-key="titleKey" message-key="messageKey" items-intro-key="itemsIntroKey" dashboards="dashboards" reports="reports" models="models"></make-a-copy-dialog>'),e.put("components/popupNotificationDialog/popupNotificationDialog.html",'<dialog-frame><dialog-header><header class="smallHeader" ng-bind="::$ctrl.config.subtitle"></header><header class="mainHeader" ng-bind="::$ctrl.config.title"></header></dialog-header><dialog-body> <img src="{{::$ctrl.config.imgUrl}}" ng-if="::$ctrl.config.imgUrl"><section class="description" ng-bind="::$ctrl.config.message"></section></dialog-body><dialog-footer id="popupNotificationFooter"> <button type="submit" ng-click="$ctrl.ok()" autofocus class="okButton actionButton primary">{{::$ctrl.config.okButton.text}}</button> <button class="cancelButton text" ng-if="::($ctrl.config.cancelButton!=null)" ng-click="$ctrl.close()">{{::$ctrl.config.cancelButton.text}}</button></dialog-footer></dialog-frame>'),e.put("components/popupNotificationDialog/popupNotificationDialogDefinition.html",'<popup-notification-dialog config="config"></popup-notification-dialog>'),e.put("components/printableImage/printableImage.html",'<img class="image" ng-class="{loaded: $ctrl.imageLoaded, animate: !$ctrl.disableAnimation}" ng-src="{{$ctrl.source}}" referrerPolicy="origin" on-load="$ctrl.onLoad()" on-error="$ctrl.onError()" draggable="false" alt="{{$ctrl.altText}}"/>'),e.put("components/selectButton/selectButton.html",'<div class="toggle" ng-mousedown="$ctrl.toggleDropdown($event)"><ng-transclude class="title"></ng-transclude><span class="glyphicon glyph-mini anchorContainer" ng-class="$ctrl.dropdownOpen ? \'pbi-glyph-chevronupmedium\' : \'pbi-glyph-chevrondownmedium\'"><span class="js-anchor anchor"></span></span></div>'),e.put("components/selectTileSort/selectTileSort.html",'<button class="select-button menuItemButton" ng-mousedown="$event.stopPropagation()" aria-expanded="{{$ctrl.dropdownOpen}}" aria-haspopup="listbox" localize-tooltip="SortBy" ng-click="$ctrl.showDropdownItems($event)"><span class="title" ng-bind="$ctrl.title"></span><span class="glyphicon glyph-mini anchorContainer" ng-class="$ctrl.dropdownOpen ? \'pbi-glyph-chevronupmedium\' : \'pbi-glyph-chevrondownmedium\'"></span></button>'),e.put("components/tileOptionsMenu/tileOptionsMenu.html",'<button class="openTileOptionsBtn" ng-click="$ctrl.showOptionsMenu($event)" aria-hidden="true" aria-expanded="false" aria-haspopup="true" localize-tooltip="Options_Menu"><i class="glyphicon pbi-glyph-more"></i></button>'),e.put("views/bottomBar.html",'<div class="bottomBar" ng-hide="context.activeView === 2"><div class="dashboardConnectionsContainer"><dashboard-connections-dialog context="context.dashboardConnections"></dashboard-connections-dialog></div><div class="dashboardConnectionsBtn unselectable" id="dashboardConnectionsBtn" ng-click="context.dashboardConnections.visible = !context.dashboardConnections.visible"><span localize="Landing_DashboardConnectionsButtonText"></span> <span>{{context.dashboardConnections.dashboardConnectionsCount}}</span><i class=\'ms-Icon ms-Icon--alert warningIcon\' ng-hide="!context.dashboardConnections.error"></i></div></div>'),e.put("views/collapsiblePane.html",'<div class="collapsiblePane greyBackground" ng-class="{expanded: viewModel.isExpanded, hidden: !viewModel.isExpanded, smallWidth:viewModel.expandedWidth===1, mediumWidth:viewModel.expandedWidth===2, largeWidth:viewModel.expandedWidth===3}"><div class="innerLayout"><div class="contentFrameHost" ng-transclude></div><div class="expandButtonContainer"><div class="expanderBtn" ng-click="togglePane()" ng-hide="isExpanderHidden === true" localize-tooltip="ActivityPane_Tooltip"><i class="expandIcon glyphicon pbi-glyph-chevronleftmedium glyph-micro"></i></div></div></div></div>'),e.put("views/contentProviderStore/contentProviderSplash.html",'<div class="contentProviderSplash"><div ng-class="{welcome: screenState == 0}" class="container"><h1 ng-if="screenState == 0" localize="GetData_WelcomeTitle" class="title"></h1><h1 ng-if="screenState == 1" localize="GetData_GetData" class="title"></h1><h1 ng-if="screenState == 2" class="title" bind-text-and-tooltip="::getSplashTitleForCurrentGroup()"></h1><div ng-if="screenState == 0" class="desc"><div localize="GetData_WelcomeDescLine1"></div><div localize="GetData_WelcomeDescLine2"></div></div><div ng-if="screenState == 2 && !isMyWorkspace()" class="desc"><div localize="Groups_Splash_Description1"></div><div localize="Groups_Splash_Description2"></div></div><div class="helpSection"><span localize="GetData_Onboarding_DownloadDesktop" localize-fragments><a fragment-index="0" localize="GetData_Onboarding_DownloadDesktopLink" ng-click="downloadDesktopClicked()" href="{{::getDesktopDownloadLink()}}" target=" _blank"></a></span></div><div class="contentContainer"><div class="dataSourceTiles"><section class="dataSourceTileGroup" aria-labelledby="GetDataContentLibraryTitle"><h2 id="GetDataContentLibraryTitle" localize="GetData_ContentLibrary_Title"></h2><div class="dataSourceTile" ng-click="isEnabled(2) && navigateToCategory(2, \'splashPage\', true)"><div class="tileContent"><h3 localize="GetData_MyOrganization" class="dataSourceTitle"></h3><span localize="GetData_MyOrganizationDesc" class="dataSourceDesc"></span></div> <button class="getBtn biButton primary trimmedTextWithEllipsis" localize="GetData_Get" localize-tooltip="GetData_GetOrg" use-tooltip-as-aria-label ng-disabled="!isEnabled(2)"></button></div><div class="dataSourceTile" id="serviceAppTile" ng-click="isEnabled(1) && navigateToCategory(1, \'splashPage\', true)" feature-switch-not="serviceAppsDisabled"><div class="tileContent"><h3 localize="GetData_Services" class="dataSourceTitle"></h3><span localize="GetData_ServicesDesc" class="dataSourceDesc"></span></div> <button class="getBtn biButton primary trimmedTextWithEllipsis" localize="GetData_Get" localize-tooltip="GetData_GetServices" use-tooltip-as-aria-label ng-disabled="!isEnabled(1)"></button></div><div class="separator"></div></section><section class="dataSourceTileGroup" aria-labelledby="GetDataUploadOrConnectDataTitle"><h2 id="GetDataUploadOrConnectDataTitle" localize="GetData_UploadOrConnectData_Title"></h2><div class="dataSourceTile" ng-click="isEnabled(3) && navigateToCategory(3, \'splashPage\')"><div class="tileContent"><h3 localize="GetData_Files" class="dataSourceTitle"></h3><span localize="GetData_FilesDesc" class="dataSourceDesc"></span></div> <button class="getBtn biButton primary trimmedTextWithEllipsis" localize="GetData_Get" localize-tooltip="GetData_GetFiles" use-tooltip-as-aria-label ng-disabled="!isEnabled(3)"></button></div><div class="dataSourceTile" ng-click="isEnabled(6) && navigateToCategory(6, \'splashPage\')"><div class="tileContent"><h3 localize="Databases" class="dataSourceTitle"></h3><span localize="GetData_Databases_Desc" class="dataSourceDesc"></span></div> <button class="getBtn biButton primary trimmedTextWithEllipsis" localize="GetData_Get" localize-tooltip="GetData_GetDatabases" use-tooltip-as-aria-label ng-disabled="!isEnabled(6)"></button></div><div class="dataflowsTile " ng-if="::shouldShowDataflows()" ng-click="isEnabled(7) && navigateToCategory(7, \'splashPage\')"><div class="tileContent"><h3 localize="Generic_Dataflows" class="dataSourceTitle"></h3><span localize="GetData_Dataflows_Desc" class="dataSourceDesc"></span><a localize="Generic_LearnMore" href="https://aka.ms/Self-servicedataprepinPowerBI" target="_blank" ng-click="dataflowsLearnMore(); $event.stopPropagation()"></a></div> <button class="getBtn biButton primary trimmedTextWithEllipsis" localize="Generic_GetStarted" localize-tooltip="GetData_GetDataflows" use-tooltip-as-aria-label ng-disabled="!isEnabled(7)"></button></div></section><div class="separator"></div></div><footer><section class="leftPaneLinks"><div><label localize="GetData_CreateContent_MoreOptions_Title"></label></div><div class="getDataLinks"><a ng-click="navigateToCategory(4, \'splashPage\')" href="javascript:void(0)"><span localize="GetData_Samples" class="text"></span></a><a href="https://go.microsoft.com/fwlink/?linkid=839714" ref="noopener norefererrer" target="_blank"><span localize="GetData_PartnerShowcase" class="text"></span></a></div><div ng-if="showOrgnizationalContentPacksButton()" class="getDataLinks"><a ng-click="navigateToCategory(2, \'splashPage\')" ng-if="isEnabled(2)" href="javascript:void(0)"><span localize="GetData_ContentPack_Link" class="text"></span></a></div></section><section class="rightPaneLinks"><label class="sharedDataLabel" localize="GetData_BuildOnExistingDatasets_Title"></label><a class="getDataLinks" ng-click="openCreateReportDialog()" href="javascript:void(0)"><span localize="GetData_PublishedDatasets" class="text"></span></a></section><a class="skipBtn" ng-click="navigateToContentList()" ng-if="inGroupWelcomeView()" href="javascript:void(0)"><label localize="ContentList_SkipGetData" class="skipLabel"></label></a></footer></div></div></div>'),e.put("views/contentProviderStore/contentProviderSplashIntroVideoModal.html",'<iframe ng-src="https://go.microsoft.com/fwlink/?LinkID=761006" role="presentation" allowfullscreen></iframe><span localize="GetData_TutorialLinkPreface_Text"></span><a href="https://go.microsoft.com/fwlink/?LinkId=780853 " localize="GetData_Watch_Our_Video_Course_Or_Try_This_Tutorial_1" target="_blank"></a><span localize="GetData_Watch_Our_Video_Course_Or_Try_This_Tutorial_2"></span><a class="tutorialLink" localize="GetData_Watch_Our_Video_Course_Or_Try_This_Tutorial_3" href="https://go.microsoft.com/fwlink/p/?LinkId=522081" target="_blank"></a>'),e.put("views/contentProviderStore/customConfigHandlers/sharePointConfigHandler.html","<share-point-url-input></share-point-url-input>"),e.put("views/contentProviderStore/customConfigHandlers/sharePointForFolderConfigHandler.html",'<share-point-url-input use-folder-share-point-storage="true"></share-point-url-input>'),e.put("views/contentProviderStore/customConfigHandlers/sharePointUrlModal.html",'<div class="sharePointConfig" aria-live="polite"><label localize="SharePointSiteExample" for="sharePointText"></label> <input id="sharePointText" type="text" autofocus="" tabindex="1" ng-model="url"/><div class="notice infonav-dialogContentNotification typeInfo"><span class="glyphicon pbi-glyph-info glyph-mini"></span><span class="infonav-dialogContentNotificationText" localize="SharePoint_ModalNotification"></span></div><div ng-show="isLoading"><spinner [size]="\'xsmall\'"></spinner><span class="loading" localize="DataLoaderSpinner_LoadingMessage1"></span></div><div ng-show="hasError" class="error">{{errorMessage}}</div></div>'),e.put("views/contextMenu.html",'<div class="contextMenu" focus-trap ng-class="contextMenuStyle"><div class="wrapper" ng-class="::arrowDirection"><div class="arrow"></div><dropdown-list><div class="metadata-container"><div ng-bind="context.source.displayName" class="title trimmedTextWithEllipsis" title="{{context.source.displayName}}"></div> <button ng-click="close()" localize-tooltip="Close" pbi-auto-focus class="close-btn glyphicon pbi-glyph-close glyph-mini"></button><div ng-repeat="metadata in context.metadata" class="metadata"><h6 class="metadataLabel" ng-bind="metadata.label"></h6><div ng-if="metadata.type === 0"> <span class="message">{{metadata.value()}}</span><span ng-if="metadata.infoTooltipConfig" class="glyphicon glyph-mini pbi-glyph-info tooltipIcon" tooltip tooltip-config="::metadata.infoTooltipConfig"></span></div><div ng-if="metadata.type === 2"> <span>{{ metadata.value() }}</span> <a ng-bind-attr="{href: metadata.linkUrl(), title: metadata.linkTitle() || metadata.linkText(), target: metadata.linkTarget}">{{ metadata.linkText() }}</a></div><div ng-if="metadata.type === 3"><span class="refreshFlyoutWarning" ng-if="metadata.isWarning == true"><i class="glyphicon pbi-glyph-error glyph-mini"></i></span> <a class="refreshHistory" href="" ng-click="metadata.actionOnClick();close();">{{metadata.value()}}</a></div><div ng-if="metadata.type === 4"><div ng-switch="metadata.status"><div ng-switch-when="0"><span class="glyphicon glyph-small pbi-glyph-error statusIcon"></span><span class="statusText" ng-bind="metadata.value"></span></div><div ng-switch-when="1"><span class="glyphicon glyph-small pbi-glyph-success glyph-success-color statusIcon"></span><span class="statusText" ng-bind="metadata.value"></span></div></div></div></div><hr/></div><dropdown-list-item ng-repeat="button in context.actions" class="contextMenuButton trimmedTextWithEllipsis"> <a ng-if="button.link" ng-click="button.action();close();" ng-href="{{button.link}}" target="_blank" title="{{button.text}}">{{::button.text }}</a> <button ng-if="!button.link" ng-click="button.action();close();" title="{{button.text}}" ng-bind="button.text"></button></dropdown-list-item></dropdown-list></div></div>'),e.put("views/dashboard.html",'<div class="dashboard" container-printer calculate-print-styles="calculatePrintStyles" print-container-selector="dashboard"><pbi-data-loader-spinner class="centered" ng-if="!hideSpinner && !viewModel.isLoaded && !isGroupTransitionDelayed && !showReloadDashboard"></pbi-data-loader-spinner><div class="error" ng-if="!viewModel.isLoaded && showReloadDashboard"><i class="glyphicon pbi-glyph-error glyph-large"></i><h3 localize="DashboardTilesLoadError_Title"></h3><span class="tileLoadErrorMessage" localize="DashboardTilesLoadError_Message1" localize-fragments><a fragment-index="0" href="https://support.powerbi.com" target="_blank" localize="DashboardTilesLoadError_Message2"></a><span fragment-index="1" localize="DashboardTilesLoadError_Message3"></span></span> <button class="biButton primary" ng-click="reloadActiveDashboard()" localize="DashboardTilesLoadError_Reload"></button></div><ul class="tileContainer" ng-show="!showReloadDashboard" grid-layout focus-nav-mode="Group" id="dashboard{{viewModel.id}}"><dashboard-tile ng-repeat="tile in filteredTiles() track by tileTrackerFn(tile)" view-model="tile" can-edit="canEditTiles()" disable-keyboard-nav="disableKeyboardNav" disable-pointer-events="{{::disablePointerEvents}}" grid-layout-item grid-layout-container="gridLayoutContainer" ng-repeat-finish-event="dashboardTileRepeatFinished" remove-tile-from-mobile-view="removeTileFromMobileView(tile)" in-edit-mobile-layout-mode="inEditMobileLayoutMode" touch-action="{{dashboardTileTouchAction}}"></dashboard-tile></ul></div>'),e.put("views/dashboardContainer.html",'<div class="dashboardContainerView isNavigationPaneEnabled" ng-class="{isMainContentDisabled: isTileSpotlighted(),                isDashboardHeaderEnabled: isTileSpotlighted(),                isSelectedTileHighlighted: isSelectedTileHighlighted(),                isQuestionBoxHidden: !shouldDisplayQuestionBox}" ng-style="dashboardStyle"><div class="mainContent" ng-class="{fluentTheme: !dashboardStyle}"><notification-bar></notification-bar><div class="header" ng-if="!fullScreen.fullScreenMode"><pbi-lazy-load-modern ng-if="initialized" [module-path]="modernDashboardModulePath" [component-id]="\'DashboardAppBarComponentId\'" [input-args]="modernDashboardAppBarInputArgs"></pbi-lazy-load-modern><pbi-lazy-load-modern ng-if="isDashboardErrorBannerOn()" [module-path]="appBarLazyLoadPath" [component-id]="\'DashboardTilesErrorBannerComponentId\'" [output-args]="appBarModernComponentOutputArgs"></pbi-lazy-load-modern><div class="dashboardControlsWrapper" ng-class="{ errorBannerOff: !isDashboardErrorBannerOn(), errorBannerOn: isDashboardErrorBannerOn() }" ng-if="shouldDisplayQuestionBox"><qna-dashboard-launcher ng-if="dashboardDataService.activeDashboardContainsQnaSupportedModel" [qna-style]="qnaStyle"></qna-dashboard-launcher></div></div><div class="dashboardSliderMain fillAvailableSpace" ng-class="{ errorBannerOff: !isDashboardErrorBannerOn(), errorBannerOn: isDashboardErrorBannerOn() }"><div class="dashboardViewSlider"><dashboard disable-tile-ease-in="true" view-model="dashboardDataService.activeDashboard" disable-keyboard-nav="isTileSpotlighted()" display-layout="0" is-group-transition-delayed="folderService.isFolderTransitionDelayed"></dashboard></div></div><downgraded-flyout [lazy-load-path]="annotationsModulePath" [lazy-component-id]="\'DashboardPaneComponentId\'"></downgraded-flyout></div></div>'),e.put("views/dashboardWrapper.html",'<dashboard disable-tile-ease-in="disableTileEaseIn" view-model="viewModel" display-layout="displayLayout" disable-pointer-events="disablePointerEvents" mobile-layout="mobileLayout" in-edit-mobile-layout-mode="inEditMobileLayoutMode"></dashboard>'),e.put("views/dropdowns/appBarAuthoringMenu.html",'<dropdown-overlay dropdown-overlay-name="authorOptionsMenu" focus-trap dropdown-overlay-class="mobileAuthoringAdditionalMenus angular-dropdown override-box-shadow angular-dropdown-authoring mobileAuthoringSelector"><ul class="mobileAuthoringAdditionalMenus angular-dropdown angular-dropdown-authoring active additionalMenus" ng-class="{dark: getMode() === 0}"><li ng-repeat="item in getMenuActions()"> <button class="dropdown-item moreOptions" ng-click="menuActionSelected(item); $event.stopPropagation();" ng-class="{selectedItem: item.checked}" role="menuitem"><div class="dropdown-content angular-dropdown-authoring"><i class="dropdown-icon {{::item.iconClass}}"></i><div class="dropdown-label" ng-bind="::item.text"></div><span ng-if="item.numberOfNewTiles" class="numberOfNewTilesBadge" ng-bind="item.numberOfNewTiles"></span></div></button></li></ul></dropdown-overlay>'),e.put("views/dropdowns/breadcrumbsMenu.html",'<dropdown-overlay dropdown-overlay-name="{{menuOverlayName}}"><ul class="angular-dropdown active fluentTheme" focus-trap role="menu"><li ng-repeat="item in getMenuActions()" ng-switch="::item.type"> <button ng-switch-when="0" class="dropdown-item" ng-click="menuActionSelected();" ng-disabled="$last" ui-sref="{{::item.uisref || false}}"><div class="dropdown-content"><span class="dropdown-label" ng-bind="::item.text" title="{{::item.tooltip || item.text}}"></span></div></button></li></ul></dropdown-overlay>'),e.put("views/dropdowns/lineageDiagramActionsMenu.html",'<dropdown-overlay dropdown-overlay-name="lineageDiagramActionsMenu" focus-trap on-close="menuClosed()" focus-on-escape="closeMenu()"><ul class="angular-dropdown active lineageActionList"><li ng-repeat="item in ::menuItems"> <button class="dropdown-item trimmedTextWithEllipsis" ng-click="menuItemSelected(item)" title="{{ item.tooltip }}" ng-show="::!item.hide" ng-disabled="::item.disabled"><label class="dropdown-label" ng-bind="::item.text"></label></button></li></ul></dropdown-overlay>'),e.put("views/dropdowns/navigationBarSettingsMenu.html",'<dropdown-overlay dropdown-overlay-name="settingsMenu" focus-trap dropdown-overlay-class="angular-dropdown navigationBar-contextMenu override-box-shadow"><ul class="navigationBar-contextMenu active" ng-attr-read-only="{{!canWrite()}}"><li class="dropdown-item addBorderBottom quotaManagement" ng-click="onManageStorageSelected()"> <button class="dropdown-content "><usage-bar-menu-item label-class="lableItem"></usage-bar-menu-item></button></li><li class="orgApps" ng-if="::showContentPacks()"><div class="dropdown-item addBorderBottom" ng-click="onCreateContentPackSelected()"> <button class="dropdown-content dropdown-label" localize="TopNav_SettingsMenu_CreateContentPack"></button></div><div class="dropdown-item addBorderBottom" ng-click="onViewContentPackSelected()"> <button class="dropdown-content dropdown-label" localize="TopNav_SettingsMenu_ViewContentPack"></button></div></li><li class="dropdown-item addBorderBottom manageAdminPortal" ng-click="onAdminPortalSelected()"> <button class="dropdown-content dropdown-label" localize="AdminPortal_Title"></button></li><li ng-if="::showManageGateways()" class="dropdown-item addBorderBottom manageGateways" ng-click="onManageGatewaysSelected()"> <button class="dropdown-content dropdown-label" localize="TopNav_SettingsMenu_ManageGateways"></button></li><li class="dropdown-item addBorderBottom manageSettings" ng-click="onPowerBISettingsSelected()"> <button class="dropdown-content dropdown-label" localize="TopNav_SettingsMenu_PowerBISettings"></button></li><li ng-if="::showPublishToWeb()" class="dropdown-item addBorderBottom manageEmbedCodes" ng-click="onManageEmbedSelected()"> <button class="dropdown-content dropdown-label" localize="TopNav_SettingsMenu_ManageEmbedCodes"></button></li><li ng-if="::showArchivedContentLink" class="dropdown-item addBorderBottom" ng-click="showArchivedContent()"> <button class="dropdown-content dropdown-label" localize="NavigationPane_ArchivedContent"></button></li></ul></dropdown-overlay>'),e.put("views/dropdowns/sharingMenu.html",'<dropdown-overlay dropdown-overlay-name="sharingOptionsMenu" focus-trap dropdown-overlay-class="sharingMenu angular-dropdown override-box-shadow"><ul class="sharingMenu angular-dropdown active"><li ng-repeat="item in getMenuActions()" class="dropdown-item"> <button ng-click="menuActionSelected(item); $event.stopPropagation();" class="dropdown-label" ng-bind="::item.text"></button></li></ul></dropdown-overlay>'),e.put("views/dropdowns/tileOptionsMenu.html",'<dropdown-overlay dropdown-overlay-name="tileOptionsMenu" focus-trap focus-on-escape="$ctrl.dismiss(null)" dropdown-overlay-class="angular-dropdown tileOptionsMenuNew"><ul><li ng-repeat="item in ::items" ng-click="item.action($event)" ng-switch="item.type"><div ng-switch-when="0" class="urlContainer"><a ng-if="item.link.href" ng-class="item.buttonClass" ng-attr-href="{{item.link.href}}" ng-attr-target="{{item.link.target}}" rel="noopener noreferrer" title="{{::item.title}}"><i ng-class="item.iconClass" class="glyphicon glyph-small"></i><span ng-bind="::item.text"></span></a> <button ng-if="!item.link.href" ng-class="item.buttonClass" title="{{::item.title}}"><i ng-class="item.iconClass" class="glyphicon glyph-small"></i><span ng-bind="::item.text"></span></button></div> <button ng-switch-when="1" ng-class="item.buttonClass" title="{{::item.title}}"><i ng-class="item.iconClass" class="glyphicon glyph-small"></i><span ng-bind="::item.text"></span></button> <button ng-switch-when="2" title="{{::item.title}}" disabled><span class="placeholder" ng-bind="::item.text"></span></button></li></ul></dropdown-overlay>'),e.put("views/excelUploadFormat.html",'<div class="excelContent"><div class="uploadFormat"><header><h1 class="title" localize="UploadExcelLocalFile_ChooseFormat"></h1><div class="text" localize="UploadExcel_ChooseFormatDescription"></div></header><table class="contentContainer"><tr class="contentItem"><td class="optionColumn"><div class="imageContainer"><div class="importDataIntoPowerBI"></div></div></td><td></td><td class="optionColumn"><div class="imageContainer"><div class="viewExcelInPowerView"></div></div></td></tr><tr class="spacer"></tr><tr class="contentItem"><td class="optionColumn"><span class="contentItemTitle" localize="UploadExcel_ChooseFormat_ImportData"></span></td><td class="seperatorColumn"><span class="contentItemTitle" localize="UploadExcel_ChooseFormat_Or"></span></td><td class="optionColumn"><span class="contentItemTitle" localize="UploadExcelLocalFile_ChooseFormat_ViewExcel"></span></td></tr><tr class="contentItem"><td class="optionColumn"><div class="contentItemDescription"><span localize="UploadExcelLocalFile_ChooseFormat_ImportDataDescription"></span></div></td><td></td><td class="optionColumn"><div class="contentItemDescription"><span localize="UploadExcelLocalFile_ChooseFormat_ViewExcelDescription"></span></div></td></tr><tr class="contentItem"><td class="optionColumn"><div class="contentBtnItem"> <button class="buttonProviderFormat submitBtn BigBtn importDataBtn" ng-click="chooseFormat(0)" ng-disabled="inProgress"><span localize="UploadExcel_ChooseFormat_Import"></span><i class="arrow glyphicon pbi-glyph-getdata glyph-small getDataIcon"></i></button></div></td><td></td><td class="optionColumn"><div class="contentBtnItem" ng-attr-title="{{getToolTipForFFXLUploadButton()}}"> <button class="buttonProviderFormat submitBtn BigBtn viewExcelBtn" ng-click="chooseFormat(1)" ng-disabled="restrictServiceOutboundFlowsEnabled || inProgress" ng-class="{ffxlDisabled: restrictServiceOutboundFlowsEnabled}"><span localize="Upload"></span><i class="arrow glyphicon pbi-glyph-getdata glyph-small getDataIcon"></i></button></div></td></tr></table></div></div>'),e.put("views/historyDialogView.html",'<div><modal-dialog class="historyDialog" history-dialog="viewModel" view-model="dialogModel" ng-if="viewModel.showModalDialog" on-cancel-action="closeDialog()" on-confirm-action="closeDialog()"><div class="title" ng-switch="::isCacheRefresh"><span ng-switch-when="false" localize="HistoryDialog_Title"></span><span ng-switch-when="true" localize="HistoryDialog_TitleCache"></span></div><div class="model-package-selection"><span ng-class="{\'active\': refreshTypeSelected === 0}" accessible-click="refreshTypeSelected = 0" tabindex="0" localize="HistoryDialog_ScheduledTab"></span><span ng-class="{\'active\': refreshTypeSelected === 1}" accessible-click="refreshTypeSelected = 1" tabindex="0" localize="OneDrive"></span></div><div class="historyTableContainer"><table class="historyTable"><thead class="historyTableHeader"><tr><th class="historyDetails" localize="Details"></th><th class="historyType" localize="Type"></th><th class="historyStart" localize="HistoryDialog_TableHeader_Start"></th><th class="historyEnd" localize="HistoryDialog_TableHeader_End"></th><th class="historyStatus" localize="HistoryDialog_TableHeader_Status"></th><th class="historyFailMessage" localize="Message"></th></tr></thead><tbody class="historyTableBody" ng-repeat="history in getSelectedHistories(refreshTypeSelected)" ng-init="detailExpand=false"><tr><td class="errorDetailsLink"><div ng-show="history.showDetailLink" ng-switch="detailExpand" accessible-click="detailExpand=!detailExpand" tabindex="0"><span localize="Show" ng-switch-when="false"></span><span localize="Hide" ng-switch-when="true"></span></div></td><td class="historyType" ng-switch="getRefreshType(history)"><span ng-switch-when="0" localize="HistoryDialog_RefreshType_Scheduled"></span><span ng-switch-when="1" localize="HistoryDialog_RefreshType_OnDemand"></span><span ng-switch-when="2" localize="HistoryDialog_RefreshType_ViaApi"></span><span ng-switch-when="5" localize="FullSchemaRefresh"></span><span ng-switch-when="7" localize="HistoryDialog_RefreshType_ViaXmla"></span><span ng-switch-when="8" localize="HistoryDialog_RefreshType_ViaEnhancedApi"></span><span ng-switch-when="9" localize="HistoryDialog_RefreshType_OnDemandTrain"></span></td><td class="historyStart"><span ng-bind="::history.startTime"></span></td><td class="historyEnd"><span ng-bind="::history.endTime"></span></td><td class="historyStatus"><span ng-bind="::history.status"></span></td><td class="historyFailMessage"><span ng-bind="::history.friendlyErrorMessage"></span></td></tr><tr class="historyErrorDetails" ng-if="detailExpand"><td colspan="9"><inline-name-value-pairs mode="\'info\'" show-title="false" detail-expand="true" name-value-pairs="history.details"></inline-name-value-pairs></td></tr></tbody></table></div></modal-dialog></div>'),e.put("views/inFocus.html",'<div class="inFocusContainer" ng-if="showInFocusMode"><div class="inFocusAppBar appBar"><div class="appBarSection left"> <button class="iconBox" ng-click="hide()" localize-tooltip="InFocus_ExitInFocus" pbi-auto-focus><i class="glyphicon pbi-glyph-arrowleft glyph-small"></i><span class="dashboardTitle link appBarMenuItem" localize="InFocus_ExitInFocus"></span></button><div class="appBarDivider"></div><div class="titleBar"><span class="focusTitle appBarTitle" ng-bind="viewModel.displayText"></span><span class="focusSubtitle appBarText" ng-bind="viewModel.subDisplayText"></span></div></div><div class="appBarSection right" ng-class="{readOnlyMode: !(canEdit || viewModel.openInsightArgs.canPin), insights: viewModel.openInsightArgs != null}" ng-if="viewModel.inFocusTile"><span class="rightFloatedItem"></span><div class="lastRefreshTimestamp appBarText metadata" ng-if="viewModel.inFocusTile.formattedTime"><span class="caption" localize="InFocus_RefreshTime"></span><span ng-bind="viewModel.inFocusTile.formattedTime"></span></div><div class="appBarDivider"></div> <button class="getRelatedInsightsBtn" ng-click="getRelatedInsights()" ng-disabled="!relatedInsightsEnabled" title="{{::getInsightsTooltip()}}"><i class="glyphicon pbi-glyph-insight glyph-small"></i><span class="appBarMenuItem" ng-bind="viewModel.getRelatedInsightsText"></span></button> <button ng-if="showPinButton()" class="pinBtn" ng-click="pinVisual()" localize-tooltip="PinVisual_ToolTip"><i class="glyphicon pbi-glyph-pinned glyph-small"></i><span class="appBarMenuItem" ng-bind="viewModel.pinVisualText"></span></button> <button dropdown-menu class="moreOptionsItem moreOptionsInFocusButton" dropdown-items="inFocusMenuItems" dropdown-on-item-selected="inFocusMenuItemSelected(selected)" dropdown-class="additionalMenus" localize-tooltip="Options_Menu"><i class="glyphicon pbi-glyph-more glyph-small"></i></button></div></div><div ng-if="viewModel.inFocusTile" ng-switch="viewModel.inFocusTile.type"><section class="explorationContainer inFocus" ng-switch-when="0"><exploration-host ng-if="viewModel.showVisualEnabled && !inFocusDrillableError" class="explorationHost inFocusBody" [view-model]="viewModel" id="inFocusExpHost"><legacy-scoped-root scoped-provider-instance-name="insightsScopedInstanceProvider"><insights-scoped-services-bridge><insights-in-focus-pane-modern-lazy ng-if="viewModel.showInsightsInFocusPane" [model]="viewModel.inFocusTile.datasetModel.contract" [visual-contract]="viewModel.canvas.visualContainer.contract" [tile-action]="viewModel.inFocusTile.action.action" [visual-title]="viewModel.displayText + \' \' + viewModel.subDisplayText" [parent-event]="openInFocusEvent"></insights-in-focus-pane-modern-lazy></insights-scoped-services-bridge></legacy-scoped-root><div class="exploration"> <button class="previousVisualButton" ng-if="viewModel.showPreviousVisualButton" ng-click="showPreviousVisual()"><i class="glyphicon iconBox pbi-glyph-chevronleftmedium glyph-small"></i><span localize="InFocus_PreviousVisual"></span></button><downgraded-explore-canvas-modern [view-model]="viewModel.canvas.exploration.exploreCanvas"></downgraded-explore-canvas-modern><div class="sourceInfo"> <button class="sourceStyle" ng-if="viewModel.inFocusTile.report" ng-click="openReport()" ng-bind="viewModel.source"></button></div></div></exploration-host><water-mark-message ng-if="inFocusDrillableError" config="errorMessageConfig"></water-mark-message><div class="inFocusCenteredSpinner" ng-show="!viewModel.inFocusTile"><spinner modern [delay]="1000"></spinner></div></section><workbook-tile on-resize="handleResize(width, height)" view-model="viewModel.workbook" class="explorationContainer inFocus" ng-switch-when="5"></workbook-tile><ng-container class="realTimeTile inFocus" on-resize="handleResize(width, height)" ng-switch-when="8"><pbi-lazy-load-modern [module-path]="realTimeTileLazyPath" [component-id]="\'RealTimeTileComponentId\'" [input-args]="realTimeTileModernInputArgs"></pbi-lazy-load-modern></ng-container></div></div>'),e.put("views/landingContainer.html",'<div class="landingContainer"><div class="waitingContainer" ng-if="showLoadingSpinner()"><div class="spinnerWithText"><spinner [size]="\'large\'"></spinner><div class="loadingText" localize="Loading_Text"></div></div></div><div id="workbookLandingContainer" class="landingRootContent workbookContainerContent" ng-if="inWorkbookView()" ng-class="{inApps: inAppView()}"><workbook-container></workbook-container></div><legacy-scoped-root><exploration-scoped-services-bridge><div in-focus ng-if="::isInitialized" can-edit="dashboardDataService.activeDashboard.canEdit"></div></exploration-scoped-services-bridge></legacy-scoped-root><div class="sliderPane unselectable" ng-if="contentSliderEnabled && navigation.inContentSliderView()" ui-view="contentSlider"></div></div>'),e.put("views/loadNotificationDialog.html",'<div class="contentProviderLoadNotificationContent"><spinner [delay]="0"></spinner><span class="contentProviderLoadNotificationMessage" localize="ParametersLoadingMessage"></span></div>'),e.put("views/manageEmbedView.html",'<div class="sliderContentView manageEmbed"><user-group-header></user-group-header><div class="tableArea"><div class="centeredSpinner" ng-if="!isLoaded"><spinner modern></spinner></div><div ng-if="isLoaded" ng-switch="embeddedResources.length > 0"><table class="manageEmbedTable" ng-switch-when="true"><thead><tr><th class="associatedReport" ng-click="updateSortProperty(\'name\')" localize="ManageEmbed_AssociatedReport_Header"></th><th class="status" ng-click="updateSortProperty(\'status\')" localize="ManageEmbed_Status_Header"></th><th class="dateCreated" ng-click="updateSortProperty(\'dateCreatedSortable\')" localize="ManageEmbed_DateCreated_Header"></th><th></th></tr></thead><tbody><tr ng-repeat="resource in embeddedResources | orderBy:sortProperty:sortDescending track by resource.uniqueId"><td class="itemField trimmedTextWithEllipsis" bind-text-and-tooltip="resource.name"></td><td class="itemField trimmedTextWithEllipsis" ng-bind="resource.status"></td><td class="itemField trimmedTextWithEllipsis" ng-bind="resource.dateCreated"></td><td class="manage-embed-actions"> <button class="manage-embed-action-button" ng-click=\'showEmbedCode(resource)\'><i class=\'glyphicon glyph-small pbi-glyph-code\' localize-tooltip="ManageEmbed_CodeText"></i></button> <button ng-if="!services.activeFolderId.isReadOnly && featureSwitchPublishToWeb" class="manage-embed-action-button delete-embed-button" ng-click=\'onDeleteEmbedClick(resource)\'><i class=\'glyphicon glyph-small pbi-glyph-delete\' localize-tooltip="Delete"></i></button></td></tr></tbody></table><div class="manageEmbedTableEmpty" ng-switch-when="false"><i class="glyphicon pbi-glyph-warning glyph-med warningIcon"></i><h2 localize="ManageEmbed_NoEmbedCodesWarningTitle"></h2><p localize="ManageEmbed_NoEmbedCodesWarningText"></p></div></div></div></div>'),e.put("views/pinTileDialog.html",'<div class="explorationPinTileDialog" ng-class="{liveReportTile: isLiveReport, pinDashboardTile: !isLiveReport}"><div class="tilePreview section" ng-class="{noTitle: !viewModel.hasTitle(viewModel.useDashboardFormatting ? viewModel.reportTile:viewModel.dashboardTile), noPreview: viewModel.needSaveReport, showPreview: !viewModel.needSaveReport,vrmPreview:!viewModel.hasTileFormatting }" tabindex="0"><div class="liveReport" ng-if="isLiveReport"><span class="previewSection" localize="PinLiveReport_Preview"></span><span localize="PinLiveReport_SavedState"></span></div><div class="dashTile tilePreviewFrame" ng-show="viewModel.useDashboardFormatting"><ul><dashboard-tile disable-keyboard-nav="true" view-model="viewModel.dashboardTile"></dashboard-tile></ul></div><div class="reportTile tilePreviewFrame" ng-show="!viewModel.useDashboardFormatting"><ul><dashboard-tile disable-keyboard-nav="true" view-model="viewModel.reportTile"></dashboard-tile></ul></div><div class="tileFormatting section" ng-show="viewModel.hasTileFormatting"><div class="tileFormattingMessage pinTileBoldText" localize="ReportContainer_TileFormattingMessage"></div><div class="formatChoices tileRadioGroup"><ul><li><div class="pbi-input"> <input type="radio" name="cpRadio1" ng-disabled="viewModel.needSaveReport" ng-model="viewModel.useDashboardFormatting" ng-value="true" ng-change="updateFormatting()"><label class="form-label" localize="ReportContainer_UseDashboardFormattingRadioText"></label></div></li><li><div class="pbi-input"> <input type="radio" name="cpRadio2" ng-disabled="viewModel.needSaveReport" ng-model="viewModel.useDashboardFormatting" ng-value="false" ng-change="updateFormatting()"><label class="form-label" localize="ReportContainer_RetainReportFormattingRadioText"></label></div></li></ul></div></div></div><div class="dashboardSelector section"><div class="sectionContainer pinToDashboard" ng-model="viewModel.needSaveReport" ng-show="!viewModel.needSaveReport"><h2 class="title trimmedTextWithEllipsis" localize="ReportContainer_PinToDashboardTitle" localize-tooltip="ReportContainer_PinToDashboardTitle"></h2><div class="message" localize="ReportContainer_SelectExistingOrCreateNewDashboardMessage"></div><div class="pinMessage" localize="ReportContainer_WhereToPinMessage"></div><div class="themeYellowDark dashboardChoices tileRadioGroup"><div class="pbi-input existingDashRadioInput"> <input id="existingDashRadioInput" type="radio" name="dashboardPinTarget" ng-disabled="noPinnableDashboard()" ng-model="viewModel.useExistingDashboard" ng-value="true" pbi-auto-focus><label class="form-label" localize="ReportContainer_UseExistingDashboardRadioText" for="existingDashRadioInput"></label></div><div class="pbi-input newDashRadioInput"> <input id="newDashRadioInput" type="radio" name="dashboardPinTarget" ng-model="viewModel.useExistingDashboard" ng-value="false"><label class="form-label" localize="ReportContainer_UseNewDashboardRadioText" for="newDashRadioInput"></label></div></div><div class="existingDashboardDropDown" ng-if="viewModel.useExistingDashboard"><label for="selectDashboard" localize="ReportContainer_SelectExistingDashboard"></label> <select id="selectDashboard" class="selectDashboard" ng-model="viewModel.selectedDashboardId" localize-tooltip="ContentList_CreateDashboard_DialogDetails" ng-keyup="selectBoxKeyup($event)"><option ng-selected="{{dashboard.id === dashboardDataService.activeDashboard.id}}" ng-repeat="dashboard in sortedPinnableDashboards" value="{{dashboard.id}}" title="{{dashboard.displayName}}" ng-bind="dashboard.displayName"></option></select></div><div class="newNameTextBox animate-show section" ng-if="!viewModel.useExistingDashboard"><label for="newDashboardName" localize="SettingsBlade_DashboardName"></label> <input id="newDashboardName" type="text" class="pinTileText inputDashboardTitle" ng-trim="false" min="1" maxlength="500" ng-model="viewModel.newDashboardName"/></div><div class="warningMessageContainer"><div class="warningMessage liveReport" ng-if="isLiveReport"><pbi-lazy-load-modern [module-path]="MessageBannerModulePath" [component-id]="\'MessageBannerComponentId\'" [input-args]="{viewModel: liveReportBannerModel}"></pbi-lazy-load-modern></div><div class="warningMessage noReshareWarning" ng-if="::isNotFullyResharable"><pbi-lazy-load-modern [module-path]="MessageBannerModulePath" [component-id]="\'MessageBannerComponentId\'" [input-args]="{viewModel: noReshareWarningBannerModel}"></pbi-lazy-load-modern></div><div class="warningMessage informationProtectionWarning" ng-if="showInformationProtectionWarning && !viewModel.useExistingDashboard"><pbi-lazy-load-modern [module-path]="MessageBannerModulePath" [component-id]="\'MessageBannerComponentId\'" [input-args]="{viewModel: informationProtectionBannerModel}"></pbi-lazy-load-modern></div></div></div><div class="sectionContainer saveYourReport" ng-model="viewModel.needSaveReport" ng-hide="!viewModel.needSaveReport"><h2 class="title" localize="ReportAppBar_SaveAsDialogTitle"></h2><div class="message" localize="ReportContainer_NeedToSaveReportBeforePin"></div><div class="newNameTextBox animate-show section"> <input type="text" class="pinTileText inputReportTitle" ng-trim="false" min="1" maxlength="500" ng-model="viewModel.newReportName"/></div></div><div class="pinTileButtons"> <button class="pinTile biButton primary trimmedTextWithEllipsis" ng-click="pin()" ng-show="!viewModel.needSaveReport" ng-disabled="viewModel.isPinned || (!viewModel.useExistingDashboard && (!viewModel.newDashboardName || viewModel.newDashboardName.length===0))" ng-bind="::pinButtonText" ng-attr-title="{{::pinButtonText}}"></button> <button class="cancelpinTile biButton" ng-click="cancel()" localize="PBI_Button_Label_Cancel"></button> <button class="saveAndContinueBtn biButton primary" ng-click="saveAndContinue()" ng-show="viewModel.needSaveReport" ng-disabled="(!viewModel.newReportName || viewModel.newReportName.length===0)" localize="ReportContainer_SaveAndContinue"></button></div></div></div>'),e.put("views/settings/settingsDatasourceCredentials.html",'<div ng-if="::hasEditableDatasources" class="settingsDatasourceCredentials"> <button class="sectionHeader" ng-class="{disabledContainer : shouldDatasourceCredentialsDisabled()}" ng-click="viewModel.manageDataSourcesExpand = !viewModel.manageDataSourcesExpand" aria-expanded="{{!shouldDatasourceCredentialsDisabled() && viewModel.manageDataSourcesExpand}}"><i class="glyphicon" ng-class="{true:\'refreshSectionExpander pbi-glyph-caretdownright\', false:\'refreshSectionExpander pbi-glyph-caretright\'}[!shouldDatasourceCredentialsDisabled() && viewModel.manageDataSourcesExpand]"></i><span class="refreshSectionTitle" localize="SettingsDataset_ManageDataSources_Title"></span></button><div class="expandableInnerContainer" ng-show="!shouldDatasourceCredentialsDisabled() && viewModel.manageDataSourcesExpand" ng-switch="showDiscoverDatasourcesSpinner"><spinner ng-switch-when="true"></spinner><div ng-switch-when="false"><inline-message trace-details="datasourceTraceDetails" use-error-icon class="expandableBlockWarning" ng-show="viewModel.hasDatasourceWithWrongCredentials || viewModel.hasDirectQueryDatasourceWithMissingCredentials"><span ng-show="viewModel.hasDatasourceWithWrongCredentials" localize="SettingsDataset_ManageDataSources_Warning_YouNeedToProvideCredentials"></span><span ng-show="viewModel.hasDirectQueryDatasourceWithMissingCredentials" localize="SettingsDataset_ManageDataSources_Warning_DirectQueryMissingCredentials"></span></inline-message><inline-message trace-details="datasourceTraceDetails" class="expandableBlockWarning" ng-if="viewModel.showSkipTestConnectionWarning"><span ng-if="viewModel.showSkipTestConnectionWarning" localize="SettingsDataset_ManageDataSources_Warning_SkipTestConnection"></span></inline-message><div class="topMarginTextContainer"><table class="datasourceContainer"><tr ng-repeat="datasource in viewModel.datasources | orderBy:\'displayName\'"><th class="datasourceName"><span title="{{::datasource.fullName}}" ng-bind="::datasource.displayName"></span><th><div class="statusContainer"><spinner ng-show="testConnectionProgressing(datasource)"></spinner><i class="glyphicon pbi-glyph-error glyph-small" title="{{datasource.testConnectionErrorMessage}}" ng-show="testConnectionFailed(datasource)"></i></div><a href="" class="dataSourceEditButton" localize="SettingsDataset_ManageDataSources_EditButtonText" ng-click="editDatasource(datasource)" ng-show="!datasource.useEGW"></a><span class="datasourceName" localize="SettingsDataset_ManageDataSources_DataSourceWithEnterpriseGateway" ng-show="datasource.useEGW"></span></th></tr></table></div></div></div></div>'),e.put("views/settings/settingsOneDriveCredentials.html",'<div class="settingsOneDriveCredentials"> <button class="sectionHeader" ng-class="{disabledContainer : storageSourceFileNotFound}" ng-click="viewModel.manageStorageSourceExpand = !viewModel.manageStorageSourceExpand" aria-expanded="{{viewModel.manageStorageSourceExpand}}"><i class="glyphicon" ng-class="{true:\'refreshSectionExpander pbi-glyph-caretdownright\', false:\'refreshSectionExpander pbi-glyph-caretright\'}[viewModel.manageStorageSourceExpand]"></i><span class="refreshSectionTitle" localize="SettingsDataset_ManageStorageSource_Title"></span></button><div class="expandableInnerContainer" ng-show="viewModel.manageStorageSourceExpand" ng-switch="showDiscoverStorageSourcesSpinner"><spinner ng-switch-when="true"></spinner><div ng-switch-when="false"><inline-message trace-details="storageSourceTraceDetails" use-error-icon class="expandableBlockWarning" ng-show="testPackageConnectionFailed()"><span localize="SettingsDataset_ManageStorageSource_Warning_YouNeedToProvideCredentials"></span></inline-message><div><table class="datasourceContainer"><tr><th class="datasourceName"><span title="{{::getStorageSourceDisplayName()}}" ng-bind="getStorageSourceDisplayName()"></span></th><th><div class="statusContainer"><spinner ng-show="testPackageConnectionProgressing()"></spinner><i class="glyphicon pbi-glyph-error glyph-small" title="{{viewModel.storageSource.testConnectionErrorMessage}}" ng-show="testPackageConnectionFailed()"></i></div><a href="" class="dataSourceEditButton" localize="SettingsDataset_ManageDataSources_EditButtonText" ng-click="editStorageSource()"></a></th></tr></table></div></div></div></div>'),e.put("views/settings/settingsOneDriveRefresh.html",'<div class="settingsOneDriveRefresh"> <button class="sectionHeader" ng-class="{disabledContainer : storageSourceFileNotFound}" ng-click="viewModel.manageStorageRefreshExpand = !viewModel.manageStorageRefreshExpand" aria-expanded="{{viewModel.manageStorageRefreshExpand}}"><i class="glyphicon" ng-class="{true:\'refreshSectionExpander pbi-glyph-caretdownright\', false:\'refreshSectionExpander pbi-glyph-caretright\'}[viewModel.manageStorageRefreshExpand]"></i><span class="refreshSectionTitle" localize="SettingsDataset_RefreshStorageSource_Title"></span></button><div class="expandableInnerContainer" ng-show="viewModel.manageStorageRefreshExpand" ng-switch="showDiscoverStorageSourcesSpinner"><spinner ng-switch-when="true"></spinner><div class="topMarginTextContainer" ng-switch-when="false"><header localize="SettingsDataset_Enable_PackageRefresh_Title"></header><inline-message trace-details="storageSourceTraceDetails" use-error-icon class="expandableBlockWarning" ng-show="testPackageConnectionFailed()"><span localize="SettingsDataset_ManageStorageSource_Warning_YouNeedToProvideCredentials"></span></inline-message><pbi-toggle ng-model="viewModel.contract.isPackageRefreshEnabled" ng-disabled="shouldPackageRefreshSettingsToggleDisabled()" ng-change="updateStorageSourceRefresh()" no-label on-state-text="ToggleSwitchOn" off-state-text="ToggleSwitchOff"></pbi-toggle></div></div></div>'),e.put("views/settings/settingsPublishedContentView.html",'<div class="settings"></div>'),e.put("views/states/adminPortalState.html","<admin-portal></admin-portal>"),e.put("views/states/cdsaModelAuthoringState.html","<cdsa-model-authoring-container></cdsa-model-authoring-container>"),e.put("views/states/externalContentViewerState.html",'<content-provider-store active-dashboard="dashboardDataService.activeDashboard"></content-provider-store>'),e.put("views/states/rowLevelSecurityState.html","<row-level-security-container></row-level-security-container>"),e.put("views/taskPaneSliderView.html",'<div class="taskPaneSliderOverlay" ng-click="hideTaskPaneSliderOnClick()" ng-class="showOverlayClasses()"></div><div class="taskPaneSliderView" focus-trap focus-on-escape="hideTaskPaneSlider()" pbi-lazy-load-contents="::getModuleConfig()" keyboard-shortcuts="ctrl-F6" focus-nav-mode="Browser"><collapsible-pane view-model="viewModel.collapsiblePane" is-expander-hidden="viewModel.collapsiblePaneMode !== 0" ng-switch="viewModel.collapsiblePaneMode"><tile-editor ng-switch-when="1"></tile-editor><create-group-blade ng-switch-when="2" group-editor-mode="viewModel.collapsiblePaneMode"></create-group-blade><edit-group-blade ng-switch-when="3" group-editor-mode="viewModel.collapsiblePaneMode" parameters="viewModel.parameters"></edit-group-blade><view-group-blade ng-switch-when="4" group-editor-mode="viewModel.collapsiblePaneMode" parameters="viewModel.parameters"></view-group-blade><tile-gallery ng-switch-when="5"></tile-gallery><real-time-blade ng-switch-when="7"></real-time-blade><upn-mapping-pane ng-switch-when="8"></upn-mapping-pane><streaming-dataset-editor ng-switch-when="10" from="viewModel.previousMode"></streaming-dataset-editor><streaming-dataset-push-info ng-switch-when="11"></streaming-dataset-push-info><settings-blade ng-switch-when="12"></settings-blade><streaming-dataset-gallery ng-switch-when="13"></streaming-dataset-gallery><pub-nub-editor ng-switch-when="14" from="viewModel.previousMode"></pub-nub-editor><subscription-pane ng-switch-when="15"></subscription-pane><capacity-migrate-workspaces ng-switch-when="16"></capacity-migrate-workspaces><capacity-settings-editor ng-switch-when="18"></capacity-settings-editor><ng-container ng-switch-when="19"><edit-my-workspace-blade ng-if="!$ctrl.useModernEditMyWorkspaceBlade" group-editor-mode="viewModel.collapsiblePaneMode" parameters="viewModel.parameters"></edit-my-workspace-blade><downgraded-edit-my-workspace-blade ng-if="$ctrl.useModernEditMyWorkspaceBlade" group-editor-mode="viewModel.collapsiblePaneMode" [parameters]="viewModel.parameters"></downgraded-edit-my-workspace-blade></ng-container><instant-email-pane ng-switch-when="22"></instant-email-pane><capacity-change-pane ng-switch-when="24"></capacity-change-pane><capacity-workspace-admin-pane ng-switch-when="25" workspace="viewModel.parameters"></capacity-workspace-admin-pane><folder-permissions-edit-blade ng-switch-when="29" parameters="viewModel.parameters"></folder-permissions-edit-blade><theme-pane ng-switch-when="30"></theme-pane><capacity-auto-scale-pane ng-switch-when="31"></capacity-auto-scale-pane></collapsible-pane></div>'),e.put("views/tiles/compositeTile.html",'<div class="compositeTile" ng-class="{ fullLayout: viewModel.config.layoutType === 1 }"><div class="visualTile"><downgraded-visual-modern ng-if="$ctrl.readyToRender()" [view-model]="viewModel.visual" [allow-deferred-rendering]="::allowDeferredRendering" supports-screen-reader="true" (visual-ready)="$ctrl.onVisualDataChanged()"></downgraded-visual-modern></div></div>'),e.put("views/tiles/dashboardTile.html",'<li class="dashboardTile baseTile" in-viewport="onceInViewport()" in-viewport-context="{{::viewportContextSelector}}" in-viewport-offset="100%" ng-class="{selected: model.isSelected || hasSpotlight(), readonly: isReadOnly(), nonActionable: isNonActionable(), hasSpotlight: hasSpotlight()}" ng-click="$event.stopPropagation()" accessible-click="openTile(disablePointerEvents, $event)" tabindex="{{disableKeyboardNav && !(model.isSelected || hasSpotlight()) ? -1 : 0}}" ng-mouseenter="setHover(true)" ng-mouseleave="setHover(false)" ng-focus="setHover(true)" ng-attr-aria-label="{{getTileAriaLabel()}}"><dashboard-tile-open-options ng-if="displayDashboardTileOpenOptions()" model="model"></dashboard-tile-open-options><div ng-if="inViewport" class="tileWrapper" ng-switch="viewModel.isLocked"><div ng-switch-when="false" ng-style="viewModel.tileStyles" class="dashboardTileLayout"><section ng-if="::(inEditMobileLayoutMode || displayDashboardTileShowIcon())"> <button ng-click="addTileToMobileView()" class="tileAction pinTile glyphicon pbi-glyph-pinned glyph-small showTileIcon" localize-tooltip="DashboardTile_ToggleVisibility" ng-if="displayDashboardTileShowIcon()"></button> <button ng-click="removeTileFromMobileView()" class="tileAction unpinTile glyphicon pbi-glyph-unpin glyph-small" localize-tooltip="DashboardTile_unpinTile" ng-if="::(!displayDashboardTileShowIcon())"></button></section><a class="urlTile" ng-attr-href="{{viewModel.href}}" ng-attr-target="{{viewModel.hrefTarget}}" rel="noopener noreferrer" draggable="false"><tile view-model="viewModel" in-edit-mobile-layout-mode="inEditMobileLayoutMode" disable-pointer-events="{{::disablePointerEvents}}" header-click-target="openNotification ? openNotifications(event) : openTile(true, event)"></tile></a></div><div ng-switch-when="true" class="permissionLockedTileWrapper"><div class="permissionLockedTileContainer" ng-switch="refreshingPermissions"><loading-tile ng-switch-when="true" [message-key]="\'PermissionCenter_LoadingTile\'"></loading-tile><permission-locked-tile ng-switch-when="false"></permission-locked-tile></div></div></div><div ng-if="viewModel.shouldNewBadgeAppear" class="newBadgeContainer" localize="New_Capitalized"></div></li>'),e.put("views/tiles/dashboardTileOpenOptions.html",'<div class="moreOptions" ng-style="viewModel.tileBackground" focus-nav-mode="Group" keyboard-shortcuts="alt-shift-F10 scoped"><tile-options-menu is-read-only="isReadOnly()" model="model" view-model="viewModel" can-export="canExport" is-tile-in-error="isTileError" is-tile-openable="isOpenable()"></tile-options-menu></div>'),e.put("views/tiles/dashboardTileWrapper.html",'<dashboard-tile view-model="viewModel" can-edit="canEdit" disable-interactions="disableInteractions" add-tile-to-mobile-view="addTileToMobileView()" in-edit-mobile-layout-mode="inEditMobileLayoutMode" disable-pointer-events="disablePointerEvents" viewport-context-selector="viewportContextSelector"></dashboard-tile>'),e.put("views/tiles/reportTile.html",'<div class="explorationContainer reportTile"><downgraded-exploration ng-if="reportTilesPopulated && !viewModel.isError" [view-model]="viewModel.exploration" [disable-print]="true"></downgraded-exploration><error-placeholder ng-if="viewModel.isError" [error-text]="viewModel.errorText"></error-placeholder></div>'),e.put("views/tiles/tile.html",'<div class="tile baseTile tilePosition" ng-class="{ noTitle: !viewModel.hasTitle(), largeHeader:largeHeader, noSubtitle: !viewModel.hasSubtitle() && viewModel.hasTitle() }"><div class="item-auto" ng-if="::(viewModel.type === 1 && !viewModel.hasTitle())"><div class="webContentCorner"></div> <button class="webContentIcon" localize-tooltip="WebContentWarning_Widget" ng-click="onIconClick(getWebContentIcon(), $event)"><i class="glyphicon pbi-glyph-securityalert glyph-small"></i></button></div><ng-container ng-if="viewModel.composite && viewModel.composite.licenseUIManager"><downgrade-license-blocker ng-if="shouldDisplayLicenseBlocker" visual-type="{{visualType}}" tile-object-id="{{viewModel.contract.objectId}}"></downgrade-license-blocker><downgrade-license-environment-blocker ng-if="shouldDisplayLicenseEnvironmentBlocker" visual-type="{{visualType}}"></downgrade-license-environment-blocker><downgrade-license-banner ng-if="shouldDisplayFeatureBlockedBanner" feature-blocked-tooltip="{{viewModel.composite.licenseUIManager.featureBlockedTooltip}}" [should-start-banner-leave-animation]="shouldStartBannerLeaveAnimation" (is-animation-done)="viewModel.composite.licenseUIManager.clearBanner()" visual-type="{{visualType}}"></downgrade-license-banner></ng-container><header class="flexbox" ng-class="{ sensitivityBanner: (hasSensitivityBanner && !hasExpandSensitivityBanner), sensitivityBannerExpanded: hasExpandSensitivityBanner }"><triggered-recompile trigger="refreshIconsTrigger"> <button ng-repeat="icon in ::getIcons()" class="item-auto {{::icon.itemClass}}" ng-if="::icon.show()" title="{{::icon.tooltip()}}" ng-click="onIconClick(icon, $event)"><i class="glyphicon glyph-small {{::icon.iconClass}}"></i><span class="badge" ng-if="::icon.hasBadge" ng-bind="icon.badgeValueSetter()"></span></button></triggered-recompile><div class="headerText unselectable" ng-click="headerClickTarget({event: $event})"><section ng-class="{ headerTitleWrapper: !showCommentIndicator() }"><div class="displayText" ng-style="viewModel.tileHeaderStyles" ng-bind="viewModel.getDisplayText()" title="{{viewModel.getDisplayText()}}"></div><div class="flexbox subDisplayTextWrapper"><span class="subDisplayText item-auto first-part" ng-style="viewModel.tileHeaderStyles" ng-bind="viewModel.getSubDisplayText()" title="{{viewModel.getSubDisplayText()}}"></span> <span class="subDisplayText item-auto" ng-style="viewModel.tileHeaderStyles" ng-show="viewModel.shouldPlaceBulletSeperator()">•</span><span class="subDisplayText" ng-style="viewModel.tileHeaderStyles" bind-text-and-tooltip="viewModel.lastRefreshTimeInLocaleWithLabel()"></span></div></section> <button class="item-auto commentIndicator" ng-if="showCommentIndicator()" ng-click="selectTileConversations($event)" title="{{showConversationsToolTip()}}"><i class="glyphicon glyph-small pbi-glyph-comment"></i></button></div></header><section><div class="loadingPlaceholder" ng-if="viewModel.isTileLoading"><div class="loadingPlaceholderText glyphicon pbi-glyph-powerbi glyph-large"></div></div><div ng-show="!viewModel.isTileLoading && shouldShowTileVisual()" class="tileBody unselectable" ng-class="::{nonInteractive: disablePointerEvents}" ng-style="contentStyleWithSensitivity()" ng-switch on="::{{viewModel.type}}"><composite-tile view-model="viewModel.composite" ng-switch-when="0" allow-interactivity="{{::allowInteractivity}}" on-clear-tile-error="onClearTileError()"></composite-tile><iframe-tile [view-model]="viewModel.iframe" [embed-code]="viewModel.iframe.embedCode" ng-switch-when="1"></iframe-tile><image-tile [image-url]="viewModel.image.imageUrl" alt-text="{{::altText}}" ng-attr-title="{{viewModel.displayText}}" ng-switch-when="2"></image-tile><model-tile [view-model]="viewModel.model" ng-switch-when="3"></model-tile><ssrs-tile [image-url]="viewModel.ssrs.imageUrl" ng-switch-when="4"></ssrs-tile><workbook-tile ng-if="!modernWorkbookTile" view-model="viewModel.workbook" ng-switch-when="5"></workbook-tile><workbook-modern-tile ng-if="modernWorkbookTile" [view-model]="viewModel.workbook.contract" [config]="viewModel.workbook.tileModel.config" ng-switch-when="5"></workbook-modern-tile><div pbi-lazy-load-contents="moduleConfig" ng-switch-when="6" ng-if="!modernReportTile"><report-tile view-model="viewModel.reportTile"></report-tile></div><div pbi-lazy-load-contents="moduleConfig" ng-switch-when="6" ng-if="modernReportTile"><report-modern-tile [contract]="viewModel.reportTile.contract" [config]="viewModel.reportTile.config"></report-tile-modern></div><ng-container ng-switch-when="8"><pbi-lazy-load-modern [module-path]="realTimeTileLazyPath" [component-id]="\'RealTimeTileComponentId\'" [input-args]="realTimeTileModernInputArgs" [output-args]="realTimeTileModernOutputArgs"></pbi-lazy-load-modern></ng-container></div><error-placeholder ng-if="!shouldShowTileVisual()" [error-text]="errorText" [error-details]="errorDetails" [tile-type]="viewModel.type"></error-placeholder></section></div>'),e.put("views/tiles/tileWrapper.html",'<tile view-model="viewModel" in-edit-mobile-layout-mode="inEditMobileLayoutMode" header-click-target="headerClickTarget()" disable-pointer-events="{{disablePointerEvents}}" allow-interactivity="{{!!allowInteractivity}}" large-header="largeHeader"></tile>'),e.put("views/tiles/workbookTile.html",'<div class="workbookTile" ng-class="{hasTitle: title}" ng-switch="useLiveEwaControl"><iframe ng-src="{{::workbookTileUrl}}" role="presentation" ng-switch-when="true"></iframe><printable-image source="{{viewModel.dynamicImageUrl}}" disable-animation="true" ng-class="{backgroundOriginalSize: viewModel.keepOriginalContentSize}" ng-switch-when="false"></printable-image> <img class="internalWorkbookTileImage" name="internalWorkbookTileImage" ng-src="{{viewModel.previewImageUrl}}" ng-hide="true"/></div>'),e.put("views/waterMarkMessage.html",'<div class="waterMarkMsg unselectable"><i class="glyphicon" ng-class="{true: \'pbi-glyph-error glyph-med\', false: \'pbi-glyph-warning glyph-med warningIcon\'}[config.mode]"></i><div ng-if="config.imgClass" ng-class="config.imgClass"></div><div ng-switch="config.canEdit"><div ng-switch-when="true"><h2 class="title" ng-bind="config.titleNonShared"></h2><p class="content" ng-bind="config.contentNonShared"></p></div><div ng-switch-when="false"><h2 class="title" ng-bind="config.titleShared"></h2><p class="content" ng-bind="config.contentShared"></p><p ng-bind="config.contact"></p></div></div><p ng-if="config.linkAction" role="alert"><span class="linkDescription" ng-bind="config.linkDescription"></span><a ng-click="config.linkAction()" ng-bind="config.linkText" href="javascript:void(0)"></a></p><pbi-button ng-if="config.btnClick" label="{{config.btnLabelKey}}" localize-tooltip="{{config.btnLabelKey}}" ng-click="config.btnClick()" primary="true"></pbi-button></div>'),e.put("views/workbookAppBar.html",'<div class="workbookAppBarContent appBar trimmedTextWithEllipsis unselectable appThemeable"><div class="appBarSection left"><ul><li ng-if="isAppNavToggleEnabled"><pbi-lazy-load-modern [module-path]="appConsumptionLazyLoadPath" [component-id]="appConsumptionNavPaneToggleLazyComponentId"></pbi-lazy-load-modern></li><li ng-if="::isBackButtonEnabled"> <button ng-click="navigateBack()"><i class="glyphicon pbi-glyph-pageleft"></i></button></li><li class="workbookAppBarItemNotClickable"><span class="excelOnlineText" localize="WorkbookAppBar_ExcelOnline"></span></li><li class="appBarDivider"></li><li class="edit-menu" ng-class="{workbookAppBarItemNotClickable: !isEditEnabled()}"> <button dropdown-menu dropdown-items="editMenuActions" dropdown-class="workbookAppBarMenu appThemeable" dropdown-dark-theme="viewModeState.getMode() === 0" dropdown-on-item-selected="editMenuActionSelected(selected)" ng-disabled="!isEditEnabled()" localize-tooltip="{{getEditButtonTooltipLocId()}}" dynamic-tooltip-update tabindex="0"><span localize="WorkbookAppBar_EditButton"></span><i class="glyphicon pbi-glyph-chevrondownmedium glyph-mini"></i></button></li></ul></div><div class="appBarSection right"><ul><li class="rightFloatedItem"></li><li ng-switch="getRefreshDataStatus()" class="appBarText refreshStatus workbookAppBarItemNotClickable"><div ng-switch-when="0"><span ng-bind="refreshInformationText"></span></div><div ng-switch-when="1"> <button ng-click="showRefreshHistory()"><i class="glyphicon pbi-glyph-warning"></i></button><span ng-bind="refreshInformationText"></span></div></li><li class="reload" ng-class="{workbookAppBarItemNotClickable: !isWorkbookLoaded()}"> <button ng-disabled="!isWorkbookLoaded()" ng-click="reloadClicked()"><i class="glyphicon pbi-glyph-refresh"></i><span localize="Reload"></span></button></li><li class="data-menu" id="data" ng-class="{workbookAppBarItemNotClickable: !isWorkbookLoaded()}"> <button ng-disabled="!isWorkbookLoaded()" dropdown-menu dropdown-items="dataMenuActions" dropdown-class="workbookAppBarMenu" dropdown-on-item-selected="dataMenuActionSelected(selected)" tabindex="0"><i class="glyphicon pbi-glyph-dataset"></i><span localize="WorkbookAppBar_DataButton"></span><i class="glyphicon pbi-glyph-chevrondownmedium glyph-mini"></i></button></li><li ng-class="{workbookAppBarItemNotClickable: !isPinToDashboardEnabled()}"> <button class="pinToDashboard" ng-disabled="!isPinToDashboardEnabled()" ng-click="pinClicked()" localize-tooltip="{{getPinButtonTooltipLocId()}}" dynamic-tooltip-update><i class="glyphicon pbi-glyph-pinned"></i><span localize="WorkbookAppBar_PinWorkbookElementButton"></span></button></li><pbi-lazy-load-modern ng-if="inAppArtifactView()" [module-path]="artifactActionLazyLoadPath" [component-id]="appActionMenuLazyComponentId"></pbi-lazy-load-modern></ul></div></div>'),e.put("views/workbookContainer.html",'<div id="workbookContainerWrapper" class="workbookContainerContent"><workbook-discoverability-toast class="discoverabilityToast"></workbook-discoverability-toast><workbook-app-bar view-model="viewModel" ng-if="workbookAppBarIncluded"></workbook-app-bar><notification-bar></notification-bar><spinner class="centeredSpinner" ng-show="!isEmbeddedWorkbookReady && !embeddedWorkbookFailed"></spinner><iframe name="workbookEWAIsolation" class="workbookEWAIsolation" src="/ewaIsolation.cshtml" ng-if="isEmbeddedWorkbookDataReady" ng-class="{\'fullSizeFrame\': !workbookAppBarIncluded }"></iframe></div>'),e.put("views/workbookDiscoverabilityToast.html",'<div class="workbookDiscoverabilityToast" ng-show="viewModel.showDiscoverabilityToast"><div class="arrow"></div><div class="title" localize="WorkbookPinDiscoverability_Title"></div><div class="message" localize="WorkbookPinDiscoverability_Message"></div><div class="gotItBtn"><pbi-button label="TutorialPopup_GotIt" primary="true" ng-click="dismissToast()"></pbi-button></div><i class="glyphicon pbi-glyph-pinned"></i></div>')}})(powerbi=powerbi||{}),(function(v){var T=powerbi.common,t=powerbi.htmlTemplate.put;function e(){var e;o||(window.dashboardDefined&&powerbi.dashboard.initializeAngularModule(),angular.module("powerbi.components",[]),angular.module("powerbi.controllers",[]),angular.module("powerbi.directives",[]),angular.module("powerbi.filters",[]),e=["angularFileUpload","powerbi.common","powerbi.common.directives","powerbi.connectivity","powerbi.components","powerbi.controllers","powerbi.dashboard","powerbi.directives","powerbi.filters","powerbi.visualHost","powerbi.dataServices","ngSanitize","powerbi.explore"],window.gatewaysModuleDefined&&e.push("powerbi.gateways"),window.userNotificationsModuleDefined&&e.push("powerbi.userNotifications"),angular.module("powerbi",e).config(["$compileProvider",function(e){e.aHrefSanitizationWhitelist(new RegExp(e.aHrefSanitizationWhitelist().source+"|^s*(data):"))}]).config(["lazyProvider",function(e){e=e.factories;e.errorFormat={source:{javascript:"PowerBI/services/errorFormat"},ng:["localizationService"],fn:function(e,t){return e.create(t)}},e.previewFeatures={source:{javascript:"Settings/services/previewFeatures"},ng:["$window","telemetryService","tutorialDataStore"],fn:function(e,t,o,i){return e.create(t,o,i)}},e.embedCodesService={source:{javascript:"EmbedCodes/services/embedCodesService"},ng:["reportService","telemetryService","errorService","localizationService","modelService","promiseFactory","modalDialogService","featureSwitchService","tenantSettingService"],modular:["embed","embedProxy"],fn:function(e,t,o,i,r,a,n,s,l,c,d,p){return e.create(t,p,o,i,r,a,n,d,s,l,c)}},e.embed={source:{javascript:"EmbedCodes/services/embedService"},ng:["$location","promiseFactory","featureSwitchService","dataReaderProvider","explorationSerializer","conceptualSchemaProxy","dataProxy","displayNameService","visualPlugin","aggrOps","telemetryService","activeFolderId","navigation","visualTimeSynchronizationService","localizationService","userInfo","embedModeService","licenseEnforcementService"],fn:function(e,t,o,i,r,a,n,s,l,c,d,p,u,h,g,v,m,b,f,y,S){var w=powerbi.explore.services.createVisualPluginOps(c,i),D=powerbi.explore.services.createVisualRelationshipService(c,w,y,i,S),y=powerbi.explore.services.createSortService(l,i,c),f=powerbi.explore.services.createScriptVisualsService(c,i,v,m,b,f),f=powerbi.explore.services.createFilterGenerator(T.createEventBridge(),c,d,D,{getSelectedHostFilters:function(){return null}},p,f,i,S),S=powerbi.data.transforms.createTransformPluginService(),v=powerbi.explore.services.createVisualQueryGenerator({dataReaders:r,displayNameService:l,featureSwitchService:i,plugin:c,pluginOps:w,sortService:y,aggrOps:d,filterGenerator:f,transformPluginService:S,telemetryService:p,visualTimeSynchronizationService:g,localizationService:v});return e.create(t,o,a,n,v,s,c,l,f,u,h)}},e.embedProxy={source:{javascript:"EmbedCodes/proxies/embedProxy"},ng:["activeFolderId","httpService","promiseFactory","localizationService"],fn:function(e,t,o,i,r){return e.create(t,o,i,r)}}}]).factory("modelConverter",["telemetryService","downgradedUrlBuilder","errorService","visualPlugin","promiseFactory","geolocationService","dataServiceModelConverter","localizationService",function(e,t,o,i,r,a,n,s){return powerbi.models.createModelConverter(e,t,o,i,r,a,n,s)}]).factory("modelMerger",["modelConverter","dataServiceModelMerger","permissionService",function(e,t,o){o=powerbi.models.createModelMerger(e,t,o);return e.setModelMerger(o),o}]).service("navigationActions",["$rootScope","contentPackService","featureSwitchService","localizationService","modelService","navigation","packageService","quota","reportService","workbookService","ownership","modernDialogService","lazyProviderModern","contentPackStore","downgradedRouterUtilities",function(e,t,o,i,r,a,n,s,l,c,d,p,u,h,g){return v.services.createNavigationActions(e,t,o,i,r,a,n,s,l,c,d,p,u,h,g)}]).factory("historyDialogService",["$rootScope","$compile",function(e,t){return powerbi.createHistoryDialogService(e,t)}]).factory("folderServiceLegacy",["$rootScope","$timeout","telemetryService","errorService","localizationService","groupHttp","activeFolderIdLegacy","featureSwitchService","userInfo","profileImageService","reportService","modelService","promiseFactory","navigation","workbookService","packageService","appMetadataService","featuredDashboard","appService","groupStore","dashboardDataService",function(e,t,o,i,r,a,n,s,l,c,d,p,u,h,g,v,m,b,f,y,S){return powerbi.createFolderService({rootScope:e,timeout:t,telemetryService:o,errorService:i,localizationService:r,groupHttpService:a,activeFolderIdService:n,featureSwitchService:s,userInfo:l,profileImageService:c,appService:f,reportService:d,modelService:p,promiseFactory:u,navigation:h,workbookService:g,packageService:v,appMetadataService:m,featuredDashboard:b,groupStore:y,dashboardDataService:S})}]).factory("dashboardService",["$rootScope","navigation","$timeout","telemetryService","errorService","modelMerger","modelConverter","syncService","dashboardDataService","dashboardHttpService","dashboardSyncService","lazyProviderModern","localizationService","promiseFactory","reportService","viralTenantMergeHelperService","folderService","featureSwitchService","modelService","storageUsageService","appMetadataService","workbookService","notificationToast","resourcePackagesService","userSettingsService","visualPlugin","featuredDashboard","userActivityContextService","editableFeatureSwitchService","fileSaver","shellCapabilities","dashboardStore","permissionRefresh","globalEventBridge","resourcePackageListenerService","modernDialogService","informationProtectionService","informationProtectionArtifactService","$injector",function(e,t,o,i,r,a,n,s,l,c,d,p,u,h,g,v,m,b,f,y,S,w,D,T,C,k,P,E,I,M,A,R,N,_,F,x,L,B,O){return new powerbi.DashboardService(e,t,o,i,r,a,n,s,l,c,d,p,u,h,g,v,m,b,f,y,S,w,D,T,C,k,P,E,I,M,A,R,N,_,F,x,L,B,O)}]).factory("contentPackHttpService",["httpService",function(e){return new powerbi.ContentPackHttpService(e)}]).factory("sharePointHttp",["$window","featureSwitchService","telemetryService","localizationService","errorService","promiseFactory","httpService",function(e,t,o,i,r,a,n){return powerbi.proxies.createSharePointHttpService(e,t,o,i,r,a,n)}]).factory("contentPackService",["$rootScope","appService","errorService","telemetryService","modelConverter","localizationService","navigation","dashboardDataService","userInfo","reportService","modelService","permissionService","workbookService","promiseFactory","quota","modalDialogService","folderService","licenseEnforcementService","moduleLoader","contentPackStore","contentPackHttpService","globalEventBridge","licenseHelperService","modernDialogService","featureSwitchService",function(e,t,o,i,r,a,n,s,l,c,d,p,u,h,g,v,m,b,f,y,S,w,D,T,C,k){return powerbi.createContentPackService(e,t,o,i,r,a,n,s,l,c,d,p,u,h,g,v,m,b,f,y,S,w,D,T,C,k)}]).factory("pinTileServiceLegacy",["$rootScope","errorService","telemetryService","localizationService","modalDialogService","modelConverter","visualPlugin","userSettingsService","reportService","modelService","workbookService","dashboardService","packageService","explorationSerializer","promiseFactory","lazyProviderModern","featureSwitchService","usageMetricsReport","$interval","permissionService","appService","contentPackService","contentProviderHttpService","navigation","folderService","globalEventBridge","activeFolderId","resourcePackageCopyService",function(e,t,o,i,r,a,n,s,l,c,d,p,u,h,g,v,m,b,f,y,S,w,D,T,C,k,P,E){return powerbi.createPinTileService(e,t,o,i,r,a,n,s,l,c,d,p,u,h,g,v,m,b,f,y,S,w,D,T,C,k,P,E)}]).factory("inFocusService",["$rootScope","localizationService",function(e,t){return v.services.createInFocusService(e,t)}]).factory("relatedService",["dashboardDataService","modelService","reportService","usageMetricsReport","workbookService","featureSwitchService","folderService",function(e,t,o,i,r,a,n){return powerbi.services.createRelatedService(e,t,o,i,r,a,n)}]).run(["lazyScopedFactories",function(e){e.exportToFile={source:{javascript:"PowerBI/services/exportToFileService"},ng:["telemetryService","notificationToast","errorService","localizationService","modalDialogService","$rootScope","fileSaver","licenseEnforcementService","approvedResourceService","httpService","timeoutService","featureSwitchService"],fn:function(e,t,o,i,r,a,n,s,l,c,d,p,u){return e.create(t,o,i,r,a,n,s,l,c,d,p,u)}}}]).run(["localizationService","httpService",function(e,t){var o=window.powerbi;o.common.localize=e,o.common.httpService=t,powerbi.explore.services.VisualHostServices.initialize(e)}]).run(["folderService",function(e){}]).run(["licenseEnforcementService",function(e){}]).run(["$templateCache",t]),o=!0)}v.initializeAngularModule=e,v.registerController=function(e,t){void 0===t&&(t=[]);var o="powerbi.controllers."+e,i=((i=v.ensurePowerbi()).controllers||(i.controllers={}),i.controllers);t.push(i[e]),angular.module("powerbi.controllers").controller(o,t)},v.getService=function(e,t){return t=_.camelCase(t),e.get(t)};var o=!(v.registerBuildingBlocksForHost=function(e){var t=[{name:"ArtifactSelection",blockType:2,consumerHostFlags:8,factory:powerbi.components.ArtifactSelection},{name:"AppLogo",blockType:2,consumerHostFlags:8,factory:powerbi.components.AppLogo},{name:"AppPlaceholder",blockType:2,consumerHostFlags:8,factory:powerbi.components.AppPlaceholder},{name:"AuthoringDropDownMenu",blockType:2,consumerHostFlags:8,factory:powerbi.components.AuthoringDropDownMenu},{name:"CollapsiblePane",blockType:1,consumerHostFlags:1192,factory:powerbi.directives.CollapsiblePane},{name:"CompositeTile",blockType:1,consumerHostFlags:168,factory:powerbi.directives.CompositeTile},{name:"ContentProviderSplash",dependencies:["telemetryService","navigation","featureSwitchService","downgradedRouterUtilities"],blockType:1,consumerHostFlags:8,factory:powerbi.directives.ContentProviderSplash},{name:"ContextMenu",dependencies:["rtl","windowMetrics"],blockType:1,consumerHostFlags:168,factory:powerbi.directives.ContextMenu},{name:"Dashboard",dependencies:["telemetryService","gridLayout","userActivityContextService","appService","userInfo","$timeout","folderService","dashboardLoadingProgressTracking","modelService","permissionService","usageMetricsReport","asyncFeatureSwitchService","packageService","informationProtectionService","artifactEndorsementService","globalEventBridge"],blockType:1,consumerHostFlags:168,factory:powerbi.directives.Dashboard},{name:"DashboardContainer",blockType:1,consumerHostFlags:168,factory:powerbi.directives.DashboardContainer},{name:"DashboardContainerInner",blockType:1,consumerHostFlags:168,factory:powerbi.directives.DashboardContainerInner},{name:"DashboardTile",blockType:1,consumerHostFlags:168,factory:powerbi.directives.DashboardTile},{name:"DashboardTileOpenOptions",blockType:1,consumerHostFlags:8,factory:powerbi.directives.DashboardTileOpenOptions},{name:"DashboardTileWrapper",blockType:1,consumerHostFlags:168,factory:powerbi.directives.DashboardTileWrapper},{name:"DashboardWrapper",blockType:1,consumerHostFlags:168,factory:powerbi.directives.DashboardWrapper},{name:"ClassificationLabel",blockType:2,consumerHostFlags:8,factory:powerbi.components.ClassificationLabel},{name:"ExcelUploadFormat",blockType:1,consumerHostFlags:8,factory:powerbi.directives.ExcelUploadFormat},{name:"FlyoutToggle",dependencies:["$window","$timeout"],blockType:1,consumerHostFlags:8,factory:powerbi.directives.FlyoutToggle},{name:"GroupIcon",blockType:2,consumerHostFlags:8,factory:powerbi.components.GroupIcon},{name:"HistoryDialog",blockType:1,consumerHostFlags:8,factory:powerbi.directives.HistoryDialog},{name:"InFocus",dependencies:["promiseFactory","globalEventBridge","featureSwitchService"],blockType:1,consumerHostFlags:168,factory:powerbi.directives.InFocus},{name:"InsufficientLicenseBar",blockType:2,consumerHostFlags:8,factory:powerbi.components.InsufficientLicenseBar},{name:"Landing",blockType:2,consumerHostFlags:8,factory:powerbi.components.Landing},{name:"LandingContainer",blockType:1,consumerHostFlags:8,factory:powerbi.directives.LandingContainer},{name:"LoadNotificationDialog",blockType:1,consumerHostFlags:8,factory:powerbi.directives.LoadNotificationDialog},{name:"MakeACopyDialog",blockType:2,consumerHostFlags:8,factory:powerbi.components.MakeACopyDialog},{name:"ManageEmbedView",blockType:1,consumerHostFlags:8,factory:powerbi.directives.ManageEmbedView},{name:"ManageEmbedViewInner",blockType:1,consumerHostFlags:8,factory:powerbi.directives.ManageEmbedViewInner},{name:"OnLoad",blockType:1,consumerHostFlags:168,factory:powerbi.directives.OnLoad},{name:"PinTileDialog",blockType:1,consumerHostFlags:8,factory:powerbi.directives.PinTileDialog},{name:"PinTileDialogInner",dependencies:["$timeout"],blockType:1,consumerHostFlags:8,factory:powerbi.directives.PinTileDialogInner},{name:"PopupNotificationDialog",blockType:2,consumerHostFlags:8,factory:powerbi.components.PopupNotificationDialog},{name:"PrintableImage",blockType:2,consumerHostFlags:168,factory:powerbi.components.PrintableImage},{name:"ReportTile",blockType:1,consumerHostFlags:168,factory:powerbi.directives.ReportTile},{name:"ReportTileInner",blockType:1,consumerHostFlags:168,factory:powerbi.directives.ReportTileInner},{name:"SelectButton",blockType:2,consumerHostFlags:8,factory:powerbi.components.SelectButton},{name:"SelectTileSort",blockType:2,consumerHostFlags:8,factory:powerbi.components.SelectTileSort},{name:"SharePointUrlInput",blockType:1,consumerHostFlags:8,factory:powerbi.directives.SharePointUrlInput},{name:"SharePointUrlModal",blockType:1,consumerHostFlags:8,factory:powerbi.directives.SharePointUrlModal},{name:"TaskPaneSlider",blockType:1,consumerHostFlags:1032,factory:powerbi.directives.TaskPaneSlider},{name:"Tile",blockType:1,consumerHostFlags:168,factory:powerbi.directives.Tile},{name:"TileWrapper",blockType:1,consumerHostFlags:65535,factory:powerbi.directives.TileWrapper},{name:"TileOptionsMenu",blockType:2,consumerHostFlags:168,factory:powerbi.components.TileOptionsMenu},{name:"UserInfoContainer",blockType:1,consumerHostFlags:168,factory:powerbi.directives.UserInfoContainer},{name:"WaterMarkMessage",blockType:1,consumerHostFlags:8,factory:powerbi.directives.WaterMarkMessage},{name:"WorkbookAppBar",blockType:1,consumerHostFlags:8,factory:powerbi.directives.WorkbookAppBar},{name:"WorkbookContainer",blockType:1,consumerHostFlags:8,factory:powerbi.directives.WorkbookContainer},{name:"WorkbookContainer",blockType:1,consumerHostFlags:8,factory:powerbi.directives.WorkbookContainer},{name:"WorkbookDiscoverabilityToast",blockType:1,consumerHostFlags:8,factory:powerbi.directives.WorkbookDiscoverabilityToast},{name:"WorkbookTile",dependencies:["networkAvailability","localizationService"],blockType:1,consumerHostFlags:168,factory:powerbi.directives.WorkbookTile}];T.registerBuildingBlocksForHost(e,t,{componentsTarget:"powerbi.components",directivesTarget:"powerbi.directives",filtersTarget:"powerbi.filters"})});e()})(powerbi=powerbi||{}),(function(i){var e,o,t,r;function a(e,t,o,i){this.titleRequired=!1,this.tile=e,this.explorationSerializer=t,this.visualPlugin=o,this.originalContract=angular.copy(e.contract),this.initialize(i)}e=i.models||(i.models={}),o=i.dataServices.constants,t=i.common.constants.tileActions,r=i.dataServices.models.Tile,a.prototype.initialize=function(r){return __awaiter(this,void 0,i.Promise,(function(){var t,o,i;return __generator(this,(function(e){switch(e.label){case 0:return(t=this.tile,this.workbookService=r,i=t.composite)?(this.defaultTitle=i.heading1||i.config.heading1,this.defaultSubtitle=i.config.heading3,t.displayText=t.displayText||this.defaultTitle,t.subDisplayText=t.subDisplayText||this.defaultSubtitle,[3,6]):[3,1];case 1:return t.reportTile?(this.defaultTitle=t.displayText,this.defaultSubtitle=t.subDisplayText,[3,6]):[3,2];case 2:return t.workbook?t.config&&t.config.workbookTile?(o=t.config.workbookTile.item,[4,r.findWorkbook(t.contract.workbookId)]):[3,4]:[3,6];case 3:return i=e.sent(),i=i.displayName,this.defaultTitle=r.getDefaultTileTitle(t.config.workbookTile,i),this.defaultSubtitle=r.getDefaultTileSubtitle(o),[3,5];case 4:this.defaultTitle=t.displayText,this.defaultSubtitle=t.subDisplayText,e.label=5;case 5:this.titleRequired=!0,e.label=6;case 6:return this.defaultTitle=this.defaultTitle||"",this.defaultSubtitle=this.defaultSubtitle||"",null==t.displayText&&(t.displayText=this.defaultTitle,t.subDisplayText=this.defaultSubtitle),this.hasTitle=t.hasTitle(),this.canAddOrRemoveCustomLink=!(!t.config||!t.config.widget)||!t.reportTile,[2]}}))}))},Object.defineProperty(a.prototype,"hasLastRefreshTime",{get:function(){return!!this.tile.contractsModel&&!this.tile.realTime},enumerable:!1,configurable:!0}),a.prototype.isCustomLinkValid=function(e){var t=this.tile.action;return!this.isCustomAction(t.action)||r.isValidUrl(t.targetUrl,e)},a.prototype.isDirty=function(){var e=this.tile,t=this.originalContract,o=e.action,i=t.$action,r=!1;return o&&i&&(r=o.action!==i.action||!!o.openInSameTab!=!!i.openInSameTab||o.targetUrl!==i.targetUrl),e.displayText!==t.displayText||e.subDisplayText!==t.subDisplayText||r||!_.isEqual(e.config,t.$config)||!(!(e.workbook&&t.$config&&t.$config.workbookTile)||_.isEqual(e.workbook.keepOriginalContentSize,t.$config.workbookTile.keepOriginalContentSize))},a.prototype.isTitleValid=function(){var e=this.tile.config;return!(this.titleRequired||this.tile.subDisplayText||e&&e.lastRefreshTimeEnabled)||!!this.tile.displayText},a.prototype.isValid=function(e){return this.isTitleValid()&&this.isCustomLinkValid(e)},a.prototype.canRestoreDefaults=function(){var e=this.tile,t=!1;e.workbook&&(t=!!e.workbook.keepOriginalContentSize);var o=!1;return e.config&&e.config.lastRefreshTimeEnabled&&(o=!0===e.config.lastRefreshTimeEnabled),e.displayText!==this.defaultTitle||e.subDisplayText!==this.defaultSubtitle||t||o||!_.isEmpty(e.action.targetUrl)||!0===this.tile.action.openInSameTab},a.prototype.restoreDefaults=function(){var e=this.tile;e.displayText=this.defaultTitle,e.subDisplayText=this.defaultSubtitle;var t=this.tile.action;t.openInSameTab=!1,t.targetUrl=null,this.setAction(null),e.workbook&&this.setKeepOriginalSizeProperty(o.workbook.defaultKeepOriginalContentSize);e=e.config;e&&(e.lastRefreshTimeEnabled&&(e.lastRefreshTimeEnabled=!1),e.hideTitle&&(e.hideTitle=!1))},a.prototype.isCustomAction=function(e){return e===t.custom.openUrlActionName},a.prototype.setAction=function(e){var t=this.tile.action;e?(t.originalAction||this.isCustomAction(t.action)||(t.originalAction=t.action),t.action=e):((e=t.originalAction)&&!this.isCustomAction(e)?t.action=e:this.isCustomAction(t.action)&&(t.action=null),delete t.originalAction,delete t.targetUrl)},a.prototype.undoChanges=function(){var e=this.tile,t=this.originalContract;this.hasTitle!==e.hasTitle()&&e.invalidateLayout(),e.contract=t,e.displayText=t.displayText,e.subDisplayText=t.subDisplayText,e.action=t.$action,e.config=t.$config,this.tile.workbook&&t.$config.workbookTile&&this.setKeepOriginalSizeProperty(t.$config.workbookTile.keepOriginalContentSize)},a.prototype.updateModelContract=function(){var e=this.tile,t=e.contract;t.displayText=e.displayText,t.subDisplayText=e.subDisplayText;var o=e.action;t.$action=o,t.action=JSON.stringify(o);o=e.config;e.workbook&&o.workbookTile&&(o.workbookTile.keepOriginalContentSize=e.workbook.keepOriginalContentSize),t.$config=o,t.config=i.dataServices.models.TileFactory.serializeTileConfig(o,this.explorationSerializer,this.visualPlugin)},a.prototype.setKeepOriginalSizeProperty=function(e){this.tile.workbook.keepOriginalContentSize=e,this.workbookService.setModelDynamicImageUrl(this.tile.workbook)},e.TileEditorModel=a})(powerbi=powerbi||{}),(function(e){var t,i,o;function r(e,t,o){return i.call(this,e,t,o)||this}t=e.models||(e.models={}),o=e.dataServices.models.Tile,i=t.TileEditorModel,__extends(r,i),r.prototype.isImageUrlValid=function(){var e=this.tile.image.imageUrl;return!!e&&(0<=e.indexOf("data:")||o.isValidUrl(e,!1))},r.prototype.isDirty=function(){var e=this.tile;return e.image.imageUrl!==e.config.imageTile.imageUrl||i.prototype.isDirty.call(this)},r.prototype.isValid=function(e){return this.isImageUrlValid()&&i.prototype.isValid.call(this,e)},r.prototype.undoChanges=function(){var e=this.tile;e.image.imageUrl=e.config.imageTile.imageUrl,i.prototype.undoChanges.call(this)},r.prototype.updateModelContract=function(){this.tile.config.imageTile.imageUrl=this.tile.image.imageUrl,i.prototype.updateModelContract.call(this)},t.EditImageWidgetModel=r})(powerbi=powerbi||{}),(function(e){var i;function t(e,t,o){return i.call(this,e,t,o)||this}e=e.models||(e.models={}),i=e.TileEditorModel,__extends(t,i),t.prototype.isDirty=function(){var e=this.tile;return e.iframe.srcUrl!==e.config.iframe.srcUrl||e.iframe.embedCode!==e.config.iframe.embedCode||i.prototype.isDirty.call(this)},t.prototype.isValid=function(e){return!!this.tile.iframe.embedCode&&i.prototype.isValid.call(this,e)},t.prototype.undoChanges=function(){var e=this.tile;e.iframe.srcUrl=e.config.iframe.srcUrl,e.iframe.embedCode=e.config.iframe.embedCode,i.prototype.undoChanges.call(this)},t.prototype.updateModelContract=function(){this.tile.config.iframe.srcUrl=this.tile.iframe.srcUrl,this.tile.config.iframe.embedCode=this.tile.iframe.embedCode,i.prototype.updateModelContract.call(this)},e.EditIframeWidgetModel=t})(powerbi=powerbi||{}),(function(r){var e,a,n;function t(e,t,o,i){e=a.call(this,e,o,i)||this,o=e.tile.composite.visual,i=o.visual;return i&&i.visualPlugin&&(i=i.visualPlugin.capabilities,o.dataViews||(o.dataViews=n.apply({prototype:void 0,objectDescriptors:i?i.objects:null,transforms:o.dataTransforms,colorAllocatorFactory:r.visuals.createColorAllocatorFactory(),dataRoles:null,visualStyle:r.visuals.visualStyles.create(),featureSwitches:t.featureSwitches}).dataViews)),e.originalDataTransforms=angular.copy(o.dataTransforms),e.originalDataViews=angular.copy(o.dataViews),e}e=r.models||(r.models={}),n=r.data.DataViewTransform,a=e.TileEditorModel,__extends(t,a),t.prototype.isDirty=function(){var e=this.tile.composite.visual.dataTransforms;return!_.isEqual(e,this.originalDataTransforms)||a.prototype.isDirty.call(this)},t.prototype.undoChanges=function(){var e=this.tile.composite.visual;e.dataTransforms=this.originalDataTransforms,e.dataViews=this.originalDataViews,e.visual&&e.visual.onDataChanged({dataViews:e.dataViews}),a.prototype.undoChanges.call(this)},t.prototype.updateModelContract=function(){this.tile.config.visualContainer.$visualContainer.config.singleVisual.objects=this.tile.composite.visual.dataTransforms.objects,a.prototype.updateModelContract.call(this)},e.EditTextWidgetModel=t})(powerbi=powerbi||{}),(function(e){var i;function t(e,t,o){return i.call(this,e,t,o)||this}e=e.models||(e.models={}),i=e.TileEditorModel,__extends(t,i),t.prototype.isVideoUrlValid=function(){return!!this.tile.iframe.srcUrl},t.prototype.isDirty=function(){var e=this.tile;return e.iframe.srcUrl!==e.config.iframe.srcUrl||i.prototype.isDirty.call(this)},t.prototype.isValid=function(e){return this.isVideoUrlValid()&&i.prototype.isValid.call(this,e)},t.prototype.undoChanges=function(){var e=this.tile;e.iframe.srcUrl=e.config.iframe.srcUrl,e.iframe.embedCode=e.config.iframe.embedCode,i.prototype.undoChanges.call(this)},t.prototype.updateModelContract=function(){var e=this.tile.config.iframe,t=this.tile.iframe;e.srcUrl=t.srcUrl,e.embedCode=t.embedCode,i.prototype.updateModelContract.call(this)},e.EditVideoWidgetModel=t})(powerbi=powerbi||{}),(function(e){var t;t=e.contracts||(e.contracts={}),(e=t.ExternalConnectionContainerType||(t.ExternalConnectionContainerType={}))[e.Report=0]="Report",(t=t.ExternalConnectionType||(t.ExternalConnectionType={}))[t.Model=0]="Model"})(powerbi=powerbi||{}),(function(e){(e=(e=(e=e.models||(e.models={})).factory||(e.factory={})).TileOptionsFactory||(e.TileOptionsFactory={})).realTimeConfigTabs=function(){return[{id:0,iconClass:"pbi-glyph-barchart",labelResource:"Role_DisplayName_Fields"},{id:1,iconClass:"pbi-glyph-paintbrush",labelResource:"Format"}]},e.getRealTimeTileEditHeaderTabs=function(e){return[{type:0,text:e.get("Realtime_VisualizationDesign")},{type:1,text:e.get("TileEditorPane_TileDetailsTabHeader")}]},e.getDashboardTileIcons=function(e,t){var o=e.localizationService;return[{iconClass:"pbi-glyph-securityalert",show:e.showWebContent,itemClass:"webContentIcon",tooltip:function(){return o.get("WebContentWarning_Widget")},action:2,hasBadge:!1},{iconClass:"pbi-glyph-warning",show:e.showWarning,itemClass:t?"showWarningIcon":"warningIcon",tooltip:e.warningToolTipSetter,action:1,hasBadge:!1},{iconClass:"pbi-glyph-bell",show:e.showNotifications,itemClass:"notifications",tooltip:function(){return o.get("Alerts_NotificationTooltip")},action:0,badgeValueSetter:e.badgeTextSetter,hasBadge:!0},{iconClass:"pbi-glyph-realtime",show:e.showRealTime,itemClass:"",tooltip:function(){return o.get("Realtime_IconHoverText")},hasBadge:!1}]}})(powerbi=powerbi||{}),(function(c){var e,t,i;function o(e,t,o,i,r,a,n){var s=this;this.telemetryService=e,this.dashboardLoadingProgressTrackingService=i,this.modelService=r,this.usageMetricsReport=a,this.scope=n,this.hasResolved=!1,this.unsubcribeTileRepeatFinishedEvent=n.$on(c.common.constants.dashboardTileRepeatFinishedEvent,(function(){return s.onDashboardTileRepeatFinishedEvent()})),this.dashboardLoadingProgressCallback=function(e){s.onDashboardLoadingCompleted(e)},this.dashboardLoadingProgressTrackingService.registerLoadingProgressCallback(this.dashboardLoadingProgressCallback)}e=c.helpers||(c.helpers={}),t=c.telemetry.OpenDashboardSource,i=c.dataServices.contracts.TileType,o.prototype.recordOpenDashboardEvent=function(e,t,o,i,r,a,n,s){var l;!e||this.openDashboardTelemetryEvent||this.hasResolved||(l=(this.dashboardModel=e).getPermissions(),this.openDashboardTelemetryEvent=this.telemetryService.startActivity(this.scope,c.telemetry.DashboardOpenDashboard,{hasResourcePackages:!1,hasOnPremiseModel:this.dashboardHasOnPremModel(e,this.modelService.models),compositeTilesCount:0,iframeTilesCount:0,imageTilesCount:0,modelTilesCount:0,ssrsTilesCount:0,workbookTilesCount:0,reportTilesCount:0,workbookTileNoImage:0,otherTileTypes:0,realTimeTilesCount:0,source:this.getDashboardOpenSource(),groupObjectId:o,isReadonlyGroup:r,permissions:l,usageMetricsTilesCount:0,CompoundTileTypesAndCounts:"{}",scrubUserInfo:a,isB2B:n,compositeTilesWithSystemErrorCount:0,endorsementStage:s,originalDashboardGuid:e.contract&&e.contract.originalDashboardObjectId,appGuid:t,serviceAppObjectId:i,dashboardGuid:e.objectId}),e.isLoaded&&_.isEmpty(e.tiles)&&this.resolveOpenDashboardTelemetry(e,!1))},Object.defineProperty(o.prototype,"OpenDashboardTelemetryEvent",{get:function(){return this.openDashboardTelemetryEvent},enumerable:!1,configurable:!0}),o.prototype.getDashboardOpenSource=function(){var e=jsCommon.QueryStringUtil.getQueryStringValue("openDashboardSource");return e?t[e]||t.Invalid:t.Normal},o.prototype.onDashboardTileRepeatFinishedEvent=function(){var e=this.dashboardModel;if(this.openDashboardTelemetryEvent){for(var t=0,o=0,i=e.tiles;o<i.length;o++)i[o].shouldBeIncludedInTelemetryMeasurement&&t++;this.loadDashboardTileTelemetryEvent=this.telemetryService.startChildEvent(this.openDashboardTelemetryEvent.event,c.telemetry.DashboardLoadDashboardTileVisual,{tileCount:t})}},o.prototype.onDashboardLoadingCompleted=function(e){for(var t=0,o=e.timedOutTiles;t<o.length;t++){var i=o[t],i=i.composite&&i.composite.visual&&i.composite.visual.type;this.telemetryService.logEvent(c.telemetry.DashboardLoadTileVisualTimedOut,{visualType:i})}this.resolveOpenDashboardTelemetry(e.model,e.isCancelled),this.recordLockedTilesDisplayedEvent(e.model)},o.prototype.resolveOpenDashboardTelemetry=function(e,t){var o;this.openDashboardTelemetryEvent&&(o=this.countTileTypes(e),!this.openDashboardTelemetryEvent.event||(e=this.openDashboardTelemetryEvent.event.info)&&(e.compositeTilesWithSystemErrorCount=o.compositeWithSystemError,e.hasResourcePackages=o.hasResourcePackages,e.compositeTilesCount=o.composite,e.iframeTilesCount=o.iframe,e.imageTilesCount=o.image,e.modelTilesCount=o.model,e.ssrsTilesCount=o.ssrs,e.workbookTilesCount=o.workbook,e.reportTilesCount=o.report,e.workbookTileNoImage=o.workbookNoImage,e.otherTileTypes=o.unknown,e.realTimeTilesCount=o.realTime,e.usageMetricsTilesCount=o.usageMetrics,e.CompoundTileTypesAndCounts=JSON.stringify(o.CompoundTileTypesAndCounts),t&&(e.isCancelled=!0)),this.loadDashboardTileTelemetryEvent&&this.loadDashboardTileTelemetryEvent.resolve(),0<o.compositeWithSystemError&&o.compositeWithSystemError===o.composite?this.openDashboardTelemetryEvent.reject():this.openDashboardTelemetryEvent.resolve(),this.openDashboardTelemetryEvent=null,this.loadDashboardTileTelemetryEvent=null,this.dashboardLoadingProgressTrackingService.unregisterLoadingProgressCallback(this.dashboardLoadingProgressCallback),this.hasResolved=!0,this.unsubcribeTileRepeatFinishedEvent())},o.prototype.countTileTypes=function(e){var t={compositeWithSystemError:0,composite:0,iframe:0,image:0,model:0,realTime:0,ssrs:0,workbook:0,workbookNoImage:0,report:0,unknown:0,hasResourcePackages:!1,usageMetrics:0,CompoundTileTypesAndCounts:{}};if(_.isEmpty(e.tiles))return t;for(var o=0,i=e.tiles;o<i.length;o++){var r=i[o];this.incTileTypeCount(r,t),!t.hasResourcePackages&&r&&r.contract&&!_.isEmpty(r.contract.resourcePackageIds)&&(t.hasResourcePackages=!0)}return t},o.prototype.incTileTypeCount=function(e,t){switch(e.type){case i.composite:t.composite++;var o=e&&e.composite&&e.composite.errorDetails;o&&"PowerBI"===o.source&&t.compositeWithSystemError++,this.usageMetricsReport.fromUsageMetrics(e.report)&&t.usageMetrics++;o=e.config&&e.config.visual&&e.config.visual.visual?e.config.visual.visual:"undefined";t.CompoundTileTypesAndCounts[o]||(t.CompoundTileTypesAndCounts[o]=0),t.CompoundTileTypesAndCounts[o]++;break;case i.iframe:t.iframe++;break;case i.image:t.image++;break;case i.realTime:t.realTime++;break;case i.model:t.model++;break;case i.ssrs:t.ssrs++;break;case i.workbook:e.workbook?e.workbook.hasImages()&&t.workbook++:t.workbookNoImage++;break;case i.report:t.report++,this.usageMetricsReport.fromUsageMetrics(e.report)&&t.usageMetrics++;break;default:t.unknown++}},o.prototype.dashboardHasOnPremModel=function(e,t){e=e.contract.modelIds;if(_.isEmpty(e))return!1;for(var o={},i=0,r=t;i<r.length;i++){var a=r[i];a.vsName!==c.common.constants.onPremiseVSName||null!=(a=a.id)&&(o[a]=a)}for(var n=0,s=e;n<s.length;n++)if(o[s[n]])return!0;return!1},o.prototype.recordLockedTilesDisplayedEvent=function(e){var t;_.isEmpty(e.tiles)||(t=_.filter(e.tiles,(function(e){return 20===e.errorCode})),_.isEmpty(t)||this.telemetryService.logEvent(c.telemetry.DashboardLockedTilesDisplayed,{dashboardObjectId:e.objectId,numberOfLockedTiles:t.length,numberOfAllTiles:e.tiles.length,objectIdsOfLockedTiles:JSON.stringify(_.map(t,(function(e){return e.objectId})))}))},e.DashboardTelemetryHelper=o})(powerbi=powerbi||{}),(function(e){var t,o,i,r,a,n,s,l,c,d,p,u,h,g;function v(e,t,o){void 0===t&&(t=!1),this.columnName=e,this.reverse=t,this.toAngularFilter=o,this.toAngularFilter=o||this.toAngularFilterDefault}function m(e){return c(e),r}function b(e,t){var o;switch(e){case i.TitleAlphabeticalPredicate:o=t.get("Sort_Title_Alpabetical_Asc");break;case i.TitleReverseAlphabeticalPredicate:o=t.get("Sort_Title_Alpabetical_Desc");break;case i.OwnerAlphabeticalPredicate:case i.OwnerInfoAlphabeticalPredicate:o=t.get("Sort_Owner_Alpabetical_Asc");break;case i.OwnerReverseAlphabeticalPredicate:case i.OwnerInfoReverseAlphabeticalPredicate:o=t.get("Sort_Owner_Alpabetical_Desc");break;case i.LastAccessDatePredicate:o=t.get("Sort_Last_Access_Date_Asc");break;case i.LastAccessReverseDatePredicate:o=t.get("Sort_Last_Access_Date_Desc");break;case i.SharedTimePredicate:o=t.get("Sort_Shared_Time_Asc");break;case i.SharedReverseTimePredicate:o=t.get("Sort_Shared_Time_Desc");break;case i.ArtifactEndorsementPredicate:o=t.get("Endorsement")}return{predicate:e,text:o,type:DropDownMenuItemType.Item}}t=e.models||(e.models={}),o=t.factory||(t.factory={}),g=jsCommon.FreezeUtility,v.prototype.toAngularFilterDefault=function(){var e=_.camelCase(this.columnName);return this.reverse?"-"+e:"+"+e},e=v,o.SortPredicate=e,(t=i=o.ArtifactSortPredicates||(o.ArtifactSortPredicates={})).TitleAlphabeticalPredicate=new e("displayName"),t.TitleReverseAlphabeticalPredicate=new e("displayName",!0),t.OwnerAlphabeticalPredicate=new e("ownerFullname"),t.OwnerReverseAlphabeticalPredicate=new e("ownerFullname",!0),t.LastAccessDatePredicate=new e("lastAccess"),t.LastAccessReverseDatePredicate=new e("lastAccess",!0),t.SharedTimePredicate=new e("sharedTime"),t.SharedReverseTimePredicate=new e("sharedTime",!0),t.OwnerInfoAlphabeticalPredicate=new e("ownerInfo"),t.OwnerInfoReverseAlphabeticalPredicate=new e("ownerInfo",!0),t.ArtifactEndorsementPredicate=new e("endorsement"),g.deepFreeze(t.TitleAlphabeticalPredicate),g.deepFreeze(t.TitleReverseAlphabeticalPredicate),g.deepFreeze(t.OwnerAlphabeticalPredicate),g.deepFreeze(t.OwnerReverseAlphabeticalPredicate),g.deepFreeze(t.LastAccessDatePredicate),g.deepFreeze(t.LastAccessReverseDatePredicate),g.deepFreeze(t.SharedTimePredicate),g.deepFreeze(t.SharedReverseTimePredicate),g.deepFreeze(t.OwnerInfoAlphabeticalPredicate),g.deepFreeze(t.OwnerInfoReverseAlphabeticalPredicate),o=o.SelectTileSortItemsFactory||(o.SelectTileSortItemsFactory={}),c=_.once((function(e){r=[b(i.TitleAlphabeticalPredicate,e),b(i.TitleReverseAlphabeticalPredicate,e),b(i.OwnerAlphabeticalPredicate,e),b(i.OwnerReverseAlphabeticalPredicate,e)],Object.freeze(r)})),d=_.once((function(e){a=[b(i.TitleAlphabeticalPredicate,e),b(i.TitleReverseAlphabeticalPredicate,e)],Object.freeze(a)})),p=_.once((function(e){n=[b(i.SharedReverseTimePredicate,e),b(i.SharedTimePredicate,e),b(i.TitleAlphabeticalPredicate,e),b(i.TitleReverseAlphabeticalPredicate,e),b(i.OwnerAlphabeticalPredicate,e),b(i.OwnerReverseAlphabeticalPredicate,e)],Object.freeze(n)})),u=_.once((function(e){s=[b(i.TitleAlphabeticalPredicate,e),b(i.TitleReverseAlphabeticalPredicate,e),b(i.OwnerInfoAlphabeticalPredicate,e),b(i.OwnerInfoReverseAlphabeticalPredicate,e)],Object.freeze(s)})),h=_.once((function(e){l=[b(i.ArtifactEndorsementPredicate,e),b(i.TitleAlphabeticalPredicate,e),b(i.TitleReverseAlphabeticalPredicate,e)],Object.freeze(l)})),o.createPredicates=function(e,t){switch(t){case 8:case 256:return d(e),a;case 64:return p(e),n;case 128:return u(e),s;case 512:return h(e),l;default:return m(e)}},o.createDefaultPredicates=m})(powerbi=powerbi||{}),(function(e){var t,o;function i(e,t){this.services=t}t=e.controllers||(e.controllers={}),o=e.dataServices.AppUtils,i.createOptions=function(){return{additionalServices:["appSettings"]}},i.prototype.hasAppLogoImage=function(){return o.hasAppLogoImage(this.viewModel)},i.prototype.getAppLogoImageUrlStyle=function(){return o.getAppLogoImageUrlStyle(this.viewModel,this.services.appSettings.clusterUri)},t.AppLogoController=i})(powerbi=powerbi||{}),(function(e){(e.components||(e.components={})).AppLogo={templateUrl:"components/appLogo/appLogo.html",bindings:{viewModel:"<",size:"@"},controller:e.common.createController(e.controllers.AppLogoController)}})(powerbi=powerbi||{}),(function(e){(e.components||(e.components={})).AppPlaceholder={templateUrl:"components/appPlaceholder/appPlaceholder.html"}})(powerbi=powerbi||{}),(function(i){var e,r,t;function o(e,t){this.services=t}e=i.controllers||(i.controllers={}),r=i.common.ArrowPosition,t=i.common.contracts.ContentTileType,o.createOptions=function(){return{additionalServices:["dashboardDataService","featureSwitchService","localizationService","modelService","relatedService","usageMetricsReport","workbookService","dashboardStore","reportStore","workbookStore","lazyProviderModern"]}},o.prototype.$onChanges=function(){return __awaiter(this,void 0,i.Promise,(function(){var t,o;return __generator(this,(function(e){switch(e.label){case 0:return[4,this.services.modelService.modelsPromise];case 1:return e.sent(),[4,this.services.lazyProviderModern.get("@powerbi/ContentList/list.module#ListModule","WorkspaceListService")];case 2:return t=e.sent(),o=this,[4,t.isWorkspaceEditableForAppOperations()];case 3:return o.canToggleSelection=e.sent(),this.canToggleSelection?this.isIncluded=!i.helpers.ContentTileHelper.isStaged(this.model):(this.isIncluded=!1,this.cannotIncludeTooltipConfig={tooltipDescription:this.services.localizationService.get("ArtifactSelection_Cannot_Include_Tooltip"),tooltipArrowPosition:r.arrowTopRight}),this.isLoaded=!0,[2]}}))}))},o.prototype.getToggleTooltipConfig=function(){var e=this.isIncluded?"ArtifactSelection_Included_Tooltip":"ArtifactSelection_Excluded_Tooltip";return{tooltipLocalizeDescription:e=!this.canToggleSelection?"ArtifactSelection_Cannot_Include_Tooltip":e,tooltipArrowPosition:r.arrowTopMiddle}},o.prototype.showWarning=function(){this.displayWarning&&this.displayWarning({expand:!0})},o.prototype.showWarningIcon=function(){return this.canToggleSelection&&!_.isEmpty(this.model.stageWarning)&&!this.disableWarningIcon},o.prototype.getWarningTooltip=function(){return this.canToggleSelection?{tooltipDescription:this.model.stageWarning,tooltipArrowPosition:r.arrowTopRight}:this.cannotIncludeTooltipConfig},o.prototype.toggleSelection=function(){return __awaiter(this,void 0,i.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return this.stageContent(),[4,this.services.lazyProviderModern.get("@powerbi/PublishApp/publish-app.module#PublishAppServiceModule","publishAppService")];case 1:return[4,e.sent().stageAppArtifact(null,this.getStageArtifacts())];case 2:return e.sent()?this.updateDisplayRowWarning():(this.isIncluded=!this.isIncluded,this.stageContent()),[2]}}))}))},o.prototype.stageContent=function(){switch(this.model.contentTileType){case t.Dashboard:return void this.services.dashboardStore.update(this.model.contract,{isStaging:!this.isIncluded});case t.RdlReport:case t.Report:return void this.services.reportStore.update(this.model.contract,{isStaging:!this.isIncluded});case t.Workbook:return void this.services.workbookStore.update(this.model.contract,{isStaging:!this.isIncluded})}},o.prototype.getStageArtifacts=function(){var e={id:i.helpers.ContentTileHelper.getId(this.model),isStaging:!this.isIncluded};switch(this.model.contentTileType){case t.Dashboard:return{dashboards:[e],reports:null,workbooks:null};case t.RdlReport:case t.Report:return{dashboards:null,reports:[e],workbooks:null};case t.Workbook:return{dashboards:null,reports:null,workbooks:[e]}}},o.prototype.updateDisplayRowWarning=function(){this.displayWarning&&this.displayWarning({expand:this.showWarningIcon()})},e.ArtifactSelectionController=o})(powerbi=powerbi||{}),(function(e){(e.components||(e.components={})).ArtifactSelection={templateUrl:"components/artifactSelection/artifactSelection.html",controller:e.common.createController(e.controllers.ArtifactSelectionController),bindings:{disableWarningIcon:"<",displayWarning:"&",model:"<"}}})(powerbi=powerbi||{}),(function(o){var e,i,r,a,n;function t(e,t){this.services=t}e=o.controllers||(o.controllers={}),i="glyphicon",r="glyph-mini",a="pbi-glyph-tvmonitor",n="pbi-glyph-phone",t.createOptions=function(){return{additionalServices:["dashboardDataService","dropdown","errorService","gridLayout","lazyProviderModern","localizationService","navigation","permissionService","promiseFactory","telemetryService"]}},t.prototype.$onInit=function(){this.authorOptionsMenu=this.createAuthoringDashboardMenuItems()},t.prototype.showMenu=function(t,e){var o=this,i=this.services.dropdown,r=e.bind(this)($(t.currentTarget)),e={menuActionSelected:function(e){r.menuActionSelected.bind(o)(e),i.hideAll(),t.stopPropagation()},getMenuActions:function(){return r.menuActions}};i.showMenu(e,r.templateName,r.displayOptions)},t.prototype.getAuthoringMenuProperties=function(e){return{displayOptions:{anchorElement:$(".anchorElementForAuthoring"),blurNeeded:!1,disableAnimation:!0,preferLeft:!0},menuActions:this.getAuthoringMenuActions(),menuActionSelected:this.onAuthoringMenuItemSelected,templateName:"appBarAuthoringMenu.html"}},t.prototype.numberOfNewTiles=function(){var e=this.services.dashboardDataService.activeDashboard,t=_.filter(e.tiles,(function(e){return e.hasLayoutDefinition(1)})).length;return t?e.tiles.length-t:0},t.prototype.getSelectedItem=function(){return _.find(this.authorOptionsMenu,(function(e){return e.checked}))||{text:"",iconClass:""}},t.prototype.shouldShowAuthoringDropDown=function(){var e=this.services.dashboardDataService.activeDashboard;return!this.services.permissionService.isActiveWorkspaceIsReadOnlyLegacy&&e&&e.canEdit},t.prototype.shouldShowNewTilesCounter=function(){return 0!==this.numberOfNewTiles()},t.prototype.onAuthoringMenuItemSelected=function(e){if(null!=e.action&&!e.checked){var t=this.services.dashboardDataService.activeDashboard;switch(e.action){case 5:this.services.telemetryService.logEvent(o.telemetry.MobileAuthoringSwitchedState,{fromState:"PhoneAuthoringView",toState:"WebView"}),this.services.navigation.navigateToDashboardByGUID(t.objectId,!0),this.selectMenuItem(e);break;case 6:this.services.telemetryService.logEvent(o.telemetry.MobileAuthoringSwitchedState,{fromState:"WebView",toState:"PhoneAuthoringView"}),_.some(t.tiles,(function(e){return e.gridLayouts&&e.hasLayoutDefinition(1)}))?(this.services.navigation.navigateToDashboardMobileAuthoringByGUID(this.services.navigation.currentDashboardGUID,!0),this.selectMenuItem(e)):this.services.lazyProviderModern.get("@powerbi/MobileDashboardAuthoring/module#MobileDashboardAuthoringModule","mobileAuthoringDialogService").then((function(e){e.promptCreateMobileLayoutDialog(t.objectId)}))}}},t.prototype.getAuthoringMenuActions=function(){var e=_.filter(this.authorOptionsMenu,(function(e){return 6===e.action}));return _.isEmpty(e)||(e[0].numberOfNewTiles=this.numberOfNewTiles()),this.authorOptionsMenu},t.prototype.selectMenuItem=function(e){this.uncheckMenuItems(e),e.checked=!0},t.prototype.uncheckMenuItems=function(e){for(var t=0,o=this.authorOptionsMenu;t<o.length;t++){var i=o[t];i.checked=i.action===e.action}},t.prototype.createAuthoringDashboardMenuItems=function(){var e=this.services.localizationService,t=[];return t.push({text:e.get("Dashboard_Authoring_Web"),action:5,type:DropDownMenuItemType.Item,hasGlyph:!0,iconClass:[i,r,a].join(" "),checked:0===this.selectedItem,tooltip:e.get("Dashboard_Authoring_Web_Tooltip"),numberOfNewTiles:0}),t.push({text:e.get("MobileAuthoring_MobileLayout"),action:6,type:DropDownMenuItemType.Item,hasGlyph:!0,iconClass:[i,r,n].join(" "),checked:1===this.selectedItem,tooltip:e.get("Dashboard_Authoring_Mobile_Tooltip"),numberOfNewTiles:0}),t},e.AuthoringDropDownMenuController=t})(powerbi=powerbi||{}),(function(e){(e.components||(e.components={})).AuthoringDropDownMenu={templateUrl:"components/authoringDropDownMenu/authoringDropDownMenu.html",bindings:{selectedItem:"<"},controller:e.common.createController(e.controllers.AuthoringDropDownMenuController)}})(powerbi=powerbi||{}),(function(e){function t(e,t){this.dataClassificationService=t.dataClassificationService}e=e.controllers||(e.controllers={}),t.createOptions=function(){return{additionalServices:["featureSwitchService","dataClassificationService"]}},t.prototype.$onInit=function(){this.updateDataClassificationById(this.classificationId)},t.prototype.$onChanges=function(e){e.classificationId&&this.updateDataClassificationById(e.classificationId.currentValue)},t.prototype.updateDataClassificationById=function(t){var o=this;this.dataClassificationService.getDataClassificationsAsync().then((function(e){o.dataClassification=_.find(e,(function(e){return void 0!==t&&e.id===t}))||_.find(e,(function(e){return e.default}))}))},e.DataClassificationLabelController=t})(powerbi=powerbi||{}),(function(e){(e.components||(e.components={})).ClassificationLabel={templateUrl:"components/dataClassificationLabel/dataClassificationLabel.html",controller:e.common.createController(e.controllers.DataClassificationLabelController),bindings:{classificationId:"<"}}})(powerbi=powerbi||{}),(function(e){var t;function o(e,t){this.services=t}t=e.controllers||(e.controllers={}),o.createOptions=function(){return{additionalServices:["profileImageService"]}},o.prototype.$onInit=function(){this.updatePhoto(),this.updatePlaceholder()},o.prototype.$onChanges=function(e){e.group&&(this.updatePhoto(),this.updatePlaceholder())},o.prototype.updatePlaceholder=function(){this.placeholder=this.isMyWorkspace()?"user":"group"},o.prototype.updatePhoto=function(){var t=this;this.isMyWorkspace()?this.services.profileImageService.getUserPhoto().then((function(e){t.src=e.substring(4,e.length-1)})):this.src=null},o.prototype.isMyWorkspace=function(){return this.group&&this.group.uniqueId===e.common.constants.myWorkspaceFolderId},t.GroupIconController=o})(powerbi=powerbi||{}),(function(e){(e.components||(e.components={})).GroupIcon={templateUrl:"components/groupIcon/groupIcon.html",bindings:{group:"<",placeholderSize:"@"},controller:e.common.createController(e.controllers.GroupIconController)}})(powerbi=powerbi||{}),(function(e){function t(e,t){this.services=t}e=e.controllers||(e.controllers={}),t.createOptions=function(){return{additionalServices:["$window","licenseEnforcementService","userInfo"]}},t.prototype.$onInit=function(){this.content=this.config&&this.config.content},t.prototype.upgrade=function(){this.config&&this.config.upgradeCallback?this.config.upgradeCallback():this.services.$window.open("https://go.microsoft.com/fwlink/?linkid=847283","_blank")},t.prototype.startTrial=function(){this.config&&this.config.startTrialCallback?this.config.startTrialCallback():this.services.licenseEnforcementService.showTrialDialog("ConnectApps")},t.prototype.showTrialButton=function(){var e=this.services.userInfo;return!e.userFreeTrialExpired&&!e.userHasFreeTrial&&!e.isPremiumUser},e.InsufficientLicenseBarController=t})(powerbi=powerbi||{}),(function(e){(e.components||(e.components={})).InsufficientLicenseBar={templateUrl:"components/insufficientLicenseBar/insufficientLicenseBar.html",bindings:{config:"<?"},controller:e.common.createController(e.controllers.InsufficientLicenseBarController)}})(powerbi=powerbi||{}),(function(e){function t(e,t){this.services=t}e=e.controllers||(e.controllers={}),t.createOptions=function(){return{additionalServices:["localizationService","modalDialogService"]}},t.prototype.$onInit=function(){var t=this.services.localizationService,e=_.map(this.dashboards,(function(e){return t.format("Artifact_NameAndType_Dashboard",[e.displayName])})),o=_.map(this.models,(function(e){return t.format("Artifact_NameAndType_Dataset",[e.displayName])})),i=_.map(this.reports,(function(e){return t.format("Artifact_NameAndType_Report",[e.displayName])}));this.itemNames=e.concat(i).concat(o)},t.prototype.save=function(){this.services.modalDialogService.close(0)},t.prototype.cancel=function(){this.services.modalDialogService.close(1)},e.MakeACopyDialogController=t})(powerbi=powerbi||{}),(function(e){(e.components||(e.components={})).MakeACopyDialog={templateUrl:"components/makeACopyDialog/makeACopyDialog.html",bindings:{titleKey:"<",messageKey:"<",itemsIntroKey:"<",dashboards:"<",reports:"<",models:"<"},controller:e.common.createController(e.controllers.MakeACopyDialogController)}})(powerbi=powerbi||{}),(function(e){function t(e){this.modalDialogService=e}e=e.dialogbuilders||(e.dialogbuilders={}),t.prototype.show=function(e,t,o,i,r,a,n){return this.modalDialogService.showWebModalDialog({dialogName:e,definitionTemplateCachePath:"components/makeACopyDialog/makeACopyDialogDefinition.html",bindings:{titleKey:t,messageKey:o,itemsIntroKey:i,dashboards:r,reports:a,models:n}})},e.MakeACopyDialogBuilder=t})(powerbi=powerbi||{}),(function(e){function t(e,t){this.services=t}e=e.controllers||(e.controllers={}),t.createOptions=function(){return{additionalServices:["modalDialogService"]}},t.prototype.ok=function(){this.services.modalDialogService.close(0)},t.prototype.close=function(){this.services.modalDialogService.close(1)},e.PopupNotificationDialogController=t})(powerbi=powerbi||{}),(function(e){(e.components||(e.components={})).PopupNotificationDialog={templateUrl:"components/popupNotificationDialog/popupNotificationDialog.html",bindings:{config:"<"},controller:e.common.createController(e.controllers.PopupNotificationDialogController)}})(powerbi=powerbi||{}),(function(e){var t;function o(e,t){var o=this;this.scope=e,this.services=t,this.imageLoaded=!1,this.scope.$watch((function(){return o.source}),(function(e){e&&!o.disableAnimation&&(o.imageLoaded=!1)}))}t=e.controllers||(e.controllers={}),o.createOptions=function(){return{additionalServices:["localizationService"]}},o.prototype.onLoad=function(){this.imageLoaded=!0},o.prototype.onError=function(){this.scope.$emit(e.common.constants.tileErrorEventName,this.services.localizationService.get("Tile_ErrorText"))},t.PrintableImageController=o})(powerbi=powerbi||{}),(function(e){(e.components||(e.components={})).PrintableImage={controller:e.common.createController(e.controllers.PrintableImageController),bindings:{source:"@",disableAnimation:"<?",altText:"@?"},templateUrl:"components/printableImage/printableImage.html"}})(powerbi=powerbi||{}),(function(r){var e;function t(e,t){this.$scope=e,this.services=t,this.dropdownOpen=!1}e=r.controllers||(r.controllers={}),t.createOptions=function(){return{additionalServices:["$document","overlayService"]}},t.prototype.toggleDropdown=function(e){var t=this,o=this.services.$document.find(e.delegateTarget).find(".js-anchor"),i=this.services.overlayService.getOverlayElement(this.overlayName);this.services.overlayService.toggleDropdown(e,{anchorElement:o,element:i,preferLeft:!0,horizontal:!1}),this.dropdownOpen=!this.dropdownOpen,this.dropdownOpen&&i.on(r.common.constants.OverlayCloseEventName,(function(){t.$scope.$applyAsync((function(){i.off(r.common.constants.OverlayCloseEventName),t.dropdownOpen=!1}))}))},e.SelectButtonController=t})(powerbi=powerbi||{}),(function(e){(e.components||(e.components={})).SelectButton={transclude:!0,bindings:{overlayName:"@"},templateUrl:"components/selectButton/selectButton.html",controller:e.common.createController(e.controllers.SelectButtonController)}})(powerbi=powerbi||{}),(function(i){var e;function t(e,t){this.services=t,this.titleDropdownItem={text:this.services.localizationService.get("SortBy"),type:DropDownMenuItemType.Title,predicate:void 0,containerClass:"dropdownListHeader"}}e=i.controllers||(i.controllers={}),t.createOptions=function(){return{additionalServices:["dropdown","localizationService","overlayService"]}},t.prototype.$onInit=function(){this.updateDropdownItems(),this.updateTitle(),this.dropdownOpen=!1},t.prototype.$onChanges=function(e){e.predicates&&this.updateDropdownItems(),e.selectedPredicate&&this.updateTitle()},t.prototype.showDropdownItems=function(e){var t,o=this;this.dropdownOpen?this.services.dropdown.hideAll():(t=$(e.currentTarget).children(".anchorContainer"),e=[this.titleDropdownItem].concat(this.dropdownItems),i.common.DropdownUtils.showLegacyDropdownItems(this.services.dropdown,"selectTileSortDropdownMenu",e,"selectTileSortDropdownMenu",(function(e){return o.onCreateDropdownMenuItemSelected(e)}),{anchorElement:t,horizontal:!1,preferLeft:!0},(function(){return o.dropdownOpen=!1})),this.dropdownOpen=!0)},t.prototype.updateDropdownItems=function(){this.dropdownItems=_.isEmpty(this.predicates)?i.models.factory.SelectTileSortItemsFactory.createDefaultPredicates(this.services.localizationService):this.predicates;var e=_.find(this.dropdownItems,{predicate:this.selectedPredicate});e||(_.isEmpty(this.dropdownItems),e=this.dropdownItems[0],this.onSelect()(e.predicate)),this.setItemAsChecked(e)},t.prototype.updateTitle=function(){var e=_.find(this.dropdownItems,{predicate:this.selectedPredicate});e&&(this.title=e.text,this.setItemAsChecked(e))},t.prototype.onCreateDropdownMenuItemSelected=function(e){e.predicate&&(this.setItemAsChecked(e),this.onSelect()(e.predicate),this.services.overlayService.hideAllDropdowns(),this.dropdownOpen=!1)},t.prototype.setItemAsChecked=function(e){this.dropdownItems.forEach((function(e){return e.checked=!1})),e.checked=!0},e.SelectTileSortController=t})(powerbi=powerbi||{}),(function(e){(e.components||(e.components={})).SelectTileSort={bindings:{selectedPredicate:"<",onSelect:"&",predicates:"<?"},templateUrl:"components/selectTileSort/selectTileSort.html",controller:e.common.createController(e.controllers.SelectTileSortController)}})(powerbi=powerbi||{}),(function(e){function l(e,t,o,i,r,a){return{text:e.get(t),type:1,iconClass:"pbi-glyph-"+o,buttonClass:i,title:a,action:r}}((e=e.models||(e.models={})).TileOptionsViewModelFactory||(e.TileOptionsViewModelFactory={})).createViewModel=function(e,t,o,i){var r=[];e.canAddComment&&r.push(l(i,"AddComment","comment","commentBtn",(function(e){return o.addComment(e)}))),e.canShareToTeams&&r.push(l(i,"ChatInTeams","teamslogo","discussInTeamsBtn",(function(e){return o.shareToTeams(e)}))),e.canCopy&&r.push(l(i,"CopyVisualAsImage","copy","copyVisualBtn",(function(e){return o.copy(e)}))),e.canOpen&&r.push(function(e,t,o,i,r){function a(e){return o.open(e)}var n="openActionHeader";switch(e){case 0:return{type:0,text:r.get("TileMenuOption_GoToURL"),iconClass:"pbi-glyph-link",buttonClass:n,action:a,title:i.action.targetUrl,link:{href:i.href,target:i.hrefTarget}};case 1:return l(r,"TileMenuOption_GoToQnA","qna",n,a,t);case 2:return l(r,"TileMenuOption_GoToReport","barchart",n,a,t);case 3:return l(r,"GoToWorkbook","excel",n,a,t);case 4:return l(r,"TileMenuOption_GoToDataset","dataset",n,a,t)}}(e.openActionType,e.openActionDescription,o,t,i)),e.canFocus&&r.push(l(i,"TileMenuOption_Focus","miniexpand","inFocusTileBtn",(function(e){return o.focus(e)}))),e.canShowAlerts&&r.push(l(i,"ManageAlerts_Tooltip","alertsettings","vcAlertBtn",(function(e){return o.alerts(e)}))),e.canExport&&r.push(l(i,"TileMenuOption_ExportToCsv","export","vcExportBtn",(function(e){return o.export(e)}))),e.canEdit&&r.push(l(i,"TileMenuOption_EditDetails","edit","editTileBtn",(function(e){return o.edit(e)}))),e.canShowInsights&&r.push(l(i,"Insights_FinishedLoadingButtonText","insight","insightsBtn",(function(e){return o.insights(e)}))),e.canPin&&r.push(l(i,"TileMenuOption_Pin","pinned","vcPinBtn",(function(e){return o.pin(e)}))),e.canDelete&&r.push(l(i,"TileEditor_DeleteTile","delete","deleteTileBtn",(function(e){return o.delete(e)}))),r=_.compact(r),_.isEmpty(r)&&r.push({text:i.get("NoActionsAvailable"),type:2,action:_.noop});for(var a=0,n=r;a<n.length;a++){var s=n[a];s.title=s.title||s.text}return r}})(powerbi=powerbi||{}),(function(u){!(function(t){var o=jsCommon.EnumExtensions,a=jsCommon.JsonExtensions,i=u.common.helpers.ModelConverterHelper,r=u.common.constants.tileActions,d=u.models.TileOptionsViewModelFactory,n=u.dataServices.contracts.TileType,s=u.dataServices.TileUtils,e=(l.createOptions=function(){return{additionalServices:["$injector","$location","$element","annotationsInterop","auditing","contentProviderHttpService","dashboardDataService","dropdown","featureSwitchService","flyoutService","folderService","fullScreen","inFocusService","licenseEnforcementService","localizationService","modelService","navigation","pinTileService","reportService","taskPaneSliderService","tileSelectionService","telemetryService","userInfo","userNotificationInfo","workbookService","shellCapabilities","permissionService","modernDialogService","informationProtectionService","promiseFactory","activeFolderId","lazyProviderModern","conceptualSchemaProxy","displayNameService","appStore","groupStore","dashboardStore","appSettings","notificationToastModern","themeService"],scopedDependencies:["exportData","filterGenerator","visualPlugin"]}},l.prototype.$onInit=function(){return __awaiter(this,void 0,u.Promise,(function(){var t,o,i=this;return __generator(this,(function(e){switch(e.label){case 0:return o=this.viewModel,this.isModelTile=o&&o.model&&o.contract&&!o.contract.config,this.isWorkbookTile=o&&o.workbook&&o.contract&&"number"==typeof o.contract.workbookId,[4,(t=this.services.shellCapabilities).ensureCapabilitiesInitialized()];case 1:return e.sent(),o=t.getCapabilities().dashboardSettings,this.showPinButton=o.showPinButton,this.showComments=o.showComments,this.activeSubscriptions.push(this.services.appStore.selectedApp.subscribe((function(e){return i.selectedApp=e}))),this.activeSubscriptions.push(this.services.groupStore.selectedFolderId$.subscribe((function(e){return i.selectedGroupId=e}))),this.activeSubscriptions.push(this.services.dashboardStore.selectedDashboard.subscribe((function(e){return i.selectedDashboard=e}))),[2]}}))}))},l.prototype.$onDestroy=function(){this.activeSubscriptions.forEach((function(e){e&&e.unsubscribe()}))},l.prototype.showOptionsMenu=function(c){return __awaiter(this,void 0,u.Promise,(function(){var t,o,i,r,a,n,s,l;return __generator(this,(function(e){switch(e.label){case 0:return(c.stopPropagation(),t=this.services.dropdown,o=this.isReadOnly,a=this.viewModel,i=a.isLoading||a.composite&&a.composite.isLoading,s=a.isLocked,r=this.getOpenActionType(),a=this.getOpenTileDescription(r),t.hideAll(),s)?(n={canAddComment:!1,canExport:!1,canFocus:!1,canEdit:!1,canDelete:!o,canShowInsights:!1,canPin:!1,canShowAlerts:!1,canOpen:!1,canCopy:!1,canShareToTeams:!1,openActionType:r,openActionDescription:a},[3,3]):[3,1];case 1:return l={canAddComment:this.canAddComment(),canExport:this.canExport&&this.canExportData(),canFocus:!i&&this.shouldShowInfocusButton(),canEdit:!i&&!o,canDelete:!o,canShowInsights:!i&&this.shouldShowInfocusButton()&&this.isInsightsSupported()&&this.isRunInsightsAuthorized(),canPin:this.showPinButton&&this.canPinTile(i),canShowAlerts:!i&&this.shouldShowAlertsButton(),canOpen:this.isTileOpenable&&void 0!==r},[4,this.canCopy()];case 2:l.canCopy=e.sent(),l.canShareToTeams=this.canShareToTeams(),l.openActionType=r,l.openActionDescription=a,n=l,e.label=3;case 3:return s=d.createViewModel(n,this.viewModel,this,this.services.localizationService),_.some(s),s={items:s},t.showMenu(s,"tileOptionsMenu.html",{showInsideVisibleArea:!0,position:this.getMenuPosition()}),this.services.$element.attr("aria-expanded","true"),[2]}}))}))},l.prototype.getMenuPosition=function(){var e=this.services.$element,t=e.offset();return{x:t.left+e.width(),y:t.top+e.height()}},l.prototype.logAction=function(e){var t=this.services,o=t.dashboardDataService.activeDashboard.objectId;t.telemetryService.logEvent(u.telemetry.DashboardTileMenuAction,{action:e,dashboardGuid:o})},l.prototype.delete=function(e){this.dismiss(e),this.logAction("Delete");e=this.services.rootScope;this.services.tileSelectionService.clearSelected(),this.services.taskPaneSliderService.collapsePane(),e.$emit(t.DashboardTileController.Events.DeleteTile,this.viewModel),e.$emit(u.constants.removeTileEventName,this.viewModel)},l.prototype.alerts=function(e){this.dismiss(e),this.logAction("Alerts"),this.services.tileSelectionService.selectById(this.viewModel.id),null==this.sidePaneStoreService&&(this.sidePaneStoreService=this.services.$injector.get("sidePaneStoreService")),this.sidePaneStoreService.openAlertsEditorPane()},l.prototype.open=function(e){this.dismiss(e),this.logAction("Open"),this.services.rootScope.$emit(u.constants.openTileEventName,this.viewModel)},l.prototype.dismiss=function(e){this.services.dropdown.hideAll(),this.services.$element.attr("aria-expanded","false"),e&&e.stopPropagation&&e.stopPropagation()},l.prototype.canPinTile=function(e){return!e&&(this.services.featureSwitchService.featureSwitches.pinReadable?this.canPin():!this.isReadOnly&&this.shouldShowPinButton())},l.prototype.shouldShowPinButton=function(){var e=this.viewModel;return!(null!==this.isModelTile&&this.isModelTile)&&!this.isTileInError&&(!e.workbook||this.shouldShowPinButtonForWorkbookTile())},l.prototype.shouldShowAlertsButton=function(){if(!this.viewModel.datasetModel||!this.services.shellCapabilities.getCapabilities().dashboardSettings.alertingEnabled)return!1;var e=this.viewModel;if(e.type!==n.composite)return!1;var t=s.getVisualType(e.config),o=this.services.visualPlugin.getPlugin(t),i=this.services.visualPlugin.capabilities(t),r=!0;if(i){if(i.supportsDataDrivenAlerts&&null!=o&&o.getDataDrivenAlertCapabilities&&e.composite&&e.composite.visual&&e.composite.visual.dataViews){t=a.tryParseJSON(e.config.visualContainer.transform);if(!t)return!1;t=u.data.services.DataViewTransformActionsSerializer.deserializeDataViewTransformActions(t,i),e=o.getDataDrivenAlertCapabilities(t,e.composite.visual.dataViews);(!e.xIndex&&0!==e.xIndex||!e.yIndex&&0!==e.yIndex)&&(r=!1)}return!!i.supportsDataDrivenAlerts&&r}return!1},l.prototype.shouldShowInfocusButton=function(){return u.utils.tile.isInFocusableState(this.viewModel.contract,this.viewModel.composite&&this.viewModel.composite.visual)&&this.services.shellCapabilities.getCapabilities().dashboardSettings.inFocusModeEnabled},l.prototype.shouldShowPinButtonForWorkbookTile=function(){var e=this.viewModel,t=this.isWorkbookTile&&e.config&&!e.config.workbookTile,o=!1;return e.workbook&&e.workbook.contract&&(o=!(e=this.services.workbookService.findWorkbook(e.workbook.contract.workbookId,e.workbook.contract.packageId))||!e.isOwner()),!t&&!o},l.prototype.edit=function(e){this.dismiss(e),this.logAction("Edit"),this.services.tileSelectionService.selectById(this.viewModel.id),this.services.featureSwitchService.featureSwitches.useNewDashboard?(null==this.sidePaneStoreService&&(this.sidePaneStoreService=this.services.$injector.get("sidePaneStoreService")),this.sidePaneStoreService.openTileEditorPane()):this.services.taskPaneSliderService.expandPane(1,3)},l.prototype.focus=function(e){this.dismiss(e),this.logAction("Focus");var t=this.services,o=this.viewModel;t.tileSelectionService.selectById(this.viewModel.id);var i=o.objectId,r=o.contract.originalTileObjectId,a=t.folderService.activeFolderObjectId,e=t.dashboardDataService.activeDashboard,o=e.objectId,e=e.contract.originalDashboardObjectId;t.navigation.showInFocusMode(i,r,o,e,a)},l.prototype.addComment=function(e){this.dismiss(e),this.logAction("AddComment");e=this.services;e.annotationsInterop.selectTile(this.viewModel.id),e.flyoutService.expandFlyout()},l.prototype.export=function(o){return __awaiter(this,void 0,u.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return this.dismiss(o),this.logAction("Export"),t=this.services,(t=t.licenseEnforcementService).supportsExportData&&!t.supportsExportData(!0)?[2]:[4,this.initInformationProtectionDetailsAsync()];case 1:return(t=e.sent()).hasSensitivity?[4,this.services.modernDialogService.promptSimpleConfirmationDialog(this.services.localizationService.get(t.modalTitle),this.services.localizationService.get(t.modalContent),this.services.localizationService.get("ModalDialogButtonText_Continue"),(function(){return _.noop}),{panelClass:"sensitivityWarning"},{url:"https://go.microsoft.com/fwlink/?linkid=2132540",text:"Generic_LearnMore"})]:[3,5];case 2:return 1!==e.sent()?[3,4]:[4,this.exportCsvAsync()];case 3:e.sent(),e.label=4;case 4:return[3,7];case 5:return[4,this.exportCsvAsync()];case 6:e.sent(),e.label=7;case 7:return[2]}}))}))},l.prototype.pin=function(s){return __awaiter(this,void 0,u.Promise,(function(){var t,o,i,r,a,n;return __generator(this,(function(e){switch(e.label){case 0:return this.dismiss(s),this.logAction("Pin"),r=this.services.contentProviderHttpService.getBuiltInContentProviders(this.services.activeFolderId),t=this.viewModel,a=t.model&&t.model.contentProviderId,o=u.dataServices.AppUtils.findContentProviderName(r,a),n=t.contract.resourcePackageIds,i=!!(n&&0<n.length),r=t.config&&t.config.widget?t.config.widget.name:"",a=this.services.pinTileService,n=this.services.dashboardDataService.activeDashboard,[4,a.getSourceOrigin(n.getPermissions(),n.getUniquePackageId())];case 1:return n=e.sent(),n=this.services.telemetryService.startEvent(u.telemetry.DashboardPinTile,{visualType:t.composite?t.composite.visual.type:void 0,source:"Dashboard",reason:"",unsupportedVisualPinned:!1,contentProviderType:o,isCustomVisual:i,widgetType:r,reportPageContainsScriptVisuals:!1,sourceOrigin:n}),[4,a.showPinVisualFromDashboardDialog(t,n)];case 2:return[2,e.sent()]}}))}))},l.prototype.copy=function(n){return __awaiter(this,void 0,u.Promise,(function(){var t,o,i,r,a;return __generator(this,(function(e){switch(e.label){case 0:return this.dismiss(n),t=this.viewModel,a=!!this.selectedApp,o=a?this.selectedApp.App.providerKey:null,a=a?this.selectedDashboard.originalDashboardObjectId:this.selectedDashboard.objectId,o=u.common.helpers.RedirectUrlHelper.mobileRedirectUrlHelper(this.services.appSettings).getDashboardRedirectUrl(this.selectedGroupId,o,a,this.services.appSettings.tenantId),[4,this.initInformationProtectionDetailsAsync()];case 1:return(i=e.sent(),this.copyVisualImageService)?[3,3]:[4,(r=this).services.lazyProviderModern.get("@powerbi/CopyVisualImage/copy-visual-image.module#CopyVisualImageModule","copyVisualImageService")];case 2:r.copyVisualImageService=e.sent(),e.label=3;case 3:return a=new c(t,o,this.selectedDashboard.displayName,this.copyVisualImageService,this.services.visualPlugin,this.services.displayNameService,this.services.localizationService,this.services.filterGenerator,this.services.conceptualSchemaProxy,this.services.themeService,this.services.featureSwitchService),[2,this.copyVisualImageService.copyVisual(a,"Dashboard",i.hasSensitivity,t.config.visualContainer.$visualContainer.config.singleVisual.visualType)]}}))}))},l.prototype.shareToTeams=function(r){return __awaiter(this,void 0,u.Promise,(function(){var t,o,i;return __generator(this,(function(e){switch(e.label){case 0:return(this.dismiss(r),this.teamsDialogService)?[3,2]:[4,(t=this).services.lazyProviderModern.get("@powerbi/Teams/Teams/teams.module#TeamsModule","TeamsDialogService")];case 1:t.teamsDialogService=e.sent(),e.label=2;case 2:return this.shareToTeamsUrlBuilderService?[3,4]:[4,(o=this).services.lazyProviderModern.get("@powerbi/Teams/Teams/teams.module#TeamsModule","ShareToTeamsUrlBuilderService")];case 3:o.shareToTeamsUrlBuilderService=e.sent(),e.label=4;case 4:return i=this.viewModel,i=i.contract&&i.contract.id,i=this.shareToTeamsUrlBuilderService.getDashBoardShareToTeamsDialogData(i),this.teamsDialogService.showShareToTeamsDialog(i),[2]}}))}))},l.prototype.isInsightsSupported=function(){var e=this.viewModel,t=e.datasetModel;return!e.workbook&&!e.realTime&&t&&!t.isHidden&&t.contract.insightsSupported&&!t.cloudRlsEnabled&&o.hasFlag(t.getPermissions(),1)},l.prototype.isRunInsightsAuthorized=function(){var e=this.viewModel.datasetModel;return this.services.permissionService.isExplorableModel(e)},l.prototype.getOpenTileDescription=function(e){var t=this.viewModel,o=this.services;switch(e){case 0:return t.action.targetUrl;case 1:return t.utterance;case 2:var i=t.report&&t.report.objectId,i=o.reportService.findReportByGUID(i);return i&&i.displayName||"";case 4:var r=void 0;return(r=t.contractsModel?o.modelService.findModel(t.contractsModel.id,t.contractsModel.packageId):r)&&r.displayName||"";case 3:r=t.contract&&t.contract.workbookId,r=o.workbookService.findWorkbook(r);return r&&r.displayName||"";default:if(!e)return o.localizationService.get("TileMenuOption_NoAction")}},l.prototype.insights=function(e){this.dismiss(e);var t=this.viewModel;this.services.tileSelectionService.selectById(this.viewModel.id);var o=t.objectId,i=t.contract.originalTileObjectId,e=this.services.folderService.activeFolderObjectId,t=this.services.dashboardDataService.activeDashboard.objectId;this.services.navigation.showInsightsInFocusMode(o,i,t,e)},l.prototype.getOpenActionType=function(){var e=this.viewModel;switch(e.action.action){case r.custom.openUrlActionName:return 0;case r.openQnAActionName:if(e.contractsModel&&i.getIsQnaSupported(e.contractsModel)&&this.services.permissionService.isReadableModelContract(e.contractsModel))return 1;break;case r.openReportActionName:if(!this.isModelTile&&e.report)return 2;if(!e.report&&this.isModelTile&&this.services.permissionService.isExplorableModel(e.datasetModel))return 4;if(e.report||this.isModelTile&&e.contractsReport)return 2;break;case r.openWorkbookActionName:if(e.workbook)return 3}},l.prototype.canPin=function(){return this.services.pinTileService.canPinTile(this.viewModel)&&!this.services.fullScreen.fullScreenMode},l.prototype.canAddComment=function(){var e=this.services.dashboardDataService.activeDashboard;return this.showComments&&e&&e.annotationsEnabled&&!this.services.featureSwitchService.featureSwitches.tenantDisableCommentingEnabled},l.prototype.canShareToTeams=function(){var e=this.services.featureSwitchService.featureSwitches;return e.discussInTeamsForDashboard&&e.shareToTeamsTenantEnabled},l.prototype.canExportData=function(){var e,t=this.viewModel,t=(e=t.contractsModel?this.services.modelService.findModel(t.contractsModel.id,t.contractsModel.packageId,!0):e)&&e.contract;return 1==(1&(t&&t.permissions))&&this.services.modelService.isActionAllowed(e.contract,2)},l.prototype.canCopy=function(){return __awaiter(this,void 0,u.Promise,(function(){var t,o,i,r;return __generator(this,(function(e){switch(e.label){case 0:return(o=this.services.featureSwitchService.featureSwitches).exportVisualImageTenantEnabled&&o.copyVisualImage?(t=this.viewModel,o=t.contract,t.config.visualContainer&&(t.contract.tileDataBinaryBase64Encoded||t.contract.tileData)&&(o.config||o.$config)?(i=u.explore.util.VisualContainerUtils.getVisualType(t.config.visualContainer.$visualContainer),this.copyVisualImageService?[3,2]:[4,(r=this).services.lazyProviderModern.get("@powerbi/CopyVisualImage/copy-visual-image.module#CopyVisualImageModule","copyVisualImageService")]):[2,!1]):[2,!1];case 1:r.copyVisualImageService=e.sent(),e.label=2;case 2:return[2,this.copyVisualImageService.canCopy(i)]}}))}))},l.prototype.exportCsvAsync=function(){return __awaiter(this,void 0,u.Promise,(function(){var t,o,i,r,a,n;return __generator(this,(function(e){switch(e.label){case 0:t=this.services,o=this.viewModel,i=s.getVisualType(o.config),a=this.services.userInfo.isPremiumUser,r=o.contract&&o.contract.id,a=t.telemetryService.startEvent(u.telemetry.EXExportVisualData,{visualType:i,source:"Dashboard",isPartialResult:!1,dest:0,isPremiumUser:a,isDrillToDetailsMode:!1,dataType:0}),e.label=1;case 1:return e.trys.push([1,3,4,5]),[4,this.services.exportData.exportTileDataToCsv({contract:o.contract,config:o.config,visual:o.composite&&o.composite.visual,dataSet:o.datasetModel&&o.datasetModel.contract})];case 2:return n=e.sent(),a.event.info.isPartialResult=n.isPartialResult,a.resolve(),[3,5];case 3:return n=e.sent(),a.reject({errorCode:n.errorDetails&&n.errorDetails.errorType.toString()}),[3,5];case 4:return this.services.auditing.auditEvent(r,3,11),[7];case 5:return[2]}}))}))},l.prototype.initInformationProtectionDetailsAsync=function(){return __awaiter(this,void 0,u.Promise,(function(){var t,o,i;return __generator(this,(function(e){switch(e.label){case 0:return(t=this.services.promiseFactory.resolve({hasSensitivity:!1,modalTitle:"",modalContent:""}),this.services.informationProtectionService.isInformationProtectionFeatureEnabled())?this.viewModel&&this.viewModel.contract?(o=this.viewModel.contract.reportId,i=this.viewModel.contract.dashboardId,o?[4,this.services.informationProtectionService.isArtifactLabeled(u.common.contracts.ArtifactType.Report,o).toPromise()]:[3,2]):[2,t]:[2,t];case 1:if(e.sent())return[2,this.services.promiseFactory.resolve({hasSensitivity:!0,modalTitle:"EimInformationProtection_ExportTileToCsv_DialogTitle_Report",modalContent:"EimInformationProtection_ExportTileToCsv_DialogContent_Report"})];e.label=2;case 2:return i?[4,this.services.informationProtectionService.isArtifactLabeled(u.common.contracts.ArtifactType.Dashboard,i).toPromise()]:[3,4];case 3:if(e.sent())return[2,this.services.promiseFactory.resolve({hasSensitivity:!0,modalTitle:"EimInformationProtection_Dashboard_Has_Sensitivity_Label",modalContent:"EimInformationProtection_ExportTileToCsv_DialogContent_Dashboard"})];e.label=4;case 4:return[2,t]}}))}))},l);function l(e,t){this.services=t,this.activeSubscriptions=[]}t.TileOptionsMenuController=e;var c=(p.prototype.generateContract=function(){return __awaiter(this,void 0,u.Promise,(function(){var t,o,i,r,a,n,s;return __generator(this,(function(e){switch(e.label){case 0:return t=this.model.contract,o=this.model.config.visualContainer.$visualContainer,n=u.utils.tile.getDataSources(t,this.model.vsName,this.model.dbName),[4,this.conceptualSchemaProxy.get(n)];case 1:return i=e.sent(),r=this.filterGenerator.calculateVisualContainerFilter(null,null,o,i),(a=_.cloneDeep(t.$config)).visualContainer.heading1=this.model.getDisplayText(),a.visualContainer.heading3=this.model.getSubDisplayText(),a.visualContainer.themeCollection=this.model.composite.themeCollection,s=this.featureSwitchService.featureSwitches.useNewDashboard?(n=this.model.contract.colSpan,s=this.model.contract.rowSpan,{width:260*n||this.model.gridLayoutContext.width,height:180*s||this.model.gridLayoutContext.height}):{width:this.model.gridLayoutContext.width,height:this.model.gridLayoutContext.height},[2,{visualData:{type:t.type,config:JSON.stringify(a),tileDataBinaryBase64Encoded:t.tileDataBinaryBase64Encoded||jsCommon.GzipUtility.compress(t.tileData),resourcePackageIds:t.resourcePackageIds,renderDelay:this.copyVisualImageService.getRenderDelay(this.model.config.visualContainer.$visualContainer.config.singleVisual.visualType),layoutConfig:t.layoutConfig,customTheme:this.model.composite.themeCollection.customTheme?JSON.stringify(this.themeService.getThemeJson(this.model.composite.themeCollection.customTheme.name)):null},size:s,href:this.tileHref,title:this.title,refreshTime:u.common.helpers.ModelConverterHelper.getLocaleStringFromRefreshTime(this.model.contractsModel&&this.model.contractsModel.lastRefreshTime),filterDescription:this.generateFiltersDescription(i,r,o.config.singleVisual),visualTitle:this.model.getDisplayText()}]}}))}))},p.prototype.generateFiltersDescription=function(e,t,o){var i={filtersNamesAndRestatements:[]};if(!t||_.isEmpty(t.dataFiltersUnmerged))return i;for(var r=this.visualPlugin.capabilities(o.visualType),a=0,n=t.dataFiltersUnmerged;a<n.length;a++){var s=n[a];if(!s.isHidden){s=this.displayNameService.getFilterRestatementForOverlay(s,e,r,null,o);if(!_.isEmpty(s))for(var l=0,c=s;l<c.length;l++){var d=c[l];i.filtersNamesAndRestatements.push({displayName:d.fieldName,qualifiedDisplayName:d.fieldNameToolTip,restatement:d.restatements.join(this.localizationService.get("ListJoin_Separator"))})}}}return i},p);function p(e,t,o,i,r,a,n,s,l,c,d){this.model=e,this.tileHref=t,this.title=o,this.copyVisualImageService=i,this.visualPlugin=r,this.displayNameService=a,this.localizationService=n,this.filterGenerator=s,this.conceptualSchemaProxy=l,this.themeService=c,this.featureSwitchService=d}t.TileCopyVisualImageContractGenerator=c})(u.controllers||(u.controllers={}))})(powerbi=powerbi||{}),(function(e){(e.components||(e.components={})).TileOptionsMenu={templateUrl:"components/tileOptionsMenu/tileOptionsMenu.html",controller:e.common.createController(e.controllers.TileOptionsMenuController),bindings:{isReadOnly:"<",model:"<",viewModel:"<",canExport:"<",isTileInError:"<",isTileOpenable:"<"}}})(powerbi=powerbi||{}),(function(e){function t(e){var t=this;(this.scope=e).togglePane=function(){return t.togglePane()}}e=e.controllers||(e.controllers={}),t.prototype.togglePane=function(){var e=this.scope.viewModel;this.setCollapsePane(!0!==e.isExpanded)},t.prototype.setCollapsePane=function(e){this.scope.viewModel.isExpanded=e},e.CollapsiblePaneController=t})(powerbi=powerbi||{}),(function(s){var e;(function(e){var i,o=s.common.contracts.ContentProviderClientCategory;(t=i=e.ContentProviderSplashState||(e.ContentProviderSplashState={}))[t.Welcome=0]="Welcome",t[t.GetData=1]="GetData",t[t.GroupWelcome=2]="GroupWelcome";var t=(r.createOptions=function(){return{additionalServices:["folderService","localizationService","navigation","telemetryService","modalDialogService","modernDialogService","featureSwitchService","permissionService","modelService","moduleLoader","usageMetricsReport","shellCapabilities","userInfo","$window","quota","informationProtectionService","lazyProviderModern"]}},r.prototype.$onInit=function(){return __awaiter(this,void 0,s.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.services.shellCapabilities.ensureCapabilitiesInitialized()];case 1:return e.sent(),[2]}}))}))},r.prototype.inFolder=function(){return this.services.folderService.activeFolder instanceof s.models.Folder},r.prototype.showOrgnizationalContentPacksButton=function(){return!this.services.featureSwitchService.featureSwitches.DisableContentPacks&&!this.inFolder()},r.prototype.navigateToContentList=function(){this.services.navigation.navigateToContentList(this.services.folderService.activeFolderObjectId,!0)},r.prototype.getCurrentGroupName=function(){return this.services.folderService.activeFolder?this.services.folderService.activeFolder.displayName:""},r.prototype.getSplashTitleForCurrentGroup=function(){return this.services.folderService.activeFolder.isMyWorkspace?this.services.localizationService.get("GetData_GetData"):this.services.localizationService.format("Groups_Splash_Title",[this.getCurrentGroupName()])},r.prototype.isMyWorkspace=function(){return this.services.folderService.activeFolder.isMyWorkspace},r.prototype.navigateToCategoryAndProvider=function(r,e,a,n){return void 0===n&&(n=!1),__awaiter(this,void 0,s.Promise,(function(){var t,o,i;return __generator(this,(function(e){switch(e.label){case 0:return(s.contentProviderConstants.categoryInteractionTelemetryMap[a],t=this.services.folderService,!n||t.isMyWorkspace())?[3,2]:(i=s.constants.myWorkSpaceFolderId,o=t.getFolder(i),i=this.services.telemetryService.startEvent(s.telemetry.GroupsSwitchGroup,{groupObjectId:i}),[4,t.switchFolder(o,i)]);case 1:e.sent(),e.label=2;case 2:return s.helpers.ContentProviderStoreHelper.navigateToCategoryAndProviderHelper(r,a,this.services.telemetryService,this.services.navigation,this.services.folderService.activeFolderObjectId,this.services.rootScope,this.services.featureSwitchService,n),[2]}}))}))},r.prototype.showIntroductionVideoModal=function(){var e={dialogName:this.services.localizationService.get("GetData_PowerBI_In_60_Seconds"),templateUrl:"views/contentProviderStore/contentProviderSplashIntroVideoModal.html",scope:this.scope.$new(!0),dialogCssClass:"introVideo",onCloseDialog:_.noop,closeOnEsc:!0};this.services.modalDialogService.showLegacyWebModalDialog(e)},r.prototype.shouldShowDataflows=function(){return!this.isMyWorkspace()&&this.services.featureSwitchService.featureSwitches.showDataflowsInGetData&&this.services.featureSwitchService.featureSwitches.cDSAManagementEnabled},r.prototype.dataflowsLearnMore=function(){this.services.telemetryService.logEvent(s.telemetry.GetDataDataflowsLearnMore)},r.prototype.getDesktopDownloadLink=function(){return jsCommon.Utility.is64BitOperatingSystem()&&jsCommon.Utility.isWindows10()?"https://aka.ms/pbidesktopstore":"https://aka.ms/pbiSingleInstaller"},r.prototype.downloadDesktopClicked=function(){this.services.telemetryService.logEvent(s.telemetry.GetDataDownloadDesktop)},r.prototype.openCreateReportDialog=function(){return __awaiter(this,void 0,s.Promise,(function(){var t,o;return __generator(this,(function(e){switch(e.label){case 0:return(t=this.services).quota.checkQuotaExceeded()?(t.quota.showQuotaExceedDialog(),[2]):[4,t.moduleLoader.require({javascript:"PowerBIDialogs/components/createReportDialog/createReportDialogBuilder"})];case 1:return o=e.sent(),o.createReportDialogBuilder(t.featureSwitchService,t.folderService,t.telemetryService,t.navigation,t.permissionService,(function(e){return t.usageMetricsReport.isUsageMetricsArtifact(e)}),t.modalDialogService,t.modernDialogService,t.modelService,t.moduleLoader,t.userInfo,t.informationProtectionService,t.lazyProviderModern).show(i[this.scope.screenState].toString()),[2]}}))}))},r.prototype.isEnabled=function(e){var t=this.services.shellCapabilities;switch(e){case o.Organizational:return t.getCapabilities().getDataPane.supportsOrgApp;case o.Service:return t.getCapabilities().getDataPane.supportsServiceApp;case o.File:return t.getCapabilities().getDataPane.supportsFiles;case o.BigDataAndMore:return t.getCapabilities().getDataPane.supportsDatabases;case o.Dataflows:return t.getCapabilities().getDataPane.supportsDataflows;default:return!0}},r);function r(e,t){var i=this;this.dataflowsLearnMoreUrl="https://aka.ms/Self-servicedataprepinPowerBI",this.scope=e,this.services=t,this.scope.getCurrentGroupName=function(){return i.getCurrentGroupName()},this.scope.getSplashTitleForCurrentGroup=function(){return i.getSplashTitleForCurrentGroup()},this.scope.showIntroductionVideoModal=function(){return i.showIntroductionVideoModal()},this.scope.navigateToContentList=function(){return i.navigateToContentList()},this.scope.inGroupWelcomeView=function(){return i.services.navigation.inGroupWelcomeView()},this.scope.inFolder=function(){return i.inFolder()},this.scope.openCreateReportDialog=function(){return i.openCreateReportDialog()},this.scope.isEnabled=function(e){return i.isEnabled(e)},this.scope.shouldShowDataflows=function(){return i.shouldShowDataflows()},this.scope.dataflowsLearnMore=function(){return i.dataflowsLearnMore()},this.scope.getDesktopDownloadLink=function(){return i.getDesktopDownloadLink()},this.scope.downloadDesktopClicked=function(){return i.downloadDesktopClicked()},this.scope.showOrgnizationalContentPacksButton=function(){return i.showOrgnizationalContentPacksButton()},this.scope.navigateToCategory&&this.scope.navigateToCategoryAndProvider||(this.scope.navigateToCategory=function(e,t,o){return i.navigateToCategoryAndProvider(e,"",t,o)},this.scope.navigateToCategoryAndProvider=function(e,t,o){return i.navigateToCategoryAndProvider(e,t,o)})}e.ContentProviderSplashController=t})((e=s.controllers||(s.controllers={})).contentProviderStore||(e.contentProviderStore={}))})(powerbi=powerbi||{}),(function(p){var e,o,i,a,u,s;function t(e,i){var r=this,t=this.scope=e;this.services=i,t.scrollbarsConfig={ignoreOverlay:!1,ignoreMobile:!1},t.tileTrackerFn=function(e){return u.tileTrackerFn(e,t.viewModel.objectId)},t.useCustomScrollbar=function(){return 0!==t.displayLayout&&1===t.mobileLayout},t.fullScreen=i.fullScreen,t.permissionServices=i.permissionService,t.showReloadDashboard=!1,t.filteredTiles=function(){return r.filteredTiles()},t.removeTileFromMobileView=function(e){return r.removeTileFromMobile(e)},t.calculatePrintStyles=function(e){return r.calculatePrintStyles(e)},t.canEditTiles=function(){return r.canEditTiles()},t.tileSorter=t.tileSorter||function(e){return e},t.gridLayoutChangeHandler=function(e){return r.services.dashboardService.batchUpdateTileSizePosition(r.scope.viewModel,e)};function o(){switch(t.fullScreen.fitStyle){case 1:t.scaleDashboard();break;case 2:t.scaleDashboard(!0)}}var e=i.rootScope,a=e.$on(p.constants.openTileEventName,(function(e,t){return r.onOpenTile(e,t)})),n=e.$on(p.constants.temporaryTilePinned,(function(e){return r.beginTemporaryTileFlow(e)})),s=e.$on(p.constants.removeTileEventName,(function(t,o){return __awaiter(r,void 0,void 0,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.onRemoveTile(t,o)];case 1:return[2,e.sent()]}}))}))})),l=t.keepDashboardOnLoadFail?_.noop:e.$on(p.constants.loadDashboardFailed,(function(){t.showReloadDashboard=!0})),c=t.$on(p.constants.refreshTileData,(function(e,t){var o=i.dashboardDataService.activeDashboard;o&&i.dashboardService.refreshTileData(o.id,t)}));$(i.$window).on("resize",o);var d=this.services.globalEventBridge.createChannelSubscriptionManager().subscribe(p.common.events.scrollToSelectedTile,(function(){r.scrollToSelectedTile()}));t.$on("$destroy",(function(){t.onDestroy&&t.onDestroy(),a(),s(),n(),c(),l(),d.unsubscribeAll(),$(i.$window).off("resize",o)})),t.reloadActiveDashboard=function(){return r.reloadActiveDashboard()},t.$watch("viewModel.isLoaded",(function(e){e&&r.services.asyncFeatureSwitchService.getFeatureSwitches().then((function(e){e.consumePublicCvsWithoutRps?r.ensurePublicResourcePackages():p.helpers.TrustedVisualUtil.acquireTrustedVisuals(t.viewModel,i.trustedVisual).then((function(e){return r.reloadTrustedVisuals(e)}))}))})),t.gridLayoutCallbacks={onResize:function(){return r.services.overlayService.hideAllDropdowns()}}}e=p.controllers||(p.controllers={}),o=p.common.constants,i=p.common.helpers.ContainerPrinterHelper,a=p.dataServices.models.ContentPackItems,u=p.dataServices.TileUtils,s=p.dataServices.contracts.TileType,t.createOptions=function(){return{additionalServices:["$injector","dashboardDataService","dashboardHttpService","dashboardService","errorService","asyncFeatureSwitchService","modelConverter","overlayService","navigation","telemetryService","visualPlugin","$element","lazyProviderModern","localizationService","fullScreen","permissionService","$window","trustedVisual","taskPaneSliderService","notificationToast","globalEventBridge","publicCustomVisualService","promiseFactory","featureSwitchService"]}},t.prototype.calculatePrintStyles=function(e){var t=this.scope.gridLayoutContainer.containerWidth+40,o=this.scope.gridLayoutContainer.containerHeight,e=i.getPrintTargetViewPort(e),e=i.calculateScaleFactor({width:t,height:o},e);return e<=0?{}:{transform:"scale("+e+") !important","-webkit-transform":"scale("+e+") !important",width:t+"px !important",height:o+"px !important",overflow:"visible !important"}},t.prototype.ensurePublicResourcePackages=function(){for(var t,o=this,e=[],i=0,r=this.scope.viewModel.tiles;i<r.length;i++){var a=r[i],n=a.type===s.composite&&(null===(n=null===(n=null===(n=null===(n=null===(n=a.config)||void 0===n?void 0:n.visualContainer)||void 0===n?void 0:n.$visualContainer)||void 0===n?void 0:n.config)||void 0===n?void 0:n.singleVisual)||void 0===n?void 0:n.visualType);n&&e.push(n)}return this.services.publicCustomVisualService.getPublicVisualTypes(e).then((function(e){return t=e,o.services.publicCustomVisualService.createPublicResourcePackagesByName(t)})).then((function(e){return o.services.visualPlugin.ensurePlugins(e)})).catch((function(e){})).finally((function(){o.reloadPublicVisuals(t)}))},t.prototype.reloadPublicVisuals=function(e){this.services.globalEventBridge.publishToChannel(p.events.reloadEmptyVisuals,{visualTypes:e})},t.prototype.reloadTrustedVisuals=function(e){_.isEmpty(e)||(this.services.visualPlugin.ensureTrustedVisualPlugins(e),this.services.globalEventBridge.publishToChannel(p.events.reloadEmptyVisuals,{visualTypes:e.map((function(e){return e.name}))}))},t.prototype.onOpenTile=function(e,t){e&&e.stopPropagation&&e.stopPropagation();e=this.scope.viewModel;this.scope.$emit(p.constants.actualOpenTileEventName,t,e.id),this.services.globalEventBridge.publishToChannel(p.services.events.actualOpenTile,t)},t.prototype.beginTemporaryTileFlow=function(e){e&&e.stopPropagation&&e.stopPropagation();var t=1,o=this.services,e=o.dashboardDataService.selectedDashboardTile;7===(t=e&&e.realTime?7:t)?(null==this.sidePaneStoreService&&(this.sidePaneStoreService=this.services.$injector.get("sidePaneStoreService")),o.taskPaneSliderService.collapsePane(),this.sidePaneStoreService.openRealTimeBladePane()):this.services.featureSwitchService.featureSwitches.useNewDashboard?(null==this.sidePaneStoreService&&(this.sidePaneStoreService=this.services.$injector.get("sidePaneStoreService")),this.sidePaneStoreService.openTileEditorPane()):this.services.taskPaneSliderService.expandPane(t,3)},t.prototype.scrollToSelectedTile=function(){var e,t=this.services.$element,o=t.find(".dashboardTile.selected");0<o.length&&(e=t.offset(),o=o.offset(),t.animate({scrollTop:o.top-e.top+t.scrollTop(),scrollLeft:o.left-e.left+t.scrollLeft()}))},t.prototype.onRemoveTile=function(e,r){return __awaiter(this,void 0,p.Promise,(function(){var t,o,i;return __generator(this,(function(e){switch(e.label){case 0:if(t=this.scope.viewModel,i=t.contract,o=this.services.telemetryService.startEvent(p.telemetry.DashboardDeleteTile),this.deleteTile(r.id),!p.dataServices.DashboardUtils.isWriteable(i))return p.dataServices.DashboardUtils.notifyReadOnly(i,this.services.notificationToast,this.services.localizationService),[2];e.label=1;case 1:return e.trys.push([1,6,,7]),[4,this.services.dashboardHttpService.deleteTile(r.id,o.event)];case 2:return(e.sent(),t)?(this.updateDashboardContract(r,t),t.isUsedByContentPack&&this.services.rootScope.$emit(p.constants.contentPackDirtyShowNotification,t.id,a.Dashboard),t.hasModel(r.contract.modelId)||this.services.dashboardService.updateDashboardToken(t),r.hasLayoutPosition(1)?(this.services.telemetryService.logEvent(p.telemetry.MobileAuthoringFlyoutShown,{mobileOptimized:!0,operationType:"Remove"}),[4,this.services.lazyProviderModern.get("@powerbi/MobileDashboardAuthoring/module#MobileDashboardAuthoringModule","mobileAuthoringDialogService")]):[3,4]):[3,5];case 3:e.sent().showMobileIndicationMessage(t.objectId,4,10),e.label=4;case 4:o.resolve(),e.label=5;case 5:return[3,7];case 6:return i=e.sent(),o.reject(p.errorDetailsHelper.getTelemetryErrorDetails(i.error)),[3,7];case 7:return[2]}}))}))},t.prototype.updateDashboardContract=function(e,t){var o,i,r,a;t&&e.report&&(o=e.report.id,(a=_.filter(t.tiles,(function(e){if(e.report)return e.report.id===o})))&&0===a.length&&t.contract.reportIds&&(-1!==(i=t.contract.reportIds.indexOf(o))&&this.services.modelConverter.updateDashboardsReportContract(i,t.contract))),t&&e.contract&&e.contract.workbookId&&(r=e.contract.workbookId,(a=_.filter(t.tiles,(function(e){return!!e.contract&&e.contract.workbookId===r})))&&0===a.length&&t.contract.workbookIds&&(-1!==(a=t.contract.workbookIds.indexOf(r))&&this.services.modelConverter.removeDashboardsWorkbookContract(a,t.contract)))},t.prototype.deleteTile=function(e){var t=this.scope.viewModel;this.services.dashboardDataService.deleteTile(t.id,e)},t.prototype.canEditDashboard=function(e){return e.canEdit&&!this.services.permissionService.isActiveWorkspaceIsReadOnlyLegacy&&!this.services.fullScreen.fullScreenMode},t.prototype.canEditTiles=function(){return this.scope.viewModel.canEdit&&!this.scope.permissionServices.isActiveWorkspaceIsReadOnlyLegacy&&!this.scope.fullScreen.fullScreenMode},t.prototype.filteredTiles=function(){var e=this.scope.viewModel&&this.scope.viewModel.tiles;if(_.isEmpty(e))return[];this.scope.enableStrategySwap&&this.swapLayoutIfNeeded();var t=this.scope.displayLayout||0;return 0!==t&&(e=_.filter(e,(function(e){return e.hasLayoutPosition(t)}))),e=this.scope.tileSorter(e)},t.prototype.swapLayoutIfNeeded=function(){var e,t=this.scope.viewModel.gridLayoutService;t&&(e=this.scope.viewModel,e=_.some(e.tiles,(function(e){return e.hasLayoutDefinition(1)})),(t.strategy instanceof p.dataServices.models.PhonePortraitTileLayoutStrategy&&e||t.strategy.isDynamic&&!e)&&(this.scope.$emit(o.needStrategySwapEventName),this.services.globalEventBridge.publishToChannel(p.services.events.needStrategySwap)))},t.prototype.removeTileFromMobile=function(e){var t;1===this.scope.displayLayout&&e.gridLayoutContext&&((t=[]).push(e.removeLayoutPosition()),this.services.dashboardService.batchUpdateTileSizePosition(this.scope.viewModel,t),this.services.lazyProviderModern.get("@powerbi/MobileDashboardAuthoring/module#MobileDashboardAuthoringModule","mobileAuthoringService").then((function(e){return e.onUnpinTileFromMobileSimulator()})))},t.prototype.reloadActiveDashboard=function(){this.scope.showReloadDashboard=!1,this.services.dashboardService.loadDashboard(this.scope.viewModel.id,!0)},e.DashboardController=t})(powerbi=powerbi||{}),(function(t){var e;function o(e,t){var o=this;this.scope=e,this.scope.inProgress=!1,this.services=t,this.scope.restrictServiceOutboundFlowsEnabled=this.services.featureSwitchService.featureSwitches.restrictServiceOutboundFlowsEnabled,this.scope.toolTipForUploadButton=this.scope.restrictServiceOutboundFlowsEnabled?this.services.localizationService.get("FFXLDisabledByAdmin_ToolTip"):void 0,this.scope.chooseFormat=function(e){return o.chooseFormat(e)},this.scope.getToolTipForFFXLUploadButton=function(){return o.getToolTipForFFXLUploadButton()}}e=t.controllers||(t.controllers={}),o.createOptions=function(){return{additionalServices:["localizationService","featureSwitchService"]}},o.prototype.chooseFormat=function(e){this.scope.inProgress=!0,this.scope.$emit(t.constants.uploadFormatChosenEventName,e)},o.prototype.getToolTipForFFXLUploadButton=function(){return this.scope.toolTipForUploadButton},e.ExcelUploadFormatController=o})(powerbi=powerbi||{}),(function(u){var e,a,l,o,c,n;function t(e,t){var o=this;this.scope=e,this.services=t;var i=this.initializeSection("InFocusSection","InFocusSection");e.viewModel=u.models.inFocusViewModelFactory.createInFocus(i,t.filterGenerator,this.services.formFactor.getCurrentLayout()),e.hide=function(){return o.exitAndHide()},e.openReport=function(){return o.openReport()},e.showPinButton=function(){return o.canPin()},l.defineDataSourcesOnScopeLegacy(this.scope,this.services.dataSources),this.setDataSources(),e.pinVisual=function(){return o.pinVisual()},e.getRelatedInsights=function(){return o.getRelatedInsights()},e.getInsightsTooltip=function(){return o.getInsightsTooltip()},e.viewModeState=this.services.viewModeState,e.showRefreshErrorDetails=function(){return o.showRefreshErrorDetails()},e.inFocusMenuItems=u.models.inFocusViewModelFactory.createInFocusMenuItems(this.services.localizationService,this.scope.canExport),e.inFocusMenuItemSelected=function(e){return o.onInFocusMenuItemSelected(e)},e.showPreviousVisual=function(){return o.showPreviousVisual()},this.services.undoRedo.setStrategy(new c);var r=this.services.globalEventBridge.createChannelSubscriptionManager().subscribe(u.explore.services.events.insightsInFocusPaneClose,(function(){return o.onCloseInsightsInFocusPane()})).subscribe(u.explore.services.events.insightSelected,(function(e,t){return o.onInsightSelected({model:t.model,pinData:t.pinData,rerunInsights:t.rerunInsights})})).subscribe(u.explore.services.events.viewInsightInFocus,(function(e,t){return o.showVisualInFocus(t.pinData,{canPin:t.canPin},t.rerunInsights)}));this.routesChangeSubscription=this.services.downgradedRouterUtilities.routeChanged().subscribe((function(e){return o.handleStateChangeSuccess()}));var a=this.services.rootScope.$on(u.constants.openInFocusTileActionName,(function(e,t){return o.onOpenTile(e,t)})),n=this.services.rootScope.$on(u.constants.openInFocusWorkbookTileActionName,(function(e,t){return o.onOpenWorkbookTile(e,t)})),s=this.services.rootScope.$on(u.constants.openInFocusRealTimeTileActionName,(function(e,t){return o.onOpenRealTimeTile(e,t)}));this.scope.$on("$destroy",(function(){a(),n(),o.unregisterInsightSelectedEvent&&o.unregisterInsightSelectedEvent(),o.unregisterInsightClosePaneEvent&&o.unregisterInsightClosePaneEvent(),o.unregisterInsightsOnSelectionEvent&&o.unregisterInsightsOnSelectionEvent(),s(),o.routesChangeSubscription&&o.routesChangeSubscription.unsubscribe(),r.unsubscribeAll()})),e.viewModeState.setMode(0),this.services.pinVisual.setHandler({pinVisual:function(e){o.pinVisualHandler(e)}}),this.services.visualTimeSynchronizationService.setAnchorTimeToNow(),this.scope.realTimeTileLazyPath="@powerbi/RealTime/real-time.module#RealTimeModule"}e=u.controllers||(u.controllers={}),a=u.explore.contracts.PinData,l=u.explore.ScopeUtils,o=u.dataServices.contracts.TileType,c=u.explore.services.undoRedoStrategy.UndoRedoNoOp,n=u.dataServices.models.TileFactory,t.createOptions=function(){return{scopedDependencies:["dataSources","eventBridge","explorationCapabilities","explorationNavigation","exportData","filterGenerator","formFactor","pinVisual","selection","undoRedo","viewModeState","visualPlugin"],additionalServices:["$timeout","conceptualSchemaProxy","dashboardDataService","downgradedRouterUtilities","errorService","explorationSerializer","featureSwitchService","folderService","inFocusService","licenseEnforcementService","localizationService","modelConverter","modelService","modernDialogService","navigation","notificationToast","packageService","pbiLazyLoad","permissionService","pinTileService","resourcePackagesService","shellCapabilities","telemetryService","globalEventBridge","visualTimeSynchronizationService"]}},t.prototype.$onInit=function(){return __awaiter(this,void 0,u.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return[4,(t=this.services.shellCapabilities).ensureCapabilitiesInitialized()];case 1:return e.sent(),this.shellShowPinButton=t.getCapabilities().dashboardSettings.showPinButton,[2]}}))}))},t.prototype.toggleViewMode=function(){var e=this.scope.viewModel;this.scope.$emit(u.constants.inFocusExitEvent),e.taskPane.isPaneExpanded=!1,e.visualizationPane.isPaneExpanded=!1,this.services.viewModeState.setMode(0)},t.prototype.onCloseInsightsInFocusPane=function(){this.scope.viewModel.showInsightsInFocusPane=!1},t.prototype.onInsightSelected=function(t){return __awaiter(this,void 0,u.Promise,(function(){return __generator(this,(function(e){return t.rerunInsights||(this.scope.viewModel.showPreviousVisualButton=!0),this.services.globalEventBridge.publishToChannel(u.explore.services.events.viewInsightInFocus,{canPin:this.scope.viewModel.openInsightArgs?this.scope.viewModel.openInsightArgs.canPin:this.scope.canEdit,pinData:t.pinData,rerunInsights:!0}),[2]}))}))},t.prototype.showVisualInFocus=function(e,t,o){var i,r;e&&(i=e.modelId,r=e.packageId,r=i?this.services.modelService.findModel(i,r,!0):void 0,r=n.createTileForPinData(e,this.services.visualPlugin.capabilities(a.getVisualType(e)),r),r=this.services.modelConverter.convertTile(r,this.services.modelService.getModelContracts()),this.services.inFocusService.view(r,t,o))},t.prototype.showPreviousVisual=function(){this.services.inFocusService.inFocusTile=this.originalTile,this.generateVisual(this.originalViewTileArgs),this.scope.viewModel.showPreviousVisualButton=!1},t.prototype.onOpenTile=function(e,t){var o=this;e.stopPropagation(),(this.currentViewTileArgs=t).openInsightArgs?this.scope.$applyAsync((function(){o.scope.showInFocusMode=!0,o.generateVisual(t)})):this.scope.performTransitionAnimation(this.services.inFocusService.inFocusTile.id).then((function(){o.scope.$applyAsync((function(){o.scope.showInFocusMode=!0,o.generateVisual(t)}))}))},t.prototype.onOpenWorkbookTile=function(e,t){e.stopPropagation(),this.scope.relatedInsightsEnabled=!1,this.scope.runInsightsSupported=!1;e=t.workbook,t=this.services.inFocusService.inFocusTile;this.services.telemetryService.logEvent(u.telemetry.DashboardInFocusWorkbook,{tileId:t.contract.id,workbookId:e.contract.workbookId,packageId:e.contract.packageId}),this.setExportableState(t),this.scope.showInFocusMode=!0,this.scope.viewModel.inFocusTile=t,this.scope.viewModel.workbook=e,this.scope.viewModel.displayText=e.displayText,this.scope.viewModel.subDisplayText=e.subDisplayText},t.prototype.onOpenRealTimeTile=function(e,t){var o=this;e.stopPropagation(),this.scope.relatedInsightsEnabled=!1,this.scope.runInsightsSupported=!1;t=this.services.modelConverter.convertTile(t.contract);this.scope.viewModel.realTime=t.realTime,this.setExportableState(t),this.scope.viewModel.inFocusTile=t,this.scope.viewModel.displayText=t.displayText,this.scope.viewModel.subDisplayText=t.subDisplayText,this.scope.realTimeTileModernInputArgs={viewModel:this.scope.viewModel.realTime},this.scope.performTransitionAnimation(this.services.inFocusService.inFocusTile.id).then((function(){o.scope.showInFocusMode=!0,o.scope.$applyAsync((function(){o.scope.$emit(u.constants.inFocusEnterEvent),o.scope.clearTransitionAnimation()}))}))},t.prototype.generateVisual=function(e){var t=this.scope.viewModel;t.inFocusTile=this.services.inFocusService.inFocusTile,t.inFocusTile,this.setDataSources(t.inFocusTile),this.updateTile(t.inFocusTile,e.openInsightArgs),this.tileContractOriginal=t.inFocusTile.contract;t=this.services.telemetryService.startEvent(u.telemetry.DashboardInFocusModeSelected,{tileType:o[this.services.inFocusService.inFocusTile.composite.visual.type]});this.scope.openInFocusEvent||(this.scope.openInFocusEvent=t.event),this.services.visualPlugin.loadPluginByNameIfAny(this.services.inFocusService.inFocusTile.composite.visual.type),this.setVisualContainerProperties(e,t)},t.prototype.setVisualContainerProperties=function(e,t){var o=this,i=this.scope,r=i.viewModel,a=r.inFocusTile.config.visualContainer,n=this.services.explorationSerializer,s=n.deserializeCanvasItem(n.serializeVisualContainer(a.$visualContainer)),l=r.canvas,c=l.exploration,d=c.contract,p=c.exploreCanvas,n=this.initializeSection("fakeSection","fakeSection");this.services.explorationNavigation.loadExploration(d),d.dataSourceVariables=r.inFocusTile.config.visualContainer.dataSourceVariables,p.contract=n,d.themeCollection=a.themeCollection,this.services.viewModeState.getViewState().preventSelectionClearing=!0,s.layouts=jsCommon.ArrayExtensions.extendWithId([{id:0,position:{x:0,y:0,width:n.size.width,height:n.size.height}}]);c=u.explore.viewModels.ViewModelFactory.convertVisualContainer(d,c.sections[0].contract,s,0);this.validateDrillableVisual(c)||(t.reject({errorCode:"drillable visual in inFocus mode isn't correctly generated"}),i.inFocusDrillableError=!(t=null),this.setErrorMessage()),c.disableResize=!0;s=this.tileContractOriginal.tileDataSet;u.data.dsr.containsRestartToken(s)||(c.dataViewSource=s);s=c.contract.config.singleVisual.vcObjects||{};c.contract.config.singleVisual.vcObjects=s,u.explore.services.applyPropertyChanges({replace:[{objectName:"title",properties:{show:!1},selector:void 0}]},u.explore.contracts.VisualContainer.CommonObjectDescriptors,s),u.explore.services.selectionUtils.selectCanvasItem(c.contract,this.services.selection),l.visualContainer=c,p.visualContainers[0]=c,p.visualContainers[0].options=this.services.explorationCapabilities.getCapabilities().visualContainerOptions,p.visualContainerGroups=[p.visualContainers[0]];this.services.explorationCapabilities.setCapabilities({showAppBar:!0,showTaskPane:!0,showVisualizationPane:!0,showNavContentPane:!0,visualContainerOptions:{showMenu:!1,showPin:!1,showContextMenu:!1,disablePin:!0,hideHeader:!0},showBackButtonOnAppBar:!1,disableEnhancedTooltips:!0}),r.showVisualEnabled=!0,i.$emit(u.constants.inFocusEnterEvent),e.runScopedInsights&&(this.services.$timeout((function(){o.getRelatedInsights()})),e.runScopedInsights=!1),null!=t&&t.resolve()},t.prototype.setErrorMessage=function(){var e=this.services.localizationService;this.scope.errorMessageConfig={canEdit:this.scope.canEdit,mode:!0,titleShared:e.get("InFocusEMHeader"),titleNonShared:e.get("InFocusEMHeader"),contentShared:e.get("InFocusEMContentShared"),contentNonShared:e.get("InFocusEMContentNonShared"),contact:e.get("InFocusEMContentSharedContact")}},t.prototype.validateDrillableVisual=function(e){var t=this.services.visualPlugin.capabilities(e.contract.config.singleVisual.visualType),t=u.explore.util.DrillUtils.getDrillableRoles(t);if(0<t.length)for(var o=e.contract.config.singleVisual.query.projections,i=0,r=t;i<r.length;i++){var a=o[r[i]];if(!_.isEmpty(a)&&(1<a.all().length&&_.isEmpty(a.activeProjectionRefs)))return!1}return!0},t.prototype.setDataSources=function(e){e&&e.contract,this.services.dataSources.set(u.utils.tile.getDataSources(null==e?void 0:e.contract,null==e?void 0:e.vsName,null==e?void 0:e.dbName))},t.prototype.initializeSection=function(e,t){t={name:e,displayName:t,size:u.utils.tile.getDefaultSectionSize(),visualContainers:[],visualContainerGroups:[],filters:[]};return this.services.explorationNavigation.goto(t,!1),t},t.prototype.exitAndHide=function(){var e=this.services,t=e.dashboardDataService.activeDashboard;t&&!e.navigation.inInsightsView()&&e.navigation.navigateToDashboard(t.contract,!0),this.hide()},t.prototype.hide=function(){this.scope.showInFocusMode=!1,this.scope.viewModel.showInsightsInFocusPane=!1,this.scope.viewModel.showPreviousVisualButton=!1,this.scope.viewModel.inFocusTile=null,this.scope.viewModel.canvas.visualContainer=null,this.scope.viewModel.canvas.exploration&&(this.scope.viewModel.canvas.exploration.exploreCanvas.visualContainers=jsCommon.ArrayExtensions.createWithId(),this.scope.viewModel.canvas.exploration.exploreCanvas.visualContainerGroups=[]),this.toggleViewMode(),this.scope.inFocusDrillableError=!1,this.services.inFocusService.exit()},t.prototype.updateTile=function(e,t){this.services.filterGenerator.clearCrossHighlight(this.scope.viewModel.canvas.exploration.contract.sections[0]);var o=this.scope.viewModel;o.inFocusTile=e,o.openInsightArgs=t,o.inFocusTile&&(o.displayText=e.getDisplayText(),o.subDisplayText=e.getSubDisplayText(),e=o.inFocusTile,o.source=null!=e.report?this.services.localizationService.format("InFocus_SourceReport",[e.report.displayName]):this.services.localizationService.format("InFocus_SourceQna",[e.utterance]),this.setExportableState(e),o.pinVisualText=this.services.localizationService.get("PinVisual_ToolTip"),o.getRelatedInsightsText=this.services.localizationService.get("Insights_GetRelatedInsights"),o=e.contract,e.setDatasetModelAndPackageInfo(this.services.modelService.findModel(o.modelId,o.packageId),this.services.packageService.findPackage(o.packageId)),this.scope.runInsightsSupported=e.datasetModel.contract.insightsSupported&&!e.datasetModel.isHidden&&1==(1&e.datasetModel.getPermissions())&&!e.workbook&&!e.datasetModel.cloudRlsEnabled,this.scope.runInsightsAuthorized=this.services.permissionService.isExplorableModel(e.datasetModel),this.scope.relatedInsightsEnabled=this.scope.runInsightsSupported&&this.scope.runInsightsAuthorized,this.scope.relatedInsightsEnabled&&this.services.dataSources.get().withName(u.explore.constants.DefaultSchemaName))},t.prototype.handleStateChangeSuccess=function(){this.inInsightsOrInFocusView()||this.hide()},t.prototype.inInsightsOrInFocusView=function(){var e=this.services.downgradedRouterUtilities.getLocationPath();return new RegExp(/\/tiles\/[a-zA-Z0-9-]+\/infocus/g).test(e)},t.prototype.openReport=function(){this.services.rootScope.$emit(u.constants.openTileEventName,this.services.inFocusService.inFocusTile)},t.prototype.getRelatedInsights=function(){return __awaiter(this,void 0,u.Promise,(function(){return __generator(this,(function(e){return this.originalTile=this.scope.viewModel.inFocusTile,this.originalViewTileArgs=this.currentViewTileArgs,this.scope.viewModel.showPreviousVisualButton=!1,this.scope.viewModel.showInsightsInFocusPane?this.services.globalEventBridge.publishToChannel(u.explore.services.events.getRelatedInsights):this.scope.viewModel.showInsightsInFocusPane=!0,[2]}))}))},t.prototype.getInsightsTooltip=function(){return this.scope.runInsightsSupported?this.scope.runInsightsAuthorized?this.services.localizationService.get("Insights_GetRelatedInsights_Tooltip"):this.services.localizationService.format("Permission_ExploreRequiredForFeature",[this.services.localizationService.get("QuickInsights")]):this.services.localizationService.get("QuickInsightsDisabled_Tooltip")},t.prototype.pinVisual=function(){var t=this,e=this.scope.viewModel,o=this.services.dataSources.get(),i=e.canvas.visualContainer;this.services.conceptualSchemaProxy.get(o).then((function(e){e=i.hostServices.getFilters(t.services.filterGenerator,e);t.services.pinVisual.pinVisualContainer(o,i.contract,e,i.themeCollection,t.services.resourcePackagesService.getAllPackages())}))},t.prototype.pinVisualHandler=function(i){return __awaiter(this,void 0,u.Promise,(function(){var t,o;return __generator(this,(function(e){switch(e.label){case 0:return i?(t=this.scope.viewModel,o=t.inFocusTile.contract,i.reportId=o.reportId,0<this.scope.dataSources.length&&(i.modelId=this.scope.dataSources[0].id,i.packageId=o.packageId),o=this.scope.viewModel.inFocusTile,i.action=o.action,i.tileHeading=t.displayText,i.tileSubDisplay=t.subDisplayText,o.utterance&&(i.utterance=o.utterance),[4,this.services.pinTileService.pinVisual(i,!0)]):[2];case 1:return e.sent(),[2]}}))}))},t.prototype.showRefreshErrorDetails=function(){this.services.errorService.error(this.services.localizationService.get("TileEditor_InFocusDatasetRefreshErrorMessage"),"InFocus_DatasetRefreshError",{title:this.services.localizationService.get("TileEditor_InFocusDatasetRefreshErrorTitle")})},t.prototype.onInFocusMenuItemSelected=function(e){switch(e.action){case 0:this.qrCode();break;case 1:this.exportData()}},t.prototype.qrCode=function(){var e=this.services.inFocusService.inFocusTile,e={tile:e.contract,displayText:e.getDisplayText(),subDisplayText:e.getSubDisplayText(),dashboard:this.services.dashboardDataService.activeDashboard.contract,groupObjectId:this.services.folderService.activeFolderObjectId,appId:this.services.navigation.currentAppGUID,type:1};this.services.modernDialogService.openHostDialog({bindings:e,dialogName:"QRCodeDialog",componentName:"QRCodeDialogComponent",config:{panelClass:["no-border","transparent"]}})},t.prototype.exportData=function(){var e=this.scope.viewModel;e.inFocusTile;var t=this.services,o=t.licenseEnforcementService;o.supportsExportData&&!o.supportsExportData(!0)||(e=e.inFocusTile,t.exportData.exportTileDataToCsv({contract:e.contract,config:e.config,visual:e.composite&&e.composite.visual,dataSet:e.datasetModel&&e.datasetModel.contract}))},t.prototype.setExportableState=function(e){var t=!1,o=this.services.exportData;o&&(t=o.canExportTileData({contract:e.contract,config:e.config,visual:e.composite&&e.composite.visual,dataSet:e.datasetModel&&e.datasetModel.contract,data:e.composite&&e.composite.tileData})),this.scope.canExport=t,this.scope.inFocusMenuItems=u.models.inFocusViewModelFactory.createInFocusMenuItems(this.services.localizationService,t)},t.prototype.canPin=function(){if(!this.shellShowPinButton)return!1;var e=this.scope.viewModel,t=e.inFocusTile,e=e.openInsightArgs&&e.openInsightArgs.canPin;return!!((this.services.featureSwitchService.featureSwitches.pinReadable?this.canPinTile(t):this.scope.canEdit)||e)&&(t&&t.type!==o.workbook&&t.type!==o.realTime)},t.prototype.canPinTile=function(e){return this.currentActiveTile!==e&&(this.currentActiveTile=e,this.activeTileHasReadPermission=this.services.pinTileService.canPinTile(e)),this.activeTileHasReadPermission},e.InFocusController=t})(powerbi=powerbi||{}),(function(e){var t;function o(e,t){var o=this;this.scope=e,(this.services=t).asyncFeatureSwitchService.getFeatureSwitches().then((function(e){o.initialize(),o.scope.isInitialized=!0}))}t=e.controllers||(e.controllers={}),o.createOptions=function(){return{additionalServices:["$timeout","appService","asyncFeatureSwitchService","dashboardDataService","folderService","licenseEnforcementService","navigation","taskPaneSliderService","appStore","shellCapabilities"]}},o.prototype.initialize=function(){return __awaiter(this,void 0,e.Promise,(function(){var t,o,i;return __generator(this,(function(e){switch(e.label){case 0:return t=this.services,o=t.navigation,i=this.scope,[4,t.shellCapabilities.ensureCapabilitiesInitialized()];case 1:return e.sent(),i.inWorkbookView=function(){return o.inWorkbookView()},i.dashboardDataService=t.dashboardDataService,i.navigation=o,i.showLoadingSpinner=function(){return t.folderService.isFolderTransitionDelayed&&!o.inAppsDetailView()&&!o.inAppDetailView()},[2]}}))}))},t.LandingContainer=o})(powerbi=powerbi||{}),(function(r){var e,a,n;function t(e,t){this.scope=e,this.services=t,e.MessageBannerModulePath="@powerbi/UILibrary/message-banner/message-banner.module#MessageBannerModule",t.pinTileService.ensurePinTileService()}e=r.controllers||(r.controllers={}),a=r.common.contracts.ArtifactType,n=r.dataServices.PermissionsUtils,t.createOptions=function(){return{additionalServices:["dashboardDataService","featureSwitchService","folderService","pinTileService","localizationService","userSettingsService","groupStore","informationProtectionService","informationProtectionUIService"]}},t.prototype.$onInit=function(){return __awaiter(this,void 0,r.Promise,(function(){var t,o=this;return __generator(this,(function(e){switch(e.label){case 0:return[4,this.services.groupStore.ensureGroupArtifactsLoaded(this.services.folderService.activeFolderObjectId)];case 1:return e.sent(),t=this.scope.viewModel,this.scope.dashboardDataService=this.services.dashboardDataService,this.scope.pin=function(){return o.pin()},this.scope.cancel=function(){return o.cancel()},this.scope.saveAndContinue=function(){return o.saveAndContinue()},this.scope.noPinnableDashboard=function(){return o.noPinnableDashboard()},this.scope.getDefaultSelectedDashboardId=function(){return o.getDefaultSelectedDashboardId()},this.scope.getDashboards=function(){return o.getDashboards()},this.scope.updateFormatting=function(){return o.updateFormatting()},this.scope.isLiveReport=t.isLiveReport,this.scope.pinButtonText=this.scope.isLiveReport?this.services.localizationService.get("PinLiveReport_PinLive"):this.services.localizationService.get("ReportContainer_Pin"),this.scope.viewModel.isPinned=!1,this.scope.selectBoxKeyup=function(e){return o.selectBoxKeyup(e)},this.updateView(),t.useExistingDashboard=0!==this.scope.sortedPinnableDashboards.length,this.services.userSettingsService.getUserSettings().then((function(e){t.useDashboardFormatting=null==e.tileDialogPreviewFormat||0===e.tileDialogPreviewFormat,o.updateFormatting()})),this.scope.$watch("dashboardDataService.dashboards.length",(function(){o.updateView()})),[4,this.initializeMessageBannersAsync()];case 2:return e.sent(),[2]}}))}))},t.prototype.updateView=function(){var e=this.getSortedPinnableDashboards();this.scope.sortedPinnableDashboards=e,this.scope.viewModel.selectedDashboardId=this.getDefaultSelectedDashboardId()},t.prototype.pin=function(){return __awaiter(this,void 0,r.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return this.scope.viewModel.isPinned=!0,[4,this.services.pinTileService.onPinButtonClickedActions()];case 1:return e.sent(),[2]}}))}))},t.prototype.saveAndContinue=function(){return __awaiter(this,void 0,r.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return this.scope.viewModel.needSaveReport?[4,this.services.pinTileService.onSaveAndContinueButtonClickedActions()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},t.prototype.cancel=function(){return __awaiter(this,void 0,r.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.services.pinTileService.hideDialog()];case 1:return e.sent(),[2]}}))}))},t.prototype.updateFormatting=function(){return __awaiter(this,void 0,r.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.services.pinTileService.updateTile(this.scope.viewModel.useDashboardFormatting)];case 1:return e.sent(),[2]}}))}))},t.prototype.isDashboardPinnable=function(e){if(e.contract){var t=n.hasWriteFlag(e.getPermissions()),o=this.services.dashboardDataService.activeDashboard;return this.scope.viewModel.isPinFromDashboard&&o?t&&e.id!==o.id:t}return!1},t.prototype.getDefaultSelectedDashboardId=function(){var e=this.services.dashboardDataService.activeDashboard;if(!this.scope.viewModel.isPinFromDashboard&&e&&this.isDashboardPinnable(e))return e.id.toString();e=this.scope.sortedPinnableDashboards;return 0<e.length?e[0].id.toString():null},t.prototype.noPinnableDashboard=function(){var e;return(null===(e=this.scope.sortedPinnableDashboards)||void 0===e||!e.length)&&!(this.scope.viewModel.useExistingDashboard=!1)},t.prototype.getSortedPinnableDashboards=function(){var e=this.services,t=e.folderService,o=e.dashboardDataService,i=o.activeDashboard,o=o.dashboards,e=r.helpers.FolderContentFilteringHelper.filterDashboards(t.activeFolderObjectId,_.filter(o,(function(e){return n.hasWriteFlag(e.getPermissions())})),t,e.featureSwitchService),e=_.sortBy(e,(function(e){return e.displayName.toLowerCase()}));return this.scope.viewModel.isPinFromDashboard&&i&&_.pull(e,i),e},t.prototype.getDashboards=function(){return this.services.dashboardDataService.dashboards},t.prototype.selectBoxKeyup=function(e){27===e.keyCode&&e.stopPropagation()},t.prototype.getInformationProtectionIUCWarningAsync=function(){return __awaiter(this,void 0,r.Promise,(function(){var t,o,i,r;return __generator(this,(function(e){switch(e.label){case 0:return this.services.informationProtectionService.isInformationProtectionFeatureEnabled()?this.scope.viewModel.needSaveReport?[2]:(t=this.scope.viewModel.dashboardTile,o=!!this.scope.viewModel.sourceDashboardId,t.contract.reportId?[4,this.services.informationProtectionService.getOrLoadArtifactInformationProtection(a.Report,t.contract.reportId,null,!0).toPromise()]:[3,2]):[2];case 1:return i=e.sent(),_.isNil(i)||i.isInvalid?[3,4]:(r=this.services.informationProtectionUIService.getDisplayNameFromArtifactInformationProtection(i),[2,o?this.services.localizationService.format("PinTile_Warning_LabelInheritanceUponCreation_FromDashboard_ReportTile",[r]):this.services.localizationService.format("PinTile_Warning_LabelInheritanceUponCreation_FromReport",[r])]);case 2:return t.contract.modelId?[4,this.services.informationProtectionService.getOrLoadArtifactInformationProtection(a.Model,t.contract.modelId,null,!0).toPromise()]:[3,4];case 3:if(i=e.sent(),!_.isNil(i)&&!i.isInvalid)return r=this.services.informationProtectionUIService.getDisplayNameFromArtifactInformationProtection(i),[2,o?this.services.localizationService.format("PinTile_Warning_LabelInheritanceUponCreation_FromDashboard_DatasetTile",[r]):this.services.localizationService.format("PinTile_Warning_LabelInheritanceUponCreation_FromDataset",[r])];e.label=4;case 4:return[2]}}))}))},t.prototype.initializeMessageBannersAsync=function(){return __awaiter(this,void 0,r.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return this.scope.liveReportBannerModel={bannerType:0,iconName:"pbi-glyph-info",message:this.services.localizationService.get("PinLiveReport_RefreshMessage")},this.scope.noReshareWarningBannerModel={bannerType:2,iconName:"pbi-glyph-info",message:this.services.localizationService.get("PinTile_Warning_NoResharePermission")},[4,this.getInformationProtectionIUCWarningAsync()];case 1:return(t=e.sent())?(this.scope.showInformationProtectionWarning=!0,this.scope.informationProtectionBannerModel={bannerType:2,iconName:"pbi-glyph-info",message:t}):this.scope.showInformationProtectionWarning=!1,[2]}}))}))},e.PinTileDialogController=t})(powerbi=powerbi||{}),(function(n){var e,d,o,s;function i(e,t){var o=this;this.scope=e,this.model=this.scope.viewModel,this.services=t,this.scope.getRefreshType=function(e){return o.getRefreshType(e)},this.initModalDialog(),this.modelRefreshHistories=[],this.packageRefreshHistories=[],this.refreshHistoryTimeout=this.isPremiumWorkspace()?n.constants.refreshHistoryDialogTimeoutPremiumValue:n.constants.refreshHistoryDialogTimeoutValue,this.errorService=this.services.errorService,this.telemetryService=this.services.telemetryService,this.promiseFactory=this.services.promiseFactory,this.getRefreshHistories(),this.scope.getSelectedHistories=function(e){return o.selectHistories(e)},this.scope.isCacheRefresh=this.model.isCacheRefresh,this.isAutomaticAggregationsEnabled=this.services.featureSwitchService.featureSwitches.automaticAggregations,this.isReliableProcessingEnabled=this.services.featureSwitchService.featureSwitches.reliableProcessingHistory}e=n.controllers||(n.controllers={}),d=n.common.helpers.ModelConverterHelper,o=jsCommon.JsonExtensions,s={format:{year:"numeric",month:"numeric",day:"numeric",hour:"2-digit",minute:"numeric",second:"numeric",hour12:!1}},i.createOptions=function(){return{additionalServices:["lazy","modelHttpService","telemetryService","errorService","folderService","localizationService","promiseFactory","featureSwitchService"]}},i.prototype.getRefreshHistories=function(){var i=this,t=this.promiseFactory.defer(),o=this.promiseFactory.defer(),r=this.telemetryService.startEvent(n.telemetry.DashboardGetRefreshHistory,{refreshType:"Models"}),a=this.telemetryService.startEvent(n.telemetry.DashboardGetRefreshHistory,{refreshType:"Packages"});this.services.modelHttpService.getModelRefreshHistories(this.model.datasetModel.dataset.modelId.toString(),r.event).then((function(e){t.resolve(e),r.resolve()}),(function(e){t.resolve(e),r.reject()})),this.services.modelHttpService.getPackageRefreshHistories(this.model.datasetModel.dataset.contract.packageId.toString(),a.event).then((function(e){o.resolve(e),a.resolve()}),(function(e){o.resolve(e),a.reject()}));var e=this.services.lazy("errorFormat");this.promiseFactory.all([t.promise,o.promise,e]).then((function(e){i.model.showSpinner=!1;var t=e[0],o=e[1],e=e[2];t.data||o.data||i.errorModalConfig(t,"HistoryDialog_ScheduledAndOneDriveRefreshHistoryError"),t.data&&!o.data&&(i.modelRefreshHistories=i.cleanRefreshHistories(t.data,e),i.scope.refreshTypeSelected=0,i.errorModalConfig(o,"HistoryDialog_OneDriveRefreshHistoryError")),!t.data&&o.data&&(i.packageRefreshHistories=i.cleanRefreshHistories(o.data,e),i.scope.refreshTypeSelected=1,i.errorModalConfig(t,"HistoryDialog_ScheduledRefreshHistoryError")),t.data&&o.data&&(i.modelRefreshHistories=i.cleanRefreshHistories(t.data,e),i.packageRefreshHistories=i.cleanRefreshHistories(o.data,e),t.data.length<=0&&0<o.data.length?i.scope.refreshTypeSelected=1:i.scope.refreshTypeSelected=0)}))},i.prototype.errorModalConfig=function(e,t){this.errorService.error(this.services.localizationService.get(t),t,{requestId:e.requestId,statusCode:e.status.toString(),displayLearnMoreHelpLink:!0,helpLink:"https://go.microsoft.com/fwlink/?LinkId=799819"})},i.prototype.selectHistories=function(e){return 0===e?this.modelRefreshHistories:this.packageRefreshHistories},i.prototype.initModalDialog=function(){var e=this;this.model.showModalDialog=!0,this.scope.dialogModel=new n.common.models.ModalDialogModel(!1,this.services.localizationService.get("TopNav_HelpMenu_AboutDialog_Close"),!0,this.services.localizationService,!1,!1,!0),this.scope.closeDialog=function(){return e.closeDialog()}},i.prototype.closeDialog=function(){var e=this;this.model.showModalDialog=!1,setTimeout((function(){e.model.showHistoryDialog=!1,e.scope.$apply()}),0)},i.prototype.getRefreshType=function(e){var t=this.services.featureSwitchService.featureSwitches;return 0===e.refreshType||1===e.refreshType||2===e.refreshType||7===e.refreshType||8===e.refreshType||9===e.refreshType?e.refreshType:t.exportPbixForGeneratedModelsUI&&5===e.refreshType?5:null},i.prototype.cleanRefreshHistories=function(e,l){var c=this;return e.map((function(e){var t=e.id,o=e.refreshType||0,i=d.convertRefreshTimeToLocaleString(e.startTime,c.services.localizationService),r=e.endTime?d.convertRefreshTimeToLocaleString(e.endTime,c.services.localizationService):"",a=c.getFriendlyErrorMessage(e,l),n=c.getStatusMessage(e),s=e.isSuccessful;return c.isPackageRefreshHistory(e)?{id:t,refreshType:o,startTime:i,endTime:r,isSuccessful:s,showDetailLink:!1===s,packageId:e.packageId||0,status:n,details:l.convertErrorDetailsJson(e.serviceExceptionJson),serviceExceptionJson:e.serviceExceptionJson,friendlyErrorMessage:a}:c.isModelRefreshHistory(e)?{id:t,refreshType:o,startTime:i,endTime:r,isSuccessful:s,showDetailLink:!1===s||c.shouldShowDetailLink(e),status:n,details:c.getModelRefreshDetails(e,l),modelId:e.modelId||0,serviceExceptionJson:e.serviceExceptionJson,friendlyErrorMessage:a}:void 0})).filter((function(e){return!!e}))},i.prototype.getFriendlyErrorMessage=function(e,t){if(this.isModelRefreshHistory(e)&&4===e.status)return this.services.localizationService.get("HistoryDialog_RefreshDisabledMessage");var o=this.getModelRefreshTrainingMessage(e);return _.isEmpty(o)?t.getFriendlyErrorMessage(e.serviceExceptionJson):o},i.prototype.getStatusMessage=function(e){var t=this.services.localizationService;if(i.isRefreshInProgress(e,this.refreshHistoryTimeout))return t.get("InProgress");if(i.isRefreshTimedOut(e,this.refreshHistoryTimeout))return t.get("HistoryDialog_RefreshStatus_TimedOut");if(this.isPackageRefreshHistory(e))return e.isSuccessful?t.get("Completed"):t.get("Failed");var o=this.tryParsePerformanceAcceleratorDetails(e);switch(e.status){case 1:return o&&"Completed"!==o.status?t.get("HistoryDialog_PartiallyCompleted"):t.get("Completed");case 4:return t.get("Disabled");case 2:return t.get("Failed");case 5:return t.get("Canceled");case 6:case 7:return t.get("InProgress");case 8:return t.get("HistoryDialog_RefreshStatus_TimedOut");default:return""}},i.isRefreshInProgress=function(e,t){var o=d.convertRefreshTimeToJsDateTime(e.startTime);return!(e.endTime||!o)&&o.getTime()+t>=Date.now()},i.isRefreshTimedOut=function(e,t){var o=d.convertRefreshTimeToJsDateTime(e.startTime);return!(e.endTime||!o)&&o.getTime()+t<Date.now()},i.prototype.isPremiumWorkspace=function(){var e=this.services.folderService;return e&&e.activeFolder&&!!e.activeFolder.capacity},i.prototype.isModelRefreshHistory=function(e){return void 0!==e.modelId},i.prototype.isPackageRefreshHistory=function(e){return void 0!==e.packageId},i.prototype.tryParsePerformanceAcceleratorDetails=function(e){var t=null;if(!this.isAutomaticAggregationsEnabled||_.isEmpty(e.modelRefreshExtendedInfos))return t;e=_.find(e.modelRefreshExtendedInfos,(function(e){return 1===e.infoType}));return t=e?o.tryParseJSON(e.extendedInfoDetails):t},i.prototype.tryParseReliableProcessingDetails=function(e){var t=null;if(!this.isReliableProcessingEnabled||_.isEmpty(e.modelRefreshExtendedInfos))return t;e=_.find(e.modelRefreshExtendedInfos,(function(e){return 2===e.infoType}));return t=e?o.tryParseJSON(e.extendedInfoDetails):t},i.prototype.shouldShowDetailLink=function(e){var t=this.tryParsePerformanceAcceleratorDetails(e),e=this.tryParseReliableProcessingDetails(e);return!_.isEmpty(t)||!_.isEmpty(e)},i.prototype.getModelRefreshDetails=function(e,t){var o=t.convertErrorDetailsJson(e.serviceExceptionJson),i=this.tryParsePerformanceAcceleratorDetails(e),r=this.tryParseReliableProcessingDetails(e);if(_.isEmpty(i)&&_.isEmpty(r))return o;var a=[],n=this.services.localizationService;return _.isEmpty(i)||(_.isEmpty(o)&&(_.isEmpty(i.clusterURL)||a.push({Name:n.get("ServerError_ClusterUriText"),Value:i.clusterURL}),_.isEmpty(i.activityId)||a.push({Name:n.get("ServerError_ActivityIdText"),Value:i.activityId}),_.isEmpty(i.requestId)||a.push({Name:n.get("ServerError_RequestIdText"),Value:i.requestId}),_.isEmpty(i.time)||a.push({Name:n.get("ServerError_TimestampText"),Value:d.getLocaleStringFromRefreshTime(i.time,s)})),_.isEmpty(i.trainingStartTime)||a.push({Name:n.get("HistoryDialog_TrainingStartTime"),Value:d.getLocaleStringFromRefreshTime(i.trainingStartTime,s)}),_.isEmpty(i.trainingEndTime)||a.push({Name:n.get("HistoryDialog_TrainingEndTime"),Value:d.getLocaleStringFromRefreshTime(i.trainingEndTime,s)}),_.isEmpty(i.errorMsg)||a.push({Name:n.get("HistoryDialog_TrainingError"),Value:i.errorMsg}),_.isEmpty(null===(t=i.numOfAggTable)||void 0===t?void 0:t.toString())||a.push({Name:n.get("HistoryDialog_TrainingNumAggregation"),Value:i.numOfAggTable.toString()}),_.isEmpty(null===(t=i.storageUsedInMB)||void 0===t?void 0:t.toString())||a.push({Name:n.get("HistoryDialog_TrainingSizeAggregations"),Value:i.storageUsedInMB.toString()})),_.isEmpty(r)||(_.isEmpty(r.messages)||_.isEmpty(r.messages[0].message)||a.push({Name:n.get("ServerError_ModelRefresh_DataSourceErrorLabel"),Value:r.messages[0].message}),_.isEmpty(e.rootActivityId)||a.push({Name:n.get("ServerError_RequestIdText"),Value:e.rootActivityId}),_.isEmpty(e.endTime)||a.push({Name:n.get("ServerError_TimestampText"),Value:d.getLocaleStringFromRefreshTime(e.endTime,s)})),null!=o&&o.length?o.concat(a):a},i.prototype.getModelRefreshTrainingMessage=function(e){var t;if(!this.isModelRefreshHistory(e))return"";var o=this.tryParsePerformanceAcceleratorDetails(e);if(_.isEmpty(o))return"";var i=this.services.localizationService;switch(e.status){case 1:if("Completed"!==o.status)return i.get("HistoryDialog_TrainingFailedRefreshSucceeded");switch(null===(t=o.supportability)||void 0===t?void 0:t.PAWarningType){case"HybridTable":return i.get("HistoryDialog_TrainingSucceeded_NoDQTableFound");case"UnsupportedDatasource":return i.get("HistoryDialog_TrainingSucceeded_UnsupportedDataSourceSkipped");case"SSOEnabled":return i.get("HistoryDialog_TrainingSucceeded_SSODataSourceSkipped");default:return i.format("HistoryDialog_TrainingSucceededRefreshSucceeded",o.storageUsedInMB,o.queryCoverage)}case 2:return"Failed"===o.status?i.get("HistoryDialog_TrainingFailedRefreshFailed"):i.get("HistoryDialog_TrainingSucceededRefreshFailed");default:return""}},e.HistoryDialogController=i})(powerbi=powerbi||{}),(function(e){function t(e,t,o){var i=this;e.filteredModels,this.scope=e,this.services=t,this.settingsGroupsType=o;t=this.scope.viewModel;this.scope.onDatasetSelected=function(e){return i.onDatasetSelected(e)},this.scope.itemsList=[],(o=this.services.downgradedRouterUtilities.getCurrentActivatedRouteSnapshotLeaf().paramMap.get("settingsId"))?t.currentDatasetId=this.getIdFromDbName(o):!t.currentDatasetId&&0<this.scope.filteredModels.length&&(t.currentDatasetId=_.sortBy(this.scope.filteredModels,(function(e){return e.displayName.toUpperCase()}))[0].id)}e=e.controllers||(e.controllers={}),t.createOptions=function(){return{additionalServices:["errorService","featureSwitchService","localizationService","modelService","packageService","navigation","usageMetricsReport","permissionService","promiseFactory","folderService","downgradedRouterUtilities"]}},t.prototype.$onInit=function(){this.scope.watermarkConfig={canEdit:!0,mode:!1,titleNonShared:this.services.localizationService.get("ContentList_EmptyDatasetsTitle"),contentNonShared:this.services.localizationService.get("ContentList_EmptyDatasetsMessage"),imgClass:"empty-datasets-img"}},t.prototype.getIdFromDbName=function(t){var e=_.find(this.scope.viewModel.datasets,(function(e){return e.contract.dbName===t}));if(e)return e.modelId},t.prototype.onDatasetSelected=function(t){var o=this;this.scope.viewModel.currentDatasetId=parseInt(t,10);var e=this.services.promiseFactory.defer(),i=_.find(this.scope.viewModel.datasets,(function(e){return e.modelId===o.scope.viewModel.currentDatasetId})),r=_.find(this.scope.filteredModels,(function(e){return e.id.toString()===t}));return i&&(i.isDirty||i.isQnaDirty)?this.displayLeaveConfirmationModal(r.dbName):(this.setCurrentDataset(r.dbName),e.resolve(!0),e.promise)},t.prototype.displayLeaveConfirmationModal=function(o){var i=this,r=this.services.errorService.control(),e=this.services.localizationService,a=this.services.promiseFactory.defer(),t=this.services.localizationService.get("Settings_DiscardChangesWarning_YesOption"),n=this.services.localizationService.get("Settings_DiscardChangesWarning_CancelOption"),s=[new InJs.ModalDialogAction(t,function(e,t){r.hideDialog(),i.setCurrentDataset(o),a.resolve(!0)}),new InJs.ModalDialogAction(n,function(e,t){r.hideDialog(),a.resolve(!1)})],t=e.get("SettingsDataset_DiscardChangesWarning_Title"),e=e.get("datasets"===this.settingsGroupsType?"SettingsDataset_DiscardChangesWarning_DatasetMessage":"SettingsDataset_DiscardChangesWarning_WorkbookMessage");return r.showCustomDialog(t,$("<div></div>").text(e),s,(function(e){e.parent().find('input[value="'+n+'"]').focus()}),!0),a.promise},t.prototype.setCurrentDataset=function(e){this.services.navigation.showSettingsSlider(this.settingsGroupsType,e)},e.SettingsDataModelsController=t})(powerbi=powerbi||{}),(function(e){var t;function o(e,t){var o=this;this.scope=e,this.services=t,this.scope.getModuleConfig=function(){return o.getModuleConfig()},this.scope.hideTaskPaneSlider=function(){return o.services.taskPaneSliderService.collapsePane()},this.scope.hideTaskPaneSliderOnClick=function(){return o.hideTaskPaneSliderOnClick()},this.scope.showOverlayClasses=function(){return o.showOverlayClasses()}}t=e.controllers||(e.controllers={}),o.createOptions=function(){return{additionalServices:["$element","$timeout","featureSwitchService","taskPaneSliderService"]}},Object.defineProperty(o.prototype,"useModernEditMyWorkspaceBlade",{get:function(){return this.services.featureSwitchService.featureSwitches.useModernEditMyWorkspaceBlade},enumerable:!1,configurable:!0}),o.prototype.$onInit=function(){this.expandCollapsiblePane()},o.prototype.updatePaneVisibility=function(t,e,o,i){var r=this,a=this.scope.viewModel;a.collapsiblePane.isExpanded=t,a.collapsiblePane.expandedWidth=o||3,a.previousMode=this.scope.viewModel.collapsiblePaneMode,a.collapsiblePaneMode=e||0,a.parameters=i||{},this.services.$timeout((function(){var e;t&&!jQuery.contains(r.services.$element.get(0),document.activeElement)&&(e=r.services.$element.find(":tabbable"),_.some(e)&&e.first().focus())}))},o.prototype.getModuleConfig=function(){return{name:"powerbi.sidePanes",namespace:"powerbi.sidePanes",dependency:{javascript:"powerBISidePanes",css:["powerBISidePanes"]}}},o.prototype.expandCollapsiblePane=function(){var e=this.scope.viewModel;this.updatePaneVisibility(!0,e.collapsiblePaneMode,e.collapsiblePane.expandedWidth,e.parameters)},o.prototype.hideTaskPaneSlider=function(){this.updatePaneVisibility(!1,0,3)},o.prototype.showOverlayClasses=function(){var e=[{isCollapsiblePaneExpanded:this.scope.viewModel.collapsiblePane.isExpanded}];return this.isThemeTaskPane()?e.push({showOverlayForThemePane:!0}):e.push({showOverlay:!0}),e},o.prototype.isThemeTaskPane=function(){return 30===this.scope.viewModel.collapsiblePaneMode},o.prototype.hideTaskPaneSliderOnClick=function(){this.services.taskPaneSliderService.shouldNotCollapsePaneOnClick()||(this.services.taskPaneSliderService.collapsePane(),this.scope.$broadcast(e.constants.hideTaskPaneSliderOnClickEventName))},t.TaskPaneSliderController=o})(powerbi=powerbi||{}),(function(n){var e,a,t,o;function i(e,t){var o=this;this.services=t,this.tileRefreshRetryCount=0,this.unregisterViewModelChanged=function(){return _.noop()},this.unregisterTrustedVisualErrorChanged=function(){return _.noop()};var i,r=(this.scope=e).viewModel;this.visualType=r.visual&&r.visual.type,r.visual&&r.contract&&((i=this.services.dashboardDataService.findDashboard(r.contract.dashboardId))&&(r.visual.dashboardId=i.objectId)),t.trustedVisual.isTrustedVisual(this.visualType)&&(this.onTrustedVisualErrorChanged(),this.unregisterTrustedVisualErrorChanged=t.rootScope.$on(n.explore.constants.trustedVisualConsentStateChangedEventName,(function(){o.onTrustedVisualErrorChanged()}))),r.updateVisualInteractivityOptions("true"===e.allowInteractivity),this.onViewModelChanged(),this.unregisterViewModelChanged=e.$watch("viewModel",(function(){return o.onViewModelChanged()})),e.$on(a.scopeDestroyEventName,(function(){o.unregisterViewModelChanged(),o.unregisterTrustedVisualErrorChanged(),o.services.dashboardThemeService.unsubscribe(o.themeChangeHandler),o.reloadEmptyVisualsSubscriptionManager&&o.reloadEmptyVisualsSubscriptionManager.unsubscribeAll()})),this.themeLoaded=!1,this.ensureThemeLoaded()}e=n.controllers||(n.controllers={}),a=n.common.constants,t=n.dataServices.contracts.TileType,o=n.visualHost.CustomVisualsUtils,i.createOptions=function(){return{additionalServices:["dashboardDataService","dashboardThemeService","dataProxy","localizationService","modelConverter","telemetryService","visualPlugin","modelService","featureSwitchService","promiseFactory","resourcePackagesService","approvedResourceService","themeService","trustedVisual","globalEventBridge","managedCustomVisualsService"],scopedDependencies:["resourceLoader"]}},i.prototype.$onInit=function(){return __awaiter(this,void 0,n.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return[4,this.services.managedCustomVisualsService.isPublicManagedVisualByVisualType(this.visualType)];case 1:return t=e.sent(),this.isCustomVisualTypeDisabled=o.isCustomVisualTypeDisabled(this.services.featureSwitchService,this.visualType,this.services.approvedResourceService,!1,t),(this.isCustomVisualTypeDisabled||o.isOrganizationalCustomVisual(this.visualType))&&this.validateVisualPluginHandler(this.visualType),[2]}}))}))},i.prototype.readyToRender=function(){return!this.scope.viewModel.isLoading&&this.themeLoaded},i.prototype.onViewModelChanged=function(){var e,t,o,i=this,r=this.scope,a=r.viewModel;a&&(this.initTileData(),t=a.contract,e=a.visual&&a.visual.type,this.visualType,o=this.services.modelService.findModel(t.modelId,t.packageId),o=!(t=!!t.queryResultError)&&a.isDataStale(o?o.lastRefreshEpochTime:void 0),this.shouldRefreshData(t,o)&&(this.tileRefreshRetryCount++,a.isLoading=!a.tileData.data,this.scope.$emit(n.constants.refreshTileData,a.contract.modelId),a.setDataLoadEventDelegate((function(){return i.services.telemetryService.startEvent(n.telemetry.DashboardLoadTileData,{tileId:a.contract.id,modelId:a.contract.modelId})}))),a.setDependencies(this.services.dataProxy),n.tileDataRefreshWorker(this.scope,this.services.modelConverter,a),a.errorText=a.errorText||this.services.localizationService.get("Tile_ErrorText"),a.onErrorDelegate=function(){return i.onErrorChanged()},r.allowDeferredRendering=e&&!this.services.visualPlugin.isLightWeightRenderingVisual(e),a.onErrorDelegate(),a.shouldBeIncludedInTelemetryMeasurement=!(!a.tileData||!a.tileData.data||t))},i.prototype.onErrorChanged=function(){var e=this.scope.viewModel;e&&e.isError?(this.services.telemetryService.logEvent(n.telemetry.DashboardTileError,{tileType:t[t.composite],message:e.errorText}),this.scope.$emit(a.tileErrorEventName,e.errorText,e.errorDetails)):this.scope.onClearTileError()},i.prototype.shouldRefreshData=function(e,t){if(this.tileRefreshRetryCount>=i.tileRefreshRetryMaxCount)return!1;if(e)return!1;e=this.scope.viewModel;return!!e.tileData&&(!!e.requiresData()&&(!e.tileDataIsVolatile&&(!e.tileData.data||t)))},i.prototype.initTileData=function(){var t=this.scope.viewModel;if(!t.tileData){var o=this.services;try{t.tileData=o.modelConverter.convertTileData(t.contract)}catch(e){t.isError=!0,t.errorText=o.localizationService.get("Tile_DsrParseErrorText")}}},i.prototype.onVisualDataChanged=function(){var e=this.scope.viewModel;this.services.globalEventBridge.publishToChannel(n.common.events.tileVisualLoadedChanged,e.contract.id)},i.prototype.onTrustedVisualErrorChanged=function(){var e=this.scope.viewModel.visual.type;this.services.trustedVisual.isTrustedVisual(e)&&((e=this.services.trustedVisual.validate(e))?(this.scope.viewModel.errorDetails=e,this.scope.viewModel.errorText=e.message,this.scope.viewModel.isError=!0):this.scope.viewModel.isError=!1,this.onErrorChanged())},i.prototype.validateVisualPluginHandler=function(o){var i=this;this.services.resourcePackagesService.getPackage(o)&&!this.services.visualPlugin.getPlugin(o)?this.reloadEmptyVisualsSubscriptionManager=this.services.globalEventBridge.createChannelSubscriptionManager().subscribe(n.events.reloadEmptyVisuals,(function(e,t){_.includes(t.visualTypes,o)&&(i.reloadEmptyVisualsSubscriptionManager.unsubscribeAll(),i.validateVisualPlugin(o))})):this.validateVisualPlugin(o)},i.prototype.validateVisualPlugin=function(e){this.services.visualPlugin.isCustomVisual(e)&&(this.isCustomVisualTypeDisabled?this.showCustomVisualDisabledMessage():o.isOrganizationalCustomVisual(e)&&!this.services.resourcePackagesService.getPackage(e)&&this.showCustomVisualDeletedMessage())},i.prototype.showCustomVisualDisabledMessage=function(){var e,t,o=this.services.localizationService,i=o.get("ContactYourAdministratorForDetails"),r=this.scope.viewModel,a=this.services.featureSwitchService.featureSwitches,o=a&&a.customVisualsTenantSwitch&&!a.customVisualsTenantEnabled?(e=o.get("VisualContainer_CustomVisualDisabledByAdmin"),t="https://go.microsoft.com/fwlink/?linkid=2100000",o.get("VisualContainer_CustomVisualDisabledByAdmin_tileDetails")):(e=o.get("VisualContainer_UncertifiedDisabledValue"),t="https://go.microsoft.com/fwlink/?linkid=2002010&clcid=0x409",o.get("VisualContainer_UncertifiedDisabledValue_tileDetails"));r.errorDetails={message:e,displayableErrorInfo:[{errorInfoKey:o,errorInfoValue:i}],hideAdditionalErrorInfo:!0,hideGetHelpLink:!1,forceShowError:!0,helpLink:t},r.errorText=e,r.isError=!0,this.onErrorChanged()},i.prototype.showCustomVisualDeletedMessage=function(){var e=this.services.localizationService,t=e.get("CustomVisualsAreNotAvailable"),o=e.get("ServiceError_CannotLoadVisual"),i=e.get("CustomVisualsAreNotAvailable"),e=this.scope.viewModel;e.errorDetails={message:t,displayableErrorInfo:[{errorInfoKey:o,errorInfoValue:i}],hideAdditionalErrorInfo:!0,hideGetHelpLink:!1,forceShowError:!0,helpLink:"https://go.microsoft.com/fwlink/?LinkID=690865"},e.errorText=t,e.isError=!0,this.onErrorChanged()},i.prototype.loadThemeAndBaseTheme=function(){var e=this;n.visualHost.ThemeUtils.loadThemeAndBaseTheme(this.services.promiseFactory,this.services.resourceLoader,this.services.themeService,this.services.resourcePackagesService.getAllPackages(),this.scope.viewModel.themeCollection).finally((function(){e.themeLoaded=!0,e.scope.$applyAsync()}))},i.prototype.ensureThemeLoaded=function(){var o,i=this,e=this.services.dashboardDataService,t=this.services.dashboardThemeService;e&&e.activeDashboard&&t&&t.isDashboardThemeLoaded?(e=e.activeDashboard,o=e&&e.objectId,t.isDashboardThemeLoaded(o)?this.loadThemeAndBaseTheme():(this.themeChangeHandler={onDashboardThemeLoaded:function(e,t){o!==t||i.themeLoaded||i.loadThemeAndBaseTheme()},onDashboardThemeChanged:_.noop},t.subscribe(this.themeChangeHandler))):this.loadThemeAndBaseTheme()},i.tileRefreshRetryMaxCount=1,e.CompositeTileController=i})(powerbi=powerbi||{}),(function(n){var s,a,l,c,o,i,r,d,p;function e(e,t){var o=this;this.scope=e,this.services=t,this.unregisterViewModelChanged=function(){return _.noop()};var i=e.viewModel;this.isHovered=!1,e.isTileError=!1,e.model=i,e.openTile=function(e,t){return o.openTile(e,t)},e.openNotifications=function(e){return o.openNotifications(e)},e.isReadOnly=function(){return o.isReadOnly()},e.isOpenable=function(e){return o.isOpenable(!0)},e.isNonActionable=function(){return o.isNonActionable()},e.displayDashboardTileOpenOptions=function(){return o.displayDashboardTileOpenOptions()},e.setHover=function(e){return o.setHover(e)},e.displayDashboardTileShowIcon=function(){return o.displayDashboardTileShowIcon()},e.viewportContextSelector=e.viewportContextSelector||l.dashboardSelector,e.disableInteractions=!!e.disableInteractions,e.getTileAriaLabel=function(){return o.getTileAriaLabel()};var r=i.contract;i.setDatasetModelAndPackageInfo(this.services.modelService.findModel(r.modelId,r.packageId),this.services.packageService.findPackage(r.packageId));var a=this.services.rootScope.$on(s.DashboardTileController.Events.DeleteTile,(function(e,t){t===o.scope.model&&(e.stopPropagation&&e.stopPropagation(),o.services.$element.hide())}));e.hasSpotlight=function(){return!(!i||!i.hasSpotlight)},e.isModelTile=i&&i.model&&i.contract&&!i.contract.config,e.isWorkbookTile=i&&i.workbook&&i.contract&&"number"==typeof i.contract.workbookId,e.exportVisualData=function(e){return o.exportVisualData(e)};var n=this.services.$element;n.on(c.focusOutEventName,(function(e){return o.onFocusOut(e)})),this.setCanExportVisualData(),this.updateReportModel(i),e.refreshingPermissions=!!i.isLocked,i.isLocked&&t.permissionRefresh.refreshDashboardTilePermissionsUponLoad(t.dashboardDataService.activeDashboard).finally((function(){e.refreshingPermissions=!1})),this.isReportTile()&&this.setReportTileContext(i),e.$on(l.scopeDestroyEventName,(function(){a(),o.unregisterViewModelChanged(),n.off(c.focusOutEventName),o.services.dashboardThemeService.unsubscribe(o.themeChangeHandler)})),this.setInViewPort(),this.unregisterViewModelChanged=e.$watch("viewModel.composite",(function(){return o.updateTileStyles()})),this.setUpThemeHandlers(),this.updateTileStyles(),this.logEventForRealtimeTile(i)}s=n.controllers||(n.controllers={}),a=jsCommon.CssConstants,l=n.common.constants,c=jsCommon.DOMConstants,o=jsCommon.E2EUtils,i=n.a11y.util.FocusUtility,r=n.common.constants.tileActions,d=n.dataServices.contracts.TileType,p=n.dataServices.TileUtils,e.createOptions=function(){return{additionalServices:["pinTileService","contentProviderHttpService","telemetryService","$element","$injector","inFocusService","featureSwitchService","localizationService","reportService","modelService","packageService","workbookService","userNotificationInfo","userNotificationTileFilterService","folderService","navigation","dashboardDataService","userInfo","dashboardService","auditing","platformCapabilities","taskPaneSliderService","globalEventBridge","licenseEnforcementService","modernDialogService","$timeout","permissionRefresh","permissionService","dashboardThemeService","shellCapabilities"],scopedDependencies:["exportData"]}},Object.defineProperty(e.prototype,"sidePaneStoreService",{get:function(){return this.services.$injector.get("sidePaneStoreService")},enumerable:!1,configurable:!0}),e.prototype.logEventForRealtimeTile=function(e){e&&e.contractsModel&&(e.contractsModel.realTimeMode||e.contractsModel.pushDataVersion)&&this.services.telemetryService.logEvent(n.telemetry.DashboardRealtimeModelLoad,{modelId:e.contractsModel.id,realtimeMode:e.contractsModel.realTimeMode||0,pushdataVersion:e.contractsModel.pushDataVersion||0,controller:"DashboardTileController"})},e.prototype.onFocusOut=function(e){var t=this;this.services.$timeout((function(){var e=document.activeElement;$(e).hasClass("openTileOptionsBtn")?$(e).attr("aria-hidden","false"):i.isFocusInTree(t.services.$element)||t.setHover(!1)}))},e.prototype.setInViewPort=function(){var e=this.scope.viewModel,e=n.dataServices.ContractUtils.getMasterLayoutPosition(e.contract);e&&(this.scope.inViewport=e.x+e.width<=7&&e.y+e.height<=6)},e.prototype.isReadOnly=function(){return!this.scope.canEdit||this.scope.disableInteractions},e.prototype.isNonActionable=function(){var e=this.scope.viewModel;return!e||!e.action||!e.action.action||this.scope.disableInteractions},e.prototype.setHover=function(e){this.isHovered=e},e.prototype.displayDashboardTileOpenOptions=function(){if(o.isE2EV2Run())return!0;if(this.scope.viewModel.isLocked&&this.isReadOnly())return!1;var e=this.scope.viewModel,t=this.services.platformCapabilities.supportsMouseover;return this.scope.inViewport&&(this.isHovered||!t)&&e&&!e.isTemporary&&!this.scope.disableInteractions&&!this.scope.inEditMobileLayoutMode},e.prototype.displayDashboardTileShowIcon=function(){return this.scope.disableInteractions},e.prototype.isReportTile=function(){var e=this.scope.viewModel;return e&&null!=e.reportTile},e.prototype.setCanExportVisualData=function(){var t,o,i,r=this;this.services.exportData&&(t=this.services.exportData,(o=this.scope.viewModel).type===d.composite?i=this.scope.$watch("viewModel.composite.tileData",(function(e){e&&(r.scope.canExport=t.canExportTileData({contract:o.contract,config:o.config,visual:o.composite&&o.composite.visual,dataSet:o.datasetModel&&o.datasetModel.contract,data:o.composite&&o.composite.tileData}),i())})):this.scope.canExport=t.canExportTileData({contract:o.contract,config:o.config,visual:o.composite&&o.composite.visual,dataSet:o.datasetModel&&o.datasetModel.contract,data:o.composite&&o.composite.tileData}))},e.prototype.exportVisualData=function(e){e.stopPropagation();var t,o,i,r=this.services,a=r.licenseEnforcementService;a.supportsExportData&&!a.supportsExportData(!0)||(t=this.scope.viewModel,o=p.getVisualType(t.config),e=this.services.userInfo.isPremiumUser,a=t.contract&&t.contract.id,i=r.telemetryService.startEvent(n.telemetry.EXExportVisualData,{visualType:o,source:"Dashboard",isPartialResult:!1,dest:0,isPremiumUser:e,isDrillToDetailsMode:!1,dataType:0}),this.services.exportData.exportTileDataToCsv({contract:t.contract,config:t.config,visual:t.composite&&t.composite.visual,dataSet:t.datasetModel&&t.datasetModel.contract}).then((function(e){i.event.info.isPartialResult=e.isPartialResult,i.resolve()}),(function(e){i.reject({errorCode:e.errorDetails&&e.errorDetails.errorType.toString()})})),this.services.auditing.auditEvent(a,3,11))},e.prototype.getTileAriaLabel=function(){var e=this.scope.viewModel;return e.displayText||e.subDisplayText||this.services.localizationService.get("ArtifactKind_Tile")},e.prototype.updateReportModel=function(t){return __awaiter(this,void 0,n.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return t&&t.report?[4,this.services.reportService.ensureReportsInitialization()]:[3,2];case 1:e.sent(),t.report=this.services.reportService.findReport(t.report.id),e.label=2;case 2:return[2]}}))}))},e.prototype.setReportTileContext=function(t){return __awaiter(this,void 0,n.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return this.scope.isTileError=t.reportTile.isError,t.report&&t.action.action===r.openReportActionName?[4,this.services.reportService.ensureReportsInitialization()]:[3,2];case 1:e.sent(),this.services.reportService.findReport(t.report.id)||this.services.reportService.addReport(t.report),this.services.modelService.findModel(t.report.modelId)||this.services.modelService.addContractModel(t.contractsModel),e.label=2;case 2:return[2]}}))}))},e.prototype.isOpenable=function(e,t){var o=this.scope.model,i=o&&o.composite&&o.composite.isError;if(this.scope.disableInteractions||this.scope.inEditMobileLayoutMode)return!1;if(!e&&o.isLocked)return!1;if(!e&&i)return!1;if(!e&&this.isReportTile())return!1;if(this.scope.isTileElementChanging())return!1;if(o.isLoading)return!1;if(t)try{var r=$(t.target);if(r.is("a")&&!r.hasClass("dashboardTileLayout"))return!1}catch(e){}return!0},e.prototype.openTile=function(e,t){var o=this.scope;if(o.disableInteractions||this.scope.inEditMobileLayoutMode)return t&&t.preventDefault&&t.preventDefault(),!1;t&&t.keyCode&&(e=!0);var i,r,a=this.isOpenable(e,t);return a?(o.$emit(n.constants.openTileEventName,o.model),t&&t.stopPropagation&&t.stopPropagation()):o.viewModel.isLocked&&!o.refreshingPermissions&&(i=this.services.modernDialogService,r=this.services.localizationService.get("PermissionCenter_PermissionRequired_Title"),e=this.services.localizationService.get("PermissionCenter_PermissionRequired_Description"),t=this.services.localizationService.get("PBI_Button_Label_Close"),i.promptSimpleDialog(r,e,{},{url:"//go.microsoft.com/fwlink/?linkid=858549",text:"Generic_LearnMore"},t)),a||this.services.globalEventBridge.publishToChannel(n.services.events.tileNotOpenable,o.model),a},e.prototype.openNotifications=function(e){e&&e.stopPropagation&&e.stopPropagation();var t=this.scope.viewModel.contract.id,e=this.services.userNotificationInfo.userNotifications.notifications,e=_.filter(this.services.userNotificationTileFilterService.filterNotifications(e,t),(function(e){return!e.seen}));if(!_.isEmpty(e))for(var o=0,i=e;o<i.length;o++){var r=i[o];r.message.filterProperties&&r.message.filterProperties.UserDataAlertRuleId&&this.services.telemetryService.logEvent(n.telemetry.DataAlertsTileBadgeClicked,{alertId:parseInt(r.message.filterProperties.UserDataAlertRuleId,10)})}this.services.userNotificationTileFilterService.tileId=t,this.sidePaneStoreService.openNotificationPane()},e.prototype.updateTileStyles=function(e){var t,o,i,r;this.services.dashboardDataService.activeDashboard&&(t=this.scope.viewModel,o=this.services.dashboardDataService.activeDashboard.objectId,i=this.services.dashboardThemeService,t.type!==d.composite||!t.composite||(!(r=(r=t.composite.themeCollection).customTheme&&r.customTheme.name)||i.isBuiltInTheme(r)||i.isLegacyThemeName(r)||i.getTheme(r))&&(e=e||i.getDashboardThemeName(o))&&(t.themeName=e,this.tileStyles=i.getTileStyles(e),t.tileStyles=this.tileStyles,t.tileHeaderStyles=_.pick(this.tileStyles,a.colorProperty),t.tileBackground=_.pick(this.tileStyles,a.backgroundColorProperty),t.composite.setThemeName(t.themeName)))},e.prototype.setUpThemeHandlers=function(){var o=this;this.themeChangeHandler={onDashboardThemeChanged:function(e){o.updateTileStyles(e)},onDashboardThemeLoaded:function(e,t){null!=o.services.dashboardDataService.activeDashboard&&t===o.services.dashboardDataService.activeDashboard.objectId&&o.updateTileStyles(e)},onReloadTheme:function(e){o.updateTileStyles(e)}},this.services.dashboardThemeService.subscribe(this.themeChangeHandler)},e.Events={DeleteTile:"DeleteTile"},s.DashboardTileController=e})(powerbi=powerbi||{}),(function(u){var e,n,h,l,r,i,s,a,g,v,c,m;function p(e,t){var o=this;this.scope=e,this.services=t,e.reportTilesPopulated=!1,s.defineDataSourcesOnScopeLegacy(this.scope,this.services.dataSources);t=this.services.viewModeState;t.setMode(0),t.updateConfig((function(e){e.displayOptions.hideNavigationPane=!0,e.displayOptions.hideOutspaceFormatting=!0}));var i=this.scope.$on(u.constants.populateDashboardWithReportTiles,(function(){o.populateReportTiles()})),t=new c;this.services.undoRedo.setStrategy(t);var r=this.scope.viewModel,a=this.services.eventBridge.createChannelSubscriptionManager();a.subscribe(n.events.liveReportTileReady,(function(){o.services.globalEventBridge.publishToChannel(n.events.tileVisualLoadedChanged,r.contract.id)})).subscribe(u.explore.services.events.reportVisualError,(function(e,t){o.services.globalEventBridge.publishToChannel(u.explore.services.events.reportVisualErrorGlobal,t)})),this.scope.$on("$destroy",(function(){i(),a.unsubscribeAll(),o.services.reportRefresh.destroy()})),this.populateReportTiles().finally((function(){return e.reportTilesPopulated=!0}));this.services.explorationCapabilities.setCapabilities({allowVisualContainerPreload:!1,allowNewLoadingExperience:!1,showAppBar:!1,showTaskPane:!1,showVisualizationPane:!1,showNavContentPane:!0,visualContainerOptions:{showMenu:!1,showPin:!1,showContextMenu:!1,disablePin:!1,hideHeader:!0,useStylableHeader:!0},showBackButtonOnAppBar:!1,analysisVisuals:!0,qna:!0,azureMaps:!0,allowWebUrlVisualLinks:!0,disableCanvasTooltips:!0,disableDrillthroughText:!0,disableEnhancedTooltips:!0})}e=u.controllers||(u.controllers={}),n=u.common,h=jsCommon.ExceptionHelper,l=u.explore.util.ExplorationTrustedVisualUtil,r=u.explore.FilterUtils,i=u.visualHost.utils.ResourcePackageUtils,s=u.explore.ScopeUtils,a=u.visualHost.ThemeUtils,g=u.dataServices.models.TileFactory,v=u.dataServices.contracts.TileType,c=u.explore.services.undoRedoStrategy.UndoRedoNoOp,m=u.explore.viewModels.ViewModelFactory,p.createOptions=function(){return{scopedDependencies:["dataSources","viewModeState","undoRedo","selection","visualPlugin","explorationNavigation","explorationCapabilities","resourceLoader","eventBridge","reportRefresh"],additionalServices:["conceptualSchemaProxy","promiseFactory","localizationService","modelService","reportService","modelConverter","reportTileService","resourcePackagesService","explorationSerializer","featureSwitchService","visualPlugin","telemetryService","trustedVisual","themeService","globalEventBridge","visualTimeSynchronizationService","lazyProviderModern","publicCustomVisualService"]}},p.prototype.logEventForRealtimeTile=function(e){e&&(e.realTimeMode||e.pushDataVersion)&&this.services.telemetryService.logEvent(u.telemetry.DashboardRealtimeModelLoad,{modelId:e.id,realtimeMode:e.realTimeMode||0,pushdataVersion:e.pushDataVersion||0,controller:"ReportTileController"})},p.prototype.reloadTrustedVisuals=function(e){_.isEmpty(e)||(this.services.visualPlugin.ensureTrustedVisualPlugins(e),this.services.globalEventBridge.publishToChannel(u.events.reloadEmptyVisuals,{visualTypes:e.map((function(e){return e.name}))}))},p.prototype.populateExploration=function(t,e,o,i,r){var a=this;this.setDataSources(t,e);var n=this.services.explorationSerializer.deepCopyExploration(e,{withData:!0,withQuery:!0}),s=p.mapCanvasSize(n,o);this.applySectionParameterFilters(s,o,i,r);r=p.getReferencedResourcePackages(s,o);this.services.featureSwitchService.featureSwitches.consumePublicCvsWithoutRps?this.getResourcePackagesToRegister(r,s,o).then((function(e){a.resolveExploration(e,s,o),a.logEventForRealtimeTile(t)})):(this.resolveExploration(r,s,o),l.acquireTrustedVisuals(e,this.services.trustedVisual).then((function(e){return a.reloadTrustedVisuals(e)})),this.logEventForRealtimeTile(t))},p.prototype.resolveExploration=function(e,t,o){var i;_.isEmpty(e)?this.resolveExplorationWithoutResourcePackage(t,o):(i=this.scope.viewModel,this.services.telemetryService.logEvent(u.telemetry.DashboardRegisterAndLoadResourcePackagesForReportTiles,{resourcePackageLength:e.length,tileId:i&&i.contract?i.contract.id:-1,reportTileHasCustomVisual:!0}),this.resolveExplorationWithResourcePackages(e,t,o))},p.prototype.getResourcePackagesToRegister=function(l,c,d){return __awaiter(this,void 0,u.Promise,(function(){var t,o,i,r,a,n,s;return __generator(this,(function(e){switch(e.label){case 0:return t=p.getReferencedVisualsInSection(c,d),[4,this.services.publicCustomVisualService.getPublicResourcePackages(_.keys(t))];case 1:for(o=e.sent(),i=o,r=function(t){_.find(o,(function(e){return e.name===t.name}))||i.push(t)},a=0,n=l;a<n.length;a++)s=n[a],r(s);return[2,i]}}))}))},p.prototype.addODataFilterFromQuery=function(a,n){return __awaiter(this,void 0,u.PbiPromise,(function(){var t,o,i,r;return __generator(this,(function(e){switch(e.label){case 0:return[4,this.services.lazyProviderModern.get("@powerbi/ODataFilterParser/OData-Filter-Parser.module#ODataFilterParserModule","odataFilterParserService")];case 1:return[4,e.sent().tryGetFilters(n)];case 2:if(t=e.sent(),_.isEmpty(t))return[2];for(a.filters||(a.filters=[]),o=0,i=t;o<i.length;o++)r=i[o],a.filters.push(r);return this.updateExplorationCacheCapabilities(!0,!1),[2]}}))}))},p.prototype.updateExplorationCacheCapabilities=function(e,t){var o=this.services.explorationCapabilities,i=o.getCapabilities();i.visualContainerOptions.disableQueryCacheUpdates=e,void 0!==t&&(i.persistentUserStateEnabled=t),o.setCapabilities(i)},p.prototype.applySectionParameterFilters=function(e,t,o,i){e&&e.sections&&((t=null!=(t=u.explore.SectionUtils.findSectionIndexForSectionId(e,t))&&e.sections[t])&&(r.mergeExplorationSectionFilters(e,t),o=null!=(o=u.explore.PodUtils.findPodIndexForPodName(e,o))&&e.pods[o],r.applySectionParameterFilters(t,o,void 0,i)))},p.prototype.resolveExplorationWithResourcePackages=function(e,t,o){var i=this;this.services.resourcePackagesService.registerPackages(e),this.services.visualPlugin.ensurePlugins(e,!1).finally((function(){i.resolveExplorationWithoutResourcePackage(t,o)}))},p.prototype.populateReportTiles=function(){return __awaiter(this,void 0,u.Promise,(function(){var t,o,i,r,a,n,s,l,c,d,p;return __generator(this,(function(e){switch(e.label){case 0:return((t=this.scope.viewModel).isError=!1,t&&t.contract)?(o=t.contract)&&o.type===v.report?(i=this.services.modelConverter.convertTileConfig(o),r=o.reportId,[4,this.services.reportService.ensureReportsInitialization()]):[2]:[3,8];case 1:if(e.sent(),l=this.services.reportService.findReport(r),a=o.sectionId,!l)return this.setErrorText(),[2];n=this.services.modelService.findModel(l.modelId,l.packageId),e.label=2;case 2:return e.trys.push([2,7,,8]),[4,this.services.reportTileService.getExploration(r,a)];case 3:return s=e.sent().exploration,[4,this.initializeExplorationTheme(s)];case 4:if(e.sent(),c=i&&i.reportTile&&i.reportTile.sectionId,l=s.sections,null==a&&null!=c&&null!=l&&c<l.length){if(!(d=s.sections[c]))return this.setErrorText(),[2];a=d.id}return d=c=null,i&&i.reportTile&&(c=i.reportTile.pod,i.reportTile.filters&&(p=[],d=this.services.explorationSerializer.deserializeFilterCollection(this.services.explorationSerializer.parseFilterCollectionConfig(i.reportTile.filters),p,!1),_.isEmpty(p))),this.scope.viewModel.odataFilters?[4,this.addODataFilterFromQuery(s,this.scope.viewModel.odataFilters)]:[3,6];case 5:e.sent(),e.label=6;case 6:return this.populateExploration(n.contract,s,a,c,d),[3,8];case 7:return p=e.sent(),h.handleErrorAndLogTelemetry(this.services.telemetryService,u.telemetry.DashboardReportTilePopulateException,p),this.setErrorText(),[3,8];case 8:return[2]}}))}))},p.prototype.initializeExplorationTheme=function(o){return __awaiter(this,void 0,u.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return t=u.visualHost.ThemeUtils.cloneThemeCollection(o.themeCollection),this.services.themeService.isLegacyThemeName(t.customTheme&&t.customTheme.name)&&delete t.customTheme,[4,a.loadThemeAndBaseTheme(this.services.promiseFactory,this.services.resourceLoader,this.services.themeService,o.resourcePackages,t)];case 1:return e.sent(),[2]}}))}))},p.prototype.resolveExplorationWithoutResourcePackage=function(e,t){var o=this.scope.viewModel,i=e.sections,r=i.length,a=[];this.services.explorationNavigation.loadExploration(e);for(var n=0;n<r;n++)i[n].crossFilterSource&&(i[n].crossFilterSource.highlight=void 0),a[n]={contract:i[n],selected:!0,displayName:i[n].displayName};if(void 0!==t){var s=u.explore.SectionUtils.findSectionById(e,t);if(s){this.services.explorationNavigation.goto(s);for(var l=new u.explore.viewModels.ExploreCanvas(s),c=jsCommon.ArrayExtensions.createWithId(),d=s.visualContainers.length,n=0;n<d;n++){var p=m.convertVisualContainer(e,l.contract,s.visualContainers[n],0);p.allowDeferredRendering=!0,p.options=this.services.explorationCapabilities.getCapabilities().visualContainerOptions,c.push(p)}l.visualContainers=c,l.visualContainerGroups=m.convertVisualContainerGroups(s.visualContainerGroups,c,0),o.exploration={contract:e,exploreCanvas:l,sections:a},o.isLoading=g.isTileLoading(o.contract),this.services.featureSwitchService.featureSwitches.realTimeRefreshDisabled||this.services.reportRefresh.init(!1),this.services.visualTimeSynchronizationService.setAnchorTimeToNow()}else this.setErrorText()}else this.setErrorText()},p.prototype.setDataSources=function(e,t){var o=t.dataSources.withId(e.id);o||(i=u.explore.constants.DefaultSchemaName,o={type:u.common.constants.dsrDataReaderType,id:e.id,name:u.explore.constants.DefaultSchemaName,dsr:{schemaName:u.explore.constants.DefaultSchemaName,vsName:e.vsName,dbName:e.dbName,modelId:e.id}},t.dataSources.push(o),o=u.explore.constants.ExplorationSchemaName,i={type:u.explore.dataReaderPlugins.ExplorationDataReaderType,id:t.id,name:o,extends:i,exploration:{schemaName:o,extends:i,getModelExtensions:function(){return t.modelExtensions},getDataSourceVariables:function(){return t.dataSourceVariables}}},t.dataSources.push(i));var i=t.dataSources;this.services.dataSources.set(i)},p.prototype.setErrorText=function(){var e=this.scope.viewModel;e.isError=!0,e.errorText=this.services.localizationService.get("ReportTile_DataUnavailable")},p.getReferencedResourcePackages=function(e,t){var o=p.getReferencedVisualsInSection(e,t);if(!_.isEmpty(o))return _.filter(e.resourcePackages,(function(e){return i.isCustomVisualResourcePackage(e)&&o[e.name]}))},p.getReferencedVisualsInSection=function(e,t){var e=e.sections,o={};if(_.isEmpty(e))return o;for(var i=0,r=e;i<r.length;i++){var a=r[i];if(a.id===t){_.map(a.visualContainers,(function(e){e=e&&e.config&&e.config.singleVisual&&e.config.singleVisual.visualType;_.isEmpty(e)||(o[e]=!0)}));break}}return o},p.mapCanvasSize=function(e,t){return e&&(t=u.explore.SectionUtils.findSectionIndexForSectionId(e,t),e.sections&&e.sections[t]&&void 0!==e.sections[t].size.displayOption&&(e.sections[t].size.displayOption=1)),e},e.ReportTileController=p})(powerbi=powerbi||{}),(function(e){var t;function o(e,t){var o=this;this.scope=e,this.services=t,this.scope.workbookTileUrl=this.workbookTileUrl,this.scope.workbookTileImageUrl=this.workbookTileImageUrl,this.scope.useLiveEwaControl=!!this.services.featureSwitchService.featureSwitches.liveWorkbookTiles;var i=this.scope.$watch("viewModel.tileModel.size",(function(){return o.services.workbookService.setModelDynamicImageUrl(o.scope.viewModel)}),!0),r=this.scope.$watch("viewModel",(function(){return o.services.workbookService.setModelDynamicImageUrl(o.scope.viewModel)}));this.scope.$on("$destroy",(function(){i(),r()})),this.initWorkbookTile()}e=e.controllers||(e.controllers={}),t=jsCommon.UrlUtils,o.createOptions=function(){return{additionalServices:["$sce","workbookService","featureSwitchService"]}},o.prototype.constructWorkbookWopiUrl=function(e,t){return this.scope.viewModel.contract.$config.workbookTile?e.replace(/ExcelJs.ashx/i,"xlEmbed.aspx")+"&access_token="+t+"&item="+this.scope.viewModel.contract.$config.workbookTile.item+"&action=embedView":""},o.prototype.shouldPreparePreviewImage=function(){return!this.scope.viewModel.previewImageUrl&&!this.scope.viewModel.image&&!this.scope.viewModel.hasImages()},o.prototype.initWorkbookTile=function(){var o=this;this.scope.viewModel.isLoading=!0,this.shouldPreparePreviewImage()&&this.services.workbookService.getWorkbookTilePreviewImageUrl(this.scope.viewModel.contract).then((function(e){var t=-1===e.indexOf("?")?"?":"&";o.scope.viewModel.previewImageUrl=e+t+(new Date).getTime(),o.services.workbookService.setModelDynamicImageUrl(o.scope.viewModel),o.scope.onTileImageReady((function(e){o.scope.viewModel.isLoading=!1}))})),this.scope.useLiveEwaControl&&this.services.workbookService.getWorkbookEmbedAccessData(this.scope.viewModel.contract.workbookId,this.scope.viewModel.contract.packageId).then((function(e){e&&t.isValidHttpUrl(e.url)&&(e=o.constructWorkbookWopiUrl(e.url,e.accessToken),o.scope.workbookTileUrl=o.services.$sce.trustAsResourceUrl(e))}))},e.WorkbookTileController=o})(powerbi=powerbi||{}),(function(s){var e,t,l,c,d,o,i,r,a,p,n,u;function h(e,t){var i=this;this.activeSubscriptions=[],this.scope=e,this.services=t,this.model=e.viewModel,this.scope.hasSensitivityBanner=!1,this.scope.modernReportTile=this.services.featureSwitchService.featureSwitches.reportTileModern,this.setSensitivityBannerHeight(),this.scope.modernWorkbookTile=this.services.featureSwitchService.featureSwitches.workbookTileModern,this.globalChannelSubscriptionManager=this.services.globalEventBridge.createChannelSubscriptionManager().subscribe(u,(function(e,t){i.handleSensitivity(t)})),this.scope.moduleConfig=d,this.updateTileHref(),this.scope.hasWarning=function(){return i.hasWarning()},this.scope.shouldShowTileVisual=function(){return i.shouldShowTileVisual()},this.scope.$watchCollection("viewModel.action",(function(){return i.updateTileHref()}));var o,r=this.services.rootScope.$on(c.reportDeletedEventName,(function(e,t){i.model.report&&i.model.report.id===t&&(i.model.report=null)})),t=this.services.userNotificationInfo;t.registerNotificationsUpdatedListener&&t.registerNotificationsUpdatedListener((function(){return i.onNotificationsUpdated()})).then((function(e){o=e}));var a=this.services.shellCapabilities;a.ensureCapabilitiesInitialized().then((function(){i.showComments=a.getCapabilities().dashboardSettings.showComments})),this.scope.$on(s.common.constants.scopeDestroyEventName,(function(){r(),o&&o(),i.globalChannelSubscriptionManager&&i.globalChannelSubscriptionManager.unsubscribeAll();var e=i.scope;e.isError&&e.errorDetails?e.$emit(s.constants.removeDashboardTileErrorEventName,i.model,e.errorDetails):i.hasWarning()&&e.$emit(s.constants.removeDashboardTileErrorEventName,i.model,{message:i.scope.warning&&i.scope.warning.tooltip,displayableErrorInfo:[]})})),this.updateModelTileHeaderSize(),this.scope.$root.$on(s.common.constants.needStrategySwapEventName,(function(){i.updateModelTileHeaderSize()})),this.scope.onTileError=function(e,t){i.scope.isError=!0,i.scope.errorText=i.model.type===p.image?i.services.localizationService.get("Tile_ImageErrorText"):e,i.scope.errorDetails=t||{message:i.scope.errorText,displayableErrorInfo:[]},i.model.resetTileErrors=function(){i.scope.isError=!1},i.services.globalEventBridge.publishToChannel(s.services.events.dashboardTileErrorEventName,{tile:i.model,errorDetails:i.scope.errorDetails})},this.scope.$on(s.common.constants.tileErrorEventName,(function(e,t,o){i.scope.onTileError(t,o)})),this.scope.onClearTileError=function(){var e=i.scope.errorDetails;i.scope.isError&&e&&i.scope.$emit(s.constants.removeDashboardTileErrorEventName,i.model,e),i.model.resetTileErrors&&i.model.resetTileErrors()},this.services.rootScope.$on(s.constants.rowLevelSecurityAccessDeniedEventName,(function(e,t){i.model.composite&&_.find(t,(function(e){return i.scope.viewModel.contract.modelId===e}))&&(i.scope.isError=!0,i.scope.errorText=i.services.localizationService.get("Tile_RLS_NoAccess"),i.model.composite.tileData.data=null,i.model.resetTileErrors=function(){i.scope.isError=!1})})),this.scope.getUnseenCount=function(){return i.getUnseenCount()},this.scope.getIcons=function(){return i.getIcons()};var n={};this.scope.contentStyleWithSensitivity=function(){var e;return!0===i.scope.hasSensitivityBanner?((e={})[l.topProperty]=i.scope.viewModel.getTileHeight()+i.sensitivityBanerHeight+"px",e):n},this.scope.getWebContentIcon=function(){return i.getWebContentIcon()},this.scope.onIconClick=function(e,t){return i.onIconClick(e,t)},this.scope.selectTileConversations=function(e){return i.selectTileConversations(e)},this.scope.showCommentIndicator=function(){return i.showCommentIndicator()},this.scope.showConversationsToolTip=function(){return i.showConversationsToolTip()},this.scope.refreshIconsTrigger=!0,this.model.type===p.image&&(this.scope.altText=this.model.displayText||this.services.localizationService.get("Image")),this.scope.realTimeTileModernInputArgs={viewModel:this.scope.viewModel.realTime},this.scope.realTimeTileModernOutputArgs={onTileError:function(e,t){return i.scope.onTileError(e,t)},onClearTileError:function(){return i.scope.onClearTileError()}},this.scope.realTimeTileLazyPath="@powerbi/RealTime/real-time.module#RealTimeModule";t=null===(e=this.model)||void 0===e?void 0:e.composite;this.scope.visualType=null===(e=null==t?void 0:t.visual)||void 0===e?void 0:e.type,t&&t.licenseUIManager&&(this.activeSubscriptions.push(t.licenseUIManager.shouldDisplayLicenseBlocker$.subscribe((function(e){return i.scope.shouldDisplayLicenseBlocker=e}))),this.activeSubscriptions.push(t.licenseUIManager.shouldDisplayLicenseEnvironmentBlocker$.subscribe((function(e){return i.scope.shouldDisplayLicenseEnvironmentBlocker=e}))),this.activeSubscriptions.push(t.licenseUIManager.shouldDisplayFeatureBlockedBanner$.subscribe((function(e){return i.scope.shouldDisplayFeatureBlockedBanner=e}))),this.activeSubscriptions.push(t.licenseUIManager.shouldStartBannerLeaveAnimation$.subscribe((function(e){return i.scope.shouldStartBannerLeaveAnimation=e}))))}e=s.controllers||(s.controllers={}),t=s.common.contracts.ArtifactType,l=jsCommon.CssConstants,c=s.dataServices.constants,d=s.common.modules.JQueryUIModule,o=s.common.constants.tileActions,i=s.dataServices.models.Tile,r=s.models.factory.TileOptionsFactory,a=s.dataServices.TileUtils,p=s.dataServices.contracts.TileType,n=s.dataServices.models.TileConstants,u=s.common.events.informationProtectionLoaded,h.createOptions=function(){return{additionalServices:["localizationService","userInfo","visualPlugin","dashboardDataService","flyoutService","modelService","userNotificationInfo","featureSwitchService","userNotificationTileFilterService","tileDisplay","errorService","gridLayout","licenseEnforcementService","annotationsInterop","telemetryService","shellCapabilities","embedModeService","globalEventBridge"],scopedDependencies:["scriptVisuals"]}},h.prototype.$onDestroy=function(){this.activeSubscriptions.forEach((function(e){e&&e.unsubscribe()}))},h.prototype.onResize=function(){this.setSensitivityBannerHeight()},h.prototype.setSensitivityBannerHeight=function(){this.baseSensitivityBannerHeight=window.innerWidth<640?n.sensitivityMobileBannerHeight:n.sensitivityDesktopBannerHeight},h.prototype.handleSensitivity=function(e){e.artifactType!==t.Tile||_.isNil(e.componentId)||e.componentId!==this.scope.viewModel.contract.id||(this.scope.hasSensitivityBanner=e.hasSensitivity,this.scope.hasExpandSensitivityBanner=e.isBannerExpanded,this.sensitivityBanerHeight=e.isBannerExpanded?n.sensitivityMobileExpendBannerHeight:this.baseSensitivityBannerHeight,this.scope.viewModel.calculateLayout(void 0,this.sensitivityBanerHeight),this.scope.viewModel.invalidateLayout())},h.prototype.updateTileHref=function(){this.model.intraDomainNavigationParameters=null;var e=this.model.action;e.action===o.custom.openUrlActionName&&i.isValidUrl(e.targetUrl,!0)?this.scope.$emit(s.constants.updateTileHrefEventName,this.model,e.targetUrl):this.model.href=void 0},h.prototype.hasLostReportConnection=function(){var e=this.scope.viewModel,t=e.action;return e.type===p.composite&&t&&!(t.action&&t.action===o.openQnAActionName)&&(!t.action||t.action===o.openReportActionName&&!e.report)&&"bingSocial"!==e.contract.name&&!e.config.widget},h.prototype.hasWarning=function(){var e=this.services.visualPlugin,t=this.services.userInfo,o=this.scope.viewModel;if(this.scope.isError&&this.services.tileDisplay.isVisualSupportedInErrorState(o)){var i=o.composite;return this.scope.warning={tooltip:this.services.localizationService.format("DashboardAppBar_TileError_ErrorTooltip",[i.errorText])},!0}if(a.tileContainsScriptVisuals(this.scope.viewModel,e)){o=o.report&&o.report.id;if(this.services.scriptVisuals.shouldBlockScriptVisual(0,o)){t=t&&!Array.isArray(t)&&this.services.licenseEnforcementService.supportsScriptVisuals();return this.scope.warning={tooltip:t&&this.services.localizationService.get("Tile_RVis_RefreshDisabled")||this.services.localizationService.get("Tile_RVis_RefreshDisabledForNonPro")},!0}}else{if(this.hasLostReportConnection())return this.scope.warning={tooltip:this.services.localizationService.get("Tile_LoseReportConnection")},!0;if(this.scope.viewModel.errorCode)return this.scope.warning={tooltip:this.model.details.getErrorLocId(this.model.errorCode,this.services.localizationService)},!0}return!1},h.prototype.getUnseenCount=function(){var e=this.scope.viewModel.contract.id,t=this.services.userNotificationInfo;if(!e||!t||!t.userNotifications||_.isEmpty(t.userNotifications.notifications))return 0;t=t.userNotifications.notifications;return _.filter(this.services.userNotificationTileFilterService.filterNotifications(t,e),(function(e){return!e.seen})).length},h.prototype.onIconClick=function(e,t){t.stopPropagation(),t.preventDefault();var o=this.scope;if(e.action)switch(e.action){case 0:this.scope.headerClickTarget({event:t,openNotification:!0});break;case 2:this.services.tileDisplay.onErrorIconClicked({message:e.tooltip()});break;case 1:this.services.tileDisplay.onErrorIconClicked({isError:o.isError,errorTitle:o.errorText,errorDetails:o.errorDetails,message:e.tooltip()})}},h.prototype.getIcons=function(){var t=this;if(this.icons)return this.icons;var e={badgeTextSetter:this.getUnseenCount.bind(this),localizationService:this.services.localizationService,showNotifications:function(){return 0<t.getUnseenCount()},showWarning:this.hasWarning.bind(this),showWebContent:function(){var e=t.scope.viewModel;return e&&e.type===p.iframe&&!e.isTemporary&&e.hasTitle()},showRealTime:function(){var e=t.scope.viewModel;return e&&e.type===p.realTime},warningToolTipSetter:function(){return t.scope.warning&&t.scope.warning.tooltip}};return this.icons=r.getDashboardTileIcons(e),e.showWarning()&&this.services.globalEventBridge.publishToChannel(s.services.events.dashboardTileErrorEventName,{tile:this.model,errorDetails:{message:e.warningToolTipSetter(),displayableErrorInfo:[]}}),this.icons},h.prototype.getWebContentIcon=function(){return _.find(this.getIcons(),(function(e){return 2===e.action}))},h.prototype.shouldShowTileVisual=function(){var e=this.services.tileDisplay.getTileDisplayError(this.scope.viewModel);return e&&e.isError?(this.scope.errorText=e.errorTitle,this.scope.errorDetails=e.errorDetails,!1):!this.scope.isError||this.services.tileDisplay.isVisualSupportedInErrorState(this.scope.viewModel)},h.prototype.updateModelTileHeaderSize=function(){var e=1;this.services.gridLayout.strategy.isDynamic||this.scope.inEditMobileLayoutMode?e=2:this.scope.largeHeader&&(e=0),this.model.setTileHeaderSize(e)},h.prototype.onNotificationsUpdated=function(){0<this.getUnseenCount()&&(this.scope.refreshIconsTrigger=!this.scope.refreshIconsTrigger)},h.prototype.selectTileConversations=function(e){e.stopPropagation(),e.preventDefault();var t=this.services,e=this.scope.viewModel;t.annotationsInterop.selectTile(e.id),t.flyoutService.expandFlyout(),t.telemetryService.logEvent(s.telemetry.AnnotationsOpenAnnotationsPane,{artifactType:"Tile"})},h.prototype.showCommentIndicator=function(){var e=this.services.dashboardDataService.activeDashboard;return!!(this.showComments&&e&&e.annotationsEnabled&&this.scope.viewModel.hasConversation)},h.prototype.showConversationsToolTip=function(){return this.services.localizationService.format("ShowConversationsToolTip",["tile"])},e.Tile=h})(powerbi=powerbi||{}),(function(t){(t.controllers||(t.controllers={})).UserInfoController=function(e){(this.scope=e).userName=t.session.UserInfoUtils.getFullName()}})(powerbi=powerbi||{}),(function(c){!(function(e){var a,t,o,i,r=c.dataServices.AppUtils,n=c.common.helpers.ModelConverterHelper,s=c.dataServices.constants.workbook;(i=a=e.DataRefreshStatus||(e.DataRefreshStatus={}))[i.Success=0]="Success",i[i.Failure=1]="Failure",i[i.NotSupported=2]="NotSupported",i[i.MissingData=3]="MissingData",(i=t=t||{})[i.Supported=0]="Supported",i[i.NotSupported=1]="NotSupported",(i=o=o||{})[i.Supported=0]="Supported",i[i.NotSupportedNotOwned=1]="NotSupportedNotOwned",i[i.NotSupportedLocalWorkbook=2]="NotSupportedLocalWorkbook",i[i.NotSupportedNotLoaded=3]="NotSupportedNotLoaded",i[i.StatusNotKnown=4]="StatusNotKnown";l.createOptions=function(){return{additionalServices:["localizationService","featureSwitchService","modelService","historyDialogService","packageService","telemetryService","navigation","shellCapabilities","folderService","appService","appStore","lazyProviderModern"]}},l.prototype.$onDestroy=function(){this.isAppNavToggleEnabledSubscription&&this.isAppNavToggleEnabledSubscription.unsubscribe(),this.shouldDisplayAppNavToggleSubscription&&this.shouldDisplayAppNavToggleSubscription.unsubscribe()},l.prototype.isEditEnabled=function(){return this.model.workbook&&this.getEditSupportedStatus(this.model.workbook)===o.Supported},l.prototype.isWorkbookLoaded=function(){return this.model&&this.model.workbook&&this.model.workbookLoaded},l.prototype.bindMenuActions=function(){var t=this,e=this.scope,o=l.WorkbookAppBarActions;e.editMenuActions=[{text:this.services.localizationService.get("WorkbookAppBar_EditInExcel"),description:this.services.localizationService.get("WorkbookAppBar_EditInExcelDescription"),action:o.EditInExcel,itemClass:"editInExcel",type:DropDownMenuItemType.Item},{text:this.services.localizationService.get("WorkbookAppBar_EditInExcelOnline"),description:this.services.localizationService.get("WorkbookAppBar_EditInExcelOnlineDescription"),action:o.EditInExcelOnline,itemClass:"editInExcelOnline",type:DropDownMenuItemType.Item}],e.dataMenuActions=[{text:this.services.localizationService.get("WorkbookAppBar_Calculate"),description:this.services.localizationService.get("WorkbookAppBar_CalculateDetails"),action:o.Calculate,itemClass:"calculate",type:DropDownMenuItemType.Item}],e.editMenuActionSelected=function(e){return t.onEditMenuActionSelected(e)},e.dataMenuActionSelected=function(e){return t.onDataMenuActionSelected(e)},e.pinClicked=function(){return t.pinClicked()},e.reloadClicked=function(){return t.reloadClicked()},e.isPinToDashboardEnabled=function(){return t.isPinToDashboardEnabled()},e.getPinButtonTooltipLocId=function(){return t.getPinButtonTooltipLocId()},e.isWorkbookLoaded=function(){return t.isWorkbookLoaded()},e.isEditEnabled=function(){return t.isEditEnabled()},e.getEditButtonTooltipLocId=function(){return t.getEditButtonTooltipLocId()},e.getRefreshDataStatus=function(){return t.updateLastRefreshInformationAndGetStatus()}},l.prototype.onEditMenuActionSelected=function(e){var t=l.WorkbookAppBarActions;switch(e.action){case t.EditInExcelOnline:this.EditInExcelOnline();break;case t.EditInExcel:this.EditInExcel()}},l.prototype.onDataMenuActionSelected=function(e){e.action===l.WorkbookAppBarActions.Calculate&&this.CalculateClicked()},l.prototype.CalculateClicked=function(){this.services.telemetryService.logEvent(c.telemetry.DashboardCalculateWorkbook),this.scope.$emit(l.Events.CalculateWorkbookClicked)},l.prototype.EditInExcelOnline=function(){this.scope.$emit(l.Events.EditInExcelOnlineClicked)},l.prototype.EditInExcel=function(){this.scope.$emit(l.Events.EditInExcelClicked)},l.prototype.pinClicked=function(){this.scope.$emit(l.Events.PinClicked)},l.prototype.reloadClicked=function(){this.services.telemetryService.logEvent(c.telemetry.DashboardReloadWorkbook),this.scope.$emit(l.Events.ReloadClicked)},l.prototype.getDataRefreshSupportStatus=function(e){return e.isOwner()&&e.contract.modelId&&e.contract.isPowerPivotVersionSupportsRefresh?t.Supported:t.NotSupported},l.prototype.getEditSupportedStatus=function(e){return this.model.workbookLoaded&&e.isEditable()?o.Supported:this.model.workbookLoaded?e.isOwner()?this.services.packageService.isLocalWorkbook(e.packageId)?o.NotSupportedLocalWorkbook:o.StatusNotKnown:o.NotSupportedNotOwned:o.NotSupportedNotLoaded},l.prototype.isWorkbookFromFolderButInAppView=function(){var e=this.model.workbook;return e.contract.folderId&&this.services.folderService.activeFolderNumericId!==e.contract.folderId&&r.isOrgAppInstance(e.packageId,this.services.appService)},l.prototype.isPinToDashboardEnabled=function(){return this.isWorkbookLoaded()&&this.model.workbook.isOwner()&&!this.isWorkbookFromFolderButInAppView()},l.prototype.getPinButtonTooltipLocId=function(){return this.isWorkbookLoaded()?!this.model.workbook.isOwner()||this.isWorkbookFromFolderButInAppView()?"WorkbookAppBar_PinTooltip_NotOwner":this.model.workbookChanged?"WorkbookAppBar_PinTooltip_Disabled_WorkbookChanged":this.model.workbookRangeSelected?"WorkbookAppBar_PinTooltip_Enabled":"WorkbookAppBar_PinTooltip_Disabled_NoSelection":""},l.prototype.getEditButtonTooltipLocId=function(){var e;switch(this.getEditSupportedStatus(this.model.workbook)){case o.Supported:case o.NotSupportedNotLoaded:e="";break;case o.NotSupportedLocalWorkbook:e="WorkbookAppBar_EditToolTip_NotEditable_Local";break;case o.NotSupportedNotOwned:e="WorkbookAppBar_EditToolTip_NotEditable_NotOwned";break;case o.StatusNotKnown:e=""}return e},l.prototype.updateLastRefreshInformationAndGetStatus=function(){if(!this.model||!this.model.workbook)return a.MissingData;if(this.getDataRefreshSupportStatus(this.model.workbook)===t.NotSupported)return this.scope.refreshInformationText="",a.NotSupported;var e=this.services.modelService.findModel(this.model.workbook.modelId,this.model.workbook.packageId);return e?this.getLastRefreshText(e.contract):a.MissingData},l.prototype.getLastRefreshText=function(e){var t,o,i,r=this;return 4===e.lastRefreshStatus?(t=this.services.localizationService.get("WorkbookAppBar_LastDataRefreshFailed"),o=a.Failure,(i={}).dataset=n.convertModelToDataset(e,this.services.localizationService),this.scope.showRefreshHistory=function(){return r.services.historyDialogService.showHistoryDialog(i)}):t=2===e.lastRefreshStatus?(o=a.MissingData,""):(e=n.convertRefreshTimeToLocaleString(e.lastRefreshTime,this.services.localizationService),o=a.Success,this.services.localizationService.format("WorkbookAppBar_LastDataRefreshSucceded",[e])),this.scope.refreshInformationText=t,o},l.WorkbookAppBarActions={Calculate:"Calculate",EditInExcel:"EditInExcel",EditInExcelOnline:"EditInExcelOnline",Pin:"Pin",Reload:"Reload"},l.Events={PinClicked:s.pinClickedEventName,EditInExcelOnlineClicked:s.editInExcelOnlineClickedEventName,EditInExcelClicked:s.editInExcelClickedEventName,CalculateWorkbookClicked:s.calculateWorkbookClickedEventName,ReloadClicked:s.reloadExcelWorkbookEventName},s=l;function l(e,t){var o=this;this.scope=e,this.services=t,this.model=this.scope.viewModel,this.bindMenuActions(),this.scope.inAppArtifactView=function(){return o.services.navigation.inAppArtifactView()},this.scope.navigateBack=function(){return t.navigation.navigateBack()},t.shellCapabilities.ensureCapabilitiesInitialized().then((function(){o.scope.isBackButtonEnabled=t.shellCapabilities.getCapabilities().workbookSettings.showBackButtonOnAppBar})),this.scope.appConsumptionLazyLoadPath="@powerbi/AppConsumption/app-consumption.module#AppConsumptionModule",this.scope.appConsumptionNavPaneToggleLazyComponentId="AppNavigationPaneToggleComponentId",this.scope.artifactActionLazyLoadPath="@powerbi/ArtifactAction/artifact-action.module#ArtifactActionModule",this.scope.appActionMenuLazyComponentId="AppActionMenuComponentId",this.isAppNavToggleEnabledSubscription=this.services.appStore.selectedApp.subscribe((function(i){return __awaiter(o,void 0,c.Promise,(function(){var t,o=this;return __generator(this,(function(e){switch(e.label){case 0:return i?[3,1]:(this.scope.isAppNavToggleEnabled=!1,this.shouldDisplayAppNavToggleSubscription&&(this.shouldDisplayAppNavToggleSubscription.unsubscribe(),this.shouldDisplayAppNavToggleSubscription=null),[3,3]);case 1:return this.shouldDisplayAppNavToggleSubscription?[3,3]:[4,this.services.lazyProviderModern.get("@powerbi/AppConsumption/app-consumption.module#AppConsumptionModule","AppNavigationService")];case 2:t=e.sent(),this.shouldDisplayAppNavToggleSubscription=t.shouldDisplayAppNavToggleInAppBar().subscribe((function(e){o.scope.isAppNavToggleEnabled=e})),e.label=3;case 3:return[2]}}))}))}))}e.WorkbookAppBarController=s})(c.controllers||(c.controllers={}))})(powerbi=powerbi||{}),(function(n){var i,s,r,l,c,a,d;function e(e,t,o){this.workbook=e,this.range=t,this.promiseFactory=o}function t(e,t,o){this.workbook=e,this.item=t,this.promiseFactory=o}function p(e,t){var o=this;this.workbookIdentifierRegex=new RegExp(".*/groups/[a-zA-Z0-9-]+(?:/)?(?:apps/)?(?:[a-zA-Z0-9-]+)?/workbooks/([a-zA-Z0-9-_]+)(/?).*"),this.pinTileScenario=2,this.scope=e,this.services=t,this.scope.viewModel={},this.scope.appBarArgs={selection:null},this.resetSelectionArgs(),this.unsubscribeList=[],this.subscribeToAppBarEvents(),this.setWorkbookAppBarIfNeeded(),this.scope.isEmbeddedWorkbookReady=!1,this.scope.embeddedWorkbookFailed=!1,this.scope.isEmbeddedWorkbookDataReady=!1,this.scope.dismissToast=function(){n.models.WorkbookContainer.DiscoverabilityToastDismissed=!0;var e=o.services.telemetryService.startEvent(n.telemetry.DashboardWorkbookPinabilityShown);o.services.tutorialDataStore.setKey(p.WorkbookPinToastShown,!0,e),o.scope.viewModel.showDiscoverabilityToast=!1},this.scope.showPinDashboardDialog=function(){return o.showPinDashboardDialog()};var i=this.services.downgradedRouterUtilities.getLocationPath();_.includes(i,"/apps")?this.ensureWorkbookInitialization(i,this.services):this.services.folderService.folderSwitchPromise().then((function(){o.ensureWorkbookInitialization(i,o.services)})),this.scope.$on("$destroy",(function(){o.unsubscribeToAppBarEvents(),o.routeChangedSubscription.unsubscribe()}))}i=n.controllers||(n.controllers={}),s=n.dataServices.constants,r=n.dataServices.EwaNamedItemType,l=n.common.constants.tileActions,c=n.dataServices.contracts.TileType,e.prototype.getTileData=function(){return this.getTileDataDeferred=this.promiseFactory.defer(),this.verifyIntersections(0),this.getTileDataDeferred.promise},e.prototype.verifyIntersections=function(e){var t,o=this,i=this.workbook.getNamedItems();e>=i.getCount()?(t={elementName:this.range.getAddressA1(),elementRange:this.range.getAddressA1(),smartSelection:!1,sheetName:this.range.getSheet().getName()},this.getTileDataDeferred.resolve(t)):(i=(t=i.getItem(e)).getNamedItemType())===r.NamedRange||i===r.Table||i===r.PivotTable?t.getRefersToRangeAsync((function(e){return o.verifyNamedItemIntersection(e)}),e):this.verifyIntersections(e+1)},e.prototype.verifyNamedItemIntersection=function(e){var t=e.getReturnValue(),e=e.getUserContext();this.rangesIntersect(this.range,t)?(t={elementName:this.workbook.getNamedItems().getItem(e).getName(),elementRange:t.getAddressA1(),smartSelection:!0,namedItemType:this.workbook.getNamedItems().getItem(e).getNamedItemType(),sheetName:this.workbook.getActiveSheet().getName()},this.getTileDataDeferred.resolve(t)):this.verifyIntersections(e+1)},e.prototype.rangesIntersect=function(e,t){return null!=e&&null!=t&&(e.getSheet()===t.getSheet()&&e.getRow()===t.getRow()&&e.getRowCount()===t.getRowCount()&&e.getColumn()===t.getColumn()&&e.getColumnCount()===t.getColumnCount())},a=e,t.prototype.getTileData=function(){var e,t=this,o=this.promiseFactory.defer(),i=this.item.getNamedItemType();return i===r.NamedRange||i===r.Table||i===r.PivotTable?this.item.getRefersToRangeAsync((function(e){e=e.getReturnValue(),e={elementName:t.item.getName(),elementRange:e.getAddressA1(),smartSelection:!1,namedItemType:i,sheetName:e.getSheet().getName()};o.resolve(e)}),void 0):(e={elementName:this.item.getName(),elementRange:this.workbook.getActiveSheet().getRange(0,0,1,1).getAddressA1(),smartSelection:!1,namedItemType:i,sheetName:this.workbook.getActiveSheet().getName()},o.resolve(e)),o.promise},d=t,p.createOptions=function(){return{additionalServices:["$rootScope","$window","applicationOptions","contentProviderHttpService","errorService","featureSwitchService","folderService","localizationService","modelConverter","recentStore","navigation","notificationToast","packageService","permissionService","pinTileService","promiseFactory","telemetryService","tutorialDataStore","workbookService","appStore","activeFolderId","downgradedRouterUtilities"]}},p.prototype.ensureWorkbookInitialization=function(t,o){var i=this;this.services.workbookService.ensureWorkbookInitialization().then((function(){var e=i.extractWorkbookIdentifier(t);i.navigateToWorkbookPage(e),i.routeChangedSubscription=o.downgradedRouterUtilities.routeChanged().subscribe((function(e){return i.handleStateChange(e)}))}))},p.prototype.handleStateChange=function(o){return __awaiter(this,void 0,n.Promise,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return-1<(t=o.currentRoute).indexOf("/workbooks")?[4,this.navigateToWorkbookPage(this.extractWorkbookIdentifier(t))]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},p.prototype.resetSelectionArgs=function(){this.scope.appBarArgs.selection=void 0},p.prototype.navigateToWorkbookPage=function(e){return __awaiter(this,void 0,n.Promise,(function(){var o=this;return __generator(this,(function(e){return this.services.downgradedRouterUtilities.getQueryParams().subscribe((function(e){var t="";e&&e.activeSelection&&(t=e.activeSelection);e=o.services.downgradedRouterUtilities.getLocationPath().split(/[/\?]+/),e=e[e.indexOf("workbooks")+1],e=o.getWorkbook(e);o.onLoadExcelWorkbook(e,t)})),[2]}))}))},p.prototype.extractWorkbookIdentifier=function(e){e=e&&e.match(this.workbookIdentifierRegex);return e&&1<e.length?e[1]:void 0},p.prototype.getWorkbook=function(e){var t=this.services.workbookService;return t.findWorkbookByEtagHash(e)||t.findWorkbookByUniqueId(e)},p.prototype.subscribeToAppBarEvents=function(){var t=this,e=this.scope,o=e.$on(i.WorkbookAppBarController.Events.PinClicked,(function(e){return t.pinButtonResponse()}));this.unsubscribeList.push(o);o=e.$on(i.WorkbookAppBarController.Events.EditInExcelOnlineClicked,(function(e){return t.openWorkbookInExcelOnline()}));this.unsubscribeList.push(o);e=e.$on(i.WorkbookAppBarController.Events.EditInExcelClicked,(function(e){return t.openWorkbookInExcel()}));this.unsubscribeList.push(e);e=this.services.rootScope.$on(n.constants.groupSwitchedEventName,(function(){return t.setWorkbookAppBarIfNeeded()}));this.unsubscribeList.push(e);e=this.services.rootScope.$on(i.WorkbookAppBarController.Events.CalculateWorkbookClicked,(function(){return t.calculateWorkbook()}));this.unsubscribeList.push(e);e=this.services.rootScope.$on(i.WorkbookAppBarController.Events.ReloadClicked,(function(){return t.onLoadExcelWorkbook(t.scope.viewModel.workbook,null)}));this.unsubscribeList.push(e)},p.prototype.unsubscribeToAppBarEvents=function(){var e,t=this.unsubscribeList.length;if(t){for(e=t;t;)this.unsubscribeList[--t]();this.unsubscribeList.splice(0,e)}},p.prototype.embedWorkbook=function(e,t,o){var i=this,r=this.scope.viewModel.workbook.contract,a=!!r.modelId;this.services.workbookService.embedWorkbook(r.etagHash,this.scope.getEwaTargetWindow(),e.url,e.accessToken,e.accessTokenTtl,this.services.packageService.getWorkbookStorageProvider(r.packageId),this.services.packageService.getWorkbookContentProvider(r.packageId),r.permissions,a,t).then((function(e){var t;i.scope.isEmbeddedWorkbookReady=!0,e.ewaControl&&(t=i.services.tutorialDataStore.hasKey(p.WorkbookPinToastShown),n.models.WorkbookContainer.DiscoverabilityToastDismissed=t,i.scope.viewModel.showDiscoverabilityToast=!t&&i.scope.workbookAppBarIncluded,i.onEwaApplicationReady(e)),o.resolve()}),(function(){o.reject(),i.scope.viewModel.workbook=null,i.scope.embeddedWorkbookFailed=!0}))},p.prototype.onWopiDataError=function(t,o){var i=this.services.$window,r=this.services.telemetryService,a=this.services.navigation;this.services.errorService.error(this.services.localizationService.get("Workbook_FailToEmbedWorkbookMessage"),"Workbook_FailToEmbedWorkbook",{title:this.services.localizationService.get("Workbook_FailToEmbedWorkbookTitle"),dismissCallback:function(e){"openInXL"===e&&(r.logChildEvent(o,n.telemetry.DashboardWorkbookViewedExternallyDueToAnError,{etagHash:t.contract.etagHash}),i.open(t.viewUrl,"_blank")),a.navigateBack()},dialogOptions:[{label:this.services.localizationService.get("Workbook_FailToEmbedWorkbookActionOpenInExcel"),resultValue:"openInXL"},{label:this.services.localizationService.get("PowerViewError_Close"),resultValue:"close"}]})},p.prototype.handleOutboundFlowsRestrictedError=function(e){var t=this.services.navigation;this.services.errorService.error(this.services.localizationService.get("PrivateLinkProtectionEnabled_FFXL"),"Workbook_FailToEmbedWorkbook",{title:this.services.localizationService.get("Workbook_FailToEmbedWorkbookTitle"),dismissCallback:function(e){t.navigateBack()},dialogOptions:[{label:this.services.localizationService.get("PowerViewError_Close"),resultValue:"close"}]})},p.prototype.ensureExpressionApplied=function(t){var o=this,i=this.services.promiseFactory.defer();return this.services.timeout((function(){var e=t();o.services.timeout((function(){i.resolve(e)}),0,!1)})),i.promise},p.prototype.getWopiAccessData=function(e,t){return this.services.workbookService.getWorkbookEmbedAccessData(e.id,e.packageId,t)},p.prototype.loadExcelWorkbook=function(e,t){var o=this,i=this.services.telemetryService.startEvent(n.telemetry.DashboardViewWorkbook,{etagHash:e.contract.etagHash,permissions:e.getPermissions(),storageProvider:this.services.packageService.getWorkbookStorageProvider(e.packageId),contentProvider:this.services.packageService.getWorkbookContentProvider(e.packageId)});this.services.featureSwitchService.featureSwitches.restrictServiceOutboundFlowsEnabled?(this.handleOutboundFlowsRestrictedError(i.event),this.scope.viewModel.workbook=null,i.reject()):this.getWopiAccessData(e,i.event).then((function(e){o.ensureExpressionApplied((function(){o.scope.isEmbeddedWorkbookDataReady=!0})).then((function(){o.embedWorkbook(e,t,i)}))}),(function(){o.onWopiDataError(e,i.event),o.scope.viewModel.workbook=null,i.reject()}))},p.prototype.setWorkbookAppBarIfNeeded=function(){this.scope.workbookAppBarIncluded=!this.services.permissionService.isActiveWorkspaceIsReadOnlyLegacy},p.prototype.calculateWorkbook=function(){this.workbook.recalcAsync()},p.prototype.onLoadExcelWorkbook=function(e,t){var o=this;this.resetSelectionArgs(),this.scope.viewModel.workbook=e,this.scope.viewModel.workbookRangeSelected=!1,this.scope.viewModel.workbookChanged=!1,this.scope.viewModel.workbookLoaded=!1,this.scope.viewModel.loadedWorkbookOrdinal=e.contract.etagOrdinal,this.workbook=null,this.scope.isEmbeddedWorkbookDataReady=!1,this.scope.isEmbeddedWorkbookReady=!1,this.scope.embeddedWorkbookFailed=!1,this.anyWorkbookChangesOccurred=!1,this.ensureExpressionApplied((function(){})).then((function(){o.loadExcelWorkbook(e,t)}))},p.prototype.openWorkbookInExcel=function(){this.services.$window.open("ms-excel:ofe|u|"+this.scope.viewModel.workbook.contract.sourceFilePath,"_self")},p.prototype.openWorkbookInExcelOnline=function(){this.services.$window.open(this.scope.viewModel.workbook.editUrl,"_blank")},p.prototype.showPinDashboardDialog=function(){return __awaiter(this,void 0,n.Promise,(function(){var t,o,i,r,a;return __generator(this,(function(e){switch(e.label){case 0:return this.scope.appBarArgs.selection?[4,this.scope.appBarArgs.selection.getTileData()]:[3,4];case 1:return t=e.sent(),r={item:t.elementName,itemType:t.namedItemType,hideGridlines:!1,hideRowAndColumnHeaders:!0,allowTyping:!1,activeSelection:t.elementRange,keepOriginalContentSize:s.workbook.defaultKeepOriginalContentSize,sheetName:t.sheetName.replace(/\'/g,"''")},a={version:n.dataServices.constants.upgrader.TileConfigVersion,workbookTile:r},i={action:l.openWorkbookActionName},o=a.workbookTile.item,t=this.scope.viewModel.workbook,r=n.dataServices.ContractUtils.createMasterLayoutConfig({width:n.common.GridLayoutConstants.gridItemMediumLandscapeColSpan,height:n.common.GridLayoutConstants.gridItemMediumLandscapeRowSpan}),o={type:c.workbook,workbookId:t.id,packageId:t.contract.packageId,displayText:this.services.workbookService.getDefaultTileTitle(a.workbookTile,t.contract.displayName),subDisplayText:this.services.workbookService.getDefaultTileSubtitle(o),config:JSON.stringify(a),$config:a,action:JSON.stringify(i),layoutConfig:JSON.stringify(r),$layoutConfig:r},this.services.modelConverter.resolveTilePackage(o,this.services.packageService.packages),a=this.services.packageService.getWorkbookContentProvider(t.packageId),i=n.dataServices.AppUtils.findContentProviderName(this.services.contentProviderHttpService.getBuiltInContentProviders(this.services.activeFolderId),a),[4,(r=this.services.pinTileService).getSourceOrigin(this.services.permissionService.getWorkbookEffectivePermissions(t.contract),t.packageId)];case 2:return a=e.sent(),a=this.services.telemetryService.startEvent(n.telemetry.DashboardPinTile,{visualType:"",source:"Workbook",reason:"",unsupportedVisualPinned:!1,contentProviderType:i,isCustomVisual:!1,widgetType:"",reportPageContainsScriptVisuals:!1,sourceOrigin:a}),[4,r.showPinVisualFromWorkbookDialog(t.contract,o,a,this.pinTileScenario)];case 3:e.sent(),e.label=4;case 4:return[2]}}))}))},p.prototype.onEwaApplicationReady=function(e){var t=this;this.resetSelectionArgs();e=e.ewaControl;this.workbook=e.getActiveWorkbook(),e.add_activeSelectionChanged((function(e){return t.onWorkbookSelectionChange(e)})),e.add_workbookChanged((function(e){return t.onWorkbookChanged(e)})),this.scope.viewModel.workbookLoaded=!0,this.scope.appBarArgs.selection=new a(this.workbook,e.getActiveWorkbook().getActiveSelection(),this.services.promiseFactory)},p.prototype.onWorkbookSelectionChange=function(e){var t,o,i=this;this.scope.viewModel.workbookRangeSelected=!0,0===e.getSelectionType()?(t=e,this.scope.$applyAsync((function(){return i.scope.appBarArgs.selection=new a(i.workbook,t.getRange(),i.services.promiseFactory)}))):1===e.getSelectionType()&&(o=e,this.scope.$applyAsync((function(){return i.scope.appBarArgs.selection=new d(i.workbook,o.getNamedItem(),i.services.promiseFactory)})))},p.prototype.onWorkbookChanged=function(e){var t=this.scope.viewModel;!this.anyWorkbookChangesOccurred&&t.workbookRangeSelected&&(this.services.telemetryService.logEvent(n.telemetry.DashboardWorkbookEditedInPowerBICausedPinBlock),this.anyWorkbookChangesOccurred=!0),t.workbookChanged||(t.workbookChanged=!0,this.scope.$digest())},p.prototype.pinButtonResponse=function(){return __awaiter(this,void 0,n.Promise,(function(){var t,o;return __generator(this,(function(e){return this.scope.viewModel.workbookChanged?(this.pinTileScenario=0,this.showPinDashboardDialog()):this.scope.viewModel.workbookRangeSelected||this.services.applicationOptions.isE2ERun?(this.pinTileScenario=2,this.showPinDashboardDialog()):(this.pinTileScenario=1,t=this.services.localizationService.get("PinTile_RangeNotSelected"),o=this.services.localizationService.get("PinTile_RangeNotSelected_Title"),this.services.errorService.infoCustom(o,t)),[2]}))}))},p.WorkbookPinToastShown="workbookPinToastShown",i.WorkbookContainerController=p})(powerbi=powerbi||{}),(function(e){(e.controllers||(e.controllers={})).LandingController=function(){}})(powerbi=powerbi||{}),(function(e){(e.components||(e.components={})).Landing={templateUrl:"components/landing/landing.html",transclude:!0,controller:e.common.createController(e.controllers.LandingController)}})(powerbi=powerbi||{}),(function(e){(e.directives||(e.directives={})).CollapsiblePane=function(){this.restrict="E",this.templateUrl="views/collapsiblePane.html",this.transclude=!0,this.replace=!0,this.scope={viewModel:"=",isExpanderHidden:"="},this.controller=e.common.createController(e.controllers.CollapsiblePaneController)}})(powerbi=powerbi||{}),(function(a){var e,n;e=a.directives||(a.directives={}),n=a.controllers.contentProviderStore.ContentProviderSplashState,e.ContentProviderSplash=function(e,t,o,i){var r=this;this.downgradedRouterUtilities=i,this.restrict="E",this.templateUrl="views/contentProviderStore/contentProviderSplash.html",this.replace=!0,this.controller=a.common.createController(a.controllers.contentProviderStore.ContentProviderSplashController),this.link=function(e,t,o){var i=e.$eval(o.screenState),o=r.downgradedRouterUtilities.getCurrentActivatedRouteSnapshotLeaf().params.categoryName;i?(e.screenState=i)===n.GroupWelcome&&r.telemetryService.logEvent(a.telemetry.DashboardGetDataSplash,{state:"GroupWelcome"}):o===a.constants.navigation.getDataWelcome?(e.screenState=n.Welcome,r.telemetryService.logEvent(a.telemetry.DashboardGetDataSplash,{state:"Welcome"})):(e.screenState=n.GetData,r.telemetryService.logEvent(a.telemetry.DashboardGetDataSplash,{state:"GetData"}))},this.telemetryService=e,this.navigation=t}})(powerbi=powerbi||{}),(function(e){(e.directives||(e.directives={})).SharePointUrlModal=function(){this.restrict="E",this.templateUrl="views/contentProviderStore/customConfigHandlers/sharePointUrlModal.html"}})(powerbi=powerbi||{}),(function(r){!(function(e){var i,t;(t=i=i||{})[t.left=0]="left",t[t.right=1]="right",e.ContextMenu=function(){this.controller=r.common.createController(o),this.restrict="A",this.scope={context:"=",arrowDirection:"=?",showContextMenu:"=?"}};var o=(n.createOptions=function(){return{additionalServices:["$element","$templateCache","rtl","windowMetrics"]}},n.prototype.clickOutsideContextMenu=function(e){var t=e.pageX,o=e.pageY;if(this.contextMenuElement&&this.scope.contextMenuStyle===n.contextMenuActiveStyle){var i=this.contextMenuElement.offset(),r=i.left,a=i.top,e=r+this.contextMenuElement.width(),i=a+this.contextMenuElement.height();return t<r||e<t||o<a||i<o}return!1},n.prototype.blurAnchor=function(){this.element.is(":focus")&&this.element.blur()},n.prototype.dispose=function(){this.contextMenuElement&&this.contextMenuElement.remove(),$(window).off("resize",this.blurAnchor),$(window).off(jsCommon.DOMConstants.keyDownEventName,this.keyDownHideDialog),$(window).off(jsCommon.DOMConstants.mouseDownEventName,this.mouseDownHideDialog)},n.prototype.showDialog=function(e){var t=this;e&&(e.preventDefault(),e.stopPropagation()),this.template=angular.element(this.services.$templateCache.get("views/contextMenu.html")),this.contextMenuElement=this.services.compile(this.template)(this.scope),this.arrowElement=this.contextMenuElement.find(n.arrowSelector),$("body").append(this.contextMenuElement);var o=this.element.offset();this.services.timeout((function(){switch(t.arrowDirection){case i.left:o.left+=t.element.width()+n.arrowWidth+n.positionOffset.left,o.top-=t.contextMenuElement.height()/2-t.element.height()/2-n.positionOffset.top;break;case i.right:var e=t.contextMenuElement.width();o.left-=e+n.arrowWidth+n.positionOffset.left,o.top-=t.contextMenuElement.height()/2-t.element.height()/2-n.positionOffset.top,t.rtl&&t.rtl.isRtlLayout&&(e=t.windowMetrics.windowWidth-(o.left+e),o.left=null,t.contextMenuElement.css("right",e))}o.top=t.adjustPositionTop(o),t.contextMenuElement.css(o),t.scope.contextMenuStyle=n.contextMenuActiveStyle,t.scope.showContextMenu=!0}))},n.prototype.adjustPositionTop=function(e){var t=0+$(document).height()-this.contextMenuElement.height();return e.top<0?(this.arrowElement.css({top:+(e.top+this.contextMenuElement.height()/2)+n.arrowPositionOffset.top}),0):e.top>t?(this.arrowElement.css({top:e.top+this.contextMenuElement.height()/2-t+n.arrowPositionOffset.top}),t):(this.arrowElement.removeAttr("style"),e.top)},n.prototype.hideDialog=function(){this.contextMenuElement&&(this.scope.contextMenuStyle=n.contextMenuInactiveStyle,this.scope.showContextMenu=!1,this.dispose())},n.prototype.mouseDownHideDialog=function(e){var t=this;this.clickOutsideContextMenu(e)&&this.scope.$apply((function(){t.hideDialog()}))},n.prototype.keyDownHideDialog=function(e){var t=this;this.scope.contextMenuStyle===n.contextMenuActiveStyle&&27===e.keyCode&&this.scope.$apply((function(){t.hideDialog()}))},n.arrowPositionOffset={left:0,top:-10},n.arrowWidth=17,n.positionOffset={left:-22,top:0},n.contextMenuActiveStyle="active",n.contextMenuInactiveStyle="inactive",n.arrowSelector=".wrapper .arrow",n.rightArrowDirection="right",n);function n(e,t){var o=this;this.scope=e,this.services=t,this.element=this.services.$element,this.rtl=this.services.rtl,this.windowMetrics=this.services.windowMetrics,this.rtl&&this.rtl.isRtlLayout&&(e.arrowDirection=n.rightArrowDirection),this.arrowDirection=e.arrowDirection?i[e.arrowDirection]:i.left,this.scope.contextMenuStyle=n.contextMenuInactiveStyle,this.scope.close=function(){return o.hideDialog()},e.$on("$destroy",(function(){return o.dispose()})),$(window).on("resize",(function(){return o.blurAnchor()})),$(window).on(jsCommon.DOMConstants.keyDownEventName,(function(e){return o.keyDownHideDialog(e)})),$(window).on(jsCommon.DOMConstants.mouseDownEventName,(function(e){return o.mouseDownHideDialog(e)})),angular.isUndefined(e.showContextMenu)?this.element.bind(jsCommon.DOMConstants.mouseClickEventName,(function(e){return o.showDialog(e)})):this.scope.$watch((function(){return o.scope.showContextMenu}),(function(e,t){e&&!t&&o.scope.contextMenuStyle===n.contextMenuInactiveStyle?o.showDialog():!e&&t&&o.scope.contextMenuStyle===n.contextMenuActiveStyle&&o.hideDialog()}))}})(r.directives||(r.directives={}))})(powerbi=powerbi||{}),(function(D){!(function(e){var b=D.dataServices.AppUtils,f=D.common.models,y=D.helpers.DashboardTelemetryHelper,S=D.common.directives.InViewport,s=D.common.contracts.ArtifactType;e.DashboardWrapper=function(){this.restrict="E",this.templateUrl="views/dashboardWrapper.html",this.scope={viewModel:"=",displayLayout:"<",disablePointerEvents:"<?",mobileLayout:"<?",inEditMobileLayoutMode:"<?",isGroupTransitionDelayed:"<",enableStrategySwap:"<?",tileSorter:"=?",dashboardTileTouchAction:"@",keepDashboardOnLoadFail:"<?",disableKeyboardNav:"<?",hideSpinner:"<?"}};var t=(w.calculateDashboardScaleFactor=function(e,t,o,i,r){e=o/e;if(r)return e;t=i/t;return e<t?e:t},w.prototype.doesModelContainsTilesByLayout=function(e,t){return e&&(!e.tiles||void 0===t||0===_.filter(e.tiles,(function(e){return e.hasLayoutPosition(t)})).length)},w.prototype.recordOpenDashboardTelemetry=function(t,e,o,i,r,a){var n=this;e.artifactEndorsementFeatureUI&&o&&i?(null!==(e=this.artifactEndorsementSubscription)&&void 0!==e&&e.unsubscribe(),this.artifactEndorsementSubscription=this.artifactEndorsementService.getArtifactEndorsement(o,i,s.App,!1).subscribe((function(e){e=n.artifactEndorsementService.getArtifactStageString(e.stage);n.telemetryHelper.recordOpenDashboardEvent(t,i,n.folderService.activeFolderObjectId,r,n.permissionService.isActiveWorkspaceIsReadOnlyLegacy,a,n.userInfo.isGuestUser,e)}))):this.telemetryHelper.recordOpenDashboardEvent(t,i,this.folderService.activeFolderObjectId,r,this.permissionService.isActiveWorkspaceIsReadOnlyLegacy,a,this.userInfo.isGuestUser)},w.TransitioningCSSClass="transitioning",w.DashboardTransitionDurationMs=150,w.DashboardAnimationUITransitionType="transition.fadeIn",w.TileContainerPixelPadding=40,w.DashboardFitToScreenCSSClass="fitToScreen",w);function w(e,t,o,i,r,a,n,s,l,c,d,p,u,h,g,v){var m=this;this.telemetryService=e,this.gridLayout=t,this.userActivityContextService=o,this.appService=i,this.userInfo=r,this.timeout=a,this.folderService=n,this.dashboardLoadingProgressTrackingService=s,this.modelService=l,this.permissionService=c,this.usageMetricsReport=d,this.asyncFeatureSwitchService=p,this.packageService=u,this.informationProtectionService=h,this.artifactEndorsementService=g,this.globalEventBridge=v,this.restrict="E",this.templateUrl="views/dashboard.html",this.replace=!0,this.scope={viewModel:"=",displayLayout:"<",disablePointerEvents:"<?",mobileLayout:"<?",inEditMobileLayoutMode:"<?",isGroupTransitionDelayed:"<",enableStrategySwap:"<?",tileSorter:"=?",dashboardTileTouchAction:"@",keepDashboardOnLoadFail:"<?",disableKeyboardNav:"<?",hideSpinner:"<?"},this.controller=D.common.createController(D.controllers.DashboardController),this.link=function(p,u,e,t){var h=-1,g=!1;p.dashboardTileTouchAction=_.isEmpty(p.dashboardTileTouchAction)?"pan-y":p.dashboardTileTouchAction;var a=S.getRefreshAllHandler();p.scaleDashboard=function(e){var t=p.gridLayoutContainer.containerWidth+w.TileContainerPixelPadding,o=p.gridLayoutContainer.containerHeight,i=u.parent().width(),r=u.parent().height(),i=w.calculateDashboardScaleFactor(t,o,i,r,e);i<=0||(u.css({transform:"scale("+i+")",width:t+"px",height:e?r/i+"px":o+"px"}).addClass(w.DashboardFitToScreenCSSClass),a())};var o=p.fullScreen,i={onFitStyleChanged:function(){switch(o.fitStyle){case 1:p.scaleDashboard();break;case 2:p.scaleDashboard(!0);break;case 0:u.removeAttr("style").removeClass(w.DashboardFitToScreenCSSClass)}},onFullScreenModeChanged:_.noop};o.subscribe(i),p.$watch("viewModel",(function(o,e){var i,r,t,a,n;if(o&&e&&o.id!==e.id){o.gridLayoutService=e.gridLayoutService,o.gridLayoutService.strategy=new f.DefaultGridLayoutStrategy,o.gridLayoutService.displayLayout=0;var s=o.tiles;if(s)for(var l=0,c=s;l<c.length;l++){var d=c[l];d.gridLayoutContext&&d.gridLayoutContext.setActiveLayout(0),d.invalidateLayout()}}o&&(i=null,m.appService&&o.contract&&(i=b.getDashboardAppGUID(o,m.appService),r=null===(s=o.contract)||void 0===s?void 0:s.contentProviderId),a=null,m.packageService&&o.contract&&(t=_(__spreadArray([o.contract.originalPackageId],o.contract.packageIds||[])).map((function(e){return _.get(m.packageService.findPackage(e),"contract")})).groupBy("folderId").value(),n=_.find(m.packageService.packages,(function(e){return t[e.contract.folderId]&&e.contract.serviceAppObjectId})),a=n&&n.contract.serviceAppObjectId),m.dashboardLoadingProgressTrackingService.cancelTracking(),m.telemetryHelper=new y(m.telemetryService,m.userActivityContextService,m.timeout,m.dashboardLoadingProgressTrackingService,m.modelService,m.usageMetricsReport,p),m.asyncFeatureSwitchService.getFeatureSwitches().then((function(e){var t;e&&e.trackUserInfo&&!e.usageMetricsTrackUserLevelInfoEnabled&&(t=!0),m.recordOpenDashboardTelemetry(o,e,r,i,a,t),m.informationProtectionService.logDownstreamUsageInOpenDashboardFlow(o.id,null===(t=o.contract)||void 0===t?void 0:t.reportIds,null===(t=o.contract)||void 0===t?void 0:t.modelIds)})),m.dashboardLoadingProgressTrackingService.startTracking(o),m.gridLayout&&(o.gridLayoutService=m.gridLayout),n=p.displayLayout||0,_.isNumber(n),o.currentDisplayLayout=n),g=!0,window.clearTimeout(h),u.scrollTop(0).scrollLeft(0).addClass(w.TransitioningCSSClass)})),p.$watch("viewModel.isLoaded",(function(e,t){var o=m.doesModelContainsTilesByLayout(p.viewModel,p.displayLayout);e&&!t&&o&&p.$emit(D.common.constants.dashboardTileRepeatFinishedEvent)})),p.onDestroy=function(){var e;m.dashboardLoadingProgressTrackingService.cancelTracking(),o.unsubscribe(i),null!==(e=m.artifactEndorsementSubscription)&&void 0!==e&&e.unsubscribe()},p.$on(D.common.constants.dashboardTileRepeatFinishedEvent,(function(){m.globalEventBridge.publishToChannel(D.services.events.dashboardTileRepeatFinished),0!==p.fullScreen.fitStyle&&i.onFitStyleChanged(),t.scrollToSelectedTile(),g&&(h=window.setTimeout((function(){u.removeClass(w.TransitioningCSSClass)}),2e3),g=!1)}))}}e.Dashboard=t})(D.directives||(D.directives={}))})(powerbi=powerbi||{}),(function(e){var t,n;t=e.directives||(e.directives={}),n=e.constants,t.DashboardContainer=function(){this.template='<legacy-scoped-root><dashboard-scoped-services-bridge><dashboard-container-inner is-active="isActive"></dashboard-container-inner></dashboard-scoped-services-bridge></legacy-scoped-root>',this.scope={isActive:"="}},t.DashboardContainerInner=function(){this.restrict="E",this.templateUrl="views/dashboardContainer.html",this.scope={isActive:"="},this.controller=e.common.createController(e.controllers.DashboardContainerController),this.link=function(e,t,o){var i=e.rootScope.$on(n.inFocusEnterEvent,(function(){t.hide()})),r=e.rootScope.$on(n.inFocusExitEvent,(function(){t.show()})),a=e.$on("$destroy",(function(){i(),r(),a()}))}}})(powerbi=powerbi||{}),(function(e){(e.directives||(e.directives={})).ExcelUploadFormat=function(){this.restrict="E",this.templateUrl="views/excelUploadFormat.html",this.replace=!0,this.controller=e.common.createController(e.controllers.ExcelUploadFormatController)}})(powerbi=powerbi||{}),(function(e){var t,l,c;t=e.directives||(e.directives={}),l=jsCommon.DOMConstants,c=e.a11y.util.FocusUtility,t.FlyoutToggle=function(e,t){var s=this;this.$timeout=t,this.restrict="A",this.scope={flyoutToggle:"="},this.link=function(t,e,o){var i=s.$timeout,r=e.parent();function a(e){27===e.keyCode&&(t.flyoutToggle=!1,t.$applyAsync())}function n(e){i((function(){return t.flyoutToggle=c.isFocusInTree(r)}))}t.$watch("flyoutToggle",(function(e,t){e!==t&&!0===e?(s.$window.on(l.focusOutEventName,n),r.on(l.keyDownEventName,a)):e!==t&&!1===e&&(s.$window.off(l.focusOutEventName,n),r.off(l.keyDownEventName,a))}))},this.$window=$(e)}})(powerbi=powerbi||{}),(function(e){(e.directives||(e.directives={})).HistoryDialog=function(){this.restrict="E",this.replace=!0,this.templateUrl="views/historyDialogView.html",this.scope={viewModel:"="},this.controller=e.common.createController(e.controllers.HistoryDialogController)}})(powerbi=powerbi||{}),(function(a){(a.directives||(a.directives={})).InFocus=function(e,t){var r=this;this.promiseFactory=e,this.globalEventBridge=t,this.restrict="A",this.templateUrl="views/inFocus.html",this.scope={canEdit:"="},this.controller=a.common.createController(a.controllers.InFocusController),this.link=function(i,e){i.performTransitionAnimation=function(e){var t=$.Deferred();0===$(".inFocusTransition.begin").length&&$('<div class="inFocusTransition begin"></div>').insertAfter($("[in-focus]"));var o=$(".dashboardTile[data-id="+e+"]");if(0===o.length)return t.resolve(),t;var e=o.offset(),i=e.top,r=e.left,a=o.width(),n=o.height();return $(".inFocusTransition.begin").animate({opacity:1,top:0,left:0,width:"100%",height:"100%"},{duration:250,begin:function(){$(".begin").css({top:i,left:r,width:a,height:n})},complete:function(){t.resolve()}}),t},i.clearTransitionAnimation=function(){var e=r.promiseFactory.defer();return $(".inFocusTransition.begin").animate({opacity:0},{duration:350,complete:function(){$(".inFocusTransition.begin").css({width:0,height:0}),e.resolve(null)}}),e.promise};var o=_.throttle((function(e){var t,o=i.viewModel.inFocusTile;o&&o.realTime&&((t=i.onResizeViewport||e)&&(e=t.width-40,t=t.height-40,e<=0||t<=0||(o.calculateLayout({width:e,height:t}),o.applyLayout())))}),300);i.handleResize=function(e,t){o({width:e,height:t})},r.globalEventBridge.publishToChannel(a.services.events.inFocusDirectiveInitialized)}}})(powerbi=powerbi||{}),(function(e){(e.directives||(e.directives={})).LandingContainer=function(){this.restrict="E",this.replace=!0,this.transclude=!0,this.controller=e.common.createController(e.controllers.LandingContainer),this.templateUrl="views/landingContainer.html",this.controllerAs="$ctrl",this.scope=!0}})(powerbi=powerbi||{}),(function(e){(e.directives||(e.directives={})).LoadNotificationDialog=function(e){this.restrict="E",this.templateUrl="views/loadNotificationDialog.html",this.replace=!0,this.scope={message:"="},this.scope=e}})(powerbi=powerbi||{}),(function(o){(o.directives||(o.directives={})).OnLoad=function(){this.restrict="A",this.scope={onLoad:"&",onError:"&?"},this.link=function(e,t){t.on("load",(function(){e.$applyAsync((function(){e.onLoad()}))})),e.onError&&t.on("error",(function(){e.$applyAsync((function(){e.onError()}))})),e.$on(o.common.constants.scopeDestroyEventName,(function(){t.off()}))}}})(powerbi=powerbi||{}),(function(t){var e;(e=t.directives||(t.directives={})).PinTileDialog=function(){this.template="<legacy-scoped-root><dashboard-scoped-services-bridge><pin-tile-dialog-inner></pin-tile-dialog-inner></dashboard-scoped-services-bridge></legacy-scoped-root>"},e.PinTileDialogInner=function(e){var i=this;this.restrict="E",this.templateUrl="views/pinTileDialog.html",this.replace=!0,this.controller=t.common.createController(t.controllers.PinTileDialogController),this.link=function(e,t,o){i.$timeout((function(){t.find('input[type="text"]').focus(),$(".inputReportTitle").keypress((function(e){13===e.keyCode&&((e=$(".saveAndContinueBtn")).prop("disabled")||e.click())})),$(".inputDashboardTitle").keypress((function(e){13===e.charCode&&((e=$(".pinTile")).prop("disabled")||e.click())})),$("#newDashRadioInput").click((function(e){$(".inputDashboardTitle").focus()}))}),500),i.$timeout((function(){var e=t.find(".tilePreviewFrame .dashboardTile");0<e.length&&e.fadeIn(300)}))},this.$timeout=e}})(powerbi=powerbi||{}),(function(e){(e.directives||(e.directives={})).TaskPaneSlider=function(){this.restrict="E",this.templateUrl="views/taskPaneSliderView.html",this.scope={viewModel:"="},this.controllerAs="$ctrl",this.controller=e.common.createController(e.controllers.TaskPaneSliderController)}})(powerbi=powerbi||{}),(function(e){(e.directives||(e.directives={})).CompositeTile=function(){this.restrict="E",this.templateUrl="views/tiles/compositeTile.html",this.replace=!0,this.scope={viewModel:"=",allowInteractivity:"@",onClearTileError:"&?"},this.controllerAs="$ctrl",this.controller=e.common.createController(e.controllers.CompositeTileController)}})(powerbi=powerbi||{}),(function(o){!(function(e){var l=o.common.constants,c=o.dataServices.constants;e.DashboardTileWrapper=function(){this.restrict="E",this.templateUrl="views/tiles/dashboardTileWrapper.html",this.controllerAs="$ctrl",this.scope={viewModel:"=",canEdit:"<",disableInteractions:"<?",addTileToMobileView:"&?",inEditMobileLayoutMode:"<?",removeTileFromMobileView:"&?",viewportContextSelector:"<?",disableKeyboardNav:"<?"}};var t=(d.DragResizeDisabledAttr="drag-resize-disabled",d);function d(){this.restrict="E",this.templateUrl="views/tiles/dashboardTile.html",this.controllerAs="$ctrl",this.replace=!0,this.scope={viewModel:"=",canEdit:"<",disableInteractions:"<?",addTileToMobileView:"&?",inEditMobileLayoutMode:"<?",removeTileFromMobileView:"&?",viewportContextSelector:"<?",disableKeyboardNav:"<?"},this.link=function(i,r,e){var t=i.viewModel.report;t&&r.attr("data-report-id",t.id),i.disablePointerEvents="true"===e.disablePointerEvents||i.disableInteractions,i.onceInViewport=function(){i.inViewport=!0};var o=i.$root.$on(c.deleteModelStartedEventName,(function(e,t){var o=i.viewModel.datasetModel;o&&o.id===t&&r.hide()})),a=i.$root.$on(c.deleteModelFailedEventName,(function(e,t){var o=i.viewModel.datasetModel;o&&o.id===t&&r.show()}));i.$watch("canEdit",(function(e,t){r.attr(d.DragResizeDisabledAttr,e?"false":"true")})),i.isTileElementChanging=function(){return r.hasClass("changing")};function n(e){i.openTile(!1,e)&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)}var e=i.viewModel,s=r.find(".tileContent")[0];e&&!e.reportTile&&s&&s.addEventListener("click",n,!0),i.$on(l.scopeDestroyEventName,(function(){s&&s.removeEventListener("click",n,!0),a(),o()}))},this.controller=o.common.createController(o.controllers.DashboardTileController)}e.DashboardTile=t})(o.directives||(o.directives={}))})(powerbi=powerbi||{}),(function(e){var t;(t=e.directives||(e.directives={})).ReportTile=function(){this.template='<legacy-scoped-root><exploration-scoped-services-bridge><report-tile-inner view-model="viewModel"></report-tile-inner></exploration-scoped-services-bridge></legacy-scoped-root>',this.scope={viewModel:"="}},t.ReportTileInner=function(){this.restrict="E",this.templateUrl="views/tiles/reportTile.html",this.replace=!0,this.scope={viewModel:"="},this.controller=e.common.createController(e.controllers.ReportTileController)}})(powerbi=powerbi||{}),(function(e){(e.directives||(e.directives={})).WorkbookTile=function(){this.restrict="E",this.templateUrl="views/tiles/workbookTile.html",this.replace=!0,this.scope={viewModel:"=",title:"="},this.controller=e.common.createController(e.controllers.WorkbookTileController),this.link=function(e,o,t){e.onTileImageReady=function(t){o.find("img.internalWorkbookTileImage").on("load",(function(e){t(e.currentTarget)}))}}}})(powerbi=powerbi||{}),(function(e){var t;(t=e.directives||(e.directives={})).TileWrapper=function(){this.restrict="E",this.templateUrl="views/tiles/tileWrapper.html",this.controllerAs="$ctrl",this.scope={viewModel:"=",headerClickTarget:"&",inEditMobileLayoutMode:"<?"}},t.Tile=function(){this.restrict="E",this.templateUrl="views/tiles/tile.html",this.replace=!0,this.scope={viewModel:"=",headerClickTarget:"&",inEditMobileLayoutMode:"<?"},this.controller=e.common.createController(e.controllers.Tile),this.link=function(e,t,o,i){var r;e.disablePointerEvents="true"===o.disablePointerEvents,e.largeHeader=o.hasOwnProperty("largeHeader"),e.allowInteractivity=o.allowInteractivity,e.largeHeader&&e.viewModel.setTileHeaderSize(0),void 0!==window.ResizeObserver&&((r=new ResizeObserver(function(e,t){return i.onResize()})).observe(t[0]),e.$on("$destroy",(function(){r.disconnect()})))}}})(powerbi=powerbi||{}),(function(e){(e.directives||(e.directives={})).UserInfoContainer=function(){this.restrict="E",this.replace=!0,this.transclude=!0,this.controller=e.common.createController(e.controllers.UserInfoController),this.template='<div ng-transclude class="userInfo"></div>'}})(powerbi=powerbi||{}),(function(e){(e.directives||(e.directives={})).WaterMarkMessage=function(){this.restrict="E",this.templateUrl="views/waterMarkMessage.html",this.scope={config:"<"}}})(powerbi=powerbi||{}),(function(e){(e.directives||(e.directives={})).WorkbookAppBar=function(){this.restrict="E",this.replace=!0,this.templateUrl="views/workbookAppBar.html",this.scope={viewModel:"="},this.controller=e.common.createController(e.controllers.WorkbookAppBarController)}})(powerbi=powerbi||{}),(function(e){(e.directives||(e.directives={})).WorkbookContainer=function(){this.restrict="E",this.templateUrl="views/workbookContainer.html",this.replace=!0,this.scope={},this.controller=e.common.createController(e.controllers.WorkbookContainerController),this.link=function(e,t,o){e.getEwaTargetWindow=function(){return t.find("iframe.workbookEWAIsolation")[0].contentWindow}}}})(powerbi=powerbi||{}),(function(e){(e.directives||(e.directives={})).WorkbookDiscoverabilityToast=function(){this.restrict="E",this.replace=!0,this.templateUrl="views/workbookDiscoverabilityToast.html"}})(powerbi=powerbi||{}),(function(e){var t;((t=e.helpers||(e.helpers={})).CanReshareArtifactHelper||(t.CanReshareArtifactHelper={})).showErrorIfCannotReshare=function(r,a,n,s,l){return __awaiter(this,void 0,e.Promise,(function(){var t,o,i;return __generator(this,(function(e){switch(e.label){case 0:return[4,n.get("@powerbi/WebSharing/web-sharing.module#WebSharingModule","permissionData")];case 1:return[4,e.sent().currentUserHasResharePermissionToArtifact(r,a)];case 2:switch((t=e.sent()).resultCode){case 0:return[2,!1];case 2:switch(o=void 0,r){case 1:o=l.get("ArtifactKind_Dashboard");break;case 2:o=l.get("ArtifactKind_Report");break;case 4:o=l.get("ArtifactKind_Workbook");break;case 3:o=l.get("ArtifactKind_Dataset");break;default:o=l.get("ArtifactKind_Artifact")}return i=l.format("PermissionCenter_ErrorMessage_LostReshare",[o,o]),s.errorNoDefaultAdditionalErrorInfo(i,"PermissionCenter_PermissionRequired_Title",{requestId:t.errorRequestId,statusCode:t.errorHttpStatusCode?t.errorHttpStatusCode.toString():void 0,title:l.get("PermissionCenter_PermissionRequired_Title")}),[2,!0];case 3:return s.error(l.get("PermissionCenter_ErrorMessage_Generic"),"PermissionCenter_ErrorMessage_Generic",{requestId:t.errorRequestId,statusCode:t.errorHttpStatusCode?t.errorHttpStatusCode.toString():void 0,title:l.get("PermissionCenter_ErrorTitle")}),[2,!0];default:return[2,!1]}return[2]}}))}))}})(powerbi=powerbi||{}),(function(e){(e=(e=e.helpers||(e.helpers={})).EmailValidationHelper||(e.EmailValidationHelper={})).validateInputTags=function(w,D,T){D.emailValidationError=D.emailValidationWarning="",D.showSecurityGroupUpgradeAccount=!1;var C=w.promiseFactory.defer();return w.domainHelperService.getVerifiedDomains().then((function(e){var t={},o={},i=null,r="",a=0,n=0,s=w.licenseEnforcementService.supportsGroups();if(D&&D.emailsList){var l=D.emailsList.inputUserList,c=T.maxNumberOfEmailsAllowedAtATime;0<c&&l.length>c&&(D.emailValidationError=w.localizationService.format("MaxOneTimeEmailCountReached",[c]),i=2,r="User entered "+l.length+" email addresses");for(var d=!1,p=0,u=l;p<u.length;p++){var h,g=u[p];g.userPrincipalName&&(h=g.userPrincipalName.split("@")[1].toLowerCase(),e.verifiedDomains[h.toUpperCase()]||(t[h]=h,a++),e.blockedDomains[h.toUpperCase()]&&(o[h]=h,n++)),g.isSecurityGroup&&!s&&(d=!0)}var v,m="",b=0;for(v in t)b++,m+=v+", ";var f,y="",S=0;for(f in o)S++,y+=f+", ";d&&(D.showSecurityGroupUpgradeAccount=!0),_.endsWith(m,", ")&&(m=m.substring(0,m.length-2)),_.endsWith(y,", ")&&(y=y.substring(0,y.length-2)),!T.disableExternalSharingValidationOnFE&&!w.featureSwitchService.featureSwitches.externalSharingEnabled&&0<b?(D.emailValidationError=w.localizationService.format("Sharing_ExternalSharingDisabled"),i=0,r=m):T.shouldBlockExternalDomains&&0<b?(D.emailValidationError=w.localizationService.format("Sharing_EmailDomainNotInTenant"),i=0,r=m):T.shouldBlockConsumerDomains&&0<S?(D.emailValidationError=w.localizationService.format("Sharing_BlockedDomains",[y]),i=1,r=y):0<b&&(D.emailValidationWarning=w.localizationService.format("Sharing_ExternalOrganization",[m]))}!_.isEmpty(D.emailValidationError)?C.reject({errorReason:r,errorType:i}):C.resolve({externalEmailCount:a,consumerEmailCount:n})}),(function(e){C.reject(null)})),C.promise},e.isValidEmailAddress=function(e){return new RegExp("^([!#$%&'*+/=?^{|}~\\w\\-\\.\\u00c0-\\uffff]{1,64}@[\\w\\-\\.\\u00c0-\\uffff]{1,253}\\.\\w{1,63})$").test(e)}})(powerbi=powerbi||{}),(function(e){function t(){var t=this;this.reports=[],this.dashboards=[],this.tiles=[],this.models=[],this.isReportExpanded=!0,this.isDashboardExpanded=!1,this.isTileExpanded=!1,this.onCuratedContentExpanded=function(e){t.openOneAtTime(e)}}e=e.models||(e.models={}),Object.defineProperty(t.prototype,"dashboardCount",{get:function(){return this.dashboards.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tileCount",{get:function(){return this.tiles.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"reportCount",{get:function(){return this.reports.length},enumerable:!1,configurable:!0}),t.prototype.addModels=function(e){for(var t=0,o=e=e||[];t<o.length;t++){var i=o[t];this.models.push(i)}},t.prototype.addReports=function(e){for(var t=0,o=e=e||[];t<o.length;t++){var i=o[t];i.reportUrl&&this.reports.push(i)}},t.prototype.addDashboards=function(e){for(var t=0,o=e=e||[];t<o.length;t++){var i=o[t];this.dashboards.push(i)}},t.prototype.addTiles=function(e){for(var t=0,o=e=e||[];t<o.length;t++){var i=o[t];this.tiles.push(i)}},t.prototype.openOneAtTime=function(e){"report"===e?(this.isReportExpanded=!this.isReportExpanded,this.isReportExpanded&&(this.isDashboardExpanded=!1,this.isTileExpanded=!1)):"dashboard"===e?(this.isDashboardExpanded=!this.isDashboardExpanded,this.isDashboardExpanded&&(this.isReportExpanded=!1,this.isTileExpanded=!1)):"tile"===e&&(this.isTileExpanded=!this.isTileExpanded,this.isTileExpanded&&(this.isReportExpanded=!1,this.isDashboardExpanded=!1))},e.ActivityPaneCuratedContentModel=t})(powerbi=powerbi||{}),(function(n){var s;function e(){this._connectionOptionsTag=-1}s=n.models||(n.models={}),Object.defineProperty(e.prototype,"connectionOptionsTag",{get:function(){return this._connectionOptionsTag},enumerable:!1,configurable:!0}),e.prototype.onPackageSelectionChange=function(e){this.packageSelectionEvent=e},e.prototype.updatePackagesData=function(e){var t,o;e&&(t=-1,o=null,this.packageItems&&(t=this.packageItems.selectedIndex,o=this.packageItems.selectedItem),this.packageModels=[],this.activityPaneData=e.activityPaneData,this.packageItems=this.initializePackageNames(o),-1!==t?this.packageItems.selectedIndex=t:0<this.packageItems.itemsCount&&(this.packageItems.selectedIndex=0))},e.prototype.initializePackageNames=function(e){var t=this,o=[];if(0<this.activityPaneData.length){o=this.activityPaneData.map((function(e){return new s.ComboBoxItem(e.packageName,e.packageId)})),this.packageItems||(this.packageItems=new s.ComboBoxModel),this.packageItems.clearItems(),o.sort((function(e,t){return e.name.toLowerCase().localeCompare(t.name.toLowerCase())}));for(var i=0,r=o;i<r.length;i++){var a=r[i];this.packageItems.addItem(a)}-1===this.packageItems.selectedIndex&&0<this.packageItems.itemsCount&&(this.packageItems.selectedIndex=0),this.packageItems.addSeparator(),this.packageItems.addItem(new s.ComboBoxItem(n.common.getLocalize().get("ActivityPane_ConnectionOptionsText"),this.connectionOptionsTag,s.ComboBoxItemType.Text,!1)),e=e||this.packageItems.selectedItem,this.populateSelectedPackageModels(e)}return this.packageItems.onClickEvent=function(e){return t.onPackageItemSelected(e)},this.packageItems.onDropDownEvent=function(){return t.onPackageItemSelected()},this.packageItems},e.prototype.onPackageItemSelected=function(e){e=e||this.packageItems.selectedItem,this.populateSelectedPackageModels(e),this.packageSelectionEvent&&this.packageSelectionEvent(e)},e.prototype.populateSelectedPackageModels=function(e){if(e.tag!==this.connectionOptionsTag)for(var t=0,o=this.activityPaneData;t<o.length;t++){var i=o[t];if(i.packageId===e.tag){if(!i.models)return;if(this.packageModels=[],1===i.models.length){var r=i.models[0];this.packageModels[0]={modelId:r.id,modelName:n.common.getLocalize().get("ActivityPane_Explore")}}else for(var a=0;a<i.models.length;a++){r=i.models[a];this.packageModels[a]={modelId:r.id,modelName:n.common.getLocalize().get("ActivityPane_Explore")+" "+r.displayName}}break}}},s.ActivityPaneDataPackagesModel=e,s.ActivityPanePackageModel=function(e,t){this.modelId=e,this.modelName=t}})(powerbi=powerbi||{}),(function(e){(e.models||(e.models={})).ActivityPaneModel=function(e){this.contract=e}})(powerbi=powerbi||{}),(function(e){!(function(e){var r;(i=r=e.ComboBoxItemType||(e.ComboBoxItemType={}))[i.Text=1]="Text",i[i.Separator=2]="Separator";var t=(Object.defineProperty(o.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"tag",{get:function(){return this._tag},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"selectable",{get:function(){return this._selectable},enumerable:!1,configurable:!0}),o);function o(e,t,o,i){this._name=e,this._tag=t,this._type=o||r.Text,this._selectable=void 0===i||i}e.ComboBoxItem=t;var i=(Object.defineProperty(a.prototype,"separatorTag",{get:function(){return this._separatorTag},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"isVisible",{get:function(){return this._dialogVisible},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"selectedItem",{get:function(){return this._items[this._selectedIndex]},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"selectedIndex",{get:function(){return this._selectedIndex},set:function(e){this._selectedIndex=e},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"items",{get:function(){return this._items},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"itemsCount",{get:function(){return this._items.length},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"onClickEvent",{set:function(e){this._onClickEvent=e},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"onDropDownEvent",{set:function(e){this._onDropDownEvent=e},enumerable:!1,configurable:!0}),a.prototype.clearItems=function(){this._items=[]},a.prototype.addItem=function(e){this._items.push(e)},a.prototype.addSeparator=function(){this._items.push(new t("",-9,r.Separator,!1))},a.prototype.collapse=function(){this._dialogVisible=!1},a.prototype.toggle=function(e){this._dialogVisible||this._onDropDownEvent&&this._onDropDownEvent(),this._dialogVisible=!this._dialogVisible,e.stopPropagation()},a);function a(){this._items=[],this._dialogVisible=!1,this._selectedIndex=-1,this._separatorTag=-9}e.ComboBoxModel=i})(e.models||(e.models={}))})(powerbi=powerbi||{}),(function(o){var i;function e(e,t){this.localizationService=t,this.contract=e,this.contentProviderDialogModel=new o.common.models.ModalDialogModel(!1,"Ok",!0,this.localizationService,!0,!0,!1),this.manageStoragePane=new i.ManageStorageViewModel,this.temporaryDashboardMap=null,this.viewMode=0,this.contentProviderDialogModel.confirmButtonText=this.localizationService.get("PBI_Button_Label_OK")}i=o.models||(o.models={}),Object.defineProperty(e.prototype,"dashboards",{get:function(){return this._dashboards},set:function(e){this._dashboards=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"visibleDashboards",{get:function(){return _.filter(this._dashboards,(function(e){return!e.isHidden}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"models",{get:function(){return this.contract.models},enumerable:!1,configurable:!0}),e.prototype.cacheTemporaryDashBoardMapping=function(e,t){this.temporaryDashboardMap={temporaryId:e,resolvedId:t}},e.prototype.calculateLayout=function(){if(this._dashboards)for(var e=0,t=this._dashboards;e<t.length;e++)t[e].calculateLayout()},e.prototype.applyLayout=function(e){if(this._dashboards)for(var t=0,o=this._dashboards;t<o.length;t++)o[t].applyLayout()},e.prototype.findDashboard=function(e){return this.dashboards[this.getDashboardIndex(e)]},e.prototype.findDashboardByGUID=function(e){var t=this.dashboards;this.temporaryDashboardMap&&this.temporaryDashboardMap.resolvedId&&this.temporaryDashboardMap.temporaryId&&this.temporaryDashboardMap.temporaryId===e&&(e=this.temporaryDashboardMap.resolvedId);for(var o=0,i=t.length;o<i;o++)if(t[o].objectId===e)return t[o]},e.prototype.getDashboardIndex=function(e){for(var t=this.dashboards,o=0,i=t.length;o<i;o++)if(t[o].id===e)return o;return-1},i.DashboardContainer=e})(powerbi=powerbi||{}),(function(e){var t;t=e.models||(e.models={}),(e=t.UploadFormat||(t.UploadFormat={}))[e.ImportData=0]="ImportData",e[e.ViewExcel=1]="ViewExcel",(e=t.HostType||(t.HostType={}))[e.Local=0]="Local",e[e.OneDrive=1]="OneDrive",e[e.DropBox=2]="DropBox",e[e.OneDrivePro=3]="OneDrivePro",e[e.SharePoint=4]="SharePoint",t.ExcelUploadFormat=function(){}})(powerbi=powerbi||{}),(function(e){var t,o,i;function r(e,t,o,i,r,a){this.id=e,this.name=t,this.lastModified=o,this.size=i,this.entryType=r,this.downloadUrl=a}t=e.models||(e.models={}),o=e.constants.fileExtensions,i=jsCommon.FileUtils,Object.defineProperty(r.prototype,"formattedSize",{get:function(){if(null==this.size)return"";var e=this.size/1024,t="KB";return 1024<e&&(t="MB",1048576<(e/=1024)&&(t="GB",1073741824<(e/=1024)&&(e/=1024,t="TB"))),e.toFixed(2)+t},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"iconPath",{get:function(){var e=this.name.toLocaleLowerCase();return _.endsWith(e,o.xlsxFileExtension)||_.endsWith(e,o.xlsxmFileExtension)?"excelIcon":_.endsWith(e,o.pbiFileExtension)?"pbixIcon":_.endsWith(e,o.csvFileExtension)?"csvIcon":1===this.entryType||2===this.entryType?"folder":""},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"fileExtension",{get:function(){return"."+i.getFileExtension(this.name)},enumerable:!1,configurable:!0}),t.FileBrowserEntry=r})(powerbi=powerbi||{}),(function(t){var o,i,r,e;function a(e,t){this.localizationService=t,this.isAdmin=!(!e||!e.contract)&&(e.contract.isOwner||e.contract.isMyWorkspace),this.groupName=e?e.displayName:"",this.groupId="",this.contactList=new r,this.emailsList=new r,this.sharePointStorageList=new r,this.displayMemberList=[],this.originalDisplayMemberList=[],this.invalidEmailAddressesErrorMessage="",this.notExitingEmailAddressesErrorMessage="",this.notificationTarget=0,this.privacyOption=e&&e.contract&&e.contract.isPublic?0:1,this.accessControlOption=e&&e.contract&&e.contract.isReadOnly?1:0,this.capacity=e&&e.capacity,this.isFolder=e instanceof o.Folder,this.defaultDatasetStorageFormat=1,this.licenseMode=i.Pro,e&&this.isFolder&&(this.iconUrl=(t=e).icon,this.description=t.description,this.isAdmin=2==(2&t.permissions),this.contactList.inputUserList=t.contacts,this.notificationTarget=_.isEmpty(t.contacts)?0:1,this.allowContributorUpdateApp=t.allowContributorUpdateApp,this.defaultDatasetStorageFormat=t.defaultDatasetStorageMode||1,this.folderType=t.type),this.initWorkspaceConnection(e),this.initPrivacyOptions(),this.initAccessControlOptions(),this.initMemberRoleOptions()}o=t.models||(t.models={}),r=t.common.models.EmailsListModel,Object.defineProperty(a.prototype,"isCapacityEnabled",{get:function(){return null==this.licenseMode?!!this.capacity:this.licenseMode!==i.Pro},enumerable:!1,configurable:!0}),a.prototype.initWorkspaceConnection=function(e){_.isEmpty(this.groupName)||e.workspaceId===t.common.constants.myWorkspaceFolderId||(this.workspaceConnection="powerbi://"+window.xmlaEndpointApiDNSName+"/v1.0/myorg/"+encodeURIComponent(this.groupName))},a.prototype.initPrivacyOptions=function(){this.privacyOptions=[{key:0,value:this.localizationService.get("GroupEditor_PrivacyOptions_Public")},{key:1,value:this.localizationService.get("GroupEditor_PrivacyOptions_Private")}]},a.prototype.initAccessControlOptions=function(){this.accessControlOptions=[{key:0,value:this.localizationService.get("GroupEditor_AccessControlOptions_ReadWrite")},{key:1,value:this.localizationService.get("GroupEditor_AccessControlOptions_ReadOnly")}]},a.prototype.initMemberRoleOptions=function(){this.groupMemberRoleOptions=[{key:1,value:this.localizationService.get("GroupEditor_RoleOptions_Admin")},{key:0,value:this.localizationService.get("GroupEditor_RoleOptions_Member")}]},e=a,o.GroupEditorModel=e,(e=i=o.LicenseMode||(o.LicenseMode={}))[e.Pro=0]="Pro",e[e.PPU=1]="PPU",e[e.Premium=2]="Premium",e[e.Embedded=3]="Embedded"})(powerbi=powerbi||{}),(function(e){var t,l;function o(e,t,o,i){this.localizationService=e,this.invalidEmailAddressesErrorMessage="",this.notExitingEmailAddressesErrorMessage="",this.folderMemberRoleOption=0,this.localizedAdmin=this.localizationService.get("GroupEditor_RoleOptions_Admin"),this.localizedMember=this.localizationService.get("GroupEditor_RoleOptions_Member"),this.localizedContributor=this.localizationService.get("GroupEditor_RoleOptions_Contributor"),this.localizedViewer=this.localizationService.get("GroupEditor_RoleOptions_Viewer"),this.localizedRemove=this.localizationService.get("Remove"),this.folderMemberActionOptionAdminByRole={};var r={text:this.localizedAdmin,action:2,type:DropDownMenuItemType.Item},a={text:this.localizedMember,action:0,type:DropDownMenuItemType.Item},n={text:this.localizedContributor,action:1,type:DropDownMenuItemType.Item},s={text:this.localizedViewer,action:4,type:DropDownMenuItemType.Item},e={text:this.localizedRemove,action:3,type:DropDownMenuItemType.Item};this.folder=o;o=!i||void 0===this.folder||this.folder.type!==l.AdminFolder,i=[a,n];t&&i.push(s),i.push(e),this.folderMemberActionOptionAdminByRole[2]=i;i=[];o&&i.push(r),i.push(n),t&&i.push(s),i.push(e),this.folderMemberActionOptionAdminByRole[0]=i;i=[];o&&i.push(r),i.push(a),t&&i.push(s),i.push(e),this.folderMemberActionOptionAdminByRole[1]=i,this.folderMemberActionOptionAdminByRole[4]=o?[r,a,n,e]:[a,n,e],this.folderServicePrincipalProfileActionOption=[e]}t=e.models||(e.models={}),l=e.common.contracts.FolderType,Object.defineProperty(o.prototype,"members",{get:function(){return this.permissionArtifact?this.permissionArtifact.members:[]},enumerable:!1,configurable:!0}),t.FolderPermissionsEditModel=o})(powerbi=powerbi||{}),(function(e){(e.models||(e.models={})).HistoryDialogModel=function(){this.showHistoryDialog=!1,this.showSpinner=!1}})(powerbi=powerbi||{}),(function(e){((e=e.models||(e.models={})).insights||(e.insights={})).InsightsModel=function(){}})(powerbi=powerbi||{}),(function(e){(e.models||(e.models={})).ManageStorageViewModel=function(){}})(powerbi=powerbi||{}),(function(h){!(function(s){var c=h.common.constants,i=h.common.helpers.ModelConverterHelper,o=h.dataServices.models.Dashboard,l=h.common.controllers.EmailsListController,d=h.common.models.EmailsListModel,p=jsCommon.JsonExtensions,r=window;s.createModelConverter=function(e,t,o,i,r,a,n,s){return new u(e,t,o,i,r,a,n,s)};var u=(e.prototype.setModelMerger=function(e){this.modelMerger=e},e.prototype.convertAppPublishModel=function(e){var t=h.helpers.PublishAppHelper.getTenantId(),o=this.convertContentPack(e);if(o){var i=this.dataServiceModelConverter.convertAppModelBase(e),i=__assign(__assign({url:this.downgradedUrlBuilder.getAppUrl(e.providerKey,t),displayName:e.displayText,objectId:e.providerKey,emailsList:new d,contactsList:void 0,publishAsTemplate:7===e.category,getPermissions:function(){return 17}},o),i);if(_.isEmpty(e.accessPermissions.adUserMetadataList))i.emailsList.inputUserList=l.emailsToUsers(e.accessPermissions.listOfGroupsOrPrincipals);else{i.emailsList.inputUserList=_.cloneDeep(e.accessPermissions.adUserMetadataList);for(var r=0,a=i.emailsList.inputUserList;r<a.length;r++){var n=a[r];n.userPrincipalName&&1!==n.groupType&&3!==n.groupType||(n.isSecurityGroup=!0)}}e=p.tryParseJSON(e.providerConfig);return e&&e.appSettings&&(i.allowCopyContent=!!e.appSettings.allowCopyContent),i}},e.prototype.fillReport=function(e,t){this.dataServiceModelConverter.fillReport(e,t)},e.prototype.convertReport=function(e){return this.dataServiceModelConverter.convertReport(e)},e.prototype.convertDatapool=function(e){return this.dataServiceModelConverter.convertCdsaModel(e)},e.prototype.convertPackage=function(e){return this.dataServiceModelConverter.convertPackage(e)},e.prototype.convertWorkbookContainerShallow=function(e){return new s.WorkbookContainer(e)},e.prototype.convertWorkbookContainer=function(e){var t=this.convertWorkbookContainerShallow(e);return this.fillWorkbookContainerChildren(t,e),t},e.prototype.fillWorkbookContainerChildren=function(e,t){t&&(e.workbook=this.convertWorkbook(t))},e.prototype.convertWorkbook=function(e){return this.dataServiceModelConverter.convertWorkbook(e)},e.prototype.convertWorkbookShallow=function(e){return this.dataServiceModelConverter.convertWorkbookShallow(e)},e.prototype.convertModel=function(e){return this.dataServiceModelConverter.convertModel(e)},e.prototype.convertContentPack=function(e){var t=this.dataServiceModelConverter.convertContentPackBase(e);if(e)return __assign({publishedTo:this.findPublishedTo(e.accessPermissions),isDirty:e.isDirty,listOfGroupPrincipals:e.accessPermissions.listOfGroupsOrPrincipals,isSharedToEntireOrg:e.accessPermissions.isSharedToEntireOrganization},t)},e.prototype.findPublishedTo=function(e){if(e.isSharedToEntireOrganization)return this.localizationService.get("GetData_MyOrganization");var t=this.localizationService.get("PowerBI_Semicolon_Delimiter");return(e.adUserMetadataList?_.map(e.adUserMetadataList,(function(e){return e.displayName||e.userPrincipalName})):e.listOfGroupsOrPrincipals).join(t)},e.prototype.convertDashboardContainerShallow=function(e){var t=new s.DashboardContainer(e,this.localizationService);return t.activeViewMode=e.activeViewMode,t.userId=e.userId,t},e.prototype.fillDashboardContainerDashboard=function(e){var t,o=this;e.dashboards&&1===e.dashboards.length&&(t=e.packages||[],(e=e.dashboards[0]).tiles&&e.tiles.map((function(e){o.resolveTilePackage(e,t)})))},e.prototype.setDashboardHasUpdate=function(t,e){t.hasUpdate=!1;e=_.find(e,(function(e){return e.id===t.contract.originalPackageId}));e&&e.latestVersion&&e.version!==e.latestVersion&&(t.hasUpdate=!0)},e.prototype.setDashboardsHasUpdate=function(e){for(var t=0,o=e;t<o.length;t++)o[t].hasUpdate=!0},e.prototype.fillDashboardContainerDashboards=function(e,t){t.dashboards&&(e.userId=t.userId,this.fillDashboardContainerDashboardsFromBasicDashboardContainer(e,t))},e.prototype.fillDashboardContainerDashboardsFromBasicDashboardContainer=function(e,o){var i,r,a,n,s=this;o.dashboards&&(i=o.reports||[],r=o.workbooks||[],a=o.models||[],n=o.packages||[],e.dashboards=o.dashboards.map((function(e){var t=s.convertDashboard(e,a,i,r);return s.setDashboardHasUpdate(t,n),e.id===o.activeDashboardId&&t.contract.tiles&&t.contract.tiles.map((function(e){s.resolveTilePackage(e,n)})),t})))},e.prototype.updateDashboardContainerContract=function(e){this.updateBasicDashboardContainer(e)},e.prototype.updateDashboardsReportContract=function(e,t){t.reportIds.splice(e,1)},e.prototype.removeDashboardsWorkbookContract=function(e,t){t.workbookIds.splice(e,1)},e.prototype.updateBasicDashboardContainer=function(e){var t=e.dashboards;void 0===e.activeDashboardId&&t&&0<t.length&&(e.activeDashboardId=t[0].id),this.modelMerger.mergeModelContentProviderId(e.models,e.packages)},e.prototype.resolveTilePackage=function(e,t){this.dataServiceModelConverter.resolveTilePackage(e,t)},e.prototype.getTileModel=function(e,t){return this.dataServiceModelConverter.getTileModel(e,t)},e.prototype.getTileReport=function(e,t){return this.dataServiceModelConverter.getTileReport(e,t)},e.prototype.getTileWorkbook=function(e,t,o){return this.dataServiceModelConverter.getTileWorkbook(e,t,o)},e.prototype.fillDashboardContainerDashboardsShallow=function(e,t){var o=this;t.dashboards&&(e.dashboards=t.dashboards.map((function(e){return o.convertDashboardShallow(e)})))},e.prototype.convertDashboardContainer=function(e){var t=this.convertDashboardContainerShallow(e);return this.fillDashboardContainerDashboards(t,e),e.activityPane&&(t.activityPane=this.convertActivityPane(e.activityPane)),t},e.prototype.convertActivityPane=function(e){var t=this,o=this.convertActivityPaneShallow(e);return e.contentProviders||(o.contentProviders=e.contentProviders.map((function(e){return t.convertContentProvider(e)}))),o},e.prototype.convertActivityPaneShallow=function(e){return new s.ActivityPaneModel(e)},e.prototype.convertContentProvider=function(e){if(!e)return null;var t=new s.ProviderTileModel(e);return t.backgroundImageUrl=h.getBuild()+e.iconUrl,t.displayText=e.displayText,t},e.prototype.convertContentProviderContractToContentProviderTileModel=function(e){var t,o=null;return e&&(t=this.promiseFactory.defer(),e.authentication||t.resolve(""),o={contract:e,id:e.id,title:e.displayText,category:e.category,clientCategory:i.getContentProviderClientCategory(e),providerName:e.providerName,iconUrl:e.iconUrl?jsCommon.Utility.urlCombine(r.clusterUri,e.iconUrl):null,iconCSSClass:e.iconCSSClass,descriptionLocalizationKey:e.description,learnMoreUrl:e.learnMoreUrl,searchKeywords:e.searchKeywords,publisher:e.publisher,publishDate:e.publishDate,emailAddress:null,emailAddressAsLink:null,visible:!1,disableDetailPane:e.disableDetailPane,sortPriority:null!==e.sortPriority&&void 0!==e.sortPriority?e.sortPriority:c.contentProviderStoreTileMaxSortPriority,authentication:e.authentication,authenticationInitializationDeferred:t,authenticationInitializationInProgress:!0,finePrint:e.finePrint,autoRedirectUrlParams:e.autoRedirectUrlParams,customConfigurationHandler:e.customConfigurationHandler,tileGrouping:null,usePBIDesktop:e.usePBIDesktop}),o},e.prototype.convertContentProviderContractToContentProviderTileModelWithGrouping=function(e){var t=null;return t=e?{contract:e,id:e.id,title:e.grouping.groupingName,category:e.category,clientCategory:i.getContentProviderClientCategory(e),providerName:e.providerName,iconUrl:e.iconUrl?jsCommon.Utility.urlCombine(r.clusterUri,e.iconUrl):null,iconCSSClass:e.iconCSSClass,descriptionLocalizationKey:e.grouping.groupingDescription,learnMoreUrl:e.learnMoreUrl,searchKeywords:e.searchKeywords||"",publisher:e.publisher,publishDate:null,emailAddress:null,emailAddressAsLink:null,visible:!1,disableDetailPane:e.disableDetailPane,sortPriority:null!==e.sortPriority&&void 0!==e.sortPriority?e.sortPriority:c.contentProviderStoreTileMaxSortPriority,authentication:null,authenticationInitializationDeferred:null,authenticationInitializationInProgress:!1,finePrint:e.finePrint,autoRedirectUrlParams:null,customConfigurationHandler:null,tileGrouping:{groupingChildItems:[]}}:t},e.prototype.groupContentProviderTileModels=function(e){for(var t,o,i=[],r={},a=[],n=0,s=e;n<s.length;n++){var l=s[n];l.contract.grouping&&l.contract.grouping.groupingName&&0<l.contract.grouping.groupingName.length?(r[t=l.contract.grouping.groupingName]||(o=this.convertContentProviderContractToContentProviderTileModelWithGrouping(l.contract),r[t]=o,a.push(t),i.push(o)),(o=r[t]).searchKeywords=o.searchKeywords.concat(" ",l.searchKeywords||""," ",l.title.toLowerCase()),l.sortPriority=l.contract.grouping.groupingIndex,jQuery.isNumeric(l.sortPriority)||(l.sortPriority=c.contentProviderStoreTileMaxSortPriority),o.tileGrouping.groupingChildItems.push(l)):i.push(l)}return i},e.prototype.convertDashboardShallow=function(e){var t=new o(e);return this.modelMerger.mergeDashboardShallow(t,e),t},e.prototype.convertDashboard=function(e,t,o,i){return this.dataServiceModelConverter.convertDashboard(e,t,o,i)},e.prototype.fillDashboardChildren=function(e,t,o,i){return this.dataServiceModelConverter.fillDashboardChildren(e,t,o,i)},e.prototype.convertTileShallow=function(e,t,o){return this.dataServiceModelConverter.convertTileShallow(e,t,o)},e.prototype.convertSpecificTileShallow=function(e,t){return this.dataServiceModelConverter.convertSpecificTileShallow(e,t)},e.prototype.convertTile=function(e,t,o,i){return this.dataServiceModelConverter.convertTile(e,t,o,i)},e.prototype.convertCompositeTile=function(e){return this.dataServiceModelConverter.convertCompositeTile(e)},e.prototype.convertTileData=function(e){return this.dataServiceModelConverter.convertTileData(e)},e.prototype.convertImageTile=function(e){return this.dataServiceModelConverter.convertImageTile(e)},e.prototype.convertWorkbookTile=function(e,t,o){return this.dataServiceModelConverter.convertWorkbookTile(e,t,o)},e.prototype.convertReportTile=function(e){return this.dataServiceModelConverter.convertReportTile(e)},e.prototype.convertModelTile=function(e){return this.dataServiceModelConverter.convertModelTile(e)},e.prototype.convertIframeTile=function(e){return this.dataServiceModelConverter.convertIframeTile(e)},e.prototype.convertSsrsTile=function(e){return this.dataServiceModelConverter.convertSsrsTile(e)},e.prototype.convertRealTimeTile=function(e){return this.dataServiceModelConverter.convertRealTimeTile(e)},e.prototype.convertTileConfig=function(e){return this.dataServiceModelConverter.convertTileConfig(e)},e.prototype.convertTileAction=function(e){return this.dataServiceModelConverter.convertTileAction(e)},e.prototype.convertUserSettings=function(e){var t=new s.UserSettings(e);return t.allowQnaDataCollection=null==e.allowQnaDataCollection||e.allowQnaDataCollection,t.tileDialogPreviewFormat=e.tileDialogPreviewFormat,t.preferredLanguage=e.preferredLanguage,t.extendedSettings=p.tryParseJSON(e.extendedSettings),t.embedTrialUsage=e.embedTrialUsage,t.visualPaneSettings=p.tryParseJSON(e.visualPaneSettings),t},e.prototype.convertSettingsMetadata=function(e){return{dashboards:this.convertSettingsDashboards(e.dashboards),general:this.convertSettingsGeneral(e.userSettings),datasets:this.convertSettingsDatasets(e.datasetModels||[]),workbooks:this.convertSettingsDatasets(e.workbookModels||[])}},e.prototype.convertSettingsDashboards=function(e){var t=this;return{dashboards:_.map(e,(function(e){return t.convertSettingsDashboard(e)}))}},e.prototype.convertSettingsDashboard=function(e){return{dashboardId:e.id,hasQnaSupportedModel:e.hasQnaSupportedModel,name:e.displayName,objectId:e.objectId,qnaEnabled:e.qnaEnabled,gravityEnabled:e.gravityEnabled,dataClassificationId:e.dataClassificationId,annotationsEnabled:null==e.annotationsEnabled||e.annotationsEnabled}},e.prototype.convertSettingsGeneral=function(e){return{privacy:this.convertSettingsPrivacy(e),language:this.convertSettingsLanguage(e)}},e.prototype.convertSettingsPrivacy=function(e){return{allowQnaDataCollection:null==e.allowQnaDataCollection||e.allowQnaDataCollection}},e.prototype.convertSettingsLanguage=function(e){return{preferredLanguage:e.preferredLanguage}},e.prototype.convertSettingsDatasets=function(e){var t=this;return{datasets:_.map(e,(function(e){return t.convertSettingsDataset(e)}))}},e.prototype.convertSettingsDataset=function(e){return e&&!e.contentProviderId&&e.packageContentProviderId&&(e.contentProviderId=e.packageContentProviderId),i.convertModelToDataset(e,this.localizationService)},e.prototype.getImageUrl=function(e){return this.dataServiceModelConverter.getImageUrl(e)},e.prototype.getSsrsImageUrl=function(e){return this.dataServiceModelConverter.getSsrsImageUrl(e)},e.prototype.convertDashboardInvitation=function(e){var t=this;return null==e||""===e.toString()?[]:e.map((function(e){return t.convertToUserInvitation(e)}))},e.prototype.convertToUserInvitation=function(e){var t=new s.UserInvitationModel;return t.dashboardId=e.dashboardId,t.id=e.id,t.permissions=e.permissions,t.sentToEmailAddress=e.sentToEmailAddress,t},e.prototype.convertDashboardAccessInfoArray=function(e){var t=this;return null==e||_.isEmpty(e.toString())?[]:_.map(e,(function(e){return t.convertDashboardAccessInfo(e)}))},e.prototype.convertDashboardAccessInfo=function(e){var t=new s.DashboardAccessInfoModel(this.localizationService);return t.emailAddress=e.emailAddress,t.id=e.id,t.kind=e.kind,t.permissions=e.permissions,t.givenName=e.givenName,t.familyName=e.familyName,t.fullName=e.givenName,t.aadAppId=e.aadAppId,e.familyName?t.fullName=t.fullName+" "+e.familyName:_.isEmpty(t.fullName)&&(t.fullName=t.emailAddress),t},e.prototype.convertCuratedContent=function(e,t){if(!e)return null;var o=[],i=[],r=[],a=[],n=new s.ActivityPaneCuratedContentModel,e=e.activityPaneData;t||e&&0<e.length&&(t=new s.ComboBoxItem(e[0].packageName,e[0].packageId));e=_.filter(e,(function(e){return e.packageId===t.tag}));return e&&1===e.length&&(e[0].models&&(a=e[0].models),e[0].reports&&(o=e[0].reports),e[0].dashboards&&(i=e[0].dashboards),e[0].tiles&&(r=e[0].tiles),n.packageId=e[0].packageId),n.addModels(a),n.addReports(o),n.addDashboards(i),n.addTiles(r),n},e);function e(e,t,o,i,r,a,n,s){this.downgradedUrlBuilder=t,this.promiseFactory=r,this.dataServiceModelConverter=n,this.localizationService=s}})(h.models||(h.models={}))})(powerbi=powerbi||{}),(function(o){var e,t,i,r,n,s,l;function a(r,e){var t={id:0,name:l.uniqueName(r.visualContainers),config:s.EmptyConfig,layouts:jsCommon.ArrayExtensions.extendWithId([{id:e,position:c()}])},e={visualContainer:i.ViewModelFactory.convertVisualContainerStandalone(t,e),exploration:(function(e){e={width:e.size.width,height:e.size.height,dataSources:o.explore.contracts.createDataSourceArray(),sections:[e],themeCollection:{},settings:{}};return o.explore.viewModels.ViewModelFactory.convertExploration(e,0)})(r)};e.exploration.contract.settings.allowChangeFilterTypes=!0;var a=e.visualContainer;return a.overridePosition=c(),a.allowDeferredRendering=!0,a.hostServices={getFilters:function(){for(var e=[],t=0,o=(a.contract.filters||[]).concat(r.filters||[]);t<o.length;t++){var i=o[t].filter;i&&e.push(i)}return{dataFilter:n.merge(e),dataFiltersUnmerged:e.map((function(e){return{filter:e}})),highlightFilter:null}},getDataSourceVariables:function(){},getVisualRelationshipFilterAction:function(){return 0},selectDataPoint:function(){},setVisualRelationshipFilterAction:_.noop},e}function c(){return{x:0,y:0,width:1024,height:768}}e=o.models||(o.models={}),i=o.explore.viewModels,r=o.dataServices.models.RealTimeModel,n=o.data.SemanticFilter,s=o.explore.contracts.VisualContainer,l=o.explore.util.VisualContainerUtils,(t=e.modelFactory||(e.modelFactory={})).createDashboardMenuItemsAuthoringContext=function(e){var t=[];return t.push({text:e.get("Dashboard_Authoring_Delete_Mobile_Layout"),action:9,type:DropDownMenuItemType.Item}),t},t.createDefaultRealTimeModel=function(){var e=new r(null,{name:"",columns:[],mode:1});return e.isNew=!0,e},(e=e.inFocusViewModelFactory||(e.inFocusViewModelFactory={})).createInFocus=function(e,t,o){return{canvas:a(e,o),taskPane:{isPaneExpanded:!1,isPaneVisible:!0,title:"Data"},visualizationPane:{sections:[],activeSection:i.VisualizationPaneSectionType.Fields,pagePaneSections:[],activePageSection:i.PagePaneSectionType.Fields,isPaneExpanded:!1,isPaneVisible:!0,title:"Format",visualPluginFilter:function(e){return!t.tryGetFilterPropertyIdentifier(e.capabilities)}},showVisualEnabled:!1,inFocusTile:null,displayText:"",subDisplayText:"",source:"",pinVisualText:"",getRelatedInsightsText:"",workbook:null,realTime:null,showInsightsInFocusPane:!1,showPreviousVisualButton:!1}},e.createInFocusMenuItems=function(e,t){var o=[];return o.push({text:e.get("InFocus_GenerateQrCode"),action:0,type:DropDownMenuItemType.Item}),t&&o.push({text:e.get("ExportData_MenuItem"),action:1,type:DropDownMenuItemType.Item}),o},e.createInFocusCanvas=a})(powerbi=powerbi||{}),(function(o){!(function(e){var i=o.common.helpers.ModelConverterHelper,a=o.dataServices.ContractUtils;e.createModelMerger=function(e,t,o){return new r(e,t,o)};var r=(t.prototype.mergeDashboard=function(e,t,o,i,r){this.dataServiceModelMerger.mergeDashboard(e,t,o,i,r)},t.prototype.mergeDashboardShallow=function(e,t){this.dataServiceModelMerger.mergeDashboardShallow(e,t)},t.prototype.mergeArtifactOwnerInfo=function(e,t){this.dataServiceModelMerger.mergeArtifactOwnerInfo(e,t)},t.prototype.mergeDashboardTiles=function(e,t){this.dataServiceModelMerger.mergeDashboardTiles(e,t)},t.prototype.mergeTileShallow=function(e,t,o,i){this.dataServiceModelMerger.mergeTileShallow(e,t,o,i)},t.prototype.mergeTile=function(e,t,o,i,r,a){this.dataServiceModelMerger.mergeTile(e,t,o,i,r,a)},t.prototype.mergeResourceWithIdArrays=function(e,o){for(var i=e.slice(0),t=0,r=e;t<r.length;t++)!(function(t){0<_.filter(o,(function(e){return e.id===t.id})).length&&i.splice(i.indexOf(t),1)})(r[t]);return i.concat(o)},t.prototype.mergeModelContentProviderId=function(e,t){if(e)for(var o=0,i=e;o<i.length;o++){var r=i[o];r.contentProviderId=r.contentProviderId||a.findContentProviderId(t,r.packageId)}},t.prototype.mergeReport=function(e,t){var o=this;e&&t&&(e.contract=t,e.id=t.id||e.id,e.objectId=t.objectId||e.objectId,e.modelId=t.modelId||e.modelId,e.reportUrl=t.reportUrl||e.reportUrl,e.packagePublishStatus=t.packagePublishStatus||e.packagePublishStatus,e.name=t.name||e.name,e.displayName=t.displayName||e.displayName,e.description=t.description||e.description,e.fileName=t.fileName||e.fileName,e.packageId=t.packageId||e.packageId,e.packageVersion=t.packageVersion||e.packageVersion,e.contentProviderId=t.contentProviderId||e.contentProviderId,e.getPermissionsCallback=function(){return o.permissionService.getReportEffectivePermissions(t)},t.ownerInfo&&this.mergeArtifactOwnerInfo(e,t.ownerInfo))},t.prototype.mergeModel=function(e,t){var o=this;e&&t&&(e.contract=t,e.id=t.id||e.id,e.isNew=t.isNew||e.isNew,e.getPermissionsCallback=function(){return o.permissionService.getModelEffectivePermissions(t)},e.name=t.name||e.name,e.displayName=t.displayName||e.displayName,e.description=t.description||e.description,e.fileName=t.fileName||e.fileName,e.packageId=t.packageId||e.packageId,e.packageVersion=t.packageVersion||e.packageVersion,e.contentProviderId=t.contentProviderId||e.contentProviderId,e.qnaSupported=t.qnaSupported,e.packagePublishStatus=(null!=t.packagePublishStatus?t:e).packagePublishStatus,e.isRefreshInProgress=t.currentRefreshStartingTime&&i.convertRefreshTimeToJsDateTime(t.currentRefreshStartingTime).getTime()+18e5>Date.now(),e.cloudRlsEnabled=t.cloudRlsEnabled,e.isHidden=e.isHidden&&t.isHidden)},t.prototype.mergeWorkbook=function(e,t){this.dataServiceModelMerger.mergeWorkbook(e,t)},t);function t(e,t,o){this.permissionService=o,this.dataServiceModelMerger=t}})(o.models||(o.models={}))})(powerbi=powerbi||{}),(function(e){var t;t=e.models||(e.models={}),(e=t.NavigationPaneListItemIcon||(t.NavigationPaneListItemIcon={}))[e.None=0]="None",e[e.Shared=1]="Shared",e[e.ReadOnly=2]="ReadOnly",e[e.Group=3]="Group",e[e.User=4]="User",e[e.Workbook=5]="Workbook",t.NavigationPaneListItemModel=function(){}})(powerbi=powerbi||{}),(function(e){var t;function o(e){this.source=e,this.isNameEditable=!1,this.metadata=[],this.actions=[],this.icon=t.NavigationPaneListItemIcon.Workbook}(t=e.models||(e.models={})).WorkbookNavigationPaneListItemModel=o})(powerbi=powerbi||{}),(function(e){(e.models||(e.models={})).PinTileDialogModel=function(e){this.dashboardTile=e,this.reportTile=e,this.workbookTile=e,this.hasTileFormatting=!0}})(powerbi=powerbi||{}),(function(e){(e.models||(e.models={})).PowerBICompanionModel={enabled:void 0,downloadLink:void 0}})(powerbi=powerbi||{}),(function(e){(e.models||(e.models={})).PowerBIConnectorModel={downloadLink:void 0}})(powerbi=powerbi||{}),(function(e){(e.models||(e.models={})).PublishContentPackViewModel=function(e){e&&(this.isDefaultImageUsed=!e.icon),this.contentPackCreatedFor=!1}})(powerbi=powerbi||{}),(function(e){var t;t=e.models||(e.models={}),(e=t.SettingsGeneralSubgroupType||(t.SettingsGeneralSubgroupType={}))[e.Privacy=0]="Privacy",e[e.CloseAccount=1]="CloseAccount",e[e.Language=2]="Language",e[e.Developer=3]="Developer",e[e.Preview=4]="Preview",e[e.Esri=5]="Esri",e[e.HiddenContent=6]="HiddenContent",t.GeneralSubGroup=function(e,t){this.type=e,this.name=t}})(powerbi=powerbi||{}),(function(e){(e.models||(e.models={})).SettingsGroup=function(e,t){this.type=e,this.name=t}})(powerbi=powerbi||{}),(function(e){!(function(e){var o;(t=e.SharingUserList||(e.SharingUserList={}))[t.Default=0]="Default",t[t.SharedUsers=1]="SharedUsers",t[t.InvitedUsers=2]="InvitedUsers",t[t.RequestingUsers=3]="RequestingUsers",(t=o=e.SharingOptions||(e.SharingOptions={}))[t.ReadOnly=0]="ReadOnly",t[t.ReadReshare=1]="ReadReshare",t[t.StopSharing=2]="StopSharing",t[t.ReadWriteReshare=3]="ReadWriteReshare",t[t.ReadWrite=4]="ReadWrite",(t=e.SharedFromFolderPermissions||(e.SharedFromFolderPermissions={}))[t.Member=0]="Member",t[t.Contributor=1]="Contributor",t[t.Admin=2]="Admin",e.UserInvitationModel=function(){};var t=(Object.defineProperty(i.prototype,"permissionsDisplayText",{get:function(){return 7==(7&this.permissions)?this.localizationService.get("Sharing_Owner"):5==(5&this.permissions)?this.localizationService.get("PermissionCenter_ReadAndReshare"):3==(3&this.permissions)?this.localizationService.get("PermissionCenter_ReadEdit"):1==(1&this.permissions)?this.localizationService.get("PermissionCenter_Read"):void 0},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isExternalUser",{get:function(){return this._isExternalUser},set:function(e){this._isExternalUser=e,this.allowedActions=void 0},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"sharingPermissionsOptions",{get:function(){if(this.allowedActions)return this.allowedActions;var e=[];return void 0===this.sharedFromFolderPermissions&&(4==(4&this.permissions)?e.push(this.getPermissionsOptions(o.ReadOnly)):this.isExternalUser||e.push(this.getPermissionsOptions(o.ReadReshare)),e.push(this.getPermissionsOptions(o.StopSharing))),this.allowedActions=e,this.allowedActions},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"emailAddressAsLink",{get:function(){return"mailto:"+this.emailAddress},enumerable:!1,configurable:!0}),i.prototype.getPermissionsOptions=function(e){var t={text:void 0,action:e,id:this.id,type:DropDownMenuItemType.Item,kind:this.kind};switch(e){case o.ReadOnly:t.text=this.localizationService.get("PermissionCenter_Read");break;case o.ReadReshare:t.text=this.localizationService.get("PermissionCenter_ReadAndReshare");break;case o.StopSharing:t.text=this.localizationService.get("PermissionCenter_RemoveAccess")}return t},i);function i(e){this.localizationService=e}e.DashboardAccessInfoModel=t;Object.defineProperty(r.prototype,"hasValidationError",{get:function(){return!_.isEmpty(this.emailValidationError)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"hasValidationWarning",{get:function(){return!_.isEmpty(this.emailValidationWarning)},enumerable:!1,configurable:!0}),t=r;function r(){this.allowReshare=!0}e.ShareViewModel=t})(e.models||(e.models={}))})(powerbi=powerbi||{}),(function(e){(e.models||(e.models={})).ProviderTileModel=function(e){this.contract=e}})(powerbi=powerbi||{}),(function(e){(e=e.tutorialPopupOffset||(e.tutorialPopupOffset={})).connectData={top:0,left:-25},e.home={top:-15,left:-15},e.findContent={top:0,left:-25},e.dataCapacityLimit={top:-10,left:0},e.dataOnPremises={top:10,left:0},e.createGroup={top:0,left:-25},e.createContentPacks={top:0,left:-25},e.insights={top:-10,left:0},e.groupCapacitySettings={top:-25,left:-5}})(powerbi=powerbi||{}),(function(e){(e.models||(e.models={})).UserSettings=function(e){this.contract=e}})(powerbi=powerbi||{}),(function(e){function t(e){this.contract=e}e=e.models||(e.models={}),Object.defineProperty(t.prototype,"showDiscoverabilityToast",{get:function(){return!t.DiscoverabilityToastDismissed&&this._showDiscoverabilityToast},set:function(e){this._showDiscoverabilityToast=e},enumerable:!1,configurable:!0}),e.WorkbookContainer=t})(powerbi=powerbi||{}),(function(e){var t=(o.prototype.deleteContentPack=function(e,t){t=this.httpService.powerbiRequestOptions(t,"DeleteContentPack");return t.enableTelemetry=!0,this.httpService.delete("/powerbi/content/providers/organization/"+e+"/",t)},o.prototype.unpublishOrganizationalApp=function(e,t){t=this.httpService.powerbiRequestOptions(t,"UnpublishOrganizationalApp");return t.enableTelemetry=!0,this.httpService.delete("/metadata/appmodel/"+e+"/",t)},o.prototype.uninstallContentPack=function(e,t,o){o=this.httpService.powerbiRequestOptions(o,"UninstallContentPack");return o.enableTelemetry=!0,this.httpService.delete("/metadata/appmodel/contentprovider/"+e+"/package/"+t+"/uninstall",o)},o.prototype.publishContentPack=function(e,t,o,i,r,a){i=this.createContentPackRequest(e,t,o,i,r),r=e.isTemplate,a=this.httpService.powerbiRequestOptions(a,r?"PublishTenantContentPack":"PublishContentPack"),r=r?"/powerbi/content/providers/organizationaltemplate/":"/powerbi/content/providers/organization/";return e.providerKey?this.httpService.put(r+e.providerKey+"/",JSON.stringify(i),a):this.httpService.post(r,JSON.stringify(i),a)},o.prototype.createContentPackRequest=function(e,t,o,i,r){var a=e.isTemplate?4:2,a={name:e.titleText,description:e.descriptionText,icon:t,parameterIcon:o,accessPermissions:{listOfGroupsOrPrincipals:e.groupsAddressesList,isSharedToEntireOrganization:e.isSharedWithOrg},dashboardIds:e.selectedDashboardIds,reportIds:e.selectedReportIds,modelIds:e.selectedDatasetIds,workbookIds:e.selectedWorkbookIds,contentProviderCategory:a};return e.emailsList&&e.emailsList.inputUserList&&(a.accessPermissions.adUserMetadataList=e.emailsList.inputUserList),e.providerKey&&(i||(a.skipUpdateIcon=!i,a.icon=""),r||(a.skipUpdateParameterIcon=!r,a.parameterIcon="")),a},o.prototype.setContentPackDirty=function(e,t){t=this.httpService.powerbiRequestOptions(t,"SetContentPackDirty");return t.enableTelemetry=!0,this.httpService.put("/powerbi/content/providers/organization/",JSON.stringify({contentProviderKeys:e}),t)},o.prototype.personalizeContentPack=function(e,t){t=this.httpService.powerbiRequestOptions(t,"Personalize");return this.httpService.put("/powerbi/content/providers/personalize?packageId="+e,null,t)},o);function o(e){this.httpService=e}e.ContentPackHttpService=t})(powerbi=powerbi||{}),(function(v){!(function(e){var s=v.models.FileBrowserEntry,h=v.constants.fileExtensions,g=v.constants.InformationProtectionErrorDictionary;e.createSharePointHttpService=function(e,t,o,i,r,a,n){return new l(e,t,o,i,r,a,n)};var l=(t.prototype.configureSharePointFile=function(e,t,o,i,r,n){var a,s,l=this,c=this.promiseFactory.defer(),d=JSON.parse(e.id),p=this.telemetryService.startChildEvent(i,v.telemetry.ProvidersSharePointWorkbookUploadRequest,{fileSize:e.size,DSID:""}),i=this.httpService.powerbiRequestOptions(p.event,"SharePointConfigureSelectedFile"),u=e.fileExtension.toLocaleLowerCase();return u===h.xlsxFileExtension||u===h.xlsxmFileExtension?(a=v.constants.providerBaseEndpointPaths.Excel+"configureWithUrl?providerUrl="+encodeURIComponent(o.personalUrl)+"&listId="+d.ListId+"&documentId="+d.DocumentId+"&storageProvider=3",s=v.constants.contentProviderIds.Excel):u===h.pbiFileExtension?(a=v.constants.providerBaseEndpointPaths.PBIX+"configureWithUrl?providerUrl="+encodeURIComponent(o.personalUrl)+"&listId="+d.ListId+"&documentId="+d.DocumentId+"&storageProvider=3",s=v.constants.contentProviderIds.PBIX):u===h.csvFileExtension&&(a=v.constants.providerBaseEndpointPaths.Csv+"configureWithUrl?providerUrl="+encodeURIComponent(o.personalUrl)+"&listId="+d.ListId+"&documentId="+d.DocumentId+"&storageProvider=3",s=v.constants.contentProviderIds.Csv),r&&(a+="&folderObjectId="+r),o.resourceId&&(a+="&resourceId="+encodeURIComponent(o.resourceId)),a+="&scenario="+(t===v.models.UploadFormat.ViewExcel?"View":"Import"),this.httpService.post(a,null,i).then((function(e){e=JSON.parse(e.data);e.ContentProviderIdOverride=s,e.isImportOperation=t===v.models.UploadFormat.ImportData,!n&&l.$window.parent&&l.$window.parent.postMessage(JSON.stringify({dataAccessInfo:e,parentEventId:p.event.id}),v.common.constants.hostOrigin),c.resolve(e),p.event.info.DSID=e.DSID,p.resolve()}),(function(e){var t,o,i,r,a;!n&&l.$window.parent&&(t=e.headers(v.common.PowerBIErrorHeader),a=g[t],t&&v.errors.excelViewWorkbookErrorMessageIds[t]?(r=v.errors.excelViewWorkbookErrorMessageIds[t],i=v.errors.excelViewWorkbookErrorTitleIds[t],l.errorService.infoCustom(l.localizationService.get(i||"UploadExcel_ConfigureFileFailed"),l.localizationService.get(r))):u===h.pbiFileExtension&&a?(o=l.localizationService.get("UploadLocalFile_InformationProtectionError_Title"),i={label:l.localizationService.get("LearnMore"),url:"https://go.microsoft.com/fwlink/?linkid=2146450"},r=l.localizationService.get(a.errorMessage),a=a.buttonText?l.localizationService.get(a.buttonText):void 0,l.errorService.control().showMessage(o,r,a,i)):l.$window.parent.postMessage(JSON.stringify({ErrorCode:t,ErrorMessage:l.localizationService.get("UploadExcel_ConfigureFileFailed"),ErrorType:"UploadExcel_ConfigureFileFailed",RequestId:e.requestId,StatusCode:e.status.toString()}),v.common.constants.hostOrigin)),c.reject(),p.reject()})),c.promise},t.prototype.configureSharePointFileInfo=function(e,t,o,i,r,a,n){t=JSON.stringify({ListId:e,DocumentId:t});return this.configureSharePointFile(new s(t,o,null,null,0,null),v.models.UploadFormat.ImportData,{personalUrl:i,resourceId:r},a,n,!0)},t.prototype.getFilesAndFolders=function(e,t,o){o=this.httpService.powerbiRequestOptions(o,"SharePointGetFilesAndFolders"),t=v.constants.providerBaseEndpointPaths.Excel+"/getFilesAndFolders?providerUrl="+encodeURIComponent(e.personalUrl)+"&folderRelativeUrl="+encodeURIComponent(t)+(jsCommon.QueryStringUtil.getQueryStringValue(v.common.constants.contentProviderStoreRenderAsFullScreenMode)?"&fileExtensions="+h.xlsxFileExtension+";"+h.xlsxmFileExtension+";"+(this.featureSwitchService.featureSwitches.csvContentProviderEnabled?h.csvFileExtension+";":"")+h.pbiFileExtension:"");return e.resourceId&&(t+="&resourceId="+encodeURIComponent(e.resourceId)),this.httpService.get(t,o)},t.prototype.getDocumentLibraries=function(e,t){var o=this.httpService.powerbiRequestOptions(e,"GetSharepointDocumentLibraries"),e=v.constants.providerBaseEndpointPaths.Excel+"allDocumentLibraries";return this.httpService.get(e=t?e+"?siteUrl="+t:e,o),this.httpService.get(e,o)},t);function t(e,t,o,i,r,a,n){this.$window=e,this.featureSwitchService=t,this.telemetryService=o,this.localizationService=i,this.errorService=r,this.promiseFactory=a,this.httpService=n}})(v.proxies||(v.proxies={}))})(powerbi=powerbi||{}),(function(r){!(function(e){var i=r.errorDetailsHelper;e.createResourcePackageHttpService=function(e,t){return new o(e,t)};var o=(t.prototype.getResourcePackageItem=function(e,t,o){try{var i=this.httpService.powerbiRequestOptions(o,"GetResourcePackageItem"),r="metadata/ResourcePackages/"+t+"/"+e.path,a=this.httpService.get(r,i).then((function(e){return e.data}));return this.promiseFactory.all([a])}catch(e){return this.handleError(e)}},t.prototype.copyResourcePackage=function(e,t,o){},t.prototype.handleError=function(e){var t=this.promiseFactory.defer(),o=i.getErrorCode(e);return t.reject({status:e.status,requestId:e.requestId,activityId:e.activityId,errorCode:o,error:e.error}),t.promise},t);function t(e,t){this.httpService=e,this.promiseFactory=t}})(r.proxies||(r.proxies={}))})(powerbi=powerbi||{}),(function(T){var C=T.dialogbuilders.MakeACopyDialogBuilder,k=T.common.dialog.MessageDialogBuilder;T.createContentPackService=function(e,t,o,i,r,a,n,s,l,c,d,p,u,h,g,v,m,b,f,y,S,w,D,T,C,k){return new P(t,e,o,i,r,a,n,s,c,d,u,h,g,v,m,b,y,S,w,D,T,k)};var P=(e.prototype.isApp=function(e){e=e.category;return 5===e||7===e},e.prototype.displayLicenseErrorDialog=function(e){this.licenseHelperService.displayFeatureDisabledErrorMessage(e?"ConnectApps":"ConnectContentPacks",this.localizationService.get(e?"UpgradeReasonText_Apps":"UpgradeReasonText_ContentPacks"))},e.prototype.showDialogOnModelDeleteInContentPack=function(t){this.currentGroupCPs;var e=_.find(this.currentGroupCPs.contentPacks,(function(e){return _.includes(e.modelIds,t)}));e&&this.showDialogArtifactInContentPackInternal(e,"Model_DeleteConfirmationTitle","Model_DeleteCheckMessageApps","Model_DeleteCheckMessage","ModelDeleteInOrgProvider")},e.prototype.showDialogOnWorkbookRemoveInContentPack=function(t){this.currentGroupCPs;var e=_.find(this.currentGroupCPs.contentPacks,(function(e){return _.includes(e.workbookIds,t)}));e&&this.showDialogArtifactInContentPackInternal(e,"Workbook_RemoveConfirmationTitle","Workbook_RemoveCheckMessageApps","Workbook_RemoveCheckMessage","WorkbookDeleteInOrgProvider")},e.prototype.showDialogOnRdlReportReplaceInContentPack=function(e){e=this.findPublishedAppContainingReport(e);e&&this.showDialogArtifactInContentPackInternal(e,"RdlReport_ReplaceConfirmationTitle","RdlReport_ReplaceCheckMessageApps","RdlReport_ReplaceCheckMessage","RdlReportReplaceInOrgProvider")},e.prototype.findPublishedAppContainingReport=function(t){if(this.currentGroupCPs)return _.find(this.currentGroupCPs.contentPacks,(function(e){return _.includes(e.reportIds,t)}))},e.prototype.onPersonalizeContentPack=function(r){return __awaiter(this,void 0,T.Promise,(function(){var t,o,i;return __generator(this,(function(e){switch(e.label){case 0:return this.appService.getAppInstance(r)?[2]:this.licenseEnforcementService.supportsAppsAuthoring()?this.quota.checkQuotaExceeded("PersonalizeContentPack")?[2]:[4,this.showMakeACopyDialog(r)]:(this.displayLicenseErrorDialog(!1),[2]);case 1:return 0!==e.sent()?[2]:[4,this.lazyProviderModern.get("@powerbi/UILibrary/progress-dialog/progress-dialog-builder.module","progressDialogBuilder")];case 2:return t=e.sent(),o=t.show("MakeACopy_ProgressDialogTitle","MakeACopy_ProgressDialogDescription",!1),i=this.telemetryService.startEvent(T.telemetry.DashboardContentPackPersonalize),this.contentPackStore.personalize(r,i),i.promise.finally((function(){return t.hide(o)})),[2]}}))}))},e.prototype.showDialogArtifactInContentPack=function(e,t,o,i,r){var a=this,n=this.localizationService,o=e?o:i,i=e?"PBI_Button_Label_OK":"Publish_ViewContentPacks";e?this.messageDialogBuilder.show(r,{messageText:o,titleText:t,okButtonText:i,cancelButtonText:e?void 0:"PBI_Button_Label_Cancel"}):(o=n.get(o),t=n.get(t),i=n.get(i),this.modernDialogService.promptSimpleConfirmationDialog(t,o,i,(function(){a.navigation.showViewContentPackSlider()})))},e.prototype.showDialogArtifactInContentPackInternal=function(e,t,o,i,r){e=this.isApp(e);return this.showDialogArtifactInContentPack(e,t,o,i,r)},e.prototype.showMakeACopyDialog=function(e){var t=this.dashboardDataService.findDashboardsByPackageId(e),o=this.modelService.findModelsByPackageId(e),i=this.reportService.findReportsByPackageId(e);this.appService.getAppInstance(e);return this.makeACopyDialogBuilder.show("PersonalizeContentPack","PublishContentPack_PersonalizeTitle","PublishContentPack_PersonalizeDescription","PersonalizeOrgApp_PersonalizeDescriptionItemIntro",t,i,o)},e.prototype.resetContentPackUsageFlags=function(){var e=this.dashboardDataService.dashboards;if(e)for(var t=0,o=e;t<o.length;t++){var i=o[t];i&&(i.isUsedByContentPack=!1)}e=this.reportService.reports;if(e)for(var r=0,a=e;r<a.length;r++){var n=a[r];n&&(n.isUsedByContentPack=!1)}e=this.modelService.models;if(e)for(var s=0,l=e;s<l.length;s++){var c=l[s];c&&(c.isUsedByContentPack=!1)}e=this.workbookService.workbooks;if(e)for(var d=0,p=e;d<p.length;d++){var u=p[d];u&&(u.isUsedByContentPack=!1)}},e.prototype.uninstallContentPack=function(e,t){var o=this,i=this.telemetryService.startEvent(T.telemetry.ContentPackUninstall,{contentProviderId:e});return this.contentPackHttpService.uninstallContentPack(e,t,i.event).then((function(e){i.resolve()}),(function(e){e?i.reject(T.errorDetailsHelper.getTelemetryErrorDetails(e.error,e.status)):i.reject(),o.errorService.error(o.localizationService.get("ContentPack_Uninstall_FailedMessage"),"",{requestId:e.requestId,statusCode:e.status.toString(),activityId:e.activityId})}))},e.prototype.removeContentPacks=function(e){for(var o=this,t=0,i=e;t<i.length;t++){var r=(function(t){if(!o.currentGroupCPs)return{value:void 0};var e=_.find(o.currentGroupCPs.contentPacks,(function(e){return e.providerContract.providerId===t}));o.contentPackStore.remove(e.providerContract.providerKey)})(i[t]);if("object"==typeof r)return r.value}},e.prototype.onFolderChanged=function(){this.currentGroupCPs=null,this.loadContentPacks()},e.prototype.loadContentPacks=function(){var e=this.folderService.activeFolder&&this.folderService.activeFolder.uniqueId;if(!e)return this.promiseFactory.reject();var t=this.requests[e];return t?t.promise:(this.contentPackStore.loadContentPackForSelectedGroup(),this.requests[e]=this.promiseFactory.defer(),this.requests[e].promise)},e.prototype.markItemsUsedByContentPack=function(){var t=this;if(this.resetContentPackUsageFlags(),this.currentGroupCPs&&!_.isEmpty(this.currentGroupCPs.contentPacks))for(var e=0,o=this.currentGroupCPs.contentPacks;e<o.length;e++){var i=o[e];i.dashboardIds.forEach((function(e){e=t.dashboardDataService.findDashboard(e);e&&(e.isUsedByContentPack=!0)})),i.reportIds.forEach((function(e){e=t.reportService.findReport(e);e&&(e.isUsedByContentPack=!0)})),i.modelIds.forEach((function(e){e=t.modelService.findModel(e);e&&(e.isUsedByContentPack=!0)})),i.workbookIds.forEach((function(e){e=t.workbookService.findWorkbook(e);e&&(e.isUsedByContentPack=!0)}))}},e.prototype.publishContentPack=function(e,t,o,i,r,a){return this.contentPackHttpService.publishContentPack(e,t,o,i,r,a)},e);function e(e,t,o,i,r,a,n,s,l,c,d,p,u,h,g,v,m,b,f,y,S,w){var D=this;this.appService=e,this.rootScope=t,this.errorService=o,this.telemetryService=i,this.modelConverter=r,this.localizationService=a,this.navigation=n,this.dashboardDataService=s,this.reportService=l,this.modelService=c,this.workbookService=d,this.promiseFactory=p,this.quota=u,this.folderService=g,this.licenseEnforcementService=v,this.contentPackStore=m,this.contentPackHttpService=b,this.globalEventBridge=f,this.licenseHelperService=y,this.modernDialogService=S,this.lazyProviderModern=w,this.requests={},this.makeACopyDialogBuilder=new C(h),this.messageDialogBuilder=new k(h),this.contentPackStore.groupContentProviders.subscribe((function(e){var t;D.currentGroupCPs={groupGUID:e.groupGUID,contentPacks:_.map(e.contentProviders,(function(e){return D.modelConverter.convertContentPack(e)}))},e.groupGUID&&((t=D.requests[e.groupGUID])&&(t.resolve(D.currentGroupCPs.contentPacks),delete D.requests[e.groupGUID]),D.markItemsUsedByContentPack())})),this.rootScope.$on(T.constants.contentPackDirtyShowNotification,(function(e,t,o){D.contentPackStore.setDirtyContentPacks(t,o)})),this.globalEventBridge.createChannelSubscriptionManager().subscribe(T.services.events.personalizeArtifact,(function(e,t){D.onPersonalizeContentPack(t)}))}})(powerbi=powerbi||{}),(function(c){var r=c.common.GridLayoutConstants,d=c.visuals.PivotTableOptions,n=c.visualHost.utils.ResourcePackageUtils,p=c.visuals.TableExOptions,s=c.visualHost.visualPluginServiceHelpers.VisualPluginStorage,a=42,l=10,u=10,h=0,g=8,v=c.visuals.createPivotTable,m=c.visuals.createTableEx,b=c.visuals.createMatrix,f=c.visuals.createTable,y=c.visuals.createActionButton,S=c.visuals.createCard,w=c.visuals.createGauge,D=c.visuals.createDonutChart,T=c.visuals.createFunnelChart,C=c.visuals.createMap,k=c.visuals.createAzureMap,P=c.visuals.createShapeMap,E=c.visuals.createTreemap,I=c.visuals.createTextbox,M=c.visuals.createTextboxViewModelAdapter,A=c.visuals.createDecompositionTree,R=c.visuals.createCartesianChart,N=c.visuals.createRealTimeLineChartAnimator,F=c.visuals.createDashboardColumnChartAnimator;c.createDashboardVisualPluginService=function(e,t,o,i,r,a){return new x(e,t,o,i,r,a)};var x=(e.prototype.ensureBuiltInPlugins=function(){return this.initBuiltInPlugins},e.prototype.getVisuals=function(){return this.storage.getLoadedPlugins()},e.prototype.ensureTrustedVisualPlugins=function(e){s.ensureTrustedVisualPlugins(this.storage,e)},e.prototype.ensurePlugins=function(e,t){this.promiseFactory;var o=[];if(e&&e.length)for(var i=0,r=e;i<r.length;i++){var a=r[i];n.isCustomVisualResourcePackage(a)&&o.push(this.ensurePlugin(a,!1))}return this.promiseFactory.allSettled(o)},e.prototype.ensurePlugin=function(t,e){var o=this;return this.asyncFeatureSwitchService.getFeatureSwitches().then((function(e){return e.consumePublicCvsWithoutRps?o.publicCustomVisualService.getPublicVisualTypes([t.name]).then((function(e){return t.name!==e[0]||t.isPublic?s.ensurePlugin(o.storage,o.promiseFactory,o.resourceLoader,t,!1,o.telemetryService):o.promiseFactory.resolve()})):s.ensurePlugin(o.storage,o.promiseFactory,o.resourceLoader,t,!1,o.telemetryService)}))},e.prototype.getPlugin=function(e){var t=this.storage.getLoadedPlugin(e);return!t&&c.visuals.plugins[e]&&(this.storage.loadPlugin(e,B(e,this.options,this.properties,this.asyncFeatureSwitchService.featureSwitches)),t=this.storage.getLoadedPlugin(e)),t},e.prototype.capabilities=function(e){e=this.getPlugin(e);return e?e.capabilities:void 0},e.prototype.isCustomVisual=function(e){return c.visualHost.utils.isCustomVisual(this.getPlugin(e),e)},e.prototype.getInteractivityOptions=function(){return{overflow:"hidden",isVisualInteractive:!1}},e.prototype.getTelemetryHostInformation=function(){return{name:"Dashboard"}},e.prototype.isScriptVisual=function(e){return c.visualHost.utils.isScriptVisual(this.getPlugin(e))},e.prototype.isScriptVisualQueryable=function(e){return c.visualHost.utils.isScriptVisualQueryable(e,this.asyncFeatureSwitchService.featureSwitches)},e.prototype.isLightWeightRenderingVisual=function(e){return c.visualHost.utils.isLightWeightRenderingVisual(this.getPlugin(e))},e.prototype.getStorage=function(){return this.storage},e);function e(e,t,o,i,r,a){var n=this;this.asyncFeatureSwitchService=e,this.promiseFactory=t,this.resourceLoader=o,this.telemetryService=i,this.options=r,this.publicCustomVisualService=a,this.storage=new s;i=L(!0,2,!1),r=L(!0,4,!0),a=L(!1,3,!0);this.properties={cardSmallViewportProperties:{cardSmallViewportWidth:i},textboxSmallViewportProperties:{minWidthToScaleFontSize:r,minHeightToScaleFontSize:a}},this.initBuiltInPlugins=this.asyncFeatureSwitchService.getFeatureSwitches().then((function(e){for(var t in c.visuals.plugins)n.storage.loadPlugin(t,B(t,n.options,n.properties,e))}))}function L(e,t,o){var i=0;return(e?r.dynamicGridWidth:r.dynamicGridHeight)*t+2*r.dynamicGridItemSpacing*(t-1)-(i=o?e?l+u:h+g:i)-(e?0:a)}function B(e,t,i,r){var o=this,a=t.tooltipsEnabled;r=r?_.clone(r):{};var n=c.visuals.plugins;switch(e){case c.visuals.plugins.barChart.name:return c.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(c.visuals.plugins.barChart,(function(e){e=e.module;return e.createCartesianChart({chartType:6,tooltipsEnabled:a,animator:e.createDashboardColumnChartAnimator(),animateCategoryAxis:!0,animateValueAxis:!0,featureSwitches:r})}),r,R?function(){return __awaiter(o,void 0,void 0,(function(){var t,o;return __generator(this,(function(e){switch(e.label){case 0:return t=R,o={chartType:6,tooltipsEnabled:a},[4,F()];case 1:return[2,t.apply(void 0,[(o.animator=e.sent(),o.animateCategoryAxis=!0,o.animateValueAxis=!0,o.featureSwitches=r,o)])]}}))}))}:void 0);case c.visuals.plugins.clusteredBarChart.name:return c.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(c.visuals.plugins.clusteredBarChart,(function(e){e=e.module;return e.createCartesianChart({chartType:5,tooltipsEnabled:a,animator:e.createDashboardColumnChartAnimator(),animateCategoryAxis:!0,animateValueAxis:!0,featureSwitches:r})}),r,R?function(){return __awaiter(o,void 0,void 0,(function(){var t,o;return __generator(this,(function(e){switch(e.label){case 0:return t=R,o={chartType:5,tooltipsEnabled:a},[4,F()];case 1:return[2,t.apply(void 0,[(o.animator=e.sent(),o.animateCategoryAxis=!0,o.animateValueAxis=!0,o.featureSwitches=r,o)])]}}))}))}:void 0);case c.visuals.plugins.clusteredColumnChart.name:return c.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(c.visuals.plugins.clusteredColumnChart,(function(e){e=e.module;return e.createCartesianChart({chartType:3,tooltipsEnabled:a,animator:e.createDashboardColumnChartAnimator(),animateCategoryAxis:!0,animateValueAxis:!0,featureSwitches:r})}),r,R?function(){return __awaiter(o,void 0,void 0,(function(){var t,o;return __generator(this,(function(e){switch(e.label){case 0:return t=R,o={chartType:3,tooltipsEnabled:a},[4,F()];case 1:return[2,t.apply(void 0,[(o.animator=e.sent(),o.animateCategoryAxis=!0,o.animateValueAxis=!0,o.featureSwitches=r,o)])]}}))}))}:void 0);case c.visuals.plugins.columnChart.name:return c.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(c.visuals.plugins.columnChart,(function(e){e=e.module;return e.createCartesianChart({chartType:4,tooltipsEnabled:a,animator:e.createDashboardColumnChartAnimator(),animateCategoryAxis:!0,animateValueAxis:!0,featureSwitches:r})}),r,R?function(){return __awaiter(o,void 0,void 0,(function(){var t,o;return __generator(this,(function(e){switch(e.label){case 0:return t=R,o={chartType:4,tooltipsEnabled:a},[4,F()];case 1:return[2,t.apply(void 0,[(o.animator=e.sent(),o.animateCategoryAxis=!0,o.animateValueAxis=!0,o.featureSwitches=r,o)])]}}))}))}:void 0);case c.visuals.plugins.dataDotClusteredColumnComboChart.name:return c.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(c.visuals.plugins.dataDotClusteredColumnComboChart,(function(e){return e.module.createCartesianChart({chartType:16,tooltipsEnabled:a,animateCategoryAxis:!0,animateValueAxis:!0,featureSwitches:r})}),r,R?function(){return R({chartType:16,tooltipsEnabled:a,animateCategoryAxis:!0,animateValueAxis:!0,featureSwitches:r})}:void 0);case c.visuals.plugins.dataDotStackedColumnComboChart.name:return c.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(c.visuals.plugins.dataDotStackedColumnComboChart,(function(e){return e.module.createCartesianChart({chartType:17,tooltipsEnabled:a,animateCategoryAxis:!0,animateValueAxis:!0,featureSwitches:r})}),r,R?function(){return R({chartType:17,tooltipsEnabled:a,animateCategoryAxis:!0,animateValueAxis:!0,featureSwitches:r})}:void 0);case c.visuals.plugins.donutChart.name:return c.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(c.visuals.plugins.donutChart,(function(){return new c.visuals.DonutChart({tooltipsEnabled:a})}),r,D?function(){return D({tooltipsEnabled:a})}:void 0);case c.visuals.plugins.funnel.name:return c.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(c.visuals.plugins.funnel,(function(){return new c.visuals.FunnelChart({tooltipsEnabled:a})}),r,T?function(){return T({tooltipsEnabled:a})}:void 0);case c.visuals.plugins.gauge.name:return c.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(c.visuals.plugins.gauge,(function(e){return e.module.createGauge({animator:new c.visuals.BaseAnimator,tooltipsEnabled:a},r)}),r,w?function(){return w({animator:new c.visuals.BaseAnimator,tooltipsEnabled:a})}:void 0);case c.visuals.plugins.hundredPercentStackedBarChart.name:return c.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(c.visuals.plugins.hundredPercentStackedBarChart,(function(e){return e.module.createCartesianChart({chartType:7,tooltipsEnabled:a,animateCategoryAxis:!0,animateValueAxis:!0,featureSwitches:r})}),r,R?function(){return R({chartType:7,tooltipsEnabled:a,animateCategoryAxis:!0,animateValueAxis:!0,featureSwitches:r})}:void 0);case c.visuals.plugins.hundredPercentStackedColumnChart.name:return c.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(c.visuals.plugins.hundredPercentStackedColumnChart,(function(e){return e.module.createCartesianChart({chartType:8,tooltipsEnabled:a,animateCategoryAxis:!0,animateValueAxis:!0,featureSwitches:r})}),r,R?function(){return R({chartType:8,tooltipsEnabled:a,animateCategoryAxis:!0,animateValueAxis:!0,featureSwitches:r})}:void 0);case c.visuals.plugins.lineChart.name:return c.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(c.visuals.plugins.lineChart,(function(e){return e.module.createCartesianChart({chartType:0,tooltipsEnabled:a,animateCategoryAxis:!0,animateValueAxis:!0,featureSwitches:r})}),r,R?function(){return R({chartType:0,tooltipsEnabled:a,animateCategoryAxis:!0,animateValueAxis:!0,featureSwitches:r})}:void 0);case c.visuals.plugins.areaChart.name:return c.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(c.visuals.plugins.areaChart,(function(e){return e.module.createCartesianChart({chartType:1,tooltipsEnabled:a,animateCategoryAxis:!0,animateValueAxis:!0,featureSwitches:r})}),r,R?function(){return R({chartType:1,tooltipsEnabled:a,animateCategoryAxis:!0,animateValueAxis:!0,featureSwitches:r})}:void 0);case c.visuals.plugins.stackedAreaChart.name:return c.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(c.visuals.plugins.stackedAreaChart,(function(e){return e.module.createCartesianChart({chartType:2,tooltipsEnabled:a,animateCategoryAxis:!0,animateValueAxis:!0,featureSwitches:r})}),r,R?function(){return R({chartType:2,tooltipsEnabled:a,animateCategoryAxis:!0,animateValueAxis:!0,featureSwitches:r})}:void 0);case c.visuals.plugins.lineClusteredColumnComboChart.name:return c.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(c.visuals.plugins.lineClusteredColumnComboChart,(function(e){return e.module.createCartesianChart({chartType:14,tooltipsEnabled:a,animateCategoryAxis:!0,animateValueAxis:!0,featureSwitches:r})}),r,R?function(){return R({chartType:14,tooltipsEnabled:a,animateCategoryAxis:!0,animateValueAxis:!0,featureSwitches:r})}:void 0);case c.visuals.plugins.lineStackedColumnComboChart.name:return c.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(c.visuals.plugins.lineStackedColumnComboChart,(function(e){return e.module.createCartesianChart({chartType:15,tooltipsEnabled:a,animateCategoryAxis:!0,animateValueAxis:!0,featureSwitches:r})}),r,R?function(){return R({chartType:15,tooltipsEnabled:a,animateCategoryAxis:!0,animateValueAxis:!0,featureSwitches:r})}:void 0);case c.visuals.plugins.pieChart.name:return c.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(c.visuals.plugins.pieChart,(function(){return new c.visuals.DonutChart({sliceWidthRatio:0,tooltipsEnabled:a})}),r,D?function(){return D({sliceWidthRatio:0,tooltipsEnabled:a})}:void 0);case c.visuals.plugins.ribbonChart.name:return c.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(c.visuals.plugins.ribbonChart,(function(e){e=e.module;return e.createCartesianChart({chartType:9,tooltipsEnabled:a,animator:e.createDashboardColumnChartAnimator(),animateCategoryAxis:!0,animateValueAxis:!0,featureSwitches:r})}),r,R?function(){return __awaiter(o,void 0,void 0,(function(){var t,o;return __generator(this,(function(e){switch(e.label){case 0:return t=R,o={chartType:9,tooltipsEnabled:a},[4,F()];case 1:return[2,t.apply(void 0,[(o.animator=e.sent(),o.animateCategoryAxis=!0,o.animateValueAxis=!0,o.featureSwitches=r,o)])]}}))}))}:void 0);case c.visuals.plugins.scatterChart.name:return c.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(c.visuals.plugins.scatterChart,(function(e){return e.module.createCartesianChart({chartType:10,tooltipsEnabled:a,animateCategoryAxis:!0,animateValueAxis:!0,featureSwitches:r})}),r,R?function(){return __awaiter(o,void 0,void 0,(function(){return __generator(this,(function(e){return[2,R({chartType:10,tooltipsEnabled:a,animateCategoryAxis:!0,animateValueAxis:!0,featureSwitches:r})]}))}))}:void 0);case c.visuals.plugins.treemap.name:return c.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(c.visuals.plugins.treemap,(function(e){return new e.module.Treemap({isScrollable:!1,tooltipsEnabled:a})}),r,E?function(){return E({isScrollable:!1,tooltipsEnabled:a})}:void 0);case c.visuals.plugins.waterfallChart.name:return c.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(c.visuals.plugins.waterfallChart,(function(e){return e.module.createCartesianChart({chartType:13,tooltipsEnabled:a,animateCategoryAxis:!0,animateValueAxis:!0,featureSwitches:r})}),r,R?function(){return R({chartType:13,tooltipsEnabled:a,animateCategoryAxis:!0,animateValueAxis:!0,featureSwitches:r})}:void 0);case c.visuals.plugins.map.name:return c.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(c.visuals.plugins.map,(function(){return new c.visuals.Map({tooltipsEnabled:a,disableZooming:!0,disablePanning:!0})}),r,C?function(){return C({tooltipsEnabled:a,disableZooming:!0,disablePanning:!0})}:void 0);case c.visuals.plugins.filledMap.name:return c.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(c.visuals.plugins.filledMap,(function(){return new c.visuals.Map({filledMap:!0,tooltipsEnabled:a,disableZooming:!0,disablePanning:!0})}),r,C?function(){return C({filledMap:!0,tooltipsEnabled:a,disableZooming:!0,disablePanning:!0})}:void 0);case c.visuals.plugins.azureMap.name:return c.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(c.visuals.plugins.azureMap,(function(e){return e.module.createAzureMap({tooltipsEnabled:a,disableZooming:!0,disablePanning:!0})}),r,k?function(){return k({tooltipsEnabled:a,disableZooming:!0,disablePanning:!0})}:void 0);case c.visuals.plugins.actionButton.name:return c.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(c.visuals.plugins.actionButton,(function(e){return new e.module.ActionButton}),r,y?function(){return y()}:void 0);case c.visuals.plugins.shapeMap.name:return c.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(c.visuals.plugins.shapeMap,(function(e){return new e.module.ShapeMap({tooltipsEnabled:a})}),r,P?function(){return P({tooltipsEnabled:a})}:void 0);case c.visuals.plugins.matrix.name:return c.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(c.visuals.plugins.matrix,(function(){return new c.visuals.Matrix}),r,b?function(){return b()}:void 0);case c.visuals.plugins.tableEx.name:var s=p.createDashboardConstructorOptions();return c.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(c.visuals.plugins.tableEx,(function(){return new c.visuals.TableEx(s,r)}),r,m?function(){return m(s,r)}:void 0);case c.visuals.plugins.pivotTable.name:var l=d.createDashboardConstructorOptions();return c.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(c.visuals.plugins.pivotTable,(function(){return new c.visuals.PivotTable(l,r)}),r,v?function(){return v(l,r)}:void 0);case c.visuals.plugins.realTimeLineChart.name:return c.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(c.visuals.plugins.realTimeLineChart,(function(e){e=e.module;return e.createCartesianChart({chartType:18,animator:e.createRealTimeLineChartAnimator(),animateCategoryAxis:!0,animateValueAxis:!0,featureSwitches:r})}),r,R?function(){return __awaiter(o,void 0,void 0,(function(){var t,o;return __generator(this,(function(e){switch(e.label){case 0:return t=R,o={chartType:18},[4,N()];case 1:return[2,t.apply(void 0,[(o.animator=e.sent(),o.animateCategoryAxis=!0,o.animateValueAxis=!0,o.featureSwitches=r,o)])]}}))}))}:void 0);case c.visuals.plugins.table.name:return c.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(c.visuals.plugins.table,(function(){return new c.visuals.Table}),r,f?function(){return f()}:void 0);case c.visuals.plugins.card.name:return c.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(c.visuals.plugins.card,(function(e){return e.module.createCard({cardSmallViewportProperties:i.cardSmallViewportProperties,tooltipsEnabled:a,featureSwitches:r})}),r,S?function(){return S({cardSmallViewportProperties:i.cardSmallViewportProperties,tooltipsEnabled:a,featureSwitches:r})}:void 0);case c.visuals.plugins.textbox.name:return c.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(c.visuals.plugins.textbox,(function(e){e=e.module;return e.createTextbox({viewModelAdapter:e.createTextboxViewModelAdapter(i.textboxSmallViewportProperties),disableScrollingInViewMode:!0,supportsNarrativeExpressions:r.daxTransformEnabled})}),r,I?function(){return __awaiter(o,void 0,void 0,(function(){var t,o;return __generator(this,(function(e){switch(e.label){case 0:return t=I,o={},[4,M(i.textboxSmallViewportProperties)];case 1:return[2,t.apply(void 0,[(o.viewModelAdapter=e.sent(),o.disableScrollingInViewMode=!0,o.supportsNarrativeExpressions=r.daxTransformEnabled,o)])]}}))}))}:void 0);case c.visualHost.EsriVisual:return n[c.visualHost.EsriVisual]?c.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(n[c.visualHost.EsriVisual],n[c.visualHost.EsriVisual].create,r,n[c.visualHost.EsriVisual].createES6):null;case c.visuals.plugins.keyDriversVisual.name:return c.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(c.visuals.plugins.keyDriversVisual,(function(e){return e.module.createAnalysisVisual()}),r,void 0);case c.visuals.plugins.qnaVisual.name:return c.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(c.visuals.plugins.qnaVisual,(function(e){return e.module.createQnaVisual()}),r,void 0);case c.visuals.plugins.histogram.name:return c.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(c.visuals.plugins.histogram,(function(e){e=e.module;return e.createCartesianChart({chartType:19,tooltipsEnabled:a,animator:e.createDashboardColumnChartAnimator(),animateCategoryAxis:!0,animateValueAxis:!0,featureSwitches:r})}),r,R?function(){return __awaiter(o,void 0,void 0,(function(){var t,o;return __generator(this,(function(e){switch(e.label){case 0:return t=R,o={chartType:19,tooltipsEnabled:a},[4,F()];case 1:return[2,t.apply(void 0,[(o.animator=e.sent(),o.animateCategoryAxis=!0,o.animateValueAxis=!0,o.featureSwitches=r,o)])]}}))}))}:void 0);case c.visuals.plugins.decompositionTreeVisual.name:return c.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(c.visuals.plugins.decompositionTreeVisual,(function(e){return new e.module.DecompositionTree}),r,A?function(){return A()}:void 0);default:return c.Prototype.inherit(n[e])}}})(powerbi=powerbi||{}),define("PowerBI/services/errorFormat",["require","exports"],(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.create=void 0;var n=powerbi,s=jsCommon.JsonExtensions,a=n.helpers.PowerBIServiceExceptionErrorHelper;t.create=function(e){return new o(e)};var o=(i.prototype.convertErrorDetailsJson=function(e){if(!_.isEmpty(e)){e=s.tryParseJSON(e);if(!e)return[];var t=[],e=a.generateErrorMessage(e.error,this.localizationService);if(!e)return[];for(var o=0,i=e.displayableErrorInfo;o<i.length;o++){var r=i[o];t.push({Name:r.errorInfoKey,Value:r.errorInfoValue})}return t}},i.prototype.getFriendlyErrorMessage=function(e){if(!_.isEmpty(e)){var t=s.tryParseJSON(e);if(t){var e=null,o={};if(e=t.error["pbi.error"]?t.error["pbi.error"].parameters:e)if(_.isArray(e))for(var i=0,r=e;i<r.length;i++){var a=r[i];o[a.Key]=a.Value}else o=e;return n.ServiceErrorHelper.FormatWithNamedParameters(this.localizationService,t.error.code,o)}}},i);function i(e){this.localizationService=e}})),(function(e){(e=(e=e.services||(e.services={})).events||(e.events={})).resetPersistentUserStateDone={name:"resetPersistentUserStateDone",type:3},e.activeBookmarkChanged={name:"activeBookmarkChanged",type:4},e.onReportSaved={name:"onReportSaved",type:3},e.personalizeArtifact={name:"personalizeArtifact",type:4},e.contentProviderStoreShowLoadingScreenArtifact={name:"contentProviderStoreShowLoadingScreenArtifact",type:4},e.invitationClaimed={name:"invitationClaimed",type:4},e.inFocusDirectiveInitialized={type:4,name:"inFocusDirectiveInitialized"},e.dashboardTileErrorEventName={type:4,name:"dashboardTileErrorEventName"},e.actualOpenTile={type:4,name:"actualOpenTile"},e.tileNotOpenable={type:4,name:"tileNotOpenable"},e.needStrategySwap={type:4,name:"needStrategySwap"},e.dashboardTileRepeatFinished={type:4,name:"dashboardTileRepeatFinished"},e.dashboardTileRepeatFinishedEvent={name:"dashboardTileRepeatFinished",type:4},e.tileVisualLoadedEventName={name:"tileVisualLoaded",type:4}})(powerbi=powerbi||{}),(function(u){var i=u.models.Group,e=u.models.Folder,t=window;u.createFolderService=function(e){return new o(e)};var o=(r.prototype.resolveFolderSwitchTelemetry=function(){this.perfSwitchGroupEvent&&(this.perfSwitchGroupEvent.resolve(),this.perfSwitchGroupEvent=null)},Object.defineProperty(r.prototype,"myFolderObjectId",{get:function(){return this._myFolderObjectId},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isInFolderTransition",{get:function(){return this._isInFolderTransition},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isFolderTransitionDelayed",{get:function(){return this._isGroupTransitionDelayed},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"groups",{get:function(){return this._groups},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"folders",{get:function(){return this._folders},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"activeFolderNumericId",{get:function(){return this.activeFolder instanceof e?this.activeFolder.id:void 0},enumerable:!1,configurable:!0}),r.prototype.getFolder=function(t){return _.find(this._groups,(function(e){return e.uniqueId===t}))||_.find(this._folders,(function(e){return e.uniqueId===t}))},r.prototype.addGroup=function(e){e=new u.models.Group(e);this._groups.push(e),this.services.groupStore.add(e.contract,!1)},r.prototype.addFolder=function(e){this._folders.push(new u.models.Folder(e)),this.services.groupStore.add(e,!0),this.services.activeFolderIdService.folderObjectIdToNumericIdMapping[e.objectId]=e.id},r.prototype.removeGroup=function(t){_.remove(this._groups,(function(e){return e.aadGroupId===t})),this.services.rootScope.$emit(u.constants.groupDeletedEventName),this.removeFromStore(t)},r.prototype.removeFolder=function(t){_.remove(this._folders,(function(e){return e.uniqueId===t})),this.services.rootScope.$emit(u.constants.groupDeletedEventName),this.removeFromStore(t)},r.prototype.isMyWorkspace=function(){return!this.services.activeFolderIdService.isInFolder},Object.defineProperty(r.prototype,"activeFolder",{get:function(){return this.getFolder(this.services.activeFolderIdService.activeFolderObjectId)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isFolder",{get:function(){return this.activeFolder instanceof u.models.Folder},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"activeFolderObjectId",{get:function(){return this.services.activeFolderIdService.activeFolderObjectId},set:function(e){var t=this,o=this.services.activeFolderIdService;o.activeFolderObjectId=e;e=this.activeFolder;e?(e=e.contract,this.isFolder?o.folderPermission=e.permissions:o.folderPermission=void 0,o.isReadOnly=e.isReadOnly&&!e.isOwner,this.activeFolderNumericId&&((e=_.find(this._folders,(function(e){return e.uniqueId===t.activeFolderObjectId})))&&e.sharePointStorage?o.folderSharePoint={groupFilesUrl:e.sharePointStorage.groupFilesUrl,groupDisplayName:e.sharePointStorage.groupDisplayName}:e&&(o.folderSharePoint=void 0)),this.activeFolder.capacity&&!_.isEmpty(this.activeFolder.capacity.id)&&(this.services.telemetryService.setHostInfo("isInCapacity",!0),this.services.telemetryService.setHostInfo("activeFolderCapacityId",this.activeFolder.capacity.id))):o.isReadOnly=!1},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"datasets",{get:function(){return this.services.modelService.models},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"reports",{get:function(){return this.services.reportService.reports},enumerable:!1,configurable:!0}),r.prototype.switchFolder=function(e,t){return this.groupSwitchDeferred&&(this.groupSwitchDeferred.reject(),this.groupSwitchDeferred=null),this.switchFolderInternal(e,t),this.folderSwitchPromise()},r.prototype.isDataInCurrentGroup=function(){var t;return this.services.cdsaModelStore.cdsaModels.subscribe((function(e){t=e})),0<this.services.modelService.models.length||0<this.services.reportService.reports.length||0<this.services.workbookService.workbooks.length||0<t.length},r.prototype.ensureFoldersInitialization=function(){return this.initializationDeferredOperation.promise},r.prototype.folderSwitchPromise=function(){return this.groupSwitchDeferred?this.groupSwitchDeferred.promise:this.services.promiseFactory.resolve(null)},r.prototype.updateGroupInStore=function(e){this.services.groupStore.updateGroup(e)},r.prototype.updateFolders=function(p){return __awaiter(this,void 0,u.Promise,(function(){var t,o,i,r,a,n,s,l,c,d;return __generator(this,(function(e){switch(e.label){case 0:return this.services.featureSwitchService.featureSwitches.workspacesV2?(t=p,_.isEmpty(t)?[4,this.getAllWorkspaceFolders()]:[3,2]):[2];case 1:t=e.sent(),_.isEmpty(t)||this.services.groupStore.loadFoldersSuccess(t),e.label=2;case 2:if(o=this.services.activeFolderIdService,t){for(i=function(t){var e=_.findIndex(r._folders,(function(e){return e.uniqueId===t.objectId}));-1!==e?r._folders[e]=new u.models.Folder(t):r._folders.push(new u.models.Folder(t)),o.folderObjectIdToNumericIdMapping[t.objectId]=t.id},r=this,a=0,n=t;a<n.length;a++)s=n[a],i(s);for(this.services.groupStore.update(t),l=0,c=this.folderChangedHandlers;l<c.length;l++)c[l].onFolderChanged()}return this.activeFolder&&(o.folderDisplayName=this.activeFolder.displayName,this.activeFolderNumericId?(d=this.activeFolder,o.folderPermission=d.contract.permissions,d&&d.sharePointStorage?o.folderSharePoint={groupFilesUrl:d.sharePointStorage.groupFilesUrl,groupDisplayName:d.sharePointStorage.groupDisplayName}:o.folderSharePoint=void 0):o.folderPermission=void 0),[2]}}))}))},r.prototype.isViewerOnFolder=function(t){var e=_.find(this.folders,(function(e){return e.uniqueId===t}));return!!e&&1===e.permissions},r.prototype.removeFromStore=function(e){this.services.groupStore.remove(e)},r.prototype.updateActiveGroup=function(e,t){this.activeFolderObjectId=e,this.services.activeFolderIdService.folderDisplayName=t},r.prototype.initFoldersService=function(){var a=this;this.services.appMetadataService.getAppMetadata().then((function(e){a.initFoldersServiceFromDashboardContainer(e)}),(function(){return a.updateGroups()})),this.services.rootScope.$on(u.common.constants.navigation.stateChangeSuccess,(function(e,t,o,i,r){return a.handleStateChange(t,o,i,r)})),this.services.rootScope.$on(u.common.constants.dashboardTileRepeatFinishedEvent,(function(){a.resolveFolderSwitchTelemetry()}))},r.prototype.handleStateChange=function(e,t,o,i){var r,a=this;this.activeFolderObjectId!==t.groupGUID&&(r=this.activeFolderObjectId,this.shouldSwitchGroup(e,t,o,i,r)&&(this.groupSwitchDeferred&&this.groupSwitchDeferred.reject(),this.groupSwitchDeferred=this.services.promiseFactory.defer(),this.ensureFoldersInitialization().then((function(){var e=a.getFolder(t.groupGUID);e?(a.perfSwitchGroupEvent=a.services.telemetryService.startEvent(u.telemetry.GroupsSwitchGroup,{groupObjectId:t.groupGUID}),a.switchFolderInternal(e,a.perfSwitchGroupEvent)):a.groupSwitchDeferred.resolve(null)}))))},r.prototype.shouldSwitchGroup=function(e,t,o,i,r){r=!_.isEmpty(i)&&i.groupGUID||this.isValidStateWithEmptyGroupGUID(o,i)&&r;if(!r)return!1;if(t.groupGUID&&t.groupGUID!==r)return!0;if(e.name===u.constants.navigation.states.featureddashboard){if(!this.services.featuredDashboard.isHomeDashboardSet)return!1;if(r!==this.services.featuredDashboard.homeDashboard.groupId)return!0}return!1},r.prototype.isValidStateWithEmptyGroupGUID=function(e,t){return(_.isEmpty(e.params)||!e.params.hasOwnProperty("groupGUID"))&&(_.isEmpty(t)||!t.hasOwnProperty("groupGUID"))},r.prototype.switchFolderInternal=function(t,o){return __awaiter(this,void 0,u.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return(this.startTimedTransition(),this.groupSwitchDeferred||(this.groupSwitchDeferred=this.services.promiseFactory.defer()),this.updateActiveGroup(t.uniqueId,t.displayName),t instanceof i)?(this.loadContentForGroup(t,o),[3,3]):[3,1];case 1:return[4,this.loadContentForFolder(t,o)];case 2:e.sent(),e.label=3;case 3:return[2]}}))}))},r.prototype.loadContentForFolder=function(r,a){return __awaiter(this,void 0,u.Promise,(function(){var t,o,i;return __generator(this,(function(e){switch(e.label){case 0:t=r.uniqueId,e.label=1;case 1:return e.trys.push([1,4,5,6]),[4,this.services.groupHttpService.getWorkspaceDashboardContainer(r,a.event).toPromise()];case 2:return i=e.sent(),o=i.data,this.services.groupStore.loadSuccess(t,o,r.id,r.permissions),this.services.groupStore.select(t),[4,this.services.groupStore.ensureGroupSelectedAndLoaded(t)];case 3:return e.sent(),this.updateContentServices(r,o),this.groupSwitchDeferred.resolve(null),this.services.rootScope.$emit(u.constants.groupSwitchedEventName,o),[3,6];case 4:return i=e.sent(),a.reject(u.errorDetailsHelper.getTelemetryErrorDetails(i)),this.groupSwitchDeferred.reject(),this.showLoadGroupFailedMessage(i.requestId,i.status.toString()),[3,6];case 5:return this.groupSwitchDeferred=null,this.endTimedTransition(),[7];case 6:return[2]}}))}))},r.prototype.loadContentForGroup=function(o,i){var r=this;this.services.groupHttpService.getWorkspaceDashboardContainer(o,i.event).toPromise().then((function(e){var t;o.aadGroupId===r.activeFolderObjectId&&(r.services.groupStore.loadSuccess(o.aadGroupId,e.data),t=e.data,r.services.groupStore.select(o.aadGroupId),e=function(){r.updateContentServices(o,t),r.groupSwitchDeferred.resolve(null),r.groupSwitchDeferred=null,r.services.rootScope.$emit(u.constants.groupSwitchedEventName,t),r.endTimedTransition()},r.services.groupStore.ensureGroupSelectedAndLoaded(o.aadGroupId).then(e,e))}),(function(e){var t=jsCommon.StringExtensions.format("Status:{0} requestId:{1} Details:{2}",e.status.toString(),e.requestId,e.error&&e.error.message?e.error.message:"");i.reject({errorCode:e.error&&e.error.code?e.error.code:"FailToGetGroupDashboardContainer",errorMessage:t}),r.groupSwitchDeferred.reject(),r.groupSwitchDeferred=null,r.showLoadGroupFailedMessage(e.requestId,e.status.toString()),r.endTimedTransition()}))},r.prototype.updateContentServices=function(e,t){if(t)for(var o=0,i=this.folderChangedHandlers;o<i.length;o++)i[o].onFolderChanged()},r.prototype.initFoldersServiceFromDashboardContainer=function(e){this.loadGroupsWithActiveDashboard(this.services.userInfo.userMetadata?this.services.userInfo.userMetadata.groups:null,e.activeDashboardId),this.updateGroups(),this.updateFolders(e.folders)},r.prototype.getAllWorkspaceFolders=function(){return __awaiter(this,void 0,u.Promise,(function(){var t,o,i;return __generator(this,(function(e){switch(e.label){case 0:t=this.services.telemetryService.startEvent(u.telemetry.FoldersGetWorkspaceFolders,{folderId1:this.activeFolderNumericId}),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.services.groupHttpService.getWorkspaceFolders(t.event).toPromise()];case 2:return o=e.sent(),t.event.info.responseRequestId=o.responseRequestId,t.resolve(),[3,4];case 3:return i=e.sent(),t.event.info.responseRequestId=i.responseRequestId,t.reject(u.errorDetailsHelper.getTelemetryErrorDetails(i.error)),[3,4];case 4:return o&&200===o.status?[2,o.data]:[2]}}))}))},r.prototype.showLoadGroupFailedMessage=function(e,t){this.services.errorService.error(this.services.localizationService.get("ErrorMessage_FailedLoadGroup"),"FailedLoadGroup",{requestId:e,statusCode:t})},r.prototype.updateGroups=function(){var o=this;return this.activeFolderObjectId=_.isEmpty(t.initialGroupGUID)?u.constants.myWorkSpaceFolderId:t.initialGroupGUID,this.services.userInfo.userMetadataPromise.then((function(e){var t;o.activeFolder&&(t=o.activeFolder.lastViewedDashboard),o.loadGroupsWithActiveDashboard(e.groups,t),o.services.activeFolderIdService.initialFolderIdReadyPromise.then((function(){o.services.activeFolderIdService.isReadOnly=o.activeFolder.contract.isReadOnly&&!o.activeFolder.contract.isOwner}))}))},r.prototype.loadGroupsWithActiveDashboard=function(e,t){this.loadGroups(e),this.activeFolder&&(this.activeFolder.lastViewedDashboard=t),this.initializationDeferredOperation.resolve(null)},r.prototype.loadGroups=function(e){var o=this;if(this._groups=[],this.loadMyWorkspace(),e)for(var t=0,i=e.length;t<i;++t){var r=new u.models.Group(e[t]);!(function(t){o.services.profileImageService.findGroupIcon(t.contract.objectId).then((function(e){t.icon=e}),(function(){}))})(r),this._groups.push(r)}},r.prototype.loadMyWorkspace=function(){var e=this.services.userInfo&&this.services.userInfo.userMetadata&&this.services.userInfo.userMetadata.capacityWorkspaceMetadata,t={id:-1,displayName:this.services.localizationService.get("NavigationPane_Groups_MyWorkspace"),objectId:this.services.activeFolderIdService.myWorkspaceFolderId,groupType:0,isOwner:!1,isPublic:!1,isReadOnly:!1,mailNickname:"",capacityObjectId:e&&e.capacityObjectId,capacityName:e&&e.capacityName,isMyWorkspace:!0},t=new u.models.Group(t);t.workspaceId=e&&e.workspaceObjectId,this._groups.push(t)},r.prototype.startTimedTransition=function(){var e=this;this._isInFolderTransition=!0,this._isGroupTransitionDelayed=!1,this._groupTransitionTimeoutPromise&&this.services.timeout.cancel(this._groupTransitionTimeoutPromise),this._groupTransitionTimeoutPromise=this.services.timeout((function(){e._isGroupTransitionDelayed=!0}),r.switchGroupTimeLimit)},r.prototype.endTimedTransition=function(){this._isInFolderTransition=!1,this._isGroupTransitionDelayed=!1,this.services.timeout.cancel(this._groupTransitionTimeoutPromise)},r.switchGroupTimeLimit=1e3,r);function r(e){var t=this;this._isInFolderTransition=!1,this._isGroupTransitionDelayed=!1,this._groups=[],this._folders=[],this.folderChangedHandlers=[],this.services=e,this.initializationDeferredOperation=this.services.promiseFactory.defer(),this.initFoldersService(),null!==(e=this.services.groupStore.myFolderObjectId$)&&void 0!==e&&e.subscribe((function(e){t._myFolderObjectId=e}))}u.Folders=o})(powerbi=powerbi||{}),(function(e){var o=e.models.HistoryDialogModel;e.createHistoryDialogService=function(e,t){return new i(e,t)};var i=(r.prototype.showHistoryDialog=function(e,t){void 0===t&&(t=!1);var o=this.parameters;o.showHistoryDialog=!0,o.showSpinner=!0,o.datasetModel={},o.datasetModel.dataset=e.dataset,o.isCacheRefresh=t,this.historyDialogElement||(this.template=angular.element(r.htmlTemplate),this.historyDialogElement=this.compile(this.template)(this.serviceScope)),$("body").append(this.historyDialogElement)},r.prototype.hideHistoryDialog=function(){var e=this.parameters;e.showHistoryDialog=!1,e.showSpinner=!1},Object.defineProperty(r.prototype,"historyDialogParameters",{get:function(){return this.parameters},enumerable:!1,configurable:!0}),r.htmlTemplate="<history-dialog view-model='historyDialogParameters' ng-if='historyDialogParameters.showHistoryDialog'> </history-dialog>",r);function r(e,t){this.rootScope=e,this.compile=t,this.parameters=new o,this.serviceScope=this.rootScope.$new(),this.serviceScope.historyDialogParameters=this.parameters}e.HistoryDialogService=i})(powerbi=powerbi||{}),(function(s){!(function(e){var i=s.dataServices.models.Tile,r=s.dataServices.contracts.TileType,a=s.dataServices.models.WorkbookTileModel;e.createInFocusService=function(e,t){return new o(e,t)};var o=(n.prototype.view=function(e,t,o){(this.inFocusTile=e).type===r.workbook?this.openInFocusWorkbookTile(e,t):e.type===r.realTime?this.openInFocusRealTimeTile(e):this.openInFocusTile(e,t,o)},n.prototype.openInFocusTile=function(e,t,o){this.rootScope.$emit(s.constants.openInFocusTileActionName,{modelId:e.contract.modelId,openInsightArgs:t,runScopedInsights:o})},n.prototype.openInFocusWorkbookTile=function(e,t){var o=n.cloneWorkbookTileModelForInFocusUse(e.workbook,this.localizationService),i=o.tileModel.layoutPosition;e.gridLayoutContext&&"function"==typeof e.gridLayoutContext.getGridWidth&&"function"==typeof e.gridLayoutContext.getGridHeight&&(i.width=Math.floor(e.gridLayoutContext.getGridWidth()/s.common.GridLayoutConstants.defaultGridWidth),i.height=Math.floor(e.gridLayoutContext.getGridHeight()/s.common.GridLayoutConstants.defaultGridHeight)),this.rootScope.$emit(s.constants.openInFocusWorkbookTileActionName,{workbook:o})},n.prototype.openInFocusRealTimeTile=function(e){this.rootScope.$emit(s.constants.openInFocusRealTimeTileActionName,e)},n.prototype.exit=function(){this.inFocusTile=null,this.showVisualEnabled=!1},n.cloneWorkbookTileModelForInFocusUse=function(e,t){var o=new a(null,null);return jQuery.extend(o,e),o.tileModel=new i(null,t,e.tileModel.forceOpenCustomLinksInNewTab),jQuery.extend(o.tileModel,e.tileModel),o.tileModel.layoutPosition=_.cloneDeep(e.tileModel.layoutPosition),o},n);function n(e,t){this.rootScope=e,this.localizationService=t,this.inFocusTile=null}e.InFocusService=o})(s.services||(s.services={}))})(powerbi=powerbi||{}),(function(M){var s=M.dataServices.ContractUtils,l=M.data.services.DataViewTransformActionsSerializer,o=M.common.contracts.PackageType,b=M.explore.contracts.PinData,t=M.explore.util.ScriptVisualsUtil,f=M.common.constants.tileActions,y=M.dataServices.models.TileFactory,S=jsCommon.EnumExtensions;M.createPinTileService=function(e,t,o,i,r,a,n,s,l,c,d,p,u,h,g,v,m,b,f,y,S,w,D,T,C,k,P,E){return new I(e,t,o,i,r,a,n,s,l,c,d,p,u,h,g,v,m,b,f,y,S,w,D,T,C,k,P,E)};var I=(A.prototype.setSavedReportId=function(e){this.savedReportId=e},A.prototype.showPinVisualFromWorkbookDialog=function(e,t,o,i){this.showPinVisualDialog(void 0,void 0,void 0,e,o,t,void 0,i=void 0===i?2:i)},A.prototype.showPinVisualDialog=function(e,t,o,i,r,a,n,s){var l=a,c=void 0===t?[]:[t],d=o&&o.contract,p=null==d?[]:[d],u=void 0===i?[]:[i];this.pinEvent=r;var h,g=void 0!==a,v=!g&&(e.action.action===f.openQnAActionName||e.action.originalAction===f.openQnAActionName),m=e&&(e.action.action===f.openInsightsActionName||e.action.originalAction===f.openInsightsActionName),o=e&&e.action&&!e.action.action&&!e.reportId;this.pinTileScope=this.createPinTileScope(void 0===t&&!v),this.pinTileScope.viewModel.isPinFromDashboard=!1,this.pinTileScope.viewModel.isLiveReport=!1,g?(this.pinTileScope.viewModel.hasTileFormatting=!1,this.formattedTileContract=a):(r=b.getVisualType(e),g=this.visualPlugin.capabilities(r),l=y.createTileForPinData(e,g,d),a=e.themeCollection&&e.themeCollection.customTheme,r&&a?delete e.themeCollection.customTheme:this.pinTileScope.viewModel.hasTileFormatting=!1,g=y.createTileForPinData(e,g,d),this.formattedTileContract=g),i?(h=this.permissionService.getWorkbookEffectivePermissions(i),this.pinTileScope.isNotFullyResharable=!S.hasFlag(h,4)):(h=!t||this.canReshareReportContract(t.contract),d=!!d&&this.canReshareModelContract(d),this.pinTileScope.isNotFullyResharable=!h||!d),this.dashboardTile=this.modelConverter.convertTile(this.formattedTileContract,p,c,u),this.reportTile=this.modelConverter.convertTile(l,p,c),this.reportTile.composite&&(this.themeCollection=this.reportTile.composite.config.themeCollection),this.setTheme(this.dashboardTile,!1),this.setTheme(this.reportTile,!0),this.pinTileScope.viewModel.needSaveReport=!(t||v||m||i||o||n),this.createModelDialogWithOptions(this.pinTileScope,s)},A.prototype.showPinVisualFromDashboardDialog=function(e,t){this.pinEvent=t;if(e.reportTile){var o=e.reportTile.exploration,t=e.contract.sectionId,i=M.explore.SectionUtils.findSectionById(o.contract,t);if(i){var r=void 0,a=void 0;e.config&&e.config.reportTile&&(r=(t=e.config.reportTile).pod,n=[],a=t.filters&&this.explorationSerializer.deserializeFilterCollection(this.explorationSerializer.parseFilterCollectionConfig(t.filters),n,!1),_.isEmpty(n));var n={exploration:o,section:i,reportId:e.contract.reportId,modelId:e.contract.modelId,packageId:e.contract.packageId,isPinFromDashboard:!0,sourceDashboardId:e.contract.dashboardId,displayText:e.displayText,subDisplayText:e.subDisplayText,action:e.action,filters:a,pod:r,utterance:e.utterance};return this.showPinReportPageDialog(n)}}else{i=!1;this.pinTileScope=this.createPinTileScope(!1),this.pinTileScope.viewModel.isLiveReport=!1,this.pinTileScope.viewModel.isPinFromDashboard=!0;a=void 0===e.contractsReport?[]:[e.contractsReport];this.formattedTileContract=e.contract,e.composite&&e.composite.config&&(i=!!e.composite.config.themeCollection.customTheme),this.pinTileScope.viewModel.hasTileFormatting=i;var s,r=this.createCustomTileForPinData(e,!0),n=void 0;e.config&&e.config.workbookTile&&e.workbook&&e.workbook.contract?(n=(s=this.workbookService.findWorkbook(e.workbook.contract.workbookId,e.workbook.contract.packageId))?[s.contract]:void 0,this.pinTileScope.isNotFullyResharable=!s||!S.hasFlag(s.getPermissions(),4)):(s=!(i=e.contractsReport)||this.canReshareReportContract(i),i=!(i=e.contractsModel)||this.canReshareModelContract(i),this.pinTileScope.isNotFullyResharable=!s||!i),this.dashboardTile=this.modelConverter.convertTile(r,a,n);n=this.createCustomTileForPinData(e,!1);this.reportTile=this.modelConverter.convertTile(n,a),this.themeCollection=this.reportTile.composite&&this.reportTile.composite.config.themeCollection,this.setTheme(this.dashboardTile,!1),this.setTheme(this.reportTile,!0),this.pinTileScope.viewModel.sourceDashboardId=e.contract.dashboardId,this.createModelDialogWithOptions(this.pinTileScope)}},A.prototype.showPinReportPageDialog=function(p){return __awaiter(this,void 0,M.Promise,(function(){var t,o,i,r,a,n,s,l,c,d;return __generator(this,(function(e){switch(e.label){case 0:return p.exploration,p.section,p.reportId,this.exploration=p.exploration,s=!!p.isPinFromDashboard,this.pinTileScope=this.createPinTileScope(!1),this.pinTileScope.viewModel.isLiveReport=!0,this.pinTileScope.viewModel.isPinFromDashboard=s,this.pinTileScope.viewModel.needSaveReport=!1,this.pinTileScope.viewModel.hasTileFormatting=!1,s&&(this.pinTileScope.viewModel.sourceDashboardId=p.sourceDashboardId),t=this.reportService.findReport(p.reportId),o=t?t.modelId:void 0,c=this.modelService.findModel(o),i=c?[c]:[],l=p.section.size,r=l?l.width:void 0,a=l?l.height:void 0,this.pinEvent=this.createPinEvent(p.isPinFromDashboard,c?c.getPermissions():null,p.packageId),(d=this.isUsageMetricsReport(t)&&!_.isEmpty(p.additionalODataFilter))&&(n=p.additionalODataFilter),s=p.action||{action:f.openReportActionName,targetSlideId:p.section.name,filter:n},l=!t||this.canReshareReportContract(t.contract),c=!!c&&this.canReshareModelContract(c.contract),this.pinTileScope.isNotFullyResharable=!l||!c,t?[4,this.generateReportFilters(p,d)]:(this.pinTileScope.viewModel.needSaveReport=!0,this.createModelDialogWithOptions(this.pinTileScope,2,!0),[2]);case 1:return d=e.sent(),d=y.createReportTileForExploreData(p.reportId,o,p.packageId,p.section.id,p.displayText||t.displayName,p.subDisplayText||p.section.displayName,s,p.pod,d,p.utterance,r,a),this.dashboardTile=this.modelConverter.convertTile(d,i,[t]),this.reportTile=this.modelConverter.convertTile(d,i,[t]),this.themeCollection=p.exploration.contract.themeCollection,this.setTheme(this.dashboardTile,!1),this.setTheme(this.reportTile,!0),this.createModelDialogWithOptions(this.pinTileScope,2,!0),[2]}}))}))},A.prototype.generateReportFilters=function(i,r){return __awaiter(this,void 0,M.Promise,(function(){var t,o;return __generator(this,(function(e){switch(e.label){case 0:return t=i.filters||[],r?[4,this.lazyProviderModern.get("@powerbi/ODataFilterParser/OData-Filter-Parser.module#ODataFilterParserModule","odataFilterParserService")]:[3,3];case 1:return[4,e.sent().tryGetFilters(i.additionalODataFilter)];case 2:o=e.sent(),t.push.apply(t,o||[]),e.label=3;case 3:return t?[2,this.explorationSerializer.stringifyFilterCollectionConfig(this.explorationSerializer.serializeFilterCollection(t))]:[2]}}))}))},A.prototype.isScriptVisualInLivePage=function(e){if(e&&e.exploreCanvas&&e.exploreCanvas.visualContainers){e=e.exploreCanvas.contract.visualContainers;return t.visualContainerHasScriptVisuals(e,this.visualPlugin)}return!1},A.prototype.createModelDialogWithOptions=function(e,t,o){o={dialogName:null,isDismissable:!0,scope:e,template:"<pin-tile-dialog></pin-tile-dialog>",focusOnFirstButton:!0,dialogCssClass:o?"liveReport":"pinTile",closeOnEsc:!0};0===(t=void 0===t?2:t)&&(o.notificationText=this.localizationService.get("PinTile_Workbook_Changed"),o.notificationType=jsCommon.ModalDialogNotificationType.Info),this.modalDialogService.showLegacyWebModalDialog(o)},A.prototype.createPinEvent=function(e,t,o){return this.telemetryService.startEvent(M.telemetry.DashboardPinTile,{visualType:"reportPage",source:e?"Dashboard":"Report",reason:"",unsupportedVisualPinned:!1,contentProviderType:"",isCustomVisual:!1,widgetType:"",reportPageContainsScriptVisuals:this.isScriptVisualInLivePage(this.exploration),sourceOrigin:this.getSourceOrigin(t,o)})},A.prototype.createCustomTileForPinData=function(e,t){var o,i,r={visualContainer:void 0,dataViewSource:void 0,themeCollection:M.visualHost.ThemeUtils.cloneThemeCollection(e.composite&&e.composite.config&&e.composite.config.themeCollection)||{}},a=e.contract,n=a&&a.$config;n&&(r.dataViewSource=a.tileDataSet,r.reportId=a.reportId,r.modelId=a.modelId,r.action=e.action,r.utterance=a.query&&a.query.modelQuery?e.contract.query.modelQuery.utterance:void 0,r.tileSubDisplay=e.getSubDisplayText(),r.tileHeading=e.getDisplayText(),t&&delete r.themeCollection.customTheme,r.resourcePackageIds=a.resourcePackageIds,(t=n.visualContainer||n.realTimeVisual)&&(r.queryMetadata=t.queryMetadata,r.elements=t.elements,r.tileLayoutType=t.layoutType,r.visualContainer=this.explorationSerializer.deserializeCanvasItem(this.explorationSerializer.serializeVisualContainer(t.$visualContainer)),(i=this.visualPlugin.capabilities(b.getVisualType(r)))&&i.objects&&t.transform&&(o=JSON.parse(t.transform),r.dataTransforms=l.deserializeDataViewTransformActions(o,i))),n.realTimeVisual&&(r.realTimeDataWindow=n.realTimeVisual.dataWindow),o=a.query&&a.query.modelQuery&&a.query.modelQuery.sq?s.convertToTileDataQuery(a.query):void 0,i=n&&n.tileDataType,o&&(r.query=o),i&&(r.tileDataType=n.tileDataType),a.name&&(r.name=a.name));a=r.visualContainer?y.createTileForPinData(r,this.visualPlugin.capabilities(b.getVisualType(r)),e.datasetModel&&e.datasetModel.contract):y.createNonVisualTileFromExisting(a);return n.widget&&(a.$config.widget=n.widget),this.modelConverter.resolveTilePackage(a,this.packageService.packages),a.displayText=e.getDisplayText(),a.subDisplayText=e.getSubDisplayText(),a},A.prototype.updateTile=function(e){this.formattedTileContract=(e?this.dashboardTile:this.reportTile).contract},A.prototype.hideDialog=function(){this.modalDialog&&this.modalDialog.hideDialog()},A.prototype.copyResourcePackages=function(o){var i=[];if(o.resourcePackageIds)for(var r=this,e=0,t=o.resourcePackageIds.length;e<t;e++)!(function(e){var t=e;i.push(r.resourcePackageCopyService.copyResourcePackageIfNeeded(o.resourcePackageIds[t],r.activeFolderId.activeFolderNumericId,null).then((function(e){e&&(o.resourcePackageIds[t]=e.id)})))})(e);return this.promiseFactory.all(i)},A.prototype.onPinButtonClickedActions=function(){var e=this,t=this.pinTileScope.viewModel.useDashboardFormatting?0:1;this.userSettingsService.updatePinDialogPreviewTileFormat(t,this.pinEvent),this.savedReportId&&(this.formattedTileContract.reportId=this.savedReportId,this.savedReportId=null),this.copyResourcePackages(this.formattedTileContract).then((function(){return __awaiter(e,void 0,M.Promise,(function(){return __generator(this,(function(e){return this.pinTileScope.viewModel.useExistingDashboard?this.dashboardService.pinTileToExistingDashboard({tile:this.formattedTileContract,dashboardId:parseInt(this.pinTileScope.viewModel.selectedDashboardId,10),parentEvent:this.pinEvent,showNotification:!0}):this.dashboardService.pinTileToNewDashboard({tile:this.formattedTileContract,newDashboardName:this.pinTileScope.viewModel.newDashboardName,parentEvent:this.pinEvent,showNotification:!0}),this.modalDialog.hideDialog(),[2]}))}))}))},A.prototype.onSaveAndContinueButtonClickedActions=function(){var e=this;this.globalEventBridge.publishToChannel(M.explore.services.events.saveReportFromPinDialogEvent,{newReportName:this.pinTileScope.viewModel.newReportName});var t=this.interval((function(){e.savedReportId&&(e.pinTileScope.viewModel.needSaveReport=!1,e.interval.cancel(t))}),100);this.modalDialog.refocus()},A.prototype.pinVisual=function(e,t){var o=this;e&&this.modelService.modelsPromise.then((function(){o.pinVisualInternal(e,t)}))},A.prototype.pinVisualInternal=function(e,t){var o,i=this.telemetryService,r=e.modelId,a=e.packageId,n=r?this.findModel(r,a):void 0,s=n?n.contentProviderId:void 0,l=this.contentProviderHttpService.getBuiltInContentProviders(this.activeFolderId),r=M.dataServices.AppUtils.findContentProviderName(l,s),l=b.getVisualType(e),s=this.visualPlugin.isCustomVisual(l),a=i.startEvent(M.telemetry.DashboardPinTile,{visualType:l,source:this.getSource(e),reason:"",unsupportedVisualPinned:!1,contentProviderType:r,isCustomVisual:s,widgetType:"",reportPageContainsScriptVisuals:!1,sourceOrigin:this.getSourceOrigin(n?this.permissionService.getModelEffectivePermissions(n):null,a)});e.reportId&&((o=this.reportService.findReport(e.reportId))||this.reportService.addReport(this.modelConverter.convertReport({id:e.reportId,permissions:15}))),this.isPinningSupported(o,n,e.action)&&this.showPinVisualDialog(e,o,n,void 0,a,void 0,t)},A.prototype.pinReportPage=function(e){var t=this;this.modelService.modelsPromise.then((function(){t.pinReportPageInternal(e)}))},A.prototype.pinReportPageInternal=function(e){var t=this.reportService.findReport(e.reportId),o=this.findModel(e.modelId,e.packageId);this.isUsageMetricsReport(t)&&(e.additionalODataFilter=this.navigation.additionalODataFilter),this.isPinningSupported(t,o,e.action)&&this.showPinReportPageDialog(e)},A.prototype.isPinningSupported=function(e,t,o){var i,r=this.permissionService,a=r&&t&&t.getPermissions();if(this.featureSwitchService.featureSwitches.capacityMetricsGen2App){if(e&&this.isInCapacityMetricsApp(e.packageId))return this.showNotSupportedDialog(),!1;if(t&&this.isInCapacityMetricsApp(t.packageId))return this.showNotSupportedDialog(),!1}if(this.featureSwitchService.featureSwitches.pinReadable)return!r.isActiveWorkspaceIsReadOnlyLegacy&&(!(t&&!this.canPin(a,t.packageId)||e&&e.model&&!this.canPinReportPage(e))||(this.showNotSupportedDialog(),!1));if(e&&17===e.getPermissions()?i=e.packageId:t&&17===a&&(i=t.packageId),null!=i)return this.contentPackService.onPersonalizeContentPack(i),!1;o=o&&o.action,o=(o===f.openQnAActionName||o===f.openInsightsActionName)&&t&&!r.isExplorableModel(t),t=!this.featureSwitchService.featureSwitches.pinInsightsFromApp&&!!this.navigation.inAppView();return!(r.isActiveWorkspaceIsReadOnlyLegacy||e&&2!=(2&e.getPermissions())||o||t)||(this.showNotSupportedDialog(),!1)},A.prototype.isUsageMetricsReport=function(e){return this.featureSwitchService,this.featureSwitchService.featureSwitches.usageMetricsEnabled&&e&&this.usageMetricsReport.isUsageMetricsArtifact(e)},A.prototype.isInCapacityMetricsApp=function(e){e=this.packageService.findPackage(e).contract;return e&&e.serviceAppObjectId&&e.serviceAppObjectId===M.constants.genTwoCapacityPackageId},A.prototype.findModel=function(e,t,o){o=this.modelService.findModel(e,t,o=void 0===o?!0:o);return null!=o&&o.contract,o},A.prototype.getSource=function(e){switch(e.action.action){case f.openQnAActionName:return"QnA";case f.openInsightsActionName:return"Insights";default:return"Exploration"}},A.prototype.canPinReportPage=function(e){return!this.permissionService.isActiveWorkspaceIsReadOnlyLegacy&&this.canPinFromModel(e.model,e.modelId,e.packageId)},A.prototype.getSourceOrigin=function(e,t){if(_.isNumber(t)){t=this.packageService.findPackage(t);if(t&&t.packageType===o.AppInstance)return"App"}return e?1===e||5===e?"Shared":"Owned":"Unknown"},A.prototype.canPinFromModel=function(e,t,o){if(e){var i=this.permissionService.getModelEffectivePermissions(e);return this.canPin(i,e.packageId)}if(_.isNumber(t)){o=this.modelService.findModel(t,o,!0);return!!o&&this.canPin(o.getPermissions(),o.packageId)}return!1},A.prototype.canPin=function(e,t){return!!S.hasFlag(e,1)&&(!S.hasFlag(e,17)||!!this.folderService.isMyWorkspace&&!!this.appService.getAppInstance(t))},A.prototype.setTheme=function(e,t){e&&(e.calculateLayout(M.common.GridLayoutConstants.getDefaultGridItemViewport(M.common.GridLayoutConstants.getSmallLandscapeGridItem())),e.applyLayout(),t?(e.composite&&(e.composite.config.themeCollection=this.themeCollection),this.pinTileScope&&this.pinTileScope.viewModel&&(this.pinTileScope.viewModel.reportTile=e)):(e.composite&&delete e.composite.config.themeCollection.customTheme,this.pinTileScope&&this.pinTileScope.viewModel&&(this.pinTileScope.viewModel.dashboardTile=e,this.pinTileScope.viewModel.workbookTile=e)))},A.prototype.showNotSupportedDialog=function(){var o=this.errorService.control(),e=this.localizationService.get("PinTile_NotSupportedTitle"),t=this.localizationService.get("PinTile_NotSupportedMessage"),i=[new InJs.ModalDialogAction(this.localizationService.get("PinTile_OK"),function(e,t){o.hideDialog()})];o.showCustomDialog(e,$("<div></div>").text(t),i,null,!0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,!0)},A.prototype.canReshareReportContract=function(e){e=this.permissionService.getReportEffectivePermissions(e);return S.hasFlag(e,4)||S.hasFlag(e,2)},A.prototype.canReshareModelContract=function(e){e=this.permissionService.getModelEffectivePermissions(e);return S.hasFlag(e,4)||S.hasFlag(e,2)},A.prototype.createPinTileScope=function(e){var t=this.rootScope.$new();return t.viewModel=new M.models.PinTileDialogModel(null),t.viewModel.needSaveReport=e,t},A.pinInsightContainer="pinInsightContainer",A);function A(e,t,o,i,r,a,n,s,l,c,d,p,u,h,g,v,m,b,f,y,S,w,D,T,C,k,P,E){var I=this;this.rootScope=e,this.errorService=t,this.telemetryService=o,this.localizationService=i,this.modalDialogService=r,this.modelConverter=a,this.visualPlugin=n,this.userSettingsService=s,this.reportService=l,this.modelService=c,this.workbookService=d,this.dashboardService=p,this.packageService=u,this.explorationSerializer=h,this.promiseFactory=g,this.lazyProviderModern=v,this.featureSwitchService=m,this.usageMetricsReport=b,this.interval=f,this.permissionService=y,this.appService=S,this.contentPackService=w,this.contentProviderHttpService=D,this.navigation=T,this.folderService=C,this.globalEventBridge=k,this.activeFolderId=P,this.resourcePackageCopyService=E,this.modalDialog=this.errorService.control(),this.globalEventBridge.createChannelSubscriptionManager().subscribe(M.explore.services.events.pinInsightContainer,(function(e,t){return I.pinVisual(t.pinData)})),this.rootScope.$on(M.common.constants.pinReportPageToDashboard,(function(e,t){return I.pinReportPage(t)})),this.rootScope.$on(M.explore.constants.pinVisualContainerEventName,(function(e,t){return I.pinVisual(t)})),this.rootScope.$on(A.pinInsightContainer,(function(e,t){return I.pinVisual(t)}))}M.PinTileService=I,M.createMockPinTileService=function(){return new e};var e=(Object.defineProperty(i.prototype,"pinTileScope",{get:function(){},enumerable:!1,configurable:!0}),i.prototype.ensurePinTileService=function(){},i.prototype.createCustomTileForPinData=function(e,t){return __awaiter(this,void 0,M.Promise,(function(){return __generator(this,(function(e){return[2]}))}))},i.prototype.showPinVisualFromWorkbookDialog=function(e,t,o,i){return __awaiter(this,void 0,M.Promise,(function(){return __generator(this,(function(e){return[2]}))}))},i.prototype.showPinVisualFromDashboardDialog=function(e,t){return __awaiter(this,void 0,M.Promise,(function(){return __generator(this,(function(e){return[2]}))}))},i.prototype.showPinReportPageDialog=function(e){return __awaiter(this,void 0,M.Promise,(function(){return __generator(this,(function(e){return[2]}))}))},i.prototype.hideDialog=function(){return __awaiter(this,void 0,M.Promise,(function(){return __generator(this,(function(e){return[2]}))}))},i.prototype.onPinButtonClickedActions=function(){return __awaiter(this,void 0,M.Promise,(function(){return __generator(this,(function(e){return[2]}))}))},i.prototype.onSaveAndContinueButtonClickedActions=function(){return __awaiter(this,void 0,M.Promise,(function(){return __generator(this,(function(e){return[2]}))}))},i.prototype.setSavedReportId=function(e){return __awaiter(this,void 0,M.Promise,(function(){return __generator(this,(function(e){return[2]}))}))},i.prototype.updateTile=function(e){return __awaiter(this,void 0,M.Promise,(function(){return __generator(this,(function(e){return[2]}))}))},i.prototype.canPinReportPage=function(e){return!1},i.prototype.canPinFromModel=function(e){return!1},i.prototype.canPinTile=function(e){return!1},i.prototype.pinVisual=function(e){return __awaiter(this,void 0,M.Promise,(function(){return __generator(this,(function(e){return[2]}))}))},i.prototype.pinReportPage=function(e){return __awaiter(this,void 0,M.Promise,(function(){return __generator(this,(function(e){return[2]}))}))},i.prototype.getSourceOrigin=function(e,t){return __awaiter(this,void 0,M.Promise,(function(){return __generator(this,(function(e){return[2,"Owned"]}))}))},i);function i(){}})(powerbi=powerbi||{}),(function(n){!(function(t){var e=jsCommon.Utility;t.createServerLatencyService=function(e,t,o,i,r){return new a(e,t,o,i,r)},t.DefaultPauseTimeBetweenRequestsInMs=6e4;var r="pingLatency",a=(o.prototype.getServerLatencyInMs=function(){var t=this,o=performance.now(),i=this.promiseFactory.defer();return this.$http.get(this.pingUrl,{timeout:2e3}).then((function(e){200!==e.status&&(i.reject(),n.contract.fail("Ping request failed."));e=performance.now()-o;t.telemetryService.setHostInfo(r,e),i.resolve(e)}),(function(){t.telemetryService.setHostInfo(r,-1),i.resolve(-1)})),i.promise},o.prototype.startMonitoring=function(){var e=this;this.stopMonitoring(),this.getServerLatencyInMs(),this.requestPromise=this.$interval((function(){e.getServerLatencyInMs()}),t.DefaultPauseTimeBetweenRequestsInMs)},o.prototype.stopMonitoring=function(){this.requestPromise&&(this.$interval.cancel(this.requestPromise),this.requestPromise=null)},Object.defineProperty(o.prototype,"pingUrl",{get:function(){return this.pingUrlString||(this.pingUrlString=e.urlCombine(this.appSettings.clusterUri,"/powerbi/metadata/ping")),this.pingUrlString},enumerable:!1,configurable:!0}),o);function o(e,t,o,i,r){this.appSettings=e,this.$http=t,this.telemetryService=o,this.promiseFactory=i,this.$interval=r,this.requestPromise=null}})(n.services||(n.services={}))})(powerbi=powerbi||{}),(function(e){(e.staticContract||(e.staticContract={})).getActivityPaneContract=function(){return{contentProviders:[],collapsed:!0}}})(powerbi=powerbi||{}),(function(r){r.tileDataRefreshWorker=function(e,t,o){var i;(t=t.convertTileConfig(o.contract))&&t.refreshPeriod&&((t=t.refreshPeriod)<6e4&&(t=6e4),i=setInterval((function(){return o.refreshData()}),t),e.$on(r.common.constants.scopeDestroyEventName,(function(){return clearInterval(i)})))}})(powerbi=powerbi||{}),(function(d){var e,p;function t(e,t){var o=this;this.scope=e,this.services=t,this.scope.sortDescending=!1,this.scope.sortProperty="name",this.services.asyncFeatureSwitchService.getFeatureSwitches().then((function(e){o.scope.featureSwitchPublishToWeb=!!e.publishToWebEnabled})),this.scope.onDeleteEmbedClick=function(e){return o.onDeleteEmbedClick(e)},this.scope.showEmbedCode=function(e){return o.showEmbedCode(e)},this.scope.updateSortProperty=function(e){return o.updateSortProperty(e)},this.loadEmbeddedResources()}e=d.controllers||(d.controllers={}),p=d.explore.viewModels.ViewModelFactory,t.createOptions=function(){return{additionalServices:["reportService","modelService","lazy","errorService","modelConverter","localizationService","telemetryService","promiseFactory","modalDialogService","rtl","activeFolderId","asyncFeatureSwitchService","lazy","explorationProxy"]}},t.prototype.onDeleteEmbedClick=function(e){this.services.embedCodesService.promptDeleteConfirmationDialog(e,this.scope.embeddedResources)},t.prototype.showEmbedCode=function(c){return __awaiter(this,void 0,d.Promise,(function(){var t,o,i,r,a,n,s,l=this;return __generator(this,(function(e){switch(e.label){case 0:return t=c.reportId,o=c.contract,a=o.name,i={name:a,reportId:t,culture:d.common.getCultureInfo(),size:{height:o.size.height,width:o.size.width},version:d.getBuild()},(r=this.services.promiseFactory.defer()).reject(),[4,this.services.lazy("embed")];case 1:return s=e.sent(),a=s.createEmbedUri(o),s=s.createEmbedCode(o),n={existingInteractiveEmbedsPromise:r.promise,currentReportId:t,passedEmbedContract:o,passedLink:a,passedEmbedCode:s,newEmbed:i},[4,this.services.asyncFeatureSwitchService.getFeatureSwitches()];case 2:return(s=e.sent())&&s.optimizePublishToWeb?this.services.explorationProxy.get({id:c.reportId}).then((function(e){var t=p.convertExploration(e.exploration,0,0,void 0),e=_.first(e.exploration.sections);l.services.embedCodesService.onEmbedPopUpCreate("manageEmbedCodesDialog",t,e,0,n)})):this.services.embedCodesService.onEmbedPopUpCreate("manageEmbedCodesDialog",void 0,void 0,0,n),[2]}}))}))},t.prototype.updateSortProperty=function(e){this.scope.sortProperty===e?this.scope.sortDescending=!this.scope.sortDescending:(this.scope.sortProperty=e,this.scope.sortDescending=!1)},t.prototype.loadEmbeddedResources=function(){return __awaiter(this,void 0,d.Promise,(function(){var t,o=this;return __generator(this,(function(e){switch(e.label){case 0:return this.scope.isLoaded=!1,t=this.services,[4,this.services.lazy("embedCodesService")];case 1:return t.embedCodesService=e.sent(),this.services.embedCodesService.loadEmbeddedResources().then((function(e){o.scope.embeddedResources=e,o.scope.isLoaded=!0})),[2]}}))}))},e.ManageEmbedView=t})(powerbi=powerbi||{}),(function(e){var t;(t=e.directives||(e.directives={})).ManageEmbedView=function(){this.template="<legacy-scoped-root><exploration-scoped-services-bridge><manage-embed-view-inner></manage-embed-view-inner></exploration-scoped-services-bridge></legacy-scoped-root>"},t.ManageEmbedViewInner=function(){this.restrict="E",this.templateUrl="views/manageEmbedView.html",this.replace=!0,this.controller=e.common.createController(e.controllers.ManageEmbedView)}})(powerbi=powerbi||{}),(function(l){!(function(e){function t(r,e){var a=this;this.excelProviderBaseEndpointPath="/powerbi/providers/excel/",this.scope=r,this.services=e,this.scope.isLoading=!1,this.scope.hasError=!1;var n,s;this.scope.useFolderSharePointStorage&&this.services.folderService.activeFolderNumericId?this.loadFolderSharePoint(r):(n=this.services.telemetryService.startChildEvent(this.services.telemetryService.root,l.telemetry.CustomConfigHandlerSharePointDiscover,{URL:this.scope.url}),e={dialogName:this.services.localizationService.get("SharePoint_ModalTitle"),isDismissable:!1,scope:this.scope,template:"<share-point-url-modal></share-point-url-modal>",focusOnFirstButton:!0,dialogActions:[new InJs.ModalDialogAction(this.services.localizationService.get("ModalDialog_Connect"),function(e,t){a.scope.isLoading=!0,a.scope.hasError=!1;var o=a.services.contentProviderConfigHandler,i=a.services.folderService;o.configData={sharePointUrl:a.scope.url},i.isFolder&&(o.configData.folderObjectId=i.activeFolderObjectId),a.getDocumentLibararies(n.event).then((function(e){o.configData||(o.configData={}),a.services.contentProviderConfigHandler.configData.result=e,a.scope.isLoading=!1,s.then((function(e){return e.closeDialog()})),r.$emit(l.common.constants.contentProviderStoreCustomConfigurationPostbackEventName,!0),n.resolve()}),(function(e){a.scope.hasError=!0,a.scope.isLoading=!1,e.status=404,a.scope.errorMessage=a.services.localizationService.get("SharePoint_AccessError"),n.resolve()}))}),new InJs.ModalDialogAction(this.services.localizationService.get("ModalDialog_Cancel"),function(e,t){a.scope.isLoading=!1,a.scope.hasError=!1,s.then((function(e){return e.closeDialog()})),r.$emit(l.common.constants.contentProviderStoreCustomConfigurationPostbackEventName,!1)})],notificationType:jsCommon.ModalDialogNotificationType.Info},s=this.services.modalDialogService.showLegacyWebModalDialog(e))}e=e.contentProviderStore||(e.contentProviderStore={}),t.createOptions=function(){return{additionalServices:["httpService","modalDialogService","localizationService","contentProviderConfigHandler","telemetryService","folderService","globalEventBridge"]}},t.prototype.getDocumentLibararies=function(e,t){var o=this.services.httpService.powerbiRequestOptions(e,"GetSharepointDocumentLibraries"),e=this.excelProviderBaseEndpointPath+"allDocumentLibraries";return t?e=e+"?siteUrl="+t:this.scope.url&&(e=e+"?siteUrl="+this.scope.url),this.services.httpService.get(e,o)},t.prototype.loadFolderSharePoint=function(t){var e,o,i,r,a,n=this,s=this.services.folderService;s.activeFolderNumericId&&(!(i=s.activeFolder).sharePointStorage||(e=i.sharePointStorage.groupFilesUrl)&&(i=e.split("/"),o=i[i.length-1],0<(i=e.lastIndexOf(o))&&(e=e.slice(0,i)),this.scope.isLoading=!0,this.scope.hasError=!1,(r=this.services.contentProviderConfigHandler).configData={},r.configData.sharePointUrl=e,r.configData.folderObjectId=s.activeFolderObjectId,a=this.services.telemetryService.startChildEvent(this.services.telemetryService.root,l.telemetry.CustomConfigHandlerSharePointDiscover,{URL:e}),this.services.globalEventBridge.publishToChannel(l.services.events.contentProviderStoreShowLoadingScreenArtifact),this.getDocumentLibararies(a.event,e).then((function(e){r.configData||(r.configData={}),r.configData.result=e,r.configData.sharedDocFolder=o,n.scope.isLoading=!1,t.$emit(l.common.constants.contentProviderStoreCustomConfigurationPostbackEventName,!0),a.resolve()}),(function(e){n.scope.hasError=!0,n.scope.isLoading=!1,e.status=404,n.scope.errorMessage=n.services.localizationService.get("SharePoint_AccessError"),a.resolve()}))))},e.SharePointUrlInputController=t})(l.controllers||(l.controllers={}))})(powerbi=powerbi||{}),(function(e){(e.directives||(e.directives={})).DashboardTileOpenOptions=function(){this.restrict="E",this.templateUrl="views/tiles/dashboardTileOpenOptions.html",this.replace=!0}})(powerbi=powerbi||{}),(function(e){(e.directives||(e.directives={})).SharePointUrlInput=function(){this.restrict="E",this.scope={useFolderSharePointStorage:"<?"},this.controller=e.common.createController(e.controllers.contentProviderStore.SharePointUrlInputController)}})(powerbi=powerbi||{}),(function(e){var t,l;function o(){}t=e.helpers||(e.helpers={}),l=e.common.constants,o.getClusterLocation=function(e,t){var o,i=l.clusterLocations;for(o in i)for(var r=0,a=i[o];r<a.length;r++){var n=a[r];if(0<=e.toLocaleLowerCase().indexOf(n))return t.get(o)}var s=jsCommon.UrlUtils.parseUrl(e);return s&&s.host||e},t.ClusterLocationHelper=o})(powerbi=powerbi||{}),(function(s){var e;function r(e,t,o,i,r,a){var n,r=r.activeFolderNumericId;return a.featureSwitches.workspacesV2&&e===s.constants.myWorkSpaceFolderId||r?r||e!==s.constants.myWorkSpaceFolderId?r&&null!==r?(function(o,e,i,r){var a={};if(e)return _(e).filter((function(e){if(i(e)===o){var t=r(e);if(!a[t])return a[t]=e,!0}return!1})).value()})(r,t,o,i):t:(n=o,_.filter(t,(function(e){return!n(e)}))):t}(e=(e=s.helpers||(s.helpers={})).FolderContentFilteringHelper||(e.FolderContentFilteringHelper={})).filterModels=function(e,t,o,i){return r(e,t,(function(e){return e.contract.folderId}),(function(e){return e.dbName}),o,i)},e.filterCdsaModels=function(e,t,o,i){return r(e,t,(function(e){return e.folderId}),(function(e){return e.objectId}),o,i)},e.filterDashboards=function(e,t,o,i){return r(e,t,(function(e){return e.folderId}),(function(e){return e.contract.originalDashboardObjectId||e.objectId}),o,i)},e.filterPackages=function(e,t,o,i){return r(e,t,(function(e){return e.contract.folderId}),(function(e){return(e.originalPackageId||e.id).toString()}),o,i)},e.filterReports=function(e,t,o,i){return r(e,t,(function(e){return e.contract.folderId}),(function(e){return e.contract.originalReportObjectId||e.objectId}),o,i)},e.filterWorkbooks=function(e,t,o,i){return r(e,t,(function(e){return e.contract.folderId}),(function(e){return e.contract.etagHash}),o,i)},e.filterForFolder=r})(powerbi=powerbi||{}),(function(s){var e,a,n;e=(e=s.utils||(s.utils={})).tile||(e.tile={}),a=s.dataServices.contracts.TileType,n=s.dataServices.ContractUtils,e.getDataSources=function(e,t,o){if(!e)return s.explore.contracts.createDataSourceArray([]);var i=[],r=s.explore.constants.DefaultSchemaName,o={type:s.common.constants.dsrDataReaderType,id:e.modelId,name:s.explore.constants.DefaultSchemaName,dsr:{schemaName:s.explore.constants.DefaultSchemaName,vsName:t,dbName:o,modelId:e.modelId}};i.push(o);var a=e.$config.visualContainer.$modelExtensions,n=e.$config.visualContainer.dataSourceVariables,o=s.explore.constants.ExplorationSchemaName,r={type:s.explore.dataReaderPlugins.ExplorationDataReaderType,id:e.id,name:o,extends:r,exploration:{schemaName:o,extends:r,getModelExtensions:function(){return a},getDataSourceVariables:function(){return n}}};return i.push(r),s.explore.contracts.createDataSourceArray(i)},e.isInFocusableState=function(e,t){var o;if(!e)return!1;switch(e.type){case a.composite:if(t&&t.type!==s.visuals.plugins.image.name)try{var i=e.query,r=n.convertToSemanticQueryWithDataShapeBinding(i);if(2<=(null===(o=null==r?void 0:r.defn)||void 0===o?void 0:o.Version)&&_.isEmpty(r.defn.Transform))return!0}catch(e){}break;case a.workbook:case a.realTime:return!0}return!1},e.getDefaultSectionSize=function(){return{displayOption:0,width:s.explore.constants.ExploreCanvasConstants.DefaultCanvasWidth,height:s.explore.constants.ExploreCanvasConstants.DefaultCanvasHeight}}})(powerbi=powerbi||{}),(function(i){var e,r,a;e=(e=i.utils||(i.utils={})).dashboardTheme||(e.dashboardTheme={}),r=jsCommon.CssConstants,a=jsCommon.UrlUtils,e.getTileStylesByTheme=function(e,t){if(void 0===t&&(t=!1),e&&e.tiles){if(t)return(o={})[r.backgroundColorProperty]=e.tiles.background,o[r.colorProperty]=e.tiles.color,o[r.opacityProperty]=e.tiles.opacity,o;var o,t=i.common.utils.ColorUtility.hexToRGBString(e.tiles.background,e.tiles.opacity);return(o={})[r.backgroundColorProperty]=t,o[r.colorProperty]=e.tiles.color,o}},e.getDashboardStylesByTheme=function(e){if(e){var t=e.tiles?e.tiles[r.colorProperty]:r.transparentValue,o=((o={})[r.backgroundColorProperty]=e.background,o[r.colorProperty]=t,o);return a.isValidImageUrl(e.backgroundImage)?(o[r.backgroundImageProperty]="url("+e.backgroundImage+")",o[r.backgroundSizeProperty]=r.coverValue):o[r.backgroundImageProperty]=r.noneValue,o}}})(powerbi=powerbi||{});;
"use strict";var powerbi;!(function(s){var e;function l(){return{class:s.visualHost.EsriVisual,titleKey:"ArcGISMapsForPowerBI",watermarkKey:"map"}}function u(e){return{blockedInCluster:function(){return!e.featureSwitches.esriEnabled},blockedInTenant:function(){return!e.featureSwitches.esriVisualEnabled},blockedInHost:_.stubFalse}}function c(e,t,r,n){return{consentDialogProvider:o(e,t),consentPersistencyProvider:a(e,r,n)}}function a(r,n,o){return{loadConsent:function(){var t=r.defer();return n.esriVisualEnabled.subscribe((function(e){t.resolve(e)})),t.promise},saveConsent:function(e){var t=o.startEvent(s.telemetry.SettingsEsriSaveModel,{esriEnabled:e});return n.setEsriVisualEnabled(e,t),r.resolve(e)}}}function d(t,r,n){return{getErrorDetails:function(){var e;if(t.blockedInTenant()?e="SettingsEsri_OrganizationHasDisabled":r&&!r.hasConsent(s.visualHost.EsriVisual)&&(e="VisualContainer_EsriNotConsented"),e)return{message:n.get(e),errorType:1,displayableErrorInfo:[],helpLink:s.models.EsriLearnMoreUrl}}}}function o(e,r){return{showConsentDialog:function(){var t=e.defer();return r.openHostDialog({dialogName:"EsriConsentDialog",componentName:"EsriConsentDialog",config:{panelClass:["esri-consent-dialog"],autoFocus:!1}}).then((function(e){return e.afterClosed().subscribe((function(e){return t.resolve(e)}))})),t.promise}}}(e=(e=(e=s.explore||(s.explore={})).utils||(e.utils={})).EsriVisualHelper||(e.EsriVisualHelper={})).createBlockedRegisterTrustedVisualOptions=function(t,e,r){return{automaticallyImport:r=void 0===r?!0:r,sandboxProperties:[2,1,0,3],providers:{blocker:{blockedInCluster:_.stubTrue,blockedInTenant:_.stubTrue,blockedInHost:_.stubFalse},validator:{getErrorDetails:function(){return{message:e.get("VisualContainer_EsriNotSupportedInEmbed"),errorType:1,displayableErrorInfo:[],helpLink:s.models.EsriLearnMoreUrl}}}},visualTypeOptions:l(),registerVisualConsentOptions:{consentDialogProvider:{showConsentDialog:function(){return t.reject(s.visualHost.ESRINotSupportedInEmbed)}},consentPersistencyProvider:{loadConsent:function(){return t.reject(s.visualHost.ESRINotSupportedInEmbed)},saveConsent:function(e){return t.reject(s.visualHost.ESRINotSupportedInEmbed)}}}}},e.createBlocker=u,e.createRegisterTrustedVisualOptions=function(e,t,r,n,o,s,i,a){return void 0===a&&(a=!0),r=u(r),{automaticallyImport:a,sandboxProperties:[2,1,0,3],providers:{blocker:r,validator:d(r,i,n)},visualTypeOptions:l(),registerVisualConsentOptions:c(e,t,o,s)}},e.createNoConsentRegisterTrustedVisualOptions=function(e,t,r){return void 0===r&&(r=!0),e=u(e),{automaticallyImport:r,sandboxProperties:[2,1,0,3],providers:{blocker:e,validator:d(e,void 0,t)},visualTypeOptions:l()}},e.createRegisterVisualConsentOptions=c,e.createMobileVisualRegisterOptions=function(e,t,r,n,o,s,i){return void 0===i&&(i=!0),t=u(t),{automaticallyImport:i,sandboxProperties:[2,1,0,3],providers:{blocker:t,validator:d(t,n,r)},visualTypeOptions:l(),registerVisualConsentOptions:{consentDialogProvider:{showConsentDialog:function(){return e.reject("Esri consent dialog is not supported in Mobile scenario.")}},consentPersistencyProvider:a(e,o,s)}}},e.createConsentPersistencyProvider=a,e.createValidator=d,e.createConsentDialogProvider=o})(powerbi=powerbi||{}),(function(o){!(function(t){var e=jsCommon.Utility,r=o.telemetryEventFactory,n=o.telemetry.EventFactories;e?e.generateGuid:Function.prototype;t.SettingsEsriSaveModelEventName="PBI.Settings.EsriSaveModel",t.SettingsEsriSaveModel=n[t.SettingsEsriSaveModelEventName]=function(e){return r({name:t.SettingsEsriSaveModelEventName,baseEvent:t.CustomerAction(e),info:e,category:o.TelemetryCategory.CustomerAction,loggers:t.SettingsEsriSaveModelLoggers})}})(o.telemetry||(o.telemetry={}))})(powerbi=powerbi||{});;
"use strict";var powerbi;!(function(e){((e=e.web||(e.web={})).constants||(e.constants={})).whiteListResource=["self","**"]})(powerbi=powerbi||{}),(function(t){!(function(e){var r=jsCommon.ExceptionHelper,o=jsCommon.QueryStringUtil;function i(){var i;n||(t.common.initializeAngularModule(),t.initializeAngularModule(),t.connectivity.initializeAngularModule(),i=o.getQueryStringValue("isE2ERun")||o.getQueryStringValue("isE2ERun2")||window.DEBUG,angular.module("powerbi.web",["angularFileUpload","vs-repeat","powerbi.common.directives","powerbi","powerbi.controllers","powerbi.directives","powerbi.components","powerbi.filters","powerbi.connectivity"]).config(["$compileProvider","$ocLazyLoadProvider",function(e,o){i?o.config({debug:!0}):e.debugInfoEnabled(!1)}]).config(["pbiLazyLoadProvider",function(e){e.setHostEnv(8)}]).config(["$sceDelegateProvider",function(e){e.resourceUrlWhitelist(t.web.constants.whiteListResource)}]).config(["$httpProvider",function(e){e.useApplyAsync(!0)}]).run(["$window","telemetryService","$injector",function(e,o,i){window.DEBUG&&(window.injector=i),t.common.setPopupWindowService(t.common.createPopupWindowService(e)),window.DEBUG||(window.alert=function(e){},e=window.onerror||_.noop,window.onerror=r.getWindowOnErrorWrapper(o,e,t.telemetry.DashboardUnhandledStacklessException,t.telemetry.DashboardUnhandledException))}]).factory("$exceptionHandler",["telemetryService","customTraceLoggerService",function(e,o){return r.getExceptionHandler(e,o,t.telemetry.DashboardUnhandledAngularException)}]),t.registerController("LandingContainer",["$scope","$rootScope","$http","$timeout"]),t.common.registerPBICommonBuildingBlocksForHost(8),t.visualHost.registerBuildingBlocksForHost(8),t.explore.registerBuildingBlocksForHost(8),t.explore.exploration.registerBuildingBlocksForHost(8),window.gatewaysModuleDefined&&t.gateways.registerBuildingBlocksForHost(8),t.connectivity.registerBuildingBlocksForHost(8),t.registerBuildingBlocksForHost(8),n=!0)}e.initializeAngularModule=i;var n=!1;i()})(t.web||(t.web={}))})(powerbi=powerbi||{});
this.parseTimeMarkers = this.parseTimeMarkers || {};
var marker = this.parseTimeMarkers['powerbiportal.web.bundle.min.js'] || (this.parseTimeMarkers['powerbiportal.web.bundle.min.js'] = {});
marker.endEval = window.jsCommon && window.jsCommon.performance && window.jsCommon.performance.now ? window.jsCommon.performance.now() : Date.now(); marker.isExternal = false;
